{"summary":{"changed":0,"unchanged":1255,"matches":0,"duration":{"secs":0,"nanos":141404125},"scannerDuration":{"secs":0,"nanos":7405541},"errors":95,"warnings":293,"skipped":0,"suggestedFixesSkipped":0,"diagnosticsNotPrinted":0},"diagnostics":[{"category":"lint/complexity/noUselessSwitchCase","severity":"information","description":"Useless case clause.","message":[{"elements":[],"content":"Useless "},{"elements":["Emphasis"],"content":"case clause"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"because the "},{"elements":["Emphasis"],"content":"default clause"},{"elements":[],"content":" is present:"}]]},{"frame":{"path":null,"span":[4851,4903],"sourceCode":"import { loaderClient } from \"~/lib/loader-client\"\nimport { SearchHeader } from \"~/routes/($lang)._main.search/components/search-header\"\nimport { SearchResults } from \"~/routes/($lang)._main.search/components/search-results\"\nimport { SearchHints } from \"~/routes/($lang)._main.search/components/search-hints\"\nimport { useLoaderData } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { config } from \"~/config\"\nimport { useNavigate, useSearchParams } from \"@remix-run/react\"\nimport { PhotoAlbumWorkFragment } from \"~/components/responsive-photo-works-album\"\n\nexport async function loader(props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const url = new URL(props.request.url)\n\n  const tag = url.searchParams.get(\"tag\")\n  const q = url.searchParams.get(\"q\")\n  const model =\n    url.searchParams.get(\"workModelId\") ?? url.searchParams.get(\"model\")\n\n  // Build where condition\n  const whereCondition: Record<string, unknown> = {\n    // /search ã¯åŸºæœ¬çš„ã« G + R15 ã‚’è¡¨ç¤ºï¼ˆSearchResults ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¨åˆã‚ã›ã‚‹ï¼‰\n    ratings: [\"G\", \"R15\"],\n    orderBy: \"LIKES_COUNT\",\n  }\n\n  // Add search query\n  if (q) {\n    whereCondition.search = q\n  }\n\n  // Add tag search (legacy support)\n  if (tag) {\n    whereCondition.tagNames = [tag]\n  }\n\n  // Add model search\n  if (model) {\n    whereCondition.modelPostedIds = [model]\n  }\n\n  const worksResp = await loaderClient.query({\n    query: worksQuery,\n    variables: {\n      offset: 0,\n      limit: 16,\n      where: whereCondition,\n    },\n  })\n\n  // AIãƒ¢ãƒ‡ãƒ«ä¸€è¦§ã‚’å–å¾—\n  const modelsResp = await loaderClient.query({\n    query: aiModelsQuery,\n    variables: {},\n  })\n\n  // äººæ°—ã‚¿ã‚°ã‚’å–å¾—ï¼ˆã‚¿ã‚°ä½¿ç”¨æ•°é †ï¼‰\n  const popularTagsResp = await loaderClient.query({\n    query: popularTagsQuery,\n    variables: { limit: 20 },\n  })\n\n  // ã‚ˆãæ¤œç´¢ã•ã‚Œã¦ã„ã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã€å®Ÿéš›ã®APIå®Ÿè£…æ™‚ã«å·®ã—æ›¿ãˆï¼‰\n  const popularKeywords = [\n    \"ã‚¤ãƒ©ã‚¹ãƒˆ\",\n    \"ã‚¢ãƒ‹ãƒ¡\",\n    \"ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼\",\n    \"é¢¨æ™¯\",\n    \"ãƒãƒ¼ãƒˆãƒ¬ãƒ¼ãƒˆ\",\n    \"ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼\",\n    \"ã‚µã‚¤ãƒãƒ¼ãƒ‘ãƒ³ã‚¯\",\n    \"ã‹ã‚ã„ã„\",\n    \"ç¾å°‘å¥³\",\n    \"ãƒ¡ã‚«\",\n    \"ãƒ‰ãƒ©ã‚´ãƒ³\",\n    \"é­”æ³•ä½¿ã„\",\n  ]\n\n  return {\n    workResp: worksResp.data?.works ?? [],\n    models:\n      modelsResp.data?.aiModels\n        ?.map((model) => ({\n          id: model.workModelId || model.id,\n          name: model.name,\n          displayName: model.name,\n          workModelId: model.workModelId || model.id,\n          thumbnailImageURL: model.thumbnailImageURL,\n        }))\n        .filter((model) => model.id) || [],\n    popularTags:\n      popularTagsResp.data?.recommendedTags\n        ?.map((tag) => ({\n          id: tag.tagName, // tagNameã‚’idã¨ã—ã¦ä½¿ç”¨\n          name: tag.tagName,\n          count: 0, // recommendedTagsã«ã¯ä»¶æ•°ãŒãªã„ãŸã‚0ã‚’è¨­å®š\n          thumbnailUrl: tag.thumbnailUrl, // ã‚µãƒ ãƒã‚¤ãƒ«URLã‚’è¿½åŠ \n        }))\n        .slice(0, 15) || [], // è¡¨ç¤ºç”¨ã«15å€‹ã«åˆ¶é™\n    popularKeywords: popularKeywords.slice(0, 12), // è¡¨ç¤ºç”¨ã«12å€‹ã«åˆ¶é™\n    popularModels:\n      modelsResp.data?.aiModels\n        ?.filter((model) => model.thumbnailImageURL) // ã‚µãƒ ãƒã‚¤ãƒ«ãŒã‚ã‚‹ã‚‚ã®ã®ã¿\n        ?.map((model) => ({\n          id: model.workModelId || model.id,\n          name: model.name,\n          displayName: model.name,\n          workModelId: model.workModelId || model.id,\n          thumbnailImageURL: model.thumbnailImageURL || undefined,\n        }))\n        .slice(0, 8) || [], // è¡¨ç¤ºç”¨ã«8å€‹ã«åˆ¶é™\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function Search () {\n  const data = useLoaderData<typeof loader>()\n  const [searchParams] = useSearchParams()\n  const navigate = useNavigate()\n\n  if (data === null) {\n    return null\n  }\n\n  const searchQuery = searchParams.get(\"q\")\n  const tagQuery = searchParams.get(\"tag\")\n  const modelQuery =\n    searchParams.get(\"workModelId\") ?? searchParams.get(\"model\")\n\n  const hasAnySearchQuery = Boolean(searchQuery || tagQuery || modelQuery)\n\n  const orderLabel = (() => {\n    const orderBy = searchParams.get(\"orderBy\")\n    const sort = searchParams.get(\"sort\")\n\n    const base = (() => {\n      switch (orderBy) {\n        case \"DATE_CREATED\":\n          return \"æ–°ç€é †\"\n        case \"VIEWS_COUNT\":\n          return \"é–²è¦§æ•°é †\"\n        case \"COMMENTS_COUNT\":\n          return \"ã‚³ãƒ¡ãƒ³ãƒˆé †\"\n        case \"BOOKMARKS_COUNT\":\n          return \"ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯é †\"\n        case \"NAME\":\n          return \"ã‚¿ã‚¤ãƒˆãƒ«é †\"\n        case \"LIKES_COUNT\":\n        default:\n          return \"äººæ°—é †ï¼ˆã„ã„ã­ï¼‰\"\n      }\n    })()\n\n    if (sort === \"ASC\") return `${base}ï¼ˆæ˜‡é †ï¼‰`\n    return base\n  })()\n\n  const modelLabel = (() => {\n    if (!modelQuery) return null\n    const m = data.models.find(\n      (x) => x.workModelId === modelQuery || x.id === modelQuery,\n    )\n\n    return m?.displayName ?? modelQuery\n  })()\n\n  const stateLabel = (() => {\n    // ğŸ· ã‚¿ã‚°ã‚¯ãƒªãƒƒã‚¯æ™‚\n    if (tagQuery) {\n      const tags = tagQuery\n        .split(\",\")\n        .map((s) => s.trim())\n        .filter(Boolean)\n      if (tags.length >= 2) {\n        return `ğŸ· #${tags[0]} Ã— #${tags[1]} ã®ä½œå“ä¸€è¦§ï¼ˆ${orderLabel}ï¼‰`\n      }\n      return `ğŸ· #${tagQuery} ã®ä½œå“ä¸€è¦§ï¼ˆ${orderLabel}ï¼‰`\n    }\n\n    // ğŸ” ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢æ™‚\n    if (searchQuery) {\n      return modelLabel\n        ? `ğŸ” ã€Œ${searchQuery}ã€ã®æ¤œç´¢çµæœï¼ˆ${orderLabel}ãƒ»${modelLabel}ï¼‰`\n        : `ğŸ” ã€Œ${searchQuery}ã€ã®æ¤œç´¢çµæœï¼ˆ${orderLabel}ï¼‰`\n    }\n\n    // ğŸ¨ AIãƒ¢ãƒ‡ãƒ«ã®ã¿\n    if (modelQuery) {\n      return modelLabel\n        ? `${modelLabel} ã®ä½œå“ä¸€è¦§ï¼ˆ${orderLabel}ï¼‰`\n        : `ãƒ¢ãƒ‡ãƒ«ã®ä½œå“ä¸€è¦§ï¼ˆ${orderLabel}ï¼‰`\n    }\n\n    // ğŸ”° åˆæœŸè¡¨ç¤º\n    return \"â­ ãŠã™ã™ã‚ä½œå“ï¼ˆAipictorsãƒ”ãƒƒã‚¯ï¼‰\"\n  })()\n\n  const beginnerChips = [\n    \"ã‹ã‚ã„ã„\",\n    \"ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼\",\n    \"SF\",\n    \"ã‚¢ãƒ‹ãƒ¡é¢¨\",\n    \"å†™å®Ÿ\",\n    \"é¢¨æ™¯\",\n    \"ãƒãƒ¼ãƒˆãƒ¬ãƒ¼ãƒˆ\",\n    \"ã‚µã‚¤ãƒãƒ¼ãƒ‘ãƒ³ã‚¯\",\n    \"é­”æ³•ä½¿ã„\",\n    \"é’é«ª\",\n  ]\n\n  const onChipClick = (chip: string) => {\n    const params = new URLSearchParams()\n    params.set(\"q\", chip)\n    navigate(`/search?${params.toString()}`)\n  }\n\n  return (\n    <>\n      <div className=\"mx-auto max-w-4xl px-4 pt-4\">\n        <SearchHeader models={data.models} />\n\n        <div className=\"mt-2 flex flex-wrap items-center gap-x-3 gap-y-1 text-muted-foreground text-sm\">\n          <span className=\"font-medium text-foreground\">{stateLabel}</span>\n        </div>\n\n        {/* å…¥åŠ›ã—ãªãã¦ã‚‚ä½¿ãˆã‚‹ï¼šåˆå¿ƒè€…å‘ã‘ã‚¿ã‚°ãƒãƒƒãƒ— */}\n        <div className=\"mt-3 flex gap-2 overflow-x-auto pb-2\">\n          {beginnerChips.map((chip) => (\n            <button\n              key={chip}\n              type=\"button\"\n              onClick={() => onChipClick(chip)}\n              className=\"shrink-0 rounded-full border bg-background px-3 py-1 text-sm hover:bg-muted\"\n            >\n              {`#${chip}`}\n            </button>\n          ))}\n        </div>\n      </div>\n\n      {/* ç›´ä¸‹ã«å³ã‚°ãƒªãƒƒãƒ‰ï¼ˆåˆæœŸçŠ¶æ…‹ã§ã‚‚å¿…ãšä½œå“ãŒè¦‹ãˆã‚‹ï¼‰ */}\n      <div className=\"mx-auto max-w-6xl px-4 py-4\">\n        <SearchResults\n          models={data.models}\n          initialWorks={data.workResp}\n          mode=\"explore\"\n        />\n\n        {/* ä¸‹å±¤ï¼šãƒ’ãƒ³ãƒˆï¼ˆæƒ…å ±ã¯å‡ºã—ã™ããšã€å¿…è¦ãªã‚‰æ·±æ˜ã‚Šï¼‰ */}\n        <div className=\"mt-6\">\n          <details>\n            <summary className=\"cursor-pointer text-muted-foreground text-sm\">\n              {hasAnySearchQuery\n                ? \"ã•ã‚‰ã«æ¢ã™ï¼ˆé›°å›²æ°—ãƒ»ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ»ç”»é¢¨ï¼‰\"\n                : \"ã•ã‚‰ã«æ¢ã™ï¼ˆé›°å›²æ°—ãƒ»ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ»ç”»é¢¨ï¼‰\"}\n            </summary>\n            <div className=\"mt-4\">\n              <SearchHints\n                popularTags={data.popularTags}\n                popularKeywords={data.popularKeywords}\n                popularModels={data.popularModels}\n              />\n            </div>\n          </details>\n        </div>\n      </div>\n    </>\n  )\n}\n\nexport const meta: MetaFunction = (props) => {\n  const searchQuery = props.params?.q || \"\"\n\n  let title = \"æ¤œç´¢ - Aipictors\"\n  let description =\n    \"AIç”Ÿæˆã‚¤ãƒ©ã‚¹ãƒˆã‚’æ¤œç´¢ã§ãã¾ã™ã€‚æ§˜ã€…ãªã‚¿ã‚°ã‚„ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ä½¿ã£ã¦ã€ãŠæ°—ã«å…¥ã‚Šã®ä½œå“ã‚’è¦‹ã¤ã‘ã¾ã—ã‚‡ã†ã€‚\"\n\n  if (searchQuery) {\n    title = `ã€Œ${searchQuery}ã€ã®æ¤œç´¢çµæœ - Aipictors`\n    description = `ã€Œ${searchQuery}ã€ã«é–¢ã™ã‚‹AIç”Ÿæˆã‚¤ãƒ©ã‚¹ãƒˆã®æ¤œç´¢çµæœã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚`\n  }\n\n  return [\n    { title },\n    { name: \"description\", content: description },\n    { property: \"og:title\", content: title },\n    { property: \"og:description\", content: description },\n    { property: \"og:type\", content: \"website\" },\n    { name: \"twitter:card\", content: \"summary_large_image\" },\n    { name: \"twitter:title\", content: title },\n    { name: \"twitter:description\", content: description },\n    {\n      name: \"robots\",\n      content: searchQuery ? \"noindex, follow\" : \"index, follow\",\n    },\n  ]\n}\n\nconst worksQuery = graphql(\n  `query Works($offset: Int!, $limit: Int!, $where: WorksWhereInput) {\n    works(offset: $offset, limit: $limit, where: $where) {\n      ...PhotoAlbumWork\n    }\n  }`,\n  [PhotoAlbumWorkFragment],\n)\n\nconst aiModelsQuery = graphql(\n  `query AiModels {\n    aiModels(offset: 0, limit: 124, where: {}) {\n      id\n      name\n      type\n      generationModelId\n      workModelId\n      thumbnailImageURL\n    }\n  }`,\n)\n\nconst popularTagsQuery = graphql(\n  `query PopularTags($limit: Int!) {\n    recommendedTags(limit: $limit, where: { isSensitive: false }) {\n      tagName\n      thumbnailUrl\n    }\n  }`,\n)\n"}},{"log":["info",[{"elements":[],"content":"Unsafe fix: Remove the useless "},{"elements":["Emphasis"],"content":"case"},{"elements":[],"content":"."}]]},{"diff":{"dictionary":"import { loaderClient } from \"~/lib/loader-client\"\nimport { SearchHeader } from \"~/routes/($lang)._main.search/components/search-header\"\nimport { SearchResults } from \"~/routes/($lang)._main.search/components/search-results\"          return \"ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯é †\"\n        case \"NAME\":\n          return \"ã‚¿ã‚¤ãƒˆãƒ«é †\"\n        case \"LIKES_COUNT\":\n        default:\n          return \"äººæ°—é †ï¼ˆã„ã„ã­ï¼‰\"  }`,\n)\n","ops":[{"diffOp":{"equal":{"range":[0,224]}}},{"equalLines":{"line_count":154}},{"diffOp":{"equal":{"range":[224,320]}}},{"diffOp":{"delete":{"range":[320,348]}}},{"diffOp":{"equal":{"range":[348,409]}}},{"equalLines":{"line_count":176}},{"diffOp":{"equal":{"range":[409,417]}}}]}}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.search/route.tsx"},"span":[4823,4842],"sourceCode":"import { loaderClient } from \"~/lib/loader-client\"\nimport { SearchHeader } from \"~/routes/($lang)._main.search/components/search-header\"\nimport { SearchResults } from \"~/routes/($lang)._main.search/components/search-results\"\nimport { SearchHints } from \"~/routes/($lang)._main.search/components/search-hints\"\nimport { useLoaderData } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { config } from \"~/config\"\nimport { useNavigate, useSearchParams } from \"@remix-run/react\"\nimport { PhotoAlbumWorkFragment } from \"~/components/responsive-photo-works-album\"\n\nexport async function loader(props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const url = new URL(props.request.url)\n\n  const tag = url.searchParams.get(\"tag\")\n  const q = url.searchParams.get(\"q\")\n  const model =\n    url.searchParams.get(\"workModelId\") ?? url.searchParams.get(\"model\")\n\n  // Build where condition\n  const whereCondition: Record<string, unknown> = {\n    // /search ã¯åŸºæœ¬çš„ã« G + R15 ã‚’è¡¨ç¤ºï¼ˆSearchResults ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¨åˆã‚ã›ã‚‹ï¼‰\n    ratings: [\"G\", \"R15\"],\n    orderBy: \"LIKES_COUNT\",\n  }\n\n  // Add search query\n  if (q) {\n    whereCondition.search = q\n  }\n\n  // Add tag search (legacy support)\n  if (tag) {\n    whereCondition.tagNames = [tag]\n  }\n\n  // Add model search\n  if (model) {\n    whereCondition.modelPostedIds = [model]\n  }\n\n  const worksResp = await loaderClient.query({\n    query: worksQuery,\n    variables: {\n      offset: 0,\n      limit: 16,\n      where: whereCondition,\n    },\n  })\n\n  // AIãƒ¢ãƒ‡ãƒ«ä¸€è¦§ã‚’å–å¾—\n  const modelsResp = await loaderClient.query({\n    query: aiModelsQuery,\n    variables: {},\n  })\n\n  // äººæ°—ã‚¿ã‚°ã‚’å–å¾—ï¼ˆã‚¿ã‚°ä½¿ç”¨æ•°é †ï¼‰\n  const popularTagsResp = await loaderClient.query({\n    query: popularTagsQuery,\n    variables: { limit: 20 },\n  })\n\n  // ã‚ˆãæ¤œç´¢ã•ã‚Œã¦ã„ã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã€å®Ÿéš›ã®APIå®Ÿè£…æ™‚ã«å·®ã—æ›¿ãˆï¼‰\n  const popularKeywords = [\n    \"ã‚¤ãƒ©ã‚¹ãƒˆ\",\n    \"ã‚¢ãƒ‹ãƒ¡\",\n    \"ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼\",\n    \"é¢¨æ™¯\",\n    \"ãƒãƒ¼ãƒˆãƒ¬ãƒ¼ãƒˆ\",\n    \"ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼\",\n    \"ã‚µã‚¤ãƒãƒ¼ãƒ‘ãƒ³ã‚¯\",\n    \"ã‹ã‚ã„ã„\",\n    \"ç¾å°‘å¥³\",\n    \"ãƒ¡ã‚«\",\n    \"ãƒ‰ãƒ©ã‚´ãƒ³\",\n    \"é­”æ³•ä½¿ã„\",\n  ]\n\n  return {\n    workResp: worksResp.data?.works ?? [],\n    models:\n      modelsResp.data?.aiModels\n        ?.map((model) => ({\n          id: model.workModelId || model.id,\n          name: model.name,\n          displayName: model.name,\n          workModelId: model.workModelId || model.id,\n          thumbnailImageURL: model.thumbnailImageURL,\n        }))\n        .filter((model) => model.id) || [],\n    popularTags:\n      popularTagsResp.data?.recommendedTags\n        ?.map((tag) => ({\n          id: tag.tagName, // tagNameã‚’idã¨ã—ã¦ä½¿ç”¨\n          name: tag.tagName,\n          count: 0, // recommendedTagsã«ã¯ä»¶æ•°ãŒãªã„ãŸã‚0ã‚’è¨­å®š\n          thumbnailUrl: tag.thumbnailUrl, // ã‚µãƒ ãƒã‚¤ãƒ«URLã‚’è¿½åŠ \n        }))\n        .slice(0, 15) || [], // è¡¨ç¤ºç”¨ã«15å€‹ã«åˆ¶é™\n    popularKeywords: popularKeywords.slice(0, 12), // è¡¨ç¤ºç”¨ã«12å€‹ã«åˆ¶é™\n    popularModels:\n      modelsResp.data?.aiModels\n        ?.filter((model) => model.thumbnailImageURL) // ã‚µãƒ ãƒã‚¤ãƒ«ãŒã‚ã‚‹ã‚‚ã®ã®ã¿\n        ?.map((model) => ({\n          id: model.workModelId || model.id,\n          name: model.name,\n          displayName: model.name,\n          workModelId: model.workModelId || model.id,\n          thumbnailImageURL: model.thumbnailImageURL || undefined,\n        }))\n        .slice(0, 8) || [], // è¡¨ç¤ºç”¨ã«8å€‹ã«åˆ¶é™\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function Search () {\n  const data = useLoaderData<typeof loader>()\n  const [searchParams] = useSearchParams()\n  const navigate = useNavigate()\n\n  if (data === null) {\n    return null\n  }\n\n  const searchQuery = searchParams.get(\"q\")\n  const tagQuery = searchParams.get(\"tag\")\n  const modelQuery =\n    searchParams.get(\"workModelId\") ?? searchParams.get(\"model\")\n\n  const hasAnySearchQuery = Boolean(searchQuery || tagQuery || modelQuery)\n\n  const orderLabel = (() => {\n    const orderBy = searchParams.get(\"orderBy\")\n    const sort = searchParams.get(\"sort\")\n\n    const base = (() => {\n      switch (orderBy) {\n        case \"DATE_CREATED\":\n          return \"æ–°ç€é †\"\n        case \"VIEWS_COUNT\":\n          return \"é–²è¦§æ•°é †\"\n        case \"COMMENTS_COUNT\":\n          return \"ã‚³ãƒ¡ãƒ³ãƒˆé †\"\n        case \"BOOKMARKS_COUNT\":\n          return \"ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯é †\"\n        case \"NAME\":\n          return \"ã‚¿ã‚¤ãƒˆãƒ«é †\"\n        case \"LIKES_COUNT\":\n        default:\n          return \"äººæ°—é †ï¼ˆã„ã„ã­ï¼‰\"\n      }\n    })()\n\n    if (sort === \"ASC\") return `${base}ï¼ˆæ˜‡é †ï¼‰`\n    return base\n  })()\n\n  const modelLabel = (() => {\n    if (!modelQuery) return null\n    const m = data.models.find(\n      (x) => x.workModelId === modelQuery || x.id === modelQuery,\n    )\n\n    return m?.displayName ?? modelQuery\n  })()\n\n  const stateLabel = (() => {\n    // ğŸ· ã‚¿ã‚°ã‚¯ãƒªãƒƒã‚¯æ™‚\n    if (tagQuery) {\n      const tags = tagQuery\n        .split(\",\")\n        .map((s) => s.trim())\n        .filter(Boolean)\n      if (tags.length >= 2) {\n        return `ğŸ· #${tags[0]} Ã— #${tags[1]} ã®ä½œå“ä¸€è¦§ï¼ˆ${orderLabel}ï¼‰`\n      }\n      return `ğŸ· #${tagQuery} ã®ä½œå“ä¸€è¦§ï¼ˆ${orderLabel}ï¼‰`\n    }\n\n    // ğŸ” ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢æ™‚\n    if (searchQuery) {\n      return modelLabel\n        ? `ğŸ” ã€Œ${searchQuery}ã€ã®æ¤œç´¢çµæœï¼ˆ${orderLabel}ãƒ»${modelLabel}ï¼‰`\n        : `ğŸ” ã€Œ${searchQuery}ã€ã®æ¤œç´¢çµæœï¼ˆ${orderLabel}ï¼‰`\n    }\n\n    // ğŸ¨ AIãƒ¢ãƒ‡ãƒ«ã®ã¿\n    if (modelQuery) {\n      return modelLabel\n        ? `${modelLabel} ã®ä½œå“ä¸€è¦§ï¼ˆ${orderLabel}ï¼‰`\n        : `ãƒ¢ãƒ‡ãƒ«ã®ä½œå“ä¸€è¦§ï¼ˆ${orderLabel}ï¼‰`\n    }\n\n    // ğŸ”° åˆæœŸè¡¨ç¤º\n    return \"â­ ãŠã™ã™ã‚ä½œå“ï¼ˆAipictorsãƒ”ãƒƒã‚¯ï¼‰\"\n  })()\n\n  const beginnerChips = [\n    \"ã‹ã‚ã„ã„\",\n    \"ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼\",\n    \"SF\",\n    \"ã‚¢ãƒ‹ãƒ¡é¢¨\",\n    \"å†™å®Ÿ\",\n    \"é¢¨æ™¯\",\n    \"ãƒãƒ¼ãƒˆãƒ¬ãƒ¼ãƒˆ\",\n    \"ã‚µã‚¤ãƒãƒ¼ãƒ‘ãƒ³ã‚¯\",\n    \"é­”æ³•ä½¿ã„\",\n    \"é’é«ª\",\n  ]\n\n  const onChipClick = (chip: string) => {\n    const params = new URLSearchParams()\n    params.set(\"q\", chip)\n    navigate(`/search?${params.toString()}`)\n  }\n\n  return (\n    <>\n      <div className=\"mx-auto max-w-4xl px-4 pt-4\">\n        <SearchHeader models={data.models} />\n\n        <div className=\"mt-2 flex flex-wrap items-center gap-x-3 gap-y-1 text-muted-foreground text-sm\">\n          <span className=\"font-medium text-foreground\">{stateLabel}</span>\n        </div>\n\n        {/* å…¥åŠ›ã—ãªãã¦ã‚‚ä½¿ãˆã‚‹ï¼šåˆå¿ƒè€…å‘ã‘ã‚¿ã‚°ãƒãƒƒãƒ— */}\n        <div className=\"mt-3 flex gap-2 overflow-x-auto pb-2\">\n          {beginnerChips.map((chip) => (\n            <button\n              key={chip}\n              type=\"button\"\n              onClick={() => onChipClick(chip)}\n              className=\"shrink-0 rounded-full border bg-background px-3 py-1 text-sm hover:bg-muted\"\n            >\n              {`#${chip}`}\n            </button>\n          ))}\n        </div>\n      </div>\n\n      {/* ç›´ä¸‹ã«å³ã‚°ãƒªãƒƒãƒ‰ï¼ˆåˆæœŸçŠ¶æ…‹ã§ã‚‚å¿…ãšä½œå“ãŒè¦‹ãˆã‚‹ï¼‰ */}\n      <div className=\"mx-auto max-w-6xl px-4 py-4\">\n        <SearchResults\n          models={data.models}\n          initialWorks={data.workResp}\n          mode=\"explore\"\n        />\n\n        {/* ä¸‹å±¤ï¼šãƒ’ãƒ³ãƒˆï¼ˆæƒ…å ±ã¯å‡ºã—ã™ããšã€å¿…è¦ãªã‚‰æ·±æ˜ã‚Šï¼‰ */}\n        <div className=\"mt-6\">\n          <details>\n            <summary className=\"cursor-pointer text-muted-foreground text-sm\">\n              {hasAnySearchQuery\n                ? \"ã•ã‚‰ã«æ¢ã™ï¼ˆé›°å›²æ°—ãƒ»ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ»ç”»é¢¨ï¼‰\"\n                : \"ã•ã‚‰ã«æ¢ã™ï¼ˆé›°å›²æ°—ãƒ»ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ»ç”»é¢¨ï¼‰\"}\n            </summary>\n            <div className=\"mt-4\">\n              <SearchHints\n                popularTags={data.popularTags}\n                popularKeywords={data.popularKeywords}\n                popularModels={data.popularModels}\n              />\n            </div>\n          </details>\n        </div>\n      </div>\n    </>\n  )\n}\n\nexport const meta: MetaFunction = (props) => {\n  const searchQuery = props.params?.q || \"\"\n\n  let title = \"æ¤œç´¢ - Aipictors\"\n  let description =\n    \"AIç”Ÿæˆã‚¤ãƒ©ã‚¹ãƒˆã‚’æ¤œç´¢ã§ãã¾ã™ã€‚æ§˜ã€…ãªã‚¿ã‚°ã‚„ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ä½¿ã£ã¦ã€ãŠæ°—ã«å…¥ã‚Šã®ä½œå“ã‚’è¦‹ã¤ã‘ã¾ã—ã‚‡ã†ã€‚\"\n\n  if (searchQuery) {\n    title = `ã€Œ${searchQuery}ã€ã®æ¤œç´¢çµæœ - Aipictors`\n    description = `ã€Œ${searchQuery}ã€ã«é–¢ã™ã‚‹AIç”Ÿæˆã‚¤ãƒ©ã‚¹ãƒˆã®æ¤œç´¢çµæœã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚`\n  }\n\n  return [\n    { title },\n    { name: \"description\", content: description },\n    { property: \"og:title\", content: title },\n    { property: \"og:description\", content: description },\n    { property: \"og:type\", content: \"website\" },\n    { name: \"twitter:card\", content: \"summary_large_image\" },\n    { name: \"twitter:title\", content: title },\n    { name: \"twitter:description\", content: description },\n    {\n      name: \"robots\",\n      content: searchQuery ? \"noindex, follow\" : \"index, follow\",\n    },\n  ]\n}\n\nconst worksQuery = graphql(\n  `query Works($offset: Int!, $limit: Int!, $where: WorksWhereInput) {\n    works(offset: $offset, limit: $limit, where: $where) {\n      ...PhotoAlbumWork\n    }\n  }`,\n  [PhotoAlbumWorkFragment],\n)\n\nconst aiModelsQuery = graphql(\n  `query AiModels {\n    aiModels(offset: 0, limit: 124, where: {}) {\n      id\n      name\n      type\n      generationModelId\n      workModelId\n      thumbnailImageURL\n    }\n  }`,\n)\n\nconst popularTagsQuery = graphql(\n  `query PopularTags($limit: Int!) {\n    recommendedTags(limit: $limit, where: { isSensitive: false }) {\n      tagName\n      thumbnailUrl\n    }\n  }`,\n)\n"},"tags":["fixable"],"source":null},{"category":"lint/complexity/noUselessLoneBlockStatements","severity":"information","description":"This block statement doesn't serve any purpose and can be safely removed.","message":[{"elements":[],"content":"This block statement doesn't serve any purpose and can be safely removed."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Standalone block statements without any block-level declarations are redundant in JavaScript and can be removed to simplify the code."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).events.halloween-2025/route.tsx"},"span":[21634,21663],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"~/components/ui/card\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { EventWakiaiaiImage } from \"~/routes/events.wakiaiai/components/event-wakiaiai-image\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { Link, useLoaderData } from \"@remix-run/react\"\nimport {\n  CalendarIcon,\n  MapPinIcon,\n  UsersIcon,\n  PaletteIcon,\n  ExternalLinkIcon,\n  ImageIcon,\n  StoreIcon,\n  BadgeIcon,\n  ClockIcon,\n  ChevronDownIcon,\n  ChevronUpIcon,\n} from \"lucide-react\"\nimport { loaderClient } from \"~/lib/loader-client\"\nimport { graphql } from \"gql.tada\"\nimport {\n  EventWorkListItemFragment,\n  EventWorkList,\n} from \"~/routes/($lang).events.$event._index/components/event-work-list\"\nimport {\n  EventAwardWorkListItemFragment,\n  EventAwardWorkList,\n} from \"~/routes/($lang).events.$event._index/components/event-award-work-list\"\nimport { config } from \"~/config\"\nimport { useState, useId } from \"react\"\n\nexport async function loader(props: LoaderFunctionArgs) {\n  const event = \"halloween-2025\"\n\n  const urlParams = new URL(props.request.url).searchParams\n\n  const pageParam = urlParams.get(\"page\")\n\n  const page = pageParam ? Number(pageParam) : 0\n\n  const eventsResp = await loaderClient.query({\n    query: appEventQuery,\n    variables: {\n      limit: 64,\n      offset: page * 64,\n      slug: event,\n      where: {\n        ratings: [\"G\", \"R15\"],\n        isNowCreatedAt: true,\n      },\n    },\n  })\n\n  if (eventsResp.data.appEvent === null) {\n    // ãƒãƒ­ã‚¦ã‚£ãƒ³2025ã‚¤ãƒ™ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã§ã‚‚è¡¨ç¤ºã™ã‚‹\n    return {\n      appEvent: null,\n      page,\n    }\n  }\n\n  return {\n    appEvent: eventsResp.data.appEvent,\n    page,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneMonth,\n})\n\nexport default function EventHalloween2025 () {\n  const data = useLoaderData<typeof loader>()\n  const [expandedFaq, setExpandedFaq] = useState<number | null>(null)\n  const participationMethodsId = useId()\n\n  const eventInfo = {\n    title: \"ãƒãƒ­ã‚¦ã‚£ãƒ³2025ä¼ç”»\",\n    subtitle:\n      \"Aipictorsã‚µã‚¤ãƒˆå†…ä¼ç”»ï¼šå’Œæ°—ã‚ã„AI4ä¼šå ´ã§ã®å±•ç¤ºãƒ»å†Šå­æ²è¼‰ã‚’ç›®æŒ‡ã—ã¦ãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã‚’æŠ•ç¨¿ã—ã‚ˆã†ï¼\",\n    date: \"2025å¹´10æœˆ25æ—¥(åœŸ)\",\n    time: \"10:00ã€œ16:00\",\n    location: \"åå¤å±‹é‰„é“ å¤ªç”°å·é§…å‰ å¤§å±‹æ ¹åºƒå ´\",\n    address: \"æ„›çŸ¥çœŒæ±æµ·å¸‚å¤§ç”°ç”ºä¸‹æµœç”°137\",\n    access: \"å¤ªç”°å·é§…ã‹ã‚‰å¾’æ­©1åˆ†\",\n    admission: \"ç„¡æ–™\",\n    deadline: \"ä½œå“æŠ•ç¨¿æœŸé–“ï¼š2025å¹´7æœˆ21æ—¥ã€œ8æœˆ31æ—¥\",\n    tag: \"!å’Œæ°—ã‚ã„AI2025ãƒãƒ­ã‚¦ã‚£ãƒ³ä¼ç”»\",\n  }\n\n  const features = [\n    {\n      icon: <PaletteIcon className=\"h-6 w-6\" />,\n      title: \"Aipictorsã‚µã‚¤ãƒˆå†…ä¼ç”»\",\n      description:\n        \"å½“ä¼ç”»ã¯Aipictorsã‚µã‚¤ãƒˆå†…ã§ã®ä½œå“æŠ•ç¨¿ä¼ç”»ã§ã™ã€‚å„ªç§€ä½œå“ãŒãƒªã‚¢ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆã§å±•ç¤ºã•ã‚Œã¾ã™\",\n    },\n    {\n      icon: <ImageIcon className=\"h-6 w-6\" />,\n      title: \"å’Œæ°—ã‚ã„AI4ä¼šå ´ã§ã®å±•ç¤º\",\n      description:\n        \"æŠ•ç¨¿ä½œå“ã®ä¸­ã‹ã‚‰å„ªç§€ä½œå“ãŒæ„›çŸ¥çœŒã®å®Ÿéš›ã®ã‚¤ãƒ™ãƒ³ãƒˆä¼šå ´ã§å±•ç¤ºã•ã‚Œã¾ã™\",\n    },\n    {\n      icon: <UsersIcon className=\"h-6 w-6\" />,\n      title: \"å†Šå­æ²è¼‰ã®ãƒãƒ£ãƒ³ã‚¹\",\n      description:\n        \"Aipictorsé‹å–¶ãŒä½œæˆã™ã‚‹å†Šå­ã¸ã®æ²è¼‰æ©Ÿä¼šãŒã‚ã‚Šã€ã‚¤ãƒ™ãƒ³ãƒˆä¼šå ´ã§é…å¸ƒãƒ»è²©å£²ã•ã‚Œã¾ã™\",\n    },\n  ]\n\n  const participationMethods = [\n    {\n      title: \"ã‚ªãƒ³ãƒ©ã‚¤ãƒ³æŠ•ç¨¿\",\n      description:\n        \"Aipictorsã«ã€Œ!å’Œæ°—ã‚ã„AI2025ãƒãƒ­ã‚¦ã‚£ãƒ³ä¼ç”»ã€ã‚¿ã‚°ä»˜ãã§ãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã‚’æŠ•ç¨¿ã—ã¦ãã ã•ã„ã€‚å„ªç§€ä½œå“ãŒå’Œæ°—ã‚ã„AI4ä¼šå ´ã§å±•ç¤ºã•ã‚Œã¾ã™ã€‚\",\n      icon: <BadgeIcon className=\"h-6 w-6\" />,\n      link: `/new/image?event=wakiaiai4-halloween&tag=${encodeURIComponent(eventInfo.tag)}`,\n    },\n    {\n      title: \"ãƒªã‚¢ãƒ«å‡ºå±•ï¼ˆåˆ¥ç”³è¾¼ï¼‰\",\n      description:\n        \"å’Œæ°—ã‚ã„AI4ã‚¤ãƒ™ãƒ³ãƒˆã«ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã¨ã—ã¦ç›´æ¥å‡ºå±•ã—ãŸã„å ´åˆã¯ã€åˆ¥é€”å’Œæ°—ã‚ã„AI4ã®å‡ºå±•ç”³è¾¼ãŒå¿…è¦ã§ã™ã€‚\",\n      icon: <StoreIcon className=\"h-6 w-6\" />,\n      link: \"/events/wakiaiai4\",\n    },\n  ]\n\n  const faqItems = [\n    {\n      question: \"ã“ã®ä¼ç”»ã¯ä½•ã§ã™ã‹ï¼Ÿ\",\n      answer:\n        \"AipictorsãŒä¸»å‚¬ã™ã‚‹ã‚µã‚¤ãƒˆå†…ä½œå“æŠ•ç¨¿ä¼ç”»ã§ã™ã€‚æŠ•ç¨¿ã•ã‚ŒãŸä½œå“ã®ä¸­ã‹ã‚‰å„ªç§€ä½œå“ã‚’é¸å®šã—ã€æ„›çŸ¥çœŒã§é–‹å‚¬ã•ã‚Œã‚‹ãƒªã‚¢ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆã€Œå’Œæ°—ã‚ã„AI4ã€ã®ä¼šå ´ã§å±•ç¤ºãƒ»å†Šå­æ²è¼‰ã‚’è¡Œã„ã¾ã™ã€‚\",\n    },\n    {\n      question: \"èª°ãŒä½œå“ã‚’é¸å®šãƒ»å±•ç¤ºã™ã‚‹ã®ã§ã™ã‹ï¼Ÿ\",\n      answer:\n        \"Aipictorsé‹å–¶ãŒä½œå“ã‚’é¸å®šã—ã€å’Œæ°—ã‚ã„AI4ã‚¤ãƒ™ãƒ³ãƒˆã«Aipictorsã¨ã—ã¦å‡ºå±•ã™ã‚‹éš›ã®å±•ç¤ºå†…å®¹ãƒ»å†Šå­åéŒ²ä½œå“ã¨ã—ã¦ä½¿ç”¨ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚\",\n    },\n    {\n      question: \"å‚åŠ æ–¹æ³•ã‚’æ•™ãˆã¦ãã ã•ã„\",\n      answer: `Aipictorsã‚µã‚¤ãƒˆã«ãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã‚’æŠ•ç¨¿ã™ã‚‹éš›ã€å¿…ãšã€Œ${eventInfo.tag}ã€ã‚¿ã‚°ã‚’ä»˜ã‘ã¦ãã ã•ã„ã€‚ã“ã®ä¼ç”»ã¸ã®å‚åŠ ã¯ã‚µã‚¤ãƒˆå†…æŠ•ç¨¿ã®ã¿ã¨ãªã‚Šã¾ã™ã€‚`,\n    },\n    {\n      question: \"ç›´æ¥ã‚¤ãƒ™ãƒ³ãƒˆä¼šå ´ã«å‡ºå±•ã—ãŸã„å ´åˆã¯ï¼Ÿ\",\n      answer:\n        \"ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼å€‹äººã¨ã—ã¦å’Œæ°—ã‚ã„AI4ã«å‡ºå±•ã—ãŸã„å ´åˆã¯ã€ã“ã®ä¼ç”»ã¨ã¯åˆ¥ã«å’Œæ°—ã‚ã„AI4ã®å‡ºå±•ç”³è¾¼ãŒå¿…è¦ã§ã™ã€‚è©³ç´°ã¯å’Œæ°—ã‚ã„AI4ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã‚’ã”ç¢ºèªãã ã•ã„ã€‚\",\n    },\n    {\n      question: \"ã©ã‚“ãªãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã‚’ä½œã‚Œã°è‰¯ã„ã§ã™ã‹ï¼Ÿ\",\n      answer:\n        \"ãƒãƒ­ã‚¦ã‚£ãƒ³ã‚’ãƒ†ãƒ¼ãƒã«ã—ãŸç”ŸæˆAIä½œå“ã§ã‚ã‚Œã°ä½•ã§ã‚‚OKã§ã™ã€‚ã‹ã‚ã„ã„ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã€ãƒ›ãƒ©ãƒ¼é¢¨æ™¯ã€ä»®è£…ã‚·ãƒ¼ãƒ³ãªã©è‡ªç”±ã«å‰µä½œã—ã¦ãã ã•ã„ã€‚\",\n    },\n  ]\n\n  const toggleFaq = (index: number) => {\n    setExpandedFaq(expandedFaq === index ? null : index)\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Hero Section */}\n      <div className=\"bg-gradient-to-r from-orange-600 to-purple-600 text-white\">\n        <div className=\"container mx-auto px-4 py-16 text-center\">\n          <div className=\"mx-auto max-w-4xl\">\n            <Badge\n              variant=\"secondary\"\n              className=\"mb-6 bg-yellow-400 px-6 py-2 font-bold text-black\"\n            >\n              {eventInfo.deadline}\n            </Badge>\n\n            <h1 className=\"mb-4 font-bold text-4xl drop-shadow-lg sm:text-5xl lg:text-6xl\">\n              ğŸƒ {eventInfo.title}\n            </h1>\n            <p className=\"mb-8 text-lg opacity-90 drop-shadow-lg sm:text-xl\">\n              {eventInfo.subtitle}\n            </p>\n            <div className=\"mb-8 flex flex-col items-center gap-4 sm:flex-row sm:justify-center\">\n              <div className=\"flex items-center gap-2\">\n                <CalendarIcon className=\"h-5 w-5\" />\n                <span className=\"font-semibold\">{eventInfo.date}</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <ClockIcon className=\"h-5 w-5\" />\n                <span>{eventInfo.time}</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <MapPinIcon className=\"h-5 w-5\" />\n                <span>{eventInfo.location}</span>\n              </div>\n            </div>\n            <div className=\"flex flex-col gap-4 sm:flex-row sm:justify-center\">\n              <Button\n                size=\"lg\"\n                className=\"transform border-2 border-orange-300 bg-gradient-to-r from-orange-500 to-orange-600 px-8 py-4 font-bold text-lg text-white shadow-xl transition-all duration-200 hover:scale-105 hover:from-orange-600 hover:to-orange-700\"\n                onClick={() => {\n                  document\n                    .getElementById(participationMethodsId)\n                    ?.scrollIntoView({ behavior: \"smooth\" })\n                }}\n              >\n                ğŸ¯ å‚åŠ æ–¹æ³•ã‚’è¦‹ã‚‹\n              </Button>\n              <Link to=\"/events/wakiaiai4\">\n                <Button\n                  size=\"lg\"\n                  variant=\"outline\"\n                  className=\"border-white bg-black px-8 py-4 font-bold text-lg backdrop-blur-sm hover:bg-white/20\"\n                >\n                  <ExternalLinkIcon className=\"mr-2 h-5 w-5\" />\n                  å’Œæ°—ã‚ã„AI4ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸\n                </Button>\n              </Link>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"container mx-auto space-y-12 px-4 py-12\">\n        {/* ä¼ç”»æ¦‚è¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}\n        <section>\n          <h2 className=\"mb-8 text-center font-bold text-2xl\">ä¼ç”»æ¦‚è¦</h2>\n          <Card className=\"border-2 border-orange-200 bg-gradient-to-r from-orange-50 to-purple-50\">\n            <CardContent className=\"p-8\">\n              <div className=\"space-y-6 text-center\">\n                <h3 className=\"font-bold text-orange-700 text-xl\">\n                  ã“ã‚Œã¯ä½•ã®ä¼ç”»ã§ã™ã‹ï¼Ÿ\n                </h3>\n                <div className=\"mx-auto max-w-4xl space-y-4 text-left\">\n                  <p className=\"text-lg\">\n                    ã“ã®ä¼ç”»ã¯\n                    <strong>AipictorsãŒä¸»å‚¬ã™ã‚‹ã‚µã‚¤ãƒˆå†…ä½œå“æŠ•ç¨¿ä¼ç”»</strong>\n                    ã§ã™ã€‚\n                  </p>\n                  <p>\n                    æŠ•ç¨¿ã•ã‚ŒãŸãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã®ä¸­ã‹ã‚‰ã€Aipictorsé‹å–¶ãŒå„ªç§€ä½œå“ã‚’é¸å®šã—ã€\n                    æ„›çŸ¥çœŒã§é–‹å‚¬ã•ã‚Œã‚‹ç”ŸæˆAIã‚¤ãƒ™ãƒ³ãƒˆã€Œå’Œæ°—ã‚ã„AI4ã€ã«ãŠã„ã¦\n                    <strong>\n                      Aipictorsã¨ã—ã¦å‡ºå±•ã™ã‚‹éš›ã®å±•ç¤ºä½œå“ãƒ»å†Šå­åéŒ²ä½œå“\n                    </strong>\n                    ã¨ã—ã¦ä½¿ç”¨ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚\n                  </p>\n                  <div className=\"rounded-lg border border-orange-200 bg-white/70 p-4\">\n                    <h4 className=\"mb-2 font-semibold text-orange-800\">\n                      å‚åŠ ã®æµã‚Œ\n                    </h4>\n                    <ol className=\"list-inside list-decimal space-y-1 text-sm\">\n                      <li>Aipictorsã«ãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã‚’æŒ‡å®šã‚¿ã‚°ä»˜ãã§æŠ•ç¨¿</li>\n                      <li>Aipictorsé‹å–¶ãŒå„ªç§€ä½œå“ã‚’é¸å®š</li>\n                      <li>\n                        é¸å®šä½œå“ãŒå’Œæ°—ã‚ã„AI4ä¼šå ´ã§Aipictorsãƒ–ãƒ¼ã‚¹ã«å±•ç¤ºãƒ»å†Šå­æ²è¼‰\n                      </li>\n                    </ol>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </section>\n\n        {/* Main Event Banner */}\n        <section className=\"text-center\">\n          <div className=\"mx-auto max-w-3xl\">\n            <EventWakiaiaiImage\n              alt=\"ãƒãƒ­ã‚¦ã‚£ãƒ³2025ä¼ç”»\"\n              imageURL=\"https://assets.aipictors.com/cc52625d-887c-46f4-afbc-757b7655797f.webp\"\n              linkTitle=\"Aipictors\"\n            />\n          </div>\n        </section>\n\n        {/* Features */}\n        <section>\n          <h2 className=\"mb-8 text-center font-bold text-2xl\">ä¼ç”»ã®ç‰¹å¾´</h2>\n          <div className=\"grid gap-6 md:grid-cols-3\">\n            {features.map((feature, index) => (\n              <Card key={index.toString()} className=\"text-center\">\n                <CardHeader>\n                  <div className=\"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-primary/10 text-primary\">\n                    {feature.icon}\n                  </div>\n                  <CardTitle className=\"text-lg\">{feature.title}</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-muted-foreground\">{feature.description}</p>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </section>\n\n        {/* Event Details */}\n        <section>\n          <h2 className=\"mb-8 text-center font-bold text-2xl\">\n            å±•ç¤ºäºˆå®šä¼šå ´ï¼ˆå’Œæ°—ã‚ã„AI4ï¼‰\n          </h2>\n          <Card className=\"border-2 border-blue-200\">\n            <CardHeader className=\"bg-blue-50\">\n              <CardTitle className=\"text-center text-blue-800\">\n                é¸å®šä½œå“ã®å±•ç¤ºä¼šå ´ã«ã¤ã„ã¦\n              </CardTitle>\n              <p className=\"mt-2 text-center text-blue-600 text-sm\">\n                ã“ã®ä¼ç”»ã§æŠ•ç¨¿ã•ã‚ŒãŸä½œå“ã®å„ªç§€ä½œå“ã¯ã€ä»¥ä¸‹ã®ä¼šå ´ã§Aipictorsã¨ã—ã¦å±•ç¤ºã•ã‚Œã‚‹äºˆå®šã§ã™\n              </p>\n            </CardHeader>\n            <CardContent className=\"p-8\">\n              <div className=\"grid gap-6 md:grid-cols-2\">\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <CalendarIcon className=\"h-5 w-5 text-blue-600\" />\n                    <div>\n                      <div className=\"font-semibold\">é–‹å‚¬æ—¥æ™‚</div>\n                      <div className=\"text-muted-foreground\">\n                        {eventInfo.date} {eventInfo.time}\n                      </div>\n                    </div>\n                  </div>\n                  <div className=\"flex items-start gap-3\">\n                    <MapPinIcon className=\"mt-1 h-5 w-5 text-blue-600\" />\n                    <div>\n                      <div className=\"font-semibold\">é–‹å‚¬å ´æ‰€</div>\n                      <div className=\"text-muted-foreground\">\n                        {eventInfo.location}\n                        <br />\n                        {eventInfo.address}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <ClockIcon className=\"h-5 w-5 text-blue-600\" />\n                    <div>\n                      <div className=\"font-semibold\">ã‚¢ã‚¯ã‚»ã‚¹</div>\n                      <div className=\"text-muted-foreground\">\n                        {eventInfo.access}\n                      </div>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center gap-3\">\n                    <UsersIcon className=\"h-5 w-5 text-blue-600\" />\n                    <div>\n                      <div className=\"font-semibold\">å…¥å ´æ–™</div>\n                      <div className=\"font-semibold text-muted-foreground\">\n                        {eventInfo.admission}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </section>\n\n        {/* Participation Methods */}\n        <section id={participationMethodsId}>\n          <h2 className=\"mb-8 text-center font-bold text-2xl\">\n            ä¼ç”»ã¸ã®å‚åŠ æ–¹æ³•\n          </h2>\n          <div className=\"mb-6\">\n            <Card className=\"border-orange-200 bg-orange-50 dark:border-orange-800 dark:bg-orange-950\">\n              <CardContent className=\"p-6\">\n                <div className=\"text-center\">\n                  <h3 className=\"mb-2 font-bold text-lg\">\n                    AipictorsæŠ•ç¨¿æ™‚ã®å¿…é ˆã‚¿ã‚°\n                  </h3>\n                  <Badge className=\"bg-orange-600 px-4 py-2 font-mono text-lg text-white\">\n                    {eventInfo.tag}\n                  </Badge>\n                  <p className=\"mt-2 text-muted-foreground text-sm\">\n                    ã“ã®ä¼ç”»ã«å‚åŠ ã™ã‚‹ã«ã¯ã€Aipictorsã«ä½œå“æŠ•ç¨¿æ™‚ã«ã“ã®ã‚¿ã‚°ã‚’å¿…ãšä»˜ã‘ã¦ãã ã•ã„\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n          <div className=\"grid gap-6 md:grid-cols-2\">\n            {participationMethods.map((method, index) => (\n              <Card key={index.toString()}>\n                <CardHeader>\n                  <div className=\"mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-primary/10 text-primary\">\n                    {method.icon}\n                  </div>\n                  <CardTitle className=\"text-lg\">{method.title}</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <p className=\"text-muted-foreground\">{method.description}</p>\n                  <Link\n                    to={method.link}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                  >\n                    <Button className=\"w-full\">\n                      <ExternalLinkIcon className=\"mr-2 h-4 w-4\" />\n                      {method.title === \"ã‚ªãƒ³ãƒ©ã‚¤ãƒ³æŠ•ç¨¿\"\n                        ? \"ä½œå“ã‚’æŠ•ç¨¿ã™ã‚‹\"\n                        : \"ç”³ã—è¾¼ã‚€\"}\n                    </Button>\n                  </Link>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </section>\n\n        {/* Ranking Works Section */}\n        {data.appEvent?.awardWorks && data.appEvent.awardWorks.length > 0 && (\n          <section>\n            <EventAwardWorkList\n              works={data.appEvent.awardWorks}\n              slug=\"halloween-2025\"\n            />\n          </section>\n        )}\n\n        {/* Works List */}\n        {data.appEvent?.works && (\n          <section>\n            <div className=\"mb-8 text-center\">\n              <h2 className=\"mb-4 font-bold text-2xl\">æŠ•ç¨¿ä½œå“</h2>\n              <div className=\"mx-auto mb-6 max-w-2xl rounded-lg border border-orange-200 bg-orange-50 p-4 dark:border-orange-800 dark:bg-orange-950/20\">\n                <Link\n                  to={`/tags/${encodeURIComponent(eventInfo.tag)}`}\n                  className=\"inline-block\"\n                >\n                  <Button\n                    variant=\"default\"\n                    size=\"lg\"\n                    className=\"bg-orange-600 hover:bg-orange-700\"\n                  >\n                    <BadgeIcon className=\"mr-2 h-4 w-4\" />\n                    {eventInfo.tag} ã®ã‚¿ã‚°ãƒšãƒ¼ã‚¸ã§å…¨ä½œå“ã‚’è¦‹ã‚‹\n                  </Button>\n                </Link>\n              </div>\n            </div>\n            <EventWorkList\n              works={data.appEvent.works}\n              maxCount={data.appEvent.worksCount}\n              page={data.page}\n              slug=\"halloween-2025\"\n              sort=\"DESC\"\n              orderBy=\"DATE_CREATED\"\n              workType={null}\n              rating={null}\n              sumWorksCount={data.appEvent.worksCount}\n              setWorkType={() => {}}\n              setRating={() => {}}\n              setSort={() => {}}\n              isHideSortableSetting={true}\n              onClickTitleSortButton={() => {}}\n              onClickLikeSortButton={() => {}}\n              onClickBookmarkSortButton={() => {}}\n              onClickCommentSortButton={() => {}}\n              onClickViewSortButton={() => {}}\n              onClickAccessTypeSortButton={() => {}}\n              onClickDateSortButton={() => {}}\n              onClickWorkTypeSortButton={() => {}}\n              onClickIsPromotionSortButton={() => {}}\n            />\n          </section>\n        )}\n\n        {/* FAQ */}\n        <section>\n          <h2 className=\"mb-8 text-center font-bold text-2xl\">ã‚ˆãã‚ã‚‹è³ªå•</h2>\n          <div className=\"space-y-4\">\n            {faqItems.map((item, index) => (\n              <Card key={index.toString()}>\n                <CardHeader\n                  className=\"cursor-pointer\"\n                  onClick={() => toggleFaq(index)}\n                >\n                  <div className=\"flex items-center justify-between\">\n                    <CardTitle className=\"text-lg\">{item.question}</CardTitle>\n                    {expandedFaq === index ? (\n                      <ChevronUpIcon className=\"h-5 w-5\" />\n                    ) : (\n                      <ChevronDownIcon className=\"h-5 w-5\" />\n                    )}\n                  </div>\n                </CardHeader>\n                {expandedFaq === index && (\n                  <CardContent className=\"pt-0\">\n                    <p className=\"text-muted-foreground\">{item.answer}</p>\n                  </CardContent>\n                )}\n              </Card>\n            ))}\n          </div>\n        </section>\n\n        {/* Call to Action */}\n        <section className=\"text-center\">\n          <Card className=\"bg-gradient-to-r from-orange-50 to-purple-50 dark:from-orange-950/20 dark:to-purple-950/20\">\n            <CardContent className=\"p-8\">\n              <h3 className=\"mb-4 font-bold text-2xl\">\n                å’Œæ°—ã‚ã„AI4ã§ä¼šã„ã¾ã—ã‚‡ã†ï¼\n              </h3>\n              <p className=\"mb-6 text-muted-foreground\">\n                ãƒãƒ­ã‚¦ã‚£ãƒ³ä¼ç”»ã¨åˆã‚ã›ã¦ã€ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã«ã‚‚ãœã²ã”å‚åŠ ãã ã•ã„\n              </p>\n              <div className=\"flex flex-col gap-4 sm:flex-row sm:justify-center\">\n                <Link to=\"/events/wakiaiai4\">\n                  <Button size=\"lg\" className=\"px-8 py-4\">\n                    <ExternalLinkIcon className=\"mr-2 h-5 w-5\" />\n                    å’Œæ°—ã‚ã„AI4è©³ç´°ã‚’è¦‹ã‚‹\n                  </Button>\n                </Link>\n                <Link\n                  to={`/new/image?event=wakiaiai4-halloween&tag=${encodeURIComponent(eventInfo.tag)}`}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  <Button size=\"lg\" variant=\"outline\" className=\"px-8 py-4\">\n                    <PaletteIcon className=\"mr-2 h-5 w-5\" />\n                    ä»Šã™ãä½œå“æŠ•ç¨¿\n                  </Button>\n                </Link>\n              </div>\n            </CardContent>\n          </Card>\n        </section>\n      </div>\n    </div>\n  )\n}\n{\n  /* Main Event Banner */\n}\n;<div className=\"text-center\">\n  <div className=\"mx-auto max-w-3xl\">\n    <EventWakiaiaiImage\n      alt=\"ãƒãƒ­ã‚¦ã‚£ãƒ³2025ä¼ç”»\"\n      imageURL=\"https://assets.aipictors.com/cc52625d-887c-46f4-afbc-757b7655797f.webp\"\n      linkTitle=\"Aipictors\"\n    />\n  </div>\n</div>\n\n{\n  /* Event Details */\n}\n;<div className=\"grid gap-8 md:grid-cols-2\">\n  <Card className=\"border-2 border-orange-300 bg-gradient-to-br from-orange-100 to-yellow-100 shadow-xl dark:from-orange-900/30 dark:to-yellow-900/30\">\n    <CardHeader className=\"text-center\">\n      <CardTitle className=\"font-bold text-2xl text-orange-600 dark:text-orange-400\">\n        <CalendarIcon className=\"mr-2 inline h-6 w-6\" />\n        é–‹å‚¬æœŸé–“\n      </CardTitle>\n    </CardHeader>\n    <CardContent className=\"space-y-4 text-center\">\n      <p className=\"font-semibold text-lg\">2025å¹´7æœˆ21æ—¥(æœˆ)ï½8æœˆ31æ—¥(æ—¥)</p>\n      <Badge className=\"bg-red-500 px-4 py-2 text-lg text-white\">\n        å¿œå‹Ÿå—ä»˜ä¸­ï¼\n      </Badge>\n    </CardContent>\n  </Card>\n\n  <Card className=\"border-2 border-purple-300 bg-gradient-to-br from-purple-100 to-pink-100 shadow-xl dark:from-purple-900/30 dark:to-pink-900/30\">\n    <CardHeader className=\"text-center\">\n      <CardTitle className=\"font-bold text-2xl text-purple-600 dark:text-purple-400\">\n        <MapPinIcon className=\"mr-2 inline h-6 w-6\" />\n        ã‚¤ãƒ™ãƒ³ãƒˆä¼šå ´\n      </CardTitle>\n    </CardHeader>\n    <CardContent className=\"space-y-4 text-center\">\n      <p className=\"text-lg\">\n        æ„›çŸ¥çœŒæ±æµ·å¸‚\n        <br />\n        å¤ªç”°å·é§…è¥¿åºƒå ´\n      </p>\n      <Link to=\"/events/wakiaiai4\">\n        <Button\n          variant=\"outline\"\n          className=\"border-purple-300 text-purple-600 hover:bg-purple-50\"\n        >\n          <ExternalLinkIcon className=\"mr-2 h-4 w-4\" />\n          ä¼šå ´è©³ç´°ã‚’è¦‹ã‚‹\n        </Button>\n      </Link>\n    </CardContent>\n  </Card>\n</div>\n\n{\n  /* Participation Method */\n}\n;<Card className=\"border-orange-200 bg-orange-50 dark:border-orange-800 dark:bg-orange-950\">\n  <CardHeader className=\"text-center\">\n    <CardTitle className=\"font-bold text-3xl\">å‚åŠ æ–¹æ³•</CardTitle>\n  </CardHeader>\n  <CardContent className=\"p-8\">\n    <div className=\"space-y-6 text-center\">\n      <div className=\"rounded-lg border-2 border-orange-300 bg-orange-200 p-6 dark:bg-orange-800/30\">\n        <h3 className=\"mb-4 font-bold text-2xl text-orange-700 dark:text-orange-300\">\n          å¿…é ˆã‚¿ã‚°\n        </h3>\n        <p className=\"font-bold text-3xl text-orange-900 dark:text-orange-100\">\n          ã€Œ!å’Œæ°—ã‚ã„AI2025ãƒãƒ­ã‚¦ã‚£ãƒ³ä¼ç”»ã€\n        </p>\n        <p className=\"mt-4 text-orange-700 dark:text-orange-300\">\n          ã“ã®ã‚¿ã‚°ã‚’ã¤ã‘ã¦ä½œå“ã‚’æŠ•ç¨¿ã™ã‚‹ã¨ã‚¤ãƒ™ãƒ³ãƒˆã«å‚åŠ ã§ãã¾ã™ï¼\n        </p>\n      </div>\n\n      <div className=\"grid gap-6 md:grid-cols-2\">\n        <div className=\"rounded-lg border-2 border-purple-300 bg-purple-100 p-6 dark:bg-purple-900/30\">\n          <h4 className=\"mb-3 font-bold text-purple-700 text-xl dark:text-purple-300\">\n            Aipictorsã¨ã—ã¦ã®ãƒã‚¹ã‚¿ãƒ¼å±•ç¤º\n          </h4>\n          <p className=\"text-purple-600 dark:text-purple-200\">\n            å„ªç§€ä½œå“ã¯Aipictorsé‹å–¶ãŒä½œæˆã™ã‚‹å’Œæ°—ã‚ã„AI4ã®ãƒã‚¹ã‚¿ãƒ¼ã«æ²è¼‰ã•ã‚Œã¾ã™\n          </p>\n        </div>\n\n        <div className=\"rounded-lg border-2 border-yellow-300 bg-yellow-100 p-6 dark:bg-yellow-900/30\">\n          <h4 className=\"mb-3 font-bold text-xl text-yellow-700 dark:text-yellow-300\">\n            Aipictorså†Šå­ã¸ã®æ²è¼‰\n          </h4>\n          <p className=\"text-yellow-600 dark:text-yellow-200\">\n            Aipictorsé‹å–¶ãŒä½œæˆã™ã‚‹å†Šå­ã«ã‚‚ä½œå“æ²è¼‰ã®ãƒãƒ£ãƒ³ã‚¹ãŒã‚ã‚Šã€ã‚¤ãƒ™ãƒ³ãƒˆä¼šå ´ã§é…å¸ƒãƒ»è²©å£²ã•ã‚Œã¾ã™\n          </p>\n        </div>\n      </div>\n\n      <div className=\"flex flex-col gap-4 sm:flex-row sm:justify-center\">\n        <Button\n          size=\"lg\"\n          className=\"transform bg-gradient-to-r from-orange-500 to-red-500 px-10 py-6 font-bold text-white text-xl shadow-xl transition-all duration-300 hover:scale-105 hover:from-orange-600 hover:to-red-600\"\n          onClick={() => {\n            const url = `/new/image?event=wakiaiai4-halloween&tag=${encodeURIComponent(\"!å’Œæ°—ã‚ã„AI2025ãƒãƒ­ã‚¦ã‚£ãƒ³ä¼ç”»\")}`\n            window.open(url, \"_blank\")\n          }}\n        >\n          ğŸƒ ä»Šã™ãä½œå“æŠ•ç¨¿\n        </Button>\n\n        <Link to=\"/events/wakiaiai4\">\n          <Button\n            size=\"lg\"\n            variant=\"outline\"\n            className=\"border-purple-300 px-10 py-6 font-bold text-purple-600 text-xl hover:bg-purple-50\"\n          >\n            ã‚¤ãƒ™ãƒ³ãƒˆè©³ç´°\n          </Button>\n        </Link>\n      </div>\n    </div>\n  </CardContent>\n</Card>\n\nexport const meta: MetaFunction = () => {\n  return [\n    { title: \"ãƒãƒ­ã‚¦ã‚£ãƒ³2025ä¼ç”» - å’Œæ°—ã‚ã„AI4é€£å‹•ç‰¹åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆ\" },\n    {\n      name: \"description\",\n      content:\n        \"å’Œæ°—ã‚ã„AI4ã¨é€£å‹•ã—ãŸãƒãƒ­ã‚¦ã‚£ãƒ³ç‰¹åˆ¥ä¼ç”»ã€‚ç”ŸæˆAIã‚’ä½¿ã£ã¦ç´ æ•µãªãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã‚’æŠ•ç¨¿ã—ã‚ˆã†ï¼\",\n    },\n  ]\n}\n\nconst appEventQuery = graphql(\n  `query AppEvent($slug: String!, $offset: Int!, $limit: Int!, $where: WorksWhereInput!) {\n    appEvent(slug: $slug) {\n      id\n      title\n      description\n      slug\n      worksCount\n      works(offset: $offset, limit: $limit, where: $where) {\n        ...EventWorkListItem\n      }\n      awardWorks(offset: 0, limit: 20, isSensitive: false) {\n        ...EventAwardWorkListItem\n      }\n    }\n  }`,\n  [EventWorkListItemFragment, EventAwardWorkListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/complexity/noUselessLoneBlockStatements","severity":"information","description":"This block statement doesn't serve any purpose and can be safely removed.","message":[{"elements":[],"content":"This block statement doesn't serve any purpose and can be safely removed."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Standalone block statements without any block-level declarations are redundant in JavaScript and can be removed to simplify the code."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).events.halloween-2025/route.tsx"},"span":[21935,21960],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"~/components/ui/card\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { EventWakiaiaiImage } from \"~/routes/events.wakiaiai/components/event-wakiaiai-image\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { Link, useLoaderData } from \"@remix-run/react\"\nimport {\n  CalendarIcon,\n  MapPinIcon,\n  UsersIcon,\n  PaletteIcon,\n  ExternalLinkIcon,\n  ImageIcon,\n  StoreIcon,\n  BadgeIcon,\n  ClockIcon,\n  ChevronDownIcon,\n  ChevronUpIcon,\n} from \"lucide-react\"\nimport { loaderClient } from \"~/lib/loader-client\"\nimport { graphql } from \"gql.tada\"\nimport {\n  EventWorkListItemFragment,\n  EventWorkList,\n} from \"~/routes/($lang).events.$event._index/components/event-work-list\"\nimport {\n  EventAwardWorkListItemFragment,\n  EventAwardWorkList,\n} from \"~/routes/($lang).events.$event._index/components/event-award-work-list\"\nimport { config } from \"~/config\"\nimport { useState, useId } from \"react\"\n\nexport async function loader(props: LoaderFunctionArgs) {\n  const event = \"halloween-2025\"\n\n  const urlParams = new URL(props.request.url).searchParams\n\n  const pageParam = urlParams.get(\"page\")\n\n  const page = pageParam ? Number(pageParam) : 0\n\n  const eventsResp = await loaderClient.query({\n    query: appEventQuery,\n    variables: {\n      limit: 64,\n      offset: page * 64,\n      slug: event,\n      where: {\n        ratings: [\"G\", \"R15\"],\n        isNowCreatedAt: true,\n      },\n    },\n  })\n\n  if (eventsResp.data.appEvent === null) {\n    // ãƒãƒ­ã‚¦ã‚£ãƒ³2025ã‚¤ãƒ™ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã§ã‚‚è¡¨ç¤ºã™ã‚‹\n    return {\n      appEvent: null,\n      page,\n    }\n  }\n\n  return {\n    appEvent: eventsResp.data.appEvent,\n    page,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneMonth,\n})\n\nexport default function EventHalloween2025 () {\n  const data = useLoaderData<typeof loader>()\n  const [expandedFaq, setExpandedFaq] = useState<number | null>(null)\n  const participationMethodsId = useId()\n\n  const eventInfo = {\n    title: \"ãƒãƒ­ã‚¦ã‚£ãƒ³2025ä¼ç”»\",\n    subtitle:\n      \"Aipictorsã‚µã‚¤ãƒˆå†…ä¼ç”»ï¼šå’Œæ°—ã‚ã„AI4ä¼šå ´ã§ã®å±•ç¤ºãƒ»å†Šå­æ²è¼‰ã‚’ç›®æŒ‡ã—ã¦ãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã‚’æŠ•ç¨¿ã—ã‚ˆã†ï¼\",\n    date: \"2025å¹´10æœˆ25æ—¥(åœŸ)\",\n    time: \"10:00ã€œ16:00\",\n    location: \"åå¤å±‹é‰„é“ å¤ªç”°å·é§…å‰ å¤§å±‹æ ¹åºƒå ´\",\n    address: \"æ„›çŸ¥çœŒæ±æµ·å¸‚å¤§ç”°ç”ºä¸‹æµœç”°137\",\n    access: \"å¤ªç”°å·é§…ã‹ã‚‰å¾’æ­©1åˆ†\",\n    admission: \"ç„¡æ–™\",\n    deadline: \"ä½œå“æŠ•ç¨¿æœŸé–“ï¼š2025å¹´7æœˆ21æ—¥ã€œ8æœˆ31æ—¥\",\n    tag: \"!å’Œæ°—ã‚ã„AI2025ãƒãƒ­ã‚¦ã‚£ãƒ³ä¼ç”»\",\n  }\n\n  const features = [\n    {\n      icon: <PaletteIcon className=\"h-6 w-6\" />,\n      title: \"Aipictorsã‚µã‚¤ãƒˆå†…ä¼ç”»\",\n      description:\n        \"å½“ä¼ç”»ã¯Aipictorsã‚µã‚¤ãƒˆå†…ã§ã®ä½œå“æŠ•ç¨¿ä¼ç”»ã§ã™ã€‚å„ªç§€ä½œå“ãŒãƒªã‚¢ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆã§å±•ç¤ºã•ã‚Œã¾ã™\",\n    },\n    {\n      icon: <ImageIcon className=\"h-6 w-6\" />,\n      title: \"å’Œæ°—ã‚ã„AI4ä¼šå ´ã§ã®å±•ç¤º\",\n      description:\n        \"æŠ•ç¨¿ä½œå“ã®ä¸­ã‹ã‚‰å„ªç§€ä½œå“ãŒæ„›çŸ¥çœŒã®å®Ÿéš›ã®ã‚¤ãƒ™ãƒ³ãƒˆä¼šå ´ã§å±•ç¤ºã•ã‚Œã¾ã™\",\n    },\n    {\n      icon: <UsersIcon className=\"h-6 w-6\" />,\n      title: \"å†Šå­æ²è¼‰ã®ãƒãƒ£ãƒ³ã‚¹\",\n      description:\n        \"Aipictorsé‹å–¶ãŒä½œæˆã™ã‚‹å†Šå­ã¸ã®æ²è¼‰æ©Ÿä¼šãŒã‚ã‚Šã€ã‚¤ãƒ™ãƒ³ãƒˆä¼šå ´ã§é…å¸ƒãƒ»è²©å£²ã•ã‚Œã¾ã™\",\n    },\n  ]\n\n  const participationMethods = [\n    {\n      title: \"ã‚ªãƒ³ãƒ©ã‚¤ãƒ³æŠ•ç¨¿\",\n      description:\n        \"Aipictorsã«ã€Œ!å’Œæ°—ã‚ã„AI2025ãƒãƒ­ã‚¦ã‚£ãƒ³ä¼ç”»ã€ã‚¿ã‚°ä»˜ãã§ãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã‚’æŠ•ç¨¿ã—ã¦ãã ã•ã„ã€‚å„ªç§€ä½œå“ãŒå’Œæ°—ã‚ã„AI4ä¼šå ´ã§å±•ç¤ºã•ã‚Œã¾ã™ã€‚\",\n      icon: <BadgeIcon className=\"h-6 w-6\" />,\n      link: `/new/image?event=wakiaiai4-halloween&tag=${encodeURIComponent(eventInfo.tag)}`,\n    },\n    {\n      title: \"ãƒªã‚¢ãƒ«å‡ºå±•ï¼ˆåˆ¥ç”³è¾¼ï¼‰\",\n      description:\n        \"å’Œæ°—ã‚ã„AI4ã‚¤ãƒ™ãƒ³ãƒˆã«ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã¨ã—ã¦ç›´æ¥å‡ºå±•ã—ãŸã„å ´åˆã¯ã€åˆ¥é€”å’Œæ°—ã‚ã„AI4ã®å‡ºå±•ç”³è¾¼ãŒå¿…è¦ã§ã™ã€‚\",\n      icon: <StoreIcon className=\"h-6 w-6\" />,\n      link: \"/events/wakiaiai4\",\n    },\n  ]\n\n  const faqItems = [\n    {\n      question: \"ã“ã®ä¼ç”»ã¯ä½•ã§ã™ã‹ï¼Ÿ\",\n      answer:\n        \"AipictorsãŒä¸»å‚¬ã™ã‚‹ã‚µã‚¤ãƒˆå†…ä½œå“æŠ•ç¨¿ä¼ç”»ã§ã™ã€‚æŠ•ç¨¿ã•ã‚ŒãŸä½œå“ã®ä¸­ã‹ã‚‰å„ªç§€ä½œå“ã‚’é¸å®šã—ã€æ„›çŸ¥çœŒã§é–‹å‚¬ã•ã‚Œã‚‹ãƒªã‚¢ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆã€Œå’Œæ°—ã‚ã„AI4ã€ã®ä¼šå ´ã§å±•ç¤ºãƒ»å†Šå­æ²è¼‰ã‚’è¡Œã„ã¾ã™ã€‚\",\n    },\n    {\n      question: \"èª°ãŒä½œå“ã‚’é¸å®šãƒ»å±•ç¤ºã™ã‚‹ã®ã§ã™ã‹ï¼Ÿ\",\n      answer:\n        \"Aipictorsé‹å–¶ãŒä½œå“ã‚’é¸å®šã—ã€å’Œæ°—ã‚ã„AI4ã‚¤ãƒ™ãƒ³ãƒˆã«Aipictorsã¨ã—ã¦å‡ºå±•ã™ã‚‹éš›ã®å±•ç¤ºå†…å®¹ãƒ»å†Šå­åéŒ²ä½œå“ã¨ã—ã¦ä½¿ç”¨ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚\",\n    },\n    {\n      question: \"å‚åŠ æ–¹æ³•ã‚’æ•™ãˆã¦ãã ã•ã„\",\n      answer: `Aipictorsã‚µã‚¤ãƒˆã«ãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã‚’æŠ•ç¨¿ã™ã‚‹éš›ã€å¿…ãšã€Œ${eventInfo.tag}ã€ã‚¿ã‚°ã‚’ä»˜ã‘ã¦ãã ã•ã„ã€‚ã“ã®ä¼ç”»ã¸ã®å‚åŠ ã¯ã‚µã‚¤ãƒˆå†…æŠ•ç¨¿ã®ã¿ã¨ãªã‚Šã¾ã™ã€‚`,\n    },\n    {\n      question: \"ç›´æ¥ã‚¤ãƒ™ãƒ³ãƒˆä¼šå ´ã«å‡ºå±•ã—ãŸã„å ´åˆã¯ï¼Ÿ\",\n      answer:\n        \"ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼å€‹äººã¨ã—ã¦å’Œæ°—ã‚ã„AI4ã«å‡ºå±•ã—ãŸã„å ´åˆã¯ã€ã“ã®ä¼ç”»ã¨ã¯åˆ¥ã«å’Œæ°—ã‚ã„AI4ã®å‡ºå±•ç”³è¾¼ãŒå¿…è¦ã§ã™ã€‚è©³ç´°ã¯å’Œæ°—ã‚ã„AI4ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã‚’ã”ç¢ºèªãã ã•ã„ã€‚\",\n    },\n    {\n      question: \"ã©ã‚“ãªãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã‚’ä½œã‚Œã°è‰¯ã„ã§ã™ã‹ï¼Ÿ\",\n      answer:\n        \"ãƒãƒ­ã‚¦ã‚£ãƒ³ã‚’ãƒ†ãƒ¼ãƒã«ã—ãŸç”ŸæˆAIä½œå“ã§ã‚ã‚Œã°ä½•ã§ã‚‚OKã§ã™ã€‚ã‹ã‚ã„ã„ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã€ãƒ›ãƒ©ãƒ¼é¢¨æ™¯ã€ä»®è£…ã‚·ãƒ¼ãƒ³ãªã©è‡ªç”±ã«å‰µä½œã—ã¦ãã ã•ã„ã€‚\",\n    },\n  ]\n\n  const toggleFaq = (index: number) => {\n    setExpandedFaq(expandedFaq === index ? null : index)\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Hero Section */}\n      <div className=\"bg-gradient-to-r from-orange-600 to-purple-600 text-white\">\n        <div className=\"container mx-auto px-4 py-16 text-center\">\n          <div className=\"mx-auto max-w-4xl\">\n            <Badge\n              variant=\"secondary\"\n              className=\"mb-6 bg-yellow-400 px-6 py-2 font-bold text-black\"\n            >\n              {eventInfo.deadline}\n            </Badge>\n\n            <h1 className=\"mb-4 font-bold text-4xl drop-shadow-lg sm:text-5xl lg:text-6xl\">\n              ğŸƒ {eventInfo.title}\n            </h1>\n            <p className=\"mb-8 text-lg opacity-90 drop-shadow-lg sm:text-xl\">\n              {eventInfo.subtitle}\n            </p>\n            <div className=\"mb-8 flex flex-col items-center gap-4 sm:flex-row sm:justify-center\">\n              <div className=\"flex items-center gap-2\">\n                <CalendarIcon className=\"h-5 w-5\" />\n                <span className=\"font-semibold\">{eventInfo.date}</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <ClockIcon className=\"h-5 w-5\" />\n                <span>{eventInfo.time}</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <MapPinIcon className=\"h-5 w-5\" />\n                <span>{eventInfo.location}</span>\n              </div>\n            </div>\n            <div className=\"flex flex-col gap-4 sm:flex-row sm:justify-center\">\n              <Button\n                size=\"lg\"\n                className=\"transform border-2 border-orange-300 bg-gradient-to-r from-orange-500 to-orange-600 px-8 py-4 font-bold text-lg text-white shadow-xl transition-all duration-200 hover:scale-105 hover:from-orange-600 hover:to-orange-700\"\n                onClick={() => {\n                  document\n                    .getElementById(participationMethodsId)\n                    ?.scrollIntoView({ behavior: \"smooth\" })\n                }}\n              >\n                ğŸ¯ å‚åŠ æ–¹æ³•ã‚’è¦‹ã‚‹\n              </Button>\n              <Link to=\"/events/wakiaiai4\">\n                <Button\n                  size=\"lg\"\n                  variant=\"outline\"\n                  className=\"border-white bg-black px-8 py-4 font-bold text-lg backdrop-blur-sm hover:bg-white/20\"\n                >\n                  <ExternalLinkIcon className=\"mr-2 h-5 w-5\" />\n                  å’Œæ°—ã‚ã„AI4ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸\n                </Button>\n              </Link>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"container mx-auto space-y-12 px-4 py-12\">\n        {/* ä¼ç”»æ¦‚è¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}\n        <section>\n          <h2 className=\"mb-8 text-center font-bold text-2xl\">ä¼ç”»æ¦‚è¦</h2>\n          <Card className=\"border-2 border-orange-200 bg-gradient-to-r from-orange-50 to-purple-50\">\n            <CardContent className=\"p-8\">\n              <div className=\"space-y-6 text-center\">\n                <h3 className=\"font-bold text-orange-700 text-xl\">\n                  ã“ã‚Œã¯ä½•ã®ä¼ç”»ã§ã™ã‹ï¼Ÿ\n                </h3>\n                <div className=\"mx-auto max-w-4xl space-y-4 text-left\">\n                  <p className=\"text-lg\">\n                    ã“ã®ä¼ç”»ã¯\n                    <strong>AipictorsãŒä¸»å‚¬ã™ã‚‹ã‚µã‚¤ãƒˆå†…ä½œå“æŠ•ç¨¿ä¼ç”»</strong>\n                    ã§ã™ã€‚\n                  </p>\n                  <p>\n                    æŠ•ç¨¿ã•ã‚ŒãŸãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã®ä¸­ã‹ã‚‰ã€Aipictorsé‹å–¶ãŒå„ªç§€ä½œå“ã‚’é¸å®šã—ã€\n                    æ„›çŸ¥çœŒã§é–‹å‚¬ã•ã‚Œã‚‹ç”ŸæˆAIã‚¤ãƒ™ãƒ³ãƒˆã€Œå’Œæ°—ã‚ã„AI4ã€ã«ãŠã„ã¦\n                    <strong>\n                      Aipictorsã¨ã—ã¦å‡ºå±•ã™ã‚‹éš›ã®å±•ç¤ºä½œå“ãƒ»å†Šå­åéŒ²ä½œå“\n                    </strong>\n                    ã¨ã—ã¦ä½¿ç”¨ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚\n                  </p>\n                  <div className=\"rounded-lg border border-orange-200 bg-white/70 p-4\">\n                    <h4 className=\"mb-2 font-semibold text-orange-800\">\n                      å‚åŠ ã®æµã‚Œ\n                    </h4>\n                    <ol className=\"list-inside list-decimal space-y-1 text-sm\">\n                      <li>Aipictorsã«ãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã‚’æŒ‡å®šã‚¿ã‚°ä»˜ãã§æŠ•ç¨¿</li>\n                      <li>Aipictorsé‹å–¶ãŒå„ªç§€ä½œå“ã‚’é¸å®š</li>\n                      <li>\n                        é¸å®šä½œå“ãŒå’Œæ°—ã‚ã„AI4ä¼šå ´ã§Aipictorsãƒ–ãƒ¼ã‚¹ã«å±•ç¤ºãƒ»å†Šå­æ²è¼‰\n                      </li>\n                    </ol>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </section>\n\n        {/* Main Event Banner */}\n        <section className=\"text-center\">\n          <div className=\"mx-auto max-w-3xl\">\n            <EventWakiaiaiImage\n              alt=\"ãƒãƒ­ã‚¦ã‚£ãƒ³2025ä¼ç”»\"\n              imageURL=\"https://assets.aipictors.com/cc52625d-887c-46f4-afbc-757b7655797f.webp\"\n              linkTitle=\"Aipictors\"\n            />\n          </div>\n        </section>\n\n        {/* Features */}\n        <section>\n          <h2 className=\"mb-8 text-center font-bold text-2xl\">ä¼ç”»ã®ç‰¹å¾´</h2>\n          <div className=\"grid gap-6 md:grid-cols-3\">\n            {features.map((feature, index) => (\n              <Card key={index.toString()} className=\"text-center\">\n                <CardHeader>\n                  <div className=\"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-primary/10 text-primary\">\n                    {feature.icon}\n                  </div>\n                  <CardTitle className=\"text-lg\">{feature.title}</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-muted-foreground\">{feature.description}</p>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </section>\n\n        {/* Event Details */}\n        <section>\n          <h2 className=\"mb-8 text-center font-bold text-2xl\">\n            å±•ç¤ºäºˆå®šä¼šå ´ï¼ˆå’Œæ°—ã‚ã„AI4ï¼‰\n          </h2>\n          <Card className=\"border-2 border-blue-200\">\n            <CardHeader className=\"bg-blue-50\">\n              <CardTitle className=\"text-center text-blue-800\">\n                é¸å®šä½œå“ã®å±•ç¤ºä¼šå ´ã«ã¤ã„ã¦\n              </CardTitle>\n              <p className=\"mt-2 text-center text-blue-600 text-sm\">\n                ã“ã®ä¼ç”»ã§æŠ•ç¨¿ã•ã‚ŒãŸä½œå“ã®å„ªç§€ä½œå“ã¯ã€ä»¥ä¸‹ã®ä¼šå ´ã§Aipictorsã¨ã—ã¦å±•ç¤ºã•ã‚Œã‚‹äºˆå®šã§ã™\n              </p>\n            </CardHeader>\n            <CardContent className=\"p-8\">\n              <div className=\"grid gap-6 md:grid-cols-2\">\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <CalendarIcon className=\"h-5 w-5 text-blue-600\" />\n                    <div>\n                      <div className=\"font-semibold\">é–‹å‚¬æ—¥æ™‚</div>\n                      <div className=\"text-muted-foreground\">\n                        {eventInfo.date} {eventInfo.time}\n                      </div>\n                    </div>\n                  </div>\n                  <div className=\"flex items-start gap-3\">\n                    <MapPinIcon className=\"mt-1 h-5 w-5 text-blue-600\" />\n                    <div>\n                      <div className=\"font-semibold\">é–‹å‚¬å ´æ‰€</div>\n                      <div className=\"text-muted-foreground\">\n                        {eventInfo.location}\n                        <br />\n                        {eventInfo.address}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <ClockIcon className=\"h-5 w-5 text-blue-600\" />\n                    <div>\n                      <div className=\"font-semibold\">ã‚¢ã‚¯ã‚»ã‚¹</div>\n                      <div className=\"text-muted-foreground\">\n                        {eventInfo.access}\n                      </div>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center gap-3\">\n                    <UsersIcon className=\"h-5 w-5 text-blue-600\" />\n                    <div>\n                      <div className=\"font-semibold\">å…¥å ´æ–™</div>\n                      <div className=\"font-semibold text-muted-foreground\">\n                        {eventInfo.admission}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </section>\n\n        {/* Participation Methods */}\n        <section id={participationMethodsId}>\n          <h2 className=\"mb-8 text-center font-bold text-2xl\">\n            ä¼ç”»ã¸ã®å‚åŠ æ–¹æ³•\n          </h2>\n          <div className=\"mb-6\">\n            <Card className=\"border-orange-200 bg-orange-50 dark:border-orange-800 dark:bg-orange-950\">\n              <CardContent className=\"p-6\">\n                <div className=\"text-center\">\n                  <h3 className=\"mb-2 font-bold text-lg\">\n                    AipictorsæŠ•ç¨¿æ™‚ã®å¿…é ˆã‚¿ã‚°\n                  </h3>\n                  <Badge className=\"bg-orange-600 px-4 py-2 font-mono text-lg text-white\">\n                    {eventInfo.tag}\n                  </Badge>\n                  <p className=\"mt-2 text-muted-foreground text-sm\">\n                    ã“ã®ä¼ç”»ã«å‚åŠ ã™ã‚‹ã«ã¯ã€Aipictorsã«ä½œå“æŠ•ç¨¿æ™‚ã«ã“ã®ã‚¿ã‚°ã‚’å¿…ãšä»˜ã‘ã¦ãã ã•ã„\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n          <div className=\"grid gap-6 md:grid-cols-2\">\n            {participationMethods.map((method, index) => (\n              <Card key={index.toString()}>\n                <CardHeader>\n                  <div className=\"mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-primary/10 text-primary\">\n                    {method.icon}\n                  </div>\n                  <CardTitle className=\"text-lg\">{method.title}</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <p className=\"text-muted-foreground\">{method.description}</p>\n                  <Link\n                    to={method.link}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                  >\n                    <Button className=\"w-full\">\n                      <ExternalLinkIcon className=\"mr-2 h-4 w-4\" />\n                      {method.title === \"ã‚ªãƒ³ãƒ©ã‚¤ãƒ³æŠ•ç¨¿\"\n                        ? \"ä½œå“ã‚’æŠ•ç¨¿ã™ã‚‹\"\n                        : \"ç”³ã—è¾¼ã‚€\"}\n                    </Button>\n                  </Link>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </section>\n\n        {/* Ranking Works Section */}\n        {data.appEvent?.awardWorks && data.appEvent.awardWorks.length > 0 && (\n          <section>\n            <EventAwardWorkList\n              works={data.appEvent.awardWorks}\n              slug=\"halloween-2025\"\n            />\n          </section>\n        )}\n\n        {/* Works List */}\n        {data.appEvent?.works && (\n          <section>\n            <div className=\"mb-8 text-center\">\n              <h2 className=\"mb-4 font-bold text-2xl\">æŠ•ç¨¿ä½œå“</h2>\n              <div className=\"mx-auto mb-6 max-w-2xl rounded-lg border border-orange-200 bg-orange-50 p-4 dark:border-orange-800 dark:bg-orange-950/20\">\n                <Link\n                  to={`/tags/${encodeURIComponent(eventInfo.tag)}`}\n                  className=\"inline-block\"\n                >\n                  <Button\n                    variant=\"default\"\n                    size=\"lg\"\n                    className=\"bg-orange-600 hover:bg-orange-700\"\n                  >\n                    <BadgeIcon className=\"mr-2 h-4 w-4\" />\n                    {eventInfo.tag} ã®ã‚¿ã‚°ãƒšãƒ¼ã‚¸ã§å…¨ä½œå“ã‚’è¦‹ã‚‹\n                  </Button>\n                </Link>\n              </div>\n            </div>\n            <EventWorkList\n              works={data.appEvent.works}\n              maxCount={data.appEvent.worksCount}\n              page={data.page}\n              slug=\"halloween-2025\"\n              sort=\"DESC\"\n              orderBy=\"DATE_CREATED\"\n              workType={null}\n              rating={null}\n              sumWorksCount={data.appEvent.worksCount}\n              setWorkType={() => {}}\n              setRating={() => {}}\n              setSort={() => {}}\n              isHideSortableSetting={true}\n              onClickTitleSortButton={() => {}}\n              onClickLikeSortButton={() => {}}\n              onClickBookmarkSortButton={() => {}}\n              onClickCommentSortButton={() => {}}\n              onClickViewSortButton={() => {}}\n              onClickAccessTypeSortButton={() => {}}\n              onClickDateSortButton={() => {}}\n              onClickWorkTypeSortButton={() => {}}\n              onClickIsPromotionSortButton={() => {}}\n            />\n          </section>\n        )}\n\n        {/* FAQ */}\n        <section>\n          <h2 className=\"mb-8 text-center font-bold text-2xl\">ã‚ˆãã‚ã‚‹è³ªå•</h2>\n          <div className=\"space-y-4\">\n            {faqItems.map((item, index) => (\n              <Card key={index.toString()}>\n                <CardHeader\n                  className=\"cursor-pointer\"\n                  onClick={() => toggleFaq(index)}\n                >\n                  <div className=\"flex items-center justify-between\">\n                    <CardTitle className=\"text-lg\">{item.question}</CardTitle>\n                    {expandedFaq === index ? (\n                      <ChevronUpIcon className=\"h-5 w-5\" />\n                    ) : (\n                      <ChevronDownIcon className=\"h-5 w-5\" />\n                    )}\n                  </div>\n                </CardHeader>\n                {expandedFaq === index && (\n                  <CardContent className=\"pt-0\">\n                    <p className=\"text-muted-foreground\">{item.answer}</p>\n                  </CardContent>\n                )}\n              </Card>\n            ))}\n          </div>\n        </section>\n\n        {/* Call to Action */}\n        <section className=\"text-center\">\n          <Card className=\"bg-gradient-to-r from-orange-50 to-purple-50 dark:from-orange-950/20 dark:to-purple-950/20\">\n            <CardContent className=\"p-8\">\n              <h3 className=\"mb-4 font-bold text-2xl\">\n                å’Œæ°—ã‚ã„AI4ã§ä¼šã„ã¾ã—ã‚‡ã†ï¼\n              </h3>\n              <p className=\"mb-6 text-muted-foreground\">\n                ãƒãƒ­ã‚¦ã‚£ãƒ³ä¼ç”»ã¨åˆã‚ã›ã¦ã€ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã«ã‚‚ãœã²ã”å‚åŠ ãã ã•ã„\n              </p>\n              <div className=\"flex flex-col gap-4 sm:flex-row sm:justify-center\">\n                <Link to=\"/events/wakiaiai4\">\n                  <Button size=\"lg\" className=\"px-8 py-4\">\n                    <ExternalLinkIcon className=\"mr-2 h-5 w-5\" />\n                    å’Œæ°—ã‚ã„AI4è©³ç´°ã‚’è¦‹ã‚‹\n                  </Button>\n                </Link>\n                <Link\n                  to={`/new/image?event=wakiaiai4-halloween&tag=${encodeURIComponent(eventInfo.tag)}`}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  <Button size=\"lg\" variant=\"outline\" className=\"px-8 py-4\">\n                    <PaletteIcon className=\"mr-2 h-5 w-5\" />\n                    ä»Šã™ãä½œå“æŠ•ç¨¿\n                  </Button>\n                </Link>\n              </div>\n            </CardContent>\n          </Card>\n        </section>\n      </div>\n    </div>\n  )\n}\n{\n  /* Main Event Banner */\n}\n;<div className=\"text-center\">\n  <div className=\"mx-auto max-w-3xl\">\n    <EventWakiaiaiImage\n      alt=\"ãƒãƒ­ã‚¦ã‚£ãƒ³2025ä¼ç”»\"\n      imageURL=\"https://assets.aipictors.com/cc52625d-887c-46f4-afbc-757b7655797f.webp\"\n      linkTitle=\"Aipictors\"\n    />\n  </div>\n</div>\n\n{\n  /* Event Details */\n}\n;<div className=\"grid gap-8 md:grid-cols-2\">\n  <Card className=\"border-2 border-orange-300 bg-gradient-to-br from-orange-100 to-yellow-100 shadow-xl dark:from-orange-900/30 dark:to-yellow-900/30\">\n    <CardHeader className=\"text-center\">\n      <CardTitle className=\"font-bold text-2xl text-orange-600 dark:text-orange-400\">\n        <CalendarIcon className=\"mr-2 inline h-6 w-6\" />\n        é–‹å‚¬æœŸé–“\n      </CardTitle>\n    </CardHeader>\n    <CardContent className=\"space-y-4 text-center\">\n      <p className=\"font-semibold text-lg\">2025å¹´7æœˆ21æ—¥(æœˆ)ï½8æœˆ31æ—¥(æ—¥)</p>\n      <Badge className=\"bg-red-500 px-4 py-2 text-lg text-white\">\n        å¿œå‹Ÿå—ä»˜ä¸­ï¼\n      </Badge>\n    </CardContent>\n  </Card>\n\n  <Card className=\"border-2 border-purple-300 bg-gradient-to-br from-purple-100 to-pink-100 shadow-xl dark:from-purple-900/30 dark:to-pink-900/30\">\n    <CardHeader className=\"text-center\">\n      <CardTitle className=\"font-bold text-2xl text-purple-600 dark:text-purple-400\">\n        <MapPinIcon className=\"mr-2 inline h-6 w-6\" />\n        ã‚¤ãƒ™ãƒ³ãƒˆä¼šå ´\n      </CardTitle>\n    </CardHeader>\n    <CardContent className=\"space-y-4 text-center\">\n      <p className=\"text-lg\">\n        æ„›çŸ¥çœŒæ±æµ·å¸‚\n        <br />\n        å¤ªç”°å·é§…è¥¿åºƒå ´\n      </p>\n      <Link to=\"/events/wakiaiai4\">\n        <Button\n          variant=\"outline\"\n          className=\"border-purple-300 text-purple-600 hover:bg-purple-50\"\n        >\n          <ExternalLinkIcon className=\"mr-2 h-4 w-4\" />\n          ä¼šå ´è©³ç´°ã‚’è¦‹ã‚‹\n        </Button>\n      </Link>\n    </CardContent>\n  </Card>\n</div>\n\n{\n  /* Participation Method */\n}\n;<Card className=\"border-orange-200 bg-orange-50 dark:border-orange-800 dark:bg-orange-950\">\n  <CardHeader className=\"text-center\">\n    <CardTitle className=\"font-bold text-3xl\">å‚åŠ æ–¹æ³•</CardTitle>\n  </CardHeader>\n  <CardContent className=\"p-8\">\n    <div className=\"space-y-6 text-center\">\n      <div className=\"rounded-lg border-2 border-orange-300 bg-orange-200 p-6 dark:bg-orange-800/30\">\n        <h3 className=\"mb-4 font-bold text-2xl text-orange-700 dark:text-orange-300\">\n          å¿…é ˆã‚¿ã‚°\n        </h3>\n        <p className=\"font-bold text-3xl text-orange-900 dark:text-orange-100\">\n          ã€Œ!å’Œæ°—ã‚ã„AI2025ãƒãƒ­ã‚¦ã‚£ãƒ³ä¼ç”»ã€\n        </p>\n        <p className=\"mt-4 text-orange-700 dark:text-orange-300\">\n          ã“ã®ã‚¿ã‚°ã‚’ã¤ã‘ã¦ä½œå“ã‚’æŠ•ç¨¿ã™ã‚‹ã¨ã‚¤ãƒ™ãƒ³ãƒˆã«å‚åŠ ã§ãã¾ã™ï¼\n        </p>\n      </div>\n\n      <div className=\"grid gap-6 md:grid-cols-2\">\n        <div className=\"rounded-lg border-2 border-purple-300 bg-purple-100 p-6 dark:bg-purple-900/30\">\n          <h4 className=\"mb-3 font-bold text-purple-700 text-xl dark:text-purple-300\">\n            Aipictorsã¨ã—ã¦ã®ãƒã‚¹ã‚¿ãƒ¼å±•ç¤º\n          </h4>\n          <p className=\"text-purple-600 dark:text-purple-200\">\n            å„ªç§€ä½œå“ã¯Aipictorsé‹å–¶ãŒä½œæˆã™ã‚‹å’Œæ°—ã‚ã„AI4ã®ãƒã‚¹ã‚¿ãƒ¼ã«æ²è¼‰ã•ã‚Œã¾ã™\n          </p>\n        </div>\n\n        <div className=\"rounded-lg border-2 border-yellow-300 bg-yellow-100 p-6 dark:bg-yellow-900/30\">\n          <h4 className=\"mb-3 font-bold text-xl text-yellow-700 dark:text-yellow-300\">\n            Aipictorså†Šå­ã¸ã®æ²è¼‰\n          </h4>\n          <p className=\"text-yellow-600 dark:text-yellow-200\">\n            Aipictorsé‹å–¶ãŒä½œæˆã™ã‚‹å†Šå­ã«ã‚‚ä½œå“æ²è¼‰ã®ãƒãƒ£ãƒ³ã‚¹ãŒã‚ã‚Šã€ã‚¤ãƒ™ãƒ³ãƒˆä¼šå ´ã§é…å¸ƒãƒ»è²©å£²ã•ã‚Œã¾ã™\n          </p>\n        </div>\n      </div>\n\n      <div className=\"flex flex-col gap-4 sm:flex-row sm:justify-center\">\n        <Button\n          size=\"lg\"\n          className=\"transform bg-gradient-to-r from-orange-500 to-red-500 px-10 py-6 font-bold text-white text-xl shadow-xl transition-all duration-300 hover:scale-105 hover:from-orange-600 hover:to-red-600\"\n          onClick={() => {\n            const url = `/new/image?event=wakiaiai4-halloween&tag=${encodeURIComponent(\"!å’Œæ°—ã‚ã„AI2025ãƒãƒ­ã‚¦ã‚£ãƒ³ä¼ç”»\")}`\n            window.open(url, \"_blank\")\n          }}\n        >\n          ğŸƒ ä»Šã™ãä½œå“æŠ•ç¨¿\n        </Button>\n\n        <Link to=\"/events/wakiaiai4\">\n          <Button\n            size=\"lg\"\n            variant=\"outline\"\n            className=\"border-purple-300 px-10 py-6 font-bold text-purple-600 text-xl hover:bg-purple-50\"\n          >\n            ã‚¤ãƒ™ãƒ³ãƒˆè©³ç´°\n          </Button>\n        </Link>\n      </div>\n    </div>\n  </CardContent>\n</Card>\n\nexport const meta: MetaFunction = () => {\n  return [\n    { title: \"ãƒãƒ­ã‚¦ã‚£ãƒ³2025ä¼ç”» - å’Œæ°—ã‚ã„AI4é€£å‹•ç‰¹åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆ\" },\n    {\n      name: \"description\",\n      content:\n        \"å’Œæ°—ã‚ã„AI4ã¨é€£å‹•ã—ãŸãƒãƒ­ã‚¦ã‚£ãƒ³ç‰¹åˆ¥ä¼ç”»ã€‚ç”ŸæˆAIã‚’ä½¿ã£ã¦ç´ æ•µãªãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã‚’æŠ•ç¨¿ã—ã‚ˆã†ï¼\",\n    },\n  ]\n}\n\nconst appEventQuery = graphql(\n  `query AppEvent($slug: String!, $offset: Int!, $limit: Int!, $where: WorksWhereInput!) {\n    appEvent(slug: $slug) {\n      id\n      title\n      description\n      slug\n      worksCount\n      works(offset: $offset, limit: $limit, where: $where) {\n        ...EventWorkListItem\n      }\n      awardWorks(offset: 0, limit: 20, isSensitive: false) {\n        ...EventAwardWorkListItem\n      }\n    }\n  }`,\n  [EventWorkListItemFragment, EventAwardWorkListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/complexity/noUselessLoneBlockStatements","severity":"information","description":"This block statement doesn't serve any purpose and can be safely removed.","message":[{"elements":[],"content":"This block statement doesn't serve any purpose and can be safely removed."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Standalone block statements without any block-level declarations are redundant in JavaScript and can be removed to simplify the code."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).events.halloween-2025/route.tsx"},"span":[23557,23589],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"~/components/ui/card\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { EventWakiaiaiImage } from \"~/routes/events.wakiaiai/components/event-wakiaiai-image\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { Link, useLoaderData } from \"@remix-run/react\"\nimport {\n  CalendarIcon,\n  MapPinIcon,\n  UsersIcon,\n  PaletteIcon,\n  ExternalLinkIcon,\n  ImageIcon,\n  StoreIcon,\n  BadgeIcon,\n  ClockIcon,\n  ChevronDownIcon,\n  ChevronUpIcon,\n} from \"lucide-react\"\nimport { loaderClient } from \"~/lib/loader-client\"\nimport { graphql } from \"gql.tada\"\nimport {\n  EventWorkListItemFragment,\n  EventWorkList,\n} from \"~/routes/($lang).events.$event._index/components/event-work-list\"\nimport {\n  EventAwardWorkListItemFragment,\n  EventAwardWorkList,\n} from \"~/routes/($lang).events.$event._index/components/event-award-work-list\"\nimport { config } from \"~/config\"\nimport { useState, useId } from \"react\"\n\nexport async function loader(props: LoaderFunctionArgs) {\n  const event = \"halloween-2025\"\n\n  const urlParams = new URL(props.request.url).searchParams\n\n  const pageParam = urlParams.get(\"page\")\n\n  const page = pageParam ? Number(pageParam) : 0\n\n  const eventsResp = await loaderClient.query({\n    query: appEventQuery,\n    variables: {\n      limit: 64,\n      offset: page * 64,\n      slug: event,\n      where: {\n        ratings: [\"G\", \"R15\"],\n        isNowCreatedAt: true,\n      },\n    },\n  })\n\n  if (eventsResp.data.appEvent === null) {\n    // ãƒãƒ­ã‚¦ã‚£ãƒ³2025ã‚¤ãƒ™ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã§ã‚‚è¡¨ç¤ºã™ã‚‹\n    return {\n      appEvent: null,\n      page,\n    }\n  }\n\n  return {\n    appEvent: eventsResp.data.appEvent,\n    page,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneMonth,\n})\n\nexport default function EventHalloween2025 () {\n  const data = useLoaderData<typeof loader>()\n  const [expandedFaq, setExpandedFaq] = useState<number | null>(null)\n  const participationMethodsId = useId()\n\n  const eventInfo = {\n    title: \"ãƒãƒ­ã‚¦ã‚£ãƒ³2025ä¼ç”»\",\n    subtitle:\n      \"Aipictorsã‚µã‚¤ãƒˆå†…ä¼ç”»ï¼šå’Œæ°—ã‚ã„AI4ä¼šå ´ã§ã®å±•ç¤ºãƒ»å†Šå­æ²è¼‰ã‚’ç›®æŒ‡ã—ã¦ãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã‚’æŠ•ç¨¿ã—ã‚ˆã†ï¼\",\n    date: \"2025å¹´10æœˆ25æ—¥(åœŸ)\",\n    time: \"10:00ã€œ16:00\",\n    location: \"åå¤å±‹é‰„é“ å¤ªç”°å·é§…å‰ å¤§å±‹æ ¹åºƒå ´\",\n    address: \"æ„›çŸ¥çœŒæ±æµ·å¸‚å¤§ç”°ç”ºä¸‹æµœç”°137\",\n    access: \"å¤ªç”°å·é§…ã‹ã‚‰å¾’æ­©1åˆ†\",\n    admission: \"ç„¡æ–™\",\n    deadline: \"ä½œå“æŠ•ç¨¿æœŸé–“ï¼š2025å¹´7æœˆ21æ—¥ã€œ8æœˆ31æ—¥\",\n    tag: \"!å’Œæ°—ã‚ã„AI2025ãƒãƒ­ã‚¦ã‚£ãƒ³ä¼ç”»\",\n  }\n\n  const features = [\n    {\n      icon: <PaletteIcon className=\"h-6 w-6\" />,\n      title: \"Aipictorsã‚µã‚¤ãƒˆå†…ä¼ç”»\",\n      description:\n        \"å½“ä¼ç”»ã¯Aipictorsã‚µã‚¤ãƒˆå†…ã§ã®ä½œå“æŠ•ç¨¿ä¼ç”»ã§ã™ã€‚å„ªç§€ä½œå“ãŒãƒªã‚¢ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆã§å±•ç¤ºã•ã‚Œã¾ã™\",\n    },\n    {\n      icon: <ImageIcon className=\"h-6 w-6\" />,\n      title: \"å’Œæ°—ã‚ã„AI4ä¼šå ´ã§ã®å±•ç¤º\",\n      description:\n        \"æŠ•ç¨¿ä½œå“ã®ä¸­ã‹ã‚‰å„ªç§€ä½œå“ãŒæ„›çŸ¥çœŒã®å®Ÿéš›ã®ã‚¤ãƒ™ãƒ³ãƒˆä¼šå ´ã§å±•ç¤ºã•ã‚Œã¾ã™\",\n    },\n    {\n      icon: <UsersIcon className=\"h-6 w-6\" />,\n      title: \"å†Šå­æ²è¼‰ã®ãƒãƒ£ãƒ³ã‚¹\",\n      description:\n        \"Aipictorsé‹å–¶ãŒä½œæˆã™ã‚‹å†Šå­ã¸ã®æ²è¼‰æ©Ÿä¼šãŒã‚ã‚Šã€ã‚¤ãƒ™ãƒ³ãƒˆä¼šå ´ã§é…å¸ƒãƒ»è²©å£²ã•ã‚Œã¾ã™\",\n    },\n  ]\n\n  const participationMethods = [\n    {\n      title: \"ã‚ªãƒ³ãƒ©ã‚¤ãƒ³æŠ•ç¨¿\",\n      description:\n        \"Aipictorsã«ã€Œ!å’Œæ°—ã‚ã„AI2025ãƒãƒ­ã‚¦ã‚£ãƒ³ä¼ç”»ã€ã‚¿ã‚°ä»˜ãã§ãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã‚’æŠ•ç¨¿ã—ã¦ãã ã•ã„ã€‚å„ªç§€ä½œå“ãŒå’Œæ°—ã‚ã„AI4ä¼šå ´ã§å±•ç¤ºã•ã‚Œã¾ã™ã€‚\",\n      icon: <BadgeIcon className=\"h-6 w-6\" />,\n      link: `/new/image?event=wakiaiai4-halloween&tag=${encodeURIComponent(eventInfo.tag)}`,\n    },\n    {\n      title: \"ãƒªã‚¢ãƒ«å‡ºå±•ï¼ˆåˆ¥ç”³è¾¼ï¼‰\",\n      description:\n        \"å’Œæ°—ã‚ã„AI4ã‚¤ãƒ™ãƒ³ãƒˆã«ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã¨ã—ã¦ç›´æ¥å‡ºå±•ã—ãŸã„å ´åˆã¯ã€åˆ¥é€”å’Œæ°—ã‚ã„AI4ã®å‡ºå±•ç”³è¾¼ãŒå¿…è¦ã§ã™ã€‚\",\n      icon: <StoreIcon className=\"h-6 w-6\" />,\n      link: \"/events/wakiaiai4\",\n    },\n  ]\n\n  const faqItems = [\n    {\n      question: \"ã“ã®ä¼ç”»ã¯ä½•ã§ã™ã‹ï¼Ÿ\",\n      answer:\n        \"AipictorsãŒä¸»å‚¬ã™ã‚‹ã‚µã‚¤ãƒˆå†…ä½œå“æŠ•ç¨¿ä¼ç”»ã§ã™ã€‚æŠ•ç¨¿ã•ã‚ŒãŸä½œå“ã®ä¸­ã‹ã‚‰å„ªç§€ä½œå“ã‚’é¸å®šã—ã€æ„›çŸ¥çœŒã§é–‹å‚¬ã•ã‚Œã‚‹ãƒªã‚¢ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆã€Œå’Œæ°—ã‚ã„AI4ã€ã®ä¼šå ´ã§å±•ç¤ºãƒ»å†Šå­æ²è¼‰ã‚’è¡Œã„ã¾ã™ã€‚\",\n    },\n    {\n      question: \"èª°ãŒä½œå“ã‚’é¸å®šãƒ»å±•ç¤ºã™ã‚‹ã®ã§ã™ã‹ï¼Ÿ\",\n      answer:\n        \"Aipictorsé‹å–¶ãŒä½œå“ã‚’é¸å®šã—ã€å’Œæ°—ã‚ã„AI4ã‚¤ãƒ™ãƒ³ãƒˆã«Aipictorsã¨ã—ã¦å‡ºå±•ã™ã‚‹éš›ã®å±•ç¤ºå†…å®¹ãƒ»å†Šå­åéŒ²ä½œå“ã¨ã—ã¦ä½¿ç”¨ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚\",\n    },\n    {\n      question: \"å‚åŠ æ–¹æ³•ã‚’æ•™ãˆã¦ãã ã•ã„\",\n      answer: `Aipictorsã‚µã‚¤ãƒˆã«ãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã‚’æŠ•ç¨¿ã™ã‚‹éš›ã€å¿…ãšã€Œ${eventInfo.tag}ã€ã‚¿ã‚°ã‚’ä»˜ã‘ã¦ãã ã•ã„ã€‚ã“ã®ä¼ç”»ã¸ã®å‚åŠ ã¯ã‚µã‚¤ãƒˆå†…æŠ•ç¨¿ã®ã¿ã¨ãªã‚Šã¾ã™ã€‚`,\n    },\n    {\n      question: \"ç›´æ¥ã‚¤ãƒ™ãƒ³ãƒˆä¼šå ´ã«å‡ºå±•ã—ãŸã„å ´åˆã¯ï¼Ÿ\",\n      answer:\n        \"ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼å€‹äººã¨ã—ã¦å’Œæ°—ã‚ã„AI4ã«å‡ºå±•ã—ãŸã„å ´åˆã¯ã€ã“ã®ä¼ç”»ã¨ã¯åˆ¥ã«å’Œæ°—ã‚ã„AI4ã®å‡ºå±•ç”³è¾¼ãŒå¿…è¦ã§ã™ã€‚è©³ç´°ã¯å’Œæ°—ã‚ã„AI4ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã‚’ã”ç¢ºèªãã ã•ã„ã€‚\",\n    },\n    {\n      question: \"ã©ã‚“ãªãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã‚’ä½œã‚Œã°è‰¯ã„ã§ã™ã‹ï¼Ÿ\",\n      answer:\n        \"ãƒãƒ­ã‚¦ã‚£ãƒ³ã‚’ãƒ†ãƒ¼ãƒã«ã—ãŸç”ŸæˆAIä½œå“ã§ã‚ã‚Œã°ä½•ã§ã‚‚OKã§ã™ã€‚ã‹ã‚ã„ã„ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã€ãƒ›ãƒ©ãƒ¼é¢¨æ™¯ã€ä»®è£…ã‚·ãƒ¼ãƒ³ãªã©è‡ªç”±ã«å‰µä½œã—ã¦ãã ã•ã„ã€‚\",\n    },\n  ]\n\n  const toggleFaq = (index: number) => {\n    setExpandedFaq(expandedFaq === index ? null : index)\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Hero Section */}\n      <div className=\"bg-gradient-to-r from-orange-600 to-purple-600 text-white\">\n        <div className=\"container mx-auto px-4 py-16 text-center\">\n          <div className=\"mx-auto max-w-4xl\">\n            <Badge\n              variant=\"secondary\"\n              className=\"mb-6 bg-yellow-400 px-6 py-2 font-bold text-black\"\n            >\n              {eventInfo.deadline}\n            </Badge>\n\n            <h1 className=\"mb-4 font-bold text-4xl drop-shadow-lg sm:text-5xl lg:text-6xl\">\n              ğŸƒ {eventInfo.title}\n            </h1>\n            <p className=\"mb-8 text-lg opacity-90 drop-shadow-lg sm:text-xl\">\n              {eventInfo.subtitle}\n            </p>\n            <div className=\"mb-8 flex flex-col items-center gap-4 sm:flex-row sm:justify-center\">\n              <div className=\"flex items-center gap-2\">\n                <CalendarIcon className=\"h-5 w-5\" />\n                <span className=\"font-semibold\">{eventInfo.date}</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <ClockIcon className=\"h-5 w-5\" />\n                <span>{eventInfo.time}</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <MapPinIcon className=\"h-5 w-5\" />\n                <span>{eventInfo.location}</span>\n              </div>\n            </div>\n            <div className=\"flex flex-col gap-4 sm:flex-row sm:justify-center\">\n              <Button\n                size=\"lg\"\n                className=\"transform border-2 border-orange-300 bg-gradient-to-r from-orange-500 to-orange-600 px-8 py-4 font-bold text-lg text-white shadow-xl transition-all duration-200 hover:scale-105 hover:from-orange-600 hover:to-orange-700\"\n                onClick={() => {\n                  document\n                    .getElementById(participationMethodsId)\n                    ?.scrollIntoView({ behavior: \"smooth\" })\n                }}\n              >\n                ğŸ¯ å‚åŠ æ–¹æ³•ã‚’è¦‹ã‚‹\n              </Button>\n              <Link to=\"/events/wakiaiai4\">\n                <Button\n                  size=\"lg\"\n                  variant=\"outline\"\n                  className=\"border-white bg-black px-8 py-4 font-bold text-lg backdrop-blur-sm hover:bg-white/20\"\n                >\n                  <ExternalLinkIcon className=\"mr-2 h-5 w-5\" />\n                  å’Œæ°—ã‚ã„AI4ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸\n                </Button>\n              </Link>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"container mx-auto space-y-12 px-4 py-12\">\n        {/* ä¼ç”»æ¦‚è¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}\n        <section>\n          <h2 className=\"mb-8 text-center font-bold text-2xl\">ä¼ç”»æ¦‚è¦</h2>\n          <Card className=\"border-2 border-orange-200 bg-gradient-to-r from-orange-50 to-purple-50\">\n            <CardContent className=\"p-8\">\n              <div className=\"space-y-6 text-center\">\n                <h3 className=\"font-bold text-orange-700 text-xl\">\n                  ã“ã‚Œã¯ä½•ã®ä¼ç”»ã§ã™ã‹ï¼Ÿ\n                </h3>\n                <div className=\"mx-auto max-w-4xl space-y-4 text-left\">\n                  <p className=\"text-lg\">\n                    ã“ã®ä¼ç”»ã¯\n                    <strong>AipictorsãŒä¸»å‚¬ã™ã‚‹ã‚µã‚¤ãƒˆå†…ä½œå“æŠ•ç¨¿ä¼ç”»</strong>\n                    ã§ã™ã€‚\n                  </p>\n                  <p>\n                    æŠ•ç¨¿ã•ã‚ŒãŸãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã®ä¸­ã‹ã‚‰ã€Aipictorsé‹å–¶ãŒå„ªç§€ä½œå“ã‚’é¸å®šã—ã€\n                    æ„›çŸ¥çœŒã§é–‹å‚¬ã•ã‚Œã‚‹ç”ŸæˆAIã‚¤ãƒ™ãƒ³ãƒˆã€Œå’Œæ°—ã‚ã„AI4ã€ã«ãŠã„ã¦\n                    <strong>\n                      Aipictorsã¨ã—ã¦å‡ºå±•ã™ã‚‹éš›ã®å±•ç¤ºä½œå“ãƒ»å†Šå­åéŒ²ä½œå“\n                    </strong>\n                    ã¨ã—ã¦ä½¿ç”¨ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚\n                  </p>\n                  <div className=\"rounded-lg border border-orange-200 bg-white/70 p-4\">\n                    <h4 className=\"mb-2 font-semibold text-orange-800\">\n                      å‚åŠ ã®æµã‚Œ\n                    </h4>\n                    <ol className=\"list-inside list-decimal space-y-1 text-sm\">\n                      <li>Aipictorsã«ãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã‚’æŒ‡å®šã‚¿ã‚°ä»˜ãã§æŠ•ç¨¿</li>\n                      <li>Aipictorsé‹å–¶ãŒå„ªç§€ä½œå“ã‚’é¸å®š</li>\n                      <li>\n                        é¸å®šä½œå“ãŒå’Œæ°—ã‚ã„AI4ä¼šå ´ã§Aipictorsãƒ–ãƒ¼ã‚¹ã«å±•ç¤ºãƒ»å†Šå­æ²è¼‰\n                      </li>\n                    </ol>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </section>\n\n        {/* Main Event Banner */}\n        <section className=\"text-center\">\n          <div className=\"mx-auto max-w-3xl\">\n            <EventWakiaiaiImage\n              alt=\"ãƒãƒ­ã‚¦ã‚£ãƒ³2025ä¼ç”»\"\n              imageURL=\"https://assets.aipictors.com/cc52625d-887c-46f4-afbc-757b7655797f.webp\"\n              linkTitle=\"Aipictors\"\n            />\n          </div>\n        </section>\n\n        {/* Features */}\n        <section>\n          <h2 className=\"mb-8 text-center font-bold text-2xl\">ä¼ç”»ã®ç‰¹å¾´</h2>\n          <div className=\"grid gap-6 md:grid-cols-3\">\n            {features.map((feature, index) => (\n              <Card key={index.toString()} className=\"text-center\">\n                <CardHeader>\n                  <div className=\"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-primary/10 text-primary\">\n                    {feature.icon}\n                  </div>\n                  <CardTitle className=\"text-lg\">{feature.title}</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-muted-foreground\">{feature.description}</p>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </section>\n\n        {/* Event Details */}\n        <section>\n          <h2 className=\"mb-8 text-center font-bold text-2xl\">\n            å±•ç¤ºäºˆå®šä¼šå ´ï¼ˆå’Œæ°—ã‚ã„AI4ï¼‰\n          </h2>\n          <Card className=\"border-2 border-blue-200\">\n            <CardHeader className=\"bg-blue-50\">\n              <CardTitle className=\"text-center text-blue-800\">\n                é¸å®šä½œå“ã®å±•ç¤ºä¼šå ´ã«ã¤ã„ã¦\n              </CardTitle>\n              <p className=\"mt-2 text-center text-blue-600 text-sm\">\n                ã“ã®ä¼ç”»ã§æŠ•ç¨¿ã•ã‚ŒãŸä½œå“ã®å„ªç§€ä½œå“ã¯ã€ä»¥ä¸‹ã®ä¼šå ´ã§Aipictorsã¨ã—ã¦å±•ç¤ºã•ã‚Œã‚‹äºˆå®šã§ã™\n              </p>\n            </CardHeader>\n            <CardContent className=\"p-8\">\n              <div className=\"grid gap-6 md:grid-cols-2\">\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <CalendarIcon className=\"h-5 w-5 text-blue-600\" />\n                    <div>\n                      <div className=\"font-semibold\">é–‹å‚¬æ—¥æ™‚</div>\n                      <div className=\"text-muted-foreground\">\n                        {eventInfo.date} {eventInfo.time}\n                      </div>\n                    </div>\n                  </div>\n                  <div className=\"flex items-start gap-3\">\n                    <MapPinIcon className=\"mt-1 h-5 w-5 text-blue-600\" />\n                    <div>\n                      <div className=\"font-semibold\">é–‹å‚¬å ´æ‰€</div>\n                      <div className=\"text-muted-foreground\">\n                        {eventInfo.location}\n                        <br />\n                        {eventInfo.address}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <ClockIcon className=\"h-5 w-5 text-blue-600\" />\n                    <div>\n                      <div className=\"font-semibold\">ã‚¢ã‚¯ã‚»ã‚¹</div>\n                      <div className=\"text-muted-foreground\">\n                        {eventInfo.access}\n                      </div>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center gap-3\">\n                    <UsersIcon className=\"h-5 w-5 text-blue-600\" />\n                    <div>\n                      <div className=\"font-semibold\">å…¥å ´æ–™</div>\n                      <div className=\"font-semibold text-muted-foreground\">\n                        {eventInfo.admission}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </section>\n\n        {/* Participation Methods */}\n        <section id={participationMethodsId}>\n          <h2 className=\"mb-8 text-center font-bold text-2xl\">\n            ä¼ç”»ã¸ã®å‚åŠ æ–¹æ³•\n          </h2>\n          <div className=\"mb-6\">\n            <Card className=\"border-orange-200 bg-orange-50 dark:border-orange-800 dark:bg-orange-950\">\n              <CardContent className=\"p-6\">\n                <div className=\"text-center\">\n                  <h3 className=\"mb-2 font-bold text-lg\">\n                    AipictorsæŠ•ç¨¿æ™‚ã®å¿…é ˆã‚¿ã‚°\n                  </h3>\n                  <Badge className=\"bg-orange-600 px-4 py-2 font-mono text-lg text-white\">\n                    {eventInfo.tag}\n                  </Badge>\n                  <p className=\"mt-2 text-muted-foreground text-sm\">\n                    ã“ã®ä¼ç”»ã«å‚åŠ ã™ã‚‹ã«ã¯ã€Aipictorsã«ä½œå“æŠ•ç¨¿æ™‚ã«ã“ã®ã‚¿ã‚°ã‚’å¿…ãšä»˜ã‘ã¦ãã ã•ã„\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n          <div className=\"grid gap-6 md:grid-cols-2\">\n            {participationMethods.map((method, index) => (\n              <Card key={index.toString()}>\n                <CardHeader>\n                  <div className=\"mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-primary/10 text-primary\">\n                    {method.icon}\n                  </div>\n                  <CardTitle className=\"text-lg\">{method.title}</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <p className=\"text-muted-foreground\">{method.description}</p>\n                  <Link\n                    to={method.link}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                  >\n                    <Button className=\"w-full\">\n                      <ExternalLinkIcon className=\"mr-2 h-4 w-4\" />\n                      {method.title === \"ã‚ªãƒ³ãƒ©ã‚¤ãƒ³æŠ•ç¨¿\"\n                        ? \"ä½œå“ã‚’æŠ•ç¨¿ã™ã‚‹\"\n                        : \"ç”³ã—è¾¼ã‚€\"}\n                    </Button>\n                  </Link>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </section>\n\n        {/* Ranking Works Section */}\n        {data.appEvent?.awardWorks && data.appEvent.awardWorks.length > 0 && (\n          <section>\n            <EventAwardWorkList\n              works={data.appEvent.awardWorks}\n              slug=\"halloween-2025\"\n            />\n          </section>\n        )}\n\n        {/* Works List */}\n        {data.appEvent?.works && (\n          <section>\n            <div className=\"mb-8 text-center\">\n              <h2 className=\"mb-4 font-bold text-2xl\">æŠ•ç¨¿ä½œå“</h2>\n              <div className=\"mx-auto mb-6 max-w-2xl rounded-lg border border-orange-200 bg-orange-50 p-4 dark:border-orange-800 dark:bg-orange-950/20\">\n                <Link\n                  to={`/tags/${encodeURIComponent(eventInfo.tag)}`}\n                  className=\"inline-block\"\n                >\n                  <Button\n                    variant=\"default\"\n                    size=\"lg\"\n                    className=\"bg-orange-600 hover:bg-orange-700\"\n                  >\n                    <BadgeIcon className=\"mr-2 h-4 w-4\" />\n                    {eventInfo.tag} ã®ã‚¿ã‚°ãƒšãƒ¼ã‚¸ã§å…¨ä½œå“ã‚’è¦‹ã‚‹\n                  </Button>\n                </Link>\n              </div>\n            </div>\n            <EventWorkList\n              works={data.appEvent.works}\n              maxCount={data.appEvent.worksCount}\n              page={data.page}\n              slug=\"halloween-2025\"\n              sort=\"DESC\"\n              orderBy=\"DATE_CREATED\"\n              workType={null}\n              rating={null}\n              sumWorksCount={data.appEvent.worksCount}\n              setWorkType={() => {}}\n              setRating={() => {}}\n              setSort={() => {}}\n              isHideSortableSetting={true}\n              onClickTitleSortButton={() => {}}\n              onClickLikeSortButton={() => {}}\n              onClickBookmarkSortButton={() => {}}\n              onClickCommentSortButton={() => {}}\n              onClickViewSortButton={() => {}}\n              onClickAccessTypeSortButton={() => {}}\n              onClickDateSortButton={() => {}}\n              onClickWorkTypeSortButton={() => {}}\n              onClickIsPromotionSortButton={() => {}}\n            />\n          </section>\n        )}\n\n        {/* FAQ */}\n        <section>\n          <h2 className=\"mb-8 text-center font-bold text-2xl\">ã‚ˆãã‚ã‚‹è³ªå•</h2>\n          <div className=\"space-y-4\">\n            {faqItems.map((item, index) => (\n              <Card key={index.toString()}>\n                <CardHeader\n                  className=\"cursor-pointer\"\n                  onClick={() => toggleFaq(index)}\n                >\n                  <div className=\"flex items-center justify-between\">\n                    <CardTitle className=\"text-lg\">{item.question}</CardTitle>\n                    {expandedFaq === index ? (\n                      <ChevronUpIcon className=\"h-5 w-5\" />\n                    ) : (\n                      <ChevronDownIcon className=\"h-5 w-5\" />\n                    )}\n                  </div>\n                </CardHeader>\n                {expandedFaq === index && (\n                  <CardContent className=\"pt-0\">\n                    <p className=\"text-muted-foreground\">{item.answer}</p>\n                  </CardContent>\n                )}\n              </Card>\n            ))}\n          </div>\n        </section>\n\n        {/* Call to Action */}\n        <section className=\"text-center\">\n          <Card className=\"bg-gradient-to-r from-orange-50 to-purple-50 dark:from-orange-950/20 dark:to-purple-950/20\">\n            <CardContent className=\"p-8\">\n              <h3 className=\"mb-4 font-bold text-2xl\">\n                å’Œæ°—ã‚ã„AI4ã§ä¼šã„ã¾ã—ã‚‡ã†ï¼\n              </h3>\n              <p className=\"mb-6 text-muted-foreground\">\n                ãƒãƒ­ã‚¦ã‚£ãƒ³ä¼ç”»ã¨åˆã‚ã›ã¦ã€ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã«ã‚‚ãœã²ã”å‚åŠ ãã ã•ã„\n              </p>\n              <div className=\"flex flex-col gap-4 sm:flex-row sm:justify-center\">\n                <Link to=\"/events/wakiaiai4\">\n                  <Button size=\"lg\" className=\"px-8 py-4\">\n                    <ExternalLinkIcon className=\"mr-2 h-5 w-5\" />\n                    å’Œæ°—ã‚ã„AI4è©³ç´°ã‚’è¦‹ã‚‹\n                  </Button>\n                </Link>\n                <Link\n                  to={`/new/image?event=wakiaiai4-halloween&tag=${encodeURIComponent(eventInfo.tag)}`}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  <Button size=\"lg\" variant=\"outline\" className=\"px-8 py-4\">\n                    <PaletteIcon className=\"mr-2 h-5 w-5\" />\n                    ä»Šã™ãä½œå“æŠ•ç¨¿\n                  </Button>\n                </Link>\n              </div>\n            </CardContent>\n          </Card>\n        </section>\n      </div>\n    </div>\n  )\n}\n{\n  /* Main Event Banner */\n}\n;<div className=\"text-center\">\n  <div className=\"mx-auto max-w-3xl\">\n    <EventWakiaiaiImage\n      alt=\"ãƒãƒ­ã‚¦ã‚£ãƒ³2025ä¼ç”»\"\n      imageURL=\"https://assets.aipictors.com/cc52625d-887c-46f4-afbc-757b7655797f.webp\"\n      linkTitle=\"Aipictors\"\n    />\n  </div>\n</div>\n\n{\n  /* Event Details */\n}\n;<div className=\"grid gap-8 md:grid-cols-2\">\n  <Card className=\"border-2 border-orange-300 bg-gradient-to-br from-orange-100 to-yellow-100 shadow-xl dark:from-orange-900/30 dark:to-yellow-900/30\">\n    <CardHeader className=\"text-center\">\n      <CardTitle className=\"font-bold text-2xl text-orange-600 dark:text-orange-400\">\n        <CalendarIcon className=\"mr-2 inline h-6 w-6\" />\n        é–‹å‚¬æœŸé–“\n      </CardTitle>\n    </CardHeader>\n    <CardContent className=\"space-y-4 text-center\">\n      <p className=\"font-semibold text-lg\">2025å¹´7æœˆ21æ—¥(æœˆ)ï½8æœˆ31æ—¥(æ—¥)</p>\n      <Badge className=\"bg-red-500 px-4 py-2 text-lg text-white\">\n        å¿œå‹Ÿå—ä»˜ä¸­ï¼\n      </Badge>\n    </CardContent>\n  </Card>\n\n  <Card className=\"border-2 border-purple-300 bg-gradient-to-br from-purple-100 to-pink-100 shadow-xl dark:from-purple-900/30 dark:to-pink-900/30\">\n    <CardHeader className=\"text-center\">\n      <CardTitle className=\"font-bold text-2xl text-purple-600 dark:text-purple-400\">\n        <MapPinIcon className=\"mr-2 inline h-6 w-6\" />\n        ã‚¤ãƒ™ãƒ³ãƒˆä¼šå ´\n      </CardTitle>\n    </CardHeader>\n    <CardContent className=\"space-y-4 text-center\">\n      <p className=\"text-lg\">\n        æ„›çŸ¥çœŒæ±æµ·å¸‚\n        <br />\n        å¤ªç”°å·é§…è¥¿åºƒå ´\n      </p>\n      <Link to=\"/events/wakiaiai4\">\n        <Button\n          variant=\"outline\"\n          className=\"border-purple-300 text-purple-600 hover:bg-purple-50\"\n        >\n          <ExternalLinkIcon className=\"mr-2 h-4 w-4\" />\n          ä¼šå ´è©³ç´°ã‚’è¦‹ã‚‹\n        </Button>\n      </Link>\n    </CardContent>\n  </Card>\n</div>\n\n{\n  /* Participation Method */\n}\n;<Card className=\"border-orange-200 bg-orange-50 dark:border-orange-800 dark:bg-orange-950\">\n  <CardHeader className=\"text-center\">\n    <CardTitle className=\"font-bold text-3xl\">å‚åŠ æ–¹æ³•</CardTitle>\n  </CardHeader>\n  <CardContent className=\"p-8\">\n    <div className=\"space-y-6 text-center\">\n      <div className=\"rounded-lg border-2 border-orange-300 bg-orange-200 p-6 dark:bg-orange-800/30\">\n        <h3 className=\"mb-4 font-bold text-2xl text-orange-700 dark:text-orange-300\">\n          å¿…é ˆã‚¿ã‚°\n        </h3>\n        <p className=\"font-bold text-3xl text-orange-900 dark:text-orange-100\">\n          ã€Œ!å’Œæ°—ã‚ã„AI2025ãƒãƒ­ã‚¦ã‚£ãƒ³ä¼ç”»ã€\n        </p>\n        <p className=\"mt-4 text-orange-700 dark:text-orange-300\">\n          ã“ã®ã‚¿ã‚°ã‚’ã¤ã‘ã¦ä½œå“ã‚’æŠ•ç¨¿ã™ã‚‹ã¨ã‚¤ãƒ™ãƒ³ãƒˆã«å‚åŠ ã§ãã¾ã™ï¼\n        </p>\n      </div>\n\n      <div className=\"grid gap-6 md:grid-cols-2\">\n        <div className=\"rounded-lg border-2 border-purple-300 bg-purple-100 p-6 dark:bg-purple-900/30\">\n          <h4 className=\"mb-3 font-bold text-purple-700 text-xl dark:text-purple-300\">\n            Aipictorsã¨ã—ã¦ã®ãƒã‚¹ã‚¿ãƒ¼å±•ç¤º\n          </h4>\n          <p className=\"text-purple-600 dark:text-purple-200\">\n            å„ªç§€ä½œå“ã¯Aipictorsé‹å–¶ãŒä½œæˆã™ã‚‹å’Œæ°—ã‚ã„AI4ã®ãƒã‚¹ã‚¿ãƒ¼ã«æ²è¼‰ã•ã‚Œã¾ã™\n          </p>\n        </div>\n\n        <div className=\"rounded-lg border-2 border-yellow-300 bg-yellow-100 p-6 dark:bg-yellow-900/30\">\n          <h4 className=\"mb-3 font-bold text-xl text-yellow-700 dark:text-yellow-300\">\n            Aipictorså†Šå­ã¸ã®æ²è¼‰\n          </h4>\n          <p className=\"text-yellow-600 dark:text-yellow-200\">\n            Aipictorsé‹å–¶ãŒä½œæˆã™ã‚‹å†Šå­ã«ã‚‚ä½œå“æ²è¼‰ã®ãƒãƒ£ãƒ³ã‚¹ãŒã‚ã‚Šã€ã‚¤ãƒ™ãƒ³ãƒˆä¼šå ´ã§é…å¸ƒãƒ»è²©å£²ã•ã‚Œã¾ã™\n          </p>\n        </div>\n      </div>\n\n      <div className=\"flex flex-col gap-4 sm:flex-row sm:justify-center\">\n        <Button\n          size=\"lg\"\n          className=\"transform bg-gradient-to-r from-orange-500 to-red-500 px-10 py-6 font-bold text-white text-xl shadow-xl transition-all duration-300 hover:scale-105 hover:from-orange-600 hover:to-red-600\"\n          onClick={() => {\n            const url = `/new/image?event=wakiaiai4-halloween&tag=${encodeURIComponent(\"!å’Œæ°—ã‚ã„AI2025ãƒãƒ­ã‚¦ã‚£ãƒ³ä¼ç”»\")}`\n            window.open(url, \"_blank\")\n          }}\n        >\n          ğŸƒ ä»Šã™ãä½œå“æŠ•ç¨¿\n        </Button>\n\n        <Link to=\"/events/wakiaiai4\">\n          <Button\n            size=\"lg\"\n            variant=\"outline\"\n            className=\"border-purple-300 px-10 py-6 font-bold text-purple-600 text-xl hover:bg-purple-50\"\n          >\n            ã‚¤ãƒ™ãƒ³ãƒˆè©³ç´°\n          </Button>\n        </Link>\n      </div>\n    </div>\n  </CardContent>\n</Card>\n\nexport const meta: MetaFunction = () => {\n  return [\n    { title: \"ãƒãƒ­ã‚¦ã‚£ãƒ³2025ä¼ç”» - å’Œæ°—ã‚ã„AI4é€£å‹•ç‰¹åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆ\" },\n    {\n      name: \"description\",\n      content:\n        \"å’Œæ°—ã‚ã„AI4ã¨é€£å‹•ã—ãŸãƒãƒ­ã‚¦ã‚£ãƒ³ç‰¹åˆ¥ä¼ç”»ã€‚ç”ŸæˆAIã‚’ä½¿ã£ã¦ç´ æ•µãªãƒãƒ­ã‚¦ã‚£ãƒ³ä½œå“ã‚’æŠ•ç¨¿ã—ã‚ˆã†ï¼\",\n    },\n  ]\n}\n\nconst appEventQuery = graphql(\n  `query AppEvent($slug: String!, $offset: Int!, $limit: Int!, $where: WorksWhereInput!) {\n    appEvent(slug: $slug) {\n      id\n      title\n      description\n      slug\n      worksCount\n      works(offset: $offset, limit: $limit, where: $where) {\n        ...EventWorkListItem\n      }\n      awardWorks(offset: 0, limit: 20, isSensitive: false) {\n        ...EventAwardWorkListItem\n      }\n    }\n  }`,\n  [EventWorkListItemFragment, EventAwardWorkListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/complexity/noUselessFragments","severity":"information","description":"This fragment is unnecessary.","message":[{"elements":[],"content":"This fragment is unnecessary."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"A fragment is redundant if it contains only one child, or if it is the child of a html element, and is not a keyed "},{"elements":[{"Hyperlink":{"href":"https://legacy.reactjs.org/docs/fragments.html#keyed-fragments"}}],"content":"fragment"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/generation-task-sheet-view-content.tsx"},"span":[9173,9178],"sourceCode":"import { SwipeArea } from \"~/components/swipe-area\"\nimport { Button } from \"~/components/ui/button\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { Skeleton } from \"~/components/ui/skeleton\"\nimport { cn } from \"~/lib/utils\"\nimport { GenerationImageDialogButton } from \"~/routes/($lang).generation._index/components/generation-image-dialog-button\"\nimport { GenerationMenuButton } from \"~/routes/($lang).generation._index/components/generation-menu-button\"\nimport { GenerationReferenceDialog } from \"~/routes/($lang).generation._index/components/generation-reference-dialog-button\"\nimport { GenerationTaskContentImagePlaceHolder } from \"~/routes/($lang).generation._index/components/generation-task-content-image-place-holder\"\nimport type { GenerationParameters } from \"~/routes/($lang).generation._index/types/generation-parameters\"\nimport type { GenerationSize } from \"~/routes/($lang).generation._index/types/generation-size\"\nimport {\n  ArrowDownToLine,\n  ArrowUpRightSquare,\n  ChevronLeft,\n  ChevronRight,\n  ClipboardCopy,\n  LockKeyholeIcon,\n  LockKeyholeOpenIcon,\n  PenIcon,\n} from \"lucide-react\"\nimport { Suspense } from \"react\"\nimport { ErrorBoundary } from \"react-error-boundary\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { GenerationTaskError } from \"~/routes/($lang).generation._index/components/task-view/generation-task-error\"\nimport { StarRating } from \"~/routes/($lang).generation._index/components/task-view/star-rating\"\nimport { GeminiImageModificationDialog } from \"~/routes/($lang).generation._index/components/submission-view/gemini-image-modification-dialog\"\nimport { CopyButton } from \"~/routes/($lang).generation._index/components/copy-button\"\nimport { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport { toDateTimeText } from \"~/utils/to-date-time-text\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { GenerationTaskPostConfirmDialog } from \"~/routes/($lang).generation._index/components/generation-task-post-confirm-dialog\"\nimport { GenerationTaskDeleteMemoConfirmDialog } from \"~/routes/($lang).generation._index/components/generation-task-delete-memo-confirm-dialog\"\nimport { normalizeGenerativeFileUrl } from \"~/utils/normalize-generative-file-url\"\n\ntype Props = {\n  task:\n    | FragmentOf<typeof GenerationImageResultSheetContentFragment>\n    | FragmentOf<typeof GenerationImageResultSheetContentTaskFragment>\n  isScroll: boolean\n  isDisplayImageListButton: boolean\n  isListFullSize: boolean\n  showAiModificationDialog: boolean\n  userNanoid: string\n  generationSize: GenerationSize\n  rating: number\n  isProtected: boolean\n  GenerationParameters: GenerationParameters\n  isProtectedLoading: boolean\n  isRatingLoading: boolean\n  isDeletedLoading: boolean\n  onReference(isSeedWith: boolean): void\n  onPost(): void\n  onDelete(): void\n  onInPaint(): void\n  onChangeRating(nanoid: string, rating: number): void\n  onNextTask(): void\n  onPrevTask(): void\n  setRating: (value: number) => void\n  setShowAiModificationDialog: (value: boolean) => void\n  saveGenerationImage(taskId: string, imageUrl: string): void\n  toggleProtectedImage(taskId: string): void\n  copyGeneration(generationParameters: GenerationParameters): void\n  copyUrl(nanoid: string): void\n}\n\n/**\n * å±¥æ­´ä¸€è¦§ã®å±¥æ­´ã‚·ãƒ¼ãƒˆã®ä¸­ã«è¡¨ç¤ºã™ã‚‹å±¥æ­´å†…å®¹\n */\nexport function GenerationTaskSheetViewContent (props: Props) {\n  const context = useGenerationContext()\n  const t = useTranslation()\n\n  const originalImageUrl = props.task.imageUrl ?? \"\"\n  const originalThumbnailUrl = props.task.thumbnailUrl ?? \"\"\n\n  const normalizedImageUrl = originalImageUrl\n    ? normalizeGenerativeFileUrl(originalImageUrl)\n    : originalImageUrl\n  const normalizedThumbnailUrl = originalThumbnailUrl\n    ? normalizeGenerativeFileUrl(originalThumbnailUrl)\n    : originalThumbnailUrl\n\n  /**\n   * ã‚«ãƒ³ãƒå‰ã¾ã§ã®æ–‡å­—åˆ—ã‚’å–å¾—\n   * @param text\n   * @returns\n   */\n  const extractStringBeforeComma = (text: string) => {\n    const commaIndex = text.indexOf(\".\")\n    if (commaIndex === -1) {\n      return text\n    }\n    return text.substring(0, commaIndex)\n  }\n\n  /**\n   * æ¬¡ã®ã‚¿ã‚¹ã‚¯ã«æˆ»ã‚Œã‚‹ã‹\n   * @returns\n   */\n  const canNextTask = (): boolean => {\n    const nowTask = props.task.id\n    const taskIds = context.config.viewTaskIds\n    if (nowTask === null || taskIds === null) return false\n    const index = taskIds.indexOf(nowTask)\n    if (!taskIds.length || taskIds.length === index + 1) {\n      return false\n    }\n    return true\n  }\n\n  /**\n   * å‰ã®ã‚¿ã‚¹ã‚¯ã«æˆ»ã‚Œã‚‹ã‹\n   * @returns\n   */\n  const canPrevTask = (): boolean => {\n    const nowTask = props.task.id\n    const taskIds = context.config.viewTaskIds\n    if (nowTask === null || taskIds === null) return false\n    const index = taskIds.indexOf(nowTask)\n    if (!taskIds.length || index === 0) {\n      return false\n    }\n    return true\n  }\n\n  const upscaleSize =\n    props.task.upscaleSize !== null || props.task.upscaleSize\n      ? props.task.upscaleSize\n      : 1\n  const width = props.generationSize.width * upscaleSize\n\n  const height = props.generationSize.height * upscaleSize\n\n  const userToken = context.config.currentUserToken\n\n  return (\n    <>\n      <ScrollArea\n        className={cn(\n          \"mx-auto w-full\",\n          \"md:h-[64vh]\", // â† max-height ã§ã¯ãªã height ã«\n        )}\n      >\n        <div\n          className={cn(\"p-4\", {\n            \"mx-auto w-full\": props.isListFullSize,\n            \"max-h-[88vh]\": props.isScroll,\n          })}\n        >\n          <SwipeArea\n            onNext={() => {\n              props.onNextTask()\n            }}\n            onPrev={() => {\n              props.onPrevTask()\n            }}\n          >\n            <div className=\"relative bg-gray-100 dark:bg-gray-900\">\n              {/* å‰ãƒœã‚¿ãƒ³ */}\n              {canPrevTask() && (\n                <Button\n                  className=\"absolute top-[50%] left-8\"\n                  variant={\"ghost\"}\n                  size={\"icon\"}\n                  onClick={props.onPrevTask}\n                >\n                  <ChevronLeft className=\"w-8\" />\n                </Button>\n              )}\n              {props.task.status !== \"RESERVED\" ? (\n                <ErrorBoundary fallback={<GenerationTaskError />}>\n                  <Suspense\n                    fallback={\n                      <GenerationTaskContentImagePlaceHolder\n                        className={\"m-auto max-h-96 max-w-['50vw']\"}\n                      />\n                    }\n                  >\n                    {props.task.imageUrl &&\n                    props.task.thumbnailUrl &&\n                    userToken ? (\n                      <GenerationImageDialogButton\n                        taskId={props.task.id}\n                        userToken={userToken}\n                        imageUrl={originalImageUrl}\n                        thumbnailUrl={originalThumbnailUrl}\n                      >\n                        <img\n                          className={\"m-auto max-h-96\"}\n                          src={\n                            context.config.taskListThumbnailType === \"light\"\n                              ? normalizedThumbnailUrl\n                              : normalizedImageUrl\n                          }\n                          data-generative-raw={\n                            context.config.taskListThumbnailType === \"light\"\n                              ? originalThumbnailUrl\n                              : originalImageUrl\n                          }\n                          onError={(event) => {\n                            const img = event.currentTarget\n                            const raw = img.dataset.generativeRaw\n                            if (!raw) return\n                            if (img.dataset.generativeFallback === \"true\") {\n                              return\n                            }\n                            img.dataset.generativeFallback = \"true\"\n                            img.src = raw\n\n                            // Download should also use the fallback URL.\n                            const downloadTarget =\n                              document.querySelector<HTMLImageElement>(\n                                `.generation-image-${props.task.id}`,\n                              )\n                            if (downloadTarget) {\n                              downloadTarget.dataset.generativeFallback = \"true\"\n                              const downloadRaw =\n                                downloadTarget.dataset.originalRaw ??\n                                originalImageUrl\n                              if (downloadRaw) {\n                                downloadTarget.dataset.original = downloadRaw\n                                downloadTarget.src = downloadRaw\n                              }\n                            }\n                          }}\n                          alt={\"-\"}\n                        />\n                      </GenerationImageDialogButton>\n                    ) : (\n                      <></>\n                    )}\n                  </Suspense>\n                  {/* ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç”¨ï¼ˆéè¡¨ç¤ºï¼‰ */}\n                  <Suspense\n                    fallback={\n                      <GenerationTaskContentImagePlaceHolder\n                        className={\"m-auto hidden h-72 max-h-96 max-w-['50vw']\"}\n                      />\n                    }\n                  >\n                    {userToken &&\n                      props.task.imageUrl &&\n                      props.task.thumbnailUrl && (\n                        <img\n                          className={cn(\n                            \"m-auto hidden h-72 max-h-96\",\n                            `generation-image-${props.task.id}`,\n                          )}\n                          alt={\"-\"}\n                          src={normalizedImageUrl}\n                          data-original={normalizedImageUrl}\n                          data-original-raw={originalImageUrl}\n                          onError={(event) => {\n                            const img = event.currentTarget\n                            const raw = img.dataset.originalRaw\n                            if (!raw) return\n                            if (img.dataset.generativeFallback === \"true\") {\n                              return\n                            }\n                            img.dataset.generativeFallback = \"true\"\n                            img.src = raw\n                            img.dataset.original = raw\n                          }}\n                        />\n                      )}\n                  </Suspense>\n                </ErrorBoundary>\n              ) : (\n                <>\n                  <p className=\"text-center\">\n                    {t(\"äºˆç´„ç”Ÿæˆä¸­\", \"Generating...\")}\n                  </p>\n                  <div className=\"relative bg-gray-100 p-8 dark:bg-gray-900\">\n                    <Skeleton\n                      className={\"m-auto h-[400px] w-[400px] rounded-xl\"}\n                    />\n                  </div>\n                </>\n              )}\n              {/* æ¬¡ãƒœã‚¿ãƒ³ */}\n              {canNextTask() && (\n                <Button\n                  className=\"absolute top-[50%] right-8\"\n                  variant={\"ghost\"}\n                  size={\"icon\"}\n                  onClick={props.onNextTask}\n                >\n                  <ChevronRight className=\"w-8\" />\n                </Button>\n              )}\n            </div>\n          </SwipeArea>\n          {props.task.status !== \"RESERVED\" && (\n            <>\n              <div className=\"flex flex-wrap gap-x-2 gap-y-2 pt-2\">\n                <GenerationReferenceDialog\n                  onReference={() => {\n                    props.onReference(false)\n                  }}\n                  onReferenceWithSeed={() => {\n                    props.onReference(true)\n                  }}\n                  isShowControlNetCaption={\n                    props.task.controlNetModule !== null &&\n                    props.task.controlNetModule !== \"\"\n                  }\n                >\n                  <GenerationMenuButton\n                    title={t(\n                      \"åŒã˜æƒ…å ±ã§ç”Ÿæˆã™ã‚‹\",\n                      \"Generate with same settings\",\n                    )}\n                    onClick={() => {}}\n                    text={t(\"å†åˆ©ç”¨\", \"Reuse\")}\n                    icon={ArrowUpRightSquare}\n                  />\n                </GenerationReferenceDialog>\n                <GenerationTaskPostConfirmDialog onPost={props.onPost} />\n                <GenerationMenuButton\n                  title={t(\"ç”Ÿæˆæƒ…å ±ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹\", \"Copy generation info\")}\n                  onClick={() =>\n                    props.copyGeneration(props.GenerationParameters)\n                  }\n                  icon={ClipboardCopy}\n                />\n                {props.task?.imageUrl && (\n                  <GenerationMenuButton\n                    title={t(\"ç”»åƒã‚’ä¿å­˜ã™ã‚‹\", \"Save image\")}\n                    onClick={() =>\n                      userToken &&\n                      props.saveGenerationImage(\n                        props.task.id,\n                        props.task.imageUrl ?? \"\",\n                      )\n                    }\n                    icon={ArrowDownToLine}\n                  />\n                )}\n                <GenerationMenuButton\n                  title={t(\"ä¿è­·ã™ã‚‹\", \"Protect image\")}\n                  onClick={() => props.toggleProtectedImage(props.task.id)}\n                  icon={\n                    props.isProtected ? LockKeyholeIcon : LockKeyholeOpenIcon\n                  }\n                  isLoading={props.isProtectedLoading}\n                />\n                <GenerationTaskDeleteMemoConfirmDialog\n                  onDelete={props.onDelete}\n                  isDeletedLoading={props.isDeletedLoading}\n                />\n              </div>\n              <div className=\"py-2\">\n                <Separator />\n              </div>\n              <div className=\"my-4 flex justify-end gap-x-2\">\n                <StarRating\n                  value={props.rating}\n                  onChange={(value) => {\n                    props.setRating(value)\n                    props.onChangeRating(props.task.nanoid ?? \"\", value)\n                  }}\n                  isLoading={props.isRatingLoading}\n                />\n                <div className=\"ml-auto\">\n                  <GenerationMenuButton\n                    title={t(\n                      \"AIã§ç”»åƒã‚’ä¿®æ­£(5æšæ¶ˆè²»)ã™ã‚‹\",\n                      \"Modify image with AI\",\n                    )}\n                    onClick={props.onInPaint}\n                    text={t(\"AIä¿®æ­£\", \"AI Modify\")}\n                    icon={PenIcon}\n                  />\n                </div>\n              </div>\n              <div className=\"py-2\">\n                <Separator />\n              </div>\n            </>\n          )}\n          <div className=\"flex gap-x-2\">\n            <div className=\"basis-1/3 space-y-1\">\n              <p className=\"font-bold\">{t(\"Size\", \"Size\")}</p>\n              <p>\n                {width}x{height}\n              </p>\n            </div>\n            <div className=\"basis-1/3 space-y-1\">\n              <p className=\"font-bold\">{t(\"Model\", \"Model\")}</p>\n              <p>{extractStringBeforeComma(props.task.model?.name)}</p>\n            </div>\n          </div>\n          <div className=\"py-2\">\n            <Separator />\n          </div>\n          <div className=\"space-y-2\">\n            <p className=\"font-bold\">{t(\"prompt\", \"Prompt\")}</p>\n            <AutoResizeTextarea\n              disabled={true}\n              className=\"max-h-24 w-[100%] overflow-y-auto rounded-md border p-2 text-sm disabled:opacity-100\"\n            >\n              {props.task.prompt}\n            </AutoResizeTextarea>\n            <CopyButton text={props.task.prompt} />\n          </div>\n          <div className=\"py-2\">\n            <Separator />\n          </div>\n          {props.task.promptsText && (\n            <>\n              <div className=\"space-y-2\">\n                <p className=\"font-bold\">{t(\"å…ƒã®æ–‡ç« \", \"Original Text\")}</p>\n                <AutoResizeTextarea\n                  disabled={true}\n                  className=\"max-h-24 w-[100%] overflow-y-auto rounded-md border p-2 text-sm disabled:opacity-100\"\n                >\n                  {props.task.promptsText}\n                </AutoResizeTextarea>\n                <CopyButton text={props.task.promptsText} />\n              </div>\n              <div className=\"py-2\">\n                <Separator />\n              </div>\n            </>\n          )}\n          <div className=\"space-y-2\">\n            <p className=\"font-bold\">\n              {t(\"NegativePrompt\", \"Negative Prompt\")}\n            </p>\n            <AutoResizeTextarea\n              disabled={true}\n              className=\"max-h-24 w-[100%] overflow-y-auto rounded-md border p-2 text-sm disabled:opacity-100\"\n            >\n              {props.task.negativePrompt}\n            </AutoResizeTextarea>\n\n            <CopyButton text={props.task.negativePrompt} />\n          </div>\n          <div className=\"py-2\">\n            <Separator />\n          </div>\n          <div className=\"mb-1 flex space-x-4\">\n            <div className=\"w-full space-y-1\">\n              <p className=\"font-bold\">{t(\"Scale\", \"Scale\")}</p>\n              <p>{props.task.scale}</p>\n            </div>\n            <div className=\"w-full space-y-1\">\n              <p className=\"font-bold\">{t(\"Steps\", \"Steps\")}</p>\n              <p>{props.task.steps}</p>\n            </div>\n            <div className=\"w-full space-y-1\">\n              <p className=\"font-bold\">{t(\"Sampler\", \"Sampler\")}</p>\n              <p>{props.task.sampler}</p>\n            </div>\n          </div>\n          <div className=\"py-2\">\n            <Separator />\n          </div>\n          <div className=\"flex space-x-4\">\n            <div className=\"w-full space-y-1\">\n              <p className=\"font-bold\">{t(\"ClipSkip\", \"ClipSkip\")}</p>\n              <p>{props.task.clipSkip}</p>\n            </div>\n            <div className=\"w-full space-y-1\">\n              <p className=\"font-bold\">{t(\"Vae\", \"VAE\")}</p>\n              <p>\n                {props.task.vae\n                  ?.replace(\".ckpt\", \"\")\n                  .replace(\".safetensors\", \"\") ?? \"\"}\n              </p>\n            </div>\n            <div className=\"w-full space-y-1\">\n              <p className=\"font-bold\">{t(\"Seed\", \"Seed\")}</p>\n              <p>{props.task.seed}</p>\n            </div>\n          </div>\n          {(props.task.controlNetModule || props.task.controlNetWeight) && (\n            <>\n              <div className=\"py-2\">\n                <Separator />\n              </div>\n              <div className=\"flex space-x-4\">\n                {props.task.controlNetModule && (\n                  <div className=\"w-full space-y-1\">\n                    <p className=\"font-bold\">{t(\"Module\", \"Module\")}</p>\n                    <p>{props.task.controlNetModule}</p>\n                  </div>\n                )}\n                {props.task.controlNetWeight && (\n                  <div className=\"w-full space-y-1\">\n                    <p className=\"font-bold\">{t(\"Weight\", \"Weight\")}</p>\n                    <p>{props.task.controlNetWeight}</p>\n                  </div>\n                )}\n                <div className=\"w-full space-y-1\" />\n              </div>\n            </>\n          )}\n          <div className=\"py-2\">\n            <Separator />\n          </div>\n          {props.task.completedAt && (\n            <div className=\"w-full space-y-1\">\n              <p className=\"font-bold\">{t(\"ç”Ÿæˆæ—¥æ™‚\", \"Generation Date\")}</p>\n              <p>{toDateTimeText(props.task.completedAt)}</p>\n            </div>\n          )}\n        </div>\n      </ScrollArea>\n      {props.task.imageUrl && userToken && (\n        <GeminiImageModificationDialog\n          isOpen={props.showAiModificationDialog}\n          onClose={() => props.setShowAiModificationDialog(false)}\n          taskId={props.task.id}\n          token={userToken}\n          imageUrl={normalizeGenerativeFileUrl(props.task.imageUrl)}\n          userNanoid={props.userNanoid}\n          originalPrompt={props.task.prompt || \"\"}\n        />\n      )}\n    </>\n  )\n}\n\nexport const GenerationImageResultSheetContentFragment = graphql(\n  `fragment GenerationImageResultSheetContent on ImageGenerationResultNode @_unmask {\n    id\n    nanoid\n    prompt\n    promptsText\n    negativePrompt\n    upscaleSize\n    seed\n    steps\n    scale\n    sampler\n    clipSkip\n    imageUrl\n    sizeType\n    vae\n    controlNetModule\n    controlNetWeight\n    thumbnailUrl\n    status\n    completedAt\n    rating\n    isProtected\n    model {\n      id\n      name\n    }\n  }`,\n)\n\nexport const GenerationImageResultSheetContentTaskFragment = graphql(\n  `fragment GenerationImageResultSheetContentTask on ImageGenerationTaskNode @_unmask {\n    id\n    nanoid\n    prompt\n    promptsText\n    negativePrompt\n    upscaleSize\n    seed\n    steps\n    scale\n    sampler\n    clipSkip\n    imageUrl\n    sizeType\n    vae\n    controlNetModule\n    controlNetWeight\n    thumbnailUrl\n    status\n    completedAt\n    rating\n    isProtected\n    model {\n      id\n      name\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/complexity/noUselessFragments","severity":"information","description":"This fragment is unnecessary.","message":[{"elements":[],"content":"This fragment is unnecessary."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"A fragment is redundant if it contains only one child, or if it is the child of a html element, and is not a keyed "},{"elements":[{"Hyperlink":{"href":"https://legacy.reactjs.org/docs/fragments.html#keyed-fragments"}}],"content":"fragment"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/task-view/generation-task-content-preview.tsx"},"span":[4392,4397],"sourceCode":"import { Card } from \"~/components/ui/card\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useCachedImageGenerationResult } from \"~/routes/($lang).generation._index/hooks/use-cached-image-generation-result\"\nimport { useCachedImageGenerationTask } from \"~/routes/($lang).generation._index/hooks/use-cached-image-generation-task\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { useContext } from \"react\"\nimport { cn } from \"~/lib/utils\"\nimport { normalizeGenerativeFileUrl } from \"~/utils/normalize-generative-file-url\"\n\n/**\n * ã‚¿ã‚¹ã‚¯ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼å†…å®¹\n */\nexport function GenerationTaskContentPreview () {\n  const context = useGenerationContext()\n\n  const authContext = useContext(AuthContext)\n\n  const previewTaskId = context.config.previewTaskId ?? \"\"\n\n  const imageGenerationTask = useCachedImageGenerationTask(previewTaskId)\n\n  const imageGenerationResult = useCachedImageGenerationResult(previewTaskId)\n\n  if (authContext === null || !context.config.previewTaskId) {\n    return null\n  }\n\n  const userToken = context.config.currentUserToken\n\n  return (\n    <>\n      <Card className=\"flex h-[100vh] w-auto flex-col\">\n        {imageGenerationTask?.imageUrl &&\n        imageGenerationTask?.thumbnailUrl &&\n        userToken ? (\n          <div className=\"m-auto max-h-[100vh]\">\n            <img\n              className={cn(\n                `generation-image-${imageGenerationTask.id}`,\n                \"max-h-[64vh]\",\n              )}\n              src={\n                context.config.taskListThumbnailType === \"light\"\n                  ? normalizeGenerativeFileUrl(imageGenerationTask.thumbnailUrl)\n                  : normalizeGenerativeFileUrl(imageGenerationTask.imageUrl)\n              }\n              data-original={normalizeGenerativeFileUrl(\n                imageGenerationTask.imageUrl,\n              )}\n              data-generative-raw={\n                context.config.taskListThumbnailType === \"light\"\n                  ? imageGenerationTask.thumbnailUrl\n                  : imageGenerationTask.imageUrl\n              }\n              onError={(event) => {\n                const img = event.currentTarget\n                const raw = img.dataset.generativeRaw\n                if (!raw) return\n                if (img.dataset.generativeFallback === \"true\") {\n                  return\n                }\n                img.dataset.generativeFallback = \"true\"\n                img.src = raw\n              }}\n              alt={\"-\"}\n            />\n            <div className=\"m-auto mb-1\">\n              <p className=\"mb-1 font-semibold\">{\"Model\"}</p>\n              <p>{imageGenerationTask.model?.name}</p>\n            </div>\n          </div>\n        ) : (\n          <></>\n        )}\n\n        {imageGenerationResult?.imageUrl &&\n        imageGenerationResult?.thumbnailUrl &&\n        userToken ? (\n          <div className=\"m-auto max-h-[100vh]\">\n            <img\n              className={cn(\n                `generation-image-${imageGenerationResult.id}`,\n                \"max-h-[64vh]\",\n              )}\n              src={\n                context.config.taskListThumbnailType === \"light\"\n                  ? normalizeGenerativeFileUrl(\n                      imageGenerationResult.thumbnailUrl,\n                    )\n                  : normalizeGenerativeFileUrl(imageGenerationResult.imageUrl)\n              }\n              data-original={normalizeGenerativeFileUrl(\n                imageGenerationResult.imageUrl,\n              )}\n              data-generative-raw={\n                context.config.taskListThumbnailType === \"light\"\n                  ? imageGenerationResult.thumbnailUrl\n                  : imageGenerationResult.imageUrl\n              }\n              onError={(event) => {\n                const img = event.currentTarget\n                const raw = img.dataset.generativeRaw\n                if (!raw) return\n                if (img.dataset.generativeFallback === \"true\") {\n                  return\n                }\n                img.dataset.generativeFallback = \"true\"\n                img.src = raw\n              }}\n              alt={\"-\"}\n            />\n            <div className=\"m-auto mb-1\">\n              <p className=\"mb-1 font-semibold\">{\"Model\"}</p>\n              <p>{imageGenerationResult.model?.name}</p>\n            </div>\n          </div>\n        ) : (\n          <></>\n        )}\n      </Card>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/complexity/noUselessFragments","severity":"information","description":"This fragment is unnecessary.","message":[{"elements":[],"content":"This fragment is unnecessary."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"A fragment is redundant if it contains only one child, or if it is the child of a html element, and is not a keyed "},{"elements":[{"Hyperlink":{"href":"https://legacy.reactjs.org/docs/fragments.html#keyed-fragments"}}],"content":"fragment"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/task-view/generation-task-content-preview.tsx"},"span":[2758,2763],"sourceCode":"import { Card } from \"~/components/ui/card\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useCachedImageGenerationResult } from \"~/routes/($lang).generation._index/hooks/use-cached-image-generation-result\"\nimport { useCachedImageGenerationTask } from \"~/routes/($lang).generation._index/hooks/use-cached-image-generation-task\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { useContext } from \"react\"\nimport { cn } from \"~/lib/utils\"\nimport { normalizeGenerativeFileUrl } from \"~/utils/normalize-generative-file-url\"\n\n/**\n * ã‚¿ã‚¹ã‚¯ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼å†…å®¹\n */\nexport function GenerationTaskContentPreview () {\n  const context = useGenerationContext()\n\n  const authContext = useContext(AuthContext)\n\n  const previewTaskId = context.config.previewTaskId ?? \"\"\n\n  const imageGenerationTask = useCachedImageGenerationTask(previewTaskId)\n\n  const imageGenerationResult = useCachedImageGenerationResult(previewTaskId)\n\n  if (authContext === null || !context.config.previewTaskId) {\n    return null\n  }\n\n  const userToken = context.config.currentUserToken\n\n  return (\n    <>\n      <Card className=\"flex h-[100vh] w-auto flex-col\">\n        {imageGenerationTask?.imageUrl &&\n        imageGenerationTask?.thumbnailUrl &&\n        userToken ? (\n          <div className=\"m-auto max-h-[100vh]\">\n            <img\n              className={cn(\n                `generation-image-${imageGenerationTask.id}`,\n                \"max-h-[64vh]\",\n              )}\n              src={\n                context.config.taskListThumbnailType === \"light\"\n                  ? normalizeGenerativeFileUrl(imageGenerationTask.thumbnailUrl)\n                  : normalizeGenerativeFileUrl(imageGenerationTask.imageUrl)\n              }\n              data-original={normalizeGenerativeFileUrl(\n                imageGenerationTask.imageUrl,\n              )}\n              data-generative-raw={\n                context.config.taskListThumbnailType === \"light\"\n                  ? imageGenerationTask.thumbnailUrl\n                  : imageGenerationTask.imageUrl\n              }\n              onError={(event) => {\n                const img = event.currentTarget\n                const raw = img.dataset.generativeRaw\n                if (!raw) return\n                if (img.dataset.generativeFallback === \"true\") {\n                  return\n                }\n                img.dataset.generativeFallback = \"true\"\n                img.src = raw\n              }}\n              alt={\"-\"}\n            />\n            <div className=\"m-auto mb-1\">\n              <p className=\"mb-1 font-semibold\">{\"Model\"}</p>\n              <p>{imageGenerationTask.model?.name}</p>\n            </div>\n          </div>\n        ) : (\n          <></>\n        )}\n\n        {imageGenerationResult?.imageUrl &&\n        imageGenerationResult?.thumbnailUrl &&\n        userToken ? (\n          <div className=\"m-auto max-h-[100vh]\">\n            <img\n              className={cn(\n                `generation-image-${imageGenerationResult.id}`,\n                \"max-h-[64vh]\",\n              )}\n              src={\n                context.config.taskListThumbnailType === \"light\"\n                  ? normalizeGenerativeFileUrl(\n                      imageGenerationResult.thumbnailUrl,\n                    )\n                  : normalizeGenerativeFileUrl(imageGenerationResult.imageUrl)\n              }\n              data-original={normalizeGenerativeFileUrl(\n                imageGenerationResult.imageUrl,\n              )}\n              data-generative-raw={\n                context.config.taskListThumbnailType === \"light\"\n                  ? imageGenerationResult.thumbnailUrl\n                  : imageGenerationResult.imageUrl\n              }\n              onError={(event) => {\n                const img = event.currentTarget\n                const raw = img.dataset.generativeRaw\n                if (!raw) return\n                if (img.dataset.generativeFallback === \"true\") {\n                  return\n                }\n                img.dataset.generativeFallback = \"true\"\n                img.src = raw\n              }}\n              alt={\"-\"}\n            />\n            <div className=\"m-auto mb-1\">\n              <p className=\"mb-1 font-semibold\">{\"Model\"}</p>\n              <p>{imageGenerationResult.model?.name}</p>\n            </div>\n          </div>\n        ) : (\n          <></>\n        )}\n      </Card>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/app/app-breadcrumb-script.tsx"},"span":[322,335],"sourceCode":"import type { BreadcrumbList, WithContext } from \"schema-dts\"\n\ntype Props = Readonly<{\n  breadcrumb: WithContext<BreadcrumbList>\n}>\n\nexport function AppBreadcrumbScript (props: Props): React.ReactNode {\n  return (\n    <script\n      type=\"application/ld+json\"\n      // biome-ignore lint/security/noDangerouslySetInnerHtml: <explanation>\n      dangerouslySetInnerHTML={{ __html: JSON.stringify(props.breadcrumb) }}\n    />\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/app/app-markdown.tsx"},"span":[2093,2106],"sourceCode":"import \"zenn-content-css\"\n\nimport { cn } from \"~/lib/utils\"\nimport { marked } from \"marked\"\nimport type React from \"react\"\n\ntype Props = Readonly<{\n  className?: string\n  breaks?: boolean\n  children: React.ReactNode\n}>\n\nexport function AppMarkdown (props: Props): React.ReactNode {\n  if (typeof props.children !== \"string\") {\n    return <>{props.children}</>\n  }\n\n  const html = marked(props.children, {\n    breaks: props.breaks ?? false,\n  })\n\n  return (\n    <div\n      className={cn(\n        \"znc\",\n        // åŸºæœ¬çš„ãªã‚¹ã‚¿ã‚¤ãƒ«\n        \"text-foreground leading-relaxed\",\n        // ãƒ˜ãƒƒãƒ€ãƒ¼ã®ã‚¹ã‚¿ã‚¤ãƒ«\n        \"[&>h1]:mt-8 [&>h1]:mb-6 [&>h1]:border-b [&>h1]:pb-2 [&>h1]:font-bold [&>h1]:text-2xl [&>h1]:text-foreground\",\n        \"[&>h2]:mt-6 [&>h2]:mb-4 [&>h2]:font-semibold [&>h2]:text-foreground [&>h2]:text-xl\",\n        \"[&>h3]:mt-4 [&>h3]:mb-3 [&>h3]:font-medium [&>h3]:text-foreground [&>h3]:text-lg\",\n        // ãƒ‘ãƒ©ã‚°ãƒ©ãƒ•ã¨ãƒªã‚¹ãƒˆã®ã‚¹ã‚¿ã‚¤ãƒ«\n        \"[&>p]:mb-4 [&>p]:text-muted-foreground [&>p]:leading-relaxed\",\n        \"[&>ul>li]:mb-2 [&>ul>li]:text-muted-foreground [&>ul>li]:leading-relaxed [&>ul]:mb-4 [&>ul]:pl-6\",\n        \"[&>ol>li]:mb-2 [&>ol>li]:text-muted-foreground [&>ol>li]:leading-relaxed [&>ol]:mb-4 [&>ol]:pl-6\",\n        // ãƒªãƒ³ã‚¯ã®ã‚¹ã‚¿ã‚¤ãƒ«\n        \"[&>p>a]:text-blue-600 [&>p>a]:underline [&>p>a]:underline-offset-2 hover:[&>p>a]:text-blue-800 dark:[&>p>a]:text-blue-400 dark:hover:[&>p>a]:text-blue-300\",\n        // ãƒ–ãƒ­ãƒƒã‚¯ã‚¯ã‚©ãƒ¼ãƒˆã®ã‚¹ã‚¿ã‚¤ãƒ«\n        \"[&>blockquote]:mb-4 [&>blockquote]:border-muted [&>blockquote]:border-l-4 [&>blockquote]:pl-4 [&>blockquote]:text-muted-foreground [&>blockquote]:italic\",\n        // ã‚³ãƒ¼ãƒ‰ã®ã‚¹ã‚¿ã‚¤ãƒ«\n        \"[&>pre]:mb-4 [&>pre]:overflow-x-auto [&>pre]:rounded-md [&>pre]:bg-muted [&>pre]:p-4\",\n        \"[&>p>code]:rounded [&>p>code]:bg-muted [&>p>code]:px-2 [&>p>code]:py-1 [&>p>code]:text-sm\",\n        // ãã®ä»–ã®ã‚¹ã‚¿ã‚¤ãƒ«\n        \"[&>hr]:my-8 [&>hr]:border-border\",\n        props.className,\n      )}\n      // biome-ignore lint/security/noDangerouslySetInnerHtml: <explanation>\n      dangerouslySetInnerHTML={{ __html: html }}\n    />\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/button/follow-button.tsx"},"span":[5228,5336],"sourceCode":"\"use client\"\n\nimport { useMutation } from \"@apollo/client/index\"\nimport { useContext, useEffect, useState } from \"react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { LoginDialogButton } from \"~/components/login-dialog-button\"\nimport { cn } from \"~/lib/utils\"\nimport { graphql } from \"gql.tada\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"~/components/ui/alert-dialog\"\nimport { toast } from \"sonner\"\n\ntype Props = {\n  targetUserId: string\n  isFollow: boolean\n  className?: string\n  triggerChildren?: React.ReactNode\n  unFollowTriggerChildren?: React.ReactNode\n}\n\n/**\n * ãƒ•ã‚©ãƒ­ãƒ¼\n */\nexport function FollowButton (props: Props): React.ReactNode {\n  const authContext = useContext(AuthContext)\n\n  const [isFollow, setIsFollow] = useState(props.isFollow)\n  const [isOpen, setIsOpen] = useState(false)\n  const [_isDeleted, _setIsDeleted] = useState(false)\n\n  const t = useTranslation()\n\n  useEffect(() => {\n    setIsFollow(props.isFollow)\n  }, [props.isFollow])\n\n  const [follow, { loading: isFollowing }] = useMutation(followUserMutation)\n\n  const [unFollow, { loading: isUnFollowing }] =\n    useMutation(unfollowUserMutation)\n\n  const onFollow = async () => {\n    try {\n      const res = await follow({\n        variables: {\n          input: {\n            userId: props.targetUserId,\n          },\n        },\n      })\n      setIsFollow(res.data?.followUser?.isFollowee ?? false)\n      toast.success(t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¾ã—ãŸ\", \"You have followed the user\"))\n    } catch (e) {\n      console.error(e)\n      toast.error(t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to follow the user\"))\n    }\n  }\n\n  const onUnFollow = async () => {\n    try {\n      const res = await unFollow({\n        variables: {\n          input: {\n            userId: props.targetUserId,\n          },\n        },\n      })\n      setIsFollow(res.data?.unfollowUser?.isFollowee ?? false)\n      toast.success(\n        t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã‚’è§£é™¤ã—ã¾ã—ãŸ\", \"You have un followed the user\"),\n      )\n      setIsOpen(false)\n    } catch (e) {\n      console.error(e)\n      toast.error(\n        t(\"ãƒ•ã‚©ãƒ­ãƒ¼è§£é™¤ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to un follow the user\"),\n      )\n    }\n  }\n\n  const triggerNode = props.triggerChildren ?? (\n    <button\n      type=\"button\"\n      onClick={() => {}}\n      className={`h-8 w-full rounded-full bg-clear-bright-blue p-1 font-bold text-white transition duration-500 hover:opacity-80 ${props.className}`}\n    >\n      {t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹\", \"Follow\")}\n    </button>\n  )\n\n  const unFollowTriggerNode = props.unFollowTriggerChildren ?? (\n    <button\n      type=\"button\"\n      onClick={() => {}}\n      className={`h-8 w-full rounded-full bg-gray-500 p-1 font-bold text-white opacity-50 transition duration-500 hover:opacity-30 ${props.className}`}\n    >\n      {t(\"ãƒ•ã‚©ãƒ­ãƒ¼ä¸­\", \"Following\")}\n    </button>\n  )\n\n  /* æœªãƒ­ã‚°ã‚¤ãƒ³ */\n  if (authContext.isLoading || authContext.isNotLoggedIn) {\n    return (\n      <LoginDialogButton\n        label={t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹\", \"Follow\")}\n        isLoading={authContext.isLoading || authContext.isLoggedIn}\n        isWidthFull={true}\n        description={t(\n          \"ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã€ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼\",\n          \"Log in and try following!\",\n        )}\n        triggerChildren={triggerNode}\n      />\n    )\n  }\n\n  /* è‡ªåˆ†è‡ªèº«ã®å ´åˆã¯ãƒ•ã‚©ãƒ­ãƒ¼ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤ºã—ãªã„ */\n  if (authContext.userId === props.targetUserId) {\n    return null\n  }\n\n  return isFollow ? (\n    <AlertDialog open={isOpen} onOpenChange={setIsOpen}>\n      <AlertDialogTrigger asChild>\n        {/* biome-ignore lint/a11y/useSemanticElements: wrapper div avoids nested buttons; keyboard handlers provided */}\n        <div\n          role=\"button\"\n          tabIndex={0}\n          onClick={() => {\n            if (isFollowing || isUnFollowing) return\n            setIsOpen(true)\n          }}\n          onKeyDown={(event) => {\n            if (event.key !== \"Enter\" && event.key !== \" \") return\n            event.preventDefault()\n            if (isFollowing || isUnFollowing) return\n            setIsOpen(true)\n          }}\n          className={cn(isFollowing || isUnFollowing ? \"opacity-80\" : \"\")}\n        >\n          {unFollowTriggerNode}\n        </div>\n      </AlertDialogTrigger>\n      <AlertDialogContent>\n        <AlertDialogHeader>\n          <AlertDialogTitle>{t(\"ç¢ºèª\", \"Confirm\")}</AlertDialogTitle>\n          <AlertDialogDescription>\n            {t(\n              \"æœ¬å½“ã«ãƒ•ã‚©ãƒ­ãƒ¼ã‚’è§£é™¤ã—ã¾ã™ã‹ï¼Ÿ\",\n              \"Are you sure you want to unfollow?\",\n            )}\n          </AlertDialogDescription>\n        </AlertDialogHeader>\n        <AlertDialogFooter>\n          <AlertDialogCancel onClick={() => setIsOpen(false)}>\n            {t(\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\", \"Cancel\")}\n          </AlertDialogCancel>\n          <AlertDialogAction onClick={onUnFollow}>\n            {t(\"è§£é™¤ã™ã‚‹\", \"Unfollow\")}\n          </AlertDialogAction>\n        </AlertDialogFooter>\n      </AlertDialogContent>\n    </AlertDialog>\n  ) : (\n    // biome-ignore lint/a11y/useSemanticElements: wrapper div avoids nested buttons; keyboard handlers provided\n    <div\n      role=\"button\"\n      tabIndex={0}\n      onClick={() => {\n        if (isFollowing || isUnFollowing) return\n        onFollow()\n      }}\n      onKeyDown={(event) => {\n        if (event.key !== \"Enter\" && event.key !== \" \") return\n        event.preventDefault()\n        if (isFollowing || isUnFollowing) return\n        onFollow()\n      }}\n      className={cn(isFollowing || isUnFollowing ? \"opacity-80\" : \"\")}\n    >\n      {triggerNode}\n    </div>\n  )\n}\n\nconst followUserMutation = graphql(\n  `mutation FollowUser($input: FollowUserInput!) {\n    followUser(input: $input) {\n      id\n      isFollowee\n    }\n  }`,\n)\n\nconst unfollowUserMutation = graphql(\n  `mutation UnfollowUser($input: UnfollowUserInput!) {\n    unfollowUser(input: $input) {\n      id\n      isFollowee\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/button/follow-button.tsx"},"span":[3790,3901],"sourceCode":"\"use client\"\n\nimport { useMutation } from \"@apollo/client/index\"\nimport { useContext, useEffect, useState } from \"react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { LoginDialogButton } from \"~/components/login-dialog-button\"\nimport { cn } from \"~/lib/utils\"\nimport { graphql } from \"gql.tada\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"~/components/ui/alert-dialog\"\nimport { toast } from \"sonner\"\n\ntype Props = {\n  targetUserId: string\n  isFollow: boolean\n  className?: string\n  triggerChildren?: React.ReactNode\n  unFollowTriggerChildren?: React.ReactNode\n}\n\n/**\n * ãƒ•ã‚©ãƒ­ãƒ¼\n */\nexport function FollowButton (props: Props): React.ReactNode {\n  const authContext = useContext(AuthContext)\n\n  const [isFollow, setIsFollow] = useState(props.isFollow)\n  const [isOpen, setIsOpen] = useState(false)\n  const [_isDeleted, _setIsDeleted] = useState(false)\n\n  const t = useTranslation()\n\n  useEffect(() => {\n    setIsFollow(props.isFollow)\n  }, [props.isFollow])\n\n  const [follow, { loading: isFollowing }] = useMutation(followUserMutation)\n\n  const [unFollow, { loading: isUnFollowing }] =\n    useMutation(unfollowUserMutation)\n\n  const onFollow = async () => {\n    try {\n      const res = await follow({\n        variables: {\n          input: {\n            userId: props.targetUserId,\n          },\n        },\n      })\n      setIsFollow(res.data?.followUser?.isFollowee ?? false)\n      toast.success(t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¾ã—ãŸ\", \"You have followed the user\"))\n    } catch (e) {\n      console.error(e)\n      toast.error(t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to follow the user\"))\n    }\n  }\n\n  const onUnFollow = async () => {\n    try {\n      const res = await unFollow({\n        variables: {\n          input: {\n            userId: props.targetUserId,\n          },\n        },\n      })\n      setIsFollow(res.data?.unfollowUser?.isFollowee ?? false)\n      toast.success(\n        t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã‚’è§£é™¤ã—ã¾ã—ãŸ\", \"You have un followed the user\"),\n      )\n      setIsOpen(false)\n    } catch (e) {\n      console.error(e)\n      toast.error(\n        t(\"ãƒ•ã‚©ãƒ­ãƒ¼è§£é™¤ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to un follow the user\"),\n      )\n    }\n  }\n\n  const triggerNode = props.triggerChildren ?? (\n    <button\n      type=\"button\"\n      onClick={() => {}}\n      className={`h-8 w-full rounded-full bg-clear-bright-blue p-1 font-bold text-white transition duration-500 hover:opacity-80 ${props.className}`}\n    >\n      {t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹\", \"Follow\")}\n    </button>\n  )\n\n  const unFollowTriggerNode = props.unFollowTriggerChildren ?? (\n    <button\n      type=\"button\"\n      onClick={() => {}}\n      className={`h-8 w-full rounded-full bg-gray-500 p-1 font-bold text-white opacity-50 transition duration-500 hover:opacity-30 ${props.className}`}\n    >\n      {t(\"ãƒ•ã‚©ãƒ­ãƒ¼ä¸­\", \"Following\")}\n    </button>\n  )\n\n  /* æœªãƒ­ã‚°ã‚¤ãƒ³ */\n  if (authContext.isLoading || authContext.isNotLoggedIn) {\n    return (\n      <LoginDialogButton\n        label={t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹\", \"Follow\")}\n        isLoading={authContext.isLoading || authContext.isLoggedIn}\n        isWidthFull={true}\n        description={t(\n          \"ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã€ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼\",\n          \"Log in and try following!\",\n        )}\n        triggerChildren={triggerNode}\n      />\n    )\n  }\n\n  /* è‡ªåˆ†è‡ªèº«ã®å ´åˆã¯ãƒ•ã‚©ãƒ­ãƒ¼ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤ºã—ãªã„ */\n  if (authContext.userId === props.targetUserId) {\n    return null\n  }\n\n  return isFollow ? (\n    <AlertDialog open={isOpen} onOpenChange={setIsOpen}>\n      <AlertDialogTrigger asChild>\n        {/* biome-ignore lint/a11y/useSemanticElements: wrapper div avoids nested buttons; keyboard handlers provided */}\n        <div\n          role=\"button\"\n          tabIndex={0}\n          onClick={() => {\n            if (isFollowing || isUnFollowing) return\n            setIsOpen(true)\n          }}\n          onKeyDown={(event) => {\n            if (event.key !== \"Enter\" && event.key !== \" \") return\n            event.preventDefault()\n            if (isFollowing || isUnFollowing) return\n            setIsOpen(true)\n          }}\n          className={cn(isFollowing || isUnFollowing ? \"opacity-80\" : \"\")}\n        >\n          {unFollowTriggerNode}\n        </div>\n      </AlertDialogTrigger>\n      <AlertDialogContent>\n        <AlertDialogHeader>\n          <AlertDialogTitle>{t(\"ç¢ºèª\", \"Confirm\")}</AlertDialogTitle>\n          <AlertDialogDescription>\n            {t(\n              \"æœ¬å½“ã«ãƒ•ã‚©ãƒ­ãƒ¼ã‚’è§£é™¤ã—ã¾ã™ã‹ï¼Ÿ\",\n              \"Are you sure you want to unfollow?\",\n            )}\n          </AlertDialogDescription>\n        </AlertDialogHeader>\n        <AlertDialogFooter>\n          <AlertDialogCancel onClick={() => setIsOpen(false)}>\n            {t(\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\", \"Cancel\")}\n          </AlertDialogCancel>\n          <AlertDialogAction onClick={onUnFollow}>\n            {t(\"è§£é™¤ã™ã‚‹\", \"Unfollow\")}\n          </AlertDialogAction>\n        </AlertDialogFooter>\n      </AlertDialogContent>\n    </AlertDialog>\n  ) : (\n    // biome-ignore lint/a11y/useSemanticElements: wrapper div avoids nested buttons; keyboard handlers provided\n    <div\n      role=\"button\"\n      tabIndex={0}\n      onClick={() => {\n        if (isFollowing || isUnFollowing) return\n        onFollow()\n      }}\n      onKeyDown={(event) => {\n        if (event.key !== \"Enter\" && event.key !== \" \") return\n        event.preventDefault()\n        if (isFollowing || isUnFollowing) return\n        onFollow()\n      }}\n      className={cn(isFollowing || isUnFollowing ? \"opacity-80\" : \"\")}\n    >\n      {triggerNode}\n    </div>\n  )\n}\n\nconst followUserMutation = graphql(\n  `mutation FollowUser($input: FollowUserInput!) {\n    followUser(input: $input) {\n      id\n      isFollowee\n    }\n  }`,\n)\n\nconst unfollowUserMutation = graphql(\n  `mutation UnfollowUser($input: UnfollowUserInput!) {\n    unfollowUser(input: $input) {\n      id\n      isFollowee\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/button/tag-follow-button.tsx"},"span":[3444,3552],"sourceCode":"import { useMutation } from \"@apollo/client/index\"\nimport { useContext, useEffect, useState } from \"react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { LoginDialogButton } from \"~/components/login-dialog-button\"\nimport { cn } from \"~/lib/utils\"\nimport { graphql } from \"gql.tada\"\nimport { toast } from \"sonner\"\nimport { CrossPlatformTooltip } from \"~/components/cross-platform-tooltip\"\nimport { useTranslation } from \"~/hooks/use-translation\" // ç¿»è¨³å¯¾å¿œ\n\ntype Props = {\n  tag: string\n  isFollow: boolean\n  className?: string\n  triggerChildren?: React.ReactNode\n  unFollowTriggerChildren?: React.ReactNode\n}\n\n/**\n * ã‚¿ã‚°ãŠæ°—ã«å…¥ã‚Šç™»éŒ²\n */\nexport function TagFollowButton (props: Props): React.ReactNode {\n  const t = useTranslation() // ç¿»è¨³ãƒ•ãƒƒã‚¯\n  const authContext = useContext(AuthContext)\n\n  const [isFollow, setIsFollow] = useState(props.isFollow)\n\n  useEffect(() => {\n    setIsFollow(props.isFollow)\n  }, [props.isFollow])\n\n  const [follow, { loading: isFollowing }] = useMutation(followTagMutation)\n  const [unFollow, { loading: isUnFollowing }] =\n    useMutation(unfollowTagMutation)\n\n  const onFollow = async () => {\n    try {\n      const _res = await follow({\n        variables: {\n          input: {\n            tagName: props.tag,\n          },\n        },\n      })\n      setIsFollow(true)\n    } catch (e) {\n      console.error(e)\n      toast.error(t(\"ãŠæ°—ã«å…¥ã‚Šç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to follow tag\"))\n    }\n  }\n\n  const onUnFollow = async () => {\n    try {\n      const _res = await unFollow({\n        variables: {\n          input: {\n            tagName: props.tag,\n          },\n        },\n      })\n      setIsFollow(false)\n    } catch (e) {\n      console.error(e)\n      toast.error(t(\"ãŠæ°—ã«å…¥ã‚Šè§£é™¤ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to unfollow tag\"))\n    }\n  }\n\n  const triggerNode = props.triggerChildren ?? (\n    <button\n      type=\"button\"\n      onClick={onFollow}\n      className={cn(\n        \"h-10 w-full rounded-full bg-clear-bright-blue p-1 font-bold text-white transition duration-500 hover:opacity-80\",\n        props.className,\n      )}\n    >\n      {t(\"ãŠæ°—ã«å…¥ã‚Šç™»éŒ²\", \"Follow\")}\n    </button>\n  )\n\n  const unFollowTriggerNode = props.unFollowTriggerChildren ?? (\n    <button\n      type=\"button\"\n      onClick={onUnFollow}\n      className={cn(\n        \"h-10 w-full rounded-full bg-gray-500 p-1 font-bold text-white opacity-50 transition duration-500 hover:opacity-30\",\n        props.className,\n      )}\n    >\n      {t(\"ãŠæ°—ã«å…¥ã‚Šè§£é™¤\", \"Unfollow\")}\n    </button>\n  )\n\n  /* æœªãƒ­ã‚°ã‚¤ãƒ³ */\n  if (authContext.isLoading || authContext.isNotLoggedIn) {\n    return (\n      <LoginDialogButton\n        label={t(\"ãŠæ°—ã«å…¥ã‚Šç™»éŒ²\", \"Follow\")}\n        isLoading={authContext.isLoading || authContext.isLoggedIn}\n        isWidthFull={true}\n        description={t(\n          \"ã‚¿ã‚°ã‚’ãŠæ°—ã«å…¥ã‚Šç™»éŒ²ã—ã¦æŠ•ç¨¿ã‚’ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼\",\n          \"Follow tags to see related posts!\",\n        )}\n        triggerChildren={triggerNode}\n      />\n    )\n  }\n\n  if (!props.tag) {\n    return null\n  }\n\n  return (\n    <div className=\"flex w-full items-center space-x-2\">\n      <CrossPlatformTooltip\n        text={t(\n          \"ã‚¿ã‚°ã®ã¤ã„ãŸæ–°ç€ä½œå“ã‚’ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã§ãƒã‚§ãƒƒã‚¯ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™\",\n          \"You can check new works with this tag in your timeline\",\n        )}\n      />\n      {isFollow ? (\n        // biome-ignore lint/a11y/useSemanticElements: wrapper div avoids nested buttons; keyboard handlers provided\n        <div\n          role=\"button\"\n          tabIndex={0}\n          onClick={() => {\n            if (isFollowing || isUnFollowing) return\n            onUnFollow()\n          }}\n          onKeyDown={(event) => {\n            if (event.key !== \"Enter\" && event.key !== \" \") return\n            event.preventDefault()\n            if (isFollowing || isUnFollowing) return\n            onUnFollow()\n          }}\n          className={cn(\n            isFollowing || isUnFollowing ? \"w-full opacity-80\" : \" w-full\",\n          )}\n        >\n          {unFollowTriggerNode}\n        </div>\n      ) : (\n        // biome-ignore lint/a11y/useSemanticElements: wrapper div avoids nested buttons; keyboard handlers provided\n        <div\n          role=\"button\"\n          tabIndex={0}\n          onClick={() => {\n            if (isFollowing || isUnFollowing) return\n            onFollow()\n          }}\n          onKeyDown={(event) => {\n            if (event.key !== \"Enter\" && event.key !== \" \") return\n            event.preventDefault()\n            if (isFollowing || isUnFollowing) return\n            onFollow()\n          }}\n          className={cn(\n            isFollowing || isUnFollowing ? \"w-full opacity-80\" : \" w-full\",\n          )}\n        >\n          {triggerNode}\n        </div>\n      )}\n    </div>\n  )\n}\n\nconst followTagMutation = graphql(\n  `mutation FollowTag($input: FollowTagInput!) {\n    followTag(input: $input)\n  }`,\n)\n\nconst unfollowTagMutation = graphql(\n  `mutation UnFollowTag($input: UnfollowTagInput!) {\n    unfollowTag(input: $input)\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/button/tag-follow-button.tsx"},"span":[4149,4257],"sourceCode":"import { useMutation } from \"@apollo/client/index\"\nimport { useContext, useEffect, useState } from \"react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { LoginDialogButton } from \"~/components/login-dialog-button\"\nimport { cn } from \"~/lib/utils\"\nimport { graphql } from \"gql.tada\"\nimport { toast } from \"sonner\"\nimport { CrossPlatformTooltip } from \"~/components/cross-platform-tooltip\"\nimport { useTranslation } from \"~/hooks/use-translation\" // ç¿»è¨³å¯¾å¿œ\n\ntype Props = {\n  tag: string\n  isFollow: boolean\n  className?: string\n  triggerChildren?: React.ReactNode\n  unFollowTriggerChildren?: React.ReactNode\n}\n\n/**\n * ã‚¿ã‚°ãŠæ°—ã«å…¥ã‚Šç™»éŒ²\n */\nexport function TagFollowButton (props: Props): React.ReactNode {\n  const t = useTranslation() // ç¿»è¨³ãƒ•ãƒƒã‚¯\n  const authContext = useContext(AuthContext)\n\n  const [isFollow, setIsFollow] = useState(props.isFollow)\n\n  useEffect(() => {\n    setIsFollow(props.isFollow)\n  }, [props.isFollow])\n\n  const [follow, { loading: isFollowing }] = useMutation(followTagMutation)\n  const [unFollow, { loading: isUnFollowing }] =\n    useMutation(unfollowTagMutation)\n\n  const onFollow = async () => {\n    try {\n      const _res = await follow({\n        variables: {\n          input: {\n            tagName: props.tag,\n          },\n        },\n      })\n      setIsFollow(true)\n    } catch (e) {\n      console.error(e)\n      toast.error(t(\"ãŠæ°—ã«å…¥ã‚Šç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to follow tag\"))\n    }\n  }\n\n  const onUnFollow = async () => {\n    try {\n      const _res = await unFollow({\n        variables: {\n          input: {\n            tagName: props.tag,\n          },\n        },\n      })\n      setIsFollow(false)\n    } catch (e) {\n      console.error(e)\n      toast.error(t(\"ãŠæ°—ã«å…¥ã‚Šè§£é™¤ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to unfollow tag\"))\n    }\n  }\n\n  const triggerNode = props.triggerChildren ?? (\n    <button\n      type=\"button\"\n      onClick={onFollow}\n      className={cn(\n        \"h-10 w-full rounded-full bg-clear-bright-blue p-1 font-bold text-white transition duration-500 hover:opacity-80\",\n        props.className,\n      )}\n    >\n      {t(\"ãŠæ°—ã«å…¥ã‚Šç™»éŒ²\", \"Follow\")}\n    </button>\n  )\n\n  const unFollowTriggerNode = props.unFollowTriggerChildren ?? (\n    <button\n      type=\"button\"\n      onClick={onUnFollow}\n      className={cn(\n        \"h-10 w-full rounded-full bg-gray-500 p-1 font-bold text-white opacity-50 transition duration-500 hover:opacity-30\",\n        props.className,\n      )}\n    >\n      {t(\"ãŠæ°—ã«å…¥ã‚Šè§£é™¤\", \"Unfollow\")}\n    </button>\n  )\n\n  /* æœªãƒ­ã‚°ã‚¤ãƒ³ */\n  if (authContext.isLoading || authContext.isNotLoggedIn) {\n    return (\n      <LoginDialogButton\n        label={t(\"ãŠæ°—ã«å…¥ã‚Šç™»éŒ²\", \"Follow\")}\n        isLoading={authContext.isLoading || authContext.isLoggedIn}\n        isWidthFull={true}\n        description={t(\n          \"ã‚¿ã‚°ã‚’ãŠæ°—ã«å…¥ã‚Šç™»éŒ²ã—ã¦æŠ•ç¨¿ã‚’ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼\",\n          \"Follow tags to see related posts!\",\n        )}\n        triggerChildren={triggerNode}\n      />\n    )\n  }\n\n  if (!props.tag) {\n    return null\n  }\n\n  return (\n    <div className=\"flex w-full items-center space-x-2\">\n      <CrossPlatformTooltip\n        text={t(\n          \"ã‚¿ã‚°ã®ã¤ã„ãŸæ–°ç€ä½œå“ã‚’ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã§ãƒã‚§ãƒƒã‚¯ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™\",\n          \"You can check new works with this tag in your timeline\",\n        )}\n      />\n      {isFollow ? (\n        // biome-ignore lint/a11y/useSemanticElements: wrapper div avoids nested buttons; keyboard handlers provided\n        <div\n          role=\"button\"\n          tabIndex={0}\n          onClick={() => {\n            if (isFollowing || isUnFollowing) return\n            onUnFollow()\n          }}\n          onKeyDown={(event) => {\n            if (event.key !== \"Enter\" && event.key !== \" \") return\n            event.preventDefault()\n            if (isFollowing || isUnFollowing) return\n            onUnFollow()\n          }}\n          className={cn(\n            isFollowing || isUnFollowing ? \"w-full opacity-80\" : \" w-full\",\n          )}\n        >\n          {unFollowTriggerNode}\n        </div>\n      ) : (\n        // biome-ignore lint/a11y/useSemanticElements: wrapper div avoids nested buttons; keyboard handlers provided\n        <div\n          role=\"button\"\n          tabIndex={0}\n          onClick={() => {\n            if (isFollowing || isUnFollowing) return\n            onFollow()\n          }}\n          onKeyDown={(event) => {\n            if (event.key !== \"Enter\" && event.key !== \" \") return\n            event.preventDefault()\n            if (isFollowing || isUnFollowing) return\n            onFollow()\n          }}\n          className={cn(\n            isFollowing || isUnFollowing ? \"w-full opacity-80\" : \" w-full\",\n          )}\n        >\n          {triggerNode}\n        </div>\n      )}\n    </div>\n  )\n}\n\nconst followTagMutation = graphql(\n  `mutation FollowTag($input: FollowTagInput!) {\n    followTag(input: $input)\n  }`,\n)\n\nconst unfollowTagMutation = graphql(\n  `mutation UnFollowTag($input: UnfollowTagInput!) {\n    unfollowTag(input: $input)\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/drag/sortable-item.tsx"},"span":[1965,1978],"sourceCode":"import { ImageItem } from \"~/components/drag/image-item\"\nimport { Button } from \"~/components/ui/button\"\nimport { useSortable } from \"@dnd-kit/sortable\"\nimport { XIcon } from \"lucide-react\"\nimport { useState, type HTMLAttributes } from \"react\"\n\n// ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªã‚¢ã‚¤ãƒ†ãƒ ã®å‹\nexport type TSortableItem = {\n  id: number\n  content: string | null // ç”»åƒã®URLãªã©\n  isContentEdited?: boolean // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒç·¨é›†ã•ã‚ŒãŸã‹ã©ã†ã‹\n}\n\ntype Props = {\n  item: TSortableItem\n  isDeletable?: boolean\n  onDelete?: (id: number) => void\n  optionalButton?: React.ReactNode\n  onClickOptionButton?: (id: number) => void\n} & HTMLAttributes<HTMLDivElement>\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªã‚¢ã‚¤ãƒ†ãƒ \n * @param props\n */\nexport function SortableItem ({ item, ...props }: Props): React.ReactNode {\n  const [isDeleted, _setIsDeleted] = useState(false)\n\n  const { attributes, isDragging, listeners, setNodeRef } = useSortable({\n    id: item.id,\n  })\n\n  if (!item.content || isDeleted) {\n    return null\n  }\n\n  const style = {\n    opacity: isDragging ? 0.5 : 1, // ãƒ‰ãƒ©ãƒƒã‚°æ™‚ã«é€æ˜åº¦ã‚’å¤‰æ›´\n  }\n\n  return (\n    <div className=\"relative\">\n      <div\n        className=\"relative\"\n        ref={setNodeRef}\n        style={{ ...style, ...props.style }} // æ—¢å­˜ã®ã‚¹ã‚¿ã‚¤ãƒ«ãƒ—ãƒ­ãƒƒãƒ—ã¨ãƒãƒ¼ã‚¸\n        {...attributes}\n        {...listeners}\n        {...props} // propsã‚’ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã—ã¦ä»–ã®å±æ€§ã‚’é©ç”¨\n      >\n        <ImageItem item={item} />\n      </div>\n      {props.isDeletable && (\n        <Button\n          className=\"absolute top-2 right-2 size-6 md:h-8 md:w-8\"\n          size={\"icon\"}\n          onClick={() => {\n            if (props.onDelete) {\n              props.onDelete(item.id)\n            }\n            // setIsDeleted(true)\n          }}\n        >\n          <XIcon className=\"size-4 md:h-6 md:w-6\" />\n        </Button>\n      )}\n      {props.optionalButton && (\n        // biome-ignore lint/complexity/useOptionalChain: <explanation>\n        // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n        <div\n          onClick={() => {\n            if (props.onClickOptionButton) {\n              props.onClickOptionButton(item.id)\n            }\n          }}\n          className=\"absolute bottom-2 left-2\"\n        >\n          {props.optionalButton}\n        </div>\n      )}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/drag/sortable-item.tsx"},"span":[2036,2049],"sourceCode":"import { ImageItem } from \"~/components/drag/image-item\"\nimport { Button } from \"~/components/ui/button\"\nimport { useSortable } from \"@dnd-kit/sortable\"\nimport { XIcon } from \"lucide-react\"\nimport { useState, type HTMLAttributes } from \"react\"\n\n// ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªã‚¢ã‚¤ãƒ†ãƒ ã®å‹\nexport type TSortableItem = {\n  id: number\n  content: string | null // ç”»åƒã®URLãªã©\n  isContentEdited?: boolean // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒç·¨é›†ã•ã‚ŒãŸã‹ã©ã†ã‹\n}\n\ntype Props = {\n  item: TSortableItem\n  isDeletable?: boolean\n  onDelete?: (id: number) => void\n  optionalButton?: React.ReactNode\n  onClickOptionButton?: (id: number) => void\n} & HTMLAttributes<HTMLDivElement>\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªã‚¢ã‚¤ãƒ†ãƒ \n * @param props\n */\nexport function SortableItem ({ item, ...props }: Props): React.ReactNode {\n  const [isDeleted, _setIsDeleted] = useState(false)\n\n  const { attributes, isDragging, listeners, setNodeRef } = useSortable({\n    id: item.id,\n  })\n\n  if (!item.content || isDeleted) {\n    return null\n  }\n\n  const style = {\n    opacity: isDragging ? 0.5 : 1, // ãƒ‰ãƒ©ãƒƒã‚°æ™‚ã«é€æ˜åº¦ã‚’å¤‰æ›´\n  }\n\n  return (\n    <div className=\"relative\">\n      <div\n        className=\"relative\"\n        ref={setNodeRef}\n        style={{ ...style, ...props.style }} // æ—¢å­˜ã®ã‚¹ã‚¿ã‚¤ãƒ«ãƒ—ãƒ­ãƒƒãƒ—ã¨ãƒãƒ¼ã‚¸\n        {...attributes}\n        {...listeners}\n        {...props} // propsã‚’ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã—ã¦ä»–ã®å±æ€§ã‚’é©ç”¨\n      >\n        <ImageItem item={item} />\n      </div>\n      {props.isDeletable && (\n        <Button\n          className=\"absolute top-2 right-2 size-6 md:h-8 md:w-8\"\n          size={\"icon\"}\n          onClick={() => {\n            if (props.onDelete) {\n              props.onDelete(item.id)\n            }\n            // setIsDeleted(true)\n          }}\n        >\n          <XIcon className=\"size-4 md:h-6 md:w-6\" />\n        </Button>\n      )}\n      {props.optionalButton && (\n        // biome-ignore lint/complexity/useOptionalChain: <explanation>\n        // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n        <div\n          onClick={() => {\n            if (props.onClickOptionButton) {\n              props.onClickOptionButton(item.id)\n            }\n          }}\n          className=\"absolute bottom-2 left-2\"\n        >\n          {props.optionalButton}\n        </div>\n      )}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/expansion-transition.tsx"},"span":[1318,1331],"sourceCode":"import type React from \"react\"\nimport { useState, useRef, useEffect } from \"react\"\n\ntype Props = {\n  triggerChildren: React.ReactNode\n  children: React.ReactNode\n  oneTimeExpand?: boolean // ä¸€åº¦åˆ‡ã‚Šã®å±•é–‹ãƒ•ãƒ©ã‚°\n  onExpandChange?: (isOpen: boolean) => void\n  className?: string\n  hidden?: boolean\n}\n\nexport function ExpansionTransition (props: Props): React.ReactNode {\n  const [isFilterOpen, setIsFilterOpen] = useState(false)\n  const [hasExpanded, setHasExpanded] = useState(false) // è¿½åŠ : å±•é–‹æ¸ˆã¿ãƒ•ãƒ©ã‚°\n  const [maxHeight, setMaxHeight] = useState(\"0px\")\n  const [opacity, setOpacity] = useState(0)\n  const contentRef = useRef<HTMLDivElement>(null)\n\n  useEffect(() => {\n    if (isFilterOpen && contentRef.current) {\n      setMaxHeight(`${contentRef.current.scrollHeight}px`)\n      setOpacity(1)\n      if (props.oneTimeExpand) {\n        setHasExpanded(true)\n      }\n    } else {\n      setMaxHeight(\"0px\")\n      setOpacity(0)\n    }\n  }, [isFilterOpen, props.oneTimeExpand])\n\n  const onToggleFilterButton = () => {\n    if (!hasExpanded || !props.oneTimeExpand) {\n      setIsFilterOpen(!isFilterOpen)\n      if (props.onExpandChange) {\n        props.onExpandChange(!isFilterOpen)\n      }\n    }\n  }\n\n  return (\n    <>\n      {!hasExpanded && (\n        // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n        <div onClick={onToggleFilterButton}>{props.triggerChildren}</div>\n      )}\n      {isFilterOpen && (\n        <div\n          ref={contentRef}\n          style={{\n            maxHeight: maxHeight,\n            opacity: opacity,\n            overflow: props.hidden ? \"hidden\" : \"visible\",\n            transition: \"max-height 0.5s ease, opacity 0.5s ease\",\n          }}\n          className={props.className}\n        >\n          {props.children}\n        </div>\n      )}\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/gallery-search-filters.tsx"},"span":[5065,5423],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { Label } from \"~/components/ui/label\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"~/components/ui/select\"\nimport {\n  Collapsible,\n  CollapsibleContent,\n  CollapsibleTrigger,\n} from \"~/components/ui/collapsible\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { Filter, ChevronDown, ChevronUp, X } from \"lucide-react\"\nimport { useState, useEffect } from \"react\"\nimport { useSearchParams, useNavigate, useLocation } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype WorkType = \"ALL\" | \"WORK\" | \"VIDEO\" | \"NOVEL\" | \"COLUMN\"\ntype SortType =\n  | \"DATE_CREATED\"\n  | \"LIKES_COUNT\"\n  | \"VIEWS_COUNT\"\n  | \"COMMENTS_COUNT\"\ntype RatingType = \"G\" | \"R15\" | \"R18\" | \"R18G\"\n\n/**\n * ã‚®ãƒ£ãƒ©ãƒªãƒ¼æ¤œç´¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼\n */\nexport function GallerySearchFilters (): React.ReactNode {\n  const [isOpen, setIsOpen] = useState(false)\n  const [searchParams] = useSearchParams()\n  const navigate = useNavigate()\n  const location = useLocation()\n  const t = useTranslation()\n\n  // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼çŠ¶æ…‹\n  const [searchText, setSearchText] = useState(\"\")\n  const [promptText, setPromptText] = useState(\"\")\n  const [workType, setWorkType] = useState<WorkType>(\"ALL\")\n  const [sortType, setSortType] = useState<SortType>(\"DATE_CREATED\")\n  const [ratings, setRatings] = useState<RatingType[]>([\"G\"])\n  const [hasPrompt, setHasPrompt] = useState(false)\n\n  // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰åˆæœŸå€¤ã‚’è¨­å®š\n  useEffect(() => {\n    setSearchText(searchParams.get(\"q\") || \"\")\n    setPromptText(searchParams.get(\"prompt\") || \"\")\n    setWorkType((searchParams.get(\"workType\") as WorkType) || \"ALL\")\n    setSortType((searchParams.get(\"sort\") as SortType) || \"DATE_CREATED\")\n\n    const ratingsParam = searchParams.get(\"ratings\")\n    if (ratingsParam) {\n      setRatings(ratingsParam.split(\",\") as RatingType[])\n    } else {\n      setRatings([\"G\"])\n    }\n\n    setHasPrompt(searchParams.get(\"hasPrompt\") === \"true\")\n  }, [searchParams])\n\n  const handleRatingChange = (rating: RatingType, checked: boolean) => {\n    if (checked) {\n      setRatings((prev) => [...prev, rating])\n    } else {\n      setRatings((prev) => prev.filter((r) => r !== rating))\n    }\n  }\n\n  const applyFilters = () => {\n    const newSearchParams = new URLSearchParams()\n\n    if (searchText.trim()) {\n      newSearchParams.set(\"q\", searchText.trim())\n    }\n\n    if (promptText.trim()) {\n      newSearchParams.set(\"prompt\", promptText.trim())\n    }\n\n    if (workType !== \"ALL\") {\n      newSearchParams.set(\"workType\", workType)\n    }\n\n    if (sortType !== \"DATE_CREATED\") {\n      newSearchParams.set(\"sort\", sortType)\n    }\n\n    if (ratings.length > 0 && !(ratings.length === 1 && ratings[0] === \"G\")) {\n      newSearchParams.set(\"ratings\", ratings.join(\",\"))\n    }\n\n    if (hasPrompt) {\n      newSearchParams.set(\"hasPrompt\", \"true\")\n    }\n\n    navigate(`${location.pathname}?${newSearchParams.toString()}`)\n    setIsOpen(false)\n  }\n\n  const clearFilters = () => {\n    setSearchText(\"\")\n    setPromptText(\"\")\n    setWorkType(\"ALL\")\n    setSortType(\"DATE_CREATED\")\n    setRatings([\"G\"])\n    setHasPrompt(false)\n    navigate(location.pathname)\n  }\n\n  // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ•°ã‚’è¨ˆç®—\n  const activeFiltersCount = [\n    promptText.trim() !== \"\",\n    workType !== \"ALL\",\n    sortType !== \"DATE_CREATED\",\n    !(ratings.length === 1 && ratings[0] === \"G\"),\n    hasPrompt,\n  ].filter(Boolean).length\n\n  return (\n    <div className=\"border-b bg-background\">\n      <div className=\"container mx-auto px-4\">\n        <Collapsible open={isOpen} onOpenChange={setIsOpen}>\n          <CollapsibleTrigger asChild>\n            <Button\n              variant=\"ghost\"\n              className=\"flex w-full items-center justify-between py-4 hover:bg-transparent\"\n            >\n              <div className=\"flex items-center gap-2\">\n                <Filter className=\"size-4\" />\n                <span>{t(\"è©³ç´°æ¤œç´¢\", \"Advanced Search\")}</span>\n                {activeFiltersCount > 0 && (\n                  <Badge variant=\"secondary\" className=\"ml-2\">\n                    {activeFiltersCount}\n                  </Badge>\n                )}\n              </div>\n              {isOpen ? (\n                <ChevronUp className=\"size-4\" />\n              ) : (\n                <ChevronDown className=\"size-4\" />\n              )}\n            </Button>\n          </CollapsibleTrigger>\n\n          <CollapsibleContent className=\"pb-4\">\n            <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\n              {/* åŸºæœ¬æ¤œç´¢ */}\n              <div className=\"space-y-4\">\n                <h3 className=\"font-medium text-sm\">\n                  {t(\"åŸºæœ¬æ¤œç´¢\", \"Basic Search\")}\n                </h3>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"search-text\">\n                    {t(\"ä½œå“æ¤œç´¢\", \"Search Works\")}\n                  </Label>\n                  <Input\n                    id=\"search-text\"\n                    value={searchText}\n                    onChange={(e) => setSearchText(e.target.value)}\n                    placeholder={t(\n                      \"ã‚¿ã‚¤ãƒˆãƒ«ã€ã‚¿ã‚°ã€èª¬æ˜æ–‡ã§æ¤œç´¢\",\n                      \"Search by title, tags, description\",\n                    )}\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"prompt-text\">\n                    {t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ¤œç´¢\", \"Prompt Search\")}\n                  </Label>\n                  <Input\n                    id=\"prompt-text\"\n                    value={promptText}\n                    onChange={(e) => setPromptText(e.target.value)}\n                    placeholder={t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§æ¤œç´¢\", \"Search by prompt\")}\n                  />\n                </div>\n              </div>\n\n              {/* ä½œå“è¨­å®š */}\n              <div className=\"space-y-4\">\n                <h3 className=\"font-medium text-sm\">\n                  {t(\"ä½œå“è¨­å®š\", \"Work Settings\")}\n                </h3>\n\n                <div className=\"space-y-2\">\n                  <Label>{t(\"ä½œå“ç¨®åˆ¥\", \"Work Type\")}</Label>\n                  <Select\n                    value={workType}\n                    onValueChange={(value) => setWorkType(value as WorkType)}\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"ALL\">{t(\"ã™ã¹ã¦\", \"All\")}</SelectItem>\n                      <SelectItem value=\"WORK\">\n                        {t(\"ã‚¤ãƒ©ã‚¹ãƒˆ\", \"Illustration\")}\n                      </SelectItem>\n                      <SelectItem value=\"VIDEO\">\n                        {t(\"å‹•ç”»\", \"Video\")}\n                      </SelectItem>\n                      <SelectItem value=\"NOVEL\">\n                        {t(\"å°èª¬\", \"Novel\")}\n                      </SelectItem>\n                      <SelectItem value=\"COLUMN\">\n                        {t(\"ã‚³ãƒ©ãƒ \", \"Column\")}\n                      </SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>{t(\"ä¸¦ã³é †\", \"Sort Order\")}</Label>\n                  <Select\n                    value={sortType}\n                    onValueChange={(value) => setSortType(value as SortType)}\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"DATE_CREATED\">\n                        {t(\"æŠ•ç¨¿æ—¥æ™‚\", \"Post Date\")}\n                      </SelectItem>\n                      <SelectItem value=\"LIKES_COUNT\">\n                        {t(\"ã„ã„ã­æ•°\", \"Likes\")}\n                      </SelectItem>\n                      <SelectItem value=\"VIEWS_COUNT\">\n                        {t(\"é–²è¦§æ•°\", \"Views\")}\n                      </SelectItem>\n                      <SelectItem value=\"COMMENTS_COUNT\">\n                        {t(\"ã‚³ãƒ¡ãƒ³ãƒˆæ•°\", \"Comments\")}\n                      </SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div className=\"space-y-3\">\n                  <Label>{t(\"å¯¾è±¡å¹´é½¢\", \"Age Rating\")}</Label>\n                  <div className=\"space-y-2\">\n                    {[\n                      { value: \"G\" as const, label: t(\"å…¨å¹´é½¢\", \"All Ages\") },\n                      { value: \"R15\" as const, label: \"R-15\" },\n                      { value: \"R18\" as const, label: \"R-18\" },\n                      { value: \"R18G\" as const, label: \"R-18G\" },\n                    ].map(({ value, label }) => (\n                      <div key={value} className=\"flex items-center space-x-2\">\n                        <Checkbox\n                          id={`rating-${value}`}\n                          checked={ratings.includes(value)}\n                          onCheckedChange={(checked) =>\n                            handleRatingChange(value, checked as boolean)\n                          }\n                        />\n                        <Label htmlFor={`rating-${value}`} className=\"text-sm\">\n                          {label}\n                        </Label>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              </div>\n\n              {/* è©³ç´°ã‚ªãƒ—ã‚·ãƒ§ãƒ³ */}\n              <div className=\"space-y-4\">\n                <h3 className=\"font-medium text-sm\">\n                  {t(\"è©³ç´°ã‚ªãƒ—ã‚·ãƒ§ãƒ³\", \"Advanced Options\")}\n                </h3>\n\n                <div className=\"space-y-3\">\n                  {[\n                    {\n                      id: \"hasPrompt\",\n                      checked: hasPrompt,\n                      onChange: setHasPrompt,\n                      label: t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚ã‚Š\", \"Has Prompt\"),\n                    },\n                  ].map(({ id, checked, onChange, label }) => (\n                    <div key={id} className=\"flex items-center space-x-2\">\n                      <Checkbox\n                        id={id}\n                        checked={checked}\n                        onCheckedChange={(checked) =>\n                          onChange(checked === true)\n                        }\n                      />\n                      <Label htmlFor={id} className=\"text-sm\">\n                        {label}\n                      </Label>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </div>\n\n            {/* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ */}\n            <div className=\"mt-6 flex items-center justify-between border-t pt-4\">\n              <Button\n                variant=\"outline\"\n                onClick={clearFilters}\n                className=\"flex items-center gap-2\"\n              >\n                <X className=\"size-4\" />\n                {t(\"ã‚¯ãƒªã‚¢\", \"Clear\")}\n              </Button>\n\n              <Button onClick={applyFilters}>{t(\"æ¤œç´¢\", \"Search\")}</Button>\n            </div>\n          </CollapsibleContent>\n        </Collapsible>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/gallery-search-filters.tsx"},"span":[5651,5906],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { Label } from \"~/components/ui/label\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"~/components/ui/select\"\nimport {\n  Collapsible,\n  CollapsibleContent,\n  CollapsibleTrigger,\n} from \"~/components/ui/collapsible\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { Filter, ChevronDown, ChevronUp, X } from \"lucide-react\"\nimport { useState, useEffect } from \"react\"\nimport { useSearchParams, useNavigate, useLocation } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype WorkType = \"ALL\" | \"WORK\" | \"VIDEO\" | \"NOVEL\" | \"COLUMN\"\ntype SortType =\n  | \"DATE_CREATED\"\n  | \"LIKES_COUNT\"\n  | \"VIEWS_COUNT\"\n  | \"COMMENTS_COUNT\"\ntype RatingType = \"G\" | \"R15\" | \"R18\" | \"R18G\"\n\n/**\n * ã‚®ãƒ£ãƒ©ãƒªãƒ¼æ¤œç´¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼\n */\nexport function GallerySearchFilters (): React.ReactNode {\n  const [isOpen, setIsOpen] = useState(false)\n  const [searchParams] = useSearchParams()\n  const navigate = useNavigate()\n  const location = useLocation()\n  const t = useTranslation()\n\n  // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼çŠ¶æ…‹\n  const [searchText, setSearchText] = useState(\"\")\n  const [promptText, setPromptText] = useState(\"\")\n  const [workType, setWorkType] = useState<WorkType>(\"ALL\")\n  const [sortType, setSortType] = useState<SortType>(\"DATE_CREATED\")\n  const [ratings, setRatings] = useState<RatingType[]>([\"G\"])\n  const [hasPrompt, setHasPrompt] = useState(false)\n\n  // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰åˆæœŸå€¤ã‚’è¨­å®š\n  useEffect(() => {\n    setSearchText(searchParams.get(\"q\") || \"\")\n    setPromptText(searchParams.get(\"prompt\") || \"\")\n    setWorkType((searchParams.get(\"workType\") as WorkType) || \"ALL\")\n    setSortType((searchParams.get(\"sort\") as SortType) || \"DATE_CREATED\")\n\n    const ratingsParam = searchParams.get(\"ratings\")\n    if (ratingsParam) {\n      setRatings(ratingsParam.split(\",\") as RatingType[])\n    } else {\n      setRatings([\"G\"])\n    }\n\n    setHasPrompt(searchParams.get(\"hasPrompt\") === \"true\")\n  }, [searchParams])\n\n  const handleRatingChange = (rating: RatingType, checked: boolean) => {\n    if (checked) {\n      setRatings((prev) => [...prev, rating])\n    } else {\n      setRatings((prev) => prev.filter((r) => r !== rating))\n    }\n  }\n\n  const applyFilters = () => {\n    const newSearchParams = new URLSearchParams()\n\n    if (searchText.trim()) {\n      newSearchParams.set(\"q\", searchText.trim())\n    }\n\n    if (promptText.trim()) {\n      newSearchParams.set(\"prompt\", promptText.trim())\n    }\n\n    if (workType !== \"ALL\") {\n      newSearchParams.set(\"workType\", workType)\n    }\n\n    if (sortType !== \"DATE_CREATED\") {\n      newSearchParams.set(\"sort\", sortType)\n    }\n\n    if (ratings.length > 0 && !(ratings.length === 1 && ratings[0] === \"G\")) {\n      newSearchParams.set(\"ratings\", ratings.join(\",\"))\n    }\n\n    if (hasPrompt) {\n      newSearchParams.set(\"hasPrompt\", \"true\")\n    }\n\n    navigate(`${location.pathname}?${newSearchParams.toString()}`)\n    setIsOpen(false)\n  }\n\n  const clearFilters = () => {\n    setSearchText(\"\")\n    setPromptText(\"\")\n    setWorkType(\"ALL\")\n    setSortType(\"DATE_CREATED\")\n    setRatings([\"G\"])\n    setHasPrompt(false)\n    navigate(location.pathname)\n  }\n\n  // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ•°ã‚’è¨ˆç®—\n  const activeFiltersCount = [\n    promptText.trim() !== \"\",\n    workType !== \"ALL\",\n    sortType !== \"DATE_CREATED\",\n    !(ratings.length === 1 && ratings[0] === \"G\"),\n    hasPrompt,\n  ].filter(Boolean).length\n\n  return (\n    <div className=\"border-b bg-background\">\n      <div className=\"container mx-auto px-4\">\n        <Collapsible open={isOpen} onOpenChange={setIsOpen}>\n          <CollapsibleTrigger asChild>\n            <Button\n              variant=\"ghost\"\n              className=\"flex w-full items-center justify-between py-4 hover:bg-transparent\"\n            >\n              <div className=\"flex items-center gap-2\">\n                <Filter className=\"size-4\" />\n                <span>{t(\"è©³ç´°æ¤œç´¢\", \"Advanced Search\")}</span>\n                {activeFiltersCount > 0 && (\n                  <Badge variant=\"secondary\" className=\"ml-2\">\n                    {activeFiltersCount}\n                  </Badge>\n                )}\n              </div>\n              {isOpen ? (\n                <ChevronUp className=\"size-4\" />\n              ) : (\n                <ChevronDown className=\"size-4\" />\n              )}\n            </Button>\n          </CollapsibleTrigger>\n\n          <CollapsibleContent className=\"pb-4\">\n            <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\n              {/* åŸºæœ¬æ¤œç´¢ */}\n              <div className=\"space-y-4\">\n                <h3 className=\"font-medium text-sm\">\n                  {t(\"åŸºæœ¬æ¤œç´¢\", \"Basic Search\")}\n                </h3>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"search-text\">\n                    {t(\"ä½œå“æ¤œç´¢\", \"Search Works\")}\n                  </Label>\n                  <Input\n                    id=\"search-text\"\n                    value={searchText}\n                    onChange={(e) => setSearchText(e.target.value)}\n                    placeholder={t(\n                      \"ã‚¿ã‚¤ãƒˆãƒ«ã€ã‚¿ã‚°ã€èª¬æ˜æ–‡ã§æ¤œç´¢\",\n                      \"Search by title, tags, description\",\n                    )}\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"prompt-text\">\n                    {t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ¤œç´¢\", \"Prompt Search\")}\n                  </Label>\n                  <Input\n                    id=\"prompt-text\"\n                    value={promptText}\n                    onChange={(e) => setPromptText(e.target.value)}\n                    placeholder={t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§æ¤œç´¢\", \"Search by prompt\")}\n                  />\n                </div>\n              </div>\n\n              {/* ä½œå“è¨­å®š */}\n              <div className=\"space-y-4\">\n                <h3 className=\"font-medium text-sm\">\n                  {t(\"ä½œå“è¨­å®š\", \"Work Settings\")}\n                </h3>\n\n                <div className=\"space-y-2\">\n                  <Label>{t(\"ä½œå“ç¨®åˆ¥\", \"Work Type\")}</Label>\n                  <Select\n                    value={workType}\n                    onValueChange={(value) => setWorkType(value as WorkType)}\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"ALL\">{t(\"ã™ã¹ã¦\", \"All\")}</SelectItem>\n                      <SelectItem value=\"WORK\">\n                        {t(\"ã‚¤ãƒ©ã‚¹ãƒˆ\", \"Illustration\")}\n                      </SelectItem>\n                      <SelectItem value=\"VIDEO\">\n                        {t(\"å‹•ç”»\", \"Video\")}\n                      </SelectItem>\n                      <SelectItem value=\"NOVEL\">\n                        {t(\"å°èª¬\", \"Novel\")}\n                      </SelectItem>\n                      <SelectItem value=\"COLUMN\">\n                        {t(\"ã‚³ãƒ©ãƒ \", \"Column\")}\n                      </SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>{t(\"ä¸¦ã³é †\", \"Sort Order\")}</Label>\n                  <Select\n                    value={sortType}\n                    onValueChange={(value) => setSortType(value as SortType)}\n                  >\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"DATE_CREATED\">\n                        {t(\"æŠ•ç¨¿æ—¥æ™‚\", \"Post Date\")}\n                      </SelectItem>\n                      <SelectItem value=\"LIKES_COUNT\">\n                        {t(\"ã„ã„ã­æ•°\", \"Likes\")}\n                      </SelectItem>\n                      <SelectItem value=\"VIEWS_COUNT\">\n                        {t(\"é–²è¦§æ•°\", \"Views\")}\n                      </SelectItem>\n                      <SelectItem value=\"COMMENTS_COUNT\">\n                        {t(\"ã‚³ãƒ¡ãƒ³ãƒˆæ•°\", \"Comments\")}\n                      </SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div className=\"space-y-3\">\n                  <Label>{t(\"å¯¾è±¡å¹´é½¢\", \"Age Rating\")}</Label>\n                  <div className=\"space-y-2\">\n                    {[\n                      { value: \"G\" as const, label: t(\"å…¨å¹´é½¢\", \"All Ages\") },\n                      { value: \"R15\" as const, label: \"R-15\" },\n                      { value: \"R18\" as const, label: \"R-18\" },\n                      { value: \"R18G\" as const, label: \"R-18G\" },\n                    ].map(({ value, label }) => (\n                      <div key={value} className=\"flex items-center space-x-2\">\n                        <Checkbox\n                          id={`rating-${value}`}\n                          checked={ratings.includes(value)}\n                          onCheckedChange={(checked) =>\n                            handleRatingChange(value, checked as boolean)\n                          }\n                        />\n                        <Label htmlFor={`rating-${value}`} className=\"text-sm\">\n                          {label}\n                        </Label>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              </div>\n\n              {/* è©³ç´°ã‚ªãƒ—ã‚·ãƒ§ãƒ³ */}\n              <div className=\"space-y-4\">\n                <h3 className=\"font-medium text-sm\">\n                  {t(\"è©³ç´°ã‚ªãƒ—ã‚·ãƒ§ãƒ³\", \"Advanced Options\")}\n                </h3>\n\n                <div className=\"space-y-3\">\n                  {[\n                    {\n                      id: \"hasPrompt\",\n                      checked: hasPrompt,\n                      onChange: setHasPrompt,\n                      label: t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚ã‚Š\", \"Has Prompt\"),\n                    },\n                  ].map(({ id, checked, onChange, label }) => (\n                    <div key={id} className=\"flex items-center space-x-2\">\n                      <Checkbox\n                        id={id}\n                        checked={checked}\n                        onCheckedChange={(checked) =>\n                          onChange(checked === true)\n                        }\n                      />\n                      <Label htmlFor={id} className=\"text-sm\">\n                        {label}\n                      </Label>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </div>\n\n            {/* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ */}\n            <div className=\"mt-6 flex items-center justify-between border-t pt-4\">\n              <Button\n                variant=\"outline\"\n                onClick={clearFilters}\n                className=\"flex items-center gap-2\"\n              >\n                <X className=\"size-4\" />\n                {t(\"ã‚¯ãƒªã‚¢\", \"Clear\")}\n              </Button>\n\n              <Button onClick={applyFilters}>{t(\"æ¤œç´¢\", \"Search\")}</Button>\n            </div>\n          </CollapsibleContent>\n        </Collapsible>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/suspicious/noExplicitAny","severity":"warning","description":"Unexpected any. Specify a different type.","message":[{"elements":[],"content":"Unexpected "},{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":". Specify a different type."}],"advices":{"advices":[{"log":["info",[{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":" disables many type checking rules. Its use should be avoided."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/performance-monitor.tsx"},"span":[1745,1748],"sourceCode":"import { useEffect } from \"react\"\n\n/**\n * Web Vitals ã‚’ç›£è¦–ã—ã¦ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ\n * ãƒ¢ãƒã‚¤ãƒ«ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®æ”¹å–„çŠ¶æ³ã‚’è¿½è·¡ã™ã‚‹\n */\nexport function PerformanceMonitor (): React.ReactNode {\n  useEffect(() => {\n    // Web Vitals ã®ç›£è¦–\n    if (typeof window !== \"undefined\" && \"performance\" in window) {\n      // LCP (Largest Contentful Paint) ã®ç›£è¦–\n      const observer = new PerformanceObserver((list) => {\n        for (const entry of list.getEntries()) {\n          if (entry.entryType === \"largest-contentful-paint\") {\n            console.log(`LCP: ${entry.startTime}ms`)\n          }\n        }\n      })\n\n      try {\n        observer.observe({ entryTypes: [\"largest-contentful-paint\"] })\n      } catch (error) {\n        console.warn(\"Performance monitoring not supported:\", error)\n      }\n\n      // CLS (Cumulative Layout Shift) ã®ç›£è¦–\n      let clsValue = 0\n      const clsObserver = new PerformanceObserver((list) => {\n        for (const entry of list.getEntries()) {\n          const layoutShift = entry as PerformanceEntry & {\n            hadRecentInput?: boolean\n            value?: number\n          }\n\n          if (!layoutShift.hadRecentInput) {\n            clsValue += layoutShift.value ?? 0\n          }\n        }\n        console.log(`CLS: ${clsValue}`)\n      })\n\n      try {\n        clsObserver.observe({ entryTypes: [\"layout-shift\"] })\n      } catch (error) {\n        console.warn(\"Layout shift monitoring not supported:\", error)\n      }\n\n      // FID (First Input Delay) ã®ç›£è¦–\n      const fidObserver = new PerformanceObserver((list) => {\n        for (const entry of list.getEntries()) {\n          console.log(\n            `FID: ${(entry as any).processingStart - entry.startTime}ms`,\n          )\n        }\n      })\n\n      try {\n        fidObserver.observe({ entryTypes: [\"first-input\"] })\n      } catch (error) {\n        console.warn(\"First input delay monitoring not supported:\", error)\n      }\n\n      return () => {\n        observer.disconnect()\n        clsObserver.disconnect()\n        fidObserver.disconnect()\n      }\n    }\n  }, [])\n\n  // é–‹ç™ºç’°å¢ƒã§ã®ã¿ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°\n  if (process.env.NODE_ENV === \"production\") {\n    return null\n  }\n\n  return null\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/progress-bar.tsx"},"span":[829,842],"sourceCode":"import { useNavigation } from \"@remix-run/react\"\n\n/**\n * ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼\n */\nexport function ProgressBar (): React.ReactNode {\n  const navigation = useNavigation()\n\n  if (navigation.state !== \"loading\") {\n    return null\n  }\n\n  const postDiverAnimation = `\n  @keyframes postDiverAnimation {\n    0% {\n      background-position: 0% 50%;\n    }\n    50% {\n      background-position: 100% 50%;\n    }\n    100% {\n      background-position: 0% 50%;\n    }\n  }\n`\n\n  const progressInAnimation = `\n  @keyframes progressInAnimation {\n    from {\n      transform: translateX(-100%);\n    }\n    to {\n      transform: translateX(0);\n    }\n  }\n`\n\n  const keyframesStyle = `\n  ${postDiverAnimation}\n  ${progressInAnimation}\n`\n\n  return (\n    <>\n      <style>{keyframesStyle}</style>\n      {/* biome-ignore lint/style/useSelfClosingElements: <explanation> */}\n      <div\n        className=\"fixed top-0 left-0 z-100 w-full shadow-md\"\n        style={{\n          right: 0,\n          zIndex: 100,\n          height: \"2px\",\n          background: \"#0090f0\",\n          width: \"100%\",\n          backgroundSize: \"200% 200%\",\n          animation:\n            \"postDiverAnimation 2s linear infinite, progressInAnimation 1s ease-in-out\",\n        }}\n      ></div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/responsive-photo-works-album-fixed.tsx"},"span":[7376,7532],"sourceCode":"import { graphql, type FragmentOf } from \"gql.tada\"\nimport { RowsPhotoAlbum } from \"react-photo-album\"\nimport SSR from \"react-photo-album/ssr\"\nimport \"react-photo-album/rows.css\"\nimport { Link } from \"@remix-run/react\"\nimport { LikeButton } from \"~/components/like-button\"\nimport { CroppedWorkSquare } from \"~/components/cropped-work-square\"\nimport { Heart, Images, MessageCircle } from \"lucide-react\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { cn } from \"~/lib/utils\"\nimport { HomeCroppedWorks } from \"~/routes/($lang)._main._index/components/home-cropped-works\"\nimport { Avatar, AvatarImage, AvatarFallback } from \"~/components/ui/avatar\"\nimport { WorkCommentFragment } from \"~/routes/($lang)._main.posts.$post._index/components/work-comment\"\nimport { StickerButtonFragment } from \"~/routes/($lang)._main.posts.$post._index/components/sticker-button\"\nimport { OptimizedImage } from \"~/components/optimized-image\"\n\ntype Props = {\n  works: FragmentOf<typeof PhotoAlbumWorkFragment>[]\n  targetRowHeight?: number\n  direction?: \"rows\" | \"columns\"\n  size?: \"small\" | \"medium\" | \"large\"\n  isShowProfile?: boolean\n  /** ä½œå“ã‚¯ãƒªãƒƒã‚¯æ™‚ã« index ã‚’è¿”ã™ã€‚æœªæŒ‡å®šãªã‚‰å¾“æ¥é€šã‚Šãƒªãƒ³ã‚¯é·ç§» */\n  onSelect?: (index: string) => void\n}\n\n/**\n * ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œã®ä½œå“ä¸€è¦§\n */\nexport function ResponsivePhotoWorksAlbum (props: Props): React.ReactNode {\n  if (props.works.length <= 2) {\n    return (\n      <div className=\"flex flex-wrap justify-center gap-x-8 gap-y-8\">\n        {props.works.map((workItem, _index) => {\n          return (\n            <div\n              key={workItem.id.toString()}\n              className=\"relative flex flex-col space-y-2\"\n            >\n              <div className=\"relative\">\n                <CroppedWorkSquare\n                  workId={workItem.id}\n                  subWorksCount={workItem.subWorksCount}\n                  imageUrl={workItem.smallThumbnailImageURL}\n                  thumbnailImagePosition={workItem.thumbnailImagePosition ?? 0}\n                  size=\"lg\"\n                  imageWidth={workItem.smallThumbnailImageWidth}\n                  imageHeight={workItem.smallThumbnailImageHeight}\n                />\n                {workItem.subWorksCount > 0 && (\n                  <div className=\"absolute top-1 right-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                    <Images className=\"size-3 text-white\" />\n                    <div className=\"font-bold text-white text-xs\">\n                      {workItem.subWorksCount + 1}\n                    </div>\n                  </div>\n                )}\n                {workItem.commentsCount > 0 && (\n                  <div className=\"absolute top-1 left-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                    <MessageCircle className=\"size-3 text-white\" />\n                    <div className=\"font-bold text-white text-xs\">\n                      {workItem.commentsCount}\n                    </div>\n                  </div>\n                )}\n                <div className=\"absolute right-0 bottom-0\">\n                  <LikeButton\n                    size={56}\n                    targetWorkId={workItem.id}\n                    targetWorkOwnerUserId={workItem.user?.id ?? \"\"}\n                    defaultLiked={workItem.isLiked}\n                    defaultLikedCount={0}\n                    isBackgroundNone={true}\n                    strokeWidth={2}\n                    isTargetUserBlocked={workItem.user?.isBlocked ?? false}\n                  />\n                </div>\n              </div>\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n\n  return (\n    <>\n      <div className=\"hidden md:block\">\n        <SSR breakpoints={[300, 600, 900, 1200]}>\n          <RowsPhotoAlbum\n            photos={props.works.map((work) => ({\n              key: work.id,\n              id: work.id.toString(),\n              src:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageURL\n                  : work.smallThumbnailImageURL,\n              width:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageWidth\n                  : work.smallThumbnailImageWidth,\n              height:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageHeight\n                  : work.smallThumbnailImageHeight,\n              context: work,\n            }))}\n            targetRowHeight={\n              props.targetRowHeight !== undefined\n                ? props.targetRowHeight\n                : props.direction === \"rows\"\n                  ? 160\n                  : 220\n            }\n            sizes={{\n              size: \"calc(100vw - 240px)\",\n              sizes: [{ viewport: \"(max-width: 960px)\", size: \"100vw\" }],\n            }}\n            componentsProps={{\n              image: { loading: \"lazy\" },\n            }}\n            render={{\n              image: (imageProps, { photo }) => (\n                <div className=\"relative h-full w-full overflow-hidden rounded\">\n                  {props.onSelect ? (\n                    <button\n                      type=\"button\"\n                      className=\"block h-full w-full cursor-pointer overflow-hidden rounded\"\n                      onClick={() => props.onSelect?.(photo.id)}\n                      aria-label={`Open ${photo.context.title}`}\n                    >\n                      <OptimizedImage\n                        src={imageProps.src}\n                        alt={photo.context.title}\n                        width={\n                          typeof imageProps.width === \"string\"\n                            ? Number.parseInt(imageProps.width)\n                            : imageProps.width\n                        }\n                        height={\n                          typeof imageProps.height === \"string\"\n                            ? Number.parseInt(imageProps.height)\n                            : imageProps.height\n                        }\n                        loading={imageProps.loading as \"lazy\" | \"eager\"}\n                        className=\"h-full w-full transition-transform duration-300 ease-in-out hover:scale-105\"\n                      />\n                    </button>\n                  ) : (\n                    <Link\n                      className=\"block h-full w-full overflow-hidden rounded\"\n                      to={`/posts/${photo.context.id}`}\n                    >\n                      <OptimizedImage\n                        src={imageProps.src}\n                        alt={photo.context.title}\n                        width={\n                          typeof imageProps.width === \"string\"\n                            ? Number.parseInt(imageProps.width)\n                            : imageProps.width\n                        }\n                        height={\n                          typeof imageProps.height === \"string\"\n                            ? Number.parseInt(imageProps.height)\n                            : imageProps.height\n                        }\n                        loading={imageProps.loading as \"lazy\" | \"eager\"}\n                        className=\"h-full w-full transition-transform duration-300 ease-in-out hover:scale-105\"\n                      />\n                    </Link>\n                  )}\n                  {/* biome-ignore lint/a11y/useSemanticElements: wrapper prevents card navigation when interacting with LikeButton; cannot be a button due to nested button */}\n                  <div\n                    className={cn(\n                      \"absolute right-0 z-10\",\n                      props.isShowProfile ? \"bottom-14\" : \"bottom-0\",\n                    )}\n                    role=\"button\"\n                    onClick={(e) => {\n                      e.stopPropagation()\n                      e.preventDefault()\n                    }}\n                    onKeyDown={(e) => {\n                      if (e.key !== \"Enter\" && e.key !== \" \") return\n                      e.preventDefault()\n                      e.stopPropagation()\n                    }}\n                  >\n                    <LikeButton\n                      size={56}\n                      targetWorkId={photo.context.id}\n                      targetWorkOwnerUserId={photo.context.user?.id ?? \"\"}\n                      defaultLiked={photo.context.isLiked}\n                      defaultLikedCount={0}\n                      isBackgroundNone={true}\n                      strokeWidth={2}\n                      likedCount={photo.context.likesCount}\n                    />\n                  </div>\n                  {photo.context.subWorksCount > 0 && (\n                    <div className=\"absolute top-1 right-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                      <Images className=\"size-3 text-white\" />\n                      <div className=\"font-bold text-white text-xs\">\n                        {photo.context.subWorksCount + 1}\n                      </div>\n                    </div>\n                  )}\n                  {photo.context.commentsCount > 0 && (\n                    <div className=\"absolute top-1 left-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                      <MessageCircle className=\"size-3 text-white\" />\n                      <div className=\"font-bold text-white text-xs\">\n                        {photo.context.commentsCount}\n                      </div>\n                    </div>\n                  )}\n                  {props.isShowProfile && (\n                    <div className=\"mt-2 flex flex-col space-y-2 overflow-hidden text-ellipsis\">\n                      {props.onSelect ? (\n                        <button\n                          type=\"button\"\n                          className=\"w-48 cursor-pointer border-0 bg-transparent p-0 text-left font-bold\"\n                          onClick={(e) => {\n                            e.stopPropagation()\n                            props.onSelect?.(photo.context.id.toString())\n                          }}\n                          aria-label={`Open ${photo.context.title}`}\n                        >\n                          <p className=\"overflow-hidden text-ellipsis text-nowrap text-left text-sm\">\n                            {photo.context.title}\n                          </p>\n                        </button>\n                      ) : (\n                        <Link\n                          className=\"w-48 font-bold\"\n                          to={`/posts/${photo.context.id}`}\n                        >\n                          <p className=\"overflow-hidden text-ellipsis text-nowrap text-left text-sm\">\n                            {photo.context.title}\n                          </p>\n                        </Link>\n                      )}\n\n                      <div className=\"flex items-center justify-between\">\n                        <Link to={`/users/${photo.context.user?.id}`}>\n                          <div className=\"flex items-center space-x-2\">\n                            <Avatar className=\"size-6\">\n                              <AvatarImage\n                                className=\"size-6 rounded-full\"\n                                src={withIconUrlFallback(\n                                  photo.context.user?.iconUrl,\n                                )}\n                                alt=\"\"\n                              />\n                              <AvatarFallback />\n                            </Avatar>\n                            <span className=\"truncate text-sm\">\n                              {photo.context.user?.name}\n                            </span>\n                          </div>\n                        </Link>\n                        <div className=\"absolute right-0 ml-auto flex items-center space-x-1 rounded-md bg-card p-1\">\n                          <Heart className=\"size-3 fill-gray-400 text-gray-400\" />\n                          <span className=\"text-xs\">\n                            {photo.context.likesCount}\n                          </span>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              ),\n            }}\n          />\n        </SSR>\n      </div>\n      <div className=\"block md:hidden\">\n        <HomeCroppedWorks\n          works={props.works}\n          isShowProfile={true}\n          hasReferenceButton={false}\n        />\n      </div>\n    </>\n  )\n}\n\nexport const PhotoAlbumWorkFragment = graphql(\n  `fragment PhotoAlbumWork on WorkNode @_unmask {\n    id\n    isMyRecommended\n    title\n    mdUrl\n    accessType\n    type\n    adminAccessType\n    promptAccessType\n    rating\n    description\n    isSensitive\n    enTitle\n    enDescription\n    imageURL\n    largeThumbnailImageURL\n    largeThumbnailImageWidth\n    largeThumbnailImageHeight\n    smallThumbnailImageURL\n    smallThumbnailImageWidth\n    smallThumbnailImageHeight\n    thumbnailImagePosition\n    subWorksCount\n    url\n    isDeleted\n    user {\n      id\n      biography\n      enBiography\n      login\n      nanoid\n      name\n      receivedLikesCount\n      receivedViewsCount\n      awardsCount\n      followersCount\n      worksCount\n      iconUrl\n      headerImageUrl\n      webFcmToken\n      isFollower\n      isFollowee\n      headerImageUrl\n      receivedLikesCount\n      createdLikesCount\n      createdBookmarksCount\n      isMuted\n      isBlocked\n      promptonUser {\n        id\n      }\n    }\n    likedUsers(offset: 0, limit: 64) {\n      id\n      name\n      iconUrl\n      login\n    }\n    dailyTheme {\n      id\n      title\n      dateText\n    }\n    tagNames\n    createdAt\n    likesCount\n    viewsCount\n    commentsCount\n    subWorks {\n      id\n      imageUrl\n    }\n    model\n    modelHash\n    generationModelId\n    workModelId\n    isTagEditable\n    isCommentsEditable\n    isLiked\n    isBookmarked\n    isInCollection\n    isPromotion\n    isGeneration\n    ogpThumbnailImageUrl\n    prompt\n    negativePrompt\n    noise\n    seed\n    steps\n    sampler\n    scale\n    strength\n    vae\n    clipSkip\n    otherGenerationParams\n    pngInfo\n    style\n    url\n    updatedAt\n    dailyRanking\n    weeklyRanking\n    monthlyRanking\n    relatedUrl\n    nanoid\n  }`,\n)\n\nconst _userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      iconUrl\n    }\n  }`,\n)\n\nexport const CommentListItemFragment = graphql(\n  `fragment Comment on CommentNode @_unmask {\n      ...WorkComment\n      responses(offset: 0, limit: 128) {\n        ...WorkComment\n      }\n  }`,\n  [WorkCommentFragment],\n)\n\nconst _createWorkCommentMutation = graphql(\n  `mutation CreateWorkComment($input: CreateWorkCommentInput!) {\n    createWorkComment(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst _createCommentLikeMutation = graphql(\n  `mutation CreateCommentLike($input: CreateCommentLikeInput!) {\n    createCommentLike(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst _deleteCommentLikeMutation = graphql(\n  `mutation DeleteCommentLike($input: DeleteCommentLikeInput!) {\n    deleteCommentLike(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst _viewerUserQuery = graphql(\n  `query ViewerUser {\n    viewer {\n      id\n      user {\n        id\n        iconUrl\n      }\n      userStickers(offset: 0, limit: 5, orderBy: DATE_USED) {\n        ...StickerButton\n      }\n    }\n  }`,\n  [StickerButtonFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/sensitive/sensitive-toggle.tsx"},"span":[10786,10799],"sourceCode":"import { useEffect, useState, useId } from \"react\"\nimport { Button } from \"~/components/ui/button\"\nimport { Switch } from \"~/components/ui/switch\"\nimport { Label } from \"~/components/ui/label\"\nimport { useLocation, useNavigate } from \"react-router-dom\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { useLocale } from \"~/hooks/use-locale\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"~/components/ui/alert-dialog\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { setCookie, hasCookie } from \"~/lib/cookie-utils\"\nimport { Shield, Eye, EyeOff, AlertTriangle } from \"lucide-react\"\n\ntype Props = {\n  variant?: \"compact\" | \"full\" | \"toggle\" | \"card\"\n  className?: string\n  showStatus?: boolean\n  targetUrl?: string\n}\n\nexport function SensitiveToggle ({\n  variant = \"compact\",\n  className,\n  showStatus = false,\n  targetUrl,\n}: Props): React.ReactNode {\n  const [isR18Mode, setIsR18Mode] = useState(false)\n  const [isDialogOpen, setIsDialogOpen] = useState(false)\n  const [shouldSkipDialog, setShouldSkipDialog] = useState(false)\n  const [isRememberChoice, setIsRememberChoice] = useState(false)\n  const location = useLocation()\n  const navigate = useNavigate()\n  const locale = useLocale()\n  const t = useTranslation()\n  const checkboxId = useId()\n  const cookieKey = \"sensitive-content-confirmed\"\n\n  useEffect(() => {\n    // URLã«\"/r\"ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯\n    setIsR18Mode(/\\/r($|\\/)/.test(location.pathname))\n    // CookieãŒå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯\n    setShouldSkipDialog(hasCookie(cookieKey))\n  }, [location.pathname, cookieKey])\n\n  const performR18Toggle = () => {\n    if (targetUrl) {\n      // targetUrlãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ãã®URLã«ç›´æ¥ãƒŠãƒ“ã‚²ãƒ¼ãƒˆ\n      navigate(targetUrl, { replace: true })\n      return\n    }\n\n    const isEnglish = locale === \"en\"\n    let newPathname = location.pathname\n\n    if (isR18Mode) {\n      // R18ãƒ¢ãƒ¼ãƒ‰ã‚’OFFã«ã™ã‚‹ï¼ˆ\"/r\"ã‚’å‰Šé™¤ï¼‰\n      newPathname = location.pathname.replace(/\\/r/, \"\")\n      if (newPathname === \"\") newPathname = \"/\"\n    } else {\n      // R18ãƒ¢ãƒ¼ãƒ‰ã‚’ONã«ã™ã‚‹\n      if (isEnglish) {\n        newPathname = location.pathname.startsWith(\"/en\")\n          ? location.pathname.replace(\"/en\", \"/en/r\")\n          : `/en/r${location.pathname}`\n      } else {\n        newPathname = `/r${location.pathname}`\n      }\n    }\n\n    navigate(newPathname, { replace: true })\n  }\n\n  const handleR18ToggleClick = () => {\n    if (isR18Mode) {\n      // R18ãƒ¢ãƒ¼ãƒ‰ã‚’OFFã«ã™ã‚‹å ´åˆã¯ç›´æ¥å®Ÿè¡Œ\n      performR18Toggle()\n    } else {\n      // R18ãƒ¢ãƒ¼ãƒ‰ã‚’ONã«ã™ã‚‹å ´åˆã¯å¿…ãšç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º\n      if (shouldSkipDialog) {\n        performR18Toggle()\n      } else {\n        setIsDialogOpen(true)\n      }\n    }\n  }\n\n  const handleConfirm = () => {\n    // Cookieã‚’è¨­å®šï¼ˆ30æ—¥é–“ï¼‰\n    if (isRememberChoice) {\n      const expiryDate = new Date()\n      expiryDate.setDate(expiryDate.getDate() + 30)\n      setCookie(cookieKey, \"true\", {\n        expires: expiryDate,\n        path: \"/\",\n        secure: true,\n        sameSite: \"strict\",\n      })\n    }\n\n    // R18ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ\n    performR18Toggle()\n    setIsDialogOpen(false)\n    setIsRememberChoice(false)\n  }\n\n  const handleCancel = () => {\n    setIsDialogOpen(false)\n    setIsRememberChoice(false)\n  }\n\n  // ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆãƒãƒªã‚¢ãƒ³ãƒˆ - ãƒ˜ãƒƒãƒ€ãƒ¼/ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ç”¨\n  if (variant === \"compact\") {\n    return (\n      <>\n        <Button\n          variant={isR18Mode ? \"default\" : \"outline\"}\n          size=\"sm\"\n          onClick={handleR18ToggleClick}\n          className={cn(\n            \"group relative overflow-hidden transition-all duration-300 ease-in-out\",\n            isR18Mode\n              ? \"border-0 bg-gradient-to-r from-red-500 via-pink-500 to-rose-500 text-white shadow-lg hover:scale-105 hover:shadow-xl\"\n              : \"border-2 border-red-200/60 bg-white/80 text-red-600 backdrop-blur-sm hover:border-red-300 hover:bg-red-50 dark:border-red-700/60 dark:bg-gray-800/80 dark:text-red-400 dark:hover:bg-red-950/50\",\n            className,\n          )}\n        >\n          <span className=\"relative z-10 flex items-center gap-2\">\n            <span className=\"font-bold text-sm tracking-wide\">R18</span>\n            {showStatus && isR18Mode && (\n              <div className=\"h-2 w-2 animate-pulse rounded-full bg-white/80\" />\n            )}\n          </span>\n          {isR18Mode && (\n            <div className=\"absolute inset-0 animate-pulse bg-gradient-to-r from-red-600/20 via-pink-600/20 to-rose-600/20\" />\n          )}\n        </Button>\n\n        <ConfirmationDialog\n          isOpen={isDialogOpen}\n          onConfirm={handleConfirm}\n          onCancel={handleCancel}\n          isRememberChoice={isRememberChoice}\n          onRememberChoiceChange={setIsRememberChoice}\n          checkboxId={checkboxId}\n          t={t}\n        />\n      </>\n    )\n  }\n\n  // ã‚«ãƒ¼ãƒ‰ãƒãƒªã‚¢ãƒ³ãƒˆ - ãƒšãƒ¼ã‚¸ãƒ˜ãƒƒãƒ€ãƒ¼ç”¨\n  if (variant === \"card\") {\n    return (\n      <>\n        <div\n          className={cn(\n            \"flex items-center justify-between rounded-xl border bg-gradient-to-r p-4 shadow-sm transition-all duration-300\",\n            isR18Mode\n              ? \"border-red-200 from-red-50 to-pink-50 dark:border-red-800 dark:from-red-950/20 dark:to-pink-950/20\"\n              : \"border-gray-200 from-gray-50 to-gray-100 dark:border-gray-700 dark:from-gray-800 dark:to-gray-900\",\n            className,\n          )}\n        >\n          <div className=\"flex items-center space-x-4\">\n            <div\n              className={cn(\n                \"flex h-12 w-12 items-center justify-center rounded-xl transition-all duration-300\",\n                isR18Mode\n                  ? \"bg-gradient-to-r from-red-100 to-pink-100 dark:from-red-900 dark:to-pink-900\"\n                  : \"bg-gray-200 dark:bg-gray-700\",\n              )}\n            >\n              {isR18Mode ? (\n                <AlertTriangle className=\"h-6 w-6 text-red-600 dark:text-red-400\" />\n              ) : (\n                <Shield className=\"h-6 w-6 text-gray-600 dark:text-gray-400\" />\n              )}\n            </div>\n            <div>\n              <h3 className=\"font-bold text-gray-900 dark:text-gray-100\">\n                {t(\"å¹´é½¢åˆ¶é™ã‚³ãƒ³ãƒ†ãƒ³ãƒ„\", \"Age-Restricted Content\")}\n              </h3>\n              <p className=\"text-gray-600 text-sm dark:text-gray-400\">\n                {isR18Mode\n                  ? t(\n                      \"R18ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™\",\n                      \"R18 content is visible\",\n                    )\n                  : t(\"R18ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯éè¡¨ç¤ºã§ã™\", \"R18 content is hidden\")}\n              </p>\n            </div>\n          </div>\n          <Button\n            variant={isR18Mode ? \"destructive\" : \"outline\"}\n            onClick={handleR18ToggleClick}\n            className={cn(\n              \"transition-all duration-300\",\n              isR18Mode\n                ? \"bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-700 hover:to-pink-700\"\n                : \"border-red-200 text-red-600 hover:bg-red-50 dark:border-red-800 dark:text-red-400 dark:hover:bg-red-950\",\n            )}\n          >\n            <span className=\"flex items-center gap-2\">\n              {isR18Mode ? (\n                <EyeOff className=\"h-4 w-4\" />\n              ) : (\n                <Eye className=\"h-4 w-4\" />\n              )}\n              <span className=\"font-medium\">\n                {isR18Mode ? t(\"éè¡¨ç¤ºã«ã™ã‚‹\", \"Hide\") : t(\"è¡¨ç¤ºã™ã‚‹\", \"Show\")}\n              </span>\n            </span>\n          </Button>\n        </div>\n\n        <ConfirmationDialog\n          isOpen={isDialogOpen}\n          onConfirm={handleConfirm}\n          onCancel={handleCancel}\n          isRememberChoice={isRememberChoice}\n          onRememberChoiceChange={setIsRememberChoice}\n          checkboxId={checkboxId}\n          t={t}\n        />\n      </>\n    )\n  }\n\n  // ãƒˆã‚°ãƒ«ãƒãƒªã‚¢ãƒ³ãƒˆ - è¨­å®šç”»é¢ç”¨\n  if (variant === \"toggle\") {\n    return (\n      <>\n        <div\n          className={cn(\n            \"flex items-center justify-between space-x-4 rounded-xl bg-gradient-to-r from-gray-50 to-gray-100 p-4 dark:from-gray-800 dark:to-gray-900\",\n            className,\n          )}\n        >\n          <div className=\"flex items-center space-x-3\">\n            <div\n              className={cn(\n                \"rounded-lg p-2 transition-colors\",\n                isR18Mode\n                  ? \"bg-red-100 dark:bg-red-900\"\n                  : \"bg-gray-200 dark:bg-gray-700\",\n              )}\n            >\n              {isR18Mode ? (\n                <Shield className=\"h-5 w-5 text-red-600 dark:text-red-400\" />\n              ) : (\n                <Eye className=\"h-5 w-5 text-gray-600 dark:text-gray-400\" />\n              )}\n            </div>\n            <div>\n              <Label\n                htmlFor=\"sensitive-toggle\"\n                className=\"cursor-pointer font-semibold text-sm\"\n              >\n                {t(\"å¹´é½¢åˆ¶é™ã‚³ãƒ³ãƒ†ãƒ³ãƒ„\", \"Age-Restricted Content\")}\n              </Label>\n              <p className=\"text-muted-foreground text-xs\">\n                {isR18Mode\n                  ? t(\"R18ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒè¡¨ç¤ºã•ã‚Œã¾ã™\", \"R18 content is visible\")\n                  : t(\"R18ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯éè¡¨ç¤ºã§ã™\", \"R18 content is hidden\")}\n              </p>\n            </div>\n          </div>\n          {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n          <Switch\n            id=\"sensitive-toggle\"\n            checked={isR18Mode}\n            onCheckedChange={handleR18ToggleClick}\n            className={cn(\n              \"data-[state=checked]:bg-gradient-to-r data-[state=checked]:from-red-500 data-[state=checked]:to-pink-500\",\n              \"transition-all duration-300\",\n            )}\n          />\n        </div>\n\n        <ConfirmationDialog\n          isOpen={isDialogOpen}\n          onConfirm={handleConfirm}\n          onCancel={handleCancel}\n          isRememberChoice={isRememberChoice}\n          onRememberChoiceChange={setIsRememberChoice}\n          checkboxId={checkboxId}\n          t={t}\n        />\n      </>\n    )\n  }\n\n  // ãƒ•ãƒ«ãƒãƒªã‚¢ãƒ³ãƒˆ - è©³ç´°è¨­å®šãƒšãƒ¼ã‚¸ç”¨\n  return (\n    <>\n      <div className={cn(\"space-y-6 \", className)}>\n        <div className=\"flex items-center justify-between space-x-2\">\n          <div className=\"space-y-1\">\n            <Label htmlFor=\"full-sensitive-toggle\">\n              {t(\"R18ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¡¨ç¤º\", \"Show R18 Content\")}\n            </Label>\n          </div>\n          {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n          <Switch\n            id=\"full-sensitive-toggle\"\n            checked={isR18Mode}\n            onCheckedChange={handleR18ToggleClick}\n            className=\"data-[state=checked]:bg-gradient-to-r data-[state=checked]:from-red-500 data-[state=checked]:to-pink-500\"\n          />\n        </div>\n\n        {/* {isR18Mode && (\n          <div className=\"flex items-center gap-3 rounded-lg border border-red-200 bg-gradient-to-r from-red-50 to-pink-50 p-4 dark:border-red-800 dark:from-red-950/50 dark:to-pink-950/50\">\n            <AlertTriangle className=\"h-6 w-6 text-red-600 dark:text-red-400\" />\n            <div>\n              <h4 className=\" text-red-800 dark:text-red-200\">\n                {t(\"R18ãƒ¢ãƒ¼ãƒ‰æœ‰åŠ¹\", \"R18 Mode Active\")}\n              </h4>\n              <p className=\"text-red-700 text-sm dark:text-red-300\">\n                {t(\n                  \"å¹´é½¢åˆ¶é™ã®ã‚ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™\",\n                  \"Age-restricted content is now visible\",\n                )}\n              </p>\n            </div>\n          </div>\n        )} */}\n      </div>\n\n      <ConfirmationDialog\n        isOpen={isDialogOpen}\n        onConfirm={handleConfirm}\n        onCancel={handleCancel}\n        isRememberChoice={isRememberChoice}\n        onRememberChoiceChange={setIsRememberChoice}\n        checkboxId={checkboxId}\n        t={t}\n      />\n    </>\n  )\n}\n\n// ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ\nfunction ConfirmationDialog({\n  isOpen,\n  onConfirm,\n  onCancel,\n  isRememberChoice,\n  onRememberChoiceChange,\n  checkboxId,\n  t,\n}: {\n  isOpen: boolean\n  onConfirm: () => void\n  onCancel: () => void\n  isRememberChoice: boolean\n  onRememberChoiceChange: (checked: boolean) => void\n  checkboxId: string\n  t: (ja: string, en: string) => string\n}) {\n  return (\n    <AlertDialog open={isOpen} onOpenChange={onCancel}>\n      <AlertDialogContent className=\"max-w-lg border-red-200 dark:border-red-800\">\n        <AlertDialogHeader className=\"space-y-4\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"rounded-full bg-red-100 p-3 dark:bg-red-900\">\n              <AlertTriangle className=\"h-6 w-6 text-red-600 dark:text-red-400\" />\n            </div>\n            <AlertDialogTitle className=\"font-bold text-red-700 text-xl dark:text-red-300\">\n              {t(\"å¹´é½¢ç¢ºèªãŒå¿…è¦ã§ã™\", \"Age Verification Required\")}\n            </AlertDialogTitle>\n          </div>\n\n          <AlertDialogDescription className=\"space-y-4\">\n            <div className=\"rounded-xl border border-red-200 bg-gradient-to-r from-red-50 via-pink-50 to-rose-50 p-4 dark:border-red-800 dark:from-red-950/30 dark:via-pink-950/30 dark:to-rose-950/30\">\n              <div className=\"flex items-start gap-3\">\n                <span className=\"text-2xl\">!</span>\n                <div>\n                  <h4 className=\"mb-2 font-bold text-red-800 dark:text-red-200\">\n                    {t(\"é‡è¦ãªè­¦å‘Š\", \"Important Warning\")}\n                  </h4>\n                  <p className=\"text-red-700 text-sm leading-relaxed dark:text-red-300\">\n                    {t(\n                      \"ã“ã‚Œã‹ã‚‰è¡¨ç¤ºã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ã¯ã€18æ­³æœªæº€ã®æ–¹ã«ã¯ä¸é©åˆ‡ãªå†…å®¹ãŒå«ã¾ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚\",\n                      \"The content you are about to view may contain material inappropriate for viewers under 18 years of age.\",\n                    )}\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"space-y-3\">\n              <div className=\"rounded-lg bg-gray-50 p-4 dark:bg-gray-800/50\">\n                <h5 className=\"mb-3 font-semibold text-gray-800 dark:text-gray-200\">\n                  {t(\"å«ã¾ã‚Œã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹å†…å®¹\", \"Content may include\")}\n                </h5>\n                <div className=\"grid gap-2\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"h-2 w-2 rounded-full bg-red-500\" />\n                    <span className=\"text-gray-700 text-sm dark:text-gray-300\">\n                      {t(\"æ€§çš„ãªè¡¨ç¾ã‚„æå†™\", \"Sexual content and depictions\")}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"h-2 w-2 rounded-full bg-red-500\" />\n                    <span className=\"text-gray-700 text-sm dark:text-gray-300\">\n                      {t(\"æš´åŠ›çš„ãªè¡¨ç¾\", \"Violent content\")}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"h-2 w-2 rounded-full bg-red-500\" />\n                    <span className=\"text-gray-700 text-sm dark:text-gray-300\">\n                      {t(\n                        \"ãã®ä»–æˆäººå‘ã‘ã‚³ãƒ³ãƒ†ãƒ³ãƒ„\",\n                        \"Other adult-oriented content\",\n                      )}\n                    </span>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"rounded-xl border border-blue-200 bg-gradient-to-r from-blue-50 to-indigo-50 p-4 text-center dark:border-blue-800 dark:from-blue-950/30 dark:to-indigo-950/30\">\n              <p className=\"font-bold text-gray-900 text-lg dark:text-gray-100\">\n                {t(\"ã‚ãªãŸã¯18æ­³ä»¥ä¸Šã§ã™ã‹ï¼Ÿ\", \"Are you 18 years or older?\")}\n              </p>\n            </div>\n          </AlertDialogDescription>\n        </AlertDialogHeader>\n\n        <div className=\"border-gray-200 border-t pt-4 dark:border-gray-700\">\n          <div className=\"flex items-start space-x-3\">\n            <Checkbox\n              id={checkboxId}\n              checked={isRememberChoice}\n              onCheckedChange={(checked) =>\n                onRememberChoiceChange(checked === true)\n              }\n              className=\"mt-0.5 border-red-300 data-[state=checked]:border-red-600 data-[state=checked]:bg-red-600\"\n            />\n            <label\n              htmlFor={checkboxId}\n              className=\"cursor-pointer font-medium text-gray-700 text-sm leading-relaxed dark:text-gray-300\"\n            >\n              {t(\n                \"ã“ã®é¸æŠã‚’è¨˜æ†¶ã™ã‚‹ï¼ˆ30æ—¥é–“ã€æ¬¡å›ã‹ã‚‰ç¢ºèªã‚’ã‚¹ã‚­ãƒƒãƒ—ï¼‰\",\n                \"Remember this choice (30 days, skip confirmation next time)\",\n              )}\n            </label>\n          </div>\n        </div>\n\n        <AlertDialogFooter className=\"flex-col space-y-4 pt-4\">\n          <div className=\"flex w-full gap-3\">\n            <AlertDialogCancel\n              onClick={onCancel}\n              className=\"flex-1 border-red-200 text-red-700 hover:bg-red-50 dark:border-red-800 dark:text-red-300 dark:hover:bg-red-950\"\n            >\n              <span className=\"flex items-center gap-2\">\n                <EyeOff className=\"h-4 w-4\" />\n                {t(\"ã„ã„ãˆï¼ˆ18æ­³æœªæº€ï¼‰\", \"No (Under 18)\")}\n              </span>\n            </AlertDialogCancel>\n            <AlertDialogAction\n              onClick={onConfirm}\n              className=\"flex-1 bg-gradient-to-r from-red-600 to-pink-600 text-white shadow-lg hover:from-red-700 hover:to-pink-700\"\n            >\n              <span className=\"flex items-center gap-2\">\n                <Eye className=\"h-4 w-4\" />\n                {t(\"ã¯ã„ï¼ˆ18æ­³ä»¥ä¸Šï¼‰\", \"Yes (18 or older)\")}\n              </span>\n            </AlertDialogAction>\n          </div>\n        </AlertDialogFooter>\n      </AlertDialogContent>\n    </AlertDialog>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/sensitive/sensitive-toggle.tsx"},"span":[9629,9642],"sourceCode":"import { useEffect, useState, useId } from \"react\"\nimport { Button } from \"~/components/ui/button\"\nimport { Switch } from \"~/components/ui/switch\"\nimport { Label } from \"~/components/ui/label\"\nimport { useLocation, useNavigate } from \"react-router-dom\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { useLocale } from \"~/hooks/use-locale\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"~/components/ui/alert-dialog\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { setCookie, hasCookie } from \"~/lib/cookie-utils\"\nimport { Shield, Eye, EyeOff, AlertTriangle } from \"lucide-react\"\n\ntype Props = {\n  variant?: \"compact\" | \"full\" | \"toggle\" | \"card\"\n  className?: string\n  showStatus?: boolean\n  targetUrl?: string\n}\n\nexport function SensitiveToggle ({\n  variant = \"compact\",\n  className,\n  showStatus = false,\n  targetUrl,\n}: Props): React.ReactNode {\n  const [isR18Mode, setIsR18Mode] = useState(false)\n  const [isDialogOpen, setIsDialogOpen] = useState(false)\n  const [shouldSkipDialog, setShouldSkipDialog] = useState(false)\n  const [isRememberChoice, setIsRememberChoice] = useState(false)\n  const location = useLocation()\n  const navigate = useNavigate()\n  const locale = useLocale()\n  const t = useTranslation()\n  const checkboxId = useId()\n  const cookieKey = \"sensitive-content-confirmed\"\n\n  useEffect(() => {\n    // URLã«\"/r\"ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯\n    setIsR18Mode(/\\/r($|\\/)/.test(location.pathname))\n    // CookieãŒå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯\n    setShouldSkipDialog(hasCookie(cookieKey))\n  }, [location.pathname, cookieKey])\n\n  const performR18Toggle = () => {\n    if (targetUrl) {\n      // targetUrlãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ãã®URLã«ç›´æ¥ãƒŠãƒ“ã‚²ãƒ¼ãƒˆ\n      navigate(targetUrl, { replace: true })\n      return\n    }\n\n    const isEnglish = locale === \"en\"\n    let newPathname = location.pathname\n\n    if (isR18Mode) {\n      // R18ãƒ¢ãƒ¼ãƒ‰ã‚’OFFã«ã™ã‚‹ï¼ˆ\"/r\"ã‚’å‰Šé™¤ï¼‰\n      newPathname = location.pathname.replace(/\\/r/, \"\")\n      if (newPathname === \"\") newPathname = \"/\"\n    } else {\n      // R18ãƒ¢ãƒ¼ãƒ‰ã‚’ONã«ã™ã‚‹\n      if (isEnglish) {\n        newPathname = location.pathname.startsWith(\"/en\")\n          ? location.pathname.replace(\"/en\", \"/en/r\")\n          : `/en/r${location.pathname}`\n      } else {\n        newPathname = `/r${location.pathname}`\n      }\n    }\n\n    navigate(newPathname, { replace: true })\n  }\n\n  const handleR18ToggleClick = () => {\n    if (isR18Mode) {\n      // R18ãƒ¢ãƒ¼ãƒ‰ã‚’OFFã«ã™ã‚‹å ´åˆã¯ç›´æ¥å®Ÿè¡Œ\n      performR18Toggle()\n    } else {\n      // R18ãƒ¢ãƒ¼ãƒ‰ã‚’ONã«ã™ã‚‹å ´åˆã¯å¿…ãšç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º\n      if (shouldSkipDialog) {\n        performR18Toggle()\n      } else {\n        setIsDialogOpen(true)\n      }\n    }\n  }\n\n  const handleConfirm = () => {\n    // Cookieã‚’è¨­å®šï¼ˆ30æ—¥é–“ï¼‰\n    if (isRememberChoice) {\n      const expiryDate = new Date()\n      expiryDate.setDate(expiryDate.getDate() + 30)\n      setCookie(cookieKey, \"true\", {\n        expires: expiryDate,\n        path: \"/\",\n        secure: true,\n        sameSite: \"strict\",\n      })\n    }\n\n    // R18ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ\n    performR18Toggle()\n    setIsDialogOpen(false)\n    setIsRememberChoice(false)\n  }\n\n  const handleCancel = () => {\n    setIsDialogOpen(false)\n    setIsRememberChoice(false)\n  }\n\n  // ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆãƒãƒªã‚¢ãƒ³ãƒˆ - ãƒ˜ãƒƒãƒ€ãƒ¼/ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ç”¨\n  if (variant === \"compact\") {\n    return (\n      <>\n        <Button\n          variant={isR18Mode ? \"default\" : \"outline\"}\n          size=\"sm\"\n          onClick={handleR18ToggleClick}\n          className={cn(\n            \"group relative overflow-hidden transition-all duration-300 ease-in-out\",\n            isR18Mode\n              ? \"border-0 bg-gradient-to-r from-red-500 via-pink-500 to-rose-500 text-white shadow-lg hover:scale-105 hover:shadow-xl\"\n              : \"border-2 border-red-200/60 bg-white/80 text-red-600 backdrop-blur-sm hover:border-red-300 hover:bg-red-50 dark:border-red-700/60 dark:bg-gray-800/80 dark:text-red-400 dark:hover:bg-red-950/50\",\n            className,\n          )}\n        >\n          <span className=\"relative z-10 flex items-center gap-2\">\n            <span className=\"font-bold text-sm tracking-wide\">R18</span>\n            {showStatus && isR18Mode && (\n              <div className=\"h-2 w-2 animate-pulse rounded-full bg-white/80\" />\n            )}\n          </span>\n          {isR18Mode && (\n            <div className=\"absolute inset-0 animate-pulse bg-gradient-to-r from-red-600/20 via-pink-600/20 to-rose-600/20\" />\n          )}\n        </Button>\n\n        <ConfirmationDialog\n          isOpen={isDialogOpen}\n          onConfirm={handleConfirm}\n          onCancel={handleCancel}\n          isRememberChoice={isRememberChoice}\n          onRememberChoiceChange={setIsRememberChoice}\n          checkboxId={checkboxId}\n          t={t}\n        />\n      </>\n    )\n  }\n\n  // ã‚«ãƒ¼ãƒ‰ãƒãƒªã‚¢ãƒ³ãƒˆ - ãƒšãƒ¼ã‚¸ãƒ˜ãƒƒãƒ€ãƒ¼ç”¨\n  if (variant === \"card\") {\n    return (\n      <>\n        <div\n          className={cn(\n            \"flex items-center justify-between rounded-xl border bg-gradient-to-r p-4 shadow-sm transition-all duration-300\",\n            isR18Mode\n              ? \"border-red-200 from-red-50 to-pink-50 dark:border-red-800 dark:from-red-950/20 dark:to-pink-950/20\"\n              : \"border-gray-200 from-gray-50 to-gray-100 dark:border-gray-700 dark:from-gray-800 dark:to-gray-900\",\n            className,\n          )}\n        >\n          <div className=\"flex items-center space-x-4\">\n            <div\n              className={cn(\n                \"flex h-12 w-12 items-center justify-center rounded-xl transition-all duration-300\",\n                isR18Mode\n                  ? \"bg-gradient-to-r from-red-100 to-pink-100 dark:from-red-900 dark:to-pink-900\"\n                  : \"bg-gray-200 dark:bg-gray-700\",\n              )}\n            >\n              {isR18Mode ? (\n                <AlertTriangle className=\"h-6 w-6 text-red-600 dark:text-red-400\" />\n              ) : (\n                <Shield className=\"h-6 w-6 text-gray-600 dark:text-gray-400\" />\n              )}\n            </div>\n            <div>\n              <h3 className=\"font-bold text-gray-900 dark:text-gray-100\">\n                {t(\"å¹´é½¢åˆ¶é™ã‚³ãƒ³ãƒ†ãƒ³ãƒ„\", \"Age-Restricted Content\")}\n              </h3>\n              <p className=\"text-gray-600 text-sm dark:text-gray-400\">\n                {isR18Mode\n                  ? t(\n                      \"R18ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™\",\n                      \"R18 content is visible\",\n                    )\n                  : t(\"R18ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯éè¡¨ç¤ºã§ã™\", \"R18 content is hidden\")}\n              </p>\n            </div>\n          </div>\n          <Button\n            variant={isR18Mode ? \"destructive\" : \"outline\"}\n            onClick={handleR18ToggleClick}\n            className={cn(\n              \"transition-all duration-300\",\n              isR18Mode\n                ? \"bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-700 hover:to-pink-700\"\n                : \"border-red-200 text-red-600 hover:bg-red-50 dark:border-red-800 dark:text-red-400 dark:hover:bg-red-950\",\n            )}\n          >\n            <span className=\"flex items-center gap-2\">\n              {isR18Mode ? (\n                <EyeOff className=\"h-4 w-4\" />\n              ) : (\n                <Eye className=\"h-4 w-4\" />\n              )}\n              <span className=\"font-medium\">\n                {isR18Mode ? t(\"éè¡¨ç¤ºã«ã™ã‚‹\", \"Hide\") : t(\"è¡¨ç¤ºã™ã‚‹\", \"Show\")}\n              </span>\n            </span>\n          </Button>\n        </div>\n\n        <ConfirmationDialog\n          isOpen={isDialogOpen}\n          onConfirm={handleConfirm}\n          onCancel={handleCancel}\n          isRememberChoice={isRememberChoice}\n          onRememberChoiceChange={setIsRememberChoice}\n          checkboxId={checkboxId}\n          t={t}\n        />\n      </>\n    )\n  }\n\n  // ãƒˆã‚°ãƒ«ãƒãƒªã‚¢ãƒ³ãƒˆ - è¨­å®šç”»é¢ç”¨\n  if (variant === \"toggle\") {\n    return (\n      <>\n        <div\n          className={cn(\n            \"flex items-center justify-between space-x-4 rounded-xl bg-gradient-to-r from-gray-50 to-gray-100 p-4 dark:from-gray-800 dark:to-gray-900\",\n            className,\n          )}\n        >\n          <div className=\"flex items-center space-x-3\">\n            <div\n              className={cn(\n                \"rounded-lg p-2 transition-colors\",\n                isR18Mode\n                  ? \"bg-red-100 dark:bg-red-900\"\n                  : \"bg-gray-200 dark:bg-gray-700\",\n              )}\n            >\n              {isR18Mode ? (\n                <Shield className=\"h-5 w-5 text-red-600 dark:text-red-400\" />\n              ) : (\n                <Eye className=\"h-5 w-5 text-gray-600 dark:text-gray-400\" />\n              )}\n            </div>\n            <div>\n              <Label\n                htmlFor=\"sensitive-toggle\"\n                className=\"cursor-pointer font-semibold text-sm\"\n              >\n                {t(\"å¹´é½¢åˆ¶é™ã‚³ãƒ³ãƒ†ãƒ³ãƒ„\", \"Age-Restricted Content\")}\n              </Label>\n              <p className=\"text-muted-foreground text-xs\">\n                {isR18Mode\n                  ? t(\"R18ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒè¡¨ç¤ºã•ã‚Œã¾ã™\", \"R18 content is visible\")\n                  : t(\"R18ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯éè¡¨ç¤ºã§ã™\", \"R18 content is hidden\")}\n              </p>\n            </div>\n          </div>\n          {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n          <Switch\n            id=\"sensitive-toggle\"\n            checked={isR18Mode}\n            onCheckedChange={handleR18ToggleClick}\n            className={cn(\n              \"data-[state=checked]:bg-gradient-to-r data-[state=checked]:from-red-500 data-[state=checked]:to-pink-500\",\n              \"transition-all duration-300\",\n            )}\n          />\n        </div>\n\n        <ConfirmationDialog\n          isOpen={isDialogOpen}\n          onConfirm={handleConfirm}\n          onCancel={handleCancel}\n          isRememberChoice={isRememberChoice}\n          onRememberChoiceChange={setIsRememberChoice}\n          checkboxId={checkboxId}\n          t={t}\n        />\n      </>\n    )\n  }\n\n  // ãƒ•ãƒ«ãƒãƒªã‚¢ãƒ³ãƒˆ - è©³ç´°è¨­å®šãƒšãƒ¼ã‚¸ç”¨\n  return (\n    <>\n      <div className={cn(\"space-y-6 \", className)}>\n        <div className=\"flex items-center justify-between space-x-2\">\n          <div className=\"space-y-1\">\n            <Label htmlFor=\"full-sensitive-toggle\">\n              {t(\"R18ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¡¨ç¤º\", \"Show R18 Content\")}\n            </Label>\n          </div>\n          {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n          <Switch\n            id=\"full-sensitive-toggle\"\n            checked={isR18Mode}\n            onCheckedChange={handleR18ToggleClick}\n            className=\"data-[state=checked]:bg-gradient-to-r data-[state=checked]:from-red-500 data-[state=checked]:to-pink-500\"\n          />\n        </div>\n\n        {/* {isR18Mode && (\n          <div className=\"flex items-center gap-3 rounded-lg border border-red-200 bg-gradient-to-r from-red-50 to-pink-50 p-4 dark:border-red-800 dark:from-red-950/50 dark:to-pink-950/50\">\n            <AlertTriangle className=\"h-6 w-6 text-red-600 dark:text-red-400\" />\n            <div>\n              <h4 className=\" text-red-800 dark:text-red-200\">\n                {t(\"R18ãƒ¢ãƒ¼ãƒ‰æœ‰åŠ¹\", \"R18 Mode Active\")}\n              </h4>\n              <p className=\"text-red-700 text-sm dark:text-red-300\">\n                {t(\n                  \"å¹´é½¢åˆ¶é™ã®ã‚ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™\",\n                  \"Age-restricted content is now visible\",\n                )}\n              </p>\n            </div>\n          </div>\n        )} */}\n      </div>\n\n      <ConfirmationDialog\n        isOpen={isDialogOpen}\n        onConfirm={handleConfirm}\n        onCancel={handleCancel}\n        isRememberChoice={isRememberChoice}\n        onRememberChoiceChange={setIsRememberChoice}\n        checkboxId={checkboxId}\n        t={t}\n      />\n    </>\n  )\n}\n\n// ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ\nfunction ConfirmationDialog({\n  isOpen,\n  onConfirm,\n  onCancel,\n  isRememberChoice,\n  onRememberChoiceChange,\n  checkboxId,\n  t,\n}: {\n  isOpen: boolean\n  onConfirm: () => void\n  onCancel: () => void\n  isRememberChoice: boolean\n  onRememberChoiceChange: (checked: boolean) => void\n  checkboxId: string\n  t: (ja: string, en: string) => string\n}) {\n  return (\n    <AlertDialog open={isOpen} onOpenChange={onCancel}>\n      <AlertDialogContent className=\"max-w-lg border-red-200 dark:border-red-800\">\n        <AlertDialogHeader className=\"space-y-4\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"rounded-full bg-red-100 p-3 dark:bg-red-900\">\n              <AlertTriangle className=\"h-6 w-6 text-red-600 dark:text-red-400\" />\n            </div>\n            <AlertDialogTitle className=\"font-bold text-red-700 text-xl dark:text-red-300\">\n              {t(\"å¹´é½¢ç¢ºèªãŒå¿…è¦ã§ã™\", \"Age Verification Required\")}\n            </AlertDialogTitle>\n          </div>\n\n          <AlertDialogDescription className=\"space-y-4\">\n            <div className=\"rounded-xl border border-red-200 bg-gradient-to-r from-red-50 via-pink-50 to-rose-50 p-4 dark:border-red-800 dark:from-red-950/30 dark:via-pink-950/30 dark:to-rose-950/30\">\n              <div className=\"flex items-start gap-3\">\n                <span className=\"text-2xl\">!</span>\n                <div>\n                  <h4 className=\"mb-2 font-bold text-red-800 dark:text-red-200\">\n                    {t(\"é‡è¦ãªè­¦å‘Š\", \"Important Warning\")}\n                  </h4>\n                  <p className=\"text-red-700 text-sm leading-relaxed dark:text-red-300\">\n                    {t(\n                      \"ã“ã‚Œã‹ã‚‰è¡¨ç¤ºã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ã¯ã€18æ­³æœªæº€ã®æ–¹ã«ã¯ä¸é©åˆ‡ãªå†…å®¹ãŒå«ã¾ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚\",\n                      \"The content you are about to view may contain material inappropriate for viewers under 18 years of age.\",\n                    )}\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"space-y-3\">\n              <div className=\"rounded-lg bg-gray-50 p-4 dark:bg-gray-800/50\">\n                <h5 className=\"mb-3 font-semibold text-gray-800 dark:text-gray-200\">\n                  {t(\"å«ã¾ã‚Œã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹å†…å®¹\", \"Content may include\")}\n                </h5>\n                <div className=\"grid gap-2\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"h-2 w-2 rounded-full bg-red-500\" />\n                    <span className=\"text-gray-700 text-sm dark:text-gray-300\">\n                      {t(\"æ€§çš„ãªè¡¨ç¾ã‚„æå†™\", \"Sexual content and depictions\")}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"h-2 w-2 rounded-full bg-red-500\" />\n                    <span className=\"text-gray-700 text-sm dark:text-gray-300\">\n                      {t(\"æš´åŠ›çš„ãªè¡¨ç¾\", \"Violent content\")}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"h-2 w-2 rounded-full bg-red-500\" />\n                    <span className=\"text-gray-700 text-sm dark:text-gray-300\">\n                      {t(\n                        \"ãã®ä»–æˆäººå‘ã‘ã‚³ãƒ³ãƒ†ãƒ³ãƒ„\",\n                        \"Other adult-oriented content\",\n                      )}\n                    </span>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"rounded-xl border border-blue-200 bg-gradient-to-r from-blue-50 to-indigo-50 p-4 text-center dark:border-blue-800 dark:from-blue-950/30 dark:to-indigo-950/30\">\n              <p className=\"font-bold text-gray-900 text-lg dark:text-gray-100\">\n                {t(\"ã‚ãªãŸã¯18æ­³ä»¥ä¸Šã§ã™ã‹ï¼Ÿ\", \"Are you 18 years or older?\")}\n              </p>\n            </div>\n          </AlertDialogDescription>\n        </AlertDialogHeader>\n\n        <div className=\"border-gray-200 border-t pt-4 dark:border-gray-700\">\n          <div className=\"flex items-start space-x-3\">\n            <Checkbox\n              id={checkboxId}\n              checked={isRememberChoice}\n              onCheckedChange={(checked) =>\n                onRememberChoiceChange(checked === true)\n              }\n              className=\"mt-0.5 border-red-300 data-[state=checked]:border-red-600 data-[state=checked]:bg-red-600\"\n            />\n            <label\n              htmlFor={checkboxId}\n              className=\"cursor-pointer font-medium text-gray-700 text-sm leading-relaxed dark:text-gray-300\"\n            >\n              {t(\n                \"ã“ã®é¸æŠã‚’è¨˜æ†¶ã™ã‚‹ï¼ˆ30æ—¥é–“ã€æ¬¡å›ã‹ã‚‰ç¢ºèªã‚’ã‚¹ã‚­ãƒƒãƒ—ï¼‰\",\n                \"Remember this choice (30 days, skip confirmation next time)\",\n              )}\n            </label>\n          </div>\n        </div>\n\n        <AlertDialogFooter className=\"flex-col space-y-4 pt-4\">\n          <div className=\"flex w-full gap-3\">\n            <AlertDialogCancel\n              onClick={onCancel}\n              className=\"flex-1 border-red-200 text-red-700 hover:bg-red-50 dark:border-red-800 dark:text-red-300 dark:hover:bg-red-950\"\n            >\n              <span className=\"flex items-center gap-2\">\n                <EyeOff className=\"h-4 w-4\" />\n                {t(\"ã„ã„ãˆï¼ˆ18æ­³æœªæº€ï¼‰\", \"No (Under 18)\")}\n              </span>\n            </AlertDialogCancel>\n            <AlertDialogAction\n              onClick={onConfirm}\n              className=\"flex-1 bg-gradient-to-r from-red-600 to-pink-600 text-white shadow-lg hover:from-red-700 hover:to-pink-700\"\n            >\n              <span className=\"flex items-center gap-2\">\n                <Eye className=\"h-4 w-4\" />\n                {t(\"ã¯ã„ï¼ˆ18æ­³ä»¥ä¸Šï¼‰\", \"Yes (18 or older)\")}\n              </span>\n            </AlertDialogAction>\n          </div>\n        </AlertDialogFooter>\n      </AlertDialogContent>\n    </AlertDialog>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/sms-verification-dialog.tsx"},"span":[2149,2179],"sourceCode":"import {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\"\nimport { useEffect, useRef, useState } from \"react\"\nimport {\n  RecaptchaVerifier,\n  browserLocalPersistence,\n  getAuth,\n  setPersistence,\n  signInWithPhoneNumber,\n} from \"firebase/auth\"\nimport { telStringToNumber } from \"~/utils/tel-string-to-number\"\nimport { Input } from \"~/components/ui/input\"\nimport { Button } from \"~/components/ui/button\"\n\ntype Props = {\n  children: React.ReactNode\n}\n\n/**\n * SMSèªè¨¼ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function SmsVerificationDialog (props: Props): React.ReactNode {\n  const [phoneNumber, setPhoneNumber] = useState(\"\")\n\n  const [applicationVerifier, setApplicationVerifier] =\n    useState<RecaptchaVerifier | null>(null)\n\n  const recaptchaContainerRef = useRef<HTMLDivElement>(null)\n\n  useEffect(() => {\n    const auth = getAuth()\n\n    if (recaptchaContainerRef.current === null) return\n\n    const verifier = new RecaptchaVerifier(auth, \"recaptcha-container\", {\n      size: \"invisible\",\n      \"expired-callback\": () => {},\n    })\n\n    setApplicationVerifier(verifier)\n\n    signInSms()\n  }, [phoneNumber])\n\n  const signInSms = async () => {\n    if (applicationVerifier === null) return\n\n    const auth = getAuth()\n\n    await setPersistence(auth, browserLocalPersistence)\n\n    const phoneNumberToNumber = telStringToNumber(phoneNumber)\n\n    try {\n      if (phoneNumberToNumber) {\n        await signInWithPhoneNumber(\n          auth,\n          phoneNumberToNumber,\n          applicationVerifier,\n        )\n      }\n    } catch (error) {\n      console.error(\"signInWithPhoneNumber\", error)\n    }\n  }\n\n  return (\n    <>\n      <Dialog\n      // open={props.isOpen}\n      // onOpenChange={() => {\n      //   props.onClose()\n      // }}\n      >\n        <DialogTrigger asChild>{props.children}</DialogTrigger>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>{\"èªè¨¼æ¡ˆå†…\"}</DialogTitle>\n            <p>{\"SMSèªè¨¼ã‚’è¡Œã„ã¾ã™ã€‚\"}</p>\n            <div ref={recaptchaContainerRef}>\n              {/* biome-ignore lint/style/useSelfClosingElements: <explanation> */}\n              <div id=\"recaptcha-container\"></div>\n            </div>\n            <div className=\"flex items-center\">\n              <Input\n                type=\"tel\"\n                value={phoneNumber}\n                onChange={(e) => setPhoneNumber(e.target.value)}\n              />\n              <Button onClick={signInSms}>{\"èªè¨¼\"}</Button>\n            </div>\n          </DialogHeader>\n        </DialogContent>\n      </Dialog>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/sms-verification-dialog.tsx"},"span":[2120,2133],"sourceCode":"import {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\"\nimport { useEffect, useRef, useState } from \"react\"\nimport {\n  RecaptchaVerifier,\n  browserLocalPersistence,\n  getAuth,\n  setPersistence,\n  signInWithPhoneNumber,\n} from \"firebase/auth\"\nimport { telStringToNumber } from \"~/utils/tel-string-to-number\"\nimport { Input } from \"~/components/ui/input\"\nimport { Button } from \"~/components/ui/button\"\n\ntype Props = {\n  children: React.ReactNode\n}\n\n/**\n * SMSèªè¨¼ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function SmsVerificationDialog (props: Props): React.ReactNode {\n  const [phoneNumber, setPhoneNumber] = useState(\"\")\n\n  const [applicationVerifier, setApplicationVerifier] =\n    useState<RecaptchaVerifier | null>(null)\n\n  const recaptchaContainerRef = useRef<HTMLDivElement>(null)\n\n  useEffect(() => {\n    const auth = getAuth()\n\n    if (recaptchaContainerRef.current === null) return\n\n    const verifier = new RecaptchaVerifier(auth, \"recaptcha-container\", {\n      size: \"invisible\",\n      \"expired-callback\": () => {},\n    })\n\n    setApplicationVerifier(verifier)\n\n    signInSms()\n  }, [phoneNumber])\n\n  const signInSms = async () => {\n    if (applicationVerifier === null) return\n\n    const auth = getAuth()\n\n    await setPersistence(auth, browserLocalPersistence)\n\n    const phoneNumberToNumber = telStringToNumber(phoneNumber)\n\n    try {\n      if (phoneNumberToNumber) {\n        await signInWithPhoneNumber(\n          auth,\n          phoneNumberToNumber,\n          applicationVerifier,\n        )\n      }\n    } catch (error) {\n      console.error(\"signInWithPhoneNumber\", error)\n    }\n  }\n\n  return (\n    <>\n      <Dialog\n      // open={props.isOpen}\n      // onOpenChange={() => {\n      //   props.onClose()\n      // }}\n      >\n        <DialogTrigger asChild>{props.children}</DialogTrigger>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>{\"èªè¨¼æ¡ˆå†…\"}</DialogTitle>\n            <p>{\"SMSèªè¨¼ã‚’è¡Œã„ã¾ã™ã€‚\"}</p>\n            <div ref={recaptchaContainerRef}>\n              {/* biome-ignore lint/style/useSelfClosingElements: <explanation> */}\n              <div id=\"recaptcha-container\"></div>\n            </div>\n            <div className=\"flex items-center\">\n              <Input\n                type=\"tel\"\n                value={phoneNumber}\n                onChange={(e) => setPhoneNumber(e.target.value)}\n              />\n              <Button onClick={signInSms}>{\"èªè¨¼\"}</Button>\n            </div>\n          </DialogHeader>\n        </DialogContent>\n      </Dialog>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/tag/autocomplete.tsx"},"span":[1036,1049],"sourceCode":"// https://github.com/JaleelB/emblor/blob/main/website/components/tag/autocomplete.tsx\n\nimport type React from \"react\"\nimport {\n  Command,\n  CommandList,\n  CommandItem,\n  CommandGroup,\n  CommandEmpty,\n} from \"~/components/ui/command\"\nimport type { Tag as TagType } from \"./tag-input\"\n\ntype AutocompleteProps = {\n  tags: TagType[]\n  setTags: React.Dispatch<React.SetStateAction<TagType[]>>\n  autocompleteOptions: TagType[]\n  maxTags?: number\n  onTagAdd?: (tag: string) => void\n  allowDuplicates: boolean\n  children: React.ReactNode\n}\n\nexport function Autocomplete ({\n  tags,\n  setTags,\n  autocompleteOptions,\n  maxTags,\n  onTagAdd,\n  allowDuplicates,\n  children,\n}: AutocompleteProps): React.ReactNode {\n  return (\n    <Command className=\"border\">\n      {children}\n      <CommandList>\n        <CommandEmpty>{\"æ¤œç´¢çµæœãªã—\"}</CommandEmpty>\n        <CommandGroup heading=\"\">\n          {autocompleteOptions.map((option) => (\n            <CommandItem key={option.id}>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-full\"\n                onClick={() => {\n                  if (maxTags && tags.length >= maxTags) return\n                  if (\n                    !allowDuplicates &&\n                    tags.some((tag) => tag.text === option.text)\n                  )\n                    return\n                  setTags([...tags, option])\n                  onTagAdd?.(option.text)\n                }}\n              >\n                {option.text}\n              </div>\n            </CommandItem>\n          ))}\n        </CommandGroup>\n      </CommandList>\n    </Command>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/tag/tag.tsx"},"span":[2666,2679],"sourceCode":"// https://github.com/JaleelB/emblor/blob/main/website/components/tag/tag.tsx\n\nimport { X } from \"lucide-react\"\nimport { Button } from \"../ui/button\"\nimport type { TagInputProps, Tag as TagType } from \"./tag-input\"\nimport { cn } from \"~/lib/utils\"\nimport { cva } from \"class-variance-authority\"\n\nexport const tagVariants = cva(\n  \"transition-all border inline-flex items-center text-sm pl-2 rounded-md\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        primary:\n          \"bg-primary border-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive border-destructive text-destructive-foreground hover:bg-destructive/90\",\n      },\n      size: {\n        sm: \"text-xs h-7\",\n        md: \"text-sm h-8\",\n        lg: \"text-base h-9\",\n        xl: \"text-lg h-10\",\n      },\n      shape: {\n        default: \"rounded-sm\",\n        rounded: \"rounded-lg\",\n        square: \"rounded-none\",\n        pill: \"rounded-full\",\n      },\n      borderStyle: {\n        default: \"border-solid\",\n        none: \"border-none\",\n      },\n      textCase: {\n        uppercase: \"uppercase\",\n        lowercase: \"lowercase\",\n        capitalize: \"capitalize\",\n      },\n      interaction: {\n        clickable: \"cursor-pointer hover:shadow-md\",\n        nonClickable: \"cursor-default\",\n      },\n      animation: {\n        none: \"\",\n        fadeIn: \"animate-fadeIn\",\n        slideIn: \"animate-slideIn\",\n        bounce: \"animate-bounce\",\n      },\n      textStyle: {\n        normal: \"font-normal\",\n        bold: \"font-bold\",\n        italic: \"italic\",\n        underline: \"underline\",\n        lineThrough: \"line-through\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"md\",\n      shape: \"default\",\n      borderStyle: \"default\",\n      interaction: \"nonClickable\",\n      animation: \"fadeIn\",\n      textStyle: \"normal\",\n    },\n  },\n)\n\nexport type TagProps = {\n  tagObj: TagType\n  variant: TagInputProps[\"variant\"]\n  size: TagInputProps[\"size\"]\n  shape: TagInputProps[\"shape\"]\n  borderStyle: TagInputProps[\"borderStyle\"]\n  textCase: TagInputProps[\"textCase\"]\n  interaction: TagInputProps[\"interaction\"]\n  animation: TagInputProps[\"animation\"]\n  textStyle: TagInputProps[\"textStyle\"]\n  onRemoveTag: (id: string) => void\n} & Pick<TagInputProps, \"direction\" | \"onTagClick\" | \"draggable\">\n\nexport function Tag ({\n  tagObj,\n  direction,\n  draggable,\n  onTagClick,\n  onRemoveTag,\n  variant,\n  size,\n  shape,\n  borderStyle,\n  textCase,\n  interaction,\n  animation,\n  textStyle,\n}: TagProps): React.ReactNode {\n  return (\n    // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n    <span\n      key={tagObj.id}\n      draggable={draggable}\n      className={cn(\n        tagVariants({\n          variant,\n          size,\n          shape,\n          borderStyle,\n          textCase,\n          interaction,\n          animation,\n          textStyle,\n        }),\n        {\n          \"justify-between\": direction === \"column\",\n          \"cursor-pointer\": draggable,\n        },\n      )}\n      onClick={() => onTagClick?.(tagObj)}\n    >\n      {tagObj.text}\n      <Button\n        type=\"button\"\n        variant=\"ghost\"\n        onClick={(e) => {\n          e.stopPropagation() // Prevent event from bubbling up to the tag span\n          onRemoveTag(tagObj.id)\n        }}\n        className={cn(\"h-full px-3 py-1 hover:bg-transparent\")}\n      >\n        <X size={14} />\n      </Button>\n    </span>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/toggle-content.tsx"},"span":[787,800],"sourceCode":"import { type ReactNode, useState } from \"react\"\n\ntype Props = {\n  trigger: ReactNode\n  children: ReactNode\n  maxHeight?: string\n  initialOpen?: boolean\n}\n\nexport function ToggleContent ({\n  trigger,\n  children,\n  maxHeight = \"480px\",\n  initialOpen = false,\n}: Props): React.ReactNode {\n  const [isOpen, setIsOpen] = useState(initialOpen)\n  const [contentHeight, setContentHeight] = useState(isOpen ? maxHeight : \"0px\")\n  const [contentOpacity, setContentOpacity] = useState(isOpen ? 1 : 0)\n\n  const toggleContent = () => {\n    if (isOpen) {\n      setContentHeight(\"0px\")\n      setContentOpacity(0)\n    } else {\n      setContentHeight(maxHeight)\n      setContentOpacity(1)\n    }\n    setIsOpen(!isOpen)\n  }\n\n  return (\n    <div>\n      {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n      <div onClick={toggleContent} style={{ cursor: \"pointer\" }}>\n        {trigger}\n      </div>\n      <div\n        style={{\n          maxHeight: contentHeight,\n          overflow: \"hidden\",\n          transition: \"max-height 0.3s ease-out, opacity 0.3s ease-out\",\n          opacity: contentOpacity,\n        }}\n      >\n        {children}\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable verificationUrlRefetch is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"verificationUrlRefetch"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/verification-dialog.tsx"},"span":[671,693],"sourceCode":"import {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { useEffect, useState } from \"react\"\nimport { LineLoggedInButton } from \"~/components/button/line-logged-in-button\"\nimport { Link } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  isOpen: boolean\n  onClose(): void\n  verificationResult?: string | null\n}\n\n/**\n * èªè¨¼ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function VerificationDialog (props: Props): React.ReactNode {\n  const t = useTranslation()\n\n  const { data: verificationUrlRet, refetch: verificationUrlRefetch } =\n    useQuery(verificationUrlQuery)\n\n  const verificationUrl = verificationUrlRet?.viewer?.verificationUrl\n\n  const [showVerificationResult, setShowVerificationResult] = useState(false)\n\n  useEffect(() => {\n    if (\n      props.verificationResult === \"verification\" ||\n      props.verificationResult === \"verification_error\"\n    ) {\n      setShowVerificationResult(true)\n    }\n  }, [])\n\n  return (\n    <>\n      <Dialog\n        open={props.isOpen || showVerificationResult}\n        onOpenChange={() => {\n          props.onClose()\n          setShowVerificationResult(false)\n          if (\n            props.verificationResult === \"verification_error\" ||\n            props.verificationResult === \"verification\"\n          ) {\n            // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‰Šé™¤\n            if (window) {\n              window.location.href = \"/generation\"\n            }\n          }\n        }}\n      >\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>{t(\"èªè¨¼æ¡ˆå†…\", \"Verification Guide\")}</DialogTitle>\n            {props.verificationResult === \"verification\" && (\n              <>\n                <p>\n                  {t(\"èªè¨¼ãŒå®Œäº†ã„ãŸã—ã¾ã—ãŸã€‚\", \"Verification completed.\")}\n                </p>\n                <p>\n                  {t(\n                    \"æ¯æ—¥ç„¡æ–™10æšç”ŸæˆãŒè§£æ”¾ã•ã‚Œã¾ã—ãŸã€‚\",\n                    \"You have unlocked 10 free generations per day.\",\n                  )}\n                </p>\n              </>\n            )}\n            {props.verificationResult === \"verification_error\" && (\n              <>\n                <p>{t(\"èªè¨¼ãŒå¤±æ•—ã„ãŸã—ã¾ã—ãŸã€‚\", \"Verification failed.\")}</p>\n                <p>\n                  {t(\n                    \"ã—ã°ã‚‰ãã—ã¦ã‹ã‚‰å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚\",\n                    \"Please try again later.\",\n                  )}\n                </p>\n                <Link\n                  to={verificationUrl ?? \"\"}\n                  rel=\"noopener noreferrer\"\n                  target=\"_blank\"\n                >\n                  <div className=\"mt-2 mb-2\">\n                    <LineLoggedInButton\n                      onClick={() => {}}\n                      text={t(\n                        \"LINEã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã‚¢ã‚«ã‚¦ãƒ³ãƒˆèªè¨¼\",\n                        \"Log in with LINE to verify your account\",\n                      )}\n                    />\n                  </div>\n                </Link>\n                <p>\n                  {t(\n                    \"Aipictors+ã«åŠ å…¥ã™ã‚‹å ´åˆã¯èªè¨¼ä¸è¦ã§ã™ã€‚\",\n                    \"Verification is not required if you join Aipictors+.\",\n                  )}\n                </p>\n                <Link to=\"/plus\">\n                  <img\n                    src=\"https://pub-c8b482e79e9f4e7ab4fc35d3eb5ecda8.r2.dev/aipictors-plus-plans-lists_%20.png\"\n                    alt=\"aipictors-plus\"\n                  />\n                </Link>\n              </>\n            )}\n            {!props.verificationResult && (\n              <>\n                <p className=\"text-left text-md\">\n                  {t(\n                    \"ãŠè©¦ã—ãƒ—ãƒ©ãƒ³ã®ç”ŸæˆãŒçµ‚äº†ã„ãŸã—ã¾ã—ãŸã€‚\",\n                    \"The free trial has ended.\",\n                  )}\n                </p>\n                <p className=\"text-left text-md\">\n                  {t(\n                    \"æœ¬äººç¢ºèªã§æ¯æ—¥ç„¡æ–™ã§10æšç”Ÿæˆå¯èƒ½ã§ã™ã€‚\",\n                    \"With verification, you can generate 10 free works daily.\",\n                  )}\n                </p>\n                <p className=\"text-left text-sm\">\n                  {t(\n                    \"èªè¨¼æƒ…å ±ã¯æœ¬äººç¢ºèªã®ã¿ã«ä½¿ç”¨ã—ã€ä»–ã®ç”¨é€”ã§ã¯ä¸€åˆ‡ä½¿ç”¨ã•ã‚Œã¾ã›ã‚“ã€‚\",\n                    \"Verification information is used only for identity confirmation and will not be used for any other purpose.\",\n                  )}\n                </p>\n                <Link\n                  to={verificationUrl ?? \"\"}\n                  rel=\"noopener noreferrer\"\n                  target=\"_blank\"\n                >\n                  <div className=\"mt-2 mb-2\">\n                    <LineLoggedInButton\n                      onClick={() => {}}\n                      text={t(\n                        \"LINEã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã‚¢ã‚«ã‚¦ãƒ³ãƒˆèªè¨¼\",\n                        \"Log in with LINE to verify your account\",\n                      )}\n                    />\n                  </div>\n                </Link>\n                <p className=\"text-left\">\n                  {t(\n                    \"Aipictors+ã«åŠ å…¥ã™ã‚‹å ´åˆã¯èªè¨¼ä¸è¦ã§ã™ã€‚\",\n                    \"Verification is not required if you join Aipictors+.\",\n                  )}\n                </p>\n                <Link to=\"/plus\">\n                  <img\n                    src=\"https://pub-c8b482e79e9f4e7ab4fc35d3eb5ecda8.r2.dev/aipictors-plus-plans-lists_%20.png\"\n                    alt=\"aipictors-plus\"\n                  />\n                </Link>\n              </>\n            )}\n          </DialogHeader>\n        </DialogContent>\n      </Dialog>\n    </>\n  )\n}\n\nconst verificationUrlQuery = graphql(\n  `query VerificationUrl {\n    viewer {\n      id\n      verificationUrl\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/suspicious/noDocumentCookie","severity":"warning","description":"Direct assigning to document.cookie is not recommended.","message":[{"elements":[],"content":"Direct assigning to "},{"elements":["Emphasis"],"content":"document.cookie"},{"elements":[],"content":" is not recommended."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Consider using the "},{"elements":[{"Hyperlink":{"href":"https://developer.mozilla.org/en-US/docs/Web/API/CookieStore"}}],"content":"Cookie Store API"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/work/sticker-dialog.tsx"},"span":[1577,1653],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { useContext, useState, useEffect, useRef } from \"react\"\nimport { Tabs, TabsList, TabsTrigger } from \"~/components/ui/tabs\"\nimport {\n  StickerButton,\n  StickerButtonFragment,\n} from \"~/routes/($lang)._main.posts.$post._index/components/sticker-button\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { graphql } from \"gql.tada\"\nimport { AddStickerButton } from \"~/routes/($lang)._main.posts.$post._index/components/add-sticker-button\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { useFocusTimeout } from \"~/hooks/use-focus-timeout\"\nimport { MinusIcon, PlusIcon } from \"lucide-react\"\n\ntype Props = {\n  isOpen: boolean\n  onClose(): void\n  onSend(stickerId: string, stickerImageURL: string): void\n  isTargetUserBlocked?: boolean\n}\n\n/**\n * ã‚¯ãƒƒã‚­ãƒ¼ã®å€¤ã‚’å–å¾—ã™ã‚‹é–¢æ•°\n */\nfunction getCookie(name: string) {\n  const value = `; ${document.cookie}`\n  const parts = value.split(`; ${name}=`)\n  if (parts.length === 2) return parts.pop()?.split(\";\").shift()\n  return undefined\n}\n\n/**\n * ã‚¯ãƒƒã‚­ãƒ¼ã«å€¤ã‚’è¨­å®šã™ã‚‹é–¢æ•°\n */\nfunction setCookie(name: string, value: string, days: number) {\n  const expires = new Date()\n  expires.setTime(expires.getTime() + days * 24 * 60 * 60 * 1000)\n  document.cookie = `${name}=${value};expires=${expires.toUTCString()};path=/`\n}\n\n/**\n * ã‚¹ã‚¿ãƒ³ãƒ—é€ä¿¡ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼ˆä½œå“ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ç”¨ï¼‰\n */\nexport function StickerDialog (props: Props): React.ReactNode {\n  const appContext = useContext(AuthContext)\n\n  const [createdSortStickerPage, setCreatedSortStickerPage] = useState(0)\n\n  const [type, setType] = useState(\"CREATED\")\n\n  // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã‚’ä¿æŒã™ã‚‹ãŸã‚ã®ref\n  const scrollAreaRef = useRef<React.ElementRef<typeof ScrollArea>>(null)\n  const [savedScrollPositions, setSavedScrollPositions] = useState<\n    Record<number, number>\n  >({})\n\n  const maxStickersPage = 120\n\n  const { data: stickers = null, refetch } = useQuery(viewerUserStickersQuery, {\n    skip: !props.isOpen || appContext.isNotLoggedIn,\n    variables: {\n      limit: maxStickersPage,\n      offset: createdSortStickerPage * maxStickersPage,\n      orderBy: \"DATE_CREATED\",\n    },\n    notifyOnNetworkStatusChange: true,\n    errorPolicy: \"all\",\n  })\n\n  const { data: stickersCount = null } = useQuery(\n    viewerUserStickersCountQuery,\n    {\n      skip: !props.isOpen || appContext.isNotLoggedIn,\n    },\n  )\n\n  const maxCount = stickersCount?.viewer?.userStickersCount ?? 0\n\n  const t = useTranslation()\n\n  // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ¤œçŸ¥\n  const isTimeout = useFocusTimeout()\n\n  // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒé–‹ã‹ã‚ŒãŸæ™‚ã‚„ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ãŒå¤‰åŒ–ã—ãŸæ™‚ã«ãƒªãƒ•ã‚§ãƒƒãƒ\n  useEffect(() => {\n    if (props.isOpen && appContext.isLoggedIn && !appContext.isLoading) {\n      refetch()\n    }\n  }, [props.isOpen, appContext.isLoggedIn, appContext.isLoading, refetch])\n\n  // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚ã®è‡ªå‹•ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥\n  useEffect(() => {\n    if (isTimeout && props.isOpen && appContext.isLoggedIn) {\n      refetch().catch((error) => {\n        console.warn(\"Failed to refresh stickers after timeout:\", error)\n      })\n    }\n  }, [isTimeout, props.isOpen, appContext.isLoggedIn, refetch])\n\n  // ã‚µã‚¤ã‚ºè¨­å®š\n  const sizeOptions: Array<80 | 100 | 120> = [80, 100, 120]\n  const [sizeIndex, setSizeIndex] = useState(1)\n\n  // ã‚¯ãƒƒã‚­ãƒ¼ã‹ã‚‰ã‚µã‚¤ã‚ºè¨­å®šã‚’èª­ã¿è¾¼ã¿\n  useEffect(() => {\n    const savedSizeIndex = getCookie(\"stickerSizeIndex\")\n    if (savedSizeIndex !== undefined) {\n      setSizeIndex(Number.parseInt(savedSizeIndex, 10))\n    }\n  }, [])\n\n  // ã‚µã‚¤ã‚ºè¨­å®šã‚’ã‚¯ãƒƒã‚­ãƒ¼ã«ä¿å­˜\n  useEffect(() => {\n    setCookie(\"stickerSizeIndex\", sizeIndex.toString(), 365)\n  }, [sizeIndex])\n\n  const decreaseSize = () => {\n    setSizeIndex((prevIndex) => Math.max(prevIndex - 1, 0))\n  }\n\n  const increaseSize = () => {\n    setSizeIndex((prevIndex) => Math.min(prevIndex + 1, sizeOptions.length - 1))\n  }\n\n  // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã®ä¿å­˜\n  const saveScrollPosition = () => {\n    if (scrollAreaRef.current) {\n      const scrollElement = scrollAreaRef.current.querySelector(\n        \"[data-radix-scroll-area-viewport]\",\n      )\n      if (scrollElement) {\n        setSavedScrollPositions((prev) => ({\n          ...prev,\n          [createdSortStickerPage]: scrollElement.scrollTop,\n        }))\n      }\n    }\n  }\n\n  // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã®å¾©å…ƒ\n  const restoreScrollPosition = () => {\n    if (\n      scrollAreaRef.current &&\n      savedScrollPositions[createdSortStickerPage] !== undefined\n    ) {\n      const scrollElement = scrollAreaRef.current.querySelector(\n        \"[data-radix-scroll-area-viewport]\",\n      )\n      if (scrollElement) {\n        setTimeout(() => {\n          scrollElement.scrollTop = savedScrollPositions[createdSortStickerPage]\n        }, 50) // DOMã®æ›´æ–°ã‚’å¾…ã¤\n      }\n    }\n  }\n\n  // ãƒšãƒ¼ã‚¸å¤‰æ›´æ™‚ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã‚’ä¿å­˜\n  const handlePageChange = (page: number) => {\n    saveScrollPosition()\n    setCreatedSortStickerPage(page)\n  }\n\n  // ãƒšãƒ¼ã‚¸å¤‰æ›´å¾Œã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã‚’å¾©å…ƒ\n  useEffect(() => {\n    restoreScrollPosition()\n  }, [createdSortStickerPage, stickers])\n\n  // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒé–‰ã˜ã‚‰ã‚Œã‚‹æ™‚ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã‚’ãƒªã‚»ãƒƒãƒˆ\n  useEffect(() => {\n    if (!props.isOpen) {\n      setSavedScrollPositions({})\n    }\n  }, [props.isOpen])\n\n  const sizeMap = {\n    80: \"large\",\n    100: \"x-large\",\n    120: \"2x-large\",\n  } as const\n  const stickerSize = sizeMap[sizeOptions[sizeIndex]]\n\n  return (\n    <Dialog onOpenChange={props.onClose} open={props.isOpen}>\n      <DialogContent className=\"flex h-[80vh] min-h-[32vw] w-[80vw] min-w-[80vw] flex-col pl-2\">\n        <DialogHeader>\n          <DialogTitle>{t(\"ã‚¹ã‚¿ãƒ³ãƒ—\", \"Stickers\")}</DialogTitle>\n        </DialogHeader>\n        {props.isTargetUserBlocked && (\n          <div className=\"mb-4 rounded-md bg-gray-100 p-3 text-gray-600 text-sm dark:bg-gray-800 dark:text-gray-400\">\n            {t(\n              \"ãƒ–ãƒ­ãƒƒã‚¯ä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯ã‚¹ã‚¿ãƒ³ãƒ—ã‚’é€ä¿¡ã§ãã¾ã›ã‚“\",\n              \"Cannot send stickers to blocked users\",\n            )}\n          </div>\n        )}\n        <div className=\"flex items-center space-x-2\">\n          <Tabs value={type} defaultValue={\"CREATED\"}>\n            <TabsList>\n              <TabsTrigger\n                onClick={() => {\n                  setType(\"CREATED\")\n                }}\n                className=\"w-full\"\n                value=\"CREATED\"\n              >\n                {t(\"ä¿å­˜æ—¥\", \"Date saved\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => {\n                  setType(\"RELATED\")\n                }}\n                className=\"w-full\"\n                value=\"RELATED\"\n              >\n                {t(\"æœ€è¿‘ã®ä½¿ç”¨\", \"Recently used\")}\n              </TabsTrigger>\n            </TabsList>\n          </Tabs>\n          <div className=\"flex items-center space-x-2\">\n            <Button size=\"icon\" variant={\"secondary\"} onClick={increaseSize}>\n              <PlusIcon className=\"w-8\" />\n            </Button>\n            <Button size=\"icon\" variant={\"secondary\"} onClick={decreaseSize}>\n              <MinusIcon className=\"w-8\" />\n            </Button>\n          </div>\n        </div>\n        <ScrollArea\n          ref={scrollAreaRef}\n          className=\"flex h-[80vh] w-[80vw] flex-wrap overflow-y-auto\"\n        >\n          <div className=\"flex h-[80vh] w-[80vw] flex-wrap overflow-y-auto\">\n            <AddStickerButton\n              onAddedSicker={() => {\n                refetch()\n              }}\n            />\n            {stickers?.viewer?.userStickers?.map((sticker) => (\n              <StickerButton\n                key={sticker.id}\n                imageUrl={sticker.imageUrl ?? \"\"}\n                title={sticker.title}\n                onClick={() => {\n                  if (!props.isTargetUserBlocked) {\n                    props.onSend(sticker.id, sticker.imageUrl ?? \"\")\n                    props.onClose()\n                  }\n                }}\n                size={stickerSize}\n                disabled={props.isTargetUserBlocked}\n              />\n            ))}\n          </div>\n        </ScrollArea>\n        {type === \"CREATED\" && (\n          <div className=\"mt-1 mb-1\">\n            <ResponsivePagination\n              perPage={maxStickersPage}\n              maxCount={maxCount}\n              currentPage={createdSortStickerPage}\n              onPageChange={handlePageChange}\n              disableScrollToTop={true}\n            />\n          </div>\n        )}\n        <DialogFooter>\n          <Button\n            variant={\"secondary\"}\n            className=\"m-auto w-full\"\n            onClick={props.onClose}\n          >\n            {\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\"}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst viewerUserStickersCountQuery = graphql(\n  `query ViewerUserStickersCount($where: UserStickersWhereInput) {\n    viewer {\n      id\n      userStickersCount(where: $where)\n    }\n  }`,\n)\n\nconst viewerUserStickersQuery = graphql(\n  `query ViewerUserStickers($offset: Int!, $limit: Int!, $orderBy: StickerOrderBy, $where: UserStickersWhereInput) {\n    viewer {\n      id\n      userStickers(offset: $offset, limit: $limit, orderBy: $orderBy, where: $where) {\n        ...StickerButton\n      }\n    }\n  }`,\n  [StickerButtonFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/work/work-comment-input-fixed.tsx"},"span":[4975,5240],"sourceCode":"import { useContext, useState } from \"react\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport { Avatar, AvatarFallback, AvatarImage } from \"~/components/ui/avatar\"\nimport { Button } from \"~/components/ui/button\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { StickerDialog } from \"~/components/work/sticker-dialog\"\nimport { CrossPlatformTooltip } from \"~/components/cross-platform-tooltip\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { toast } from \"sonner\"\nimport { graphql } from \"gql.tada\"\nimport { useBoolean } from \"usehooks-ts\"\nimport { Loader2Icon, MessageCircle, StampIcon } from \"lucide-react\"\n\ntype Props = {\n  workId: string\n  isWorkOwnerBlocked?: boolean\n  commentsCount: number\n  onCommentAdded?: () => void\n}\n\n/**\n * å›ºå®šã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›æ¬„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ\n */\nexport function WorkCommentInputFixed (props: Props): React.ReactNode {\n  const authContext = useContext(AuthContext)\n  const { value: isOpen, setTrue: onOpen, setFalse: onClose } = useBoolean()\n  const t = useTranslation()\n\n  const [comment, setComment] = useState(\"\")\n  const [isSensitive, setIsSensitive] = useState(false)\n\n  const [createWorkComment, { loading: isCreatingWorkComment }] = useMutation(\n    createWorkCommentMutation,\n  )\n\n  const userResp = useQuery(userQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      userId: authContext.userId ?? \"0\",\n    },\n  })\n\n  const userIcon = userResp?.data?.user?.iconUrl\n\n  // ã‚³ãƒ¡ãƒ³ãƒˆé€ä¿¡å‡¦ç†\n  const sendComment = async (\n    text: string,\n    stickerId: string,\n    _stickerImageURL: string,\n  ) => {\n    try {\n      await createWorkComment({\n        variables: {\n          input: {\n            workId: props.workId,\n            text: text,\n            stickerId: stickerId,\n          },\n        },\n      })\n\n      setComment(\"\")\n      setIsSensitive(false)\n\n      // è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«é€šçŸ¥\n      if (props.onCommentAdded) {\n        props.onCommentAdded()\n      }\n    } catch (error) {\n      console.error(\"Failed to send comment:\", error)\n    }\n  }\n\n  const onComment = async () => {\n    const inputComment = comment.trim()\n\n    if (inputComment === \"\") {\n      toast(t(\"ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a comment\"))\n      return\n    }\n\n    sendComment(inputComment, \"\", \"\")\n  }\n\n  return (\n    <div className=\"border-t bg-background p-4\">\n      <div className=\"flex items-center space-x-2\">\n        <MessageCircle className=\"size-5\" />\n        <h3 className=\"font-semibold\">\n          {t(\"ã‚³ãƒ¡ãƒ³ãƒˆ\", \"Comments\")} ({props.commentsCount})\n        </h3>\n      </div>\n\n      {props.isWorkOwnerBlocked ? (\n        <div className=\"mt-3 rounded-md bg-gray-100 p-3 text-gray-600 text-sm dark:bg-gray-800 dark:text-gray-400\">\n          {t(\n            \"ãƒ–ãƒ­ãƒƒã‚¯ä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯ã‚³ãƒ¡ãƒ³ãƒˆã§ãã¾ã›ã‚“\",\n            \"Cannot comment to blocked users\",\n          )}\n        </div>\n      ) : (\n        <div className=\"mt-3 space-y-2\">\n          <div className=\"flex w-full items-start space-x-2 md:space-x-3\">\n            <Avatar className=\"flex-shrink-0\">\n              <AvatarImage src={withIconUrlFallback(userIcon)} alt=\"\" />\n              <AvatarFallback />\n            </Avatar>\n            <div className=\"min-w-0 flex-1\">\n              <AutoResizeTextarea\n                onChange={(event) => setComment(event.target.value)}\n                value={comment}\n                placeholder={t(\"ã‚³ãƒ¡ãƒ³ãƒˆã™ã‚‹\", \"Add a comment\")}\n                disabled={!authContext.isLoggedIn}\n                className=\"w-full\"\n              />\n            </div>\n            <div className=\"flex flex-col space-y-1 md:flex-row md:space-x-1 md:space-y-0\">\n              <Button\n                disabled={!authContext.isLoggedIn}\n                variant=\"secondary\"\n                size=\"icon\"\n                onClick={onOpen}\n                className=\"h-8 w-8 md:h-10 md:w-10\"\n              >\n                <StampIcon className=\"size-4\" />\n              </Button>\n              {isCreatingWorkComment ? (\n                <Button\n                  disabled\n                  className=\"h-8 px-2 text-xs md:h-10 md:px-4 md:text-sm\"\n                >\n                  <Loader2Icon className=\"size-4 animate-spin\" />\n                </Button>\n              ) : (\n                <Button\n                  disabled={!authContext.isLoggedIn}\n                  onClick={onComment}\n                  className=\"h-8 px-2 text-xs md:h-10 md:px-4 md:text-sm\"\n                >\n                  {t(\"é€ä¿¡\", \"Send\")}\n                </Button>\n              )}\n            </div>\n          </div>\n          <div className=\"flex items-center space-x-2 pl-10 text-muted-foreground text-xs md:pl-14\">\n            <Checkbox\n              id=\"sensitive-checkbox\"\n              checked={isSensitive}\n              onCheckedChange={(checked: boolean) =>\n                setIsSensitive(checked === true)\n              }\n              disabled={!authContext.isLoggedIn}\n            />\n            <label htmlFor=\"sensitive-checkbox\">\n              {t(\"éš ã—ä»˜ã\", \"Sensitive comment\")}\n            </label>\n            <CrossPlatformTooltip\n              text={t(\n                \"åˆæœŸè¡¨ç¤ºã¯éè¡¨ç¤ºã«ãªã‚Šã¾ã™ã€‚ã‚¯ãƒªãƒƒã‚¯ã§è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚\",\n                \"Initially hidden from view. Click to display.\",\n              )}\n            />\n          </div>\n        </div>\n      )}\n\n      {/* ã‚¹ã‚¿ãƒ³ãƒ—ãƒ€ã‚¤ã‚¢ãƒ­ã‚° */}\n      <StickerDialog\n        isOpen={isOpen}\n        onClose={onClose}\n        onSend={async (stickerId: string, url: string) => {\n          await sendComment(comment, stickerId, url)\n        }}\n        isTargetUserBlocked={props.isWorkOwnerBlocked}\n      />\n    </div>\n  )\n}\n\nconst createWorkCommentMutation = graphql(\n  `mutation CreateWorkComment($input: CreateWorkCommentInput!) {\n    createWorkComment(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst userQuery = graphql(\n  `query User($userId: ID!) {\n    user(id: $userId) {\n      id\n      iconUrl\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/work/work-comment-input.tsx"},"span":[4122,4407],"sourceCode":"import { Avatar, AvatarFallback, AvatarImage } from \"~/components/ui/avatar\"\nimport { Button } from \"~/components/ui/button\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport { Loader2Icon } from \"lucide-react\"\nimport { useState, useContext } from \"react\"\nimport { StampIcon } from \"lucide-react\"\nimport { graphql } from \"gql.tada\"\nimport { CrossPlatformTooltip } from \"~/components/cross-platform-tooltip\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { toast } from \"sonner\"\nimport { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { useBoolean } from \"usehooks-ts\"\nimport { StickerDialog } from \"~/components/work/sticker-dialog\"\n\ntype Props = {\n  targetCommentId: string\n  onReplyCompleted: (\n    id: string,\n    text: string,\n    stickerId: string,\n    stickerImageURL: string,\n  ) => void\n  isWorkOwnerBlocked?: boolean\n}\n\n/**\n * è¿”ä¿¡ã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›æ¬„ï¼ˆä½œå“ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ç”¨ï¼‰\n */\nexport function WorkCommentInput (props: Props): React.ReactNode {\n  const authContext = useContext(AuthContext)\n  const { value: isOpen, setTrue: onOpen, setFalse: onClose } = useBoolean()\n  const t = useTranslation()\n\n  const [comment, setComment] = useState(\"\")\n  const [isSensitive, setIsSensitive] = useState(false)\n\n  const [createResponseComment, { loading: isCreatingReplyComment }] =\n    useMutation(createResponseCommentMutation)\n\n  const sendComment = async (\n    text: string,\n    targetCommentId: string,\n    stickerId: string,\n    stickerImageURL: string,\n  ) => {\n    try {\n      const commentRes = await createResponseComment({\n        variables: {\n          input: {\n            commentId: targetCommentId,\n            text: text,\n            stickerId: stickerId,\n          },\n        },\n      })\n\n      setComment(\"\")\n      setIsSensitive(false)\n\n      if (props.onReplyCompleted && commentRes.data?.createResponseComment) {\n        props.onReplyCompleted(\n          commentRes.data?.createResponseComment.id ?? \"\",\n          comment,\n          stickerId ?? \"\",\n          stickerImageURL ?? \"\",\n        )\n      }\n    } catch (_e) {\n      // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°\n    }\n  }\n\n  const onComment = async () => {\n    const inputComment = comment.trim()\n\n    if (inputComment === \"\") {\n      toast(t(\"ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a comment\"))\n      return\n    }\n\n    sendComment(inputComment, props.targetCommentId, \"\", \"\")\n  }\n\n  const { data = null } = useQuery(viewerUserQuery, {\n    skip: authContext.isLoading,\n  })\n\n  const iconUrl = data?.viewer?.user?.iconUrl ?? \"\"\n\n  return (\n    <>\n      <div className=\"space-y-2 pl-16\">\n        <div className=\"flex w-full items-center space-x-4\">\n          <Avatar>\n            <AvatarImage src={withIconUrlFallback(iconUrl)} alt=\"\" />\n            <AvatarFallback />\n          </Avatar>\n          <AutoResizeTextarea\n            onChange={(event) => {\n              setComment(event.target.value)\n            }}\n            placeholder={t(\"ã‚³ãƒ¡ãƒ³ãƒˆã™ã‚‹\", \"Add a comment\")}\n            disabled={!authContext.isLoggedIn || props.isWorkOwnerBlocked}\n          />\n          <div>\n            <Button\n              disabled={!authContext.isLoggedIn || props.isWorkOwnerBlocked}\n              variant={\"secondary\"}\n              size={\"icon\"}\n              onClick={onOpen}\n            >\n              <StampIcon className=\"w-16\" />\n            </Button>\n          </div>\n          {isCreatingReplyComment ? (\n            <Button onClick={() => {}}>\n              <Loader2Icon className={\"w-16 animate-spin\"} />\n            </Button>\n          ) : (\n            <Button\n              disabled={!authContext.isLoggedIn || props.isWorkOwnerBlocked}\n              variant={\"secondary\"}\n              onClick={onComment}\n            >\n              {t(\"é€ä¿¡\", \"Send\")}\n            </Button>\n          )}\n        </div>\n        <div className=\"flex items-center space-x-2 pl-14 opacity-80\">\n          <Checkbox\n            id=\"reply-sensitive-checkbox\"\n            checked={isSensitive}\n            onCheckedChange={(checked: boolean) =>\n              setIsSensitive(checked === true)\n            }\n            disabled={!authContext.isLoggedIn || props.isWorkOwnerBlocked}\n          />\n          <div className=\"flex items-center space-x-2\">\n            <label htmlFor=\"reply-sensitive-checkbox\" className=\"text-xs\">\n              {t(\"éš ã—ä»˜ã\", \"Sensitive comment\")}\n            </label>\n            <CrossPlatformTooltip\n              text={t(\n                \"åˆæœŸè¡¨ç¤ºã¯éè¡¨ç¤ºã«ãªã‚Šã¾ã™ã€‚ã‚¯ãƒªãƒƒã‚¯ã§è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚\",\n                \"You can check new works with this tag in your timeline\",\n              )}\n            />\n          </div>\n        </div>\n      </div>\n      <StickerDialog\n        isOpen={isOpen}\n        onClose={onClose}\n        onSend={async (stickerId: string, stickerImageURL: string) => {\n          await sendComment(\n            comment,\n            props.targetCommentId,\n            stickerId,\n            stickerImageURL,\n          )\n\n          setComment(\"\")\n          onClose()\n        }}\n        isTargetUserBlocked={props.isWorkOwnerBlocked}\n      />\n    </>\n  )\n}\n\nconst createResponseCommentMutation = graphql(\n  `mutation CreateResponseComment($input: CreateResponseCommentInput!) {\n    createResponseComment(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst viewerUserQuery = graphql(\n  `query ViewerUser {\n    viewer {\n      id\n      user {\n        id\n        iconUrl\n      }\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable isCreatingCommentLike is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"isCreatingCommentLike"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/work/work-comment-section-final.tsx"},"span":[3523,3544],"sourceCode":"import { Avatar, AvatarFallback, AvatarImage } from \"~/components/ui/avatar\"\nimport { Button } from \"~/components/ui/button\"\nimport { Card, CardContent, CardHeader } from \"~/components/ui/card\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { WorkCommentInput } from \"~/components/work/work-comment-input\"\nimport { StickerDialog } from \"~/components/work/sticker-dialog\"\nimport { StickerInfoDialog } from \"~/components/work/sticker-info-dialog\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport {\n  MessageCircle,\n  Heart,\n  ThumbsUp,\n  Reply,\n  Loader2Icon,\n  Eye,\n  EyeOff,\n  ArrowDownToLine,\n  StampIcon,\n} from \"lucide-react\"\nimport { useState, useContext, useRef } from \"react\"\nimport { Link } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { CrossPlatformTooltip } from \"~/components/cross-platform-tooltip\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { toDateTimeText } from \"~/utils/to-date-time-text\"\nimport { toast } from \"sonner\"\nimport { cn } from \"~/lib/utils\"\nimport { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { useBoolean } from \"usehooks-ts\"\n\ntype Comment = {\n  id: string\n  user?: {\n    id: string\n    name: string\n    iconUrl?: string | null\n  }\n  text?: string | null\n  createdAt: number\n  likesCount: number\n  isLiked: boolean\n  isWorkOwnerLiked: boolean\n  isMuted?: boolean\n  isSensitive?: boolean\n  sticker?: {\n    id: string\n    title: string\n    imageUrl?: string | null\n    accessType: string\n    isDownloaded?: boolean\n  }\n  responses?: Array<{\n    id: string\n    user?: {\n      id: string\n      name: string\n      iconUrl?: string | null\n    }\n    text?: string | null\n    createdAt: number\n    likesCount: number\n    isLiked: boolean\n    isWorkOwnerLiked: boolean\n    isMuted?: boolean\n    isSensitive?: boolean\n    sticker?: {\n      id: string\n      title: string\n      imageUrl?: string | null\n      accessType: string\n      isDownloaded?: boolean\n    }\n  }>\n}\n\ntype Props = {\n  workId: string\n  comments: Comment[]\n  workOwnerIconImageURL?: string | null\n  isWorkOwnerBlocked?: boolean\n  isFixedInput?: boolean\n}\n\n/**\n * ä½œå“ã‚³ãƒ¡ãƒ³ãƒˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆæ‹¡å¼µç‰ˆ - è¿”ä¿¡æ©Ÿèƒ½ã¨ã‚¹ã‚¿ãƒ³ãƒ—ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯¾å¿œï¼‰\n */\nexport function WorkCommentSectionEnhanced (props: Props): React.ReactNode {\n  const authContext = useContext(AuthContext)\n  const { value: isOpen, setTrue: onOpen, setFalse: onClose } = useBoolean()\n  const t = useTranslation()\n\n  const [comment, setComment] = useState(\"\")\n  const [isSensitive, setIsSensitive] = useState(false)\n  const [likedCommentIds, setLikedCommentIds] = useState<string[]>([])\n  const [canceledCommentIds, setCanceledCommentIds] = useState<string[]>([])\n  const [showSensitiveIds, setShowSensitiveIds] = useState<string[]>([])\n  const [showMutedIds, setShowMutedIds] = useState<string[]>([])\n  const [openReplyIds, setOpenReplyIds] = useState<string[]>([])\n  const [newComments, setNewComments] = useState<Comment[]>([])\n  const [newReplies, setNewReplies] = useState<\n    Array<NonNullable<Comment[\"responses\"]>[number] & { parentId: string }>\n  >([])\n\n  const scrollAreaRef = useRef<HTMLDivElement>(null)\n\n  const [createWorkComment, { loading: isCreatingWorkComment }] = useMutation(\n    createWorkCommentMutation,\n  )\n\n  const [createCommentLike, { loading: isCreatingCommentLike }] = useMutation(\n    createCommentLikeMutation,\n  )\n\n  const [deleteCommentLike, { loading: isDeletingCommentLike }] = useMutation(\n    deleteCommentLikeMutation,\n  )\n\n  const userResp = useQuery(userQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      userId: authContext.userId ?? \"0\",\n    },\n  })\n\n  const userIcon = userResp?.data?.user?.iconUrl\n\n  // æ–°ã—ã„ã‚³ãƒ¡ãƒ³ãƒˆã®é€ä¿¡\n  const sendComment = async (\n    text: string,\n    stickerId: string,\n    stickerImageURL: string,\n  ) => {\n    try {\n      const res = await createWorkComment({\n        variables: {\n          input: {\n            workId: props.workId,\n            text: text,\n            stickerId: stickerId,\n          },\n        },\n      })\n\n      setComment(\"\")\n      setIsSensitive(false)\n\n      if (res.data?.createWorkComment) {\n        const newComment: Comment = {\n          id: res.data.createWorkComment.id,\n          text: text,\n          createdAt: Date.now() / 1000,\n          likesCount: 0,\n          isLiked: false,\n          isWorkOwnerLiked: false,\n          user: {\n            id: authContext.userId ?? \"\",\n            name: authContext.displayName ?? \"\",\n            iconUrl: userIcon,\n          },\n          sticker: stickerId\n            ? {\n                id: stickerId,\n                title: \"\",\n                imageUrl: stickerImageURL,\n                accessType: \"PUBLIC\",\n                isDownloaded: true,\n              }\n            : undefined,\n          responses: [],\n        }\n\n        setNewComments([...newComments, newComment])\n      }\n    } catch (error) {\n      // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°\n      console.error(\"Failed to send comment:\", error)\n    }\n  }\n\n  // ã‚³ãƒ¡ãƒ³ãƒˆã‚’é€ä¿¡\n  const onComment = async () => {\n    const inputComment = comment.trim()\n\n    if (inputComment === \"\") {\n      toast(t(\"ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a comment\"))\n      return\n    }\n\n    sendComment(inputComment, \"\", \"\")\n  }\n\n  // ã„ã„ã­æ©Ÿèƒ½\n  const onCreateCommentLike = async (commentId: string) => {\n    try {\n      await createCommentLike({\n        variables: {\n          input: {\n            commentId: commentId,\n          },\n        },\n      })\n      setLikedCommentIds([...likedCommentIds, commentId])\n      setCanceledCommentIds(canceledCommentIds.filter((id) => id !== commentId))\n    } catch (_e) {\n      // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°\n    }\n  }\n\n  const onDeleteCommentLike = async (commentId: string) => {\n    try {\n      await deleteCommentLike({\n        variables: {\n          input: {\n            commentId: commentId,\n          },\n        },\n      })\n      setLikedCommentIds(likedCommentIds.filter((id) => id !== commentId))\n      setCanceledCommentIds([...canceledCommentIds, commentId])\n    } catch (_e) {\n      // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°\n    }\n  }\n\n  // è¿”ä¿¡ã®åˆ‡ã‚Šæ›¿ãˆ\n  const toggleReply = (commentId: string) => {\n    if (openReplyIds.includes(commentId)) {\n      setOpenReplyIds(openReplyIds.filter((id) => id !== commentId))\n    } else {\n      setOpenReplyIds([...openReplyIds, commentId])\n    }\n  }\n\n  // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ã‚³ãƒ¡ãƒ³ãƒˆè¡¨ç¤ºã®åˆ‡ã‚Šæ›¿ãˆ\n  const toggleSensitiveComment = (commentId: string) => {\n    if (showSensitiveIds.includes(commentId)) {\n      setShowSensitiveIds(showSensitiveIds.filter((id) => id !== commentId))\n    } else {\n      setShowSensitiveIds([...showSensitiveIds, commentId])\n    }\n  }\n\n  // ãƒŸãƒ¥ãƒ¼ãƒˆã‚³ãƒ¡ãƒ³ãƒˆè¡¨ç¤ºã®åˆ‡ã‚Šæ›¿ãˆ\n  const toggleMutedComment = (commentId: string) => {\n    if (showMutedIds.includes(commentId)) {\n      setShowMutedIds(showMutedIds.filter((id) => id !== commentId))\n    } else {\n      setShowMutedIds([...showMutedIds, commentId])\n    }\n  }\n\n  // è¿”ä¿¡å®Œäº†ã®ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°\n  const onReplyCompleted = (\n    parentId: string,\n    id: string,\n    text: string,\n    stickerId: string,\n    stickerImageURL: string,\n  ) => {\n    const newReply = {\n      id,\n      text,\n      createdAt: Date.now() / 1000,\n      likesCount: 0,\n      isLiked: false,\n      isWorkOwnerLiked: false,\n      user: {\n        id: authContext.userId ?? \"\",\n        name: authContext.displayName ?? \"\",\n        iconUrl: userIcon,\n      },\n      sticker: stickerId\n        ? {\n            id: stickerId,\n            title: \"\",\n            imageUrl: stickerImageURL,\n            accessType: \"PUBLIC\",\n            isDownloaded: true,\n          }\n        : undefined,\n      parentId,\n    }\n\n    setNewReplies([...newReplies, newReply])\n    setOpenReplyIds(openReplyIds.filter((id) => id !== parentId))\n  }\n\n  // ã‚³ãƒ¡ãƒ³ãƒˆã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°\n  const renderComment = (comment: Comment, isReply = false) => {\n    const isLiked = comment.isLiked && !canceledCommentIds.includes(comment.id)\n    const isNowLiked = likedCommentIds.includes(comment.id)\n    const actualLikesCount =\n      comment.likesCount +\n      (isNowLiked ? 1 : 0) -\n      (canceledCommentIds.includes(comment.id) ? 1 : 0)\n\n    // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ã‚³ãƒ¡ãƒ³ãƒˆã®å‡¦ç†\n    if (comment.isSensitive && !showSensitiveIds.includes(comment.id)) {\n      return (\n        <div\n          key={comment.id}\n          className={cn(\n            \"flex items-center space-x-4 rounded-lg border p-3\",\n            isReply && \"ml-8\",\n          )}\n        >\n          <EyeOff className=\"size-5 text-gray-400\" />\n          <div className=\"flex-1\">\n            <p className=\"text-sm\">\n              {t(\n                \"éš ã—ä»˜ãï¼ˆã‚‚ã—ãã¯ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ï¼‰ãªã‚³ãƒ¡ãƒ³ãƒˆã§ã™\",\n                \"This is a sensitive comment\",\n              )}\n            </p>\n          </div>\n          <Button\n            variant=\"secondary\"\n            size=\"sm\"\n            onClick={() => toggleSensitiveComment(comment.id)}\n          >\n            <Eye className=\"mr-2 size-4\" />\n            {t(\"è¡¨ç¤º\", \"Show\")}\n          </Button>\n        </div>\n      )\n    }\n\n    // ãƒŸãƒ¥ãƒ¼ãƒˆã‚³ãƒ¡ãƒ³ãƒˆã®å‡¦ç†\n    if (comment.isMuted && !showMutedIds.includes(comment.id)) {\n      return (\n        <div\n          key={comment.id}\n          className={cn(\n            \"flex items-center space-x-4 rounded-lg border p-3\",\n            isReply && \"ml-8\",\n          )}\n        >\n          <EyeOff className=\"size-5 text-gray-400\" />\n          <div className=\"flex-1\">\n            <p className=\"text-sm\">\n              {t(\n                \"ãƒŸãƒ¥ãƒ¼ãƒˆã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ã®ã‚³ãƒ¡ãƒ³ãƒˆã§ã™\",\n                \"This is a comment from a muted user\",\n              )}\n            </p>\n          </div>\n          <Button\n            variant=\"secondary\"\n            size=\"sm\"\n            onClick={() => toggleMutedComment(comment.id)}\n          >\n            <Eye className=\"mr-2 size-4\" />\n            {t(\"è¡¨ç¤º\", \"Show\")}\n          </Button>\n        </div>\n      )\n    }\n\n    return (\n      <div\n        key={comment.id}\n        className={cn(\n          \"group rounded-lg border bg-background p-4 transition-all hover:shadow-md\",\n          isReply && \"ml-8 border-l-4 border-l-blue-200\",\n        )}\n      >\n        <div className=\"flex items-start space-x-3\">\n          <Link to={`/users/${comment.user?.id}`}>\n            <Avatar className=\"size-10\">\n              <AvatarImage\n                src={withIconUrlFallback(comment.user?.iconUrl)}\n                alt=\"\"\n              />\n              <AvatarFallback />\n            </Avatar>\n          </Link>\n\n          <div className=\"flex-1 space-y-2\">\n            <div className=\"flex items-center space-x-2\">\n              <Link\n                to={`/users/${comment.user?.id}`}\n                className=\"font-medium hover:underline\"\n              >\n                {comment.user?.name}\n              </Link>\n              <span className=\"text-muted-foreground text-xs\">\n                {toDateTimeText(comment.createdAt, true)}\n              </span>\n              {comment.isWorkOwnerLiked && (\n                <div className=\"relative\">\n                  <Avatar className=\"size-4\">\n                    <AvatarImage\n                      src={withIconUrlFallback(props.workOwnerIconImageURL)}\n                      alt=\"\"\n                    />\n                    <AvatarFallback />\n                  </Avatar>\n                  <Heart className=\"-right-1 -bottom-1 absolute size-3 fill-rose-500 text-rose-500\" />\n                </div>\n              )}\n            </div>\n\n            {comment.text && (\n              <p className=\"whitespace-pre-wrap break-words text-sm\">\n                {comment.text}\n              </p>\n            )}\n\n            {comment.sticker?.imageUrl && (\n              <div className=\"inline-block\">\n                {comment.sticker.accessType === \"PUBLIC\" ? (\n                  <StickerInfoDialog\n                    isDownloaded={comment.sticker.isDownloaded ?? false}\n                    stickerId={comment.sticker.id}\n                    title={comment.sticker.title}\n                    imageUrl={comment.sticker.imageUrl}\n                  >\n                    <img\n                      className=\"w-32 cursor-pointer transition-transform hover:scale-105\"\n                      src={comment.sticker.imageUrl}\n                      alt={comment.sticker.title}\n                    />\n                  </StickerInfoDialog>\n                ) : (\n                  <img\n                    className=\"w-32\"\n                    src={comment.sticker.imageUrl}\n                    alt={comment.sticker.title}\n                  />\n                )}\n              </div>\n            )}\n\n            <div className=\"flex items-center space-x-4 pt-2\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={\n                  isLiked || isNowLiked\n                    ? () => onDeleteCommentLike(comment.id)\n                    : () => onCreateCommentLike(comment.id)\n                }\n                disabled={!authContext.isLoggedIn}\n                className=\"flex items-center space-x-1 text-xs\"\n              >\n                <ThumbsUp\n                  className={cn(\n                    \"size-4\",\n                    (isLiked || isNowLiked) && \"fill-blue-500 text-blue-500\",\n                  )}\n                />\n                {actualLikesCount > 0 && <span>{actualLikesCount}</span>}\n              </Button>\n\n              {!isReply && !props.isWorkOwnerBlocked && (\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={() => toggleReply(comment.id)}\n                  className=\"flex items-center space-x-1 text-xs\"\n                >\n                  <Reply className=\"size-4\" />\n                  <span>{t(\"è¿”ä¿¡\", \"Reply\")}</span>\n                </Button>\n              )}\n\n              {comment.sticker?.imageUrl &&\n                comment.sticker.accessType === \"PUBLIC\" && (\n                  <StickerInfoDialog\n                    isDownloaded={comment.sticker.isDownloaded ?? false}\n                    stickerId={comment.sticker.id}\n                    title={comment.sticker.title}\n                    imageUrl={comment.sticker.imageUrl}\n                  >\n                    <Button variant=\"ghost\" size=\"sm\" className=\"text-xs\">\n                      <ArrowDownToLine className=\"size-4\" />\n                    </Button>\n                  </StickerInfoDialog>\n                )}\n            </div>\n          </div>\n        </div>\n\n        {/* è¿”ä¿¡å…¥åŠ›æ¬„ */}\n        {openReplyIds.includes(comment.id) && (\n          <div className=\"mt-4\">\n            <WorkCommentInput\n              targetCommentId={comment.id}\n              onReplyCompleted={(id, text, stickerId, stickerImageURL) =>\n                onReplyCompleted(\n                  comment.id,\n                  id,\n                  text,\n                  stickerId,\n                  stickerImageURL,\n                )\n              }\n              isWorkOwnerBlocked={props.isWorkOwnerBlocked}\n            />\n          </div>\n        )}\n\n        {/* è¿”ä¿¡ã®è¡¨ç¤º */}\n        {comment.responses && comment.responses.length > 0 && (\n          <div className=\"mt-4 space-y-3\">\n            {comment.responses.map((reply) => renderComment(reply, true))}\n          </div>\n        )}\n\n        {/* æ–°ã—ã„è¿”ä¿¡ã®è¡¨ç¤º */}\n        {newReplies\n          .filter((reply) => reply.parentId === comment.id)\n          .map((reply) => renderComment(reply, true))}\n      </div>\n    )\n  }\n\n  const allComments = [...props.comments, ...newComments]\n\n  return (\n    <Card className=\"w-full\">\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-2\">\n            <MessageCircle className=\"size-5\" />\n            <h3 className=\"font-semibold\">\n              {t(\"ã‚³ãƒ¡ãƒ³ãƒˆ\", \"Comments\")} ({allComments.length})\n            </h3>\n          </div>\n        </div>\n      </CardHeader>\n\n      <CardContent className=\"space-y-4\">\n        {props.isWorkOwnerBlocked && (\n          <div className=\"rounded-md bg-gray-100 p-3 text-gray-600 text-sm dark:bg-gray-800 dark:text-gray-400\">\n            {t(\n              \"ãƒ–ãƒ­ãƒƒã‚¯ä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯ã‚³ãƒ¡ãƒ³ãƒˆã§ãã¾ã›ã‚“\",\n              \"Cannot comment to blocked users\",\n            )}\n          </div>\n        )}\n\n        {/* ã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›æ¬„ */}\n        {!props.isWorkOwnerBlocked && !props.isFixedInput && (\n          <div className=\"space-y-2\">\n            <div className=\"flex w-full items-center space-x-3\">\n              <Avatar>\n                <AvatarImage src={withIconUrlFallback(userIcon)} alt=\"\" />\n                <AvatarFallback />\n              </Avatar>\n              <AutoResizeTextarea\n                onChange={(event) => setComment(event.target.value)}\n                value={comment}\n                placeholder={t(\"ã‚³ãƒ¡ãƒ³ãƒˆã™ã‚‹\", \"Add a comment\")}\n                disabled={!authContext.isLoggedIn}\n                className=\"flex-1\"\n              />\n              <Button\n                disabled={!authContext.isLoggedIn}\n                variant=\"secondary\"\n                size=\"icon\"\n                onClick={onOpen}\n              >\n                <StampIcon className=\"size-4\" />\n              </Button>\n              {isCreatingWorkComment ? (\n                <Button disabled>\n                  <Loader2Icon className=\"size-4 animate-spin\" />\n                </Button>\n              ) : (\n                <Button disabled={!authContext.isLoggedIn} onClick={onComment}>\n                  {t(\"é€ä¿¡\", \"Send\")}\n                </Button>\n              )}\n            </div>\n            <div className=\"flex items-center space-x-2 pl-14 text-muted-foreground text-xs\">\n              <Checkbox\n                id=\"sensitive-checkbox\"\n                checked={isSensitive}\n                onCheckedChange={(checked: boolean) =>\n                  setIsSensitive(checked === true)\n                }\n                disabled={!authContext.isLoggedIn}\n              />\n              <label htmlFor=\"sensitive-checkbox\">\n                {t(\"éš ã—ä»˜ã\", \"Sensitive comment\")}\n              </label>\n              <CrossPlatformTooltip\n                text={t(\n                  \"åˆæœŸè¡¨ç¤ºã¯éè¡¨ç¤ºã«ãªã‚Šã¾ã™ã€‚ã‚¯ãƒªãƒƒã‚¯ã§è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚\",\n                  \"Initially hidden from view. Click to display.\",\n                )}\n              />\n            </div>\n          </div>\n        )}\n\n        {/* ã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§ */}\n        <ScrollArea className=\"max-h-96 overflow-auto\" ref={scrollAreaRef}>\n          <div className=\"space-y-4\">\n            {allComments.length === 0 ? (\n              <div className=\"py-8 text-center text-muted-foreground\">\n                <MessageCircle className=\"mx-auto mb-2 size-12 opacity-50\" />\n                <p>{t(\"ã¾ã ã‚³ãƒ¡ãƒ³ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“\", \"No comments yet\")}</p>\n                <p className=\"text-xs\">\n                  {t(\n                    \"æœ€åˆã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’æŠ•ç¨¿ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼\",\n                    \"Be the first to comment!\",\n                  )}\n                </p>\n              </div>\n            ) : (\n              allComments.map((comment) => renderComment(comment))\n            )}\n          </div>\n        </ScrollArea>\n      </CardContent>\n\n      {/* ã‚¹ã‚¿ãƒ³ãƒ—ãƒ€ã‚¤ã‚¢ãƒ­ã‚° */}\n      <StickerDialog\n        isOpen={isOpen}\n        onClose={onClose}\n        onSend={async (stickerId: string, url: string) => {\n          await sendComment(comment, stickerId, url)\n        }}\n        isTargetUserBlocked={props.isWorkOwnerBlocked}\n      />\n    </Card>\n  )\n}\n\nconst createWorkCommentMutation = graphql(\n  `mutation CreateWorkComment($input: CreateWorkCommentInput!) {\n    createWorkComment(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst createCommentLikeMutation = graphql(\n  `mutation CreateCommentLike($input: CreateCommentLikeInput!) {\n    createCommentLike(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst deleteCommentLikeMutation = graphql(\n  `mutation DeleteCommentLike($input: DeleteCommentLikeInput!) {\n    deleteCommentLike(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst userQuery = graphql(\n  `query User($userId: ID!) {\n    user(id: $userId) {\n      id\n      iconUrl\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable isDeletingCommentLike is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"isDeletingCommentLike"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/work/work-comment-section-final.tsx"},"span":[3638,3659],"sourceCode":"import { Avatar, AvatarFallback, AvatarImage } from \"~/components/ui/avatar\"\nimport { Button } from \"~/components/ui/button\"\nimport { Card, CardContent, CardHeader } from \"~/components/ui/card\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { WorkCommentInput } from \"~/components/work/work-comment-input\"\nimport { StickerDialog } from \"~/components/work/sticker-dialog\"\nimport { StickerInfoDialog } from \"~/components/work/sticker-info-dialog\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport {\n  MessageCircle,\n  Heart,\n  ThumbsUp,\n  Reply,\n  Loader2Icon,\n  Eye,\n  EyeOff,\n  ArrowDownToLine,\n  StampIcon,\n} from \"lucide-react\"\nimport { useState, useContext, useRef } from \"react\"\nimport { Link } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { CrossPlatformTooltip } from \"~/components/cross-platform-tooltip\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { toDateTimeText } from \"~/utils/to-date-time-text\"\nimport { toast } from \"sonner\"\nimport { cn } from \"~/lib/utils\"\nimport { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { useBoolean } from \"usehooks-ts\"\n\ntype Comment = {\n  id: string\n  user?: {\n    id: string\n    name: string\n    iconUrl?: string | null\n  }\n  text?: string | null\n  createdAt: number\n  likesCount: number\n  isLiked: boolean\n  isWorkOwnerLiked: boolean\n  isMuted?: boolean\n  isSensitive?: boolean\n  sticker?: {\n    id: string\n    title: string\n    imageUrl?: string | null\n    accessType: string\n    isDownloaded?: boolean\n  }\n  responses?: Array<{\n    id: string\n    user?: {\n      id: string\n      name: string\n      iconUrl?: string | null\n    }\n    text?: string | null\n    createdAt: number\n    likesCount: number\n    isLiked: boolean\n    isWorkOwnerLiked: boolean\n    isMuted?: boolean\n    isSensitive?: boolean\n    sticker?: {\n      id: string\n      title: string\n      imageUrl?: string | null\n      accessType: string\n      isDownloaded?: boolean\n    }\n  }>\n}\n\ntype Props = {\n  workId: string\n  comments: Comment[]\n  workOwnerIconImageURL?: string | null\n  isWorkOwnerBlocked?: boolean\n  isFixedInput?: boolean\n}\n\n/**\n * ä½œå“ã‚³ãƒ¡ãƒ³ãƒˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆæ‹¡å¼µç‰ˆ - è¿”ä¿¡æ©Ÿèƒ½ã¨ã‚¹ã‚¿ãƒ³ãƒ—ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯¾å¿œï¼‰\n */\nexport function WorkCommentSectionEnhanced (props: Props): React.ReactNode {\n  const authContext = useContext(AuthContext)\n  const { value: isOpen, setTrue: onOpen, setFalse: onClose } = useBoolean()\n  const t = useTranslation()\n\n  const [comment, setComment] = useState(\"\")\n  const [isSensitive, setIsSensitive] = useState(false)\n  const [likedCommentIds, setLikedCommentIds] = useState<string[]>([])\n  const [canceledCommentIds, setCanceledCommentIds] = useState<string[]>([])\n  const [showSensitiveIds, setShowSensitiveIds] = useState<string[]>([])\n  const [showMutedIds, setShowMutedIds] = useState<string[]>([])\n  const [openReplyIds, setOpenReplyIds] = useState<string[]>([])\n  const [newComments, setNewComments] = useState<Comment[]>([])\n  const [newReplies, setNewReplies] = useState<\n    Array<NonNullable<Comment[\"responses\"]>[number] & { parentId: string }>\n  >([])\n\n  const scrollAreaRef = useRef<HTMLDivElement>(null)\n\n  const [createWorkComment, { loading: isCreatingWorkComment }] = useMutation(\n    createWorkCommentMutation,\n  )\n\n  const [createCommentLike, { loading: isCreatingCommentLike }] = useMutation(\n    createCommentLikeMutation,\n  )\n\n  const [deleteCommentLike, { loading: isDeletingCommentLike }] = useMutation(\n    deleteCommentLikeMutation,\n  )\n\n  const userResp = useQuery(userQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      userId: authContext.userId ?? \"0\",\n    },\n  })\n\n  const userIcon = userResp?.data?.user?.iconUrl\n\n  // æ–°ã—ã„ã‚³ãƒ¡ãƒ³ãƒˆã®é€ä¿¡\n  const sendComment = async (\n    text: string,\n    stickerId: string,\n    stickerImageURL: string,\n  ) => {\n    try {\n      const res = await createWorkComment({\n        variables: {\n          input: {\n            workId: props.workId,\n            text: text,\n            stickerId: stickerId,\n          },\n        },\n      })\n\n      setComment(\"\")\n      setIsSensitive(false)\n\n      if (res.data?.createWorkComment) {\n        const newComment: Comment = {\n          id: res.data.createWorkComment.id,\n          text: text,\n          createdAt: Date.now() / 1000,\n          likesCount: 0,\n          isLiked: false,\n          isWorkOwnerLiked: false,\n          user: {\n            id: authContext.userId ?? \"\",\n            name: authContext.displayName ?? \"\",\n            iconUrl: userIcon,\n          },\n          sticker: stickerId\n            ? {\n                id: stickerId,\n                title: \"\",\n                imageUrl: stickerImageURL,\n                accessType: \"PUBLIC\",\n                isDownloaded: true,\n              }\n            : undefined,\n          responses: [],\n        }\n\n        setNewComments([...newComments, newComment])\n      }\n    } catch (error) {\n      // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°\n      console.error(\"Failed to send comment:\", error)\n    }\n  }\n\n  // ã‚³ãƒ¡ãƒ³ãƒˆã‚’é€ä¿¡\n  const onComment = async () => {\n    const inputComment = comment.trim()\n\n    if (inputComment === \"\") {\n      toast(t(\"ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a comment\"))\n      return\n    }\n\n    sendComment(inputComment, \"\", \"\")\n  }\n\n  // ã„ã„ã­æ©Ÿèƒ½\n  const onCreateCommentLike = async (commentId: string) => {\n    try {\n      await createCommentLike({\n        variables: {\n          input: {\n            commentId: commentId,\n          },\n        },\n      })\n      setLikedCommentIds([...likedCommentIds, commentId])\n      setCanceledCommentIds(canceledCommentIds.filter((id) => id !== commentId))\n    } catch (_e) {\n      // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°\n    }\n  }\n\n  const onDeleteCommentLike = async (commentId: string) => {\n    try {\n      await deleteCommentLike({\n        variables: {\n          input: {\n            commentId: commentId,\n          },\n        },\n      })\n      setLikedCommentIds(likedCommentIds.filter((id) => id !== commentId))\n      setCanceledCommentIds([...canceledCommentIds, commentId])\n    } catch (_e) {\n      // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°\n    }\n  }\n\n  // è¿”ä¿¡ã®åˆ‡ã‚Šæ›¿ãˆ\n  const toggleReply = (commentId: string) => {\n    if (openReplyIds.includes(commentId)) {\n      setOpenReplyIds(openReplyIds.filter((id) => id !== commentId))\n    } else {\n      setOpenReplyIds([...openReplyIds, commentId])\n    }\n  }\n\n  // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ã‚³ãƒ¡ãƒ³ãƒˆè¡¨ç¤ºã®åˆ‡ã‚Šæ›¿ãˆ\n  const toggleSensitiveComment = (commentId: string) => {\n    if (showSensitiveIds.includes(commentId)) {\n      setShowSensitiveIds(showSensitiveIds.filter((id) => id !== commentId))\n    } else {\n      setShowSensitiveIds([...showSensitiveIds, commentId])\n    }\n  }\n\n  // ãƒŸãƒ¥ãƒ¼ãƒˆã‚³ãƒ¡ãƒ³ãƒˆè¡¨ç¤ºã®åˆ‡ã‚Šæ›¿ãˆ\n  const toggleMutedComment = (commentId: string) => {\n    if (showMutedIds.includes(commentId)) {\n      setShowMutedIds(showMutedIds.filter((id) => id !== commentId))\n    } else {\n      setShowMutedIds([...showMutedIds, commentId])\n    }\n  }\n\n  // è¿”ä¿¡å®Œäº†ã®ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°\n  const onReplyCompleted = (\n    parentId: string,\n    id: string,\n    text: string,\n    stickerId: string,\n    stickerImageURL: string,\n  ) => {\n    const newReply = {\n      id,\n      text,\n      createdAt: Date.now() / 1000,\n      likesCount: 0,\n      isLiked: false,\n      isWorkOwnerLiked: false,\n      user: {\n        id: authContext.userId ?? \"\",\n        name: authContext.displayName ?? \"\",\n        iconUrl: userIcon,\n      },\n      sticker: stickerId\n        ? {\n            id: stickerId,\n            title: \"\",\n            imageUrl: stickerImageURL,\n            accessType: \"PUBLIC\",\n            isDownloaded: true,\n          }\n        : undefined,\n      parentId,\n    }\n\n    setNewReplies([...newReplies, newReply])\n    setOpenReplyIds(openReplyIds.filter((id) => id !== parentId))\n  }\n\n  // ã‚³ãƒ¡ãƒ³ãƒˆã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°\n  const renderComment = (comment: Comment, isReply = false) => {\n    const isLiked = comment.isLiked && !canceledCommentIds.includes(comment.id)\n    const isNowLiked = likedCommentIds.includes(comment.id)\n    const actualLikesCount =\n      comment.likesCount +\n      (isNowLiked ? 1 : 0) -\n      (canceledCommentIds.includes(comment.id) ? 1 : 0)\n\n    // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ã‚³ãƒ¡ãƒ³ãƒˆã®å‡¦ç†\n    if (comment.isSensitive && !showSensitiveIds.includes(comment.id)) {\n      return (\n        <div\n          key={comment.id}\n          className={cn(\n            \"flex items-center space-x-4 rounded-lg border p-3\",\n            isReply && \"ml-8\",\n          )}\n        >\n          <EyeOff className=\"size-5 text-gray-400\" />\n          <div className=\"flex-1\">\n            <p className=\"text-sm\">\n              {t(\n                \"éš ã—ä»˜ãï¼ˆã‚‚ã—ãã¯ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ï¼‰ãªã‚³ãƒ¡ãƒ³ãƒˆã§ã™\",\n                \"This is a sensitive comment\",\n              )}\n            </p>\n          </div>\n          <Button\n            variant=\"secondary\"\n            size=\"sm\"\n            onClick={() => toggleSensitiveComment(comment.id)}\n          >\n            <Eye className=\"mr-2 size-4\" />\n            {t(\"è¡¨ç¤º\", \"Show\")}\n          </Button>\n        </div>\n      )\n    }\n\n    // ãƒŸãƒ¥ãƒ¼ãƒˆã‚³ãƒ¡ãƒ³ãƒˆã®å‡¦ç†\n    if (comment.isMuted && !showMutedIds.includes(comment.id)) {\n      return (\n        <div\n          key={comment.id}\n          className={cn(\n            \"flex items-center space-x-4 rounded-lg border p-3\",\n            isReply && \"ml-8\",\n          )}\n        >\n          <EyeOff className=\"size-5 text-gray-400\" />\n          <div className=\"flex-1\">\n            <p className=\"text-sm\">\n              {t(\n                \"ãƒŸãƒ¥ãƒ¼ãƒˆã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ã®ã‚³ãƒ¡ãƒ³ãƒˆã§ã™\",\n                \"This is a comment from a muted user\",\n              )}\n            </p>\n          </div>\n          <Button\n            variant=\"secondary\"\n            size=\"sm\"\n            onClick={() => toggleMutedComment(comment.id)}\n          >\n            <Eye className=\"mr-2 size-4\" />\n            {t(\"è¡¨ç¤º\", \"Show\")}\n          </Button>\n        </div>\n      )\n    }\n\n    return (\n      <div\n        key={comment.id}\n        className={cn(\n          \"group rounded-lg border bg-background p-4 transition-all hover:shadow-md\",\n          isReply && \"ml-8 border-l-4 border-l-blue-200\",\n        )}\n      >\n        <div className=\"flex items-start space-x-3\">\n          <Link to={`/users/${comment.user?.id}`}>\n            <Avatar className=\"size-10\">\n              <AvatarImage\n                src={withIconUrlFallback(comment.user?.iconUrl)}\n                alt=\"\"\n              />\n              <AvatarFallback />\n            </Avatar>\n          </Link>\n\n          <div className=\"flex-1 space-y-2\">\n            <div className=\"flex items-center space-x-2\">\n              <Link\n                to={`/users/${comment.user?.id}`}\n                className=\"font-medium hover:underline\"\n              >\n                {comment.user?.name}\n              </Link>\n              <span className=\"text-muted-foreground text-xs\">\n                {toDateTimeText(comment.createdAt, true)}\n              </span>\n              {comment.isWorkOwnerLiked && (\n                <div className=\"relative\">\n                  <Avatar className=\"size-4\">\n                    <AvatarImage\n                      src={withIconUrlFallback(props.workOwnerIconImageURL)}\n                      alt=\"\"\n                    />\n                    <AvatarFallback />\n                  </Avatar>\n                  <Heart className=\"-right-1 -bottom-1 absolute size-3 fill-rose-500 text-rose-500\" />\n                </div>\n              )}\n            </div>\n\n            {comment.text && (\n              <p className=\"whitespace-pre-wrap break-words text-sm\">\n                {comment.text}\n              </p>\n            )}\n\n            {comment.sticker?.imageUrl && (\n              <div className=\"inline-block\">\n                {comment.sticker.accessType === \"PUBLIC\" ? (\n                  <StickerInfoDialog\n                    isDownloaded={comment.sticker.isDownloaded ?? false}\n                    stickerId={comment.sticker.id}\n                    title={comment.sticker.title}\n                    imageUrl={comment.sticker.imageUrl}\n                  >\n                    <img\n                      className=\"w-32 cursor-pointer transition-transform hover:scale-105\"\n                      src={comment.sticker.imageUrl}\n                      alt={comment.sticker.title}\n                    />\n                  </StickerInfoDialog>\n                ) : (\n                  <img\n                    className=\"w-32\"\n                    src={comment.sticker.imageUrl}\n                    alt={comment.sticker.title}\n                  />\n                )}\n              </div>\n            )}\n\n            <div className=\"flex items-center space-x-4 pt-2\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={\n                  isLiked || isNowLiked\n                    ? () => onDeleteCommentLike(comment.id)\n                    : () => onCreateCommentLike(comment.id)\n                }\n                disabled={!authContext.isLoggedIn}\n                className=\"flex items-center space-x-1 text-xs\"\n              >\n                <ThumbsUp\n                  className={cn(\n                    \"size-4\",\n                    (isLiked || isNowLiked) && \"fill-blue-500 text-blue-500\",\n                  )}\n                />\n                {actualLikesCount > 0 && <span>{actualLikesCount}</span>}\n              </Button>\n\n              {!isReply && !props.isWorkOwnerBlocked && (\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={() => toggleReply(comment.id)}\n                  className=\"flex items-center space-x-1 text-xs\"\n                >\n                  <Reply className=\"size-4\" />\n                  <span>{t(\"è¿”ä¿¡\", \"Reply\")}</span>\n                </Button>\n              )}\n\n              {comment.sticker?.imageUrl &&\n                comment.sticker.accessType === \"PUBLIC\" && (\n                  <StickerInfoDialog\n                    isDownloaded={comment.sticker.isDownloaded ?? false}\n                    stickerId={comment.sticker.id}\n                    title={comment.sticker.title}\n                    imageUrl={comment.sticker.imageUrl}\n                  >\n                    <Button variant=\"ghost\" size=\"sm\" className=\"text-xs\">\n                      <ArrowDownToLine className=\"size-4\" />\n                    </Button>\n                  </StickerInfoDialog>\n                )}\n            </div>\n          </div>\n        </div>\n\n        {/* è¿”ä¿¡å…¥åŠ›æ¬„ */}\n        {openReplyIds.includes(comment.id) && (\n          <div className=\"mt-4\">\n            <WorkCommentInput\n              targetCommentId={comment.id}\n              onReplyCompleted={(id, text, stickerId, stickerImageURL) =>\n                onReplyCompleted(\n                  comment.id,\n                  id,\n                  text,\n                  stickerId,\n                  stickerImageURL,\n                )\n              }\n              isWorkOwnerBlocked={props.isWorkOwnerBlocked}\n            />\n          </div>\n        )}\n\n        {/* è¿”ä¿¡ã®è¡¨ç¤º */}\n        {comment.responses && comment.responses.length > 0 && (\n          <div className=\"mt-4 space-y-3\">\n            {comment.responses.map((reply) => renderComment(reply, true))}\n          </div>\n        )}\n\n        {/* æ–°ã—ã„è¿”ä¿¡ã®è¡¨ç¤º */}\n        {newReplies\n          .filter((reply) => reply.parentId === comment.id)\n          .map((reply) => renderComment(reply, true))}\n      </div>\n    )\n  }\n\n  const allComments = [...props.comments, ...newComments]\n\n  return (\n    <Card className=\"w-full\">\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-2\">\n            <MessageCircle className=\"size-5\" />\n            <h3 className=\"font-semibold\">\n              {t(\"ã‚³ãƒ¡ãƒ³ãƒˆ\", \"Comments\")} ({allComments.length})\n            </h3>\n          </div>\n        </div>\n      </CardHeader>\n\n      <CardContent className=\"space-y-4\">\n        {props.isWorkOwnerBlocked && (\n          <div className=\"rounded-md bg-gray-100 p-3 text-gray-600 text-sm dark:bg-gray-800 dark:text-gray-400\">\n            {t(\n              \"ãƒ–ãƒ­ãƒƒã‚¯ä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯ã‚³ãƒ¡ãƒ³ãƒˆã§ãã¾ã›ã‚“\",\n              \"Cannot comment to blocked users\",\n            )}\n          </div>\n        )}\n\n        {/* ã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›æ¬„ */}\n        {!props.isWorkOwnerBlocked && !props.isFixedInput && (\n          <div className=\"space-y-2\">\n            <div className=\"flex w-full items-center space-x-3\">\n              <Avatar>\n                <AvatarImage src={withIconUrlFallback(userIcon)} alt=\"\" />\n                <AvatarFallback />\n              </Avatar>\n              <AutoResizeTextarea\n                onChange={(event) => setComment(event.target.value)}\n                value={comment}\n                placeholder={t(\"ã‚³ãƒ¡ãƒ³ãƒˆã™ã‚‹\", \"Add a comment\")}\n                disabled={!authContext.isLoggedIn}\n                className=\"flex-1\"\n              />\n              <Button\n                disabled={!authContext.isLoggedIn}\n                variant=\"secondary\"\n                size=\"icon\"\n                onClick={onOpen}\n              >\n                <StampIcon className=\"size-4\" />\n              </Button>\n              {isCreatingWorkComment ? (\n                <Button disabled>\n                  <Loader2Icon className=\"size-4 animate-spin\" />\n                </Button>\n              ) : (\n                <Button disabled={!authContext.isLoggedIn} onClick={onComment}>\n                  {t(\"é€ä¿¡\", \"Send\")}\n                </Button>\n              )}\n            </div>\n            <div className=\"flex items-center space-x-2 pl-14 text-muted-foreground text-xs\">\n              <Checkbox\n                id=\"sensitive-checkbox\"\n                checked={isSensitive}\n                onCheckedChange={(checked: boolean) =>\n                  setIsSensitive(checked === true)\n                }\n                disabled={!authContext.isLoggedIn}\n              />\n              <label htmlFor=\"sensitive-checkbox\">\n                {t(\"éš ã—ä»˜ã\", \"Sensitive comment\")}\n              </label>\n              <CrossPlatformTooltip\n                text={t(\n                  \"åˆæœŸè¡¨ç¤ºã¯éè¡¨ç¤ºã«ãªã‚Šã¾ã™ã€‚ã‚¯ãƒªãƒƒã‚¯ã§è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚\",\n                  \"Initially hidden from view. Click to display.\",\n                )}\n              />\n            </div>\n          </div>\n        )}\n\n        {/* ã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§ */}\n        <ScrollArea className=\"max-h-96 overflow-auto\" ref={scrollAreaRef}>\n          <div className=\"space-y-4\">\n            {allComments.length === 0 ? (\n              <div className=\"py-8 text-center text-muted-foreground\">\n                <MessageCircle className=\"mx-auto mb-2 size-12 opacity-50\" />\n                <p>{t(\"ã¾ã ã‚³ãƒ¡ãƒ³ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“\", \"No comments yet\")}</p>\n                <p className=\"text-xs\">\n                  {t(\n                    \"æœ€åˆã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’æŠ•ç¨¿ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼\",\n                    \"Be the first to comment!\",\n                  )}\n                </p>\n              </div>\n            ) : (\n              allComments.map((comment) => renderComment(comment))\n            )}\n          </div>\n        </ScrollArea>\n      </CardContent>\n\n      {/* ã‚¹ã‚¿ãƒ³ãƒ—ãƒ€ã‚¤ã‚¢ãƒ­ã‚° */}\n      <StickerDialog\n        isOpen={isOpen}\n        onClose={onClose}\n        onSend={async (stickerId: string, url: string) => {\n          await sendComment(comment, stickerId, url)\n        }}\n        isTargetUserBlocked={props.isWorkOwnerBlocked}\n      />\n    </Card>\n  )\n}\n\nconst createWorkCommentMutation = graphql(\n  `mutation CreateWorkComment($input: CreateWorkCommentInput!) {\n    createWorkComment(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst createCommentLikeMutation = graphql(\n  `mutation CreateCommentLike($input: CreateCommentLikeInput!) {\n    createCommentLike(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst deleteCommentLikeMutation = graphql(\n  `mutation DeleteCommentLike($input: DeleteCommentLikeInput!) {\n    deleteCommentLike(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst userQuery = graphql(\n  `query User($userId: ID!) {\n    user(id: $userId) {\n      id\n      iconUrl\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/work/work-comment-section-final.tsx"},"span":[18194,18473],"sourceCode":"import { Avatar, AvatarFallback, AvatarImage } from \"~/components/ui/avatar\"\nimport { Button } from \"~/components/ui/button\"\nimport { Card, CardContent, CardHeader } from \"~/components/ui/card\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { WorkCommentInput } from \"~/components/work/work-comment-input\"\nimport { StickerDialog } from \"~/components/work/sticker-dialog\"\nimport { StickerInfoDialog } from \"~/components/work/sticker-info-dialog\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport {\n  MessageCircle,\n  Heart,\n  ThumbsUp,\n  Reply,\n  Loader2Icon,\n  Eye,\n  EyeOff,\n  ArrowDownToLine,\n  StampIcon,\n} from \"lucide-react\"\nimport { useState, useContext, useRef } from \"react\"\nimport { Link } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { CrossPlatformTooltip } from \"~/components/cross-platform-tooltip\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { toDateTimeText } from \"~/utils/to-date-time-text\"\nimport { toast } from \"sonner\"\nimport { cn } from \"~/lib/utils\"\nimport { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { useBoolean } from \"usehooks-ts\"\n\ntype Comment = {\n  id: string\n  user?: {\n    id: string\n    name: string\n    iconUrl?: string | null\n  }\n  text?: string | null\n  createdAt: number\n  likesCount: number\n  isLiked: boolean\n  isWorkOwnerLiked: boolean\n  isMuted?: boolean\n  isSensitive?: boolean\n  sticker?: {\n    id: string\n    title: string\n    imageUrl?: string | null\n    accessType: string\n    isDownloaded?: boolean\n  }\n  responses?: Array<{\n    id: string\n    user?: {\n      id: string\n      name: string\n      iconUrl?: string | null\n    }\n    text?: string | null\n    createdAt: number\n    likesCount: number\n    isLiked: boolean\n    isWorkOwnerLiked: boolean\n    isMuted?: boolean\n    isSensitive?: boolean\n    sticker?: {\n      id: string\n      title: string\n      imageUrl?: string | null\n      accessType: string\n      isDownloaded?: boolean\n    }\n  }>\n}\n\ntype Props = {\n  workId: string\n  comments: Comment[]\n  workOwnerIconImageURL?: string | null\n  isWorkOwnerBlocked?: boolean\n  isFixedInput?: boolean\n}\n\n/**\n * ä½œå“ã‚³ãƒ¡ãƒ³ãƒˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆæ‹¡å¼µç‰ˆ - è¿”ä¿¡æ©Ÿèƒ½ã¨ã‚¹ã‚¿ãƒ³ãƒ—ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯¾å¿œï¼‰\n */\nexport function WorkCommentSectionEnhanced (props: Props): React.ReactNode {\n  const authContext = useContext(AuthContext)\n  const { value: isOpen, setTrue: onOpen, setFalse: onClose } = useBoolean()\n  const t = useTranslation()\n\n  const [comment, setComment] = useState(\"\")\n  const [isSensitive, setIsSensitive] = useState(false)\n  const [likedCommentIds, setLikedCommentIds] = useState<string[]>([])\n  const [canceledCommentIds, setCanceledCommentIds] = useState<string[]>([])\n  const [showSensitiveIds, setShowSensitiveIds] = useState<string[]>([])\n  const [showMutedIds, setShowMutedIds] = useState<string[]>([])\n  const [openReplyIds, setOpenReplyIds] = useState<string[]>([])\n  const [newComments, setNewComments] = useState<Comment[]>([])\n  const [newReplies, setNewReplies] = useState<\n    Array<NonNullable<Comment[\"responses\"]>[number] & { parentId: string }>\n  >([])\n\n  const scrollAreaRef = useRef<HTMLDivElement>(null)\n\n  const [createWorkComment, { loading: isCreatingWorkComment }] = useMutation(\n    createWorkCommentMutation,\n  )\n\n  const [createCommentLike, { loading: isCreatingCommentLike }] = useMutation(\n    createCommentLikeMutation,\n  )\n\n  const [deleteCommentLike, { loading: isDeletingCommentLike }] = useMutation(\n    deleteCommentLikeMutation,\n  )\n\n  const userResp = useQuery(userQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      userId: authContext.userId ?? \"0\",\n    },\n  })\n\n  const userIcon = userResp?.data?.user?.iconUrl\n\n  // æ–°ã—ã„ã‚³ãƒ¡ãƒ³ãƒˆã®é€ä¿¡\n  const sendComment = async (\n    text: string,\n    stickerId: string,\n    stickerImageURL: string,\n  ) => {\n    try {\n      const res = await createWorkComment({\n        variables: {\n          input: {\n            workId: props.workId,\n            text: text,\n            stickerId: stickerId,\n          },\n        },\n      })\n\n      setComment(\"\")\n      setIsSensitive(false)\n\n      if (res.data?.createWorkComment) {\n        const newComment: Comment = {\n          id: res.data.createWorkComment.id,\n          text: text,\n          createdAt: Date.now() / 1000,\n          likesCount: 0,\n          isLiked: false,\n          isWorkOwnerLiked: false,\n          user: {\n            id: authContext.userId ?? \"\",\n            name: authContext.displayName ?? \"\",\n            iconUrl: userIcon,\n          },\n          sticker: stickerId\n            ? {\n                id: stickerId,\n                title: \"\",\n                imageUrl: stickerImageURL,\n                accessType: \"PUBLIC\",\n                isDownloaded: true,\n              }\n            : undefined,\n          responses: [],\n        }\n\n        setNewComments([...newComments, newComment])\n      }\n    } catch (error) {\n      // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°\n      console.error(\"Failed to send comment:\", error)\n    }\n  }\n\n  // ã‚³ãƒ¡ãƒ³ãƒˆã‚’é€ä¿¡\n  const onComment = async () => {\n    const inputComment = comment.trim()\n\n    if (inputComment === \"\") {\n      toast(t(\"ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a comment\"))\n      return\n    }\n\n    sendComment(inputComment, \"\", \"\")\n  }\n\n  // ã„ã„ã­æ©Ÿèƒ½\n  const onCreateCommentLike = async (commentId: string) => {\n    try {\n      await createCommentLike({\n        variables: {\n          input: {\n            commentId: commentId,\n          },\n        },\n      })\n      setLikedCommentIds([...likedCommentIds, commentId])\n      setCanceledCommentIds(canceledCommentIds.filter((id) => id !== commentId))\n    } catch (_e) {\n      // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°\n    }\n  }\n\n  const onDeleteCommentLike = async (commentId: string) => {\n    try {\n      await deleteCommentLike({\n        variables: {\n          input: {\n            commentId: commentId,\n          },\n        },\n      })\n      setLikedCommentIds(likedCommentIds.filter((id) => id !== commentId))\n      setCanceledCommentIds([...canceledCommentIds, commentId])\n    } catch (_e) {\n      // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°\n    }\n  }\n\n  // è¿”ä¿¡ã®åˆ‡ã‚Šæ›¿ãˆ\n  const toggleReply = (commentId: string) => {\n    if (openReplyIds.includes(commentId)) {\n      setOpenReplyIds(openReplyIds.filter((id) => id !== commentId))\n    } else {\n      setOpenReplyIds([...openReplyIds, commentId])\n    }\n  }\n\n  // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ã‚³ãƒ¡ãƒ³ãƒˆè¡¨ç¤ºã®åˆ‡ã‚Šæ›¿ãˆ\n  const toggleSensitiveComment = (commentId: string) => {\n    if (showSensitiveIds.includes(commentId)) {\n      setShowSensitiveIds(showSensitiveIds.filter((id) => id !== commentId))\n    } else {\n      setShowSensitiveIds([...showSensitiveIds, commentId])\n    }\n  }\n\n  // ãƒŸãƒ¥ãƒ¼ãƒˆã‚³ãƒ¡ãƒ³ãƒˆè¡¨ç¤ºã®åˆ‡ã‚Šæ›¿ãˆ\n  const toggleMutedComment = (commentId: string) => {\n    if (showMutedIds.includes(commentId)) {\n      setShowMutedIds(showMutedIds.filter((id) => id !== commentId))\n    } else {\n      setShowMutedIds([...showMutedIds, commentId])\n    }\n  }\n\n  // è¿”ä¿¡å®Œäº†ã®ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°\n  const onReplyCompleted = (\n    parentId: string,\n    id: string,\n    text: string,\n    stickerId: string,\n    stickerImageURL: string,\n  ) => {\n    const newReply = {\n      id,\n      text,\n      createdAt: Date.now() / 1000,\n      likesCount: 0,\n      isLiked: false,\n      isWorkOwnerLiked: false,\n      user: {\n        id: authContext.userId ?? \"\",\n        name: authContext.displayName ?? \"\",\n        iconUrl: userIcon,\n      },\n      sticker: stickerId\n        ? {\n            id: stickerId,\n            title: \"\",\n            imageUrl: stickerImageURL,\n            accessType: \"PUBLIC\",\n            isDownloaded: true,\n          }\n        : undefined,\n      parentId,\n    }\n\n    setNewReplies([...newReplies, newReply])\n    setOpenReplyIds(openReplyIds.filter((id) => id !== parentId))\n  }\n\n  // ã‚³ãƒ¡ãƒ³ãƒˆã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°\n  const renderComment = (comment: Comment, isReply = false) => {\n    const isLiked = comment.isLiked && !canceledCommentIds.includes(comment.id)\n    const isNowLiked = likedCommentIds.includes(comment.id)\n    const actualLikesCount =\n      comment.likesCount +\n      (isNowLiked ? 1 : 0) -\n      (canceledCommentIds.includes(comment.id) ? 1 : 0)\n\n    // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ã‚³ãƒ¡ãƒ³ãƒˆã®å‡¦ç†\n    if (comment.isSensitive && !showSensitiveIds.includes(comment.id)) {\n      return (\n        <div\n          key={comment.id}\n          className={cn(\n            \"flex items-center space-x-4 rounded-lg border p-3\",\n            isReply && \"ml-8\",\n          )}\n        >\n          <EyeOff className=\"size-5 text-gray-400\" />\n          <div className=\"flex-1\">\n            <p className=\"text-sm\">\n              {t(\n                \"éš ã—ä»˜ãï¼ˆã‚‚ã—ãã¯ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ï¼‰ãªã‚³ãƒ¡ãƒ³ãƒˆã§ã™\",\n                \"This is a sensitive comment\",\n              )}\n            </p>\n          </div>\n          <Button\n            variant=\"secondary\"\n            size=\"sm\"\n            onClick={() => toggleSensitiveComment(comment.id)}\n          >\n            <Eye className=\"mr-2 size-4\" />\n            {t(\"è¡¨ç¤º\", \"Show\")}\n          </Button>\n        </div>\n      )\n    }\n\n    // ãƒŸãƒ¥ãƒ¼ãƒˆã‚³ãƒ¡ãƒ³ãƒˆã®å‡¦ç†\n    if (comment.isMuted && !showMutedIds.includes(comment.id)) {\n      return (\n        <div\n          key={comment.id}\n          className={cn(\n            \"flex items-center space-x-4 rounded-lg border p-3\",\n            isReply && \"ml-8\",\n          )}\n        >\n          <EyeOff className=\"size-5 text-gray-400\" />\n          <div className=\"flex-1\">\n            <p className=\"text-sm\">\n              {t(\n                \"ãƒŸãƒ¥ãƒ¼ãƒˆã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ã®ã‚³ãƒ¡ãƒ³ãƒˆã§ã™\",\n                \"This is a comment from a muted user\",\n              )}\n            </p>\n          </div>\n          <Button\n            variant=\"secondary\"\n            size=\"sm\"\n            onClick={() => toggleMutedComment(comment.id)}\n          >\n            <Eye className=\"mr-2 size-4\" />\n            {t(\"è¡¨ç¤º\", \"Show\")}\n          </Button>\n        </div>\n      )\n    }\n\n    return (\n      <div\n        key={comment.id}\n        className={cn(\n          \"group rounded-lg border bg-background p-4 transition-all hover:shadow-md\",\n          isReply && \"ml-8 border-l-4 border-l-blue-200\",\n        )}\n      >\n        <div className=\"flex items-start space-x-3\">\n          <Link to={`/users/${comment.user?.id}`}>\n            <Avatar className=\"size-10\">\n              <AvatarImage\n                src={withIconUrlFallback(comment.user?.iconUrl)}\n                alt=\"\"\n              />\n              <AvatarFallback />\n            </Avatar>\n          </Link>\n\n          <div className=\"flex-1 space-y-2\">\n            <div className=\"flex items-center space-x-2\">\n              <Link\n                to={`/users/${comment.user?.id}`}\n                className=\"font-medium hover:underline\"\n              >\n                {comment.user?.name}\n              </Link>\n              <span className=\"text-muted-foreground text-xs\">\n                {toDateTimeText(comment.createdAt, true)}\n              </span>\n              {comment.isWorkOwnerLiked && (\n                <div className=\"relative\">\n                  <Avatar className=\"size-4\">\n                    <AvatarImage\n                      src={withIconUrlFallback(props.workOwnerIconImageURL)}\n                      alt=\"\"\n                    />\n                    <AvatarFallback />\n                  </Avatar>\n                  <Heart className=\"-right-1 -bottom-1 absolute size-3 fill-rose-500 text-rose-500\" />\n                </div>\n              )}\n            </div>\n\n            {comment.text && (\n              <p className=\"whitespace-pre-wrap break-words text-sm\">\n                {comment.text}\n              </p>\n            )}\n\n            {comment.sticker?.imageUrl && (\n              <div className=\"inline-block\">\n                {comment.sticker.accessType === \"PUBLIC\" ? (\n                  <StickerInfoDialog\n                    isDownloaded={comment.sticker.isDownloaded ?? false}\n                    stickerId={comment.sticker.id}\n                    title={comment.sticker.title}\n                    imageUrl={comment.sticker.imageUrl}\n                  >\n                    <img\n                      className=\"w-32 cursor-pointer transition-transform hover:scale-105\"\n                      src={comment.sticker.imageUrl}\n                      alt={comment.sticker.title}\n                    />\n                  </StickerInfoDialog>\n                ) : (\n                  <img\n                    className=\"w-32\"\n                    src={comment.sticker.imageUrl}\n                    alt={comment.sticker.title}\n                  />\n                )}\n              </div>\n            )}\n\n            <div className=\"flex items-center space-x-4 pt-2\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={\n                  isLiked || isNowLiked\n                    ? () => onDeleteCommentLike(comment.id)\n                    : () => onCreateCommentLike(comment.id)\n                }\n                disabled={!authContext.isLoggedIn}\n                className=\"flex items-center space-x-1 text-xs\"\n              >\n                <ThumbsUp\n                  className={cn(\n                    \"size-4\",\n                    (isLiked || isNowLiked) && \"fill-blue-500 text-blue-500\",\n                  )}\n                />\n                {actualLikesCount > 0 && <span>{actualLikesCount}</span>}\n              </Button>\n\n              {!isReply && !props.isWorkOwnerBlocked && (\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={() => toggleReply(comment.id)}\n                  className=\"flex items-center space-x-1 text-xs\"\n                >\n                  <Reply className=\"size-4\" />\n                  <span>{t(\"è¿”ä¿¡\", \"Reply\")}</span>\n                </Button>\n              )}\n\n              {comment.sticker?.imageUrl &&\n                comment.sticker.accessType === \"PUBLIC\" && (\n                  <StickerInfoDialog\n                    isDownloaded={comment.sticker.isDownloaded ?? false}\n                    stickerId={comment.sticker.id}\n                    title={comment.sticker.title}\n                    imageUrl={comment.sticker.imageUrl}\n                  >\n                    <Button variant=\"ghost\" size=\"sm\" className=\"text-xs\">\n                      <ArrowDownToLine className=\"size-4\" />\n                    </Button>\n                  </StickerInfoDialog>\n                )}\n            </div>\n          </div>\n        </div>\n\n        {/* è¿”ä¿¡å…¥åŠ›æ¬„ */}\n        {openReplyIds.includes(comment.id) && (\n          <div className=\"mt-4\">\n            <WorkCommentInput\n              targetCommentId={comment.id}\n              onReplyCompleted={(id, text, stickerId, stickerImageURL) =>\n                onReplyCompleted(\n                  comment.id,\n                  id,\n                  text,\n                  stickerId,\n                  stickerImageURL,\n                )\n              }\n              isWorkOwnerBlocked={props.isWorkOwnerBlocked}\n            />\n          </div>\n        )}\n\n        {/* è¿”ä¿¡ã®è¡¨ç¤º */}\n        {comment.responses && comment.responses.length > 0 && (\n          <div className=\"mt-4 space-y-3\">\n            {comment.responses.map((reply) => renderComment(reply, true))}\n          </div>\n        )}\n\n        {/* æ–°ã—ã„è¿”ä¿¡ã®è¡¨ç¤º */}\n        {newReplies\n          .filter((reply) => reply.parentId === comment.id)\n          .map((reply) => renderComment(reply, true))}\n      </div>\n    )\n  }\n\n  const allComments = [...props.comments, ...newComments]\n\n  return (\n    <Card className=\"w-full\">\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-2\">\n            <MessageCircle className=\"size-5\" />\n            <h3 className=\"font-semibold\">\n              {t(\"ã‚³ãƒ¡ãƒ³ãƒˆ\", \"Comments\")} ({allComments.length})\n            </h3>\n          </div>\n        </div>\n      </CardHeader>\n\n      <CardContent className=\"space-y-4\">\n        {props.isWorkOwnerBlocked && (\n          <div className=\"rounded-md bg-gray-100 p-3 text-gray-600 text-sm dark:bg-gray-800 dark:text-gray-400\">\n            {t(\n              \"ãƒ–ãƒ­ãƒƒã‚¯ä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯ã‚³ãƒ¡ãƒ³ãƒˆã§ãã¾ã›ã‚“\",\n              \"Cannot comment to blocked users\",\n            )}\n          </div>\n        )}\n\n        {/* ã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›æ¬„ */}\n        {!props.isWorkOwnerBlocked && !props.isFixedInput && (\n          <div className=\"space-y-2\">\n            <div className=\"flex w-full items-center space-x-3\">\n              <Avatar>\n                <AvatarImage src={withIconUrlFallback(userIcon)} alt=\"\" />\n                <AvatarFallback />\n              </Avatar>\n              <AutoResizeTextarea\n                onChange={(event) => setComment(event.target.value)}\n                value={comment}\n                placeholder={t(\"ã‚³ãƒ¡ãƒ³ãƒˆã™ã‚‹\", \"Add a comment\")}\n                disabled={!authContext.isLoggedIn}\n                className=\"flex-1\"\n              />\n              <Button\n                disabled={!authContext.isLoggedIn}\n                variant=\"secondary\"\n                size=\"icon\"\n                onClick={onOpen}\n              >\n                <StampIcon className=\"size-4\" />\n              </Button>\n              {isCreatingWorkComment ? (\n                <Button disabled>\n                  <Loader2Icon className=\"size-4 animate-spin\" />\n                </Button>\n              ) : (\n                <Button disabled={!authContext.isLoggedIn} onClick={onComment}>\n                  {t(\"é€ä¿¡\", \"Send\")}\n                </Button>\n              )}\n            </div>\n            <div className=\"flex items-center space-x-2 pl-14 text-muted-foreground text-xs\">\n              <Checkbox\n                id=\"sensitive-checkbox\"\n                checked={isSensitive}\n                onCheckedChange={(checked: boolean) =>\n                  setIsSensitive(checked === true)\n                }\n                disabled={!authContext.isLoggedIn}\n              />\n              <label htmlFor=\"sensitive-checkbox\">\n                {t(\"éš ã—ä»˜ã\", \"Sensitive comment\")}\n              </label>\n              <CrossPlatformTooltip\n                text={t(\n                  \"åˆæœŸè¡¨ç¤ºã¯éè¡¨ç¤ºã«ãªã‚Šã¾ã™ã€‚ã‚¯ãƒªãƒƒã‚¯ã§è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚\",\n                  \"Initially hidden from view. Click to display.\",\n                )}\n              />\n            </div>\n          </div>\n        )}\n\n        {/* ã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§ */}\n        <ScrollArea className=\"max-h-96 overflow-auto\" ref={scrollAreaRef}>\n          <div className=\"space-y-4\">\n            {allComments.length === 0 ? (\n              <div className=\"py-8 text-center text-muted-foreground\">\n                <MessageCircle className=\"mx-auto mb-2 size-12 opacity-50\" />\n                <p>{t(\"ã¾ã ã‚³ãƒ¡ãƒ³ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“\", \"No comments yet\")}</p>\n                <p className=\"text-xs\">\n                  {t(\n                    \"æœ€åˆã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’æŠ•ç¨¿ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼\",\n                    \"Be the first to comment!\",\n                  )}\n                </p>\n              </div>\n            ) : (\n              allComments.map((comment) => renderComment(comment))\n            )}\n          </div>\n        </ScrollArea>\n      </CardContent>\n\n      {/* ã‚¹ã‚¿ãƒ³ãƒ—ãƒ€ã‚¤ã‚¢ãƒ­ã‚° */}\n      <StickerDialog\n        isOpen={isOpen}\n        onClose={onClose}\n        onSend={async (stickerId: string, url: string) => {\n          await sendComment(comment, stickerId, url)\n        }}\n        isTargetUserBlocked={props.isWorkOwnerBlocked}\n      />\n    </Card>\n  )\n}\n\nconst createWorkCommentMutation = graphql(\n  `mutation CreateWorkComment($input: CreateWorkCommentInput!) {\n    createWorkComment(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst createCommentLikeMutation = graphql(\n  `mutation CreateCommentLike($input: CreateCommentLikeInput!) {\n    createCommentLike(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst deleteCommentLikeMutation = graphql(\n  `mutation DeleteCommentLike($input: DeleteCommentLikeInput!) {\n    deleteCommentLike(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst userQuery = graphql(\n  `query User($userId: ID!) {\n    user(id: $userId) {\n      id\n      iconUrl\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/suspicious/noExplicitAny","severity":"warning","description":"Unexpected any. Specify a different type.","message":[{"elements":[],"content":"Unexpected "},{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":". Specify a different type."}],"advices":{"advices":[{"log":["info",[{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":" disables many type checking rules. Its use should be avoided."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/work/work-viewer-dialog.tsx"},"span":[18278,18281],"sourceCode":"import { useCallback, useEffect, useRef, useState, useMemo } from \"react\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport type { PhotoAlbumWorkFragment } from \"~/components/responsive-photo-works-album\"\nimport { useQuery } from \"@apollo/client/index\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Avatar, AvatarImage, AvatarFallback } from \"~/components/ui/avatar\"\nimport { Button } from \"~/components/ui/button\"\nimport { ChevronLeft, ChevronRight, X } from \"lucide-react\"\nimport { WorkArticle } from \"~/routes/($lang)._main.posts.$post._index/components/work-article\"\nimport { WorkCommentSectionEnhanced } from \"~/components/work/work-comment-section-final\"\nimport { WorkCommentInputFixed } from \"~/components/work/work-comment-input-fixed\"\nimport { WorkActionContainer } from \"~/routes/($lang)._main.posts.$post._index/components/work-action-container\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\n// Note: Linkã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ä½¿ç”¨ã—ãªã„ï¼ˆPortalå†…ã§React Routerã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãŒä½¿ç”¨ã§ããªã„ãŸã‚ï¼‰\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Types â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n\ninterface Props {\n  works: FragmentOf<typeof PhotoAlbumWorkFragment>[]\n  /** è¡¨ç¤ºã‚’é–‹å§‹ã—ãŸã„ä½œå“ IDï¼ˆå„ªå…ˆï¼‰ */\n  startWorkId?: string\n  /** ID ãŒç„¡ã„å ´åˆã«ä½¿ã†ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ index */\n  startIndex?: number\n  onClose: () => void\n  /** TagWorkSection ã‹ã‚‰æ¸¡ã•ã‚Œã‚‹è¿½åŠ ãƒ­ãƒ¼ãƒ‰é–¢æ•° */\n  loadMore?: () => void\n  hasNextPage?: boolean\n  isLoadingMore?: boolean\n}\n\n/** è¦ç´ ã‚’è¦ªè¦ç´ ã®ç¸¦æ–¹å‘ä¸­å¤®ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦åˆã‚ã›ã‚‹ */\nexport function scrollItemIntoVerticalCenter(\n  container: HTMLElement,\n  item: HTMLElement,\n  smooth = true,\n): void {\n  const containerMiddle = container.clientHeight / 2\n  const itemMiddle = item.offsetTop + item.clientHeight / 2\n  const newTop = itemMiddle - containerMiddle\n  container.scrollTo({\n    top: newTop,\n    behavior: smooth ? \"smooth\" : \"auto\",\n  })\n}\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Component â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nexport function WorkViewerDialog({\n  works,\n  startIndex,\n  onClose,\n  loadMore,\n  hasNextPage = false,\n  isLoadingMore = false,\n  startWorkId,\n}: Props): React.ReactNode {\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ State / Refs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const initialIndex = useMemo(() => {\n    if (startWorkId) {\n      const idx = works.findIndex((w) => w.id === startWorkId)\n      if (idx !== -1) return idx\n    }\n    const fallbackIndex = startIndex ?? 0\n    return fallbackIndex\n  }, [startWorkId, startIndex, works])\n\n  const [index, setIndex] = useState(initialIndex)\n  const [loadedWorkIds, setLoadedWorkIds] = useState<Set<string>>(new Set())\n  const [workDataCache, setWorkDataCache] = useState<Map<string, unknown>>(\n    new Map(),\n  )\n\n  // ãƒ‡ãƒã‚¦ãƒ³ã‚¹ç”¨ã®çŠ¶æ…‹\n  const [activeWorkId, setActiveWorkId] = useState<string | null>(null)\n  const [isDebouncing, setIsDebouncing] = useState(false)\n  const isFirstScrollDone = useRef(false)\n  const isInitialized = useRef(false)\n\n  // åˆæœŸåŒ–æ™‚ã«æ­£ã—ã„ä½œå“IDã¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ç¢ºå®Ÿã«è¨­å®šï¼ˆä¸€å›ã®ã¿ï¼‰\n  useEffect(() => {\n    if (isInitialized.current) return // æ—¢ã«åˆæœŸåŒ–æ¸ˆã¿ã®å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—\n\n    const targetWork = works[initialIndex]\n    if (targetWork) {\n      // ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚‚ç¢ºå®Ÿã«åˆæœŸå€¤ã«è¨­å®š\n      setIndex(initialIndex)\n      // å¯¾å¿œã™ã‚‹ä½œå“IDã‚‚è¨­å®š\n      if (activeWorkId !== targetWork.id) {\n        setActiveWorkId(targetWork.id)\n      }\n      isInitialized.current = true // åˆæœŸåŒ–å®Œäº†ã‚’ãƒãƒ¼ã‚¯\n    }\n  }, [initialIndex]) // worksã¨activeWorkIdã‚’ä¾å­˜é…åˆ—ã‹ã‚‰é™¤å»\n\n  // startWorkIdãŒå¤‰ã‚ã£ãŸå ´åˆã¯å†åˆæœŸåŒ–ã‚’è¨±å¯\n  useEffect(() => {\n    isInitialized.current = false\n  }, [startWorkId])\n\n  const thumbListRef = useRef<HTMLDivElement | null>(null)\n  const sentinelRef = useRef<HTMLDivElement | null>(null)\n  const debounceTimerRef = useRef<NodeJS.Timeout | null>(null)\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç¾åœ¨ã®ä½œå“ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const work = works[index]\n  const isWorkCached = work ? workDataCache.has(work.id) : false\n  const shouldFetchWork = work && activeWorkId === work.id && !isWorkCached\n\n  useEffect(() => {\n    setTimeout(() => {\n      const listEl = thumbListRef.current\n      if (!listEl) return\n\n      const target = listEl.children[index] as HTMLElement | undefined\n      if (!target) return\n\n      // åˆå›ã ã‘ã¯ä¸€ç¬ã§ä½ç½®åˆã‚ã›ãƒ»ä»¥å¾Œã¯ smooth\n      scrollItemIntoVerticalCenter(\n        listEl,\n        target,\n        /* smooth = */ isFirstScrollDone.current,\n      )\n\n      // 1 å›å®Ÿè¡Œã—ãŸã‚‰ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã¦ smooth ã«åˆ‡ã‚Šæ›¿ãˆ\n      if (!isFirstScrollDone.current) isFirstScrollDone.current = true\n    }, 100)\n  }, [index, works.length, startWorkId, startIndex, initialIndex])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å¤‰æ›´æ™‚ã®å‡¦ç† â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  useEffect(() => {\n    const currentWork = works[index]\n    if (currentWork) {\n      // ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¸ˆã¿ã®å ´åˆã¯å³åº§ã«è¡¨ç¤º\n      if (workDataCache.has(currentWork.id)) {\n        setActiveWorkId(currentWork.id)\n        setIsDebouncing(false)\n        // ã‚¿ã‚¤ãƒãƒ¼ã‚’ã‚¯ãƒªã‚¢\n        if (debounceTimerRef.current) {\n          clearTimeout(debounceTimerRef.current)\n          debounceTimerRef.current = null\n        }\n      } else {\n        // åˆå›è¡¨ç¤ºã¾ãŸã¯æœªã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å ´åˆ\n        const isInitial = activeWorkId === null\n        setIsDebouncing(true)\n\n        // æ—¢å­˜ã®ã‚¿ã‚¤ãƒãƒ¼ã‚’ã‚¯ãƒªã‚¢\n        if (debounceTimerRef.current) {\n          clearTimeout(debounceTimerRef.current)\n        }\n\n        // ãƒ‡ãƒã‚¦ãƒ³ã‚¹æ™‚é–“ã‚’ã•ã‚‰ã«æœ€é©åŒ–ï¼ˆåˆå›ã¯å³åº§ã€ä»¥é™ã¯çŸ­ãï¼‰\n        const debounceTime = isInitial ? 0 : 200\n\n        debounceTimerRef.current = setTimeout(() => {\n          setActiveWorkId(currentWork.id)\n          setIsDebouncing(false)\n          debounceTimerRef.current = null\n        }, debounceTime)\n      }\n    }\n  }, [index, works, workDataCache])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GraphQL Query with conditional execution â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const { data, loading, refetch } = useQuery(workDialogQuery, {\n    variables: { workId: work?.id || \"\" },\n    skip: !shouldFetchWork || !work, // workãŒå­˜åœ¨ã—ãªã„å ´åˆã‚‚ã‚¹ã‚­ãƒƒãƒ—\n    fetchPolicy: \"cache-and-network\",\n    nextFetchPolicy: \"cache-first\",\n    notifyOnNetworkStatusChange: true,\n    returnPartialData: true,\n    onCompleted: (data) => {\n      if (data?.work && work) {\n        // ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ããŸã‚‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜\n        setWorkDataCache((prev) => new Map(prev).set(work.id, data.work))\n        setLoadedWorkIds((prev) => new Set(prev).add(work.id))\n      }\n    },\n  })\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å…ˆèª­ã¿å‡¦ç†ï¼ˆãƒ‡ãƒã‚¦ãƒ³ã‚¹ä»˜ãï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const prefetchAdjacentWorks = useCallback(() => {\n    // ç¾åœ¨ã®ä½œå“ãŒèª­ã¿è¾¼ã¿å®Œäº†ã—ã¦ã‹ã‚‰å…ˆèª­ã¿é–‹å§‹\n    if (isDebouncing || (!isWorkCached && !data?.work)) return\n\n    const prefetchIds: string[] = []\n\n    // å‰å¾Œ2ä½œå“ã®ç¯„å›²ã§å…ˆèª­ã¿ï¼ˆè² è·è»½æ¸›ã®ãŸã‚ç¯„å›²ã‚’ç¸®å°ï¼‰\n    for (\n      let i = Math.max(0, index - 2);\n      i <= Math.min(works.length - 1, index + 2);\n      i++\n    ) {\n      const workItem = works[i]\n      if (workItem && i !== index && !loadedWorkIds.has(workItem.id)) {\n        prefetchIds.push(workItem.id)\n      }\n    }\n\n    // å…ˆèª­ã¿å®Ÿè¡Œï¼ˆã•ã‚‰ã«é…å»¶ã‚’è¿½åŠ ï¼‰\n    prefetchIds.forEach((workId, idx) => {\n      setTimeout(\n        () => {\n          if (!workDataCache.has(workId)) {\n            setActiveWorkId(workId)\n          }\n        },\n        1000 + idx * 500,\n      ) // 1ç§’å¾Œã‹ã‚‰0.5ç§’é–“éš”ã§å…ˆèª­ã¿\n    })\n  }, [\n    index,\n    works,\n    loadedWorkIds,\n    workDataCache,\n    isDebouncing,\n    isWorkCached,\n    data,\n  ])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å…ˆèª­ã¿ã®ãƒˆãƒªã‚¬ãƒ¼ï¼ˆé…å»¶å®Ÿè¡Œï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  useEffect(() => {\n    const timeoutId = setTimeout(() => {\n      prefetchAdjacentWorks()\n    }, 1500) // 1.5ç§’å¾Œã«å…ˆèª­ã¿é–‹å§‹\n\n    return () => clearTimeout(timeoutId)\n  }, [prefetchAdjacentWorks])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç¾åœ¨è¡¨ç¤ºã™ã‚‹ä½œå“ãƒ‡ãƒ¼ã‚¿ã®æ±ºå®š â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const currentWork = useMemo(() => {\n    if (!work) return null\n\n    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—\n    const cachedData = workDataCache.get(work.id)\n    if (cachedData) {\n      return cachedData as typeof work\n    }\n\n    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ãªã„å ´åˆã¯APIã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã¾ãŸã¯åŸºæœ¬ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨\n    return (data?.work as typeof work) ?? work\n  }, [work, workDataCache, data])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚³ãƒ¡ãƒ³ãƒˆé€ä¿¡å¾Œã®å‡¦ç† â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleCommentAdded = useCallback(async () => {\n    if (!work) return\n\n    try {\n      // ãƒ‡ãƒ¼ã‚¿ã‚’å†å–å¾—ã—ã¦ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æ›´æ–°\n      const result = await refetch()\n      if (result.data?.work) {\n        setWorkDataCache((prev) => new Map(prev).set(work.id, result.data.work))\n      }\n    } catch (error) {\n      console.error(\"Failed to refetch comments:\", error)\n    }\n  }, [refetch, work])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ index ãŒæœ«å°¾ãªã‚‰è‡ªå‹•ãƒ­ãƒ¼ãƒ‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  useEffect(() => {\n    if (\n      index === works.length - 1 &&\n      hasNextPage &&\n      !isLoadingMore &&\n      loadMore\n    ) {\n      loadMore()\n    }\n  }, [index, works.length, hasNextPage, isLoadingMore, loadMore])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const next = useCallback(\n    () => setIndex((i) => (i < works.length - 1 ? i + 1 : i)),\n    [works.length],\n  )\n  const prev = useCallback(\n    () => setIndex((i) => (i > 0 ? i - 1 : i)),\n    [works.length],\n  )\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚­ãƒ¼ / ãƒ›ã‚¤ãƒ¼ãƒ« â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  useEffect(() => {\n    const onKey = (e: KeyboardEvent) => {\n      const activeElement = document.activeElement\n      const tagName = activeElement?.tagName.toLowerCase()\n      const isInputFocused =\n        tagName === \"input\" ||\n        tagName === \"textarea\" ||\n        activeElement?.getAttribute(\"contenteditable\") === \"true\" ||\n        activeElement?.getAttribute(\"role\") === \"textbox\"\n\n      // å…¥åŠ›æ¬„ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã—ã¦ã„ã‚‹å ´åˆã¯å‡¦ç†ã‚’åœæ­¢\n      if (isInputFocused) {\n        return\n      }\n\n      if (e.key === \"ArrowUp\") {\n        e.preventDefault() // èƒŒæ™¯ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’é˜²ã\n        e.stopPropagation() // ã‚¤ãƒ™ãƒ³ãƒˆã®ä¼æ’­ã‚’åœæ­¢\n        prev()\n      }\n      if (e.key === \"ArrowDown\") {\n        e.preventDefault() // èƒŒæ™¯ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’é˜²ã\n        e.stopPropagation() // ã‚¤ãƒ™ãƒ³ãƒˆã®ä¼æ’­ã‚’åœæ­¢\n        next()\n      }\n      if (e.key === \"Escape\") onClose()\n    }\n\n    window.addEventListener(\"keydown\", onKey)\n    // ãƒ›ã‚¤ãƒ¼ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’å‰Šé™¤ï¼ˆã‚µãƒ ãƒã‚¤ãƒ«ä¸€è¦§ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã«ã‚ˆã‚‹è‡ªå‹•åˆ‡ã‚Šæ›¿ãˆã‚’é˜²ãï¼‰\n    return () => {\n      window.removeEventListener(\"keydown\", onKey)\n    }\n  }, [prev, next, onClose])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  useEffect(() => {\n    return () => {\n      if (debounceTimerRef.current) {\n        clearTimeout(debounceTimerRef.current)\n      }\n    }\n  }, [])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const isCurrentWorkLoading = (!isWorkCached && loading) || isDebouncing\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å®‰å…¨æ€§ãƒã‚§ãƒƒã‚¯ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  if (!work || !currentWork) {\n    console.error(\n      \"Work not found at index:\",\n      index,\n      \"Works length:\",\n      works.length,\n    )\n    return (\n      <Dialog open onOpenChange={onClose}>\n        <DialogContent className=\"flex h-[90vh] w-[100vw] max-w-[88vw] overflow-hidden p-0\">\n          <div className=\"flex flex-1 items-center justify-center\">\n            <p className=\"text-muted-foreground\">ä½œå“ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</p>\n          </div>\n        </DialogContent>\n      </Dialog>\n    )\n  }\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Render â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  return (\n    <Dialog open onOpenChange={onClose}>\n      <DialogContent className=\"h-[96vh] w-[100vw] max-w-[95vw] overflow-hidden p-0 sm:max-w-[88vw]\">\n        <div className=\"flex h-[88vh] w-[100vw] max-w-[95vw] overflow-hidden p-0 sm:max-w-[88vw]\">\n          {/* è©³ç´°ãƒ‘ãƒãƒ« (Desktop + Mobile) */}\n          <aside\n            className=\"flex flex-col bg-background/80 backdrop-blur-sm\"\n            style={{\n              width: \"calc(100% - 5rem)\",\n              minWidth: \"calc(100% - 5rem)\",\n              maxWidth: \"calc(100% - 5rem)\",\n            }}\n          >\n            <DialogHeader className=\"border-b p-4 pb-2\">\n              {/* ãƒ¢ãƒã‚¤ãƒ«ç”¨ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */}\n              <div className=\"flex items-center justify-between md:hidden\">\n                <Button\n                  onClick={prev}\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  disabled={index === 0}\n                  className=\"p-2\"\n                >\n                  <ChevronLeft className=\"h-4 w-4\" />\n                </Button>\n                <span className=\"text-muted-foreground text-xs\">\n                  {index + 1} / {works.length}\n                </span>\n                <Button\n                  onClick={next}\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  disabled={index === works.length - 1}\n                  className=\"p-2\"\n                >\n                  <ChevronRight className=\"h-4 w-4\" />\n                </Button>\n                <Button\n                  onClick={onClose}\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"p-2\"\n                >\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              </div>\n              <DialogTitle className=\"truncate font-bold text-lg\">\n                {/* ã‚¿ã‚¤ãƒˆãƒ«ã¯ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã®ã¿ */}\n                <span\n                  className=\"hidden cursor-pointer text-left transition-colors hover:text-primary md:inline\"\n                  onClick={() => {\n                    // Portalå†…ã§React RouterãŒä½¿ç”¨ã§ããªã„ãŸã‚ã€ç›´æ¥ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³\n                    if (typeof window !== \"undefined\") {\n                      window.location.href = `/posts/${currentWork.id}`\n                    }\n                  }}\n                  role=\"button\"\n                  tabIndex={0}\n                  onKeyDown={(e) => {\n                    if (e.key === \"Enter\" || e.key === \" \") {\n                      e.preventDefault()\n                      if (typeof window !== \"undefined\") {\n                        window.location.href = `/posts/${currentWork.id}`\n                      }\n                    }\n                  }}\n                >\n                  {currentWork.title}\n                </span>\n                {/* ãƒ¢ãƒã‚¤ãƒ«ç”¨ç°¡æ½”ã‚¿ã‚¤ãƒˆãƒ« */}\n                <span className=\"truncate md:hidden\">{currentWork.title}</span>\n              </DialogTitle>\n              <div className=\"mt-2\">\n                <span\n                  onClick={() => {\n                    if (typeof window !== \"undefined\") {\n                      window.location.href = `/users/${currentWork.user?.login}`\n                    }\n                  }}\n                  className=\"flex cursor-pointer items-center space-x-2 transition-colors hover:text-primary\"\n                  role=\"button\"\n                  tabIndex={0}\n                  onKeyDown={(e) => {\n                    if (e.key === \"Enter\" || e.key === \" \") {\n                      e.preventDefault()\n                      if (typeof window !== \"undefined\") {\n                        window.location.href = `/users/${currentWork.user?.login}`\n                      }\n                    }\n                  }}\n                >\n                  <Avatar className=\"size-6\">\n                    <AvatarImage\n                      src={withIconUrlFallback(currentWork.user?.iconUrl)}\n                    />\n                    <AvatarFallback />\n                  </Avatar>\n                  <span className=\"font-medium text-sm\">\n                    {currentWork.user?.name}\n                  </span>\n                </span>\n              </div>\n            </DialogHeader>\n\n            {/* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º */}\n            {isCurrentWorkLoading ? (\n              <div className=\"flex flex-1 items-center justify-center\">\n                <div className=\"flex flex-col items-center space-y-2\">\n                  <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-muted-foreground border-t-transparent\" />\n                  <span className=\"text-muted-foreground text-sm\">\n                    {isDebouncing ? \"å¾…æ©Ÿä¸­...\" : \"èª­ã¿è¾¼ã¿ä¸­...\"}\n                  </span>\n                </div>\n              </div>\n            ) : (\n              <div className=\"flex flex-1 flex-col overflow-hidden\">\n                {/* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ï¼ˆã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ï¼‰ */}\n                <div className=\"flex-1 overflow-y-auto overscroll-y-contain p-4\">\n                  <WorkArticle\n                    work={{\n                      ...currentWork,\n                      isBotGradingEnabled:\n                        (\n                          currentWork as unknown as {\n                            isBotGradingEnabled?: boolean\n                          }\n                        ).isBotGradingEnabled ?? false,\n                      isBotGradingPublic:\n                        (\n                          currentWork as unknown as {\n                            isBotGradingPublic?: boolean\n                          }\n                        ).isBotGradingPublic ?? false,\n                      botEvaluation: ((currentWork as any).botEvaluation ??\n                        null) as any,\n                      user: currentWork.user\n                        ? { ...currentWork.user, works: [] }\n                        : null,\n                      nextWork: null,\n                      previousWork: null,\n                    }}\n                    userSetting={undefined}\n                    mode={\"dialog\"}\n                  />\n                  {/* ã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆãŒæœ‰åŠ¹ãªå ´åˆã®ã¿ï¼‰ */}\n                  {currentWork.isCommentsEditable && (\n                    <div className=\"mt-6\">\n                      <WorkCommentSectionEnhanced\n                        workId={currentWork.id}\n                        workOwnerIconImageURL={withIconUrlFallback(\n                          currentWork.user?.iconUrl,\n                        )}\n                        isWorkOwnerBlocked={\n                          (currentWork as { user?: { isBlocked?: boolean } })\n                            .user?.isBlocked ?? false\n                        }\n                        isFixedInput={true}\n                        comments={\n                          Array.isArray(\n                            (currentWork as unknown as { comments?: unknown[] })\n                              .comments,\n                          )\n                            ? (\n                                currentWork as unknown as {\n                                  comments: unknown[]\n                                }\n                              ).comments.map((c: unknown) => ({\n                                id: (c as { id: string }).id,\n                                text: (c as { text?: string | null }).text,\n                                createdAt: (c as { createdAt: number })\n                                  .createdAt,\n                                likesCount: (c as { likesCount: number })\n                                  .likesCount,\n                                isLiked: (c as { isLiked: boolean }).isLiked,\n                                isWorkOwnerLiked: (\n                                  c as { isWorkOwnerLiked: boolean }\n                                ).isWorkOwnerLiked,\n                                isMuted: (c as { isMuted?: boolean }).isMuted,\n                                isSensitive: (c as { isSensitive?: boolean })\n                                  .isSensitive,\n                                user: (\n                                  c as {\n                                    user?: {\n                                      id: string\n                                      name: string\n                                      iconUrl?: string | null\n                                    }\n                                  }\n                                ).user\n                                  ? {\n                                      id: (c as { user: { id: string } }).user\n                                        .id,\n                                      name:\n                                        (c as { user: { name: string } }).user\n                                          .name || \"\",\n                                      iconUrl: (\n                                        c as {\n                                          user: { iconUrl?: string | null }\n                                        }\n                                      ).user.iconUrl,\n                                    }\n                                  : undefined,\n                                sticker: (\n                                  c as {\n                                    sticker?: {\n                                      id: string\n                                      title: string\n                                      imageUrl?: string | null\n                                      accessType: string\n                                      isDownloaded?: boolean\n                                    }\n                                  }\n                                ).sticker\n                                  ? {\n                                      id:\n                                        (c as { sticker: { id: string } })\n                                          .sticker.id || \"\",\n                                      title:\n                                        (c as { sticker: { title: string } })\n                                          .sticker.title || \"\",\n                                      imageUrl: (\n                                        c as {\n                                          sticker: { imageUrl?: string | null }\n                                        }\n                                      ).sticker.imageUrl,\n                                      accessType:\n                                        (\n                                          c as {\n                                            sticker: { accessType: string }\n                                          }\n                                        ).sticker.accessType || \"PUBLIC\",\n                                      isDownloaded: (\n                                        c as {\n                                          sticker: { isDownloaded?: boolean }\n                                        }\n                                      ).sticker.isDownloaded,\n                                    }\n                                  : undefined,\n                                responses: [],\n                              }))\n                            : []\n                        }\n                      />\n                    </div>\n                  )}\n                </div>\n\n                {/* å›ºå®šã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¨ãƒªã‚¢ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›ï¼‰ */}\n                <div className=\"border-t bg-background/98 backdrop-blur-md\">\n                  {/* å›ºå®šã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›æ¬„ */}\n                  {currentWork.isCommentsEditable && (\n                    <WorkCommentInputFixed\n                      workId={currentWork.id}\n                      isWorkOwnerBlocked={\n                        (currentWork as { user?: { isBlocked?: boolean } }).user\n                          ?.isBlocked ?? false\n                      }\n                      commentsCount={\n                        Array.isArray(\n                          (currentWork as unknown as { comments?: unknown[] })\n                            .comments,\n                        )\n                          ? (currentWork as unknown as { comments: unknown[] })\n                              .comments.length\n                          : 0\n                      }\n                      onCommentAdded={handleCommentAdded}\n                    />\n                  )}\n                </div>\n              </div>\n            )}\n          </aside>\n\n          {/* ã‚µãƒ ãƒã‚¤ãƒ«åˆ— - ã‚¹ãƒãƒ›ã§ã‚‚å¸¸ã«è¡¨ç¤ºï¼ˆå¹…å›ºå®šï¼‰ */}\n          <aside\n            ref={thumbListRef}\n            className=\"ml-auto flex h-full flex-col overflow-y-auto overscroll-y-contain bg-background/80 backdrop-blur-sm\"\n            style={{\n              width: \"5rem\", // å›ºå®šå¹…\n              minWidth: \"5rem\", // æœ€å°å¹…\n              maxWidth: \"5rem\", // æœ€å¤§å¹…\n              scrollbarWidth: \"thin\",\n              display: \"flex\",\n              visibility: \"visible\",\n              opacity: 1,\n            }}\n          >\n            {works.map((w, i) => (\n              <button\n                key={w.id}\n                type=\"button\"\n                className={`relative m-1 rounded-md ring-offset-2 transition-all duration-200 focus:outline-none focus:ring-2 ${\n                  i === index\n                    ? \"bg-primary/10 ring ring-primary\"\n                    : \"hover:bg-background/20\"\n                }`}\n                onClick={() => setIndex(i)}\n              >\n                <img\n                  src={w.smallThumbnailImageURL}\n                  alt={w.title}\n                  className=\"h-16 w-full rounded-md object-cover\"\n                  draggable={false}\n                  loading=\"lazy\"\n                  onLoad={(e) => {\n                    // ç”»åƒèª­ã¿è¾¼ã¿å®Œäº†æ™‚ã«ã‚µãƒ ãƒã‚¤ãƒ«å¹…ã®å®‰å®šåŒ–\n                    const img = e.target as HTMLImageElement\n                    img.style.opacity = \"1\"\n                  }}\n                  onError={(e) => {\n                    // ã‚¨ãƒ©ãƒ¼æ™‚ã‚‚ã‚µã‚¤ã‚ºã‚’ç¶­æŒ\n                    const img = e.target as HTMLImageElement\n                    img.style.opacity = \"0.5\"\n                  }}\n                  style={{\n                    width: \"100%\",\n                    height: \"4rem\",\n                    objectFit: \"cover\",\n                    opacity: 0,\n                    transition: \"opacity 0.3s ease-in-out\",\n                  }}\n                />\n                {/* ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¸ˆã¿ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */}\n                {loadedWorkIds.has(w.id) && (\n                  <div className=\"absolute top-1 right-1 h-2 w-2 rounded-full bg-green-400 shadow-sm\" />\n                )}\n                {/* ãƒ‡ãƒã‚¦ãƒ³ã‚¹ä¸­ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */}\n                {isDebouncing && i === index && (\n                  <div className=\"absolute top-1 left-1 h-2 w-2 animate-pulse rounded-full bg-yellow-400 shadow-sm\" />\n                )}\n              </button>\n            ))}\n\n            {/* sentinel & spinner */}\n            {isLoadingMore && (\n              <div className=\"flex justify-center py-2\">\n                <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-muted-foreground border-t-transparent\" />\n              </div>\n            )}\n            <div ref={sentinelRef} className=\"h-[2px] w-full\" />\n          </aside>\n        </div>\n        {/* ã„ã„ã­ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ - ãƒ•ãƒ«å¹…æœ‰åŠ¹é ˜åŸŸ */}\n        <div className=\"border-t bg-background/95 backdrop-blur-sm\">\n          <div className=\"w-full\">\n            <WorkActionContainer\n              workLikesCount={currentWork.likesCount}\n              title={currentWork.title}\n              description={\n                (currentWork.description?.length ?? 0) > 100\n                  ? `${currentWork.description?.slice(0, 100)}...`\n                  : (currentWork.description ?? \"\")\n              }\n              currentImageUrl={currentWork.imageURL}\n              imageUrls={[\n                currentWork.imageURL,\n                ...(currentWork.subWorks || []).map(\n                  (subWork) => subWork.imageUrl ?? \"\",\n                ),\n              ]}\n              targetWorkId={currentWork.id}\n              bookmarkFolderId={null}\n              targetWorkOwnerUserId={currentWork.user?.id ?? \"\"}\n              isDisabledShare={false}\n              isTargetUserBlocked={Boolean(currentWork.user?.isBlocked)}\n              mode=\"dialogLikeOnly\"\n            />\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n// GraphQLéƒ¨åˆ†ã¯å¤‰æ›´ãªã—\nexport const workArticleFragment =\n  graphql(`fragment WorkArticle on WorkNode @_unmask {\n  id\n  isMyRecommended\n  title\n  mdUrl\n  accessType\n  type\n  adminAccessType\n  promptAccessType\n  rating\n  description\n  isSensitive\n  enTitle\n  enDescription\n  imageURL\n  largeThumbnailImageURL\n  largeThumbnailImageWidth\n  largeThumbnailImageHeight\n  smallThumbnailImageURL\n  smallThumbnailImageWidth\n  smallThumbnailImageHeight\n  thumbnailImagePosition\n  subWorksCount\n  url\n  isDeleted\n  user {\n    id\n    biography\n    enBiography\n    login\n    nanoid\n    name\n    receivedLikesCount\n    receivedViewsCount\n    awardsCount\n    followersCount\n    worksCount\n    iconUrl\n    headerImageUrl\n    webFcmToken\n    isFollower\n    isFollowee\n    headerImageUrl\n    receivedLikesCount\n    createdLikesCount\n    createdBookmarksCount\n    isMuted\n    promptonUser {\n      id\n    }\n  }\n  likedUsers(offset: 0, limit: 8) {\n    id\n    name\n    iconUrl\n    login\n  }\n  dailyTheme {\n    id\n    title\n    dateText\n  }\n  tagNames\n  createdAt\n  likesCount\n  viewsCount\n  commentsCount\n  subWorks {\n    id\n    imageUrl\n  }\n  model\n  modelHash\n  generationModelId\n  workModelId\n  isTagEditable\n  isCommentsEditable\n  isLiked\n  isBookmarked\n  isInCollection\n  isPromotion\n  isGeneration\n  ogpThumbnailImageUrl\n  prompt\n  negativePrompt\n  noise\n  seed\n  steps\n  sampler\n  scale\n  strength\n  vae\n  clipSkip\n  otherGenerationParams\n  pngInfo\n  style\n  url\n  updatedAt\n  dailyRanking\n  weeklyRanking\n  monthlyRanking\n  relatedUrl\n  nanoid\n  isBotGradingEnabled\n  isBotGradingPublic\n  botEvaluation {\n    cutenessScore\n    coolnessScore\n    beautyScore\n    originalityScore\n    compositionScore\n    colorScore\n    detailScore\n    consistencyScore\n    overallScore\n    comment\n    personality\n  }\n}`)\n\nexport const WorkCommentFragment =\n  graphql(`fragment WorkComment on CommentNode @_unmask {\n  id\n  createdAt\n  text\n  likesCount\n  isWorkOwnerLiked\n  isLiked\n  user {\n    id\n    name\n    login\n    iconUrl\n    nanoid\n  }\n  sticker {\n    id\n    imageUrl\n    title\n    isDownloaded\n    likesCount\n    usesCount\n    downloadsCount\n    accessType\n  }\n}`)\n\nconst workDialogQuery = graphql(\n  `query WorkDialog($workId: ID!) {\n    work(id: $workId) {\n      ...WorkArticle\n      comments(offset: 0, limit: 128) {\n        ...WorkComment\n      }\n      user {\n        iconUrl\n      }\n    }\n    viewer {\n      id\n    }\n  }`,\n  [workArticleFragment, WorkCommentFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/suspicious/noExplicitAny","severity":"warning","description":"Unexpected any. Specify a different type.","message":[{"elements":[],"content":"Unexpected "},{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":". Specify a different type."}],"advices":{"advices":[{"log":["info",[{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":" disables many type checking rules. Its use should be avoided."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/work/work-viewer-dialog.tsx"},"span":[18333,18336],"sourceCode":"import { useCallback, useEffect, useRef, useState, useMemo } from \"react\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport type { PhotoAlbumWorkFragment } from \"~/components/responsive-photo-works-album\"\nimport { useQuery } from \"@apollo/client/index\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Avatar, AvatarImage, AvatarFallback } from \"~/components/ui/avatar\"\nimport { Button } from \"~/components/ui/button\"\nimport { ChevronLeft, ChevronRight, X } from \"lucide-react\"\nimport { WorkArticle } from \"~/routes/($lang)._main.posts.$post._index/components/work-article\"\nimport { WorkCommentSectionEnhanced } from \"~/components/work/work-comment-section-final\"\nimport { WorkCommentInputFixed } from \"~/components/work/work-comment-input-fixed\"\nimport { WorkActionContainer } from \"~/routes/($lang)._main.posts.$post._index/components/work-action-container\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\n// Note: Linkã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ä½¿ç”¨ã—ãªã„ï¼ˆPortalå†…ã§React Routerã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãŒä½¿ç”¨ã§ããªã„ãŸã‚ï¼‰\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Types â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n\ninterface Props {\n  works: FragmentOf<typeof PhotoAlbumWorkFragment>[]\n  /** è¡¨ç¤ºã‚’é–‹å§‹ã—ãŸã„ä½œå“ IDï¼ˆå„ªå…ˆï¼‰ */\n  startWorkId?: string\n  /** ID ãŒç„¡ã„å ´åˆã«ä½¿ã†ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ index */\n  startIndex?: number\n  onClose: () => void\n  /** TagWorkSection ã‹ã‚‰æ¸¡ã•ã‚Œã‚‹è¿½åŠ ãƒ­ãƒ¼ãƒ‰é–¢æ•° */\n  loadMore?: () => void\n  hasNextPage?: boolean\n  isLoadingMore?: boolean\n}\n\n/** è¦ç´ ã‚’è¦ªè¦ç´ ã®ç¸¦æ–¹å‘ä¸­å¤®ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦åˆã‚ã›ã‚‹ */\nexport function scrollItemIntoVerticalCenter(\n  container: HTMLElement,\n  item: HTMLElement,\n  smooth = true,\n): void {\n  const containerMiddle = container.clientHeight / 2\n  const itemMiddle = item.offsetTop + item.clientHeight / 2\n  const newTop = itemMiddle - containerMiddle\n  container.scrollTo({\n    top: newTop,\n    behavior: smooth ? \"smooth\" : \"auto\",\n  })\n}\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Component â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nexport function WorkViewerDialog({\n  works,\n  startIndex,\n  onClose,\n  loadMore,\n  hasNextPage = false,\n  isLoadingMore = false,\n  startWorkId,\n}: Props): React.ReactNode {\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ State / Refs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const initialIndex = useMemo(() => {\n    if (startWorkId) {\n      const idx = works.findIndex((w) => w.id === startWorkId)\n      if (idx !== -1) return idx\n    }\n    const fallbackIndex = startIndex ?? 0\n    return fallbackIndex\n  }, [startWorkId, startIndex, works])\n\n  const [index, setIndex] = useState(initialIndex)\n  const [loadedWorkIds, setLoadedWorkIds] = useState<Set<string>>(new Set())\n  const [workDataCache, setWorkDataCache] = useState<Map<string, unknown>>(\n    new Map(),\n  )\n\n  // ãƒ‡ãƒã‚¦ãƒ³ã‚¹ç”¨ã®çŠ¶æ…‹\n  const [activeWorkId, setActiveWorkId] = useState<string | null>(null)\n  const [isDebouncing, setIsDebouncing] = useState(false)\n  const isFirstScrollDone = useRef(false)\n  const isInitialized = useRef(false)\n\n  // åˆæœŸåŒ–æ™‚ã«æ­£ã—ã„ä½œå“IDã¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ç¢ºå®Ÿã«è¨­å®šï¼ˆä¸€å›ã®ã¿ï¼‰\n  useEffect(() => {\n    if (isInitialized.current) return // æ—¢ã«åˆæœŸåŒ–æ¸ˆã¿ã®å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—\n\n    const targetWork = works[initialIndex]\n    if (targetWork) {\n      // ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚‚ç¢ºå®Ÿã«åˆæœŸå€¤ã«è¨­å®š\n      setIndex(initialIndex)\n      // å¯¾å¿œã™ã‚‹ä½œå“IDã‚‚è¨­å®š\n      if (activeWorkId !== targetWork.id) {\n        setActiveWorkId(targetWork.id)\n      }\n      isInitialized.current = true // åˆæœŸåŒ–å®Œäº†ã‚’ãƒãƒ¼ã‚¯\n    }\n  }, [initialIndex]) // worksã¨activeWorkIdã‚’ä¾å­˜é…åˆ—ã‹ã‚‰é™¤å»\n\n  // startWorkIdãŒå¤‰ã‚ã£ãŸå ´åˆã¯å†åˆæœŸåŒ–ã‚’è¨±å¯\n  useEffect(() => {\n    isInitialized.current = false\n  }, [startWorkId])\n\n  const thumbListRef = useRef<HTMLDivElement | null>(null)\n  const sentinelRef = useRef<HTMLDivElement | null>(null)\n  const debounceTimerRef = useRef<NodeJS.Timeout | null>(null)\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç¾åœ¨ã®ä½œå“ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const work = works[index]\n  const isWorkCached = work ? workDataCache.has(work.id) : false\n  const shouldFetchWork = work && activeWorkId === work.id && !isWorkCached\n\n  useEffect(() => {\n    setTimeout(() => {\n      const listEl = thumbListRef.current\n      if (!listEl) return\n\n      const target = listEl.children[index] as HTMLElement | undefined\n      if (!target) return\n\n      // åˆå›ã ã‘ã¯ä¸€ç¬ã§ä½ç½®åˆã‚ã›ãƒ»ä»¥å¾Œã¯ smooth\n      scrollItemIntoVerticalCenter(\n        listEl,\n        target,\n        /* smooth = */ isFirstScrollDone.current,\n      )\n\n      // 1 å›å®Ÿè¡Œã—ãŸã‚‰ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã¦ smooth ã«åˆ‡ã‚Šæ›¿ãˆ\n      if (!isFirstScrollDone.current) isFirstScrollDone.current = true\n    }, 100)\n  }, [index, works.length, startWorkId, startIndex, initialIndex])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å¤‰æ›´æ™‚ã®å‡¦ç† â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  useEffect(() => {\n    const currentWork = works[index]\n    if (currentWork) {\n      // ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¸ˆã¿ã®å ´åˆã¯å³åº§ã«è¡¨ç¤º\n      if (workDataCache.has(currentWork.id)) {\n        setActiveWorkId(currentWork.id)\n        setIsDebouncing(false)\n        // ã‚¿ã‚¤ãƒãƒ¼ã‚’ã‚¯ãƒªã‚¢\n        if (debounceTimerRef.current) {\n          clearTimeout(debounceTimerRef.current)\n          debounceTimerRef.current = null\n        }\n      } else {\n        // åˆå›è¡¨ç¤ºã¾ãŸã¯æœªã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å ´åˆ\n        const isInitial = activeWorkId === null\n        setIsDebouncing(true)\n\n        // æ—¢å­˜ã®ã‚¿ã‚¤ãƒãƒ¼ã‚’ã‚¯ãƒªã‚¢\n        if (debounceTimerRef.current) {\n          clearTimeout(debounceTimerRef.current)\n        }\n\n        // ãƒ‡ãƒã‚¦ãƒ³ã‚¹æ™‚é–“ã‚’ã•ã‚‰ã«æœ€é©åŒ–ï¼ˆåˆå›ã¯å³åº§ã€ä»¥é™ã¯çŸ­ãï¼‰\n        const debounceTime = isInitial ? 0 : 200\n\n        debounceTimerRef.current = setTimeout(() => {\n          setActiveWorkId(currentWork.id)\n          setIsDebouncing(false)\n          debounceTimerRef.current = null\n        }, debounceTime)\n      }\n    }\n  }, [index, works, workDataCache])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GraphQL Query with conditional execution â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const { data, loading, refetch } = useQuery(workDialogQuery, {\n    variables: { workId: work?.id || \"\" },\n    skip: !shouldFetchWork || !work, // workãŒå­˜åœ¨ã—ãªã„å ´åˆã‚‚ã‚¹ã‚­ãƒƒãƒ—\n    fetchPolicy: \"cache-and-network\",\n    nextFetchPolicy: \"cache-first\",\n    notifyOnNetworkStatusChange: true,\n    returnPartialData: true,\n    onCompleted: (data) => {\n      if (data?.work && work) {\n        // ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ããŸã‚‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜\n        setWorkDataCache((prev) => new Map(prev).set(work.id, data.work))\n        setLoadedWorkIds((prev) => new Set(prev).add(work.id))\n      }\n    },\n  })\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å…ˆèª­ã¿å‡¦ç†ï¼ˆãƒ‡ãƒã‚¦ãƒ³ã‚¹ä»˜ãï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const prefetchAdjacentWorks = useCallback(() => {\n    // ç¾åœ¨ã®ä½œå“ãŒèª­ã¿è¾¼ã¿å®Œäº†ã—ã¦ã‹ã‚‰å…ˆèª­ã¿é–‹å§‹\n    if (isDebouncing || (!isWorkCached && !data?.work)) return\n\n    const prefetchIds: string[] = []\n\n    // å‰å¾Œ2ä½œå“ã®ç¯„å›²ã§å…ˆèª­ã¿ï¼ˆè² è·è»½æ¸›ã®ãŸã‚ç¯„å›²ã‚’ç¸®å°ï¼‰\n    for (\n      let i = Math.max(0, index - 2);\n      i <= Math.min(works.length - 1, index + 2);\n      i++\n    ) {\n      const workItem = works[i]\n      if (workItem && i !== index && !loadedWorkIds.has(workItem.id)) {\n        prefetchIds.push(workItem.id)\n      }\n    }\n\n    // å…ˆèª­ã¿å®Ÿè¡Œï¼ˆã•ã‚‰ã«é…å»¶ã‚’è¿½åŠ ï¼‰\n    prefetchIds.forEach((workId, idx) => {\n      setTimeout(\n        () => {\n          if (!workDataCache.has(workId)) {\n            setActiveWorkId(workId)\n          }\n        },\n        1000 + idx * 500,\n      ) // 1ç§’å¾Œã‹ã‚‰0.5ç§’é–“éš”ã§å…ˆèª­ã¿\n    })\n  }, [\n    index,\n    works,\n    loadedWorkIds,\n    workDataCache,\n    isDebouncing,\n    isWorkCached,\n    data,\n  ])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å…ˆèª­ã¿ã®ãƒˆãƒªã‚¬ãƒ¼ï¼ˆé…å»¶å®Ÿè¡Œï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  useEffect(() => {\n    const timeoutId = setTimeout(() => {\n      prefetchAdjacentWorks()\n    }, 1500) // 1.5ç§’å¾Œã«å…ˆèª­ã¿é–‹å§‹\n\n    return () => clearTimeout(timeoutId)\n  }, [prefetchAdjacentWorks])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç¾åœ¨è¡¨ç¤ºã™ã‚‹ä½œå“ãƒ‡ãƒ¼ã‚¿ã®æ±ºå®š â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const currentWork = useMemo(() => {\n    if (!work) return null\n\n    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—\n    const cachedData = workDataCache.get(work.id)\n    if (cachedData) {\n      return cachedData as typeof work\n    }\n\n    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ãªã„å ´åˆã¯APIã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã¾ãŸã¯åŸºæœ¬ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨\n    return (data?.work as typeof work) ?? work\n  }, [work, workDataCache, data])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚³ãƒ¡ãƒ³ãƒˆé€ä¿¡å¾Œã®å‡¦ç† â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleCommentAdded = useCallback(async () => {\n    if (!work) return\n\n    try {\n      // ãƒ‡ãƒ¼ã‚¿ã‚’å†å–å¾—ã—ã¦ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æ›´æ–°\n      const result = await refetch()\n      if (result.data?.work) {\n        setWorkDataCache((prev) => new Map(prev).set(work.id, result.data.work))\n      }\n    } catch (error) {\n      console.error(\"Failed to refetch comments:\", error)\n    }\n  }, [refetch, work])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ index ãŒæœ«å°¾ãªã‚‰è‡ªå‹•ãƒ­ãƒ¼ãƒ‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  useEffect(() => {\n    if (\n      index === works.length - 1 &&\n      hasNextPage &&\n      !isLoadingMore &&\n      loadMore\n    ) {\n      loadMore()\n    }\n  }, [index, works.length, hasNextPage, isLoadingMore, loadMore])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const next = useCallback(\n    () => setIndex((i) => (i < works.length - 1 ? i + 1 : i)),\n    [works.length],\n  )\n  const prev = useCallback(\n    () => setIndex((i) => (i > 0 ? i - 1 : i)),\n    [works.length],\n  )\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚­ãƒ¼ / ãƒ›ã‚¤ãƒ¼ãƒ« â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  useEffect(() => {\n    const onKey = (e: KeyboardEvent) => {\n      const activeElement = document.activeElement\n      const tagName = activeElement?.tagName.toLowerCase()\n      const isInputFocused =\n        tagName === \"input\" ||\n        tagName === \"textarea\" ||\n        activeElement?.getAttribute(\"contenteditable\") === \"true\" ||\n        activeElement?.getAttribute(\"role\") === \"textbox\"\n\n      // å…¥åŠ›æ¬„ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã—ã¦ã„ã‚‹å ´åˆã¯å‡¦ç†ã‚’åœæ­¢\n      if (isInputFocused) {\n        return\n      }\n\n      if (e.key === \"ArrowUp\") {\n        e.preventDefault() // èƒŒæ™¯ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’é˜²ã\n        e.stopPropagation() // ã‚¤ãƒ™ãƒ³ãƒˆã®ä¼æ’­ã‚’åœæ­¢\n        prev()\n      }\n      if (e.key === \"ArrowDown\") {\n        e.preventDefault() // èƒŒæ™¯ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’é˜²ã\n        e.stopPropagation() // ã‚¤ãƒ™ãƒ³ãƒˆã®ä¼æ’­ã‚’åœæ­¢\n        next()\n      }\n      if (e.key === \"Escape\") onClose()\n    }\n\n    window.addEventListener(\"keydown\", onKey)\n    // ãƒ›ã‚¤ãƒ¼ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’å‰Šé™¤ï¼ˆã‚µãƒ ãƒã‚¤ãƒ«ä¸€è¦§ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã«ã‚ˆã‚‹è‡ªå‹•åˆ‡ã‚Šæ›¿ãˆã‚’é˜²ãï¼‰\n    return () => {\n      window.removeEventListener(\"keydown\", onKey)\n    }\n  }, [prev, next, onClose])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  useEffect(() => {\n    return () => {\n      if (debounceTimerRef.current) {\n        clearTimeout(debounceTimerRef.current)\n      }\n    }\n  }, [])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const isCurrentWorkLoading = (!isWorkCached && loading) || isDebouncing\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å®‰å…¨æ€§ãƒã‚§ãƒƒã‚¯ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  if (!work || !currentWork) {\n    console.error(\n      \"Work not found at index:\",\n      index,\n      \"Works length:\",\n      works.length,\n    )\n    return (\n      <Dialog open onOpenChange={onClose}>\n        <DialogContent className=\"flex h-[90vh] w-[100vw] max-w-[88vw] overflow-hidden p-0\">\n          <div className=\"flex flex-1 items-center justify-center\">\n            <p className=\"text-muted-foreground\">ä½œå“ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</p>\n          </div>\n        </DialogContent>\n      </Dialog>\n    )\n  }\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Render â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  return (\n    <Dialog open onOpenChange={onClose}>\n      <DialogContent className=\"h-[96vh] w-[100vw] max-w-[95vw] overflow-hidden p-0 sm:max-w-[88vw]\">\n        <div className=\"flex h-[88vh] w-[100vw] max-w-[95vw] overflow-hidden p-0 sm:max-w-[88vw]\">\n          {/* è©³ç´°ãƒ‘ãƒãƒ« (Desktop + Mobile) */}\n          <aside\n            className=\"flex flex-col bg-background/80 backdrop-blur-sm\"\n            style={{\n              width: \"calc(100% - 5rem)\",\n              minWidth: \"calc(100% - 5rem)\",\n              maxWidth: \"calc(100% - 5rem)\",\n            }}\n          >\n            <DialogHeader className=\"border-b p-4 pb-2\">\n              {/* ãƒ¢ãƒã‚¤ãƒ«ç”¨ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */}\n              <div className=\"flex items-center justify-between md:hidden\">\n                <Button\n                  onClick={prev}\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  disabled={index === 0}\n                  className=\"p-2\"\n                >\n                  <ChevronLeft className=\"h-4 w-4\" />\n                </Button>\n                <span className=\"text-muted-foreground text-xs\">\n                  {index + 1} / {works.length}\n                </span>\n                <Button\n                  onClick={next}\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  disabled={index === works.length - 1}\n                  className=\"p-2\"\n                >\n                  <ChevronRight className=\"h-4 w-4\" />\n                </Button>\n                <Button\n                  onClick={onClose}\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"p-2\"\n                >\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              </div>\n              <DialogTitle className=\"truncate font-bold text-lg\">\n                {/* ã‚¿ã‚¤ãƒˆãƒ«ã¯ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã®ã¿ */}\n                <span\n                  className=\"hidden cursor-pointer text-left transition-colors hover:text-primary md:inline\"\n                  onClick={() => {\n                    // Portalå†…ã§React RouterãŒä½¿ç”¨ã§ããªã„ãŸã‚ã€ç›´æ¥ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³\n                    if (typeof window !== \"undefined\") {\n                      window.location.href = `/posts/${currentWork.id}`\n                    }\n                  }}\n                  role=\"button\"\n                  tabIndex={0}\n                  onKeyDown={(e) => {\n                    if (e.key === \"Enter\" || e.key === \" \") {\n                      e.preventDefault()\n                      if (typeof window !== \"undefined\") {\n                        window.location.href = `/posts/${currentWork.id}`\n                      }\n                    }\n                  }}\n                >\n                  {currentWork.title}\n                </span>\n                {/* ãƒ¢ãƒã‚¤ãƒ«ç”¨ç°¡æ½”ã‚¿ã‚¤ãƒˆãƒ« */}\n                <span className=\"truncate md:hidden\">{currentWork.title}</span>\n              </DialogTitle>\n              <div className=\"mt-2\">\n                <span\n                  onClick={() => {\n                    if (typeof window !== \"undefined\") {\n                      window.location.href = `/users/${currentWork.user?.login}`\n                    }\n                  }}\n                  className=\"flex cursor-pointer items-center space-x-2 transition-colors hover:text-primary\"\n                  role=\"button\"\n                  tabIndex={0}\n                  onKeyDown={(e) => {\n                    if (e.key === \"Enter\" || e.key === \" \") {\n                      e.preventDefault()\n                      if (typeof window !== \"undefined\") {\n                        window.location.href = `/users/${currentWork.user?.login}`\n                      }\n                    }\n                  }}\n                >\n                  <Avatar className=\"size-6\">\n                    <AvatarImage\n                      src={withIconUrlFallback(currentWork.user?.iconUrl)}\n                    />\n                    <AvatarFallback />\n                  </Avatar>\n                  <span className=\"font-medium text-sm\">\n                    {currentWork.user?.name}\n                  </span>\n                </span>\n              </div>\n            </DialogHeader>\n\n            {/* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º */}\n            {isCurrentWorkLoading ? (\n              <div className=\"flex flex-1 items-center justify-center\">\n                <div className=\"flex flex-col items-center space-y-2\">\n                  <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-muted-foreground border-t-transparent\" />\n                  <span className=\"text-muted-foreground text-sm\">\n                    {isDebouncing ? \"å¾…æ©Ÿä¸­...\" : \"èª­ã¿è¾¼ã¿ä¸­...\"}\n                  </span>\n                </div>\n              </div>\n            ) : (\n              <div className=\"flex flex-1 flex-col overflow-hidden\">\n                {/* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ï¼ˆã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ï¼‰ */}\n                <div className=\"flex-1 overflow-y-auto overscroll-y-contain p-4\">\n                  <WorkArticle\n                    work={{\n                      ...currentWork,\n                      isBotGradingEnabled:\n                        (\n                          currentWork as unknown as {\n                            isBotGradingEnabled?: boolean\n                          }\n                        ).isBotGradingEnabled ?? false,\n                      isBotGradingPublic:\n                        (\n                          currentWork as unknown as {\n                            isBotGradingPublic?: boolean\n                          }\n                        ).isBotGradingPublic ?? false,\n                      botEvaluation: ((currentWork as any).botEvaluation ??\n                        null) as any,\n                      user: currentWork.user\n                        ? { ...currentWork.user, works: [] }\n                        : null,\n                      nextWork: null,\n                      previousWork: null,\n                    }}\n                    userSetting={undefined}\n                    mode={\"dialog\"}\n                  />\n                  {/* ã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆãŒæœ‰åŠ¹ãªå ´åˆã®ã¿ï¼‰ */}\n                  {currentWork.isCommentsEditable && (\n                    <div className=\"mt-6\">\n                      <WorkCommentSectionEnhanced\n                        workId={currentWork.id}\n                        workOwnerIconImageURL={withIconUrlFallback(\n                          currentWork.user?.iconUrl,\n                        )}\n                        isWorkOwnerBlocked={\n                          (currentWork as { user?: { isBlocked?: boolean } })\n                            .user?.isBlocked ?? false\n                        }\n                        isFixedInput={true}\n                        comments={\n                          Array.isArray(\n                            (currentWork as unknown as { comments?: unknown[] })\n                              .comments,\n                          )\n                            ? (\n                                currentWork as unknown as {\n                                  comments: unknown[]\n                                }\n                              ).comments.map((c: unknown) => ({\n                                id: (c as { id: string }).id,\n                                text: (c as { text?: string | null }).text,\n                                createdAt: (c as { createdAt: number })\n                                  .createdAt,\n                                likesCount: (c as { likesCount: number })\n                                  .likesCount,\n                                isLiked: (c as { isLiked: boolean }).isLiked,\n                                isWorkOwnerLiked: (\n                                  c as { isWorkOwnerLiked: boolean }\n                                ).isWorkOwnerLiked,\n                                isMuted: (c as { isMuted?: boolean }).isMuted,\n                                isSensitive: (c as { isSensitive?: boolean })\n                                  .isSensitive,\n                                user: (\n                                  c as {\n                                    user?: {\n                                      id: string\n                                      name: string\n                                      iconUrl?: string | null\n                                    }\n                                  }\n                                ).user\n                                  ? {\n                                      id: (c as { user: { id: string } }).user\n                                        .id,\n                                      name:\n                                        (c as { user: { name: string } }).user\n                                          .name || \"\",\n                                      iconUrl: (\n                                        c as {\n                                          user: { iconUrl?: string | null }\n                                        }\n                                      ).user.iconUrl,\n                                    }\n                                  : undefined,\n                                sticker: (\n                                  c as {\n                                    sticker?: {\n                                      id: string\n                                      title: string\n                                      imageUrl?: string | null\n                                      accessType: string\n                                      isDownloaded?: boolean\n                                    }\n                                  }\n                                ).sticker\n                                  ? {\n                                      id:\n                                        (c as { sticker: { id: string } })\n                                          .sticker.id || \"\",\n                                      title:\n                                        (c as { sticker: { title: string } })\n                                          .sticker.title || \"\",\n                                      imageUrl: (\n                                        c as {\n                                          sticker: { imageUrl?: string | null }\n                                        }\n                                      ).sticker.imageUrl,\n                                      accessType:\n                                        (\n                                          c as {\n                                            sticker: { accessType: string }\n                                          }\n                                        ).sticker.accessType || \"PUBLIC\",\n                                      isDownloaded: (\n                                        c as {\n                                          sticker: { isDownloaded?: boolean }\n                                        }\n                                      ).sticker.isDownloaded,\n                                    }\n                                  : undefined,\n                                responses: [],\n                              }))\n                            : []\n                        }\n                      />\n                    </div>\n                  )}\n                </div>\n\n                {/* å›ºå®šã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¨ãƒªã‚¢ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›ï¼‰ */}\n                <div className=\"border-t bg-background/98 backdrop-blur-md\">\n                  {/* å›ºå®šã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›æ¬„ */}\n                  {currentWork.isCommentsEditable && (\n                    <WorkCommentInputFixed\n                      workId={currentWork.id}\n                      isWorkOwnerBlocked={\n                        (currentWork as { user?: { isBlocked?: boolean } }).user\n                          ?.isBlocked ?? false\n                      }\n                      commentsCount={\n                        Array.isArray(\n                          (currentWork as unknown as { comments?: unknown[] })\n                            .comments,\n                        )\n                          ? (currentWork as unknown as { comments: unknown[] })\n                              .comments.length\n                          : 0\n                      }\n                      onCommentAdded={handleCommentAdded}\n                    />\n                  )}\n                </div>\n              </div>\n            )}\n          </aside>\n\n          {/* ã‚µãƒ ãƒã‚¤ãƒ«åˆ— - ã‚¹ãƒãƒ›ã§ã‚‚å¸¸ã«è¡¨ç¤ºï¼ˆå¹…å›ºå®šï¼‰ */}\n          <aside\n            ref={thumbListRef}\n            className=\"ml-auto flex h-full flex-col overflow-y-auto overscroll-y-contain bg-background/80 backdrop-blur-sm\"\n            style={{\n              width: \"5rem\", // å›ºå®šå¹…\n              minWidth: \"5rem\", // æœ€å°å¹…\n              maxWidth: \"5rem\", // æœ€å¤§å¹…\n              scrollbarWidth: \"thin\",\n              display: \"flex\",\n              visibility: \"visible\",\n              opacity: 1,\n            }}\n          >\n            {works.map((w, i) => (\n              <button\n                key={w.id}\n                type=\"button\"\n                className={`relative m-1 rounded-md ring-offset-2 transition-all duration-200 focus:outline-none focus:ring-2 ${\n                  i === index\n                    ? \"bg-primary/10 ring ring-primary\"\n                    : \"hover:bg-background/20\"\n                }`}\n                onClick={() => setIndex(i)}\n              >\n                <img\n                  src={w.smallThumbnailImageURL}\n                  alt={w.title}\n                  className=\"h-16 w-full rounded-md object-cover\"\n                  draggable={false}\n                  loading=\"lazy\"\n                  onLoad={(e) => {\n                    // ç”»åƒèª­ã¿è¾¼ã¿å®Œäº†æ™‚ã«ã‚µãƒ ãƒã‚¤ãƒ«å¹…ã®å®‰å®šåŒ–\n                    const img = e.target as HTMLImageElement\n                    img.style.opacity = \"1\"\n                  }}\n                  onError={(e) => {\n                    // ã‚¨ãƒ©ãƒ¼æ™‚ã‚‚ã‚µã‚¤ã‚ºã‚’ç¶­æŒ\n                    const img = e.target as HTMLImageElement\n                    img.style.opacity = \"0.5\"\n                  }}\n                  style={{\n                    width: \"100%\",\n                    height: \"4rem\",\n                    objectFit: \"cover\",\n                    opacity: 0,\n                    transition: \"opacity 0.3s ease-in-out\",\n                  }}\n                />\n                {/* ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¸ˆã¿ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */}\n                {loadedWorkIds.has(w.id) && (\n                  <div className=\"absolute top-1 right-1 h-2 w-2 rounded-full bg-green-400 shadow-sm\" />\n                )}\n                {/* ãƒ‡ãƒã‚¦ãƒ³ã‚¹ä¸­ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */}\n                {isDebouncing && i === index && (\n                  <div className=\"absolute top-1 left-1 h-2 w-2 animate-pulse rounded-full bg-yellow-400 shadow-sm\" />\n                )}\n              </button>\n            ))}\n\n            {/* sentinel & spinner */}\n            {isLoadingMore && (\n              <div className=\"flex justify-center py-2\">\n                <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-muted-foreground border-t-transparent\" />\n              </div>\n            )}\n            <div ref={sentinelRef} className=\"h-[2px] w-full\" />\n          </aside>\n        </div>\n        {/* ã„ã„ã­ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ - ãƒ•ãƒ«å¹…æœ‰åŠ¹é ˜åŸŸ */}\n        <div className=\"border-t bg-background/95 backdrop-blur-sm\">\n          <div className=\"w-full\">\n            <WorkActionContainer\n              workLikesCount={currentWork.likesCount}\n              title={currentWork.title}\n              description={\n                (currentWork.description?.length ?? 0) > 100\n                  ? `${currentWork.description?.slice(0, 100)}...`\n                  : (currentWork.description ?? \"\")\n              }\n              currentImageUrl={currentWork.imageURL}\n              imageUrls={[\n                currentWork.imageURL,\n                ...(currentWork.subWorks || []).map(\n                  (subWork) => subWork.imageUrl ?? \"\",\n                ),\n              ]}\n              targetWorkId={currentWork.id}\n              bookmarkFolderId={null}\n              targetWorkOwnerUserId={currentWork.user?.id ?? \"\"}\n              isDisabledShare={false}\n              isTargetUserBlocked={Boolean(currentWork.user?.isBlocked)}\n              mode=\"dialogLikeOnly\"\n            />\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n// GraphQLéƒ¨åˆ†ã¯å¤‰æ›´ãªã—\nexport const workArticleFragment =\n  graphql(`fragment WorkArticle on WorkNode @_unmask {\n  id\n  isMyRecommended\n  title\n  mdUrl\n  accessType\n  type\n  adminAccessType\n  promptAccessType\n  rating\n  description\n  isSensitive\n  enTitle\n  enDescription\n  imageURL\n  largeThumbnailImageURL\n  largeThumbnailImageWidth\n  largeThumbnailImageHeight\n  smallThumbnailImageURL\n  smallThumbnailImageWidth\n  smallThumbnailImageHeight\n  thumbnailImagePosition\n  subWorksCount\n  url\n  isDeleted\n  user {\n    id\n    biography\n    enBiography\n    login\n    nanoid\n    name\n    receivedLikesCount\n    receivedViewsCount\n    awardsCount\n    followersCount\n    worksCount\n    iconUrl\n    headerImageUrl\n    webFcmToken\n    isFollower\n    isFollowee\n    headerImageUrl\n    receivedLikesCount\n    createdLikesCount\n    createdBookmarksCount\n    isMuted\n    promptonUser {\n      id\n    }\n  }\n  likedUsers(offset: 0, limit: 8) {\n    id\n    name\n    iconUrl\n    login\n  }\n  dailyTheme {\n    id\n    title\n    dateText\n  }\n  tagNames\n  createdAt\n  likesCount\n  viewsCount\n  commentsCount\n  subWorks {\n    id\n    imageUrl\n  }\n  model\n  modelHash\n  generationModelId\n  workModelId\n  isTagEditable\n  isCommentsEditable\n  isLiked\n  isBookmarked\n  isInCollection\n  isPromotion\n  isGeneration\n  ogpThumbnailImageUrl\n  prompt\n  negativePrompt\n  noise\n  seed\n  steps\n  sampler\n  scale\n  strength\n  vae\n  clipSkip\n  otherGenerationParams\n  pngInfo\n  style\n  url\n  updatedAt\n  dailyRanking\n  weeklyRanking\n  monthlyRanking\n  relatedUrl\n  nanoid\n  isBotGradingEnabled\n  isBotGradingPublic\n  botEvaluation {\n    cutenessScore\n    coolnessScore\n    beautyScore\n    originalityScore\n    compositionScore\n    colorScore\n    detailScore\n    consistencyScore\n    overallScore\n    comment\n    personality\n  }\n}`)\n\nexport const WorkCommentFragment =\n  graphql(`fragment WorkComment on CommentNode @_unmask {\n  id\n  createdAt\n  text\n  likesCount\n  isWorkOwnerLiked\n  isLiked\n  user {\n    id\n    name\n    login\n    iconUrl\n    nanoid\n  }\n  sticker {\n    id\n    imageUrl\n    title\n    isDownloaded\n    likesCount\n    usesCount\n    downloadsCount\n    accessType\n  }\n}`)\n\nconst workDialogQuery = graphql(\n  `query WorkDialog($workId: ID!) {\n    work(id: $workId) {\n      ...WorkArticle\n      comments(offset: 0, limit: 128) {\n        ...WorkComment\n      }\n      user {\n        iconUrl\n      }\n    }\n    viewer {\n      id\n    }\n  }`,\n  [workArticleFragment, WorkCommentFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/suspicious/noDocumentCookie","severity":"warning","description":"Direct assigning to document.cookie is not recommended.","message":[{"elements":[],"content":"Direct assigning to "},{"elements":["Emphasis"],"content":"document.cookie"},{"elements":[],"content":" is not recommended."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Consider using the "},{"elements":[{"Hyperlink":{"href":"https://developer.mozilla.org/en-US/docs/Web/API/CookieStore"}}],"content":"Cookie Store API"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/lib/cookie-utils.ts"},"span":[1032,1062],"sourceCode":"/**\n * å®‰å…¨ãªCookieæ“ä½œãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£\n */\n\nexport type CookieOptions = {\n  expires?: Date\n  maxAge?: number\n  path?: string\n  domain?: string\n  secure?: boolean\n  sameSite?: \"strict\" | \"lax\" | \"none\"\n}\n\n/**\n * Cookieã‚’è¨­å®šã™ã‚‹\n */\nexport function setCookie(\n  name: string,\n  value: string,\n  options: CookieOptions = {},\n): boolean {\n  try {\n    if (typeof document === \"undefined\") {\n      return false\n    }\n\n    const {\n      expires,\n      maxAge,\n      path = \"/\",\n      domain,\n      secure = true,\n      sameSite = \"strict\",\n    } = options\n\n    let cookieString = `${encodeURIComponent(name)}=${encodeURIComponent(value)}`\n\n    if (expires) {\n      cookieString += `; expires=${expires.toUTCString()}`\n    }\n\n    if (maxAge !== undefined) {\n      cookieString += `; max-age=${maxAge}`\n    }\n\n    cookieString += `; path=${path}`\n\n    if (domain) {\n      cookieString += `; domain=${domain}`\n    }\n\n    if (secure) {\n      cookieString += \"; secure\"\n    }\n\n    cookieString += `; samesite=${sameSite}`\n\n    document.cookie = cookieString\n    return true\n  } catch (error) {\n    console.error(\"Cookieè¨­å®šã‚¨ãƒ©ãƒ¼:\", error)\n    return false\n  }\n}\n\n/**\n * Cookieã‚’å–å¾—ã™ã‚‹\n */\nexport function getCookie(name: string): string | null {\n  try {\n    if (typeof document === \"undefined\") {\n      return null\n    }\n\n    const value = `; ${document.cookie}`\n    const parts = value.split(`; ${encodeURIComponent(name)}=`)\n\n    if (parts.length === 2) {\n      const cookieValue = parts.pop()?.split(\";\").shift()\n      return cookieValue ? decodeURIComponent(cookieValue) : null\n    }\n\n    return null\n  } catch (error) {\n    console.error(\"Cookieå–å¾—ã‚¨ãƒ©ãƒ¼:\", error)\n    return null\n  }\n}\n\n/**\n * CookieãŒå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯\n */\nexport function hasCookie(name: string): boolean {\n  return getCookie(name) !== null\n}\n\n/**\n * Cookieã‚’å‰Šé™¤ã™ã‚‹\n */\nexport function deleteCookie(name: string, path = \"/\"): boolean {\n  try {\n    if (typeof document === \"undefined\") {\n      return false\n    }\n\n    document.cookie = `${encodeURIComponent(name)}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=${path}`\n    return true\n  } catch (error) {\n    console.error(\"Cookieå‰Šé™¤ã‚¨ãƒ©ãƒ¼:\", error)\n    return false\n  }\n}\n"},"tags":[],"source":null},{"category":"lint/suspicious/noDocumentCookie","severity":"warning","description":"Direct assigning to document.cookie is not recommended.","message":[{"elements":[],"content":"Direct assigning to "},{"elements":["Emphasis"],"content":"document.cookie"},{"elements":[],"content":" is not recommended."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Consider using the "},{"elements":[{"Hyperlink":{"href":"https://developer.mozilla.org/en-US/docs/Web/API/CookieStore"}}],"content":"Cookie Store API"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/lib/cookie-utils.ts"},"span":[2033,2134],"sourceCode":"/**\n * å®‰å…¨ãªCookieæ“ä½œãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£\n */\n\nexport type CookieOptions = {\n  expires?: Date\n  maxAge?: number\n  path?: string\n  domain?: string\n  secure?: boolean\n  sameSite?: \"strict\" | \"lax\" | \"none\"\n}\n\n/**\n * Cookieã‚’è¨­å®šã™ã‚‹\n */\nexport function setCookie(\n  name: string,\n  value: string,\n  options: CookieOptions = {},\n): boolean {\n  try {\n    if (typeof document === \"undefined\") {\n      return false\n    }\n\n    const {\n      expires,\n      maxAge,\n      path = \"/\",\n      domain,\n      secure = true,\n      sameSite = \"strict\",\n    } = options\n\n    let cookieString = `${encodeURIComponent(name)}=${encodeURIComponent(value)}`\n\n    if (expires) {\n      cookieString += `; expires=${expires.toUTCString()}`\n    }\n\n    if (maxAge !== undefined) {\n      cookieString += `; max-age=${maxAge}`\n    }\n\n    cookieString += `; path=${path}`\n\n    if (domain) {\n      cookieString += `; domain=${domain}`\n    }\n\n    if (secure) {\n      cookieString += \"; secure\"\n    }\n\n    cookieString += `; samesite=${sameSite}`\n\n    document.cookie = cookieString\n    return true\n  } catch (error) {\n    console.error(\"Cookieè¨­å®šã‚¨ãƒ©ãƒ¼:\", error)\n    return false\n  }\n}\n\n/**\n * Cookieã‚’å–å¾—ã™ã‚‹\n */\nexport function getCookie(name: string): string | null {\n  try {\n    if (typeof document === \"undefined\") {\n      return null\n    }\n\n    const value = `; ${document.cookie}`\n    const parts = value.split(`; ${encodeURIComponent(name)}=`)\n\n    if (parts.length === 2) {\n      const cookieValue = parts.pop()?.split(\";\").shift()\n      return cookieValue ? decodeURIComponent(cookieValue) : null\n    }\n\n    return null\n  } catch (error) {\n    console.error(\"Cookieå–å¾—ã‚¨ãƒ©ãƒ¼:\", error)\n    return null\n  }\n}\n\n/**\n * CookieãŒå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯\n */\nexport function hasCookie(name: string): boolean {\n  return getCookie(name) !== null\n}\n\n/**\n * Cookieã‚’å‰Šé™¤ã™ã‚‹\n */\nexport function deleteCookie(name: string, path = \"/\"): boolean {\n  try {\n    if (typeof document === \"undefined\") {\n      return false\n    }\n\n    document.cookie = `${encodeURIComponent(name)}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=${path}`\n    return true\n  } catch (error) {\n    console.error(\"Cookieå‰Šé™¤ã‚¨ãƒ©ãƒ¼:\", error)\n    return false\n  }\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/lib/throttle.ts"},"span":[47,60],"sourceCode":"// biome-ignore lint/suspicious/noExplicitAny: <explanation>\nexport function throttle<T extends (...args: any[]) => any>(\n  func: T,\n  timeFrame: number,\n): (...args: Parameters<T>) => void {\n  let lastTime = 0\n  return (...args: Parameters<T>): void => {\n    const now = performance.now()\n    if (now - lastTime >= timeFrame) {\n      func(...args)\n      lastTime = now\n    }\n  }\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.$user.albums.$album._index/components/album-article-editor-dialog.tsx"},"span":[2590,2943],"sourceCode":"import { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { Button } from \"~/components/ui/button\"\nimport {\n  Dialog,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from \"~/components/ui/dialog\"\nimport { SelectCreatedWorksDialogWithIds } from \"~/routes/($lang).my._index/components/select-created-works-dialog-with-ids\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\nimport { Loader2Icon } from \"lucide-react\"\nimport { useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  album: FragmentOf<typeof AlbumArticleEditorDialogFragment>\n  thumbnail?: string\n  children: React.ReactNode\n  userNanoid: string\n}\n\nexport function AlbumArticleEditorDialog (props: Props) {\n  const t = useTranslation()\n\n  const [selectedWorks, setSelectedWorks] = useState<string[]>(\n    props.album.workIds.map((work) => work.toString()),\n  )\n\n  const [title, setTitle] = useState(props.album.title)\n\n  const [description, setDescription] = useState(props.album.description)\n\n  const [updateAlbum, { loading: isUpdating }] =\n    useMutation(updateAlbumMutation)\n\n  const onSubmit = async () => {\n    if (title.length === 0) {\n      toast.error(t(\"ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a title\"))\n      return\n    }\n\n    if (description.length === 0) {\n      toast.error(t(\"èª¬æ˜ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a description\"))\n      return\n    }\n\n    if (props.userNanoid === null) {\n      toast(\n        t(\"ç”»é¢æ›´æ–°ã—ã¦å†åº¦ãŠè©¦ã—ä¸‹ã•ã„ã€‚\", \"Please refresh and try again.\"),\n      )\n      return null\n    }\n\n    await updateAlbum({\n      variables: {\n        input: {\n          albumId: props.album.id,\n          title: title,\n          description: description,\n          ...(selectedWorks && { workIds: selectedWorks }),\n        },\n      },\n    })\n\n    toast(t(\"ã‚·ãƒªãƒ¼ã‚ºã‚’æ›´æ–°ã—ã¾ã—ãŸ\", \"Album updated successfully\"))\n  }\n\n  return (\n    <Dialog>\n      <DialogTrigger asChild>{props.children}</DialogTrigger>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>{t(\"ã‚·ãƒªãƒ¼ã‚ºæ›´æ–°\", \"Update Album\")}</DialogTitle>\n        </DialogHeader>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"nickname\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"title\"\n            maxLength={32}\n            minLength={1}\n            value={title}\n            onChange={(e) => setTitle(e.target.value)}\n            className=\"rounded-md border px-2 py-1\"\n            defaultValue=\"Aipictors/AIã‚¤ãƒ©ã‚¹ãƒˆæŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIå°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIçµµ\"\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"enProfile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"èª¬æ˜\", \"Description\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"enProfile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={640}\n            value={description}\n            onChange={(e) => setDescription(e.target.value)}\n          />\n        </div>\n        <p className=\"font-medium text-sm \">\n          {t(\"é¸æŠä¸­ã®ä½œå“\", \"Selected works\")}ï¼ˆ{selectedWorks.length}ï¼‰\n        </p>\n        <SelectCreatedWorksDialogWithIds\n          selectedWorkIds={selectedWorks}\n          setSelectedWorkIds={setSelectedWorks}\n        />\n\n        <DialogFooter>\n          <Button disabled={isUpdating} className=\"w-full\" onClick={onSubmit}>\n            {isUpdating ? (\n              <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n            ) : (\n              t(\"æ›´æ–°ã™ã‚‹\", \"Update\")\n            )}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nexport const AlbumArticleEditorDialogFragment = graphql(\n  `fragment AlbumArticleEditorDialog on AlbumNode @_unmask {\n    id\n    title\n    description\n    user {\n      id\n      name\n      login\n      iconUrl\n      nanoid\n    }\n    createdAt\n    isSensitive\n    thumbnailImageURL\n    slug\n    worksCount\n    workIds\n  }`,\n)\n\nconst updateAlbumMutation = graphql(\n  `mutation UpdateAlbum($input: UpdateAlbumInput!) {\n    updateAlbum(input: $input) {\n      id\n      title\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.$user.albums.$album._index/components/album-article-editor-dialog.tsx"},"span":[3271,3503],"sourceCode":"import { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { Button } from \"~/components/ui/button\"\nimport {\n  Dialog,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from \"~/components/ui/dialog\"\nimport { SelectCreatedWorksDialogWithIds } from \"~/routes/($lang).my._index/components/select-created-works-dialog-with-ids\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\nimport { Loader2Icon } from \"lucide-react\"\nimport { useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  album: FragmentOf<typeof AlbumArticleEditorDialogFragment>\n  thumbnail?: string\n  children: React.ReactNode\n  userNanoid: string\n}\n\nexport function AlbumArticleEditorDialog (props: Props) {\n  const t = useTranslation()\n\n  const [selectedWorks, setSelectedWorks] = useState<string[]>(\n    props.album.workIds.map((work) => work.toString()),\n  )\n\n  const [title, setTitle] = useState(props.album.title)\n\n  const [description, setDescription] = useState(props.album.description)\n\n  const [updateAlbum, { loading: isUpdating }] =\n    useMutation(updateAlbumMutation)\n\n  const onSubmit = async () => {\n    if (title.length === 0) {\n      toast.error(t(\"ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a title\"))\n      return\n    }\n\n    if (description.length === 0) {\n      toast.error(t(\"èª¬æ˜ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a description\"))\n      return\n    }\n\n    if (props.userNanoid === null) {\n      toast(\n        t(\"ç”»é¢æ›´æ–°ã—ã¦å†åº¦ãŠè©¦ã—ä¸‹ã•ã„ã€‚\", \"Please refresh and try again.\"),\n      )\n      return null\n    }\n\n    await updateAlbum({\n      variables: {\n        input: {\n          albumId: props.album.id,\n          title: title,\n          description: description,\n          ...(selectedWorks && { workIds: selectedWorks }),\n        },\n      },\n    })\n\n    toast(t(\"ã‚·ãƒªãƒ¼ã‚ºã‚’æ›´æ–°ã—ã¾ã—ãŸ\", \"Album updated successfully\"))\n  }\n\n  return (\n    <Dialog>\n      <DialogTrigger asChild>{props.children}</DialogTrigger>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>{t(\"ã‚·ãƒªãƒ¼ã‚ºæ›´æ–°\", \"Update Album\")}</DialogTitle>\n        </DialogHeader>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"nickname\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"title\"\n            maxLength={32}\n            minLength={1}\n            value={title}\n            onChange={(e) => setTitle(e.target.value)}\n            className=\"rounded-md border px-2 py-1\"\n            defaultValue=\"Aipictors/AIã‚¤ãƒ©ã‚¹ãƒˆæŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIå°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIçµµ\"\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"enProfile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"èª¬æ˜\", \"Description\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"enProfile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={640}\n            value={description}\n            onChange={(e) => setDescription(e.target.value)}\n          />\n        </div>\n        <p className=\"font-medium text-sm \">\n          {t(\"é¸æŠä¸­ã®ä½œå“\", \"Selected works\")}ï¼ˆ{selectedWorks.length}ï¼‰\n        </p>\n        <SelectCreatedWorksDialogWithIds\n          selectedWorkIds={selectedWorks}\n          setSelectedWorkIds={setSelectedWorks}\n        />\n\n        <DialogFooter>\n          <Button disabled={isUpdating} className=\"w-full\" onClick={onSubmit}>\n            {isUpdating ? (\n              <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n            ) : (\n              t(\"æ›´æ–°ã™ã‚‹\", \"Update\")\n            )}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nexport const AlbumArticleEditorDialogFragment = graphql(\n  `fragment AlbumArticleEditorDialog on AlbumNode @_unmask {\n    id\n    title\n    description\n    user {\n      id\n      name\n      login\n      iconUrl\n      nanoid\n    }\n    createdAt\n    isSensitive\n    thumbnailImageURL\n    slug\n    worksCount\n    workIds\n  }`,\n)\n\nconst updateAlbumMutation = graphql(\n  `mutation UpdateAlbum($input: UpdateAlbumInput!) {\n    updateAlbum(input: $input) {\n      id\n      title\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/suspicious/noDocumentCookie","severity":"warning","description":"Direct assigning to document.cookie is not recommended.","message":[{"elements":[],"content":"Direct assigning to "},{"elements":["Emphasis"],"content":"document.cookie"},{"elements":[],"content":" is not recommended."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Consider using the "},{"elements":[{"Hyperlink":{"href":"https://developer.mozilla.org/en-US/docs/Web/API/CookieStore"}}],"content":"Cookie Store API"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main._index/components/home-header-not-logged-in-menu.tsx"},"span":[2735,2780],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuSub,\n  DropdownMenuSubTrigger,\n  DropdownMenuPortal,\n  DropdownMenuSubContent,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuRadioGroup,\n  DropdownMenuRadioItem,\n} from \"~/components/ui/dropdown-menu\"\nimport {\n  EllipsisVerticalIcon,\n  Languages,\n  MoonIcon,\n  SettingsIcon,\n  SunIcon,\n} from \"lucide-react\"\nimport { useContext } from \"react\"\nimport { useTheme } from \"next-themes\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { LoginDialogButton } from \"~/components/login-dialog-button\"\nimport { useLocale } from \"~/hooks/use-locale\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { useNavigate } from \"@remix-run/react\"\n\nexport const HomeHeaderNotLoggedInMenu = () => {\n  const authContext = useContext(AuthContext)\n\n  const { theme, setTheme } = useTheme()\n\n  const navigate = useNavigate()\n\n  const setColorTheme = (newMode: string) => {\n    if (newMode === \"system\") {\n      setTheme(newMode)\n      return\n    }\n    if ((theme === \"system\" || theme === \"dark\") && newMode === \"light\") {\n      setTheme(newMode)\n      return\n    }\n    if ((theme === \"system\" || theme === \"light\") && newMode === \"dark\") {\n      setTheme(newMode)\n      return\n    }\n    // ãƒ†ãƒ¼ãƒé©ç”¨ä¸­â†’\"light-blue\"ã€\"dark-blue\"ç­‰åŒè‰²ã§ã®ãƒ€ãƒ¼ã‚¯ã€ãƒ©ã‚¤ãƒˆåˆ‡ã‚Šæ›¿ãˆ\n    const suffix = theme?.replace(/(light|dark)-/, \"-\")\n    const colorSuffix = suffix ?? \"\"\n    setTheme(newMode + colorSuffix)\n  }\n  const setMode = (theme: string) => {\n    if (theme === \"system\" || theme === \"light\" || theme === \"dark\") {\n      return theme\n    }\n    if (theme.startsWith(\"light-\")) {\n      return \"light\"\n    }\n    if (theme.startsWith(\"dark-\")) {\n      return \"dark\"\n    }\n    return \"system\"\n  }\n  const mode = setMode(theme ? theme?.toString() : \"system\")\n\n  const getThemeIcon = () => {\n    return theme?.endsWith(\"dark\") ? (\n      <MoonIcon className=\"mr-2 inline-block w-4\" />\n    ) : (\n      <SunIcon className=\"mr-2 inline-block w-4\" />\n    )\n  }\n\n  const t = useTranslation()\n\n  const locale = useLocale()\n\n  // const isSensitiveToggleVisible = location.pathname !== \"/generation\"\n\n  // R18ãƒ¢ãƒ¼ãƒ‰ã®çŠ¶æ…‹ã‚’æ¤œå‡º\n  const _isR18Mode = /\\/r($|\\/)/.test(location.pathname)\n\n  const setLocale = (locale: string) => {\n    // URLã®å…ˆé ­ã«ã‚ã‚‹ /ja ã¾ãŸã¯ /en ã‚’æ­£ã—ãæ¤œå‡º\n    const currentLocale = location.pathname.match(/^\\/(ja|en)(\\/|$)/)?.[1] || \"\"\n\n    // ç¾åœ¨ã®ãƒ­ã‚±ãƒ¼ãƒ«éƒ¨åˆ†ã‚’å‰Šé™¤ã—ãŸURLã®ãƒ™ãƒ¼ã‚¹ãƒ‘ã‚¹ã‚’å–å¾—\n    const basePath = location.pathname.replace(/^\\/(ja|en)(\\/|$)/, \"/\")\n\n    // ã‚¯ãƒƒã‚­ãƒ¼ã«ãƒ­ã‚±ãƒ¼ãƒ«ã‚’ä¿å­˜\n    document.cookie = `locale=${locale}; path=/;`\n\n    // æ–°ã—ã„URLã‚’æ¡ä»¶ã«å¿œã˜ã¦è¨­å®š\n    const newUrl =\n      locale === \"ja\" && currentLocale\n        ? basePath // æ—¥æœ¬èªã®å ´åˆã¯ãƒ­ã‚±ãƒ¼ãƒ«ã‚’å‰Šé™¤ã—ã¦ãƒ™ãƒ¼ã‚¹ãƒ‘ã‚¹ã‚’ä½¿ç”¨\n        : locale !== \"ja\" && currentLocale\n          ? location.pathname.replace(`/${currentLocale}`, `/${locale}`) // è‹±èªã®å ´åˆã¯ãƒ­ã‚±ãƒ¼ãƒ«ã‚’ç½®ãæ›ãˆ\n          : `/${locale}${basePath}` // æ–°ã—ã„ãƒ­ã‚±ãƒ¼ãƒ«ã‚’è¿½åŠ \n\n    // navigateã‚’ä½¿ç”¨ã—ã¦URLã‚’å¤‰æ›´\n    if (location.pathname !== newUrl) {\n      navigate(newUrl)\n    }\n  }\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <Button variant={\"ghost\"} size={\"icon\"}>\n          <EllipsisVerticalIcon className=\"w-16\" />\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent>\n        <DropdownMenuSub>\n          <DropdownMenuSubTrigger>\n            {getThemeIcon()}\n            {t(\"ãƒ†ãƒ¼ãƒ\", \"theme\")}\n          </DropdownMenuSubTrigger>\n          <DropdownMenuSub>\n            <DropdownMenuSubTrigger>\n              <Languages className=\"mr-2 inline-block w-4\" />\n              {t(\"è¨€èª/Language\", \"è¨€èª/Language\")}\n            </DropdownMenuSubTrigger>\n            <DropdownMenuPortal>\n              <DropdownMenuSubContent>\n                <DropdownMenuLabel>\n                  {t(\"è¨€èªå¤‰æ›´\", \"Change Language\")}\n                </DropdownMenuLabel>\n                <DropdownMenuSeparator />\n                <DropdownMenuRadioGroup\n                  value={locale}\n                  onValueChange={(newLocale) => {\n                    setLocale(newLocale)\n                  }}\n                >\n                  <DropdownMenuRadioItem value=\"ja\">\n                    {t(\"æ—¥æœ¬èª\", \"æ—¥æœ¬èª\")}\n                  </DropdownMenuRadioItem>\n                  <DropdownMenuRadioItem value=\"en\">\n                    {t(\"English\", \"English\")}\n                  </DropdownMenuRadioItem>\n                </DropdownMenuRadioGroup>\n              </DropdownMenuSubContent>\n            </DropdownMenuPortal>\n          </DropdownMenuSub>\n          <DropdownMenuPortal>\n            <DropdownMenuSubContent>\n              <DropdownMenuLabel>{\"ãƒ†ãƒ¼ãƒå¤‰æ›´\"}</DropdownMenuLabel>\n              <DropdownMenuSeparator />\n              <DropdownMenuRadioGroup\n                value={mode}\n                onValueChange={(newMode) => {\n                  setColorTheme(newMode)\n                }}\n              >\n                <DropdownMenuRadioItem value=\"system\">\n                  ãƒ‡ãƒã‚¤ã‚¹ãƒ¢ãƒ¼ãƒ‰ä½¿ç”¨\n                </DropdownMenuRadioItem>\n                <DropdownMenuRadioItem value=\"light\">\n                  ãƒ©ã‚¤ãƒˆ\n                </DropdownMenuRadioItem>\n                <DropdownMenuRadioItem value=\"dark\">\n                  ãƒ€ãƒ¼ã‚¯\n                </DropdownMenuRadioItem>\n              </DropdownMenuRadioGroup>\n              <LoginDialogButton\n                label=\"ã‚«ãƒ©ãƒ¼ã®è¨­å®š\"\n                isLoading={authContext.isLoading || authContext.isLoggedIn}\n                isWidthFull={true}\n                description={\"ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã€ã‚«ãƒ©ãƒ¼ã®è¨­å®šã‚’å¤‰æ›´ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼\"}\n                triggerChildren={\n                  <div className=\"cursor-pointer px-2\">\n                    <SettingsIcon className=\"mr-2 inline-block w-4\" />\n                    <span>{\"ãã®ä»–ã®ã‚«ãƒ©ãƒ¼\"}</span>\n                  </div>\n                }\n              />\n            </DropdownMenuSubContent>\n          </DropdownMenuPortal>\n        </DropdownMenuSub>\n        {/* {isSensitiveToggleVisible && <DropdownMenuSeparator />}\n        {isSensitiveToggleVisible && (\n          <div className=\"px-2 py-1.5\">\n            <SensitiveToggle variant=\"compact\" className=\"w-full\" />\n          </div>\n        )} */}\n      </DropdownMenuContent>\n    </DropdownMenu>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main._index/components/home-messages-contents.tsx"},"span":[903,916],"sourceCode":"import { useSuspenseQuery } from \"@apollo/client/index\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { graphql } from \"gql.tada\"\nimport { useContext } from \"react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { MessageListItemFragment } from \"~/routes/($lang)._main.support.chat/components/support-message-list\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { Avatar, AvatarImage, AvatarFallback } from \"~/components/ui/avatar\"\nimport { Link } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = { onClick?: () => void }\n\n/**\n * ãƒ˜ãƒƒãƒ€ãƒ¼ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§å†…å®¹\n */\nexport function HomeMessagesContents ({ onClick }: Props) {\n  const authContext = useContext(AuthContext)\n\n  if (authContext.userId === null) {\n    return null\n  }\n\n  // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n  const { data: supportMessages, refetch } = useSuspenseQuery(MessagesQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      limit: 10,\n      offset: 0,\n    },\n  })\n\n  const messages = supportMessages?.viewer?.supportMessages ?? []\n\n  // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n  const t = useTranslation()\n\n  if (messages.length === 0) {\n    return (\n      <>\n        <div className=\"m-auto\">\n          <img\n            alt=\"sorry-image\"\n            className=\"m-auto w-48 md:w-64\"\n            src=\"https://pub-c8b482e79e9f4e7ab4fc35d3eb5ecda8.r2.dev/pictor-chan-sorry-image.png\"\n          />\n          <p className=\"text-center text-xl opacity-60\">\n            {t(\"é€šçŸ¥ã¯ã‚ã‚Šã¾ã›ã‚“\", \"There are no notifications\")}\n          </p>\n        </div>\n      </>\n    )\n  }\n\n  return (\n    <ScrollArea className=\"h-64 overflow-y-auto md:h-96\">\n      <div className=\"flex max-w-96 flex-col space-y-1 overflow-hidden p-1\">\n        {messages.map((message) => (\n          <Link\n            to={\"/support/chat\"}\n            key={message.id.toString()}\n            className=\"flex items-center space-x-2\"\n            onClick={onClick}\n          >\n            <Avatar>\n              <AvatarImage\n                className=\"rounded-full\"\n                src={withIconUrlFallback(message.user.iconUrl)}\n                alt=\"\"\n              />\n              <AvatarFallback />\n            </Avatar>\n            <p>{message.text}</p>\n          </Link>\n        ))}\n      </div>\n    </ScrollArea>\n  )\n}\n\nconst MessagesQuery = graphql(\n  `query ViewerSupportMessages($offset: Int!, $limit: Int!) {\n    viewer {\n      id\n      supportMessages(offset: $offset, limit: $limit) {\n        id\n        ...MessageListItem\n      }\n    }\n  }`,\n  [MessageListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main._index/components/home-messages-contents.tsx"},"span":[1243,1256],"sourceCode":"import { useSuspenseQuery } from \"@apollo/client/index\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { graphql } from \"gql.tada\"\nimport { useContext } from \"react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { MessageListItemFragment } from \"~/routes/($lang)._main.support.chat/components/support-message-list\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { Avatar, AvatarImage, AvatarFallback } from \"~/components/ui/avatar\"\nimport { Link } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = { onClick?: () => void }\n\n/**\n * ãƒ˜ãƒƒãƒ€ãƒ¼ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§å†…å®¹\n */\nexport function HomeMessagesContents ({ onClick }: Props) {\n  const authContext = useContext(AuthContext)\n\n  if (authContext.userId === null) {\n    return null\n  }\n\n  // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n  const { data: supportMessages, refetch } = useSuspenseQuery(MessagesQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      limit: 10,\n      offset: 0,\n    },\n  })\n\n  const messages = supportMessages?.viewer?.supportMessages ?? []\n\n  // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n  const t = useTranslation()\n\n  if (messages.length === 0) {\n    return (\n      <>\n        <div className=\"m-auto\">\n          <img\n            alt=\"sorry-image\"\n            className=\"m-auto w-48 md:w-64\"\n            src=\"https://pub-c8b482e79e9f4e7ab4fc35d3eb5ecda8.r2.dev/pictor-chan-sorry-image.png\"\n          />\n          <p className=\"text-center text-xl opacity-60\">\n            {t(\"é€šçŸ¥ã¯ã‚ã‚Šã¾ã›ã‚“\", \"There are no notifications\")}\n          </p>\n        </div>\n      </>\n    )\n  }\n\n  return (\n    <ScrollArea className=\"h-64 overflow-y-auto md:h-96\">\n      <div className=\"flex max-w-96 flex-col space-y-1 overflow-hidden p-1\">\n        {messages.map((message) => (\n          <Link\n            to={\"/support/chat\"}\n            key={message.id.toString()}\n            className=\"flex items-center space-x-2\"\n            onClick={onClick}\n          >\n            <Avatar>\n              <AvatarImage\n                className=\"rounded-full\"\n                src={withIconUrlFallback(message.user.iconUrl)}\n                alt=\"\"\n              />\n              <AvatarFallback />\n            </Avatar>\n            <p>{message.text}</p>\n          </Link>\n        ))}\n      </div>\n    </ScrollArea>\n  )\n}\n\nconst MessagesQuery = graphql(\n  `query ViewerSupportMessages($offset: Int!, $limit: Int!) {\n    viewer {\n      id\n      supportMessages(offset: $offset, limit: $limit) {\n        id\n        ...MessageListItem\n      }\n    }\n  }`,\n  [MessageListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable refetch is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"refetch"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main._index/components/home-messages-contents.tsx"},"span":[950,957],"sourceCode":"import { useSuspenseQuery } from \"@apollo/client/index\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { graphql } from \"gql.tada\"\nimport { useContext } from \"react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { MessageListItemFragment } from \"~/routes/($lang)._main.support.chat/components/support-message-list\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { Avatar, AvatarImage, AvatarFallback } from \"~/components/ui/avatar\"\nimport { Link } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = { onClick?: () => void }\n\n/**\n * ãƒ˜ãƒƒãƒ€ãƒ¼ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§å†…å®¹\n */\nexport function HomeMessagesContents ({ onClick }: Props) {\n  const authContext = useContext(AuthContext)\n\n  if (authContext.userId === null) {\n    return null\n  }\n\n  // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n  const { data: supportMessages, refetch } = useSuspenseQuery(MessagesQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      limit: 10,\n      offset: 0,\n    },\n  })\n\n  const messages = supportMessages?.viewer?.supportMessages ?? []\n\n  // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n  const t = useTranslation()\n\n  if (messages.length === 0) {\n    return (\n      <>\n        <div className=\"m-auto\">\n          <img\n            alt=\"sorry-image\"\n            className=\"m-auto w-48 md:w-64\"\n            src=\"https://pub-c8b482e79e9f4e7ab4fc35d3eb5ecda8.r2.dev/pictor-chan-sorry-image.png\"\n          />\n          <p className=\"text-center text-xl opacity-60\">\n            {t(\"é€šçŸ¥ã¯ã‚ã‚Šã¾ã›ã‚“\", \"There are no notifications\")}\n          </p>\n        </div>\n      </>\n    )\n  }\n\n  return (\n    <ScrollArea className=\"h-64 overflow-y-auto md:h-96\">\n      <div className=\"flex max-w-96 flex-col space-y-1 overflow-hidden p-1\">\n        {messages.map((message) => (\n          <Link\n            to={\"/support/chat\"}\n            key={message.id.toString()}\n            className=\"flex items-center space-x-2\"\n            onClick={onClick}\n          >\n            <Avatar>\n              <AvatarImage\n                className=\"rounded-full\"\n                src={withIconUrlFallback(message.user.iconUrl)}\n                alt=\"\"\n              />\n              <AvatarFallback />\n            </Avatar>\n            <p>{message.text}</p>\n          </Link>\n        ))}\n      </div>\n    </ScrollArea>\n  )\n}\n\nconst MessagesQuery = graphql(\n  `query ViewerSupportMessages($offset: Int!, $limit: Int!) {\n    viewer {\n      id\n      supportMessages(offset: $offset, limit: $limit) {\n        id\n        ...MessageListItem\n      }\n    }\n  }`,\n  [MessageListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main._index/components/home-novels-works-section.tsx"},"span":[1238,1251],"sourceCode":"import { CarouselWithGradation } from \"~/components/carousel-with-gradation\"\nimport { LikeButton } from \"~/components/like-button\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport { NovelWorkPreviewItem } from \"~/routes/($lang)._main._index/components/video-work-preview-item\"\nimport { UserNameBadge } from \"~/routes/($lang)._main._index/components/user-name-badge\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\n\ntype Props = {\n  works: FragmentOf<typeof HomeNovelsWorkListItemFragment>[]\n  title?: string\n  tooltip?: string\n  link?: string\n  isCropped?: boolean\n  onSelect?: (index: string) => void\n}\n\n/**\n * å°èª¬ä½œå“ä¸€è¦§\n */\nexport function HomeNovelsWorksSection (props: Props) {\n  if (!props.works) {\n    return null\n  }\n\n  if (props.works.length === 0) {\n    return null\n  }\n\n  return (\n    <section className=\"relative space-y-4\">\n      <div className=\"flex items-center justify-between\">\n        {props.title && (\n          <h2 className=\"items-center space-x-2 font-bold text-md\">\n            {props.title}\n          </h2>\n        )}\n      </div>\n      <CarouselWithGradation\n        items={props.works.map((work, _index) => (\n          // biome-ignore lint/correctness/useJsxKeyInIterable: <explanation>\n          <div className=\"h-full rounded border-2 border-gray border-solid\">\n            <div className=\"relative\">\n              <NovelWorkPreviewItem\n                workId={work.id}\n                imageUrl={work.smallThumbnailImageURL}\n                title={work.title}\n                text={work.description ?? \"\"}\n                tags={[]}\n              />\n            </div>\n            {work.user && (\n              <>\n                <UserNameBadge\n                  userId={work.user.id}\n                  userIconImageURL={withIconUrlFallback(work.user.iconUrl)}\n                  name={work.user.name}\n                  width={\"sm\"}\n                  padding={\"md\"}\n                />\n                <div className=\"absolute right-0 bottom-0\">\n                  <LikeButton\n                    size={56}\n                    targetWorkId={work.id}\n                    targetWorkOwnerUserId={work.user.id}\n                    defaultLiked={work.isLiked}\n                    defaultLikedCount={0}\n                    isBackgroundNone={true}\n                    strokeWidth={2}\n                  />\n                </div>\n              </>\n            )}\n          </div>\n        ))}\n      />\n    </section>\n  )\n}\n\nexport const HomeNovelsWorkListItemFragment = graphql(\n  `fragment HomeNovelsWorkListItem on WorkNode @_unmask {\n    id\n    title\n    description\n    smallThumbnailImageURL\n    isLiked\n    user {\n      id\n      name\n      iconUrl\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main._index/components/home-work-list.tsx"},"span":[483,496],"sourceCode":"import { WorkCard } from \"~/routes/($lang)._main.posts._index/components/work-card\"\nimport { Link } from \"@remix-run/react\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\n\ntype Props = {\n  works: FragmentOf<typeof HomeWorkListItemFragment>[]\n}\n\nexport function HomeWorkList (props: Props) {\n  return (\n    <ul className=\"grid w-full grid-cols-1 gap-2 pr-4 pb-4 md:grid-cols-2\">\n      {props.works?.map((work, index) => (\n        // biome-ignore lint/suspicious/noArrayIndexKey: <explanation>\n        <li key={index}>\n          <Link to={`/posts/${work.id}`}>\n            <WorkCard\n              imageURL={work.largeThumbnailImageURL}\n              imageWidth={work.largeThumbnailImageWidth}\n              imageHeight={work.largeThumbnailImageHeight}\n            />\n          </Link>\n        </li>\n      ))}\n    </ul>\n  )\n}\n\nexport const HomeWorkListItemFragment = graphql(\n  `fragment HomeWorkListItem on WorkNode @_unmask {\n    id\n    title\n    accessType\n    adminAccessType\n    type\n    likesCount\n    commentsCount\n    bookmarksCount\n    viewsCount\n    createdAt\n    rating\n    isTagEditable\n    smallThumbnailImageURL\n    smallThumbnailImageHeight\n    smallThumbnailImageWidth\n    largeThumbnailImageURL\n    largeThumbnailImageHeight\n    largeThumbnailImageWidth\n    type\n    prompt\n    negativePrompt\n    isLiked\n    thumbnailImagePosition\n    description\n    url\n    subWorksCount\n    tags {\n      name\n    }\n    user {\n      id\n      name\n      iconUrl\n    }\n    uuid\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/suspicious/noDocumentCookie","severity":"warning","description":"Direct assigning to document.cookie is not recommended.","message":[{"elements":[],"content":"Direct assigning to "},{"elements":["Emphasis"],"content":"document.cookie"},{"elements":[],"content":" is not recommended."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Consider using the "},{"elements":[{"Hyperlink":{"href":"https://developer.mozilla.org/en-US/docs/Web/API/CookieStore"}}],"content":"Cookie Store API"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main._index/components/user-navigation-menu-content.tsx"},"span":[3982,4040],"sourceCode":"import { Avatar, AvatarFallback, AvatarImage } from \"~/components/ui/avatar\"\nimport {\n  DropdownMenuPortal,\n  DropdownMenuRadioGroup,\n  DropdownMenuRadioItem,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuLabel,\n} from \"~/components/ui/dropdown-menu\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport {\n  CoffeeIcon,\n  GemIcon,\n  Languages,\n  LogOutIcon,\n  MessageCircleIcon,\n  MoonIcon,\n  SettingsIcon,\n  SquareKanbanIcon,\n  SunIcon,\n  UserCircleIcon,\n  UserIcon,\n} from \"lucide-react\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { useContext, useEffect } from \"react\"\nimport { useTheme } from \"next-themes\"\nimport { MenuItemLink } from \"~/routes/($lang)._main._index/components/menu-item-link\"\nimport { useLocation, useNavigate, Link } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { useLocale } from \"~/hooks/use-locale\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { graphql } from \"gql.tada\"\nimport {\n  userNavigationStyles,\n  getSkeletonClass,\n  getMenuSkeletonClass,\n} from \"./user-navigation-styles\"\n\ntype Props = {\n  onLogout(): void\n}\n\n/**\n * ãƒ˜ãƒƒãƒ€ãƒ¼ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®å†…å®¹éƒ¨åˆ†ï¼ˆã‚¢ã‚¤ã‚³ãƒ³éƒ¨åˆ†ã‚’é™¤ãï¼‰\n * HomeUserNavigationMenuã‹ã‚‰åˆ†é›¢ã•ã‚ŒãŸæœ€æ–°ã®å®Ÿè£…\n */\nexport function UserNavigationMenuContent (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  const { data, refetch } = useQuery(viewerUserQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    errorPolicy: \"all\",\n    fetchPolicy: \"cache-and-network\", // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒã‚ã‚‹å ´åˆã¯å³åº§ã«è¡¨ç¤ºã€ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§æ›´æ–°\n  })\n\n  const { data: userSetting } = useQuery(userSettingQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    errorPolicy: \"all\",\n    fetchPolicy: \"cache-and-network\",\n  })\n\n  const { data: tokenData } = useQuery(viewerTokenQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    errorPolicy: \"all\",\n    fetchPolicy: \"cache-and-network\",\n  })\n\n  useEffect(() => {\n    if (authContext.login) {\n      refetch()\n    }\n  }, [authContext.login, refetch])\n\n  const { theme, setTheme } = useTheme()\n  const navigate = useNavigate()\n  const location = useLocation()\n  const t = useTranslation()\n  const locale = useLocale()\n\n  const promptonUser = data?.viewer?.user?.promptonUser?.id ?? \"\"\n  const followerCount = data?.viewer?.user?.followersCount ?? 0\n  const followCount = data?.viewer?.user?.followCount ?? 0\n  const headerImageUrl = data?.viewer?.user.headerImageUrl ?? \"\"\n  const iconUrl = data?.viewer?.user?.iconUrl ?? \"\"\n  const featurePromptonRequest =\n    userSetting?.userSetting?.featurePromptonRequest ?? false\n  const viewerUserToken = tokenData?.viewer?.token\n  const _isSensitiveToggleVisible =\n    typeof window !== \"undefined\" ? location.pathname !== \"/generation\" : true\n\n  const setColorTheme = (newMode: string) => {\n    if (newMode === \"system\") {\n      setTheme(newMode)\n      return\n    }\n    if ((theme === \"system\" || theme === \"dark\") && newMode === \"light\") {\n      setTheme(newMode)\n      return\n    }\n    if ((theme === \"system\" || theme === \"light\") && newMode === \"dark\") {\n      setTheme(newMode)\n      return\n    }\n    // ãƒ†ãƒ¼ãƒé©ç”¨ä¸­â†’\"light-blue\"ã€\"dark-blue\"ç­‰åŒè‰²ã§ã®ãƒ€ãƒ¼ã‚¯ã€ãƒ©ã‚¤ãƒˆåˆ‡ã‚Šæ›¿ãˆ\n    const suffix = theme?.replace(/(light|dark)-/, \"-\")\n    const colorSuffix = suffix ?? \"\"\n    const newTheme = newMode + colorSuffix\n    setTheme(newTheme)\n  }\n\n  const setLocale = (locale: string) => {\n    const currentLocale = location.pathname.match(/^\\/(ja|en)(\\/|$)/)?.[1] || \"\"\n    const basePath = location.pathname.replace(/^\\/(ja|en)(\\/|$)/, \"/\")\n\n    if (typeof document !== \"undefined\") {\n      // @ts-ignore - ã‚¯ãƒƒã‚­ãƒ¼ã®è¨­å®šã®ãŸã‚å¿…è¦\n      document.cookie = `locale=${locale}; path=/; SameSite=Lax`\n    }\n\n    const newUrl =\n      locale === \"ja\" && currentLocale\n        ? basePath\n        : locale !== \"ja\" && currentLocale\n          ? location.pathname.replace(`/${currentLocale}`, `/${locale}`)\n          : `/${locale}${basePath}`\n\n    if (location.pathname !== newUrl) {\n      navigate(newUrl)\n    }\n  }\n\n  const setMode = (theme: string) => {\n    if (theme === \"system\" || theme === \"light\" || theme === \"dark\") {\n      return theme\n    }\n    if (theme.startsWith(\"light-\")) {\n      return \"light\"\n    }\n    if (theme.startsWith(\"dark-\")) {\n      return \"dark\"\n    }\n    return \"system\"\n  }\n\n  const mode = setMode(theme ? theme?.toString() : \"system\")\n\n  const getThemeIcon = () => {\n    return theme?.endsWith(\"dark\") ? (\n      <MoonIcon className={userNavigationStyles.menuIcon} />\n    ) : (\n      <SunIcon className={userNavigationStyles.menuIcon} />\n    )\n  }\n\n  const sensitivePath = /\\/r($|\\/)/.test(location.pathname)\n\n  const getSensitiveLink = (path: string) => {\n    if (/^\\/r($|\\s)/.test(path)) {\n      return \"\"\n    }\n    if (sensitivePath) {\n      return `/r${path}`\n    }\n    return path\n  }\n\n  if (authContext.isNotLoggedIn) {\n    return null\n  }\n\n  // ãƒ‡ãƒ¼ã‚¿ãŒèª­ã¿è¾¼ã¿ä¸­ã®å ´åˆã¯èªè¨¼æƒ…å ±ã‚’ä½¿ç”¨ã—ã¦ã‚¹ã‚±ãƒ«ãƒˆãƒ³ã‚’è¡¨ç¤º\n  if (!data?.viewer?.user) {\n    const fallbackIconUrl = authContext.avatarPhotoURL || \"\"\n    const fallbackDisplayName = authContext.displayName || \"\"\n    const fallbackLogin = authContext.login || \"\"\n\n    return (\n      <div className={userNavigationStyles.container}>\n        <div className=\"relative mb-6 h-20 w-full rounded-md bg-gray-100 p-3 dark:bg-gray-800\">\n          <Link\n            to={getSensitiveLink(`/users/${fallbackLogin}`)}\n            className=\"absolute bottom-[-24px] left-3\"\n          >\n            <Avatar className=\"h-12 w-12 cursor-pointer border-2 border-white\">\n              <AvatarImage src={withIconUrlFallback(fallbackIconUrl)} />\n              <AvatarFallback>\n                {fallbackDisplayName\n                  ? fallbackDisplayName.charAt(0).toUpperCase()\n                  : \"U\"}\n              </AvatarFallback>\n            </Avatar>\n          </Link>\n        </div>\n\n        {/* ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆã‚¹ã‚±ãƒ«ãƒˆãƒ³ï¼‰*/}\n        <div className=\"px-2 pb-2\">\n          {/* ãƒ¦ãƒ¼ã‚¶ãƒ¼åéƒ¨åˆ† - ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯åãŒã‚ã‚Œã°è¡¨ç¤ºã€ãªã‘ã‚Œã°ã‚¹ã‚±ãƒ«ãƒˆãƒ³ */}\n          {fallbackDisplayName ? (\n            <h3 className={userNavigationStyles.userName}>\n              {fallbackDisplayName}\n            </h3>\n          ) : (\n            <div\n              className={getSkeletonClass(\n                userNavigationStyles.skeleton.userName,\n              )}\n            />\n          )}\n          {/* ãƒ­ã‚°ã‚¤ãƒ³åéƒ¨åˆ† - ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ­ã‚°ã‚¤ãƒ³åãŒã‚ã‚Œã°è¡¨ç¤ºã€ãªã‘ã‚Œã°ã‚¹ã‚±ãƒ«ãƒˆãƒ³ */}\n          {fallbackLogin ? (\n            <p className={userNavigationStyles.userLogin}>@{fallbackLogin}</p>\n          ) : (\n            <div\n              className={`mt-1 ${getSkeletonClass(userNavigationStyles.skeleton.userLogin)}`}\n            />\n          )}\n\n          {/* ãƒ•ã‚©ãƒ­ãƒ¼ãƒ»ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼æƒ…å ±ï¼ˆã‚¹ã‚±ãƒ«ãƒˆãƒ³ï¼‰ */}\n          <div className=\"mt-3 flex items-center gap-x-4\">\n            <div className=\"text-center\">\n              {/* æ•°å­—éƒ¨åˆ† */}\n              <div\n                className={getSkeletonClass(\n                  userNavigationStyles.skeleton.followCount,\n                )}\n              />\n              {/* ãƒ©ãƒ™ãƒ«éƒ¨åˆ†ã¯å®Ÿéš›ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’è¡¨ç¤º */}\n              <div className={`mt-1 ${userNavigationStyles.followLabel}`}>\n                {t(\"ãƒ•ã‚©ãƒ­ãƒ¼ä¸­\", \"Following\")}\n              </div>\n            </div>\n            <div className=\"text-center\">\n              {/* æ•°å­—éƒ¨åˆ† */}\n              <div\n                className={getSkeletonClass(\n                  userNavigationStyles.skeleton.followCount,\n                )}\n              />\n              {/* ãƒ©ãƒ™ãƒ«éƒ¨åˆ†ã¯å®Ÿéš›ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’è¡¨ç¤º */}\n              <div className={`mt-1 ${userNavigationStyles.followLabel}`}>\n                {t(\"ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼\", \"Followers\")}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <ScrollArea className=\"max-h-[40vh] overflow-y-auto p-1 sm:max-h-[50vh] md:max-h-none\">\n          {/* ã‚¹ã‚±ãƒ«ãƒˆãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ï¼ˆå®Ÿéš›ã®é …ç›®æ•°ã«åˆã‚ã›ã‚‹ï¼‰ */}\n          {/* ãƒã‚¤ãƒšãƒ¼ã‚¸ */}\n          <div className={userNavigationStyles.menuItem}>\n            <div\n              className={`${userNavigationStyles.menuIcon} ${userNavigationStyles.skeleton.base}`}\n            />\n            <div className={getMenuSkeletonClass(\"myPage\")} />\n          </div>\n          {/* ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ */}\n          <div className={userNavigationStyles.menuItem}>\n            <div\n              className={`${userNavigationStyles.menuIcon} ${userNavigationStyles.skeleton.base}`}\n            />\n            <div className={getMenuSkeletonClass(\"dashboard\")} />\n          </div>\n          {/* è‡ªåˆ†ã®ä½œå“ */}\n          <div className={userNavigationStyles.menuItem}>\n            <div\n              className={`${userNavigationStyles.menuIcon} ${userNavigationStyles.skeleton.base}`}\n            />\n            <div className={getMenuSkeletonClass(\"myPosts\")} />\n          </div>\n          {/* æ”¯æ´ç®¡ç†ï¼ˆæ¡ä»¶ä»˜ãã§è¡¨ç¤ºã•ã‚Œã‚‹ãŒã€ã‚¹ã‚±ãƒ«ãƒˆãƒ³ã§ã¯è¡¨ç¤ºã—ã¦ãŠãï¼‰ */}\n          <div className={userNavigationStyles.menuItem}>\n            <div\n              className={`${userNavigationStyles.menuIcon} ${userNavigationStyles.skeleton.base}`}\n            />\n            <div className={getMenuSkeletonClass(\"support\")} />\n          </div>\n          {/* ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ */}\n          <div className={userNavigationStyles.menuItem}>\n            <div\n              className={`${userNavigationStyles.menuIcon} ${userNavigationStyles.skeleton.base}`}\n            />\n            <div className={getMenuSkeletonClass(\"account\")} />\n          </div>\n          {/* ãŠå•ã„åˆã‚ã› */}\n          <div className={userNavigationStyles.menuItem}>\n            <div\n              className={`${userNavigationStyles.menuIcon} ${userNavigationStyles.skeleton.base}`}\n            />\n            <div className={getMenuSkeletonClass(\"contact\")} />\n          </div>\n          {/* Aipictors+ */}\n          <div className={userNavigationStyles.menuItem}>\n            <div\n              className={`${userNavigationStyles.menuIcon} ${userNavigationStyles.skeleton.base}`}\n            />\n            <div className={getMenuSkeletonClass(\"plus\")} />\n          </div>\n          {/* è¨­å®š */}\n          <div className={userNavigationStyles.menuItem}>\n            <div\n              className={`${userNavigationStyles.menuIcon} ${userNavigationStyles.skeleton.base}`}\n            />\n            <div className={getMenuSkeletonClass(\"settings\")} />\n          </div>\n          {/* ãƒ†ãƒ¼ãƒ */}\n          <div className={userNavigationStyles.menuItem}>\n            <div\n              className={`${userNavigationStyles.menuIcon} ${userNavigationStyles.skeleton.base}`}\n            />\n            <div className={getMenuSkeletonClass(\"theme\")} />\n          </div>\n          {/* è¨€èª */}\n          <div className={userNavigationStyles.menuItem}>\n            <div\n              className={`${userNavigationStyles.menuIcon} ${userNavigationStyles.skeleton.base}`}\n            />\n            <div className={getMenuSkeletonClass(\"language\")} />\n          </div>\n          {/* SensitiveToggleï¼ˆæ¡ä»¶ä»˜ãã§è¡¨ç¤ºã•ã‚Œã‚‹ãŒã€ã‚¹ã‚±ãƒ«ãƒˆãƒ³ã§ã¯è¡¨ç¤ºã—ã¦ãŠãï¼‰ */}\n          <div className={userNavigationStyles.menuItem}>\n            <div\n              className={`${userNavigationStyles.menuIcon} ${userNavigationStyles.skeleton.base}`}\n            />\n            <div className={getMenuSkeletonClass(\"settings\")} />\n          </div>\n          {/* ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ */}\n          <div className={userNavigationStyles.menuItem}>\n            <div\n              className={`${userNavigationStyles.menuIcon} ${userNavigationStyles.skeleton.base}`}\n            />\n            <div className={getMenuSkeletonClass(\"logout\")} />\n          </div>\n        </ScrollArea>\n      </div>\n    )\n  }\n\n  return (\n    <div className={userNavigationStyles.container}>\n      <div\n        className=\"relative mb-6 h-20 w-full rounded-md bg-gray-100 p-3 dark:bg-gray-800\"\n        style={{\n          backgroundImage: headerImageUrl\n            ? `url(${headerImageUrl})`\n            : undefined,\n          backgroundSize: \"cover\",\n          backgroundPosition: \"center\",\n        }}\n      >\n        <Link\n          to={getSensitiveLink(`/users/${data?.viewer?.user?.login}`)}\n          className=\"absolute bottom-[-24px] left-3\"\n        >\n          <Avatar className=\"h-12 w-12 cursor-pointer border-2 border-white\">\n            <AvatarImage src={withIconUrlFallback(iconUrl)} />\n            <AvatarFallback />\n          </Avatar>\n        </Link>\n      </div>\n\n      {/* ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}\n      <div className=\"px-2 pb-2\">\n        {\" \"}\n        {/* ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’å‰Šæ¸› */}\n        <h3 className={userNavigationStyles.userName}>\n          {data?.viewer?.user?.name || authContext.displayName}\n        </h3>\n        <p className={userNavigationStyles.userLogin}>\n          @{data?.viewer?.user?.login || authContext.login}\n        </p>\n        {/* ãƒ•ã‚©ãƒ­ãƒ¼ãƒ»ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼æƒ…å ± */}\n        <div className=\"mt-3 flex items-center gap-x-4\">\n          {\" \"}\n          {/* gap ã‚’å‰Šæ¸› */}\n          <div className=\"text-center\">\n            <div className={userNavigationStyles.followCount}>\n              {followCount}\n            </div>\n            <Link\n              to={getSensitiveLink(\"/following\")}\n              className={`cursor-pointer hover:underline ${userNavigationStyles.followLabel}`}\n            >\n              {t(\"ãƒ•ã‚©ãƒ­ãƒ¼ä¸­\", \"Following\")}\n            </Link>\n          </div>\n          <div className=\"text-center\">\n            <div className={userNavigationStyles.followCount}>\n              {followerCount}\n            </div>\n            <Link\n              to={getSensitiveLink(\"/followers\")}\n              className={`cursor-pointer hover:underline ${userNavigationStyles.followLabel}`}\n            >\n              {t(\"ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼\", \"Followers\")}\n            </Link>\n          </div>\n        </div>\n      </div>\n\n      <ScrollArea className=\"max-h-[40vh] overflow-y-auto p-1 sm:max-h-[50vh] md:max-h-none\">\n        <MenuItemLink\n          href={getSensitiveLink(`/users/${authContext.login}`)}\n          icon={<UserCircleIcon className={userNavigationStyles.menuIcon} />}\n          label={t(\"ãƒã‚¤ãƒšãƒ¼ã‚¸\", \"My page\")}\n        />\n        <MenuItemLink\n          href={getSensitiveLink(\"/my\")}\n          icon={<SquareKanbanIcon className={userNavigationStyles.menuIcon} />}\n          label={t(\"ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰\", \"Dashboard\")}\n        />\n        <MenuItemLink\n          href={getSensitiveLink(\"/my/posts\")}\n          icon={<SquareKanbanIcon className={userNavigationStyles.menuIcon} />}\n          label={t(\"è‡ªåˆ†ã®ä½œå“\", \"My posts\")}\n        />\n        {featurePromptonRequest &&\n          (promptonUser === \"\" && viewerUserToken ? (\n            <MenuItemLink\n              href={`https://prompton.io/integration?token=${viewerUserToken}`}\n              icon={<CoffeeIcon className={userNavigationStyles.menuIcon} />}\n              label={t(\"æ”¯æ´ç®¡ç†\", \"Support management\")}\n            />\n          ) : (\n            <MenuItemLink\n              href={\"https://prompton.io/viewer/requests\"}\n              icon={<CoffeeIcon className={userNavigationStyles.menuIcon} />}\n              label={t(\"æ”¯æ´ç®¡ç†\", \"Support management\")}\n            />\n          ))}\n        <MenuItemLink\n          href={getSensitiveLink(\"/settings/account/login\")}\n          icon={<UserIcon className={userNavigationStyles.menuIcon} />}\n          label={t(\"ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ\", \"Account\")}\n        />\n        <MenuItemLink\n          href={getSensitiveLink(\"/support/chat\")}\n          icon={<MessageCircleIcon className={userNavigationStyles.menuIcon} />}\n          label={t(\"ãŠå•ã„åˆã‚ã›\", \"Contact\")}\n        />\n        <MenuItemLink\n          href={getSensitiveLink(\"/plus\")}\n          icon={<GemIcon className={userNavigationStyles.menuIcon} />}\n          label=\"Aipictors+\"\n        />\n        <MenuItemLink\n          href={getSensitiveLink(\"/settings\")}\n          icon={<SettingsIcon className={userNavigationStyles.menuIcon} />}\n          label={t(\"è¨­å®š\", \"Settings\")}\n        />\n        <DropdownMenuSub>\n          <DropdownMenuSubTrigger className={userNavigationStyles.menuItem}>\n            {getThemeIcon()}\n            <span\n              className={`${userNavigationStyles.menuText} ${userNavigationStyles.menuItemText}`}\n            >\n              {t(\"ãƒ†ãƒ¼ãƒ\", \"Theme\")}\n            </span>\n          </DropdownMenuSubTrigger>\n          <DropdownMenuPortal>\n            <DropdownMenuSubContent className=\"max-w-[180px] sm:max-w-[200px]\">\n              <DropdownMenuLabel>\n                {t(\"ãƒ†ãƒ¼ãƒå¤‰æ›´\", \"Change Theme\")}\n              </DropdownMenuLabel>\n              <DropdownMenuSeparator />\n              <DropdownMenuRadioGroup\n                value={mode}\n                onValueChange={(newMode) => {\n                  setColorTheme(newMode)\n                }}\n              >\n                <DropdownMenuRadioItem value=\"system\">\n                  {t(\"ãƒ‡ãƒã‚¤ã‚¹ãƒ¢ãƒ¼ãƒ‰ä½¿ç”¨\", \"Use device mode\")}\n                </DropdownMenuRadioItem>\n                <DropdownMenuRadioItem value=\"light\">\n                  {t(\"ãƒ©ã‚¤ãƒˆ\", \"Light\")}\n                </DropdownMenuRadioItem>\n                <DropdownMenuRadioItem value=\"dark\">\n                  {t(\"ãƒ€ãƒ¼ã‚¯\", \"Dark\")}\n                </DropdownMenuRadioItem>\n              </DropdownMenuRadioGroup>\n              <MenuItemLink\n                href={getSensitiveLink(\"/settings/color\")}\n                icon={\n                  <SettingsIcon className={userNavigationStyles.menuIcon} />\n                }\n                label={t(\"ãã®ä»–ã®ã‚«ãƒ©ãƒ¼\", \"Other colors\")}\n              />\n            </DropdownMenuSubContent>\n          </DropdownMenuPortal>\n        </DropdownMenuSub>\n        <DropdownMenuSub>\n          <DropdownMenuSubTrigger className={userNavigationStyles.menuItem}>\n            <Languages className={userNavigationStyles.menuIcon} />\n            <span\n              className={`${userNavigationStyles.menuText} ${userNavigationStyles.menuItemText}`}\n            >\n              {t(\"è¨€èª/Language\", \"è¨€èª/Language\")}\n            </span>\n          </DropdownMenuSubTrigger>\n          <DropdownMenuPortal>\n            <DropdownMenuSubContent className=\"max-w-[160px] sm:max-w-[180px]\">\n              <DropdownMenuLabel>\n                {t(\"è¨€èªå¤‰æ›´\", \"Change Language\")}\n              </DropdownMenuLabel>\n              <DropdownMenuSeparator />\n              <DropdownMenuRadioGroup\n                value={locale}\n                onValueChange={(newLocale) => {\n                  setLocale(newLocale)\n                }}\n              >\n                <DropdownMenuRadioItem value=\"ja\">\n                  {t(\"æ—¥æœ¬èª\", \"æ—¥æœ¬èª\")}\n                </DropdownMenuRadioItem>\n                <DropdownMenuRadioItem value=\"en\">\n                  {t(\"English\", \"English\")}\n                </DropdownMenuRadioItem>\n              </DropdownMenuRadioGroup>\n            </DropdownMenuSubContent>\n          </DropdownMenuPortal>\n        </DropdownMenuSub>\n        {/* {userSetting?.userSetting &&\n          (userSetting?.userSetting.preferenceRating === \"R18\" ||\n            userSetting?.userSetting.preferenceRating === \"R18G\") &&\n          isSensitiveToggleVisible && (\n            <DropdownMenuItem asChild>\n              <SensitiveToggle variant=\"full\" className=\"w-full\" />\n            </DropdownMenuItem>\n          )} */}\n        <DropdownMenuItem\n          onClick={props.onLogout}\n          className={userNavigationStyles.menuItem}\n        >\n          <LogOutIcon className={userNavigationStyles.menuIcon} />\n          <span\n            className={`${userNavigationStyles.menuText} ${userNavigationStyles.menuItemText}`}\n          >\n            {t(\"ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ\", \"Logout\")}\n          </span>\n        </DropdownMenuItem>\n      </ScrollArea>\n    </div>\n  )\n}\n\nconst userSettingQuery = graphql(\n  `query UserSetting {\n    userSetting {\n      id\n      userId\n      favoritedImageGenerationModelIds\n      preferenceRating\n      featurePromptonRequest\n      isNotifyComment\n    }\n  }`,\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst viewerUserQuery = graphql(\n  `query ViewerUser {\n    viewer {\n      id\n      user {\n        id\n        biography\n        login\n        name\n        awardsCount\n        followersCount\n        followCount\n        iconUrl\n        headerImageUrl\n        webFcmToken\n        generatedCount\n        promptonUser {\n          id\n          name\n        }\n        receivedLikesCount\n        receivedViewsCount\n        createdLikesCount\n        createdViewsCount\n        createdCommentsCount\n        createdBookmarksCount\n      }\n    }\n  }`,\n)\n\n// default exportã¨ã—ã¦è¿½åŠ \nexport default UserNavigationMenuContent\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main._index/components/video-work-preview-item.tsx"},"span":[1202,1215],"sourceCode":"import { Badge } from \"~/components/ui/badge\"\nimport { Link } from \"@remix-run/react\"\n\ntype Props = {\n  workId: string\n  imageUrl: string\n  title: string\n  text: string\n  tags: string[]\n}\n\n/**\n * ãƒãƒ™ãƒ«ä½œå“ã‚’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦è¡¨ç¤ºã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ\n */\nexport function NovelWorkPreviewItem (props: Props) {\n  return (\n    <Link\n      to={`/posts/${props.workId}`}\n      className=\"relative transition-all duration-300 ease-in-out hover:opacity-80\"\n    >\n      <div className={\"relative overflow-hidden rounded\"}>\n        <img\n          src={props.imageUrl}\n          alt=\"novel work preview\"\n          className={\n            \"h-32 w-48 max-w-40 rounded object-cover md:w-64 md:max-w-none\"\n          }\n        />\n      </div>\n      <div className=\"mt-2 h-32 w-48 space-y-2 overflow-hidden text-ellipsis p-2 md:w-64\">\n        <div className=\"overflow-hidden font-bold text-sm\">{props.title}</div>\n        <div className=\"h-16 overflow-hidden text-ellipsis text-wrap text-xs\">\n          {props.text}\n        </div>\n        <div className=\"mt-1 flex flex-wrap space-x-1\">\n          {props.tags.map((tag, index: number) => (\n            // biome-ignore lint/suspicious/noArrayIndexKey: <explanation>\n            <Badge variant={\"secondary\"} key={index} className=\"text-xs\">\n              {tag}\n            </Badge>\n          ))}\n        </div>\n      </div>\n    </Link>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.admin.users/route.tsx"},"span":[8283,8705],"sourceCode":"import { json, type LoaderFunctionArgs } from \"@remix-run/cloudflare\"\nimport { useLoaderData } from \"@remix-run/react\"\nimport { useState, useContext } from \"react\"\nimport { useQuery, useMutation } from \"@apollo/client/index\"\nimport { Button, buttonVariants } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"~/components/ui/card\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { Alert, AlertDescription } from \"~/components/ui/alert\"\nimport { Separator } from \"~/components/ui/separator\"\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"~/components/ui/alert-dialog\"\nimport { Search, Shield, UserX, MessageSquareOff, ImageOff } from \"lucide-react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { graphql } from \"gql.tada\"\n\n// GraphQLã‚¯ã‚¨ãƒª: ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã¨ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚¿ãƒ¼æ¨©é™ã‚’å–å¾—\nconst ViewerQuery = graphql(`\n  query Viewer {\n    viewer {\n      id\n      isModerator\n    }\n  }\n`)\n\n// GraphQLã‚¯ã‚¨ãƒª: ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—ï¼ˆIDæ¤œç´¢ï¼‰\nconst GetUserForModerationQuery = graphql(`\n  query GetUserForModeration($userId: ID!) {\n    user(id: $userId) {\n      id\n      name\n      login\n      isCommentBanned\n      isPostBanned\n    }\n  }\n`)\n\n// GraphQLã‚¯ã‚¨ãƒª: ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—ï¼ˆãƒ­ã‚°ã‚¤ãƒ³åæ¤œç´¢ï¼‰\nconst GetUserByLoginQuery = graphql(`\n  query GetUserByLogin($where: UsersWhereInput!) {\n    users(offset: 0, limit: 1, where: $where) {\n      id\n      name\n      login\n      isCommentBanned\n      isPostBanned\n    }\n  }\n`)\n\n// GraphQLãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³: ã‚³ãƒ¡ãƒ³ãƒˆBANåˆ‡ã‚Šæ›¿ãˆ\nconst ToggleUserCommentBanMutation = graphql(\n  `mutation ToggleUserCommentBan($input: ToggleUserCommentBanInput!) {\n    toggleUserCommentBan(input: $input)\n  }`,\n)\n\n// GraphQLãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³: æŠ•ç¨¿BANåˆ‡ã‚Šæ›¿ãˆ\nconst ToggleUserPostBanMutation = graphql(\n  `mutation ToggleUserPostBan($input: ToggleUserPostBanInput!) {\n    toggleUserPostBan(input: $input)\n  }`,\n)\n\ntype BanAction = \"toggleCommentBan\" | \"togglePostBan\"\n\ntype LoaderData = {\n  searchUserId?: string\n}\n\nexport async function loader({ request }: LoaderFunctionArgs) {\n  // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰searchUserIdã®ã¿ã‚’å–å¾—ã—ã¦ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«æ¸¡ã™\n  const url = new URL(request.url)\n  const searchUserId = url.searchParams.get(\"userId\")\n\n  return json<LoaderData>({ searchUserId: searchUserId || undefined })\n}\n\nexport default function AdminUsersPage () {\n  const { searchUserId } = useLoaderData<typeof loader>()\n  const authContext = useContext(AuthContext)\n  const [inputUserId, setInputUserId] = useState(searchUserId || \"\")\n  const [searchedUserId, setSearchedUserId] = useState(searchUserId || \"\")\n\n  // ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã¨ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚¿ãƒ¼æ¨©é™ã‚’å–å¾—\n  const { data: viewerData, loading: viewerLoading } = useQuery(ViewerQuery, {\n    skip: authContext.isNotLoggedIn,\n  })\n\n  // å…¥åŠ›å€¤ãŒæ•°å­—ã‹ã©ã†ã‹ã‚’åˆ¤å®š\n  const isNumericId = /^\\d+$/.test(searchedUserId)\n\n  // æ¤œç´¢ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—ï¼ˆIDæ¤œç´¢ï¼‰\n  const {\n    data: userDataById,\n    loading: userLoadingById,\n    error: userErrorById,\n  } = useQuery(GetUserForModerationQuery, {\n    variables: { userId: searchedUserId },\n    skip: !searchedUserId || !isNumericId || !viewerData?.viewer?.isModerator,\n  })\n\n  // æ¤œç´¢ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—ï¼ˆãƒ­ã‚°ã‚¤ãƒ³åæ¤œç´¢ï¼‰\n  const {\n    data: userDataByLogin,\n    loading: userLoadingByLogin,\n    error: userErrorByLogin,\n  } = useQuery(GetUserByLoginQuery, {\n    variables: { where: { search: searchedUserId } },\n    skip: !searchedUserId || isNumericId || !viewerData?.viewer?.isModerator,\n  })\n\n  // ã©ã¡ã‚‰ã‹ã®ã‚¯ã‚¨ãƒªçµæœã‚’ä½¿ç”¨\n  const userLoading = isNumericId ? userLoadingById : userLoadingByLogin\n  const userError = isNumericId ? userErrorById : userErrorByLogin // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—\n  type UserType = {\n    id: string\n    name: string\n    login: string\n    isCommentBanned: boolean\n    isPostBanned: boolean\n  }\n\n  let user: UserType | null = null\n  if (isNumericId && userDataById?.user) {\n    user = userDataById.user as UserType\n  } else if (!isNumericId && userDataByLogin?.users?.[0]) {\n    user = userDataByLogin.users[0] as UserType\n  }\n\n  // ã‚³ãƒ¡ãƒ³ãƒˆBANåˆ‡ã‚Šæ›¿ãˆãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\n  const [toggleCommentBan, { loading: commentBanLoading }] = useMutation(\n    ToggleUserCommentBanMutation,\n    {\n      onCompleted: () => {\n        // æˆåŠŸå¾Œã«ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å†å–å¾—\n        window.location.reload()\n      },\n    },\n  )\n\n  // æŠ•ç¨¿BANåˆ‡ã‚Šæ›¿ãˆãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\n  const [togglePostBan, { loading: postBanLoading }] = useMutation(\n    ToggleUserPostBanMutation,\n    {\n      onCompleted: () => {\n        // æˆåŠŸå¾Œã«ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å†å–å¾—\n        window.location.reload()\n      },\n    },\n  )\n\n  const handleSearch = () => {\n    if (!inputUserId.trim()) return\n\n    setSearchedUserId(inputUserId.trim())\n    const searchParams = new URLSearchParams()\n    searchParams.set(\"userId\", inputUserId.trim())\n    window.history.pushState({}, \"\", `?${searchParams.toString()}`)\n  }\n\n  const handleBanToggle = async (actionType: BanAction) => {\n    if (!searchedUserId || !user) return\n\n    try {\n      if (actionType === \"toggleCommentBan\") {\n        await toggleCommentBan({\n          variables: {\n            input: {\n              targetUserId: searchedUserId,\n              isBanned: !user.isCommentBanned,\n            },\n          },\n        })\n      } else if (actionType === \"togglePostBan\") {\n        await togglePostBan({\n          variables: {\n            input: {\n              targetUserId: searchedUserId,\n              isBanned: !user.isPostBanned,\n            },\n          },\n        })\n      }\n    } catch (error) {\n      console.error(\"BANæ“ä½œã‚¨ãƒ©ãƒ¼:\", error)\n    }\n  }\n\n  // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­\n  if (authContext.isLoading || viewerLoading) {\n    return (\n      <div className=\"container mx-auto max-w-4xl py-8\">\n        <div className=\"animate-pulse space-y-6\">\n          <div className=\"h-8 w-1/3 rounded bg-gray-200\" />\n          <div className=\"h-64 rounded bg-gray-200\" />\n        </div>\n      </div>\n    )\n  }\n\n  // æœªãƒ­ã‚°ã‚¤ãƒ³\n  if (authContext.isNotLoggedIn) {\n    return (\n      <div className=\"container mx-auto max-w-4xl py-8\">\n        <Alert className=\"border-red-200 bg-red-50\">\n          <Shield className=\"h-4 w-4\" />\n          <AlertDescription>\n            ã“ã®ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã«ã¯ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™ã€‚\n          </AlertDescription>\n        </Alert>\n      </div>\n    )\n  }\n\n  // ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚¿ãƒ¼æ¨©é™ãªã—\n  if (!viewerData?.viewer?.isModerator) {\n    return (\n      <div className=\"container mx-auto max-w-4xl py-8\">\n        <Alert className=\"border-red-200 bg-red-50\">\n          <Shield className=\"h-4 w-4\" />\n          <AlertDescription>\n            ã“ã®ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€‚\n          </AlertDescription>\n        </Alert>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"container mx-auto max-w-4xl space-y-6 py-8\">\n      {/* ãƒ˜ãƒƒãƒ€ãƒ¼ */}\n      <div className=\"flex items-center space-x-2\">\n        <Shield className=\"h-6 w-6 text-orange-500\" />\n        <h1 className=\"font-bold text-2xl\">ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚¿ãƒ¼ç®¡ç†ç”»é¢</h1>\n        <Badge variant=\"secondary\">ç®¡ç†è€…å°‚ç”¨</Badge>\n      </div>\n\n      <Separator />\n\n      {/* ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center space-x-2\">\n            <Search className=\"h-5 w-5\" />\n            <span>ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢</span>\n          </CardTitle>\n          <CardDescription>\n            ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã§æ¤œç´¢ã—ã¦BANæ“ä½œã‚’è¡Œã„ã¾ã™\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex space-x-2\">\n            <div className=\"flex-1\">\n              <label htmlFor=\"userId\" className=\"sr-only\">\n                ãƒ¦ãƒ¼ã‚¶ãƒ¼ID\n              </label>\n              <Input\n                id=\"userId\"\n                type=\"text\"\n                placeholder=\"ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã‚’å…¥åŠ›\"\n                value={inputUserId}\n                onChange={(e) => setInputUserId(e.target.value)}\n                onKeyDown={(e) => {\n                  if (e.key === \"Enter\") {\n                    handleSearch()\n                  }\n                }}\n                className=\"w-full\"\n              />\n            </div>\n            <Button onClick={handleSearch} disabled={!inputUserId.trim()}>\n              <Search className=\"mr-2 h-4 w-4\" />\n              æ¤œç´¢\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* ã‚¨ãƒ©ãƒ¼è¡¨ç¤º */}\n      {userError && (\n        <Alert className=\"border-red-200 bg-red-50\">\n          <AlertDescription>\n            ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ: {userError.message}\n          </AlertDescription>\n        </Alert>\n      )}\n\n      {/* ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±è¡¨ç¤ºã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}\n      {userLoading && searchedUserId && (\n        <Card>\n          <CardContent className=\"py-12 text-center\">\n            <div className=\"mx-auto mb-4 h-8 w-8 animate-spin rounded-full border-4 border-gray-300 border-t-blue-600\" />\n            <p className=\"text-gray-500\">ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’èª­ã¿è¾¼ã¿ä¸­...</p>\n          </CardContent>\n        </Card>\n      )}\n\n      {user && (\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center space-x-2\">\n              <UserX className=\"h-5 w-5\" />\n              <span>ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±</span>\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            {/* ãƒ¦ãƒ¼ã‚¶ãƒ¼åŸºæœ¬æƒ…å ± */}\n            <div className=\"grid grid-cols-1 gap-4 md:grid-cols-3\">\n              <div>\n                <p className=\"font-medium text-gray-500 text-sm\">ãƒ¦ãƒ¼ã‚¶ãƒ¼ID</p>\n                <p className=\"font-mono text-sm\">{user.id}</p>\n              </div>\n              <div>\n                <p className=\"font-medium text-gray-500 text-sm\">ãƒ¦ãƒ¼ã‚¶ãƒ¼å</p>\n                <p className=\"font-medium\">{user.name}</p>\n              </div>\n              <div>\n                <p className=\"font-medium text-gray-500 text-sm\">ãƒ­ã‚°ã‚¤ãƒ³å</p>\n                <p className=\"font-mono text-sm\">@{user.login}</p>\n              </div>\n            </div>\n\n            <Separator />\n\n            {/* BANçŠ¶æ…‹è¡¨ç¤º */}\n            <div>\n              <h3 className=\"mb-4 font-semibold text-lg\">ç¾åœ¨ã®BANçŠ¶æ…‹</h3>\n              <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2\">\n                <div className=\"flex items-center justify-between rounded-lg border p-4\">\n                  <div className=\"flex items-center space-x-2\">\n                    <MessageSquareOff className=\"h-5 w-5 text-gray-500\" />\n                    <span className=\"font-medium\">ã‚³ãƒ¡ãƒ³ãƒˆBAN</span>\n                  </div>\n                  <Badge\n                    variant={user.isCommentBanned ? \"destructive\" : \"secondary\"}\n                  >\n                    {user.isCommentBanned ? \"BANä¸­\" : \"æ­£å¸¸\"}\n                  </Badge>\n                </div>\n\n                <div className=\"flex items-center justify-between rounded-lg border p-4\">\n                  <div className=\"flex items-center space-x-2\">\n                    <ImageOff className=\"h-5 w-5 text-gray-500\" />\n                    <span className=\"font-medium\">æŠ•ç¨¿BAN</span>\n                  </div>\n                  <Badge\n                    variant={user.isPostBanned ? \"destructive\" : \"secondary\"}\n                  >\n                    {user.isPostBanned ? \"BANä¸­\" : \"æ­£å¸¸\"}\n                  </Badge>\n                </div>\n              </div>\n            </div>\n\n            <Separator />\n\n            {/* BANæ“ä½œãƒœã‚¿ãƒ³ */}\n            <div>\n              <h3 className=\"mb-4 font-semibold text-lg\">BANæ“ä½œ</h3>\n              <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2\">\n                <AlertDialog>\n                  <AlertDialogTrigger asChild>\n                    <Button\n                      variant={user.isCommentBanned ? \"destructive\" : \"outline\"}\n                      className=\"w-full\"\n                      disabled={commentBanLoading}\n                    >\n                      <MessageSquareOff className=\"mr-2 h-4 w-4\" />\n                      {commentBanLoading\n                        ? \"å‡¦ç†ä¸­...\"\n                        : `ã‚³ãƒ¡ãƒ³ãƒˆBAN${user.isCommentBanned ? \"è§£é™¤\" : \"è¨­å®š\"}`}\n                    </Button>\n                  </AlertDialogTrigger>\n                  <AlertDialogContent>\n                    <AlertDialogHeader>\n                      <AlertDialogTitle>\n                        {user.isCommentBanned\n                          ? \"ã‚³ãƒ¡ãƒ³ãƒˆBANè§£é™¤\"\n                          : \"ã‚³ãƒ¡ãƒ³ãƒˆBANè¨­å®š\"}\n                      </AlertDialogTitle>\n                      <AlertDialogDescription>\n                        {user.isCommentBanned\n                          ? `ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œ${user.name}ã€(@${user.login})ã®ã‚³ãƒ¡ãƒ³ãƒˆBANã‚’è§£é™¤ã—ã¾ã™ã‹ï¼Ÿ`\n                          : `ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œ${user.name}ã€(@${user.login})ã‚’ã‚³ãƒ¡ãƒ³ãƒˆBANã—ã¾ã™ã‹ï¼Ÿ`}\n                        <br />\n                        ã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã™ã“ã¨ãŒã§ãã¾ã™ã€‚\n                      </AlertDialogDescription>\n                    </AlertDialogHeader>\n                    <AlertDialogFooter>\n                      <AlertDialogCancel>ã‚­ãƒ£ãƒ³ã‚»ãƒ«</AlertDialogCancel>\n                      <AlertDialogAction\n                        onClick={() => handleBanToggle(\"toggleCommentBan\")}\n                        className={buttonVariants({\n                          variant: user.isCommentBanned\n                            ? \"default\"\n                            : \"destructive\",\n                        })}\n                      >\n                        {user.isCommentBanned ? \"BANè§£é™¤\" : \"BANè¨­å®š\"}\n                      </AlertDialogAction>\n                    </AlertDialogFooter>\n                  </AlertDialogContent>\n                </AlertDialog>\n\n                <AlertDialog>\n                  <AlertDialogTrigger asChild>\n                    <Button\n                      variant={user.isPostBanned ? \"destructive\" : \"outline\"}\n                      className=\"w-full\"\n                      disabled={postBanLoading}\n                    >\n                      <ImageOff className=\"mr-2 h-4 w-4\" />\n                      {postBanLoading\n                        ? \"å‡¦ç†ä¸­...\"\n                        : `æŠ•ç¨¿BAN${user.isPostBanned ? \"è§£é™¤\" : \"è¨­å®š\"}`}\n                    </Button>\n                  </AlertDialogTrigger>\n                  <AlertDialogContent>\n                    <AlertDialogHeader>\n                      <AlertDialogTitle>\n                        {user.isPostBanned ? \"æŠ•ç¨¿BANè§£é™¤\" : \"æŠ•ç¨¿BANè¨­å®š\"}\n                      </AlertDialogTitle>\n                      <AlertDialogDescription>\n                        {user.isPostBanned\n                          ? `ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œ${user.name}ã€(@${user.login})ã®æŠ•ç¨¿BANã‚’è§£é™¤ã—ã¾ã™ã‹ï¼Ÿ`\n                          : `ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€Œ${user.name}ã€(@${user.login})ã‚’æŠ•ç¨¿BANã—ã¾ã™ã‹ï¼Ÿ`}\n                        <br />\n                        ã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã™ã“ã¨ãŒã§ãã¾ã™ã€‚\n                      </AlertDialogDescription>\n                    </AlertDialogHeader>\n                    <AlertDialogFooter>\n                      <AlertDialogCancel>ã‚­ãƒ£ãƒ³ã‚»ãƒ«</AlertDialogCancel>\n                      <AlertDialogAction\n                        onClick={() => handleBanToggle(\"togglePostBan\")}\n                        className={buttonVariants({\n                          variant: user.isPostBanned\n                            ? \"default\"\n                            : \"destructive\",\n                        })}\n                      >\n                        {user.isPostBanned ? \"BANè§£é™¤\" : \"BANè¨­å®š\"}\n                      </AlertDialogAction>\n                    </AlertDialogFooter>\n                  </AlertDialogContent>\n                </AlertDialog>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* æ¤œç´¢ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ãªã„å ´åˆã®æ¡ˆå†… */}\n      {!searchedUserId && (\n        <Card>\n          <CardContent className=\"py-12 text-center\">\n            <Search className=\"mx-auto mb-4 h-12 w-12 text-gray-400\" />\n            <p className=\"text-gray-500\">\n              ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã‚’å…¥åŠ›ã—ã¦æ¤œç´¢ã—ã¦ãã ã•ã„\n            </p>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ */}\n      {searchedUserId && !userLoading && !user && !userError && (\n        <Card>\n          <CardContent className=\"py-12 text-center\">\n            <UserX className=\"mx-auto mb-4 h-12 w-12 text-gray-400\" />\n            <p className=\"text-gray-500\">ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</p>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.character-manager._index/components/character-detail.tsx"},"span":[2823,2836],"sourceCode":"import { useState } from \"react\"\nimport { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { Label } from \"~/components/ui/label\"\nimport { Textarea } from \"~/components/ui/textarea\"\nimport { Avatar, AvatarFallback, AvatarImage } from \"~/components/ui/avatar\"\nimport { Edit2, Save, X, Upload } from \"lucide-react\"\nimport type { Character } from \"../types/character\"\n\ntype Props = {\n  character: Character\n}\n\nexport function CharacterDetail (props: Props) {\n  const [isEditing, setIsEditing] = useState(false)\n  const [editingData, setEditingData] = useState({\n    name: props.character.name,\n    description: props.character.description ?? \"\",\n    promptText: props.character.promptText ?? \"\",\n  })\n\n  const handleSave = () => {\n    // TODO: GraphQLãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æƒ…å ±ã‚’æ›´æ–°\n    console.log(\"ä¿å­˜:\", editingData)\n    setIsEditing(false)\n  }\n\n  const handleCancel = () => {\n    setEditingData({\n      name: props.character.name,\n      description: props.character.description ?? \"\",\n      promptText: props.character.promptText ?? \"\",\n    })\n    setIsEditing(false)\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç”»åƒ */}\n      <div className=\"flex items-center gap-4\">\n        <Avatar className=\"h-20 w-20\">\n          <AvatarImage\n            src={props.character.imageUrl}\n            alt={props.character.name}\n          />\n          <AvatarFallback className=\"text-2xl\">\n            {props.character.name.slice(0, 2)}\n          </AvatarFallback>\n        </Avatar>\n        <Button variant=\"outline\" size=\"sm\">\n          <Upload className=\"mr-2 h-4 w-4\" />\n          ç”»åƒã‚’å¤‰æ›´\n        </Button>\n      </div>\n\n      {/* åŸºæœ¬æƒ…å ± */}\n      <div className=\"space-y-4\">\n        <div className=\"flex items-center justify-between\">\n          <h3 className=\"font-semibold text-lg\">åŸºæœ¬æƒ…å ±</h3>\n          {!isEditing ? (\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setIsEditing(true)}\n            >\n              <Edit2 className=\"mr-2 h-4 w-4\" />\n              ç·¨é›†\n            </Button>\n          ) : (\n            <div className=\"flex gap-2\">\n              <Button variant=\"outline\" size=\"sm\" onClick={handleCancel}>\n                <X className=\"mr-2 h-4 w-4\" />\n                ã‚­ãƒ£ãƒ³ã‚»ãƒ«\n              </Button>\n              <Button size=\"sm\" onClick={handleSave}>\n                <Save className=\"mr-2 h-4 w-4\" />\n                ä¿å­˜\n              </Button>\n            </div>\n          )}\n        </div>\n\n        <div className=\"grid grid-cols-1 gap-4\">\n          <div>\n            <Label htmlFor=\"name\">ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å</Label>\n            {isEditing ? (\n              // biome-ignore lint/nursery/useUniqueElementIds: <explanation>\n              <Input\n                id=\"name\"\n                value={editingData.name}\n                onChange={(e) =>\n                  setEditingData({ ...editingData, name: e.target.value })\n                }\n              />\n            ) : (\n              <p className=\"p-2 text-sm\">{props.character.name}</p>\n            )}\n          </div>\n\n          <div>\n            <Label htmlFor=\"description\">èª¬æ˜</Label>\n            {isEditing ? (\n              // biome-ignore lint/nursery/useUniqueElementIds: <explanation>\n              <Textarea\n                id=\"description\"\n                value={editingData.description}\n                onChange={(e) =>\n                  setEditingData({\n                    ...editingData,\n                    description: e.target.value,\n                  })\n                }\n                rows={3}\n              />\n            ) : (\n              <p className=\"p-2 text-muted-foreground text-sm\">\n                {props.character.description || \"èª¬æ˜ãŒã‚ã‚Šã¾ã›ã‚“\"}\n              </p>\n            )}\n          </div>\n\n          <div>\n            <Label htmlFor=\"promptText\">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ†ã‚­ã‚¹ãƒˆ</Label>\n            {isEditing ? (\n              // biome-ignore lint/nursery/useUniqueElementIds: <explanation>\n              <Textarea\n                id=\"promptText\"\n                value={editingData.promptText}\n                onChange={(e) =>\n                  setEditingData({ ...editingData, promptText: e.target.value })\n                }\n                rows={4}\n                placeholder=\"ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®ç‰¹å¾´ã‚„ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¨˜è¿°...\"\n              />\n            ) : (\n              <p className=\"rounded bg-muted p-2 font-mono text-sm\">\n                {props.character.promptText || \"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“\"}\n              </p>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.character-manager._index/components/character-detail.tsx"},"span":[3350,3363],"sourceCode":"import { useState } from \"react\"\nimport { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { Label } from \"~/components/ui/label\"\nimport { Textarea } from \"~/components/ui/textarea\"\nimport { Avatar, AvatarFallback, AvatarImage } from \"~/components/ui/avatar\"\nimport { Edit2, Save, X, Upload } from \"lucide-react\"\nimport type { Character } from \"../types/character\"\n\ntype Props = {\n  character: Character\n}\n\nexport function CharacterDetail (props: Props) {\n  const [isEditing, setIsEditing] = useState(false)\n  const [editingData, setEditingData] = useState({\n    name: props.character.name,\n    description: props.character.description ?? \"\",\n    promptText: props.character.promptText ?? \"\",\n  })\n\n  const handleSave = () => {\n    // TODO: GraphQLãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æƒ…å ±ã‚’æ›´æ–°\n    console.log(\"ä¿å­˜:\", editingData)\n    setIsEditing(false)\n  }\n\n  const handleCancel = () => {\n    setEditingData({\n      name: props.character.name,\n      description: props.character.description ?? \"\",\n      promptText: props.character.promptText ?? \"\",\n    })\n    setIsEditing(false)\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç”»åƒ */}\n      <div className=\"flex items-center gap-4\">\n        <Avatar className=\"h-20 w-20\">\n          <AvatarImage\n            src={props.character.imageUrl}\n            alt={props.character.name}\n          />\n          <AvatarFallback className=\"text-2xl\">\n            {props.character.name.slice(0, 2)}\n          </AvatarFallback>\n        </Avatar>\n        <Button variant=\"outline\" size=\"sm\">\n          <Upload className=\"mr-2 h-4 w-4\" />\n          ç”»åƒã‚’å¤‰æ›´\n        </Button>\n      </div>\n\n      {/* åŸºæœ¬æƒ…å ± */}\n      <div className=\"space-y-4\">\n        <div className=\"flex items-center justify-between\">\n          <h3 className=\"font-semibold text-lg\">åŸºæœ¬æƒ…å ±</h3>\n          {!isEditing ? (\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setIsEditing(true)}\n            >\n              <Edit2 className=\"mr-2 h-4 w-4\" />\n              ç·¨é›†\n            </Button>\n          ) : (\n            <div className=\"flex gap-2\">\n              <Button variant=\"outline\" size=\"sm\" onClick={handleCancel}>\n                <X className=\"mr-2 h-4 w-4\" />\n                ã‚­ãƒ£ãƒ³ã‚»ãƒ«\n              </Button>\n              <Button size=\"sm\" onClick={handleSave}>\n                <Save className=\"mr-2 h-4 w-4\" />\n                ä¿å­˜\n              </Button>\n            </div>\n          )}\n        </div>\n\n        <div className=\"grid grid-cols-1 gap-4\">\n          <div>\n            <Label htmlFor=\"name\">ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å</Label>\n            {isEditing ? (\n              // biome-ignore lint/nursery/useUniqueElementIds: <explanation>\n              <Input\n                id=\"name\"\n                value={editingData.name}\n                onChange={(e) =>\n                  setEditingData({ ...editingData, name: e.target.value })\n                }\n              />\n            ) : (\n              <p className=\"p-2 text-sm\">{props.character.name}</p>\n            )}\n          </div>\n\n          <div>\n            <Label htmlFor=\"description\">èª¬æ˜</Label>\n            {isEditing ? (\n              // biome-ignore lint/nursery/useUniqueElementIds: <explanation>\n              <Textarea\n                id=\"description\"\n                value={editingData.description}\n                onChange={(e) =>\n                  setEditingData({\n                    ...editingData,\n                    description: e.target.value,\n                  })\n                }\n                rows={3}\n              />\n            ) : (\n              <p className=\"p-2 text-muted-foreground text-sm\">\n                {props.character.description || \"èª¬æ˜ãŒã‚ã‚Šã¾ã›ã‚“\"}\n              </p>\n            )}\n          </div>\n\n          <div>\n            <Label htmlFor=\"promptText\">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ†ã‚­ã‚¹ãƒˆ</Label>\n            {isEditing ? (\n              // biome-ignore lint/nursery/useUniqueElementIds: <explanation>\n              <Textarea\n                id=\"promptText\"\n                value={editingData.promptText}\n                onChange={(e) =>\n                  setEditingData({ ...editingData, promptText: e.target.value })\n                }\n                rows={4}\n                placeholder=\"ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®ç‰¹å¾´ã‚„ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¨˜è¿°...\"\n              />\n            ) : (\n              <p className=\"rounded bg-muted p-2 font-mono text-sm\">\n                {props.character.promptText || \"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“\"}\n              </p>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.character-manager._index/components/character-detail.tsx"},"span":[4096,4109],"sourceCode":"import { useState } from \"react\"\nimport { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { Label } from \"~/components/ui/label\"\nimport { Textarea } from \"~/components/ui/textarea\"\nimport { Avatar, AvatarFallback, AvatarImage } from \"~/components/ui/avatar\"\nimport { Edit2, Save, X, Upload } from \"lucide-react\"\nimport type { Character } from \"../types/character\"\n\ntype Props = {\n  character: Character\n}\n\nexport function CharacterDetail (props: Props) {\n  const [isEditing, setIsEditing] = useState(false)\n  const [editingData, setEditingData] = useState({\n    name: props.character.name,\n    description: props.character.description ?? \"\",\n    promptText: props.character.promptText ?? \"\",\n  })\n\n  const handleSave = () => {\n    // TODO: GraphQLãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æƒ…å ±ã‚’æ›´æ–°\n    console.log(\"ä¿å­˜:\", editingData)\n    setIsEditing(false)\n  }\n\n  const handleCancel = () => {\n    setEditingData({\n      name: props.character.name,\n      description: props.character.description ?? \"\",\n      promptText: props.character.promptText ?? \"\",\n    })\n    setIsEditing(false)\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç”»åƒ */}\n      <div className=\"flex items-center gap-4\">\n        <Avatar className=\"h-20 w-20\">\n          <AvatarImage\n            src={props.character.imageUrl}\n            alt={props.character.name}\n          />\n          <AvatarFallback className=\"text-2xl\">\n            {props.character.name.slice(0, 2)}\n          </AvatarFallback>\n        </Avatar>\n        <Button variant=\"outline\" size=\"sm\">\n          <Upload className=\"mr-2 h-4 w-4\" />\n          ç”»åƒã‚’å¤‰æ›´\n        </Button>\n      </div>\n\n      {/* åŸºæœ¬æƒ…å ± */}\n      <div className=\"space-y-4\">\n        <div className=\"flex items-center justify-between\">\n          <h3 className=\"font-semibold text-lg\">åŸºæœ¬æƒ…å ±</h3>\n          {!isEditing ? (\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setIsEditing(true)}\n            >\n              <Edit2 className=\"mr-2 h-4 w-4\" />\n              ç·¨é›†\n            </Button>\n          ) : (\n            <div className=\"flex gap-2\">\n              <Button variant=\"outline\" size=\"sm\" onClick={handleCancel}>\n                <X className=\"mr-2 h-4 w-4\" />\n                ã‚­ãƒ£ãƒ³ã‚»ãƒ«\n              </Button>\n              <Button size=\"sm\" onClick={handleSave}>\n                <Save className=\"mr-2 h-4 w-4\" />\n                ä¿å­˜\n              </Button>\n            </div>\n          )}\n        </div>\n\n        <div className=\"grid grid-cols-1 gap-4\">\n          <div>\n            <Label htmlFor=\"name\">ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å</Label>\n            {isEditing ? (\n              // biome-ignore lint/nursery/useUniqueElementIds: <explanation>\n              <Input\n                id=\"name\"\n                value={editingData.name}\n                onChange={(e) =>\n                  setEditingData({ ...editingData, name: e.target.value })\n                }\n              />\n            ) : (\n              <p className=\"p-2 text-sm\">{props.character.name}</p>\n            )}\n          </div>\n\n          <div>\n            <Label htmlFor=\"description\">èª¬æ˜</Label>\n            {isEditing ? (\n              // biome-ignore lint/nursery/useUniqueElementIds: <explanation>\n              <Textarea\n                id=\"description\"\n                value={editingData.description}\n                onChange={(e) =>\n                  setEditingData({\n                    ...editingData,\n                    description: e.target.value,\n                  })\n                }\n                rows={3}\n              />\n            ) : (\n              <p className=\"p-2 text-muted-foreground text-sm\">\n                {props.character.description || \"èª¬æ˜ãŒã‚ã‚Šã¾ã›ã‚“\"}\n              </p>\n            )}\n          </div>\n\n          <div>\n            <Label htmlFor=\"promptText\">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ†ã‚­ã‚¹ãƒˆ</Label>\n            {isEditing ? (\n              // biome-ignore lint/nursery/useUniqueElementIds: <explanation>\n              <Textarea\n                id=\"promptText\"\n                value={editingData.promptText}\n                onChange={(e) =>\n                  setEditingData({ ...editingData, promptText: e.target.value })\n                }\n                rows={4}\n                placeholder=\"ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®ç‰¹å¾´ã‚„ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¨˜è¿°...\"\n              />\n            ) : (\n              <p className=\"rounded bg-muted p-2 font-mono text-sm\">\n                {props.character.promptText || \"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“\"}\n              </p>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.character-manager._index/components/expression-manager.tsx"},"span":[3659,3672],"sourceCode":"import { useState } from \"react\"\nimport { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { Label } from \"~/components/ui/label\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"~/components/ui/card\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { Plus, Upload, Edit2, Trash2, Copy } from \"lucide-react\"\nimport type { Character, Expression } from \"../types/character\"\n\ntype Props = {\n  character: Character\n}\n\nexport function ExpressionManager (props: Props) {\n  // ãƒ¢ãƒƒã‚¯è¡¨æƒ…ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã¯APIã‹ã‚‰å–å¾—ï¼‰\n  const [expressions, setExpressions] = useState<Expression[]>([\n    {\n      id: \"1\",\n      name: \"ç¬‘é¡”\",\n      description: \"æ˜ã‚‹ã„ç¬‘é¡”ã®è¡¨æƒ…\",\n      imageUrl: undefined,\n      promptModifier: \"smiling, happy, cheerful\",\n      tags: [\"ãƒã‚¸ãƒ†ã‚£ãƒ–\", \"åŸºæœ¬\"],\n      createdAt: new Date().toISOString(),\n    },\n    {\n      id: \"2\",\n      name: \"å›°ã£ãŸé¡”\",\n      description: \"å›°ã£ãŸæ™‚ã®è¡¨æƒ…\",\n      imageUrl: undefined,\n      promptModifier: \"troubled, worried, confused\",\n      tags: [\"ãƒã‚¬ãƒ†ã‚£ãƒ–\", \"æ„Ÿæƒ…\"],\n      createdAt: new Date().toISOString(),\n    },\n    {\n      id: \"3\",\n      name: \"æ€’ã‚Š\",\n      description: \"æ€’ã£ã¦ã„ã‚‹è¡¨æƒ…\",\n      imageUrl: undefined,\n      promptModifier: \"angry, furious, mad\",\n      tags: [\"ãƒã‚¬ãƒ†ã‚£ãƒ–\", \"å¼·ã„æ„Ÿæƒ…\"],\n      createdAt: new Date().toISOString(),\n    },\n  ])\n\n  const [isAddingNew, setIsAddingNew] = useState(false)\n  const [newExpression, setNewExpression] = useState({\n    name: \"\",\n    description: \"\",\n    promptModifier: \"\",\n    tags: \"\",\n  })\n\n  const handleAddExpression = () => {\n    if (!newExpression.name || !newExpression.promptModifier) return\n\n    const expression: Expression = {\n      id: Date.now().toString(),\n      name: newExpression.name,\n      description: newExpression.description,\n      imageUrl: undefined,\n      promptModifier: newExpression.promptModifier,\n      tags: newExpression.tags\n        .split(\",\")\n        .map((tag) => tag.trim())\n        .filter(Boolean),\n      createdAt: new Date().toISOString(),\n    }\n\n    setExpressions([...expressions, expression])\n    setNewExpression({\n      name: \"\",\n      description: \"\",\n      promptModifier: \"\",\n      tags: \"\",\n    })\n    setIsAddingNew(false)\n  }\n\n  const handleDeleteExpression = (expressionId: string) => {\n    setExpressions(expressions.filter((exp) => exp.id !== expressionId))\n  }\n\n  const handleCopyPrompt = (promptModifier: string) => {\n    navigator.clipboard.writeText(\n      `${props.character.promptText}, ${promptModifier}`,\n    )\n    // TODO: ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’è¡¨ç¤º\n    console.log(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ\")\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h3 className=\"font-semibold text-lg\">è¡¨æƒ…å·®åˆ†ç®¡ç†</h3>\n          <p className=\"text-muted-foreground text-sm\">\n            {props.character.name}ã®è¡¨æƒ…ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç®¡ç†ã—ã¾ã™\n          </p>\n        </div>\n        <Button onClick={() => setIsAddingNew(true)} disabled={isAddingNew}>\n          <Plus className=\"mr-2 h-4 w-4\" />\n          è¡¨æƒ…è¿½åŠ \n        </Button>\n      </div>\n\n      {/* æ–°ã—ã„è¡¨æƒ…è¿½åŠ ãƒ•ã‚©ãƒ¼ãƒ  */}\n      {isAddingNew && (\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-base\">æ–°ã—ã„è¡¨æƒ…ã‚’è¿½åŠ </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"expression-name\">è¡¨æƒ…å</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-name\"\n                value={newExpression.name}\n                onChange={(e) =>\n                  setNewExpression({ ...newExpression, name: e.target.value })\n                }\n                placeholder=\"ä¾‹: ç¬‘é¡”ã€å›°ã£ãŸé¡”ã€æ€’ã‚Š\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"expression-description\">èª¬æ˜</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-description\"\n                value={newExpression.description}\n                onChange={(e) =>\n                  setNewExpression({\n                    ...newExpression,\n                    description: e.target.value,\n                  })\n                }\n                placeholder=\"è¡¨æƒ…ã®è©³ç´°èª¬æ˜\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"expression-prompt\">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¿®é£¾å­</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-prompt\"\n                value={newExpression.promptModifier}\n                onChange={(e) =>\n                  setNewExpression({\n                    ...newExpression,\n                    promptModifier: e.target.value,\n                  })\n                }\n                placeholder=\"ä¾‹: smiling, happy, cheerful\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"expression-tags\">ã‚¿ã‚°ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-tags\"\n                value={newExpression.tags}\n                onChange={(e) =>\n                  setNewExpression({ ...newExpression, tags: e.target.value })\n                }\n                placeholder=\"ä¾‹: ãƒã‚¸ãƒ†ã‚£ãƒ–, åŸºæœ¬, æ„Ÿæƒ…\"\n              />\n            </div>\n            <div className=\"flex gap-2\">\n              <Button\n                onClick={handleAddExpression}\n                disabled={!newExpression.name || !newExpression.promptModifier}\n              >\n                è¿½åŠ \n              </Button>\n              <Button variant=\"outline\" onClick={() => setIsAddingNew(false)}>\n                ã‚­ãƒ£ãƒ³ã‚»ãƒ«\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* è¡¨æƒ…ä¸€è¦§ */}\n      <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2\">\n        {expressions.map((expression) => (\n          <Card key={expression.id}>\n            <CardHeader className=\"pb-2\">\n              <div className=\"flex items-center justify-between\">\n                <CardTitle className=\"text-base\">{expression.name}</CardTitle>\n                <div className=\"flex gap-1\">\n                  <Button variant=\"ghost\" size=\"sm\">\n                    <Upload className=\"h-3 w-3\" />\n                  </Button>\n                  <Button variant=\"ghost\" size=\"sm\">\n                    <Edit2 className=\"h-3 w-3\" />\n                  </Button>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => handleDeleteExpression(expression.id)}\n                  >\n                    <Trash2 className=\"h-3 w-3\" />\n                  </Button>\n                </div>\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"text-muted-foreground text-sm\">\n                {expression.description}\n              </p>\n\n              <div>\n                <Label className=\"text-xs\">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¿®é£¾å­</Label>\n                <div className=\"mt-1 flex items-center gap-2\">\n                  <code className=\"flex-1 rounded bg-muted p-2 font-mono text-xs\">\n                    {expression.promptModifier}\n                  </code>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => handleCopyPrompt(expression.promptModifier)}\n                  >\n                    <Copy className=\"h-3 w-3\" />\n                  </Button>\n                </div>\n              </div>\n\n              <div className=\"flex flex-wrap gap-1\">\n                {expression.tags.map((tag, index) => (\n                  <Badge key={index} variant=\"secondary\" className=\"text-xs\">\n                    {tag}\n                  </Badge>\n                ))}\n              </div>\n\n              <div className=\"flex gap-2 pt-2\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  className=\"flex-1\"\n                  onClick={() => handleCopyPrompt(expression.promptModifier)}\n                >\n                  <Copy className=\"mr-1 h-3 w-3\" />\n                  ã‚³ãƒ”ãƒ¼\n                </Button>\n                <Button variant=\"outline\" size=\"sm\" className=\"flex-1\">\n                  ç”Ÿæˆãƒ†ã‚¹ãƒˆ\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {expressions.length === 0 && !isAddingNew && (\n        <Card>\n          <CardContent className=\"py-8 text-center\">\n            <p className=\"text-muted-foreground\">\n              ã¾ã è¡¨æƒ…å·®åˆ†ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“\n            </p>\n            <Button\n              variant=\"outline\"\n              className=\"mt-2\"\n              onClick={() => setIsAddingNew(true)}\n            >\n              <Plus className=\"mr-2 h-4 w-4\" />\n              æœ€åˆã®è¡¨æƒ…ã‚’è¿½åŠ \n            </Button>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.character-manager._index/components/expression-manager.tsx"},"span":[4163,4176],"sourceCode":"import { useState } from \"react\"\nimport { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { Label } from \"~/components/ui/label\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"~/components/ui/card\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { Plus, Upload, Edit2, Trash2, Copy } from \"lucide-react\"\nimport type { Character, Expression } from \"../types/character\"\n\ntype Props = {\n  character: Character\n}\n\nexport function ExpressionManager (props: Props) {\n  // ãƒ¢ãƒƒã‚¯è¡¨æƒ…ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã¯APIã‹ã‚‰å–å¾—ï¼‰\n  const [expressions, setExpressions] = useState<Expression[]>([\n    {\n      id: \"1\",\n      name: \"ç¬‘é¡”\",\n      description: \"æ˜ã‚‹ã„ç¬‘é¡”ã®è¡¨æƒ…\",\n      imageUrl: undefined,\n      promptModifier: \"smiling, happy, cheerful\",\n      tags: [\"ãƒã‚¸ãƒ†ã‚£ãƒ–\", \"åŸºæœ¬\"],\n      createdAt: new Date().toISOString(),\n    },\n    {\n      id: \"2\",\n      name: \"å›°ã£ãŸé¡”\",\n      description: \"å›°ã£ãŸæ™‚ã®è¡¨æƒ…\",\n      imageUrl: undefined,\n      promptModifier: \"troubled, worried, confused\",\n      tags: [\"ãƒã‚¬ãƒ†ã‚£ãƒ–\", \"æ„Ÿæƒ…\"],\n      createdAt: new Date().toISOString(),\n    },\n    {\n      id: \"3\",\n      name: \"æ€’ã‚Š\",\n      description: \"æ€’ã£ã¦ã„ã‚‹è¡¨æƒ…\",\n      imageUrl: undefined,\n      promptModifier: \"angry, furious, mad\",\n      tags: [\"ãƒã‚¬ãƒ†ã‚£ãƒ–\", \"å¼·ã„æ„Ÿæƒ…\"],\n      createdAt: new Date().toISOString(),\n    },\n  ])\n\n  const [isAddingNew, setIsAddingNew] = useState(false)\n  const [newExpression, setNewExpression] = useState({\n    name: \"\",\n    description: \"\",\n    promptModifier: \"\",\n    tags: \"\",\n  })\n\n  const handleAddExpression = () => {\n    if (!newExpression.name || !newExpression.promptModifier) return\n\n    const expression: Expression = {\n      id: Date.now().toString(),\n      name: newExpression.name,\n      description: newExpression.description,\n      imageUrl: undefined,\n      promptModifier: newExpression.promptModifier,\n      tags: newExpression.tags\n        .split(\",\")\n        .map((tag) => tag.trim())\n        .filter(Boolean),\n      createdAt: new Date().toISOString(),\n    }\n\n    setExpressions([...expressions, expression])\n    setNewExpression({\n      name: \"\",\n      description: \"\",\n      promptModifier: \"\",\n      tags: \"\",\n    })\n    setIsAddingNew(false)\n  }\n\n  const handleDeleteExpression = (expressionId: string) => {\n    setExpressions(expressions.filter((exp) => exp.id !== expressionId))\n  }\n\n  const handleCopyPrompt = (promptModifier: string) => {\n    navigator.clipboard.writeText(\n      `${props.character.promptText}, ${promptModifier}`,\n    )\n    // TODO: ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’è¡¨ç¤º\n    console.log(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ\")\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h3 className=\"font-semibold text-lg\">è¡¨æƒ…å·®åˆ†ç®¡ç†</h3>\n          <p className=\"text-muted-foreground text-sm\">\n            {props.character.name}ã®è¡¨æƒ…ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç®¡ç†ã—ã¾ã™\n          </p>\n        </div>\n        <Button onClick={() => setIsAddingNew(true)} disabled={isAddingNew}>\n          <Plus className=\"mr-2 h-4 w-4\" />\n          è¡¨æƒ…è¿½åŠ \n        </Button>\n      </div>\n\n      {/* æ–°ã—ã„è¡¨æƒ…è¿½åŠ ãƒ•ã‚©ãƒ¼ãƒ  */}\n      {isAddingNew && (\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-base\">æ–°ã—ã„è¡¨æƒ…ã‚’è¿½åŠ </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"expression-name\">è¡¨æƒ…å</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-name\"\n                value={newExpression.name}\n                onChange={(e) =>\n                  setNewExpression({ ...newExpression, name: e.target.value })\n                }\n                placeholder=\"ä¾‹: ç¬‘é¡”ã€å›°ã£ãŸé¡”ã€æ€’ã‚Š\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"expression-description\">èª¬æ˜</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-description\"\n                value={newExpression.description}\n                onChange={(e) =>\n                  setNewExpression({\n                    ...newExpression,\n                    description: e.target.value,\n                  })\n                }\n                placeholder=\"è¡¨æƒ…ã®è©³ç´°èª¬æ˜\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"expression-prompt\">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¿®é£¾å­</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-prompt\"\n                value={newExpression.promptModifier}\n                onChange={(e) =>\n                  setNewExpression({\n                    ...newExpression,\n                    promptModifier: e.target.value,\n                  })\n                }\n                placeholder=\"ä¾‹: smiling, happy, cheerful\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"expression-tags\">ã‚¿ã‚°ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-tags\"\n                value={newExpression.tags}\n                onChange={(e) =>\n                  setNewExpression({ ...newExpression, tags: e.target.value })\n                }\n                placeholder=\"ä¾‹: ãƒã‚¸ãƒ†ã‚£ãƒ–, åŸºæœ¬, æ„Ÿæƒ…\"\n              />\n            </div>\n            <div className=\"flex gap-2\">\n              <Button\n                onClick={handleAddExpression}\n                disabled={!newExpression.name || !newExpression.promptModifier}\n              >\n                è¿½åŠ \n              </Button>\n              <Button variant=\"outline\" onClick={() => setIsAddingNew(false)}>\n                ã‚­ãƒ£ãƒ³ã‚»ãƒ«\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* è¡¨æƒ…ä¸€è¦§ */}\n      <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2\">\n        {expressions.map((expression) => (\n          <Card key={expression.id}>\n            <CardHeader className=\"pb-2\">\n              <div className=\"flex items-center justify-between\">\n                <CardTitle className=\"text-base\">{expression.name}</CardTitle>\n                <div className=\"flex gap-1\">\n                  <Button variant=\"ghost\" size=\"sm\">\n                    <Upload className=\"h-3 w-3\" />\n                  </Button>\n                  <Button variant=\"ghost\" size=\"sm\">\n                    <Edit2 className=\"h-3 w-3\" />\n                  </Button>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => handleDeleteExpression(expression.id)}\n                  >\n                    <Trash2 className=\"h-3 w-3\" />\n                  </Button>\n                </div>\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"text-muted-foreground text-sm\">\n                {expression.description}\n              </p>\n\n              <div>\n                <Label className=\"text-xs\">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¿®é£¾å­</Label>\n                <div className=\"mt-1 flex items-center gap-2\">\n                  <code className=\"flex-1 rounded bg-muted p-2 font-mono text-xs\">\n                    {expression.promptModifier}\n                  </code>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => handleCopyPrompt(expression.promptModifier)}\n                  >\n                    <Copy className=\"h-3 w-3\" />\n                  </Button>\n                </div>\n              </div>\n\n              <div className=\"flex flex-wrap gap-1\">\n                {expression.tags.map((tag, index) => (\n                  <Badge key={index} variant=\"secondary\" className=\"text-xs\">\n                    {tag}\n                  </Badge>\n                ))}\n              </div>\n\n              <div className=\"flex gap-2 pt-2\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  className=\"flex-1\"\n                  onClick={() => handleCopyPrompt(expression.promptModifier)}\n                >\n                  <Copy className=\"mr-1 h-3 w-3\" />\n                  ã‚³ãƒ”ãƒ¼\n                </Button>\n                <Button variant=\"outline\" size=\"sm\" className=\"flex-1\">\n                  ç”Ÿæˆãƒ†ã‚¹ãƒˆ\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {expressions.length === 0 && !isAddingNew && (\n        <Card>\n          <CardContent className=\"py-8 text-center\">\n            <p className=\"text-muted-foreground\">\n              ã¾ã è¡¨æƒ…å·®åˆ†ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“\n            </p>\n            <Button\n              variant=\"outline\"\n              className=\"mt-2\"\n              onClick={() => setIsAddingNew(true)}\n            >\n              <Plus className=\"mr-2 h-4 w-4\" />\n              æœ€åˆã®è¡¨æƒ…ã‚’è¿½åŠ \n            </Button>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.character-manager._index/components/expression-manager.tsx"},"span":[4746,4759],"sourceCode":"import { useState } from \"react\"\nimport { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { Label } from \"~/components/ui/label\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"~/components/ui/card\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { Plus, Upload, Edit2, Trash2, Copy } from \"lucide-react\"\nimport type { Character, Expression } from \"../types/character\"\n\ntype Props = {\n  character: Character\n}\n\nexport function ExpressionManager (props: Props) {\n  // ãƒ¢ãƒƒã‚¯è¡¨æƒ…ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã¯APIã‹ã‚‰å–å¾—ï¼‰\n  const [expressions, setExpressions] = useState<Expression[]>([\n    {\n      id: \"1\",\n      name: \"ç¬‘é¡”\",\n      description: \"æ˜ã‚‹ã„ç¬‘é¡”ã®è¡¨æƒ…\",\n      imageUrl: undefined,\n      promptModifier: \"smiling, happy, cheerful\",\n      tags: [\"ãƒã‚¸ãƒ†ã‚£ãƒ–\", \"åŸºæœ¬\"],\n      createdAt: new Date().toISOString(),\n    },\n    {\n      id: \"2\",\n      name: \"å›°ã£ãŸé¡”\",\n      description: \"å›°ã£ãŸæ™‚ã®è¡¨æƒ…\",\n      imageUrl: undefined,\n      promptModifier: \"troubled, worried, confused\",\n      tags: [\"ãƒã‚¬ãƒ†ã‚£ãƒ–\", \"æ„Ÿæƒ…\"],\n      createdAt: new Date().toISOString(),\n    },\n    {\n      id: \"3\",\n      name: \"æ€’ã‚Š\",\n      description: \"æ€’ã£ã¦ã„ã‚‹è¡¨æƒ…\",\n      imageUrl: undefined,\n      promptModifier: \"angry, furious, mad\",\n      tags: [\"ãƒã‚¬ãƒ†ã‚£ãƒ–\", \"å¼·ã„æ„Ÿæƒ…\"],\n      createdAt: new Date().toISOString(),\n    },\n  ])\n\n  const [isAddingNew, setIsAddingNew] = useState(false)\n  const [newExpression, setNewExpression] = useState({\n    name: \"\",\n    description: \"\",\n    promptModifier: \"\",\n    tags: \"\",\n  })\n\n  const handleAddExpression = () => {\n    if (!newExpression.name || !newExpression.promptModifier) return\n\n    const expression: Expression = {\n      id: Date.now().toString(),\n      name: newExpression.name,\n      description: newExpression.description,\n      imageUrl: undefined,\n      promptModifier: newExpression.promptModifier,\n      tags: newExpression.tags\n        .split(\",\")\n        .map((tag) => tag.trim())\n        .filter(Boolean),\n      createdAt: new Date().toISOString(),\n    }\n\n    setExpressions([...expressions, expression])\n    setNewExpression({\n      name: \"\",\n      description: \"\",\n      promptModifier: \"\",\n      tags: \"\",\n    })\n    setIsAddingNew(false)\n  }\n\n  const handleDeleteExpression = (expressionId: string) => {\n    setExpressions(expressions.filter((exp) => exp.id !== expressionId))\n  }\n\n  const handleCopyPrompt = (promptModifier: string) => {\n    navigator.clipboard.writeText(\n      `${props.character.promptText}, ${promptModifier}`,\n    )\n    // TODO: ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’è¡¨ç¤º\n    console.log(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ\")\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h3 className=\"font-semibold text-lg\">è¡¨æƒ…å·®åˆ†ç®¡ç†</h3>\n          <p className=\"text-muted-foreground text-sm\">\n            {props.character.name}ã®è¡¨æƒ…ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç®¡ç†ã—ã¾ã™\n          </p>\n        </div>\n        <Button onClick={() => setIsAddingNew(true)} disabled={isAddingNew}>\n          <Plus className=\"mr-2 h-4 w-4\" />\n          è¡¨æƒ…è¿½åŠ \n        </Button>\n      </div>\n\n      {/* æ–°ã—ã„è¡¨æƒ…è¿½åŠ ãƒ•ã‚©ãƒ¼ãƒ  */}\n      {isAddingNew && (\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-base\">æ–°ã—ã„è¡¨æƒ…ã‚’è¿½åŠ </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"expression-name\">è¡¨æƒ…å</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-name\"\n                value={newExpression.name}\n                onChange={(e) =>\n                  setNewExpression({ ...newExpression, name: e.target.value })\n                }\n                placeholder=\"ä¾‹: ç¬‘é¡”ã€å›°ã£ãŸé¡”ã€æ€’ã‚Š\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"expression-description\">èª¬æ˜</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-description\"\n                value={newExpression.description}\n                onChange={(e) =>\n                  setNewExpression({\n                    ...newExpression,\n                    description: e.target.value,\n                  })\n                }\n                placeholder=\"è¡¨æƒ…ã®è©³ç´°èª¬æ˜\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"expression-prompt\">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¿®é£¾å­</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-prompt\"\n                value={newExpression.promptModifier}\n                onChange={(e) =>\n                  setNewExpression({\n                    ...newExpression,\n                    promptModifier: e.target.value,\n                  })\n                }\n                placeholder=\"ä¾‹: smiling, happy, cheerful\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"expression-tags\">ã‚¿ã‚°ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-tags\"\n                value={newExpression.tags}\n                onChange={(e) =>\n                  setNewExpression({ ...newExpression, tags: e.target.value })\n                }\n                placeholder=\"ä¾‹: ãƒã‚¸ãƒ†ã‚£ãƒ–, åŸºæœ¬, æ„Ÿæƒ…\"\n              />\n            </div>\n            <div className=\"flex gap-2\">\n              <Button\n                onClick={handleAddExpression}\n                disabled={!newExpression.name || !newExpression.promptModifier}\n              >\n                è¿½åŠ \n              </Button>\n              <Button variant=\"outline\" onClick={() => setIsAddingNew(false)}>\n                ã‚­ãƒ£ãƒ³ã‚»ãƒ«\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* è¡¨æƒ…ä¸€è¦§ */}\n      <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2\">\n        {expressions.map((expression) => (\n          <Card key={expression.id}>\n            <CardHeader className=\"pb-2\">\n              <div className=\"flex items-center justify-between\">\n                <CardTitle className=\"text-base\">{expression.name}</CardTitle>\n                <div className=\"flex gap-1\">\n                  <Button variant=\"ghost\" size=\"sm\">\n                    <Upload className=\"h-3 w-3\" />\n                  </Button>\n                  <Button variant=\"ghost\" size=\"sm\">\n                    <Edit2 className=\"h-3 w-3\" />\n                  </Button>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => handleDeleteExpression(expression.id)}\n                  >\n                    <Trash2 className=\"h-3 w-3\" />\n                  </Button>\n                </div>\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"text-muted-foreground text-sm\">\n                {expression.description}\n              </p>\n\n              <div>\n                <Label className=\"text-xs\">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¿®é£¾å­</Label>\n                <div className=\"mt-1 flex items-center gap-2\">\n                  <code className=\"flex-1 rounded bg-muted p-2 font-mono text-xs\">\n                    {expression.promptModifier}\n                  </code>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => handleCopyPrompt(expression.promptModifier)}\n                  >\n                    <Copy className=\"h-3 w-3\" />\n                  </Button>\n                </div>\n              </div>\n\n              <div className=\"flex flex-wrap gap-1\">\n                {expression.tags.map((tag, index) => (\n                  <Badge key={index} variant=\"secondary\" className=\"text-xs\">\n                    {tag}\n                  </Badge>\n                ))}\n              </div>\n\n              <div className=\"flex gap-2 pt-2\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  className=\"flex-1\"\n                  onClick={() => handleCopyPrompt(expression.promptModifier)}\n                >\n                  <Copy className=\"mr-1 h-3 w-3\" />\n                  ã‚³ãƒ”ãƒ¼\n                </Button>\n                <Button variant=\"outline\" size=\"sm\" className=\"flex-1\">\n                  ç”Ÿæˆãƒ†ã‚¹ãƒˆ\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {expressions.length === 0 && !isAddingNew && (\n        <Card>\n          <CardContent className=\"py-8 text-center\">\n            <p className=\"text-muted-foreground\">\n              ã¾ã è¡¨æƒ…å·®åˆ†ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“\n            </p>\n            <Button\n              variant=\"outline\"\n              className=\"mt-2\"\n              onClick={() => setIsAddingNew(true)}\n            >\n              <Plus className=\"mr-2 h-4 w-4\" />\n              æœ€åˆã®è¡¨æƒ…ã‚’è¿½åŠ \n            </Button>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.character-manager._index/components/expression-manager.tsx"},"span":[5342,5355],"sourceCode":"import { useState } from \"react\"\nimport { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { Label } from \"~/components/ui/label\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"~/components/ui/card\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { Plus, Upload, Edit2, Trash2, Copy } from \"lucide-react\"\nimport type { Character, Expression } from \"../types/character\"\n\ntype Props = {\n  character: Character\n}\n\nexport function ExpressionManager (props: Props) {\n  // ãƒ¢ãƒƒã‚¯è¡¨æƒ…ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã¯APIã‹ã‚‰å–å¾—ï¼‰\n  const [expressions, setExpressions] = useState<Expression[]>([\n    {\n      id: \"1\",\n      name: \"ç¬‘é¡”\",\n      description: \"æ˜ã‚‹ã„ç¬‘é¡”ã®è¡¨æƒ…\",\n      imageUrl: undefined,\n      promptModifier: \"smiling, happy, cheerful\",\n      tags: [\"ãƒã‚¸ãƒ†ã‚£ãƒ–\", \"åŸºæœ¬\"],\n      createdAt: new Date().toISOString(),\n    },\n    {\n      id: \"2\",\n      name: \"å›°ã£ãŸé¡”\",\n      description: \"å›°ã£ãŸæ™‚ã®è¡¨æƒ…\",\n      imageUrl: undefined,\n      promptModifier: \"troubled, worried, confused\",\n      tags: [\"ãƒã‚¬ãƒ†ã‚£ãƒ–\", \"æ„Ÿæƒ…\"],\n      createdAt: new Date().toISOString(),\n    },\n    {\n      id: \"3\",\n      name: \"æ€’ã‚Š\",\n      description: \"æ€’ã£ã¦ã„ã‚‹è¡¨æƒ…\",\n      imageUrl: undefined,\n      promptModifier: \"angry, furious, mad\",\n      tags: [\"ãƒã‚¬ãƒ†ã‚£ãƒ–\", \"å¼·ã„æ„Ÿæƒ…\"],\n      createdAt: new Date().toISOString(),\n    },\n  ])\n\n  const [isAddingNew, setIsAddingNew] = useState(false)\n  const [newExpression, setNewExpression] = useState({\n    name: \"\",\n    description: \"\",\n    promptModifier: \"\",\n    tags: \"\",\n  })\n\n  const handleAddExpression = () => {\n    if (!newExpression.name || !newExpression.promptModifier) return\n\n    const expression: Expression = {\n      id: Date.now().toString(),\n      name: newExpression.name,\n      description: newExpression.description,\n      imageUrl: undefined,\n      promptModifier: newExpression.promptModifier,\n      tags: newExpression.tags\n        .split(\",\")\n        .map((tag) => tag.trim())\n        .filter(Boolean),\n      createdAt: new Date().toISOString(),\n    }\n\n    setExpressions([...expressions, expression])\n    setNewExpression({\n      name: \"\",\n      description: \"\",\n      promptModifier: \"\",\n      tags: \"\",\n    })\n    setIsAddingNew(false)\n  }\n\n  const handleDeleteExpression = (expressionId: string) => {\n    setExpressions(expressions.filter((exp) => exp.id !== expressionId))\n  }\n\n  const handleCopyPrompt = (promptModifier: string) => {\n    navigator.clipboard.writeText(\n      `${props.character.promptText}, ${promptModifier}`,\n    )\n    // TODO: ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’è¡¨ç¤º\n    console.log(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ\")\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h3 className=\"font-semibold text-lg\">è¡¨æƒ…å·®åˆ†ç®¡ç†</h3>\n          <p className=\"text-muted-foreground text-sm\">\n            {props.character.name}ã®è¡¨æƒ…ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç®¡ç†ã—ã¾ã™\n          </p>\n        </div>\n        <Button onClick={() => setIsAddingNew(true)} disabled={isAddingNew}>\n          <Plus className=\"mr-2 h-4 w-4\" />\n          è¡¨æƒ…è¿½åŠ \n        </Button>\n      </div>\n\n      {/* æ–°ã—ã„è¡¨æƒ…è¿½åŠ ãƒ•ã‚©ãƒ¼ãƒ  */}\n      {isAddingNew && (\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-base\">æ–°ã—ã„è¡¨æƒ…ã‚’è¿½åŠ </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"expression-name\">è¡¨æƒ…å</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-name\"\n                value={newExpression.name}\n                onChange={(e) =>\n                  setNewExpression({ ...newExpression, name: e.target.value })\n                }\n                placeholder=\"ä¾‹: ç¬‘é¡”ã€å›°ã£ãŸé¡”ã€æ€’ã‚Š\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"expression-description\">èª¬æ˜</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-description\"\n                value={newExpression.description}\n                onChange={(e) =>\n                  setNewExpression({\n                    ...newExpression,\n                    description: e.target.value,\n                  })\n                }\n                placeholder=\"è¡¨æƒ…ã®è©³ç´°èª¬æ˜\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"expression-prompt\">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¿®é£¾å­</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-prompt\"\n                value={newExpression.promptModifier}\n                onChange={(e) =>\n                  setNewExpression({\n                    ...newExpression,\n                    promptModifier: e.target.value,\n                  })\n                }\n                placeholder=\"ä¾‹: smiling, happy, cheerful\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"expression-tags\">ã‚¿ã‚°ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-tags\"\n                value={newExpression.tags}\n                onChange={(e) =>\n                  setNewExpression({ ...newExpression, tags: e.target.value })\n                }\n                placeholder=\"ä¾‹: ãƒã‚¸ãƒ†ã‚£ãƒ–, åŸºæœ¬, æ„Ÿæƒ…\"\n              />\n            </div>\n            <div className=\"flex gap-2\">\n              <Button\n                onClick={handleAddExpression}\n                disabled={!newExpression.name || !newExpression.promptModifier}\n              >\n                è¿½åŠ \n              </Button>\n              <Button variant=\"outline\" onClick={() => setIsAddingNew(false)}>\n                ã‚­ãƒ£ãƒ³ã‚»ãƒ«\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* è¡¨æƒ…ä¸€è¦§ */}\n      <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2\">\n        {expressions.map((expression) => (\n          <Card key={expression.id}>\n            <CardHeader className=\"pb-2\">\n              <div className=\"flex items-center justify-between\">\n                <CardTitle className=\"text-base\">{expression.name}</CardTitle>\n                <div className=\"flex gap-1\">\n                  <Button variant=\"ghost\" size=\"sm\">\n                    <Upload className=\"h-3 w-3\" />\n                  </Button>\n                  <Button variant=\"ghost\" size=\"sm\">\n                    <Edit2 className=\"h-3 w-3\" />\n                  </Button>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => handleDeleteExpression(expression.id)}\n                  >\n                    <Trash2 className=\"h-3 w-3\" />\n                  </Button>\n                </div>\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"text-muted-foreground text-sm\">\n                {expression.description}\n              </p>\n\n              <div>\n                <Label className=\"text-xs\">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¿®é£¾å­</Label>\n                <div className=\"mt-1 flex items-center gap-2\">\n                  <code className=\"flex-1 rounded bg-muted p-2 font-mono text-xs\">\n                    {expression.promptModifier}\n                  </code>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => handleCopyPrompt(expression.promptModifier)}\n                  >\n                    <Copy className=\"h-3 w-3\" />\n                  </Button>\n                </div>\n              </div>\n\n              <div className=\"flex flex-wrap gap-1\">\n                {expression.tags.map((tag, index) => (\n                  <Badge key={index} variant=\"secondary\" className=\"text-xs\">\n                    {tag}\n                  </Badge>\n                ))}\n              </div>\n\n              <div className=\"flex gap-2 pt-2\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  className=\"flex-1\"\n                  onClick={() => handleCopyPrompt(expression.promptModifier)}\n                >\n                  <Copy className=\"mr-1 h-3 w-3\" />\n                  ã‚³ãƒ”ãƒ¼\n                </Button>\n                <Button variant=\"outline\" size=\"sm\" className=\"flex-1\">\n                  ç”Ÿæˆãƒ†ã‚¹ãƒˆ\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {expressions.length === 0 && !isAddingNew && (\n        <Card>\n          <CardContent className=\"py-8 text-center\">\n            <p className=\"text-muted-foreground\">\n              ã¾ã è¡¨æƒ…å·®åˆ†ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“\n            </p>\n            <Button\n              variant=\"outline\"\n              className=\"mt-2\"\n              onClick={() => setIsAddingNew(true)}\n            >\n              <Plus className=\"mr-2 h-4 w-4\" />\n              æœ€åˆã®è¡¨æƒ…ã‚’è¿½åŠ \n            </Button>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.characters._index/components/add-expression-dialog.tsx"},"span":[4027,4246],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\nimport { Label } from \"~/components/ui/label\"\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"~/components/ui/select\"\nimport { useState } from \"react\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport { toast } from \"sonner\"\nimport { Loader2, Sparkles } from \"lucide-react\"\nimport { Alert, AlertDescription } from \"~/components/ui/alert\"\nimport { CREATE_CHARACTER_EXPRESSION, VIEWER_CURRENT_PASS } from \"../queries\"\nimport { useIpAddress } from \"~/hooks/use-ip-address\"\n\ntype Character = {\n  id: string\n  name: string\n  nanoid: string\n  description?: string | null\n  baseImageUrl?: string | null\n  thumbnailUrl?: string | null\n  isPublic: boolean\n  createdAt: number\n  expressions: Array<{\n    id: string\n    expressionName: string\n    imageUrl?: string | null\n    createdAt: string\n  }>\n}\n\ntype Props = {\n  isOpen: boolean\n  onClose: () => void\n  onComplete?: () => void\n  character: Character\n  userToken?: string | null\n}\n\nconst PREDEFINED_EXPRESSIONS = [\n  \"ç¬‘é¡”\",\n  \"æ€’ã‚Š\",\n  \"æ‚²ã—ã¿\",\n  \"é©šã\",\n  \"ææ€–\",\n  \"å«Œæ‚ª\",\n  \"å–œã³\",\n  \"ã‚¦ã‚£ãƒ³ã‚¯\",\n  \"ç…§ã‚Œ\",\n  \"å›°ã‚Šé¡”\",\n  \"æ³£ãé¡”\",\n  \"çœ ãã†\",\n  \"çœŸé¢ç›®\",\n  \"å¾®ç¬‘ã¿\",\n  \"ä¸æ©Ÿå«Œ\",\n  \"å¿ƒé…\",\n  \"èˆˆå¥®\",\n  \"ãƒªãƒ©ãƒƒã‚¯ã‚¹\",\n  \"é›†ä¸­\",\n]\n\nconst IMAGE_SIZE_OPTIONS = [\n  { value: \"SQUARE_512\", label: \"512x512 (å°)\" },\n  { value: \"SQUARE_768\", label: \"768x768 (ä¸­)\" },\n  { value: \"SQUARE_1024\", label: \"1024x1024 (å¤§)\" },\n  { value: \"LANDSCAPE\", label: \"1280x720 (æ¨ªé•·)\" },\n  { value: \"PORTRAIT\", label: \"720x1280 (ç¸¦é•·)\" },\n] as const\n\nexport function AddExpressionDialog ({\n  isOpen,\n  onClose,\n  onComplete,\n  character,\n}: Props) {\n  const [expressionName, setExpressionName] = useState(\"\")\n  const [size, setSize] = useState<\n    \"SQUARE_512\" | \"SQUARE_768\" | \"SQUARE_1024\" | \"LANDSCAPE\" | \"PORTRAIT\"\n  >(\"SQUARE_512\")\n\n  // IPã‚¢ãƒ‰ãƒ¬ã‚¹å–å¾—\n  const { ipInfo } = useIpAddress()\n\n  // æ®‹ã‚Šç”Ÿæˆæšæ•°å–å¾—\n  const { data: passData } = useQuery(VIEWER_CURRENT_PASS)\n\n  const [createExpression, { loading }] = useMutation(\n    CREATE_CHARACTER_EXPRESSION,\n    {\n      onCompleted: () => {\n        toast.success(\"è¡¨æƒ…ã®ç”Ÿæˆã‚’é–‹å§‹ã—ã¾ã—ãŸ\")\n        handleClose()\n        onComplete?.()\n      },\n      onError: (error) => {\n        toast.error(error.message)\n      },\n    },\n  )\n\n  const handleClose = () => {\n    resetForm()\n    onClose()\n  }\n\n  const resetForm = () => {\n    setExpressionName(\"\")\n    setSize(\"SQUARE_512\")\n  }\n\n  const handleSubmit = () => {\n    if (!expressionName.trim()) {\n      toast.error(\"è¡¨æƒ…åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    createExpression({\n      variables: {\n        input: {\n          characterId: character.nanoid,\n          expressionName: expressionName.trim(),\n          size: size,\n          // TODO: IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¿½åŠ ï¼ˆGraphQL ã‚¹ã‚­ãƒ¼ãƒæ›´æ–°å¾Œã«æœ‰åŠ¹åŒ–ï¼‰\n          ipaddress: ipInfo?.ip || null,\n        },\n      },\n    } as never)\n  }\n\n  // æ—¢å­˜ã®è¡¨æƒ…åã‚’å–å¾—ã—ã¦é‡è¤‡ãƒã‚§ãƒƒã‚¯\n  const existingExpressions = character.expressions.map(\n    (exp) => exp.expressionName,\n  )\n  const availableExpressions = PREDEFINED_EXPRESSIONS.filter(\n    (expr) => !existingExpressions.includes(expr),\n  )\n\n  return (\n    <Dialog open={isOpen} onOpenChange={handleClose}>\n      <DialogContent className=\"max-w-lg\">\n        <DialogHeader>\n          <DialogTitle>ã€Œ{character.name}ã€ã«è¡¨æƒ…ã‚’è¿½åŠ </DialogTitle>\n          <DialogDescription>\n            æ–°ã—ã„è¡¨æƒ…ã‚’ç”Ÿæˆã—ã¦ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã«è¿½åŠ ã—ã¾ã™\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4\">\n          {/* è¡¨æƒ…åå…¥åŠ› */}\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"expressionName\">è¡¨æƒ…å</Label>\n            <Input\n              id=\"expressionName\"\n              value={expressionName}\n              onChange={(e) => setExpressionName(e.target.value)}\n              placeholder=\"ä¾‹: ç¬‘é¡”ã€æ€’ã‚Šã€æ‚²ã—ã¿\"\n            />\n          </div>\n\n          {/* ãƒ—ãƒªã‚»ãƒƒãƒˆè¡¨æƒ…é¸æŠ */}\n          <div className=\"space-y-2\">\n            <Label>ãƒ—ãƒªã‚»ãƒƒãƒˆè¡¨æƒ…ã‹ã‚‰é¸æŠ</Label>\n            <div className=\"grid grid-cols-3 gap-2\">\n              {availableExpressions.slice(0, 12).map((expression) => (\n                <Button\n                  key={expression}\n                  type=\"button\"\n                  variant={\n                    expressionName === expression ? \"default\" : \"outline\"\n                  }\n                  size=\"sm\"\n                  onClick={() => setExpressionName(expression)}\n                  className=\"text-xs\"\n                >\n                  {expression}\n                </Button>\n              ))}\n            </div>\n          </div>\n\n          {/* ç”»åƒã‚µã‚¤ã‚ºé¸æŠ */}\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"imageSize\">ç”»åƒã‚µã‚¤ã‚º</Label>\n            <Select\n              value={size}\n              onValueChange={(value) => setSize(value as typeof size)}\n            >\n              <SelectTrigger>\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                {IMAGE_SIZE_OPTIONS.map((option) => (\n                  <SelectItem key={option.value} value={option.value}>\n                    {option.label}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n\n          {/* ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³æƒ…å ± */}\n          <Alert className=\"border-yellow-200 bg-gradient-to-r from-yellow-50 to-orange-50\">\n            <Sparkles className=\"h-4 w-4 text-yellow-600\" />\n            <AlertDescription className=\"text-yellow-800\">\n              <strong>ğŸ‰ ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ä¸­ï¼</strong>{\" \"}\n              ã‚µãƒ–ã‚¹ã‚¯ãƒ¦ãƒ¼ã‚¶ãƒ¼3æšæ¶ˆè²»ã€ç„¡æ–™ãƒ¦ãƒ¼ã‚¶ãƒ¼4æšæ¶ˆè²»ï¼ˆé€šå¸¸5æšæ¶ˆè²»ï¼‰ã§è¡¨æƒ…ç”ŸæˆãŒã§ãã¾ã™ï¼\n            </AlertDescription>\n          </Alert>\n\n          {/* ã‚³ã‚¹ãƒˆè¡¨ç¤º */}\n          <div className=\"rounded-md bg-muted p-3\">\n            <div className=\"flex items-center justify-between text-sm\">\n              <span>ç”Ÿæˆã‚³ã‚¹ãƒˆ:</span>\n              <span className=\"font-medium text-green-600\">\n                ã‚µãƒ–ã‚¹ã‚¯: 3æšæ¶ˆè²» / ç„¡æ–™: 4æšæ¶ˆè²»{\" \"}\n                <span className=\"text-muted-foreground line-through\">\n                  é€šå¸¸5æš\n                </span>\n              </span>\n            </div>\n          </div>\n\n          {/* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ */}\n          <div className=\"flex justify-end gap-2\">\n            <Button variant=\"outline\" onClick={handleClose} disabled={loading}>\n              ã‚­ãƒ£ãƒ³ã‚»ãƒ«\n            </Button>\n            <div className=\"flex flex-col items-end gap-1\">\n              <Button\n                onClick={handleSubmit}\n                disabled={loading || !expressionName.trim()}\n              >\n                {loading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n                è¡¨æƒ…ã‚’ç”Ÿæˆ\n              </Button>\n              {passData?.viewer?.currentPass &&\n                typeof (\n                  passData.viewer.currentPass as {\n                    remainingImageGenerations?: number\n                  }\n                ).remainingImageGenerations === \"number\" && (\n                  <div className=\"text-muted-foreground text-xs\">\n                    æ®‹ã‚Š:{\" \"}\n                    {\n                      (\n                        passData.viewer.currentPass as {\n                          remainingImageGenerations: number\n                        }\n                      ).remainingImageGenerations\n                    }\n                    æš\n                  </div>\n                )}\n            </div>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.characters._index/components/character-expressions.tsx"},"span":[13472,14027],"sourceCode":"import {\n  Download,\n  Image,\n  Plus,\n  ArrowLeft,\n  CheckCircle,\n  FolderDown,\n} from \"lucide-react\"\nimport { useState, useEffect, useRef } from \"react\"\nimport { Alert, AlertDescription } from \"~/components/ui/alert\"\nimport { Button } from \"~/components/ui/button\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\nimport { Label } from \"~/components/ui/label\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { useQuery, useMutation } from \"@apollo/client/index\"\nimport {\n  CHARACTER_WITH_EXPRESSIONS,\n  CREATE_CHARACTER_EXPRESSION,\n  VIEWER_CURRENT_PASS,\n} from \"../queries\"\nimport { useIpAddress } from \"~/hooks/use-ip-address\"\nimport JSZip from \"jszip\"\n\ntype Props = {\n  characterId: string\n  characterName: string\n  character: Character\n  onBack: () => void\n  onCharacterUpdate?: (character: Character) => void\n}\n\ntype CharacterExpression = {\n  id: string\n  expressionName: string\n  imageUrl?: string | null\n  createdAt: string\n}\n\ntype Character = {\n  id: string\n  nanoid: string\n  name: string\n  description?: string | null\n  baseImageUrl?: string | null\n  thumbnailUrl?: string | null\n  isPublic: boolean\n  createdAt: number\n  expressions: CharacterExpression[]\n}\n\ntype ImageSize =\n  | \"SQUARE_512\"\n  | \"SQUARE_768\"\n  | \"SQUARE_1024\"\n  | \"LANDSCAPE\"\n  | \"PORTRAIT\"\n\nconst imageSizeOptions: { value: ImageSize; label: string }[] = [\n  { value: \"SQUARE_512\", label: \"512x512 (å°)\" },\n  { value: \"SQUARE_768\", label: \"768x768 (ä¸­)\" },\n  { value: \"SQUARE_1024\", label: \"1024x1024 (å¤§)\" },\n  { value: \"LANDSCAPE\", label: \"1280x720 (æ¨ªé•·)\" },\n  { value: \"PORTRAIT\", label: \"720x1280 (ç¸¦é•·)\" },\n]\n\nexport function CharacterExpressions (props: Props) {\n  const { character, onBack, onCharacterUpdate } = props\n  const t = useTranslation()\n  const [isAddExpressionOpen, setIsAddExpressionOpen] = useState(false)\n  const [newExpressionName, setNewExpressionName] = useState(\"\")\n  const [selectedSize, setSelectedSize] = useState<ImageSize>(\"SQUARE_512\")\n  const [isPolling, setIsPolling] = useState(false)\n  const [currentExpressions, setCurrentExpressions] = useState(\n    character.expressions || [],\n  )\n  const [newExpressionsFound, setNewExpressionsFound] = useState(0)\n  const [showSuccessBanner, setShowSuccessBanner] = useState(false)\n  const [isBulkDownloading, setIsBulkDownloading] = useState(false)\n  const pollingIntervalRef = useRef<NodeJS.Timeout | null>(null)\n\n  // IPã‚¢ãƒ‰ãƒ¬ã‚¹å–å¾—\n  const { ipInfo } = useIpAddress()\n\n  // æ®‹ã‚Šç”Ÿæˆæšæ•°å–å¾—\n  const { data: passData } = useQuery(VIEWER_CURRENT_PASS)\n\n  // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è©³ç´°ã‚’å–å¾—ã™ã‚‹ã‚¯ã‚¨ãƒªï¼ˆãƒãƒ¼ãƒªãƒ³ã‚°ç”¨ï¼‰\n  const { refetch: refetchCharacter } = useQuery(CHARACTER_WITH_EXPRESSIONS, {\n    variables: { characterId: character.id },\n    skip: true, // åˆæœŸã¯å®Ÿè¡Œã—ãªã„\n  })\n\n  // è¡¨æƒ…ä½œæˆãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\n  const [createExpression, { loading: creating }] = useMutation(\n    CREATE_CHARACTER_EXPRESSION,\n    {\n      onCompleted: () => {\n        setIsAddExpressionOpen(false)\n        setNewExpressionName(\"\")\n        // ç”ŸæˆæˆåŠŸå¾Œã«ãƒãƒ¼ãƒªãƒ³ã‚°é–‹å§‹\n        startPolling()\n      },\n      onError: (error) => {\n        console.error(\"Expression creation failed:\", error)\n        alert(\"è¡¨æƒ…ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ\")\n      },\n    },\n  )\n\n  const expressions = currentExpressions\n\n  // ãƒãƒ¼ãƒªãƒ³ã‚°é–‹å§‹\n  const startPolling = () => {\n    if (pollingIntervalRef.current) return // æ—¢ã«ãƒãƒ¼ãƒªãƒ³ã‚°ä¸­ã®å ´åˆã¯ä½•ã‚‚ã—ãªã„\n\n    setIsPolling(true)\n    pollingIntervalRef.current = setInterval(async () => {\n      try {\n        const result = await refetchCharacter()\n        const updatedCharacter = result.data?.character as Character | undefined\n\n        if (updatedCharacter?.expressions) {\n          const newExpressionsCount = updatedCharacter.expressions.length\n          const currentCount = currentExpressions.length\n\n          // æ–°ã—ã„è¡¨æƒ…ãŒè¿½åŠ ã•ã‚ŒãŸå ´åˆ\n          if (newExpressionsCount > currentCount) {\n            const newCount = newExpressionsCount - currentCount\n            setCurrentExpressions(updatedCharacter.expressions)\n            setNewExpressionsFound(newCount)\n            setShowSuccessBanner(true)\n            onCharacterUpdate?.(updatedCharacter)\n            stopPolling()\n\n            // 5ç§’å¾Œã«ãƒãƒŠãƒ¼ã‚’éè¡¨ç¤º\n            setTimeout(() => {\n              setShowSuccessBanner(false)\n              setNewExpressionsFound(0)\n            }, 5000)\n          }\n        }\n      } catch (error) {\n        console.error(\"Polling error:\", error)\n      }\n    }, 2000) // 2ç§’é–“éš”ã§ãƒãƒ¼ãƒªãƒ³ã‚°\n  }\n\n  // ãƒãƒ¼ãƒªãƒ³ã‚°åœæ­¢\n  const stopPolling = () => {\n    if (pollingIntervalRef.current) {\n      clearInterval(pollingIntervalRef.current)\n      pollingIntervalRef.current = null\n    }\n    setIsPolling(false)\n  }\n\n  // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚¢ãƒ³ãƒã‚¦ãƒ³ãƒˆæ™‚ã«ãƒãƒ¼ãƒªãƒ³ã‚°åœæ­¢\n  useEffect(() => {\n    return () => {\n      stopPolling()\n    }\n  }, [])\n\n  const handleCreateExpression = async () => {\n    if (!newExpressionName.trim()) {\n      alert(\"è¡¨æƒ…åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    try {\n      // biome-ignore lint/suspicious/noExplicitAny: GraphQLå‹ç”ŸæˆãŒè¿½ã„ã¤ã„ã¦ã„ãªã„ãŸã‚\n      await (createExpression as any)({\n        variables: {\n          input: {\n            characterId: character.id,\n            expressionName: newExpressionName.trim(),\n            size: selectedSize,\n            ipaddress: ipInfo?.ip || null,\n          },\n        },\n      })\n    } catch (error) {\n      console.error(\"Failed to create expression:\", error)\n    }\n  }\n\n  const handleDownloadExpression = async (expression: CharacterExpression) => {\n    if (!expression.imageUrl) {\n      alert(\"ç”»åƒURLãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“\")\n      return\n    }\n\n    try {\n      const response = await fetch(expression.imageUrl)\n      const blob = await response.blob()\n      const url = window.URL.createObjectURL(blob)\n      const a = document.createElement(\"a\")\n      a.href = url\n      a.download = `${character.name}_${expression.expressionName}.png`\n      document.body.appendChild(a)\n      a.click()\n      document.body.removeChild(a)\n      window.URL.revokeObjectURL(url)\n\n      alert(`${expression.expressionName} ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ`)\n    } catch (error) {\n      console.error(\"Download failed:\", error)\n      alert(\"ç”»åƒã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n    }\n  }\n\n  const handleBulkDownload = async () => {\n    const expressionsWithImages = expressions.filter((expr) => expr.imageUrl)\n\n    if (expressionsWithImages.length === 0) {\n      alert(\"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹ç”»åƒãŒã‚ã‚Šã¾ã›ã‚“\")\n      return\n    }\n\n    setIsBulkDownloading(true)\n\n    try {\n      const zip = new JSZip()\n\n      // å„è¡¨æƒ…ç”»åƒã‚’ZIPã«è¿½åŠ \n      for (const expression of expressionsWithImages) {\n        if (expression.imageUrl) {\n          try {\n            const response = await fetch(expression.imageUrl)\n            const blob = await response.blob()\n            zip.file(`${expression.expressionName}.png`, blob)\n          } catch (error) {\n            console.error(\n              `Failed to download ${expression.expressionName}:`,\n              error,\n            )\n          }\n        }\n      }\n\n      // ZIPãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰\n      const zipBlob = await zip.generateAsync({ type: \"blob\" })\n      const url = window.URL.createObjectURL(zipBlob)\n      const a = document.createElement(\"a\")\n      a.href = url\n      a.download = `${character.name}_expressions.zip`\n      document.body.appendChild(a)\n      a.click()\n      document.body.removeChild(a)\n      window.URL.revokeObjectURL(url)\n\n      alert(`${character.name}ã®è¡¨æƒ…ç”»åƒã‚’ã¾ã¨ã‚ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ`)\n    } catch (error) {\n      console.error(\"Bulk download failed:\", error)\n      alert(\"ä¸€æ‹¬ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n    } finally {\n      setIsBulkDownloading(false)\n    }\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {/* ãƒ˜ãƒƒãƒ€ãƒ¼ */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-4\">\n          <Button onClick={onBack} variant=\"outline\" size=\"sm\">\n            <ArrowLeft className=\"mr-2 h-4 w-4\" />\n            æˆ»ã‚‹\n          </Button>{\" \"}\n          <div>\n            <h2 className=\"font-bold text-2xl\">{character.name} ã®è¡¨æƒ…ä¸€è¦§</h2>\n            <div className=\"mt-1 flex items-center gap-2\">\n              <span className=\"text-muted-foreground text-sm\">\n                {expressions.length} å€‹ã®è¡¨æƒ…\n              </span>\n              {isPolling && (\n                <span className=\"text-blue-600 text-sm\">\n                  ğŸ”„ æ–°ã—ã„è¡¨æƒ…ã‚’ç¢ºèªä¸­...\n                </span>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* ä¸€æ‹¬ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ */}\n        {expressions.filter((expr) => expr.imageUrl).length > 0 && (\n          <Button\n            onClick={handleBulkDownload}\n            variant=\"outline\"\n            disabled={isBulkDownloading}\n          >\n            <FolderDown className=\"mr-2 h-4 w-4\" />\n            {isBulkDownloading ? \"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸­...\" : \"ä¸€æ‹¬ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰\"}\n          </Button>\n        )}\n      </div>\n\n      {/* ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼åŸºæœ¬æƒ…å ± */}\n      {character.thumbnailUrl && (\n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center gap-4\">\n              <img\n                src={character.thumbnailUrl}\n                alt={character.name}\n                className=\"h-16 w-16 rounded-md object-cover\"\n              />\n              <div>\n                <h3 className=\"font-semibold\">{character.name}</h3>\n                {character.description && (\n                  <p className=\"text-muted-foreground text-sm\">\n                    {character.description}\n                  </p>\n                )}\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* æˆåŠŸãƒãƒŠãƒ¼ */}\n      {showSuccessBanner && (\n        <Alert className=\"border-green-200 bg-green-50\">\n          <CheckCircle className=\"h-4 w-4 text-green-600\" />\n          <AlertDescription className=\"text-green-800\">\n            ğŸ‰ æ–°ã—ã„è¡¨æƒ…ãŒ{newExpressionsFound}å€‹ç”Ÿæˆã•ã‚Œã¾ã—ãŸï¼\n          </AlertDescription>\n        </Alert>\n      )}\n\n      {/* ãƒãƒ¼ãƒªãƒ³ã‚°çŠ¶æ…‹è¡¨ç¤º */}\n      {isPolling && (\n        <Alert className=\"border-blue-200 bg-blue-50\">\n          <AlertDescription className=\"text-blue-800\">\n            ğŸ”„ æ–°ã—ã„è¡¨æƒ…ã‚’ç¢ºèªä¸­...\n          </AlertDescription>\n        </Alert>\n      )}\n\n      {/* è¡¨æƒ…ä¸€è¦§ã‚°ãƒªãƒƒãƒ‰ */}\n      <div className=\"grid grid-cols-2 gap-4 md:grid-cols-3 lg:grid-cols-4\">\n        {/* è¡¨æƒ…è¿½åŠ ãƒœã‚¿ãƒ³ */}\n        <Dialog\n          open={isAddExpressionOpen}\n          onOpenChange={setIsAddExpressionOpen}\n        >\n          <DialogTrigger asChild>\n            <Card className=\"cursor-pointer border-2 border-dashed transition-colors hover:border-primary/50\">\n              <CardContent className=\"p-4\">\n                <div className=\"flex aspect-square flex-col items-center justify-center rounded-md bg-muted/30\">\n                  <Plus className=\"mb-2 h-8 w-8 text-muted-foreground\" />\n                  <span className=\"text-center text-muted-foreground text-sm\">\n                    æ–°ã—ã„è¡¨æƒ…ã‚’ä½œæˆ\n                  </span>\n                  <span className=\"mt-1 text-center text-muted-foreground text-xs\">\n                    (ã‚µãƒ–ã‚¹ã‚¯:3æš/ç„¡æ–™:4æšæ¶ˆè²»)\n                  </span>\n                  {passData?.viewer?.currentPass &&\n                    typeof (\n                      passData.viewer.currentPass as {\n                        remainingImageGenerations?: number\n                      }\n                    ).remainingImageGenerations === \"number\" && (\n                      <span className=\"mt-1 text-center font-medium text-primary text-xs\">\n                        æ®‹ã‚Š\n                        {\n                          (\n                            passData.viewer.currentPass as {\n                              remainingImageGenerations: number\n                            }\n                          ).remainingImageGenerations\n                        }\n                        æš\n                      </span>\n                    )}\n                </div>\n              </CardContent>\n            </Card>\n          </DialogTrigger>\n          <DialogContent>\n            <DialogHeader>\n              <DialogTitle>æ–°ã—ã„è¡¨æƒ…ã‚’ä½œæˆ</DialogTitle>\n            </DialogHeader>\n            <div className=\"space-y-4\">\n              <div>\n                <Label htmlFor=\"expressionName\">è¡¨æƒ…å</Label>\n                {/* biome-ignore lint/nursery/useUniqueElementIds: ãƒ€ã‚¤ã‚¢ãƒ­ã‚°å†…ã®IDé‡è¤‡ã¯è¨±å®¹ */}\n                <Input\n                  id=\"expressionName\"\n                  value={newExpressionName}\n                  onChange={(e) => setNewExpressionName(e.target.value)}\n                  placeholder=\"ä¾‹: ç¬‘é¡”ã€æ€’ã‚Šã€æ‚²ã—ã¿\"\n                />\n              </div>\n              <div>\n                <Label htmlFor=\"imageSize\">ç”»åƒã‚µã‚¤ã‚º</Label>\n                <select\n                  id=\"imageSize\"\n                  value={selectedSize}\n                  onChange={(e) => setSelectedSize(e.target.value as ImageSize)}\n                  className=\"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:font-medium file:text-foreground file:text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50\"\n                >\n                  {imageSizeOptions.map((option) => (\n                    <option key={option.value} value={option.value}>\n                      {option.label}\n                    </option>\n                  ))}\n                </select>\n              </div>\n              <div className=\"rounded-md bg-blue-50 p-3\">\n                <div className=\"flex items-center gap-2\">\n                  <div className=\"flex h-5 w-5 items-center justify-center rounded-full bg-blue-100\">\n                    <span className=\"font-bold text-blue-600 text-xs\">i</span>\n                  </div>\n                  <div>\n                    <p className=\"font-medium text-blue-900 text-sm\">\n                      {t(\"ã‚³ã‚¹ãƒˆæƒ…å ±\", \"Cost Information\")}\n                    </p>\n                    <p className=\"text-blue-700 text-xs\">\n                      {t(\n                        \"ã‚µãƒ–ã‚¹ã‚¯ãƒ¦ãƒ¼ã‚¶ãƒ¼3æšæ¶ˆè²»ã€ç„¡æ–™ãƒ¦ãƒ¼ã‚¶ãƒ¼4æšæ¶ˆè²»ï¼ˆã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ä¾¡æ ¼ã€é€šå¸¸5æšæ¶ˆè²»ï¼‰\",\n                        \"Subscription users: 3 credits, Free users: 4 credits (Campaign price, normally 5 credits)\",\n                      )}\n                    </p>\n                  </div>\n                </div>\n              </div>\n              <div className=\"flex justify-end gap-2\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => setIsAddExpressionOpen(false)}\n                >\n                  ã‚­ãƒ£ãƒ³ã‚»ãƒ«\n                </Button>\n                <div className=\"flex flex-col gap-2\">\n                  <Button\n                    onClick={handleCreateExpression}\n                    disabled={creating || !newExpressionName.trim()}\n                  >\n                    {creating ? \"ä½œæˆä¸­...\" : \"è¡¨æƒ…ã‚’ä½œæˆ\"}\n                  </Button>\n                  {passData?.viewer?.currentPass &&\n                    typeof (\n                      passData.viewer.currentPass as {\n                        remainingImageGenerations?: number\n                      }\n                    ).remainingImageGenerations === \"number\" && (\n                      <div className=\"text-center text-muted-foreground text-xs\">\n                        æ®‹ã‚Šç”Ÿæˆå¯èƒ½æšæ•°:{\" \"}\n                        {\n                          (\n                            passData.viewer.currentPass as {\n                              remainingImageGenerations: number\n                            }\n                          ).remainingImageGenerations\n                        }\n                        æš\n                      </div>\n                    )}\n                </div>\n              </div>\n            </div>\n          </DialogContent>\n        </Dialog>\n\n        {/* æ—¢å­˜ã®è¡¨æƒ… */}\n        {expressions.map((expression) => (\n          <Card key={expression.id} className=\"overflow-hidden\">\n            <CardContent className=\"p-4\">\n              <div className=\"space-y-2\">\n                {expression.imageUrl ? (\n                  <img\n                    src={expression.imageUrl}\n                    alt={expression.expressionName}\n                    className=\"aspect-square w-full rounded-md object-cover\"\n                  />\n                ) : (\n                  <div className=\"flex aspect-square items-center justify-center rounded-md bg-muted\">\n                    <Image className=\"h-8 w-8 text-muted-foreground\" />\n                  </div>\n                )}\n                <div>\n                  <h4 className=\"truncate font-medium text-sm\">\n                    {expression.expressionName}\n                  </h4>\n                  <p className=\"text-muted-foreground text-xs\">\n                    {new Date(expression.createdAt).toLocaleDateString()}\n                  </p>\n                </div>\n                {expression.imageUrl && (\n                  <div className=\"flex gap-1\">\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      className=\"flex-1\"\n                      onClick={() => handleDownloadExpression(expression)}\n                    >\n                      <Download className=\"mr-1 h-3 w-3\" />\n                      DL\n                    </Button>\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={() =>\n                        expression.imageUrl &&\n                        window.open(expression.imageUrl, \"_blank\")\n                      }\n                    >\n                      <Image className=\"h-3 w-3\" />\n                    </Button>\n                  </div>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {expressions.length === 0 && (\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"text-center\">\n              <Image className=\"mx-auto h-12 w-12 text-muted-foreground\" />\n              <p className=\"mt-2 text-muted-foreground text-sm\">\n                ã¾ã è¡¨æƒ…ãŒä½œæˆã•ã‚Œã¦ã„ã¾ã›ã‚“\n              </p>\n              <p className=\"text-muted-foreground text-xs\">\n                ã€Œæ–°ã—ã„è¡¨æƒ…ã‚’ä½œæˆã€ãƒœã‚¿ãƒ³ã‹ã‚‰å§‹ã‚ã¾ã—ã‚‡ã†\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable isLoading is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"isLoading"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.generation.plans/components/plans-page.tsx"},"span":[965,974],"sourceCode":"import { PassPlanList } from \"~/routes/($lang)._main.plus._index/components/pass-plan-list\"\nimport { graphql } from \"gql.tada\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { toast } from \"sonner\"\nimport { getAnalytics, logEvent } from \"firebase/analytics\"\nimport { config } from \"~/config\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext } from \"react\"\nimport { Link } from \"@remix-run/react\"\nimport { PlusNoteList } from \"~/routes/($lang)._main.plus._index/components/plus-note-list\"\nimport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbSeparator,\n} from \"~/components/ui/breadcrumb\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * ç”»åƒç”Ÿæˆã«ã¤ã„ã¦ã®èª¬æ˜\n */\nexport function PlanPage () {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const [mutation, { loading: isLoading }] = useMutation(\n    createPassCheckoutSessionMutation,\n  )\n\n  const onSelect = async (passType: IntrospectionEnum<\"PassType\">) => {\n    try {\n      logEvent(getAnalytics(), config.logEvent.select_item, {\n        item_list_id: passType,\n        items: [{ item_id: passType, item_name: passType }],\n      })\n      const result = await mutation({\n        variables: { input: { passType: passType } },\n      })\n      const pageURL = result.data?.createPassCheckoutSession ?? null\n      if (pageURL === null) {\n        toast(\n          t(\"ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚\", \"Failed to create session.\"),\n        )\n        return\n      }\n      window.location.assign(pageURL)\n    } catch (error) {\n      if (error instanceof Error) {\n        toast(error.message)\n      }\n    }\n  }\n\n  return (\n    <main className=\"container relative m-auto flex flex-col space-y-8\">\n      <Breadcrumb>\n        <BreadcrumbList>\n          <BreadcrumbItem>\n            <BreadcrumbLink href=\"/generation\">\n              {t(\"ç”Ÿæˆãƒˆãƒƒãƒ—\", \"Top\")}\n            </BreadcrumbLink>\n          </BreadcrumbItem>\n          <BreadcrumbSeparator />\n          <BreadcrumbItem>\n            <BreadcrumbLink href=\"/generation/about\">\n              {t(\"ç”Ÿæˆæ©Ÿèƒ½ã«ã¤ã„ã¦\", \"About Image Generation\")}\n            </BreadcrumbLink>\n          </BreadcrumbItem>\n          <BreadcrumbSeparator />\n          <BreadcrumbItem>\n            <BreadcrumbLink href=\"/generation/plans\">\n              {t(\"ãƒ—ãƒ©ãƒ³\", \"Plans\")}\n            </BreadcrumbLink>\n          </BreadcrumbItem>\n        </BreadcrumbList>\n      </Breadcrumb>\n      <PassPlanList\n        showUpgradePlansOnly={false}\n        hideSubmitButton={!authContext.userId}\n        onSelect={onSelect}\n        isLoading={false}\n      />\n      <PlusNoteList />\n      <div className=\"flex justify-center gap-x-2 py-4\">\n        <Link to=\"/generation/terms\">{t(\"åˆ©ç”¨è¦ç´„\", \"Terms of Service\")}</Link>\n        <Link to=\"/specified-commercial-transaction-act\">\n          {t(\n            \"ç‰¹å®šå•†å–å¼•æ³•ã«åŸºã¥ãè¡¨è¨˜\",\n            \"Specified Commercial Transaction Act\",\n          )}\n        </Link>\n      </div>\n    </main>\n  )\n}\n\nconst createPassCheckoutSessionMutation = graphql(\n  `mutation CreatePassCheckoutSession($input: CreatePassCheckoutSessionInput!) {\n    createPassCheckoutSession(input: $input)\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.animation/route.tsx"},"span":[11058,11071],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { deleteUploadedImage } from \"~/utils/delete-uploaded-image\"\nimport { getSizeFromBase64 } from \"~/utils/get-size-from-base64\"\nimport { resizeImage } from \"~/utils/resize-image\"\nimport { sha256 } from \"~/utils/sha256\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { uploadPublicVideo } from \"~/utils/upload-public-video\"\nimport {\n  PostAnimationFormInput,\n  PostAnimationFormAiModelFragment,\n  PostAnimationFormAlbumFragment,\n  PostAnimationFormPassFragment,\n  PostAnimationFormRecentlyUsedTagsFragment,\n} from \"~/routes/($lang)._main.new.animation/components/post-animation-form-input\"\nimport { PostAnimationFormUploader } from \"~/routes/($lang)._main.new.animation/components/post-animation-form-uploader\"\nimport { postAnimationFormInputReducer } from \"~/routes/($lang)._main.new.animation/reducers/post-animation-form-input-reducer\"\nimport { postAnimationFormReducer } from \"~/routes/($lang)._main.new.animation/reducers/post-animation-form-reducer\"\nimport { CreatingWorkDialog } from \"~/routes/($lang)._main.new.image/components/creating-work-dialog\"\nimport { SuccessCreatedWorkDialog } from \"~/routes/($lang)._main.new.image/components/success-created-work-dialog\"\nimport { vPostImageForm } from \"~/routes/($lang)._main.new.image/validations/post-image-form\"\nimport { useQuery, useMutation } from \"@apollo/client/index\"\nimport {\n  type MetaFunction,\n  useBeforeUnload,\n  useLoaderData,\n} from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport React from \"react\"\nimport { useContext, useReducer } from \"react\"\nimport { toast } from \"sonner\"\nimport { safeParse } from \"valibot\"\nimport { PostFormHeader } from \"~/routes/($lang)._main.new.image/components/post-form-header\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { getJstDate } from \"~/utils/jst-date\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport type { HeadersFunction, LoaderFunctionArgs } from \"@remix-run/cloudflare\"\nimport { loaderClient } from \"~/lib/loader-client\"\n\nexport default function NewAnimation () {\n  const data = useLoaderData<typeof loader>()\n\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const [state, dispatch] = useReducer(postAnimationFormReducer, {\n    isThumbnailLandscape: false,\n    ogpBase64: null,\n    progress: 0,\n    thumbnailBase64: null,\n    thumbnailPosX: 0,\n    thumbnailPosY: 0,\n    uploadedWorkId: null,\n    uploadedWorkUuid: null,\n    videoFile: null,\n    isHovered: false,\n  })\n\n  const [inputState, dispatchInput] = useReducer(\n    postAnimationFormInputReducer,\n    {\n      accessType: \"PUBLIC\",\n      aiModelId: \"1\",\n      albumId: null,\n      caption: \"\",\n      date: new Date(),\n      enCaption: \"\",\n      enTitle: \"\",\n      animationStyle: \"ILLUSTRATION\",\n      link: \"\",\n      ratingRestriction: \"G\",\n      reservationDate: null,\n      reservationTime: null,\n      tags: [],\n      themeId: null,\n      title: \"\",\n      useCommentFeature: true,\n      useGenerationParams: true,\n      usePromotionFeature: false,\n      useTagFeature: true,\n      correctionMessage: \"\",\n    },\n  )\n\n  const now = getJstDate(new Date())\n\n  const afterDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const { data: viewer } = useQuery(ViewerQuery, {\n    skip: authContext.isNotLoggedIn,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: authContext.userId,\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: now.toISOString().split(\"T\")[0],\n      endDate: afterDate.toISOString().split(\"T\")[0],\n    },\n  })\n\n  const [createWork, { loading: isCreatedLoading }] =\n    useMutation(CreateWorkMutation)\n\n  const formResult = safeParse(vPostImageForm, {\n    title: inputState.title,\n    caption: inputState.caption,\n    enTitle: inputState.enTitle,\n    enCaption: inputState.enCaption,\n    thumbnailBase64: state.thumbnailBase64,\n  })\n\n  const uploadVideo = async () => {\n    if (state.videoFile === null) {\n      return null\n    }\n\n    const videoUrl = await uploadPublicVideo(\n      state.videoFile as File,\n      viewer?.viewer?.token,\n    )\n\n    return videoUrl\n  }\n\n  const onPost = async () => {\n    if (formResult.success === false) {\n      for (const issue of formResult.issues) {\n        toast(issue.message)\n        return\n      }\n      return\n    }\n\n    // å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã‚µãƒ ãƒã‚¤ãƒ«ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯\n    if (state.videoFile === null) {\n      toast(t(\"å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„\", \"Please select a video file\"))\n      return\n    }\n\n    if (state.thumbnailBase64 === null) {\n      toast(\n        t(\n          \"å‹•ç”»ã®ã‚µãƒ ãƒã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†é¸æŠã—ã¦ãã ã•ã„\",\n          \"Video thumbnail not generated. Please reselect the video file\",\n        ),\n      )\n      return\n    }\n\n    if (\n      inputState.reservationDate !== null &&\n      inputState.reservationTime === null\n    ) {\n      toast(\n        t(\n          \"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter a time for the scheduled post\",\n        ),\n      )\n      return\n    }\n\n    if (\n      inputState.reservationDate === null &&\n      inputState.reservationTime !== null\n    ) {\n      toast(\n        t(\n          \"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter a time for the scheduled post\",\n        ),\n      )\n      return\n    }\n\n    const uploadedImageUrls = []\n\n    try {\n      dispatch({ type: \"SET_PROGRESS\", payload: 10 })\n\n      const smallThumbnail = state.isThumbnailLandscape\n        ? await resizeImage(formResult.output.thumbnailBase64, 400, 0, \"webp\")\n        : await resizeImage(formResult.output.thumbnailBase64, 0, 400, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 20 })\n\n      const largeThumbnail = state.isThumbnailLandscape\n        ? await resizeImage(formResult.output.thumbnailBase64, 600, 0, \"webp\")\n        : await resizeImage(formResult.output.thumbnailBase64, 0, 600, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 30 })\n\n      const thumbnailUrl = await uploadPublicImage(\n        formResult.output.thumbnailBase64,\n        viewer?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 40 })\n\n      uploadedImageUrls.push(thumbnailUrl)\n\n      const smallThumbnailUrl = await uploadPublicImage(\n        smallThumbnail.base64,\n        viewer?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 45 })\n\n      uploadedImageUrls.push(smallThumbnailUrl)\n\n      const largeThumbnailUrl = await uploadPublicImage(\n        largeThumbnail.base64,\n        viewer?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 50 })\n\n      uploadedImageUrls.push(largeThumbnailUrl)\n\n      const ogpBase64Url = state.ogpBase64\n        ? await uploadPublicImage(state.ogpBase64, viewer?.viewer?.token)\n        : null\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 60 })\n\n      if (ogpBase64Url !== null) {\n        uploadedImageUrls.push(ogpBase64Url)\n      }\n\n      const reservedAt =\n        inputState.reservationDate !== null &&\n        inputState.reservationTime !== null\n          ? new Date(\n              `${inputState.reservationDate}T${inputState.reservationTime}`,\n            ).getTime() +\n            3600000 * 9\n          : undefined\n\n      const mainImageSha256 = await sha256(formResult.output.thumbnailBase64)\n\n      const mainImageSize = await getSizeFromBase64(\n        formResult.output.thumbnailBase64,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 70 })\n\n      const uploadedUrl = await uploadVideo()\n\n      if (!uploadedUrl) {\n        toast(\n          t(\"å‹•ç”»ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to upload the video\"),\n        )\n        return\n      }\n\n      const work = await createWork({\n        variables: {\n          input: {\n            title: formResult.output.title,\n            entitle: formResult.output.enTitle,\n            explanation: formResult.output.caption,\n            enExplanation: formResult.output.enCaption,\n            rating: inputState.ratingRestriction,\n            prompt: null,\n            negativePrompt: null,\n            seed: null,\n            sampler: null,\n            strength: null,\n            noise: null,\n            modelName: null,\n            modelHash: null,\n            otherGenerationParams: null,\n            pngInfo: null,\n            imageStyle: inputState.animationStyle,\n            relatedUrl: inputState.link,\n            tags: inputState.tags.map((tag) => tag.text),\n            isTagEditable: inputState.useTagFeature,\n            isCommentEditable: inputState.useCommentFeature,\n            thumbnailPosition: state.isThumbnailLandscape\n              ? state.thumbnailPosX\n              : state.thumbnailPosY,\n            modelId: inputState.aiModelId,\n            type: \"WORK\",\n            subjectId: inputState.themeId,\n            albumId: inputState.albumId,\n            isPromotion: inputState.usePromotionFeature,\n            reservedAt: reservedAt,\n            mainImageSha256: mainImageSha256,\n            accessType: inputState.accessType,\n            imageUrls: [thumbnailUrl],\n            smallThumbnailImageURL: smallThumbnailUrl,\n            smallThumbnailImageWidth: smallThumbnail.width,\n            smallThumbnailImageHeight: smallThumbnail.height,\n            largeThumbnailImageURL: largeThumbnailUrl,\n            largeThumbnailImageWidth: largeThumbnail.width,\n            largeThumbnailImageHeight: largeThumbnail.height,\n            videoUrl: uploadedUrl,\n            ogpImageUrl: ogpBase64Url,\n            imageHeight: mainImageSize.height,\n            imageWidth: mainImageSize.width,\n            accessGenerationType: \"PUBLIC\",\n          },\n        },\n      })\n\n      if (work.data?.createWork === undefined) {\n        toast(t(\"ä½œå“ã®æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to post the work\"))\n        return\n      }\n\n      dispatch({\n        type: \"MARK_AS_DONE\",\n        payload: {\n          uploadedWorkId: work.data?.createWork.id,\n          uploadedWorkUuid: work.data?.createWork.uuid,\n        },\n      })\n\n      toast(t(\"ä½œå“ã‚’æŠ•ç¨¿ã—ã¾ã—ãŸ\", \"Work has been posted\"))\n    } catch (error) {\n      console.error(\"å‹•ç”»æŠ•ç¨¿ã‚¨ãƒ©ãƒ¼:\", error)\n      if (error instanceof Error) {\n        toast(error.message)\n      } else {\n        toast(t(\"å‹•ç”»ã®æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to post video\"))\n      }\n      const promises = uploadedImageUrls.map((url) => {\n        return deleteUploadedImage(url)\n      })\n      await Promise.all(promises)\n      // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆã™ã‚‹å‰ã«å°‘ã—å¾…æ©Ÿã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèªã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹\n      setTimeout(() => {\n        dispatch({ type: \"SET_PROGRESS\", payload: 0 })\n      }, 3000)\n    }\n  }\n\n  const createdAt = new Date(\n    `${inputState.reservationDate}T${inputState.reservationTime}`,\n  )\n\n  // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n  useBeforeUnload(\n    // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n    React.useCallback(\n      (event) => {\n        if (state) {\n          const confirmationMessage = t(\n            \"ãƒšãƒ¼ã‚¸é·ç§»ã™ã‚‹ã¨å¤‰æ›´ãŒæ¶ˆãˆã¾ã™ãŒå•é¡Œç„¡ã„ã§ã™ã‹ï¼Ÿ\",\n            \"Changes will be lost if you navigate away. Is that okay?\",\n          )\n          event.returnValue = confirmationMessage\n          return confirmationMessage\n        }\n      },\n      [state, t],\n    ),\n  )\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <div className=\"m-auto w-full max-w-[1200px] space-y-4 pb-4\">\n      <div className=\"space-y-4\">\n        <div>\n          <PostFormHeader type=\"animation\" />\n          <PostAnimationFormUploader state={state} dispatch={dispatch} />\n        </div>\n        <PostAnimationFormInput\n          state={inputState}\n          dispatch={dispatchInput}\n          albums={viewer?.albums ?? []}\n          currentPass={viewer?.viewer?.currentPass ?? null}\n          recentlyUsedTags={viewer?.viewer?.recentlyUsedTags ?? []}\n          themes={\n            viewer?.dailyThemes\n              ? viewer.dailyThemes.map((theme) => ({\n                  date: theme.dateText,\n                  title: theme.title,\n                  id: theme.id,\n                }))\n              : null\n          }\n          aiModels={viewer?.aiModels ?? []}\n          events={viewer?.appEvents ?? []}\n          needFix={false}\n        />\n        <div className=\"h-4\" />\n        <Button\n          className=\"fixed bottom-0 left-0 z-60 ml-0 w-full rounded-none p-0 md:ml-[72px] md:pr-[72px] lg:ml-[224px] lg:pr-[224px] xl:left-auto xl:m-0 xl:max-w-[1200px] xl:pl-[8%]\"\n          size={\"lg\"}\n          type=\"submit\"\n          onClick={onPost}\n        >\n          {t(\"æŠ•ç¨¿\", \"Post\")}\n        </Button>\n      </div>\n      <SuccessCreatedWorkDialog\n        isOpen={state.progress === 100}\n        title={inputState.title}\n        description={inputState.caption}\n        imageBase64={state.thumbnailBase64}\n        workId={state.uploadedWorkId}\n        uuid={state.uploadedWorkUuid}\n        shareTags={[\"Aipictors\", \"AIã‚¤ãƒ©ã‚¹ãƒˆ\", \"AIart\"]}\n        createdAt={createdAt.getTime()}\n        accessType={inputState.accessType}\n      />\n      <CreatingWorkDialog\n        progress={state.progress}\n        isOpen={state.progress !== 0 && state.progress !== 100}\n      />\n    </div>\n  )\n}\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.NEW_ANIMATION, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const now = getJstDate(new Date())\n\n  const afterDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const result = await loaderClient.query({\n    query: ViewerQuery,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: \"-1\",\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: now.toISOString().split(\"T\")[0],\n      endDate: afterDate.toISOString().split(\"T\")[0],\n    },\n  })\n\n  return {\n    ...result.data,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  // è¨­å®šç”»é¢ãªã®ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nconst ViewerQuery = graphql(\n  `query ViewerQuery(\n    $limit: Int!,\n    $offset: Int!,\n    $ownerUserId: ID,\n    $startDate: String!,\n    $endDate: String!,\n    $startAt: String!,\n  ) {\n    viewer {\n      id\n      token\n      currentPass {\n        ...PostAnimationFormPass\n      }\n      recentlyUsedTags {\n        ...PostAnimationFormRecentlyUsedTags\n      }\n    }\n    albums(\n      offset: $offset,\n      limit: $limit,\n      where: {\n        ownerUserId: $ownerUserId,\n        needInspected: false,\n        needsThumbnailImage: false,\n      }\n    ) {\n      ...PostAnimationFormAlbum\n    }\n    aiModels(offset: 0, limit: 124, where: {}) {\n      id\n      ...PostAnimationFormAiModel\n    }\n    dailyThemes(\n      limit: 8,\n      offset: 0,\n      where: {\n        startDate: $startDate,\n        endDate: $endDate,\n      }) {\n      id\n      title\n      dateText\n    }\n    appEvents(\n      limit: 8,\n      offset: 0,\n      where: {\n        endAt: $startAt,\n      }\n    ) {\n      id\n      description\n      title\n      tag\n      slug\n      endAt\n    }\n  }`,\n  [\n    PostAnimationFormAiModelFragment,\n    PostAnimationFormAlbumFragment,\n    PostAnimationFormPassFragment,\n    PostAnimationFormRecentlyUsedTagsFragment,\n  ],\n)\n\nconst CreateWorkMutation = graphql(\n  `mutation CreateWork($input: CreateWorkInput!) {\n    createWork(input: $input) {\n      id\n      title\n      accessType\n      nanoid\n      uuid\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.animation/route.tsx"},"span":[11147,11160],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { deleteUploadedImage } from \"~/utils/delete-uploaded-image\"\nimport { getSizeFromBase64 } from \"~/utils/get-size-from-base64\"\nimport { resizeImage } from \"~/utils/resize-image\"\nimport { sha256 } from \"~/utils/sha256\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { uploadPublicVideo } from \"~/utils/upload-public-video\"\nimport {\n  PostAnimationFormInput,\n  PostAnimationFormAiModelFragment,\n  PostAnimationFormAlbumFragment,\n  PostAnimationFormPassFragment,\n  PostAnimationFormRecentlyUsedTagsFragment,\n} from \"~/routes/($lang)._main.new.animation/components/post-animation-form-input\"\nimport { PostAnimationFormUploader } from \"~/routes/($lang)._main.new.animation/components/post-animation-form-uploader\"\nimport { postAnimationFormInputReducer } from \"~/routes/($lang)._main.new.animation/reducers/post-animation-form-input-reducer\"\nimport { postAnimationFormReducer } from \"~/routes/($lang)._main.new.animation/reducers/post-animation-form-reducer\"\nimport { CreatingWorkDialog } from \"~/routes/($lang)._main.new.image/components/creating-work-dialog\"\nimport { SuccessCreatedWorkDialog } from \"~/routes/($lang)._main.new.image/components/success-created-work-dialog\"\nimport { vPostImageForm } from \"~/routes/($lang)._main.new.image/validations/post-image-form\"\nimport { useQuery, useMutation } from \"@apollo/client/index\"\nimport {\n  type MetaFunction,\n  useBeforeUnload,\n  useLoaderData,\n} from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport React from \"react\"\nimport { useContext, useReducer } from \"react\"\nimport { toast } from \"sonner\"\nimport { safeParse } from \"valibot\"\nimport { PostFormHeader } from \"~/routes/($lang)._main.new.image/components/post-form-header\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { getJstDate } from \"~/utils/jst-date\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport type { HeadersFunction, LoaderFunctionArgs } from \"@remix-run/cloudflare\"\nimport { loaderClient } from \"~/lib/loader-client\"\n\nexport default function NewAnimation () {\n  const data = useLoaderData<typeof loader>()\n\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const [state, dispatch] = useReducer(postAnimationFormReducer, {\n    isThumbnailLandscape: false,\n    ogpBase64: null,\n    progress: 0,\n    thumbnailBase64: null,\n    thumbnailPosX: 0,\n    thumbnailPosY: 0,\n    uploadedWorkId: null,\n    uploadedWorkUuid: null,\n    videoFile: null,\n    isHovered: false,\n  })\n\n  const [inputState, dispatchInput] = useReducer(\n    postAnimationFormInputReducer,\n    {\n      accessType: \"PUBLIC\",\n      aiModelId: \"1\",\n      albumId: null,\n      caption: \"\",\n      date: new Date(),\n      enCaption: \"\",\n      enTitle: \"\",\n      animationStyle: \"ILLUSTRATION\",\n      link: \"\",\n      ratingRestriction: \"G\",\n      reservationDate: null,\n      reservationTime: null,\n      tags: [],\n      themeId: null,\n      title: \"\",\n      useCommentFeature: true,\n      useGenerationParams: true,\n      usePromotionFeature: false,\n      useTagFeature: true,\n      correctionMessage: \"\",\n    },\n  )\n\n  const now = getJstDate(new Date())\n\n  const afterDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const { data: viewer } = useQuery(ViewerQuery, {\n    skip: authContext.isNotLoggedIn,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: authContext.userId,\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: now.toISOString().split(\"T\")[0],\n      endDate: afterDate.toISOString().split(\"T\")[0],\n    },\n  })\n\n  const [createWork, { loading: isCreatedLoading }] =\n    useMutation(CreateWorkMutation)\n\n  const formResult = safeParse(vPostImageForm, {\n    title: inputState.title,\n    caption: inputState.caption,\n    enTitle: inputState.enTitle,\n    enCaption: inputState.enCaption,\n    thumbnailBase64: state.thumbnailBase64,\n  })\n\n  const uploadVideo = async () => {\n    if (state.videoFile === null) {\n      return null\n    }\n\n    const videoUrl = await uploadPublicVideo(\n      state.videoFile as File,\n      viewer?.viewer?.token,\n    )\n\n    return videoUrl\n  }\n\n  const onPost = async () => {\n    if (formResult.success === false) {\n      for (const issue of formResult.issues) {\n        toast(issue.message)\n        return\n      }\n      return\n    }\n\n    // å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã‚µãƒ ãƒã‚¤ãƒ«ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯\n    if (state.videoFile === null) {\n      toast(t(\"å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„\", \"Please select a video file\"))\n      return\n    }\n\n    if (state.thumbnailBase64 === null) {\n      toast(\n        t(\n          \"å‹•ç”»ã®ã‚µãƒ ãƒã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†é¸æŠã—ã¦ãã ã•ã„\",\n          \"Video thumbnail not generated. Please reselect the video file\",\n        ),\n      )\n      return\n    }\n\n    if (\n      inputState.reservationDate !== null &&\n      inputState.reservationTime === null\n    ) {\n      toast(\n        t(\n          \"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter a time for the scheduled post\",\n        ),\n      )\n      return\n    }\n\n    if (\n      inputState.reservationDate === null &&\n      inputState.reservationTime !== null\n    ) {\n      toast(\n        t(\n          \"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter a time for the scheduled post\",\n        ),\n      )\n      return\n    }\n\n    const uploadedImageUrls = []\n\n    try {\n      dispatch({ type: \"SET_PROGRESS\", payload: 10 })\n\n      const smallThumbnail = state.isThumbnailLandscape\n        ? await resizeImage(formResult.output.thumbnailBase64, 400, 0, \"webp\")\n        : await resizeImage(formResult.output.thumbnailBase64, 0, 400, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 20 })\n\n      const largeThumbnail = state.isThumbnailLandscape\n        ? await resizeImage(formResult.output.thumbnailBase64, 600, 0, \"webp\")\n        : await resizeImage(formResult.output.thumbnailBase64, 0, 600, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 30 })\n\n      const thumbnailUrl = await uploadPublicImage(\n        formResult.output.thumbnailBase64,\n        viewer?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 40 })\n\n      uploadedImageUrls.push(thumbnailUrl)\n\n      const smallThumbnailUrl = await uploadPublicImage(\n        smallThumbnail.base64,\n        viewer?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 45 })\n\n      uploadedImageUrls.push(smallThumbnailUrl)\n\n      const largeThumbnailUrl = await uploadPublicImage(\n        largeThumbnail.base64,\n        viewer?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 50 })\n\n      uploadedImageUrls.push(largeThumbnailUrl)\n\n      const ogpBase64Url = state.ogpBase64\n        ? await uploadPublicImage(state.ogpBase64, viewer?.viewer?.token)\n        : null\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 60 })\n\n      if (ogpBase64Url !== null) {\n        uploadedImageUrls.push(ogpBase64Url)\n      }\n\n      const reservedAt =\n        inputState.reservationDate !== null &&\n        inputState.reservationTime !== null\n          ? new Date(\n              `${inputState.reservationDate}T${inputState.reservationTime}`,\n            ).getTime() +\n            3600000 * 9\n          : undefined\n\n      const mainImageSha256 = await sha256(formResult.output.thumbnailBase64)\n\n      const mainImageSize = await getSizeFromBase64(\n        formResult.output.thumbnailBase64,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 70 })\n\n      const uploadedUrl = await uploadVideo()\n\n      if (!uploadedUrl) {\n        toast(\n          t(\"å‹•ç”»ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to upload the video\"),\n        )\n        return\n      }\n\n      const work = await createWork({\n        variables: {\n          input: {\n            title: formResult.output.title,\n            entitle: formResult.output.enTitle,\n            explanation: formResult.output.caption,\n            enExplanation: formResult.output.enCaption,\n            rating: inputState.ratingRestriction,\n            prompt: null,\n            negativePrompt: null,\n            seed: null,\n            sampler: null,\n            strength: null,\n            noise: null,\n            modelName: null,\n            modelHash: null,\n            otherGenerationParams: null,\n            pngInfo: null,\n            imageStyle: inputState.animationStyle,\n            relatedUrl: inputState.link,\n            tags: inputState.tags.map((tag) => tag.text),\n            isTagEditable: inputState.useTagFeature,\n            isCommentEditable: inputState.useCommentFeature,\n            thumbnailPosition: state.isThumbnailLandscape\n              ? state.thumbnailPosX\n              : state.thumbnailPosY,\n            modelId: inputState.aiModelId,\n            type: \"WORK\",\n            subjectId: inputState.themeId,\n            albumId: inputState.albumId,\n            isPromotion: inputState.usePromotionFeature,\n            reservedAt: reservedAt,\n            mainImageSha256: mainImageSha256,\n            accessType: inputState.accessType,\n            imageUrls: [thumbnailUrl],\n            smallThumbnailImageURL: smallThumbnailUrl,\n            smallThumbnailImageWidth: smallThumbnail.width,\n            smallThumbnailImageHeight: smallThumbnail.height,\n            largeThumbnailImageURL: largeThumbnailUrl,\n            largeThumbnailImageWidth: largeThumbnail.width,\n            largeThumbnailImageHeight: largeThumbnail.height,\n            videoUrl: uploadedUrl,\n            ogpImageUrl: ogpBase64Url,\n            imageHeight: mainImageSize.height,\n            imageWidth: mainImageSize.width,\n            accessGenerationType: \"PUBLIC\",\n          },\n        },\n      })\n\n      if (work.data?.createWork === undefined) {\n        toast(t(\"ä½œå“ã®æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to post the work\"))\n        return\n      }\n\n      dispatch({\n        type: \"MARK_AS_DONE\",\n        payload: {\n          uploadedWorkId: work.data?.createWork.id,\n          uploadedWorkUuid: work.data?.createWork.uuid,\n        },\n      })\n\n      toast(t(\"ä½œå“ã‚’æŠ•ç¨¿ã—ã¾ã—ãŸ\", \"Work has been posted\"))\n    } catch (error) {\n      console.error(\"å‹•ç”»æŠ•ç¨¿ã‚¨ãƒ©ãƒ¼:\", error)\n      if (error instanceof Error) {\n        toast(error.message)\n      } else {\n        toast(t(\"å‹•ç”»ã®æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to post video\"))\n      }\n      const promises = uploadedImageUrls.map((url) => {\n        return deleteUploadedImage(url)\n      })\n      await Promise.all(promises)\n      // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆã™ã‚‹å‰ã«å°‘ã—å¾…æ©Ÿã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèªã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹\n      setTimeout(() => {\n        dispatch({ type: \"SET_PROGRESS\", payload: 0 })\n      }, 3000)\n    }\n  }\n\n  const createdAt = new Date(\n    `${inputState.reservationDate}T${inputState.reservationTime}`,\n  )\n\n  // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n  useBeforeUnload(\n    // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n    React.useCallback(\n      (event) => {\n        if (state) {\n          const confirmationMessage = t(\n            \"ãƒšãƒ¼ã‚¸é·ç§»ã™ã‚‹ã¨å¤‰æ›´ãŒæ¶ˆãˆã¾ã™ãŒå•é¡Œç„¡ã„ã§ã™ã‹ï¼Ÿ\",\n            \"Changes will be lost if you navigate away. Is that okay?\",\n          )\n          event.returnValue = confirmationMessage\n          return confirmationMessage\n        }\n      },\n      [state, t],\n    ),\n  )\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <div className=\"m-auto w-full max-w-[1200px] space-y-4 pb-4\">\n      <div className=\"space-y-4\">\n        <div>\n          <PostFormHeader type=\"animation\" />\n          <PostAnimationFormUploader state={state} dispatch={dispatch} />\n        </div>\n        <PostAnimationFormInput\n          state={inputState}\n          dispatch={dispatchInput}\n          albums={viewer?.albums ?? []}\n          currentPass={viewer?.viewer?.currentPass ?? null}\n          recentlyUsedTags={viewer?.viewer?.recentlyUsedTags ?? []}\n          themes={\n            viewer?.dailyThemes\n              ? viewer.dailyThemes.map((theme) => ({\n                  date: theme.dateText,\n                  title: theme.title,\n                  id: theme.id,\n                }))\n              : null\n          }\n          aiModels={viewer?.aiModels ?? []}\n          events={viewer?.appEvents ?? []}\n          needFix={false}\n        />\n        <div className=\"h-4\" />\n        <Button\n          className=\"fixed bottom-0 left-0 z-60 ml-0 w-full rounded-none p-0 md:ml-[72px] md:pr-[72px] lg:ml-[224px] lg:pr-[224px] xl:left-auto xl:m-0 xl:max-w-[1200px] xl:pl-[8%]\"\n          size={\"lg\"}\n          type=\"submit\"\n          onClick={onPost}\n        >\n          {t(\"æŠ•ç¨¿\", \"Post\")}\n        </Button>\n      </div>\n      <SuccessCreatedWorkDialog\n        isOpen={state.progress === 100}\n        title={inputState.title}\n        description={inputState.caption}\n        imageBase64={state.thumbnailBase64}\n        workId={state.uploadedWorkId}\n        uuid={state.uploadedWorkUuid}\n        shareTags={[\"Aipictors\", \"AIã‚¤ãƒ©ã‚¹ãƒˆ\", \"AIart\"]}\n        createdAt={createdAt.getTime()}\n        accessType={inputState.accessType}\n      />\n      <CreatingWorkDialog\n        progress={state.progress}\n        isOpen={state.progress !== 0 && state.progress !== 100}\n      />\n    </div>\n  )\n}\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.NEW_ANIMATION, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const now = getJstDate(new Date())\n\n  const afterDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const result = await loaderClient.query({\n    query: ViewerQuery,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: \"-1\",\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: now.toISOString().split(\"T\")[0],\n      endDate: afterDate.toISOString().split(\"T\")[0],\n    },\n  })\n\n  return {\n    ...result.data,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  // è¨­å®šç”»é¢ãªã®ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nconst ViewerQuery = graphql(\n  `query ViewerQuery(\n    $limit: Int!,\n    $offset: Int!,\n    $ownerUserId: ID,\n    $startDate: String!,\n    $endDate: String!,\n    $startAt: String!,\n  ) {\n    viewer {\n      id\n      token\n      currentPass {\n        ...PostAnimationFormPass\n      }\n      recentlyUsedTags {\n        ...PostAnimationFormRecentlyUsedTags\n      }\n    }\n    albums(\n      offset: $offset,\n      limit: $limit,\n      where: {\n        ownerUserId: $ownerUserId,\n        needInspected: false,\n        needsThumbnailImage: false,\n      }\n    ) {\n      ...PostAnimationFormAlbum\n    }\n    aiModels(offset: 0, limit: 124, where: {}) {\n      id\n      ...PostAnimationFormAiModel\n    }\n    dailyThemes(\n      limit: 8,\n      offset: 0,\n      where: {\n        startDate: $startDate,\n        endDate: $endDate,\n      }) {\n      id\n      title\n      dateText\n    }\n    appEvents(\n      limit: 8,\n      offset: 0,\n      where: {\n        endAt: $startAt,\n      }\n    ) {\n      id\n      description\n      title\n      tag\n      slug\n      endAt\n    }\n  }`,\n  [\n    PostAnimationFormAiModelFragment,\n    PostAnimationFormAlbumFragment,\n    PostAnimationFormPassFragment,\n    PostAnimationFormRecentlyUsedTagsFragment,\n  ],\n)\n\nconst CreateWorkMutation = graphql(\n  `mutation CreateWork($input: CreateWorkInput!) {\n    createWork(input: $input) {\n      id\n      title\n      accessType\n      nanoid\n      uuid\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable isCreatedLoading is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"isCreatedLoading"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.animation/route.tsx"},"span":[3703,3719],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { deleteUploadedImage } from \"~/utils/delete-uploaded-image\"\nimport { getSizeFromBase64 } from \"~/utils/get-size-from-base64\"\nimport { resizeImage } from \"~/utils/resize-image\"\nimport { sha256 } from \"~/utils/sha256\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { uploadPublicVideo } from \"~/utils/upload-public-video\"\nimport {\n  PostAnimationFormInput,\n  PostAnimationFormAiModelFragment,\n  PostAnimationFormAlbumFragment,\n  PostAnimationFormPassFragment,\n  PostAnimationFormRecentlyUsedTagsFragment,\n} from \"~/routes/($lang)._main.new.animation/components/post-animation-form-input\"\nimport { PostAnimationFormUploader } from \"~/routes/($lang)._main.new.animation/components/post-animation-form-uploader\"\nimport { postAnimationFormInputReducer } from \"~/routes/($lang)._main.new.animation/reducers/post-animation-form-input-reducer\"\nimport { postAnimationFormReducer } from \"~/routes/($lang)._main.new.animation/reducers/post-animation-form-reducer\"\nimport { CreatingWorkDialog } from \"~/routes/($lang)._main.new.image/components/creating-work-dialog\"\nimport { SuccessCreatedWorkDialog } from \"~/routes/($lang)._main.new.image/components/success-created-work-dialog\"\nimport { vPostImageForm } from \"~/routes/($lang)._main.new.image/validations/post-image-form\"\nimport { useQuery, useMutation } from \"@apollo/client/index\"\nimport {\n  type MetaFunction,\n  useBeforeUnload,\n  useLoaderData,\n} from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport React from \"react\"\nimport { useContext, useReducer } from \"react\"\nimport { toast } from \"sonner\"\nimport { safeParse } from \"valibot\"\nimport { PostFormHeader } from \"~/routes/($lang)._main.new.image/components/post-form-header\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { getJstDate } from \"~/utils/jst-date\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport type { HeadersFunction, LoaderFunctionArgs } from \"@remix-run/cloudflare\"\nimport { loaderClient } from \"~/lib/loader-client\"\n\nexport default function NewAnimation () {\n  const data = useLoaderData<typeof loader>()\n\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const [state, dispatch] = useReducer(postAnimationFormReducer, {\n    isThumbnailLandscape: false,\n    ogpBase64: null,\n    progress: 0,\n    thumbnailBase64: null,\n    thumbnailPosX: 0,\n    thumbnailPosY: 0,\n    uploadedWorkId: null,\n    uploadedWorkUuid: null,\n    videoFile: null,\n    isHovered: false,\n  })\n\n  const [inputState, dispatchInput] = useReducer(\n    postAnimationFormInputReducer,\n    {\n      accessType: \"PUBLIC\",\n      aiModelId: \"1\",\n      albumId: null,\n      caption: \"\",\n      date: new Date(),\n      enCaption: \"\",\n      enTitle: \"\",\n      animationStyle: \"ILLUSTRATION\",\n      link: \"\",\n      ratingRestriction: \"G\",\n      reservationDate: null,\n      reservationTime: null,\n      tags: [],\n      themeId: null,\n      title: \"\",\n      useCommentFeature: true,\n      useGenerationParams: true,\n      usePromotionFeature: false,\n      useTagFeature: true,\n      correctionMessage: \"\",\n    },\n  )\n\n  const now = getJstDate(new Date())\n\n  const afterDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const { data: viewer } = useQuery(ViewerQuery, {\n    skip: authContext.isNotLoggedIn,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: authContext.userId,\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: now.toISOString().split(\"T\")[0],\n      endDate: afterDate.toISOString().split(\"T\")[0],\n    },\n  })\n\n  const [createWork, { loading: isCreatedLoading }] =\n    useMutation(CreateWorkMutation)\n\n  const formResult = safeParse(vPostImageForm, {\n    title: inputState.title,\n    caption: inputState.caption,\n    enTitle: inputState.enTitle,\n    enCaption: inputState.enCaption,\n    thumbnailBase64: state.thumbnailBase64,\n  })\n\n  const uploadVideo = async () => {\n    if (state.videoFile === null) {\n      return null\n    }\n\n    const videoUrl = await uploadPublicVideo(\n      state.videoFile as File,\n      viewer?.viewer?.token,\n    )\n\n    return videoUrl\n  }\n\n  const onPost = async () => {\n    if (formResult.success === false) {\n      for (const issue of formResult.issues) {\n        toast(issue.message)\n        return\n      }\n      return\n    }\n\n    // å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã‚µãƒ ãƒã‚¤ãƒ«ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯\n    if (state.videoFile === null) {\n      toast(t(\"å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„\", \"Please select a video file\"))\n      return\n    }\n\n    if (state.thumbnailBase64 === null) {\n      toast(\n        t(\n          \"å‹•ç”»ã®ã‚µãƒ ãƒã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†é¸æŠã—ã¦ãã ã•ã„\",\n          \"Video thumbnail not generated. Please reselect the video file\",\n        ),\n      )\n      return\n    }\n\n    if (\n      inputState.reservationDate !== null &&\n      inputState.reservationTime === null\n    ) {\n      toast(\n        t(\n          \"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter a time for the scheduled post\",\n        ),\n      )\n      return\n    }\n\n    if (\n      inputState.reservationDate === null &&\n      inputState.reservationTime !== null\n    ) {\n      toast(\n        t(\n          \"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter a time for the scheduled post\",\n        ),\n      )\n      return\n    }\n\n    const uploadedImageUrls = []\n\n    try {\n      dispatch({ type: \"SET_PROGRESS\", payload: 10 })\n\n      const smallThumbnail = state.isThumbnailLandscape\n        ? await resizeImage(formResult.output.thumbnailBase64, 400, 0, \"webp\")\n        : await resizeImage(formResult.output.thumbnailBase64, 0, 400, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 20 })\n\n      const largeThumbnail = state.isThumbnailLandscape\n        ? await resizeImage(formResult.output.thumbnailBase64, 600, 0, \"webp\")\n        : await resizeImage(formResult.output.thumbnailBase64, 0, 600, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 30 })\n\n      const thumbnailUrl = await uploadPublicImage(\n        formResult.output.thumbnailBase64,\n        viewer?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 40 })\n\n      uploadedImageUrls.push(thumbnailUrl)\n\n      const smallThumbnailUrl = await uploadPublicImage(\n        smallThumbnail.base64,\n        viewer?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 45 })\n\n      uploadedImageUrls.push(smallThumbnailUrl)\n\n      const largeThumbnailUrl = await uploadPublicImage(\n        largeThumbnail.base64,\n        viewer?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 50 })\n\n      uploadedImageUrls.push(largeThumbnailUrl)\n\n      const ogpBase64Url = state.ogpBase64\n        ? await uploadPublicImage(state.ogpBase64, viewer?.viewer?.token)\n        : null\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 60 })\n\n      if (ogpBase64Url !== null) {\n        uploadedImageUrls.push(ogpBase64Url)\n      }\n\n      const reservedAt =\n        inputState.reservationDate !== null &&\n        inputState.reservationTime !== null\n          ? new Date(\n              `${inputState.reservationDate}T${inputState.reservationTime}`,\n            ).getTime() +\n            3600000 * 9\n          : undefined\n\n      const mainImageSha256 = await sha256(formResult.output.thumbnailBase64)\n\n      const mainImageSize = await getSizeFromBase64(\n        formResult.output.thumbnailBase64,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 70 })\n\n      const uploadedUrl = await uploadVideo()\n\n      if (!uploadedUrl) {\n        toast(\n          t(\"å‹•ç”»ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to upload the video\"),\n        )\n        return\n      }\n\n      const work = await createWork({\n        variables: {\n          input: {\n            title: formResult.output.title,\n            entitle: formResult.output.enTitle,\n            explanation: formResult.output.caption,\n            enExplanation: formResult.output.enCaption,\n            rating: inputState.ratingRestriction,\n            prompt: null,\n            negativePrompt: null,\n            seed: null,\n            sampler: null,\n            strength: null,\n            noise: null,\n            modelName: null,\n            modelHash: null,\n            otherGenerationParams: null,\n            pngInfo: null,\n            imageStyle: inputState.animationStyle,\n            relatedUrl: inputState.link,\n            tags: inputState.tags.map((tag) => tag.text),\n            isTagEditable: inputState.useTagFeature,\n            isCommentEditable: inputState.useCommentFeature,\n            thumbnailPosition: state.isThumbnailLandscape\n              ? state.thumbnailPosX\n              : state.thumbnailPosY,\n            modelId: inputState.aiModelId,\n            type: \"WORK\",\n            subjectId: inputState.themeId,\n            albumId: inputState.albumId,\n            isPromotion: inputState.usePromotionFeature,\n            reservedAt: reservedAt,\n            mainImageSha256: mainImageSha256,\n            accessType: inputState.accessType,\n            imageUrls: [thumbnailUrl],\n            smallThumbnailImageURL: smallThumbnailUrl,\n            smallThumbnailImageWidth: smallThumbnail.width,\n            smallThumbnailImageHeight: smallThumbnail.height,\n            largeThumbnailImageURL: largeThumbnailUrl,\n            largeThumbnailImageWidth: largeThumbnail.width,\n            largeThumbnailImageHeight: largeThumbnail.height,\n            videoUrl: uploadedUrl,\n            ogpImageUrl: ogpBase64Url,\n            imageHeight: mainImageSize.height,\n            imageWidth: mainImageSize.width,\n            accessGenerationType: \"PUBLIC\",\n          },\n        },\n      })\n\n      if (work.data?.createWork === undefined) {\n        toast(t(\"ä½œå“ã®æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to post the work\"))\n        return\n      }\n\n      dispatch({\n        type: \"MARK_AS_DONE\",\n        payload: {\n          uploadedWorkId: work.data?.createWork.id,\n          uploadedWorkUuid: work.data?.createWork.uuid,\n        },\n      })\n\n      toast(t(\"ä½œå“ã‚’æŠ•ç¨¿ã—ã¾ã—ãŸ\", \"Work has been posted\"))\n    } catch (error) {\n      console.error(\"å‹•ç”»æŠ•ç¨¿ã‚¨ãƒ©ãƒ¼:\", error)\n      if (error instanceof Error) {\n        toast(error.message)\n      } else {\n        toast(t(\"å‹•ç”»ã®æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to post video\"))\n      }\n      const promises = uploadedImageUrls.map((url) => {\n        return deleteUploadedImage(url)\n      })\n      await Promise.all(promises)\n      // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆã™ã‚‹å‰ã«å°‘ã—å¾…æ©Ÿã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèªã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹\n      setTimeout(() => {\n        dispatch({ type: \"SET_PROGRESS\", payload: 0 })\n      }, 3000)\n    }\n  }\n\n  const createdAt = new Date(\n    `${inputState.reservationDate}T${inputState.reservationTime}`,\n  )\n\n  // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n  useBeforeUnload(\n    // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n    React.useCallback(\n      (event) => {\n        if (state) {\n          const confirmationMessage = t(\n            \"ãƒšãƒ¼ã‚¸é·ç§»ã™ã‚‹ã¨å¤‰æ›´ãŒæ¶ˆãˆã¾ã™ãŒå•é¡Œç„¡ã„ã§ã™ã‹ï¼Ÿ\",\n            \"Changes will be lost if you navigate away. Is that okay?\",\n          )\n          event.returnValue = confirmationMessage\n          return confirmationMessage\n        }\n      },\n      [state, t],\n    ),\n  )\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <div className=\"m-auto w-full max-w-[1200px] space-y-4 pb-4\">\n      <div className=\"space-y-4\">\n        <div>\n          <PostFormHeader type=\"animation\" />\n          <PostAnimationFormUploader state={state} dispatch={dispatch} />\n        </div>\n        <PostAnimationFormInput\n          state={inputState}\n          dispatch={dispatchInput}\n          albums={viewer?.albums ?? []}\n          currentPass={viewer?.viewer?.currentPass ?? null}\n          recentlyUsedTags={viewer?.viewer?.recentlyUsedTags ?? []}\n          themes={\n            viewer?.dailyThemes\n              ? viewer.dailyThemes.map((theme) => ({\n                  date: theme.dateText,\n                  title: theme.title,\n                  id: theme.id,\n                }))\n              : null\n          }\n          aiModels={viewer?.aiModels ?? []}\n          events={viewer?.appEvents ?? []}\n          needFix={false}\n        />\n        <div className=\"h-4\" />\n        <Button\n          className=\"fixed bottom-0 left-0 z-60 ml-0 w-full rounded-none p-0 md:ml-[72px] md:pr-[72px] lg:ml-[224px] lg:pr-[224px] xl:left-auto xl:m-0 xl:max-w-[1200px] xl:pl-[8%]\"\n          size={\"lg\"}\n          type=\"submit\"\n          onClick={onPost}\n        >\n          {t(\"æŠ•ç¨¿\", \"Post\")}\n        </Button>\n      </div>\n      <SuccessCreatedWorkDialog\n        isOpen={state.progress === 100}\n        title={inputState.title}\n        description={inputState.caption}\n        imageBase64={state.thumbnailBase64}\n        workId={state.uploadedWorkId}\n        uuid={state.uploadedWorkUuid}\n        shareTags={[\"Aipictors\", \"AIã‚¤ãƒ©ã‚¹ãƒˆ\", \"AIart\"]}\n        createdAt={createdAt.getTime()}\n        accessType={inputState.accessType}\n      />\n      <CreatingWorkDialog\n        progress={state.progress}\n        isOpen={state.progress !== 0 && state.progress !== 100}\n      />\n    </div>\n  )\n}\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.NEW_ANIMATION, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const now = getJstDate(new Date())\n\n  const afterDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const result = await loaderClient.query({\n    query: ViewerQuery,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: \"-1\",\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: now.toISOString().split(\"T\")[0],\n      endDate: afterDate.toISOString().split(\"T\")[0],\n    },\n  })\n\n  return {\n    ...result.data,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  // è¨­å®šç”»é¢ãªã®ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nconst ViewerQuery = graphql(\n  `query ViewerQuery(\n    $limit: Int!,\n    $offset: Int!,\n    $ownerUserId: ID,\n    $startDate: String!,\n    $endDate: String!,\n    $startAt: String!,\n  ) {\n    viewer {\n      id\n      token\n      currentPass {\n        ...PostAnimationFormPass\n      }\n      recentlyUsedTags {\n        ...PostAnimationFormRecentlyUsedTags\n      }\n    }\n    albums(\n      offset: $offset,\n      limit: $limit,\n      where: {\n        ownerUserId: $ownerUserId,\n        needInspected: false,\n        needsThumbnailImage: false,\n      }\n    ) {\n      ...PostAnimationFormAlbum\n    }\n    aiModels(offset: 0, limit: 124, where: {}) {\n      id\n      ...PostAnimationFormAiModel\n    }\n    dailyThemes(\n      limit: 8,\n      offset: 0,\n      where: {\n        startDate: $startDate,\n        endDate: $endDate,\n      }) {\n      id\n      title\n      dateText\n    }\n    appEvents(\n      limit: 8,\n      offset: 0,\n      where: {\n        endAt: $startAt,\n      }\n    ) {\n      id\n      description\n      title\n      tag\n      slug\n      endAt\n    }\n  }`,\n  [\n    PostAnimationFormAiModelFragment,\n    PostAnimationFormAlbumFragment,\n    PostAnimationFormPassFragment,\n    PostAnimationFormRecentlyUsedTagsFragment,\n  ],\n)\n\nconst CreateWorkMutation = graphql(\n  `mutation CreateWork($input: CreateWorkInput!) {\n    createWork(input: $input) {\n      id\n      title\n      accessType\n      nanoid\n      uuid\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.animation/route.tsx"},"span":[11006,11071],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { deleteUploadedImage } from \"~/utils/delete-uploaded-image\"\nimport { getSizeFromBase64 } from \"~/utils/get-size-from-base64\"\nimport { resizeImage } from \"~/utils/resize-image\"\nimport { sha256 } from \"~/utils/sha256\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { uploadPublicVideo } from \"~/utils/upload-public-video\"\nimport {\n  PostAnimationFormInput,\n  PostAnimationFormAiModelFragment,\n  PostAnimationFormAlbumFragment,\n  PostAnimationFormPassFragment,\n  PostAnimationFormRecentlyUsedTagsFragment,\n} from \"~/routes/($lang)._main.new.animation/components/post-animation-form-input\"\nimport { PostAnimationFormUploader } from \"~/routes/($lang)._main.new.animation/components/post-animation-form-uploader\"\nimport { postAnimationFormInputReducer } from \"~/routes/($lang)._main.new.animation/reducers/post-animation-form-input-reducer\"\nimport { postAnimationFormReducer } from \"~/routes/($lang)._main.new.animation/reducers/post-animation-form-reducer\"\nimport { CreatingWorkDialog } from \"~/routes/($lang)._main.new.image/components/creating-work-dialog\"\nimport { SuccessCreatedWorkDialog } from \"~/routes/($lang)._main.new.image/components/success-created-work-dialog\"\nimport { vPostImageForm } from \"~/routes/($lang)._main.new.image/validations/post-image-form\"\nimport { useQuery, useMutation } from \"@apollo/client/index\"\nimport {\n  type MetaFunction,\n  useBeforeUnload,\n  useLoaderData,\n} from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport React from \"react\"\nimport { useContext, useReducer } from \"react\"\nimport { toast } from \"sonner\"\nimport { safeParse } from \"valibot\"\nimport { PostFormHeader } from \"~/routes/($lang)._main.new.image/components/post-form-header\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { getJstDate } from \"~/utils/jst-date\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport type { HeadersFunction, LoaderFunctionArgs } from \"@remix-run/cloudflare\"\nimport { loaderClient } from \"~/lib/loader-client\"\n\nexport default function NewAnimation () {\n  const data = useLoaderData<typeof loader>()\n\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const [state, dispatch] = useReducer(postAnimationFormReducer, {\n    isThumbnailLandscape: false,\n    ogpBase64: null,\n    progress: 0,\n    thumbnailBase64: null,\n    thumbnailPosX: 0,\n    thumbnailPosY: 0,\n    uploadedWorkId: null,\n    uploadedWorkUuid: null,\n    videoFile: null,\n    isHovered: false,\n  })\n\n  const [inputState, dispatchInput] = useReducer(\n    postAnimationFormInputReducer,\n    {\n      accessType: \"PUBLIC\",\n      aiModelId: \"1\",\n      albumId: null,\n      caption: \"\",\n      date: new Date(),\n      enCaption: \"\",\n      enTitle: \"\",\n      animationStyle: \"ILLUSTRATION\",\n      link: \"\",\n      ratingRestriction: \"G\",\n      reservationDate: null,\n      reservationTime: null,\n      tags: [],\n      themeId: null,\n      title: \"\",\n      useCommentFeature: true,\n      useGenerationParams: true,\n      usePromotionFeature: false,\n      useTagFeature: true,\n      correctionMessage: \"\",\n    },\n  )\n\n  const now = getJstDate(new Date())\n\n  const afterDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const { data: viewer } = useQuery(ViewerQuery, {\n    skip: authContext.isNotLoggedIn,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: authContext.userId,\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: now.toISOString().split(\"T\")[0],\n      endDate: afterDate.toISOString().split(\"T\")[0],\n    },\n  })\n\n  const [createWork, { loading: isCreatedLoading }] =\n    useMutation(CreateWorkMutation)\n\n  const formResult = safeParse(vPostImageForm, {\n    title: inputState.title,\n    caption: inputState.caption,\n    enTitle: inputState.enTitle,\n    enCaption: inputState.enCaption,\n    thumbnailBase64: state.thumbnailBase64,\n  })\n\n  const uploadVideo = async () => {\n    if (state.videoFile === null) {\n      return null\n    }\n\n    const videoUrl = await uploadPublicVideo(\n      state.videoFile as File,\n      viewer?.viewer?.token,\n    )\n\n    return videoUrl\n  }\n\n  const onPost = async () => {\n    if (formResult.success === false) {\n      for (const issue of formResult.issues) {\n        toast(issue.message)\n        return\n      }\n      return\n    }\n\n    // å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã‚µãƒ ãƒã‚¤ãƒ«ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯\n    if (state.videoFile === null) {\n      toast(t(\"å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„\", \"Please select a video file\"))\n      return\n    }\n\n    if (state.thumbnailBase64 === null) {\n      toast(\n        t(\n          \"å‹•ç”»ã®ã‚µãƒ ãƒã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†é¸æŠã—ã¦ãã ã•ã„\",\n          \"Video thumbnail not generated. Please reselect the video file\",\n        ),\n      )\n      return\n    }\n\n    if (\n      inputState.reservationDate !== null &&\n      inputState.reservationTime === null\n    ) {\n      toast(\n        t(\n          \"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter a time for the scheduled post\",\n        ),\n      )\n      return\n    }\n\n    if (\n      inputState.reservationDate === null &&\n      inputState.reservationTime !== null\n    ) {\n      toast(\n        t(\n          \"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter a time for the scheduled post\",\n        ),\n      )\n      return\n    }\n\n    const uploadedImageUrls = []\n\n    try {\n      dispatch({ type: \"SET_PROGRESS\", payload: 10 })\n\n      const smallThumbnail = state.isThumbnailLandscape\n        ? await resizeImage(formResult.output.thumbnailBase64, 400, 0, \"webp\")\n        : await resizeImage(formResult.output.thumbnailBase64, 0, 400, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 20 })\n\n      const largeThumbnail = state.isThumbnailLandscape\n        ? await resizeImage(formResult.output.thumbnailBase64, 600, 0, \"webp\")\n        : await resizeImage(formResult.output.thumbnailBase64, 0, 600, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 30 })\n\n      const thumbnailUrl = await uploadPublicImage(\n        formResult.output.thumbnailBase64,\n        viewer?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 40 })\n\n      uploadedImageUrls.push(thumbnailUrl)\n\n      const smallThumbnailUrl = await uploadPublicImage(\n        smallThumbnail.base64,\n        viewer?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 45 })\n\n      uploadedImageUrls.push(smallThumbnailUrl)\n\n      const largeThumbnailUrl = await uploadPublicImage(\n        largeThumbnail.base64,\n        viewer?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 50 })\n\n      uploadedImageUrls.push(largeThumbnailUrl)\n\n      const ogpBase64Url = state.ogpBase64\n        ? await uploadPublicImage(state.ogpBase64, viewer?.viewer?.token)\n        : null\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 60 })\n\n      if (ogpBase64Url !== null) {\n        uploadedImageUrls.push(ogpBase64Url)\n      }\n\n      const reservedAt =\n        inputState.reservationDate !== null &&\n        inputState.reservationTime !== null\n          ? new Date(\n              `${inputState.reservationDate}T${inputState.reservationTime}`,\n            ).getTime() +\n            3600000 * 9\n          : undefined\n\n      const mainImageSha256 = await sha256(formResult.output.thumbnailBase64)\n\n      const mainImageSize = await getSizeFromBase64(\n        formResult.output.thumbnailBase64,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 70 })\n\n      const uploadedUrl = await uploadVideo()\n\n      if (!uploadedUrl) {\n        toast(\n          t(\"å‹•ç”»ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to upload the video\"),\n        )\n        return\n      }\n\n      const work = await createWork({\n        variables: {\n          input: {\n            title: formResult.output.title,\n            entitle: formResult.output.enTitle,\n            explanation: formResult.output.caption,\n            enExplanation: formResult.output.enCaption,\n            rating: inputState.ratingRestriction,\n            prompt: null,\n            negativePrompt: null,\n            seed: null,\n            sampler: null,\n            strength: null,\n            noise: null,\n            modelName: null,\n            modelHash: null,\n            otherGenerationParams: null,\n            pngInfo: null,\n            imageStyle: inputState.animationStyle,\n            relatedUrl: inputState.link,\n            tags: inputState.tags.map((tag) => tag.text),\n            isTagEditable: inputState.useTagFeature,\n            isCommentEditable: inputState.useCommentFeature,\n            thumbnailPosition: state.isThumbnailLandscape\n              ? state.thumbnailPosX\n              : state.thumbnailPosY,\n            modelId: inputState.aiModelId,\n            type: \"WORK\",\n            subjectId: inputState.themeId,\n            albumId: inputState.albumId,\n            isPromotion: inputState.usePromotionFeature,\n            reservedAt: reservedAt,\n            mainImageSha256: mainImageSha256,\n            accessType: inputState.accessType,\n            imageUrls: [thumbnailUrl],\n            smallThumbnailImageURL: smallThumbnailUrl,\n            smallThumbnailImageWidth: smallThumbnail.width,\n            smallThumbnailImageHeight: smallThumbnail.height,\n            largeThumbnailImageURL: largeThumbnailUrl,\n            largeThumbnailImageWidth: largeThumbnail.width,\n            largeThumbnailImageHeight: largeThumbnail.height,\n            videoUrl: uploadedUrl,\n            ogpImageUrl: ogpBase64Url,\n            imageHeight: mainImageSize.height,\n            imageWidth: mainImageSize.width,\n            accessGenerationType: \"PUBLIC\",\n          },\n        },\n      })\n\n      if (work.data?.createWork === undefined) {\n        toast(t(\"ä½œå“ã®æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to post the work\"))\n        return\n      }\n\n      dispatch({\n        type: \"MARK_AS_DONE\",\n        payload: {\n          uploadedWorkId: work.data?.createWork.id,\n          uploadedWorkUuid: work.data?.createWork.uuid,\n        },\n      })\n\n      toast(t(\"ä½œå“ã‚’æŠ•ç¨¿ã—ã¾ã—ãŸ\", \"Work has been posted\"))\n    } catch (error) {\n      console.error(\"å‹•ç”»æŠ•ç¨¿ã‚¨ãƒ©ãƒ¼:\", error)\n      if (error instanceof Error) {\n        toast(error.message)\n      } else {\n        toast(t(\"å‹•ç”»ã®æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to post video\"))\n      }\n      const promises = uploadedImageUrls.map((url) => {\n        return deleteUploadedImage(url)\n      })\n      await Promise.all(promises)\n      // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆã™ã‚‹å‰ã«å°‘ã—å¾…æ©Ÿã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèªã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹\n      setTimeout(() => {\n        dispatch({ type: \"SET_PROGRESS\", payload: 0 })\n      }, 3000)\n    }\n  }\n\n  const createdAt = new Date(\n    `${inputState.reservationDate}T${inputState.reservationTime}`,\n  )\n\n  // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n  useBeforeUnload(\n    // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n    React.useCallback(\n      (event) => {\n        if (state) {\n          const confirmationMessage = t(\n            \"ãƒšãƒ¼ã‚¸é·ç§»ã™ã‚‹ã¨å¤‰æ›´ãŒæ¶ˆãˆã¾ã™ãŒå•é¡Œç„¡ã„ã§ã™ã‹ï¼Ÿ\",\n            \"Changes will be lost if you navigate away. Is that okay?\",\n          )\n          event.returnValue = confirmationMessage\n          return confirmationMessage\n        }\n      },\n      [state, t],\n    ),\n  )\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <div className=\"m-auto w-full max-w-[1200px] space-y-4 pb-4\">\n      <div className=\"space-y-4\">\n        <div>\n          <PostFormHeader type=\"animation\" />\n          <PostAnimationFormUploader state={state} dispatch={dispatch} />\n        </div>\n        <PostAnimationFormInput\n          state={inputState}\n          dispatch={dispatchInput}\n          albums={viewer?.albums ?? []}\n          currentPass={viewer?.viewer?.currentPass ?? null}\n          recentlyUsedTags={viewer?.viewer?.recentlyUsedTags ?? []}\n          themes={\n            viewer?.dailyThemes\n              ? viewer.dailyThemes.map((theme) => ({\n                  date: theme.dateText,\n                  title: theme.title,\n                  id: theme.id,\n                }))\n              : null\n          }\n          aiModels={viewer?.aiModels ?? []}\n          events={viewer?.appEvents ?? []}\n          needFix={false}\n        />\n        <div className=\"h-4\" />\n        <Button\n          className=\"fixed bottom-0 left-0 z-60 ml-0 w-full rounded-none p-0 md:ml-[72px] md:pr-[72px] lg:ml-[224px] lg:pr-[224px] xl:left-auto xl:m-0 xl:max-w-[1200px] xl:pl-[8%]\"\n          size={\"lg\"}\n          type=\"submit\"\n          onClick={onPost}\n        >\n          {t(\"æŠ•ç¨¿\", \"Post\")}\n        </Button>\n      </div>\n      <SuccessCreatedWorkDialog\n        isOpen={state.progress === 100}\n        title={inputState.title}\n        description={inputState.caption}\n        imageBase64={state.thumbnailBase64}\n        workId={state.uploadedWorkId}\n        uuid={state.uploadedWorkUuid}\n        shareTags={[\"Aipictors\", \"AIã‚¤ãƒ©ã‚¹ãƒˆ\", \"AIart\"]}\n        createdAt={createdAt.getTime()}\n        accessType={inputState.accessType}\n      />\n      <CreatingWorkDialog\n        progress={state.progress}\n        isOpen={state.progress !== 0 && state.progress !== 100}\n      />\n    </div>\n  )\n}\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.NEW_ANIMATION, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const now = getJstDate(new Date())\n\n  const afterDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const result = await loaderClient.query({\n    query: ViewerQuery,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: \"-1\",\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: now.toISOString().split(\"T\")[0],\n      endDate: afterDate.toISOString().split(\"T\")[0],\n    },\n  })\n\n  return {\n    ...result.data,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  // è¨­å®šç”»é¢ãªã®ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nconst ViewerQuery = graphql(\n  `query ViewerQuery(\n    $limit: Int!,\n    $offset: Int!,\n    $ownerUserId: ID,\n    $startDate: String!,\n    $endDate: String!,\n    $startAt: String!,\n  ) {\n    viewer {\n      id\n      token\n      currentPass {\n        ...PostAnimationFormPass\n      }\n      recentlyUsedTags {\n        ...PostAnimationFormRecentlyUsedTags\n      }\n    }\n    albums(\n      offset: $offset,\n      limit: $limit,\n      where: {\n        ownerUserId: $ownerUserId,\n        needInspected: false,\n        needsThumbnailImage: false,\n      }\n    ) {\n      ...PostAnimationFormAlbum\n    }\n    aiModels(offset: 0, limit: 124, where: {}) {\n      id\n      ...PostAnimationFormAiModel\n    }\n    dailyThemes(\n      limit: 8,\n      offset: 0,\n      where: {\n        startDate: $startDate,\n        endDate: $endDate,\n      }) {\n      id\n      title\n      dateText\n    }\n    appEvents(\n      limit: 8,\n      offset: 0,\n      where: {\n        endAt: $startAt,\n      }\n    ) {\n      id\n      description\n      title\n      tag\n      slug\n      endAt\n    }\n  }`,\n  [\n    PostAnimationFormAiModelFragment,\n    PostAnimationFormAlbumFragment,\n    PostAnimationFormPassFragment,\n    PostAnimationFormRecentlyUsedTagsFragment,\n  ],\n)\n\nconst CreateWorkMutation = graphql(\n  `mutation CreateWork($input: CreateWorkInput!) {\n    createWork(input: $input) {\n      id\n      title\n      accessType\n      nanoid\n      uuid\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.animation/route.tsx"},"span":[11095,11160],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { deleteUploadedImage } from \"~/utils/delete-uploaded-image\"\nimport { getSizeFromBase64 } from \"~/utils/get-size-from-base64\"\nimport { resizeImage } from \"~/utils/resize-image\"\nimport { sha256 } from \"~/utils/sha256\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { uploadPublicVideo } from \"~/utils/upload-public-video\"\nimport {\n  PostAnimationFormInput,\n  PostAnimationFormAiModelFragment,\n  PostAnimationFormAlbumFragment,\n  PostAnimationFormPassFragment,\n  PostAnimationFormRecentlyUsedTagsFragment,\n} from \"~/routes/($lang)._main.new.animation/components/post-animation-form-input\"\nimport { PostAnimationFormUploader } from \"~/routes/($lang)._main.new.animation/components/post-animation-form-uploader\"\nimport { postAnimationFormInputReducer } from \"~/routes/($lang)._main.new.animation/reducers/post-animation-form-input-reducer\"\nimport { postAnimationFormReducer } from \"~/routes/($lang)._main.new.animation/reducers/post-animation-form-reducer\"\nimport { CreatingWorkDialog } from \"~/routes/($lang)._main.new.image/components/creating-work-dialog\"\nimport { SuccessCreatedWorkDialog } from \"~/routes/($lang)._main.new.image/components/success-created-work-dialog\"\nimport { vPostImageForm } from \"~/routes/($lang)._main.new.image/validations/post-image-form\"\nimport { useQuery, useMutation } from \"@apollo/client/index\"\nimport {\n  type MetaFunction,\n  useBeforeUnload,\n  useLoaderData,\n} from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport React from \"react\"\nimport { useContext, useReducer } from \"react\"\nimport { toast } from \"sonner\"\nimport { safeParse } from \"valibot\"\nimport { PostFormHeader } from \"~/routes/($lang)._main.new.image/components/post-form-header\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { getJstDate } from \"~/utils/jst-date\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport type { HeadersFunction, LoaderFunctionArgs } from \"@remix-run/cloudflare\"\nimport { loaderClient } from \"~/lib/loader-client\"\n\nexport default function NewAnimation () {\n  const data = useLoaderData<typeof loader>()\n\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const [state, dispatch] = useReducer(postAnimationFormReducer, {\n    isThumbnailLandscape: false,\n    ogpBase64: null,\n    progress: 0,\n    thumbnailBase64: null,\n    thumbnailPosX: 0,\n    thumbnailPosY: 0,\n    uploadedWorkId: null,\n    uploadedWorkUuid: null,\n    videoFile: null,\n    isHovered: false,\n  })\n\n  const [inputState, dispatchInput] = useReducer(\n    postAnimationFormInputReducer,\n    {\n      accessType: \"PUBLIC\",\n      aiModelId: \"1\",\n      albumId: null,\n      caption: \"\",\n      date: new Date(),\n      enCaption: \"\",\n      enTitle: \"\",\n      animationStyle: \"ILLUSTRATION\",\n      link: \"\",\n      ratingRestriction: \"G\",\n      reservationDate: null,\n      reservationTime: null,\n      tags: [],\n      themeId: null,\n      title: \"\",\n      useCommentFeature: true,\n      useGenerationParams: true,\n      usePromotionFeature: false,\n      useTagFeature: true,\n      correctionMessage: \"\",\n    },\n  )\n\n  const now = getJstDate(new Date())\n\n  const afterDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const { data: viewer } = useQuery(ViewerQuery, {\n    skip: authContext.isNotLoggedIn,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: authContext.userId,\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: now.toISOString().split(\"T\")[0],\n      endDate: afterDate.toISOString().split(\"T\")[0],\n    },\n  })\n\n  const [createWork, { loading: isCreatedLoading }] =\n    useMutation(CreateWorkMutation)\n\n  const formResult = safeParse(vPostImageForm, {\n    title: inputState.title,\n    caption: inputState.caption,\n    enTitle: inputState.enTitle,\n    enCaption: inputState.enCaption,\n    thumbnailBase64: state.thumbnailBase64,\n  })\n\n  const uploadVideo = async () => {\n    if (state.videoFile === null) {\n      return null\n    }\n\n    const videoUrl = await uploadPublicVideo(\n      state.videoFile as File,\n      viewer?.viewer?.token,\n    )\n\n    return videoUrl\n  }\n\n  const onPost = async () => {\n    if (formResult.success === false) {\n      for (const issue of formResult.issues) {\n        toast(issue.message)\n        return\n      }\n      return\n    }\n\n    // å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã‚µãƒ ãƒã‚¤ãƒ«ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯\n    if (state.videoFile === null) {\n      toast(t(\"å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„\", \"Please select a video file\"))\n      return\n    }\n\n    if (state.thumbnailBase64 === null) {\n      toast(\n        t(\n          \"å‹•ç”»ã®ã‚µãƒ ãƒã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†é¸æŠã—ã¦ãã ã•ã„\",\n          \"Video thumbnail not generated. Please reselect the video file\",\n        ),\n      )\n      return\n    }\n\n    if (\n      inputState.reservationDate !== null &&\n      inputState.reservationTime === null\n    ) {\n      toast(\n        t(\n          \"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter a time for the scheduled post\",\n        ),\n      )\n      return\n    }\n\n    if (\n      inputState.reservationDate === null &&\n      inputState.reservationTime !== null\n    ) {\n      toast(\n        t(\n          \"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter a time for the scheduled post\",\n        ),\n      )\n      return\n    }\n\n    const uploadedImageUrls = []\n\n    try {\n      dispatch({ type: \"SET_PROGRESS\", payload: 10 })\n\n      const smallThumbnail = state.isThumbnailLandscape\n        ? await resizeImage(formResult.output.thumbnailBase64, 400, 0, \"webp\")\n        : await resizeImage(formResult.output.thumbnailBase64, 0, 400, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 20 })\n\n      const largeThumbnail = state.isThumbnailLandscape\n        ? await resizeImage(formResult.output.thumbnailBase64, 600, 0, \"webp\")\n        : await resizeImage(formResult.output.thumbnailBase64, 0, 600, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 30 })\n\n      const thumbnailUrl = await uploadPublicImage(\n        formResult.output.thumbnailBase64,\n        viewer?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 40 })\n\n      uploadedImageUrls.push(thumbnailUrl)\n\n      const smallThumbnailUrl = await uploadPublicImage(\n        smallThumbnail.base64,\n        viewer?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 45 })\n\n      uploadedImageUrls.push(smallThumbnailUrl)\n\n      const largeThumbnailUrl = await uploadPublicImage(\n        largeThumbnail.base64,\n        viewer?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 50 })\n\n      uploadedImageUrls.push(largeThumbnailUrl)\n\n      const ogpBase64Url = state.ogpBase64\n        ? await uploadPublicImage(state.ogpBase64, viewer?.viewer?.token)\n        : null\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 60 })\n\n      if (ogpBase64Url !== null) {\n        uploadedImageUrls.push(ogpBase64Url)\n      }\n\n      const reservedAt =\n        inputState.reservationDate !== null &&\n        inputState.reservationTime !== null\n          ? new Date(\n              `${inputState.reservationDate}T${inputState.reservationTime}`,\n            ).getTime() +\n            3600000 * 9\n          : undefined\n\n      const mainImageSha256 = await sha256(formResult.output.thumbnailBase64)\n\n      const mainImageSize = await getSizeFromBase64(\n        formResult.output.thumbnailBase64,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 70 })\n\n      const uploadedUrl = await uploadVideo()\n\n      if (!uploadedUrl) {\n        toast(\n          t(\"å‹•ç”»ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to upload the video\"),\n        )\n        return\n      }\n\n      const work = await createWork({\n        variables: {\n          input: {\n            title: formResult.output.title,\n            entitle: formResult.output.enTitle,\n            explanation: formResult.output.caption,\n            enExplanation: formResult.output.enCaption,\n            rating: inputState.ratingRestriction,\n            prompt: null,\n            negativePrompt: null,\n            seed: null,\n            sampler: null,\n            strength: null,\n            noise: null,\n            modelName: null,\n            modelHash: null,\n            otherGenerationParams: null,\n            pngInfo: null,\n            imageStyle: inputState.animationStyle,\n            relatedUrl: inputState.link,\n            tags: inputState.tags.map((tag) => tag.text),\n            isTagEditable: inputState.useTagFeature,\n            isCommentEditable: inputState.useCommentFeature,\n            thumbnailPosition: state.isThumbnailLandscape\n              ? state.thumbnailPosX\n              : state.thumbnailPosY,\n            modelId: inputState.aiModelId,\n            type: \"WORK\",\n            subjectId: inputState.themeId,\n            albumId: inputState.albumId,\n            isPromotion: inputState.usePromotionFeature,\n            reservedAt: reservedAt,\n            mainImageSha256: mainImageSha256,\n            accessType: inputState.accessType,\n            imageUrls: [thumbnailUrl],\n            smallThumbnailImageURL: smallThumbnailUrl,\n            smallThumbnailImageWidth: smallThumbnail.width,\n            smallThumbnailImageHeight: smallThumbnail.height,\n            largeThumbnailImageURL: largeThumbnailUrl,\n            largeThumbnailImageWidth: largeThumbnail.width,\n            largeThumbnailImageHeight: largeThumbnail.height,\n            videoUrl: uploadedUrl,\n            ogpImageUrl: ogpBase64Url,\n            imageHeight: mainImageSize.height,\n            imageWidth: mainImageSize.width,\n            accessGenerationType: \"PUBLIC\",\n          },\n        },\n      })\n\n      if (work.data?.createWork === undefined) {\n        toast(t(\"ä½œå“ã®æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to post the work\"))\n        return\n      }\n\n      dispatch({\n        type: \"MARK_AS_DONE\",\n        payload: {\n          uploadedWorkId: work.data?.createWork.id,\n          uploadedWorkUuid: work.data?.createWork.uuid,\n        },\n      })\n\n      toast(t(\"ä½œå“ã‚’æŠ•ç¨¿ã—ã¾ã—ãŸ\", \"Work has been posted\"))\n    } catch (error) {\n      console.error(\"å‹•ç”»æŠ•ç¨¿ã‚¨ãƒ©ãƒ¼:\", error)\n      if (error instanceof Error) {\n        toast(error.message)\n      } else {\n        toast(t(\"å‹•ç”»ã®æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to post video\"))\n      }\n      const promises = uploadedImageUrls.map((url) => {\n        return deleteUploadedImage(url)\n      })\n      await Promise.all(promises)\n      // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆã™ã‚‹å‰ã«å°‘ã—å¾…æ©Ÿã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèªã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹\n      setTimeout(() => {\n        dispatch({ type: \"SET_PROGRESS\", payload: 0 })\n      }, 3000)\n    }\n  }\n\n  const createdAt = new Date(\n    `${inputState.reservationDate}T${inputState.reservationTime}`,\n  )\n\n  // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n  useBeforeUnload(\n    // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n    React.useCallback(\n      (event) => {\n        if (state) {\n          const confirmationMessage = t(\n            \"ãƒšãƒ¼ã‚¸é·ç§»ã™ã‚‹ã¨å¤‰æ›´ãŒæ¶ˆãˆã¾ã™ãŒå•é¡Œç„¡ã„ã§ã™ã‹ï¼Ÿ\",\n            \"Changes will be lost if you navigate away. Is that okay?\",\n          )\n          event.returnValue = confirmationMessage\n          return confirmationMessage\n        }\n      },\n      [state, t],\n    ),\n  )\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <div className=\"m-auto w-full max-w-[1200px] space-y-4 pb-4\">\n      <div className=\"space-y-4\">\n        <div>\n          <PostFormHeader type=\"animation\" />\n          <PostAnimationFormUploader state={state} dispatch={dispatch} />\n        </div>\n        <PostAnimationFormInput\n          state={inputState}\n          dispatch={dispatchInput}\n          albums={viewer?.albums ?? []}\n          currentPass={viewer?.viewer?.currentPass ?? null}\n          recentlyUsedTags={viewer?.viewer?.recentlyUsedTags ?? []}\n          themes={\n            viewer?.dailyThemes\n              ? viewer.dailyThemes.map((theme) => ({\n                  date: theme.dateText,\n                  title: theme.title,\n                  id: theme.id,\n                }))\n              : null\n          }\n          aiModels={viewer?.aiModels ?? []}\n          events={viewer?.appEvents ?? []}\n          needFix={false}\n        />\n        <div className=\"h-4\" />\n        <Button\n          className=\"fixed bottom-0 left-0 z-60 ml-0 w-full rounded-none p-0 md:ml-[72px] md:pr-[72px] lg:ml-[224px] lg:pr-[224px] xl:left-auto xl:m-0 xl:max-w-[1200px] xl:pl-[8%]\"\n          size={\"lg\"}\n          type=\"submit\"\n          onClick={onPost}\n        >\n          {t(\"æŠ•ç¨¿\", \"Post\")}\n        </Button>\n      </div>\n      <SuccessCreatedWorkDialog\n        isOpen={state.progress === 100}\n        title={inputState.title}\n        description={inputState.caption}\n        imageBase64={state.thumbnailBase64}\n        workId={state.uploadedWorkId}\n        uuid={state.uploadedWorkUuid}\n        shareTags={[\"Aipictors\", \"AIã‚¤ãƒ©ã‚¹ãƒˆ\", \"AIart\"]}\n        createdAt={createdAt.getTime()}\n        accessType={inputState.accessType}\n      />\n      <CreatingWorkDialog\n        progress={state.progress}\n        isOpen={state.progress !== 0 && state.progress !== 100}\n      />\n    </div>\n  )\n}\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.NEW_ANIMATION, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const now = getJstDate(new Date())\n\n  const afterDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const result = await loaderClient.query({\n    query: ViewerQuery,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: \"-1\",\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: now.toISOString().split(\"T\")[0],\n      endDate: afterDate.toISOString().split(\"T\")[0],\n    },\n  })\n\n  return {\n    ...result.data,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  // è¨­å®šç”»é¢ãªã®ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nconst ViewerQuery = graphql(\n  `query ViewerQuery(\n    $limit: Int!,\n    $offset: Int!,\n    $ownerUserId: ID,\n    $startDate: String!,\n    $endDate: String!,\n    $startAt: String!,\n  ) {\n    viewer {\n      id\n      token\n      currentPass {\n        ...PostAnimationFormPass\n      }\n      recentlyUsedTags {\n        ...PostAnimationFormRecentlyUsedTags\n      }\n    }\n    albums(\n      offset: $offset,\n      limit: $limit,\n      where: {\n        ownerUserId: $ownerUserId,\n        needInspected: false,\n        needsThumbnailImage: false,\n      }\n    ) {\n      ...PostAnimationFormAlbum\n    }\n    aiModels(offset: 0, limit: 124, where: {}) {\n      id\n      ...PostAnimationFormAiModel\n    }\n    dailyThemes(\n      limit: 8,\n      offset: 0,\n      where: {\n        startDate: $startDate,\n        endDate: $endDate,\n      }) {\n      id\n      title\n      dateText\n    }\n    appEvents(\n      limit: 8,\n      offset: 0,\n      where: {\n        endAt: $startAt,\n      }\n    ) {\n      id\n      description\n      title\n      tag\n      slug\n      endAt\n    }\n  }`,\n  [\n    PostAnimationFormAiModelFragment,\n    PostAnimationFormAlbumFragment,\n    PostAnimationFormPassFragment,\n    PostAnimationFormRecentlyUsedTagsFragment,\n  ],\n)\n\nconst CreateWorkMutation = graphql(\n  `mutation CreateWork($input: CreateWorkInput!) {\n    createWork(input: $input) {\n      id\n      title\n      accessType\n      nanoid\n      uuid\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/ogp-dialog.tsx"},"span":[1524,1537],"sourceCode":"import { useEffect, useState } from \"react\"\nimport { ImageCropperModal } from \"~/components/modal-image-cropper\"\n\ntype Props = {\n  imageBase64: string\n  setResultImage: (image: string) => void\n  children: React.ReactNode\n}\n\nexport function OgpDialog (props: Props) {\n  const [isOpen, setIsOpen] = useState<boolean>(false)\n\n  const [cropDimensions, setCropDimensions] = useState<{\n    width: number\n    height: number\n  }>({ width: 0, height: 0 })\n\n  useEffect(() => {\n    const img = new Image()\n    img.src = props.imageBase64\n    img.onload = () => {\n      const aspectRatio = 1.91\n      const imageWidth = img.width\n      const imageHeight = img.height\n\n      let cropWidth = imageWidth\n      let cropHeight = cropWidth / aspectRatio\n\n      if (cropHeight > imageHeight) {\n        cropHeight = imageHeight\n        cropWidth = cropHeight * aspectRatio\n      }\n\n      setCropDimensions({ width: cropWidth, height: cropHeight })\n    }\n  }, [props.imageBase64])\n\n  const onClose = () => {\n    setIsOpen(false)\n  }\n\n  const onCrop = (croppedImage: string) => {\n    props.setResultImage(croppedImage)\n    onClose()\n  }\n\n  const cropperClassName = \"react-easy-crop-container\"\n\n  return (\n    <>\n      <ImageCropperModal\n        src={props.imageBase64}\n        isOpen={isOpen}\n        cropContainerClassName={cropperClassName}\n        cropWidth={cropDimensions.width}\n        cropHeight={cropDimensions.height}\n        onCrop={onCrop}\n        onClose={onClose}\n      />\n      {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n      <div\n        onClick={() => {\n          setIsOpen(true)\n          setTimeout(() => {\n            const element = document.querySelector(`.${cropperClassName}`)\n            if (element) {\n              setTimeout(() => {\n                element.classList.remove(\"mt-1\")\n              }, 100)\n              setTimeout(() => {\n                element.classList.add(\"mt-1\")\n              }, 200)\n            }\n          }, 500)\n        }}\n      >\n        {props.children}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-advertising.tsx"},"span":[1591,1794],"sourceCode":"import { Checkbox } from \"~/components/ui/checkbox\"\nimport { Link } from \"@remix-run/react\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { Button } from \"~/components/ui/button\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  isChecked?: boolean\n  onChange: (value: boolean) => void\n  isSubscribed?: boolean\n}\n\n/**\n * å®£ä¼ä½œå“ã‹ã©ã†ã‹å…¥åŠ›\n */\nexport function PostFormItemAdvertising (props: Props) {\n  const t = useTranslation()\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-2 p-4\">\n        <p className=\"font-bold text-sm\">{t(\"å®£ä¼ä½œå“\", \"Advertising Work\")}</p>\n        <div className=\"items-center text-sm opacity-65\">\n          <p>\n            {t(\n              \"åºƒå‘Šæ ã‚’ä½¿ã£ã¦è‡ªèº«ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚„ãƒ—ãƒ©ãƒ³ã‚’å®£ä¼ã§ãã¾ã™ã€‚ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ã€ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³ã®å ´åˆã€1é€±é–“ã«1ä½œå“å¯èƒ½ã§ã™ã€‚\",\n              \"You can promote your service or plan using the ad space. For Standard and Premium plans, one work can be promoted per week.\",\n            )}\n          </p>\n          <p>\n            {t(\n              \"åºƒå‘Šæ ä»¥å¤–ã®å®£ä¼ã¯è¦ç´„é•åã¨ãªã‚Šã¾ã™ã€‚\",\n              \"Promotions outside of ad space are against the terms.\",\n            )}\n          </p>\n          <p>\n            {t(\n              \"ä¸€åº¦è¨­å®šã—ãŸåºƒå‘Šæ ã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚\",\n              \"Once set, the ad space cannot be canceled.\",\n            )}\n          </p>\n        </div>\n        {props.isSubscribed ? (\n          <div className=\"items-center space-x-2\">\n            <Checkbox\n              onCheckedChange={(value: boolean) => {\n                props.onChange(value)\n              }}\n              id=\"ad-editable\"\n              checked={props.isChecked}\n            />\n            <label className=\"text-sm\" htmlFor=\"ad-editable\">\n              {t(\"å®£ä¼ä½œå“ã«è¨­å®šã™ã‚‹\", \"Set as Advertising Work\")}\n            </label>\n          </div>\n        ) : (\n          <Link target=\"_blank\" to=\"/plus\" className=\"block\">\n            <Button variant={\"secondary\"} className=\"w-full\">\n              {t(\n                \"æ¨è–¦æ©Ÿèƒ½ãªã©ç‰¹å…¸ã‚’å¾—ã‚Œã‚‹Aipictors+ã¯ã“ã¡ã‚‰\",\n                \"Get Aipictors+ for promotional features and more\",\n              )}\n            </Button>\n          </Link>\n        )}\n      </CardContent>\n    </Card>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images-and-video.tsx"},"span":[8973,8986],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { VideoItem } from \"~/routes/($lang)._main.new.image/components/video-item\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport {\n  MAX_IMAGE_FILE_SIZE_BYTES,\n  MAX_VIDEO_FILE_SIZE_BYTES,\n  formatFileSize,\n} from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  videoFile: File | null\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onVideoChange(videoFile: File | null): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImagesAndVideo (props: Props) {\n  const t = useTranslation()\n\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(MAX_IMAGE_FILE_SIZE_BYTES)\n  const videoSizeLabel = formatFileSize(MAX_VIDEO_FILE_SIZE_BYTES)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    // é•ã„ãŒã‚ã£ãŸã‚‰ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n      \"video/mp4\": [\".mp4\", \".MP4\", \".Mp4\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Up to ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (file.type === \"video/mp4\") {\n          if (file.size > MAX_VIDEO_FILE_SIZE_BYTES) {\n            toast(\n              t(\n                `å‹•ç”»ã®ã‚µã‚¤ã‚ºã¯${videoSizeLabel}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„`,\n                `Video size should be under ${videoSizeLabel}`,\n              ),\n            )\n            return\n          }\n          const video = document.createElement(\"video\")\n\n          video.src = URL.createObjectURL(file)\n          video.onloadedmetadata = () => {\n            if (video.duration > 12) {\n              toast(\n                t(\n                  \"å‹•ç”»ã¯12ç§’ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„\",\n                  \"Video length should be under 12 seconds\",\n                ),\n              )\n              return\n            }\n\n            props.onVideoChange(file)\n\n            props.setItems([])\n            props.onChangeItems([])\n\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = video.videoWidth\n            canvas.height = video.videoHeight\n            const ctx = canvas.getContext(\"2d\")\n\n            const time = video.duration / 2\n            video.currentTime = time\n            video.onseeked = () => {\n              ctx?.drawImage(video, 0, 0, canvas.width, canvas.height)\n              const thumbnailUrl = canvas.toDataURL()\n\n              updateThumbnail(thumbnailUrl)\n            }\n          }\n        } else {\n          if (\n            props.maxItemsCount &&\n            props.maxItemsCount < props.items.length + 1\n          ) {\n            toast(\n              t(\n                `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n                `Up to ${props.maxItemsCount} items allowed`,\n              ),\n            )\n            return\n          }\n\n          props.onVideoChange(null)\n\n          if (props.items.length === 0 && file.type === \"image/png\") {\n            const pngInfo = await getExtractInfoFromPNG(file)\n            if (props.onChangePngInfo) {\n              props.onChangePngInfo(pngInfo)\n            }\n          }\n\n          const reader = new FileReader()\n          reader.onload = (event) => {\n            if (event.target) {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = event.target.result as string\n            }\n          }\n          reader.readAsDataURL(file)\n        }\n      })\n\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n            </div>\n          </>\n        )}\n        {props.videoFile && (\n          <VideoItem\n            videoFile={props.videoFile}\n            onDelete={() => {\n              if (!props.isOnlyMove) {\n                props.onVideoChange(null)\n                props.onChangeItems([])\n                if (props.onChangeIndexList) {\n                  props.onChangeIndexList([])\n                }\n              }\n            }}\n          />\n        )}\n\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col text-white\">\n            <p className=\"text-center text-sm\">\n              {t(\n                \"JPEGã€PNGã€GIFã€WEBPã€BMPã€MP4\",\n                \"JPEG, PNG, GIF, WEBP, BMP, MP4\",\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æšã€å‹•ç”»ã¯${videoSizeLabel}ã€12ç§’ã¾ã§`,\n                `Max ${maxSizeLabel} per file, up to 200 files, videos under ${videoSizeLabel} and 12 seconds`,\n              )}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images-and-video.tsx"},"span":[10828,10841],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { VideoItem } from \"~/routes/($lang)._main.new.image/components/video-item\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport {\n  MAX_IMAGE_FILE_SIZE_BYTES,\n  MAX_VIDEO_FILE_SIZE_BYTES,\n  formatFileSize,\n} from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  videoFile: File | null\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onVideoChange(videoFile: File | null): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImagesAndVideo (props: Props) {\n  const t = useTranslation()\n\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(MAX_IMAGE_FILE_SIZE_BYTES)\n  const videoSizeLabel = formatFileSize(MAX_VIDEO_FILE_SIZE_BYTES)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    // é•ã„ãŒã‚ã£ãŸã‚‰ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n      \"video/mp4\": [\".mp4\", \".MP4\", \".Mp4\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Up to ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (file.type === \"video/mp4\") {\n          if (file.size > MAX_VIDEO_FILE_SIZE_BYTES) {\n            toast(\n              t(\n                `å‹•ç”»ã®ã‚µã‚¤ã‚ºã¯${videoSizeLabel}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„`,\n                `Video size should be under ${videoSizeLabel}`,\n              ),\n            )\n            return\n          }\n          const video = document.createElement(\"video\")\n\n          video.src = URL.createObjectURL(file)\n          video.onloadedmetadata = () => {\n            if (video.duration > 12) {\n              toast(\n                t(\n                  \"å‹•ç”»ã¯12ç§’ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„\",\n                  \"Video length should be under 12 seconds\",\n                ),\n              )\n              return\n            }\n\n            props.onVideoChange(file)\n\n            props.setItems([])\n            props.onChangeItems([])\n\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = video.videoWidth\n            canvas.height = video.videoHeight\n            const ctx = canvas.getContext(\"2d\")\n\n            const time = video.duration / 2\n            video.currentTime = time\n            video.onseeked = () => {\n              ctx?.drawImage(video, 0, 0, canvas.width, canvas.height)\n              const thumbnailUrl = canvas.toDataURL()\n\n              updateThumbnail(thumbnailUrl)\n            }\n          }\n        } else {\n          if (\n            props.maxItemsCount &&\n            props.maxItemsCount < props.items.length + 1\n          ) {\n            toast(\n              t(\n                `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n                `Up to ${props.maxItemsCount} items allowed`,\n              ),\n            )\n            return\n          }\n\n          props.onVideoChange(null)\n\n          if (props.items.length === 0 && file.type === \"image/png\") {\n            const pngInfo = await getExtractInfoFromPNG(file)\n            if (props.onChangePngInfo) {\n              props.onChangePngInfo(pngInfo)\n            }\n          }\n\n          const reader = new FileReader()\n          reader.onload = (event) => {\n            if (event.target) {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = event.target.result as string\n            }\n          }\n          reader.readAsDataURL(file)\n        }\n      })\n\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n            </div>\n          </>\n        )}\n        {props.videoFile && (\n          <VideoItem\n            videoFile={props.videoFile}\n            onDelete={() => {\n              if (!props.isOnlyMove) {\n                props.onVideoChange(null)\n                props.onChangeItems([])\n                if (props.onChangeIndexList) {\n                  props.onChangeIndexList([])\n                }\n              }\n            }}\n          />\n        )}\n\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col text-white\">\n            <p className=\"text-center text-sm\">\n              {t(\n                \"JPEGã€PNGã€GIFã€WEBPã€BMPã€MP4\",\n                \"JPEG, PNG, GIF, WEBP, BMP, MP4\",\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æšã€å‹•ç”»ã¯${videoSizeLabel}ã€12ç§’ã¾ã§`,\n                `Max ${maxSizeLabel} per file, up to 200 files, videos under ${videoSizeLabel} and 12 seconds`,\n              )}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images-and-video.tsx"},"span":[4746,4802],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { VideoItem } from \"~/routes/($lang)._main.new.image/components/video-item\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport {\n  MAX_IMAGE_FILE_SIZE_BYTES,\n  MAX_VIDEO_FILE_SIZE_BYTES,\n  formatFileSize,\n} from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  videoFile: File | null\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onVideoChange(videoFile: File | null): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImagesAndVideo (props: Props) {\n  const t = useTranslation()\n\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(MAX_IMAGE_FILE_SIZE_BYTES)\n  const videoSizeLabel = formatFileSize(MAX_VIDEO_FILE_SIZE_BYTES)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    // é•ã„ãŒã‚ã£ãŸã‚‰ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n      \"video/mp4\": [\".mp4\", \".MP4\", \".Mp4\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Up to ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (file.type === \"video/mp4\") {\n          if (file.size > MAX_VIDEO_FILE_SIZE_BYTES) {\n            toast(\n              t(\n                `å‹•ç”»ã®ã‚µã‚¤ã‚ºã¯${videoSizeLabel}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„`,\n                `Video size should be under ${videoSizeLabel}`,\n              ),\n            )\n            return\n          }\n          const video = document.createElement(\"video\")\n\n          video.src = URL.createObjectURL(file)\n          video.onloadedmetadata = () => {\n            if (video.duration > 12) {\n              toast(\n                t(\n                  \"å‹•ç”»ã¯12ç§’ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„\",\n                  \"Video length should be under 12 seconds\",\n                ),\n              )\n              return\n            }\n\n            props.onVideoChange(file)\n\n            props.setItems([])\n            props.onChangeItems([])\n\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = video.videoWidth\n            canvas.height = video.videoHeight\n            const ctx = canvas.getContext(\"2d\")\n\n            const time = video.duration / 2\n            video.currentTime = time\n            video.onseeked = () => {\n              ctx?.drawImage(video, 0, 0, canvas.width, canvas.height)\n              const thumbnailUrl = canvas.toDataURL()\n\n              updateThumbnail(thumbnailUrl)\n            }\n          }\n        } else {\n          if (\n            props.maxItemsCount &&\n            props.maxItemsCount < props.items.length + 1\n          ) {\n            toast(\n              t(\n                `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n                `Up to ${props.maxItemsCount} items allowed`,\n              ),\n            )\n            return\n          }\n\n          props.onVideoChange(null)\n\n          if (props.items.length === 0 && file.type === \"image/png\") {\n            const pngInfo = await getExtractInfoFromPNG(file)\n            if (props.onChangePngInfo) {\n              props.onChangePngInfo(pngInfo)\n            }\n          }\n\n          const reader = new FileReader()\n          reader.onload = (event) => {\n            if (event.target) {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = event.target.result as string\n            }\n          }\n          reader.readAsDataURL(file)\n        }\n      })\n\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n            </div>\n          </>\n        )}\n        {props.videoFile && (\n          <VideoItem\n            videoFile={props.videoFile}\n            onDelete={() => {\n              if (!props.isOnlyMove) {\n                props.onVideoChange(null)\n                props.onChangeItems([])\n                if (props.onChangeIndexList) {\n                  props.onChangeIndexList([])\n                }\n              }\n            }}\n          />\n        )}\n\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col text-white\">\n            <p className=\"text-center text-sm\">\n              {t(\n                \"JPEGã€PNGã€GIFã€WEBPã€BMPã€MP4\",\n                \"JPEG, PNG, GIF, WEBP, BMP, MP4\",\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æšã€å‹•ç”»ã¯${videoSizeLabel}ã€12ç§’ã¾ã§`,\n                `Max ${maxSizeLabel} per file, up to 200 files, videos under ${videoSizeLabel} and 12 seconds`,\n              )}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images-and-video.tsx"},"span":[7922,7978],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { VideoItem } from \"~/routes/($lang)._main.new.image/components/video-item\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport {\n  MAX_IMAGE_FILE_SIZE_BYTES,\n  MAX_VIDEO_FILE_SIZE_BYTES,\n  formatFileSize,\n} from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  videoFile: File | null\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onVideoChange(videoFile: File | null): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImagesAndVideo (props: Props) {\n  const t = useTranslation()\n\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(MAX_IMAGE_FILE_SIZE_BYTES)\n  const videoSizeLabel = formatFileSize(MAX_VIDEO_FILE_SIZE_BYTES)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    // é•ã„ãŒã‚ã£ãŸã‚‰ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n      \"video/mp4\": [\".mp4\", \".MP4\", \".Mp4\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Up to ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (file.type === \"video/mp4\") {\n          if (file.size > MAX_VIDEO_FILE_SIZE_BYTES) {\n            toast(\n              t(\n                `å‹•ç”»ã®ã‚µã‚¤ã‚ºã¯${videoSizeLabel}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„`,\n                `Video size should be under ${videoSizeLabel}`,\n              ),\n            )\n            return\n          }\n          const video = document.createElement(\"video\")\n\n          video.src = URL.createObjectURL(file)\n          video.onloadedmetadata = () => {\n            if (video.duration > 12) {\n              toast(\n                t(\n                  \"å‹•ç”»ã¯12ç§’ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„\",\n                  \"Video length should be under 12 seconds\",\n                ),\n              )\n              return\n            }\n\n            props.onVideoChange(file)\n\n            props.setItems([])\n            props.onChangeItems([])\n\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = video.videoWidth\n            canvas.height = video.videoHeight\n            const ctx = canvas.getContext(\"2d\")\n\n            const time = video.duration / 2\n            video.currentTime = time\n            video.onseeked = () => {\n              ctx?.drawImage(video, 0, 0, canvas.width, canvas.height)\n              const thumbnailUrl = canvas.toDataURL()\n\n              updateThumbnail(thumbnailUrl)\n            }\n          }\n        } else {\n          if (\n            props.maxItemsCount &&\n            props.maxItemsCount < props.items.length + 1\n          ) {\n            toast(\n              t(\n                `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n                `Up to ${props.maxItemsCount} items allowed`,\n              ),\n            )\n            return\n          }\n\n          props.onVideoChange(null)\n\n          if (props.items.length === 0 && file.type === \"image/png\") {\n            const pngInfo = await getExtractInfoFromPNG(file)\n            if (props.onChangePngInfo) {\n              props.onChangePngInfo(pngInfo)\n            }\n          }\n\n          const reader = new FileReader()\n          reader.onload = (event) => {\n            if (event.target) {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = event.target.result as string\n            }\n          }\n          reader.readAsDataURL(file)\n        }\n      })\n\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n            </div>\n          </>\n        )}\n        {props.videoFile && (\n          <VideoItem\n            videoFile={props.videoFile}\n            onDelete={() => {\n              if (!props.isOnlyMove) {\n                props.onVideoChange(null)\n                props.onChangeItems([])\n                if (props.onChangeIndexList) {\n                  props.onChangeIndexList([])\n                }\n              }\n            }}\n          />\n        )}\n\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col text-white\">\n            <p className=\"text-center text-sm\">\n              {t(\n                \"JPEGã€PNGã€GIFã€WEBPã€BMPã€MP4\",\n                \"JPEG, PNG, GIF, WEBP, BMP, MP4\",\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æšã€å‹•ç”»ã¯${videoSizeLabel}ã€12ç§’ã¾ã§`,\n                `Max ${maxSizeLabel} per file, up to 200 files, videos under ${videoSizeLabel} and 12 seconds`,\n              )}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images-and-video.tsx"},"span":[8117,8173],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { VideoItem } from \"~/routes/($lang)._main.new.image/components/video-item\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport {\n  MAX_IMAGE_FILE_SIZE_BYTES,\n  MAX_VIDEO_FILE_SIZE_BYTES,\n  formatFileSize,\n} from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  videoFile: File | null\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onVideoChange(videoFile: File | null): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImagesAndVideo (props: Props) {\n  const t = useTranslation()\n\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(MAX_IMAGE_FILE_SIZE_BYTES)\n  const videoSizeLabel = formatFileSize(MAX_VIDEO_FILE_SIZE_BYTES)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    // é•ã„ãŒã‚ã£ãŸã‚‰ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n      \"video/mp4\": [\".mp4\", \".MP4\", \".Mp4\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Up to ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (file.type === \"video/mp4\") {\n          if (file.size > MAX_VIDEO_FILE_SIZE_BYTES) {\n            toast(\n              t(\n                `å‹•ç”»ã®ã‚µã‚¤ã‚ºã¯${videoSizeLabel}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„`,\n                `Video size should be under ${videoSizeLabel}`,\n              ),\n            )\n            return\n          }\n          const video = document.createElement(\"video\")\n\n          video.src = URL.createObjectURL(file)\n          video.onloadedmetadata = () => {\n            if (video.duration > 12) {\n              toast(\n                t(\n                  \"å‹•ç”»ã¯12ç§’ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„\",\n                  \"Video length should be under 12 seconds\",\n                ),\n              )\n              return\n            }\n\n            props.onVideoChange(file)\n\n            props.setItems([])\n            props.onChangeItems([])\n\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = video.videoWidth\n            canvas.height = video.videoHeight\n            const ctx = canvas.getContext(\"2d\")\n\n            const time = video.duration / 2\n            video.currentTime = time\n            video.onseeked = () => {\n              ctx?.drawImage(video, 0, 0, canvas.width, canvas.height)\n              const thumbnailUrl = canvas.toDataURL()\n\n              updateThumbnail(thumbnailUrl)\n            }\n          }\n        } else {\n          if (\n            props.maxItemsCount &&\n            props.maxItemsCount < props.items.length + 1\n          ) {\n            toast(\n              t(\n                `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n                `Up to ${props.maxItemsCount} items allowed`,\n              ),\n            )\n            return\n          }\n\n          props.onVideoChange(null)\n\n          if (props.items.length === 0 && file.type === \"image/png\") {\n            const pngInfo = await getExtractInfoFromPNG(file)\n            if (props.onChangePngInfo) {\n              props.onChangePngInfo(pngInfo)\n            }\n          }\n\n          const reader = new FileReader()\n          reader.onload = (event) => {\n            if (event.target) {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = event.target.result as string\n            }\n          }\n          reader.readAsDataURL(file)\n        }\n      })\n\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n            </div>\n          </>\n        )}\n        {props.videoFile && (\n          <VideoItem\n            videoFile={props.videoFile}\n            onDelete={() => {\n              if (!props.isOnlyMove) {\n                props.onVideoChange(null)\n                props.onChangeItems([])\n                if (props.onChangeIndexList) {\n                  props.onChangeIndexList([])\n                }\n              }\n            }}\n          />\n        )}\n\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col text-white\">\n            <p className=\"text-center text-sm\">\n              {t(\n                \"JPEGã€PNGã€GIFã€WEBPã€BMPã€MP4\",\n                \"JPEG, PNG, GIF, WEBP, BMP, MP4\",\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æšã€å‹•ç”»ã¯${videoSizeLabel}ã€12ç§’ã¾ã§`,\n                `Max ${maxSizeLabel} per file, up to 200 files, videos under ${videoSizeLabel} and 12 seconds`,\n              )}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images-and-video.tsx"},"span":[8785,8833],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { VideoItem } from \"~/routes/($lang)._main.new.image/components/video-item\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport {\n  MAX_IMAGE_FILE_SIZE_BYTES,\n  MAX_VIDEO_FILE_SIZE_BYTES,\n  formatFileSize,\n} from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  videoFile: File | null\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onVideoChange(videoFile: File | null): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImagesAndVideo (props: Props) {\n  const t = useTranslation()\n\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(MAX_IMAGE_FILE_SIZE_BYTES)\n  const videoSizeLabel = formatFileSize(MAX_VIDEO_FILE_SIZE_BYTES)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    // é•ã„ãŒã‚ã£ãŸã‚‰ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n      \"video/mp4\": [\".mp4\", \".MP4\", \".Mp4\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Up to ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (file.type === \"video/mp4\") {\n          if (file.size > MAX_VIDEO_FILE_SIZE_BYTES) {\n            toast(\n              t(\n                `å‹•ç”»ã®ã‚µã‚¤ã‚ºã¯${videoSizeLabel}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„`,\n                `Video size should be under ${videoSizeLabel}`,\n              ),\n            )\n            return\n          }\n          const video = document.createElement(\"video\")\n\n          video.src = URL.createObjectURL(file)\n          video.onloadedmetadata = () => {\n            if (video.duration > 12) {\n              toast(\n                t(\n                  \"å‹•ç”»ã¯12ç§’ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„\",\n                  \"Video length should be under 12 seconds\",\n                ),\n              )\n              return\n            }\n\n            props.onVideoChange(file)\n\n            props.setItems([])\n            props.onChangeItems([])\n\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = video.videoWidth\n            canvas.height = video.videoHeight\n            const ctx = canvas.getContext(\"2d\")\n\n            const time = video.duration / 2\n            video.currentTime = time\n            video.onseeked = () => {\n              ctx?.drawImage(video, 0, 0, canvas.width, canvas.height)\n              const thumbnailUrl = canvas.toDataURL()\n\n              updateThumbnail(thumbnailUrl)\n            }\n          }\n        } else {\n          if (\n            props.maxItemsCount &&\n            props.maxItemsCount < props.items.length + 1\n          ) {\n            toast(\n              t(\n                `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n                `Up to ${props.maxItemsCount} items allowed`,\n              ),\n            )\n            return\n          }\n\n          props.onVideoChange(null)\n\n          if (props.items.length === 0 && file.type === \"image/png\") {\n            const pngInfo = await getExtractInfoFromPNG(file)\n            if (props.onChangePngInfo) {\n              props.onChangePngInfo(pngInfo)\n            }\n          }\n\n          const reader = new FileReader()\n          reader.onload = (event) => {\n            if (event.target) {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = event.target.result as string\n            }\n          }\n          reader.readAsDataURL(file)\n        }\n      })\n\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n            </div>\n          </>\n        )}\n        {props.videoFile && (\n          <VideoItem\n            videoFile={props.videoFile}\n            onDelete={() => {\n              if (!props.isOnlyMove) {\n                props.onVideoChange(null)\n                props.onChangeItems([])\n                if (props.onChangeIndexList) {\n                  props.onChangeIndexList([])\n                }\n              }\n            }}\n          />\n        )}\n\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col text-white\">\n            <p className=\"text-center text-sm\">\n              {t(\n                \"JPEGã€PNGã€GIFã€WEBPã€BMPã€MP4\",\n                \"JPEG, PNG, GIF, WEBP, BMP, MP4\",\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æšã€å‹•ç”»ã¯${videoSizeLabel}ã€12ç§’ã¾ã§`,\n                `Max ${maxSizeLabel} per file, up to 200 files, videos under ${videoSizeLabel} and 12 seconds`,\n              )}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images-and-video.tsx"},"span":[4789,4802],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { VideoItem } from \"~/routes/($lang)._main.new.image/components/video-item\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport {\n  MAX_IMAGE_FILE_SIZE_BYTES,\n  MAX_VIDEO_FILE_SIZE_BYTES,\n  formatFileSize,\n} from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  videoFile: File | null\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onVideoChange(videoFile: File | null): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImagesAndVideo (props: Props) {\n  const t = useTranslation()\n\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(MAX_IMAGE_FILE_SIZE_BYTES)\n  const videoSizeLabel = formatFileSize(MAX_VIDEO_FILE_SIZE_BYTES)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    // é•ã„ãŒã‚ã£ãŸã‚‰ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n      \"video/mp4\": [\".mp4\", \".MP4\", \".Mp4\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Up to ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (file.type === \"video/mp4\") {\n          if (file.size > MAX_VIDEO_FILE_SIZE_BYTES) {\n            toast(\n              t(\n                `å‹•ç”»ã®ã‚µã‚¤ã‚ºã¯${videoSizeLabel}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„`,\n                `Video size should be under ${videoSizeLabel}`,\n              ),\n            )\n            return\n          }\n          const video = document.createElement(\"video\")\n\n          video.src = URL.createObjectURL(file)\n          video.onloadedmetadata = () => {\n            if (video.duration > 12) {\n              toast(\n                t(\n                  \"å‹•ç”»ã¯12ç§’ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„\",\n                  \"Video length should be under 12 seconds\",\n                ),\n              )\n              return\n            }\n\n            props.onVideoChange(file)\n\n            props.setItems([])\n            props.onChangeItems([])\n\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = video.videoWidth\n            canvas.height = video.videoHeight\n            const ctx = canvas.getContext(\"2d\")\n\n            const time = video.duration / 2\n            video.currentTime = time\n            video.onseeked = () => {\n              ctx?.drawImage(video, 0, 0, canvas.width, canvas.height)\n              const thumbnailUrl = canvas.toDataURL()\n\n              updateThumbnail(thumbnailUrl)\n            }\n          }\n        } else {\n          if (\n            props.maxItemsCount &&\n            props.maxItemsCount < props.items.length + 1\n          ) {\n            toast(\n              t(\n                `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n                `Up to ${props.maxItemsCount} items allowed`,\n              ),\n            )\n            return\n          }\n\n          props.onVideoChange(null)\n\n          if (props.items.length === 0 && file.type === \"image/png\") {\n            const pngInfo = await getExtractInfoFromPNG(file)\n            if (props.onChangePngInfo) {\n              props.onChangePngInfo(pngInfo)\n            }\n          }\n\n          const reader = new FileReader()\n          reader.onload = (event) => {\n            if (event.target) {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = event.target.result as string\n            }\n          }\n          reader.readAsDataURL(file)\n        }\n      })\n\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n            </div>\n          </>\n        )}\n        {props.videoFile && (\n          <VideoItem\n            videoFile={props.videoFile}\n            onDelete={() => {\n              if (!props.isOnlyMove) {\n                props.onVideoChange(null)\n                props.onChangeItems([])\n                if (props.onChangeIndexList) {\n                  props.onChangeIndexList([])\n                }\n              }\n            }}\n          />\n        )}\n\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col text-white\">\n            <p className=\"text-center text-sm\">\n              {t(\n                \"JPEGã€PNGã€GIFã€WEBPã€BMPã€MP4\",\n                \"JPEG, PNG, GIF, WEBP, BMP, MP4\",\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æšã€å‹•ç”»ã¯${videoSizeLabel}ã€12ç§’ã¾ã§`,\n                `Max ${maxSizeLabel} per file, up to 200 files, videos under ${videoSizeLabel} and 12 seconds`,\n              )}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images-and-video.tsx"},"span":[7965,7978],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { VideoItem } from \"~/routes/($lang)._main.new.image/components/video-item\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport {\n  MAX_IMAGE_FILE_SIZE_BYTES,\n  MAX_VIDEO_FILE_SIZE_BYTES,\n  formatFileSize,\n} from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  videoFile: File | null\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onVideoChange(videoFile: File | null): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImagesAndVideo (props: Props) {\n  const t = useTranslation()\n\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(MAX_IMAGE_FILE_SIZE_BYTES)\n  const videoSizeLabel = formatFileSize(MAX_VIDEO_FILE_SIZE_BYTES)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    // é•ã„ãŒã‚ã£ãŸã‚‰ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n      \"video/mp4\": [\".mp4\", \".MP4\", \".Mp4\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Up to ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (file.type === \"video/mp4\") {\n          if (file.size > MAX_VIDEO_FILE_SIZE_BYTES) {\n            toast(\n              t(\n                `å‹•ç”»ã®ã‚µã‚¤ã‚ºã¯${videoSizeLabel}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„`,\n                `Video size should be under ${videoSizeLabel}`,\n              ),\n            )\n            return\n          }\n          const video = document.createElement(\"video\")\n\n          video.src = URL.createObjectURL(file)\n          video.onloadedmetadata = () => {\n            if (video.duration > 12) {\n              toast(\n                t(\n                  \"å‹•ç”»ã¯12ç§’ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„\",\n                  \"Video length should be under 12 seconds\",\n                ),\n              )\n              return\n            }\n\n            props.onVideoChange(file)\n\n            props.setItems([])\n            props.onChangeItems([])\n\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = video.videoWidth\n            canvas.height = video.videoHeight\n            const ctx = canvas.getContext(\"2d\")\n\n            const time = video.duration / 2\n            video.currentTime = time\n            video.onseeked = () => {\n              ctx?.drawImage(video, 0, 0, canvas.width, canvas.height)\n              const thumbnailUrl = canvas.toDataURL()\n\n              updateThumbnail(thumbnailUrl)\n            }\n          }\n        } else {\n          if (\n            props.maxItemsCount &&\n            props.maxItemsCount < props.items.length + 1\n          ) {\n            toast(\n              t(\n                `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n                `Up to ${props.maxItemsCount} items allowed`,\n              ),\n            )\n            return\n          }\n\n          props.onVideoChange(null)\n\n          if (props.items.length === 0 && file.type === \"image/png\") {\n            const pngInfo = await getExtractInfoFromPNG(file)\n            if (props.onChangePngInfo) {\n              props.onChangePngInfo(pngInfo)\n            }\n          }\n\n          const reader = new FileReader()\n          reader.onload = (event) => {\n            if (event.target) {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = event.target.result as string\n            }\n          }\n          reader.readAsDataURL(file)\n        }\n      })\n\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n            </div>\n          </>\n        )}\n        {props.videoFile && (\n          <VideoItem\n            videoFile={props.videoFile}\n            onDelete={() => {\n              if (!props.isOnlyMove) {\n                props.onVideoChange(null)\n                props.onChangeItems([])\n                if (props.onChangeIndexList) {\n                  props.onChangeIndexList([])\n                }\n              }\n            }}\n          />\n        )}\n\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col text-white\">\n            <p className=\"text-center text-sm\">\n              {t(\n                \"JPEGã€PNGã€GIFã€WEBPã€BMPã€MP4\",\n                \"JPEG, PNG, GIF, WEBP, BMP, MP4\",\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æšã€å‹•ç”»ã¯${videoSizeLabel}ã€12ç§’ã¾ã§`,\n                `Max ${maxSizeLabel} per file, up to 200 files, videos under ${videoSizeLabel} and 12 seconds`,\n              )}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images-and-video.tsx"},"span":[8160,8173],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { VideoItem } from \"~/routes/($lang)._main.new.image/components/video-item\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport {\n  MAX_IMAGE_FILE_SIZE_BYTES,\n  MAX_VIDEO_FILE_SIZE_BYTES,\n  formatFileSize,\n} from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  videoFile: File | null\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onVideoChange(videoFile: File | null): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImagesAndVideo (props: Props) {\n  const t = useTranslation()\n\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(MAX_IMAGE_FILE_SIZE_BYTES)\n  const videoSizeLabel = formatFileSize(MAX_VIDEO_FILE_SIZE_BYTES)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    // é•ã„ãŒã‚ã£ãŸã‚‰ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n      \"video/mp4\": [\".mp4\", \".MP4\", \".Mp4\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Up to ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (file.type === \"video/mp4\") {\n          if (file.size > MAX_VIDEO_FILE_SIZE_BYTES) {\n            toast(\n              t(\n                `å‹•ç”»ã®ã‚µã‚¤ã‚ºã¯${videoSizeLabel}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„`,\n                `Video size should be under ${videoSizeLabel}`,\n              ),\n            )\n            return\n          }\n          const video = document.createElement(\"video\")\n\n          video.src = URL.createObjectURL(file)\n          video.onloadedmetadata = () => {\n            if (video.duration > 12) {\n              toast(\n                t(\n                  \"å‹•ç”»ã¯12ç§’ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„\",\n                  \"Video length should be under 12 seconds\",\n                ),\n              )\n              return\n            }\n\n            props.onVideoChange(file)\n\n            props.setItems([])\n            props.onChangeItems([])\n\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = video.videoWidth\n            canvas.height = video.videoHeight\n            const ctx = canvas.getContext(\"2d\")\n\n            const time = video.duration / 2\n            video.currentTime = time\n            video.onseeked = () => {\n              ctx?.drawImage(video, 0, 0, canvas.width, canvas.height)\n              const thumbnailUrl = canvas.toDataURL()\n\n              updateThumbnail(thumbnailUrl)\n            }\n          }\n        } else {\n          if (\n            props.maxItemsCount &&\n            props.maxItemsCount < props.items.length + 1\n          ) {\n            toast(\n              t(\n                `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n                `Up to ${props.maxItemsCount} items allowed`,\n              ),\n            )\n            return\n          }\n\n          props.onVideoChange(null)\n\n          if (props.items.length === 0 && file.type === \"image/png\") {\n            const pngInfo = await getExtractInfoFromPNG(file)\n            if (props.onChangePngInfo) {\n              props.onChangePngInfo(pngInfo)\n            }\n          }\n\n          const reader = new FileReader()\n          reader.onload = (event) => {\n            if (event.target) {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = event.target.result as string\n            }\n          }\n          reader.readAsDataURL(file)\n        }\n      })\n\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n            </div>\n          </>\n        )}\n        {props.videoFile && (\n          <VideoItem\n            videoFile={props.videoFile}\n            onDelete={() => {\n              if (!props.isOnlyMove) {\n                props.onVideoChange(null)\n                props.onChangeItems([])\n                if (props.onChangeIndexList) {\n                  props.onChangeIndexList([])\n                }\n              }\n            }}\n          />\n        )}\n\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col text-white\">\n            <p className=\"text-center text-sm\">\n              {t(\n                \"JPEGã€PNGã€GIFã€WEBPã€BMPã€MP4\",\n                \"JPEG, PNG, GIF, WEBP, BMP, MP4\",\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æšã€å‹•ç”»ã¯${videoSizeLabel}ã€12ç§’ã¾ã§`,\n                `Max ${maxSizeLabel} per file, up to 200 files, videos under ${videoSizeLabel} and 12 seconds`,\n              )}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images.tsx"},"span":[6163,6176],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { MAX_IMAGE_FILE_SIZE_BYTES, formatFileSize } from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n  onInputFiles?: (files: FileList) => void\n  submitText?: string\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImages (props: Props) {\n  const t = useTranslation()\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(maxSize)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰ç”»åƒè²¼ã‚Šä»˜ã‘ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹\n   */\n  useEffect(() => {\n    const handlePaste = async (event: ClipboardEvent) => {\n      const activeElement = document.activeElement\n      if (\n        activeElement &&\n        (activeElement.tagName === \"INPUT\" ||\n          activeElement.tagName === \"TEXTAREA\")\n      ) {\n        return\n      }\n\n      if (props.isOnlyMove) return\n\n      const items = event.clipboardData?.items\n      if (!items) return\n\n      for (const item of items) {\n        if (item.type.startsWith(\"image\")) {\n          const file = item.getAsFile()\n          if (file && file.size <= maxSize) {\n            const reader = new FileReader()\n            reader.onload = (e) => {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = e.target?.result as string\n            }\n            reader.readAsDataURL(file)\n            toast(\"ç”»åƒã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã¾ã—ãŸ\")\n          } else {\n            toast(\n              t(\n                `${maxSizeLabel}ä»¥å†…ã®ç”»åƒã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„`,\n                `Please paste an image under ${maxSizeLabel}`,\n              ),\n            )\n          }\n        }\n      }\n    }\n\n    document.addEventListener(\"paste\", handlePaste)\n    return () => {\n      document.removeEventListener(\"paste\", handlePaste)\n    }\n  }, [])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Maximum ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (\n          props.maxItemsCount &&\n          props.maxItemsCount < props.items.length + 1\n        ) {\n          toast(\n            t(\n              `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n              `Maximum ${props.maxItemsCount} items allowed`,\n            ),\n          )\n          return\n        }\n\n        if (props.items.length === 0 && file.type === \"image/png\") {\n          const pngInfo = await getExtractInfoFromPNG(file)\n          if (props.onChangePngInfo) {\n            props.onChangePngInfo(pngInfo)\n          }\n        }\n\n        const reader = new FileReader()\n        reader.onload = (event) => {\n          if (event.target) {\n            const img = new Image()\n            img.onload = () => {\n              const canvas = document.createElement(\"canvas\")\n              canvas.width = img.width\n              canvas.height = img.height\n              const ctx = canvas.getContext(\"2d\")\n              ctx?.drawImage(img, 0, 0)\n              const webpDataURL = canvas.toDataURL(\"image/webp\")\n              props.items.push({\n                id: props.items.length,\n                content: webpDataURL,\n              })\n              props.onChangeItems([...props.items])\n              updateThumbnail()\n            }\n            img.src = event.target.result as string\n          }\n        }\n        reader.readAsDataURL(file)\n      })\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n\n        if (props.onInputFiles) {\n          props.onInputFiles(inputElement.files)\n        }\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n          props.items.length ? \"\" : \"rounded-b\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              {props.submitText ? (\n                <p className=\"font-bold\">{props.submitText}</p>\n              ) : (\n                <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n              )}\n            </div>\n          </>\n        )}\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            props.items.length !== props.maxItemsCount &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col rounded-b text-white\">\n            <p className=\"text-center text-sm\">{\"JPEGã€PNGã€GIFã€WEBPã€BMP\"}</p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æš`,\n                `Up to ${maxSizeLabel} per image, max 200 images`,\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {\"ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã‚‚å¯èƒ½\"}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images.tsx"},"span":[7811,7824],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { MAX_IMAGE_FILE_SIZE_BYTES, formatFileSize } from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n  onInputFiles?: (files: FileList) => void\n  submitText?: string\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImages (props: Props) {\n  const t = useTranslation()\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(maxSize)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰ç”»åƒè²¼ã‚Šä»˜ã‘ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹\n   */\n  useEffect(() => {\n    const handlePaste = async (event: ClipboardEvent) => {\n      const activeElement = document.activeElement\n      if (\n        activeElement &&\n        (activeElement.tagName === \"INPUT\" ||\n          activeElement.tagName === \"TEXTAREA\")\n      ) {\n        return\n      }\n\n      if (props.isOnlyMove) return\n\n      const items = event.clipboardData?.items\n      if (!items) return\n\n      for (const item of items) {\n        if (item.type.startsWith(\"image\")) {\n          const file = item.getAsFile()\n          if (file && file.size <= maxSize) {\n            const reader = new FileReader()\n            reader.onload = (e) => {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = e.target?.result as string\n            }\n            reader.readAsDataURL(file)\n            toast(\"ç”»åƒã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã¾ã—ãŸ\")\n          } else {\n            toast(\n              t(\n                `${maxSizeLabel}ä»¥å†…ã®ç”»åƒã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„`,\n                `Please paste an image under ${maxSizeLabel}`,\n              ),\n            )\n          }\n        }\n      }\n    }\n\n    document.addEventListener(\"paste\", handlePaste)\n    return () => {\n      document.removeEventListener(\"paste\", handlePaste)\n    }\n  }, [])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Maximum ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (\n          props.maxItemsCount &&\n          props.maxItemsCount < props.items.length + 1\n        ) {\n          toast(\n            t(\n              `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n              `Maximum ${props.maxItemsCount} items allowed`,\n            ),\n          )\n          return\n        }\n\n        if (props.items.length === 0 && file.type === \"image/png\") {\n          const pngInfo = await getExtractInfoFromPNG(file)\n          if (props.onChangePngInfo) {\n            props.onChangePngInfo(pngInfo)\n          }\n        }\n\n        const reader = new FileReader()\n        reader.onload = (event) => {\n          if (event.target) {\n            const img = new Image()\n            img.onload = () => {\n              const canvas = document.createElement(\"canvas\")\n              canvas.width = img.width\n              canvas.height = img.height\n              const ctx = canvas.getContext(\"2d\")\n              ctx?.drawImage(img, 0, 0)\n              const webpDataURL = canvas.toDataURL(\"image/webp\")\n              props.items.push({\n                id: props.items.length,\n                content: webpDataURL,\n              })\n              props.onChangeItems([...props.items])\n              updateThumbnail()\n            }\n            img.src = event.target.result as string\n          }\n        }\n        reader.readAsDataURL(file)\n      })\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n\n        if (props.onInputFiles) {\n          props.onInputFiles(inputElement.files)\n        }\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n          props.items.length ? \"\" : \"rounded-b\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              {props.submitText ? (\n                <p className=\"font-bold\">{props.submitText}</p>\n              ) : (\n                <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n              )}\n            </div>\n          </>\n        )}\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            props.items.length !== props.maxItemsCount &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col rounded-b text-white\">\n            <p className=\"text-center text-sm\">{\"JPEGã€PNGã€GIFã€WEBPã€BMP\"}</p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æš`,\n                `Up to ${maxSizeLabel} per image, max 200 images`,\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {\"ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã‚‚å¯èƒ½\"}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images.tsx"},"span":[8006,8019],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { MAX_IMAGE_FILE_SIZE_BYTES, formatFileSize } from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n  onInputFiles?: (files: FileList) => void\n  submitText?: string\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImages (props: Props) {\n  const t = useTranslation()\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(maxSize)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰ç”»åƒè²¼ã‚Šä»˜ã‘ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹\n   */\n  useEffect(() => {\n    const handlePaste = async (event: ClipboardEvent) => {\n      const activeElement = document.activeElement\n      if (\n        activeElement &&\n        (activeElement.tagName === \"INPUT\" ||\n          activeElement.tagName === \"TEXTAREA\")\n      ) {\n        return\n      }\n\n      if (props.isOnlyMove) return\n\n      const items = event.clipboardData?.items\n      if (!items) return\n\n      for (const item of items) {\n        if (item.type.startsWith(\"image\")) {\n          const file = item.getAsFile()\n          if (file && file.size <= maxSize) {\n            const reader = new FileReader()\n            reader.onload = (e) => {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = e.target?.result as string\n            }\n            reader.readAsDataURL(file)\n            toast(\"ç”»åƒã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã¾ã—ãŸ\")\n          } else {\n            toast(\n              t(\n                `${maxSizeLabel}ä»¥å†…ã®ç”»åƒã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„`,\n                `Please paste an image under ${maxSizeLabel}`,\n              ),\n            )\n          }\n        }\n      }\n    }\n\n    document.addEventListener(\"paste\", handlePaste)\n    return () => {\n      document.removeEventListener(\"paste\", handlePaste)\n    }\n  }, [])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Maximum ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (\n          props.maxItemsCount &&\n          props.maxItemsCount < props.items.length + 1\n        ) {\n          toast(\n            t(\n              `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n              `Maximum ${props.maxItemsCount} items allowed`,\n            ),\n          )\n          return\n        }\n\n        if (props.items.length === 0 && file.type === \"image/png\") {\n          const pngInfo = await getExtractInfoFromPNG(file)\n          if (props.onChangePngInfo) {\n            props.onChangePngInfo(pngInfo)\n          }\n        }\n\n        const reader = new FileReader()\n        reader.onload = (event) => {\n          if (event.target) {\n            const img = new Image()\n            img.onload = () => {\n              const canvas = document.createElement(\"canvas\")\n              canvas.width = img.width\n              canvas.height = img.height\n              const ctx = canvas.getContext(\"2d\")\n              ctx?.drawImage(img, 0, 0)\n              const webpDataURL = canvas.toDataURL(\"image/webp\")\n              props.items.push({\n                id: props.items.length,\n                content: webpDataURL,\n              })\n              props.onChangeItems([...props.items])\n              updateThumbnail()\n            }\n            img.src = event.target.result as string\n          }\n        }\n        reader.readAsDataURL(file)\n      })\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n\n        if (props.onInputFiles) {\n          props.onInputFiles(inputElement.files)\n        }\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n          props.items.length ? \"\" : \"rounded-b\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              {props.submitText ? (\n                <p className=\"font-bold\">{props.submitText}</p>\n              ) : (\n                <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n              )}\n            </div>\n          </>\n        )}\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            props.items.length !== props.maxItemsCount &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col rounded-b text-white\">\n            <p className=\"text-center text-sm\">{\"JPEGã€PNGã€GIFã€WEBPã€BMP\"}</p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æš`,\n                `Up to ${maxSizeLabel} per image, max 200 images`,\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {\"ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã‚‚å¯èƒ½\"}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images.tsx"},"span":[8962,8975],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { MAX_IMAGE_FILE_SIZE_BYTES, formatFileSize } from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n  onInputFiles?: (files: FileList) => void\n  submitText?: string\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImages (props: Props) {\n  const t = useTranslation()\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(maxSize)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰ç”»åƒè²¼ã‚Šä»˜ã‘ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹\n   */\n  useEffect(() => {\n    const handlePaste = async (event: ClipboardEvent) => {\n      const activeElement = document.activeElement\n      if (\n        activeElement &&\n        (activeElement.tagName === \"INPUT\" ||\n          activeElement.tagName === \"TEXTAREA\")\n      ) {\n        return\n      }\n\n      if (props.isOnlyMove) return\n\n      const items = event.clipboardData?.items\n      if (!items) return\n\n      for (const item of items) {\n        if (item.type.startsWith(\"image\")) {\n          const file = item.getAsFile()\n          if (file && file.size <= maxSize) {\n            const reader = new FileReader()\n            reader.onload = (e) => {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = e.target?.result as string\n            }\n            reader.readAsDataURL(file)\n            toast(\"ç”»åƒã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã¾ã—ãŸ\")\n          } else {\n            toast(\n              t(\n                `${maxSizeLabel}ä»¥å†…ã®ç”»åƒã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„`,\n                `Please paste an image under ${maxSizeLabel}`,\n              ),\n            )\n          }\n        }\n      }\n    }\n\n    document.addEventListener(\"paste\", handlePaste)\n    return () => {\n      document.removeEventListener(\"paste\", handlePaste)\n    }\n  }, [])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Maximum ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (\n          props.maxItemsCount &&\n          props.maxItemsCount < props.items.length + 1\n        ) {\n          toast(\n            t(\n              `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n              `Maximum ${props.maxItemsCount} items allowed`,\n            ),\n          )\n          return\n        }\n\n        if (props.items.length === 0 && file.type === \"image/png\") {\n          const pngInfo = await getExtractInfoFromPNG(file)\n          if (props.onChangePngInfo) {\n            props.onChangePngInfo(pngInfo)\n          }\n        }\n\n        const reader = new FileReader()\n        reader.onload = (event) => {\n          if (event.target) {\n            const img = new Image()\n            img.onload = () => {\n              const canvas = document.createElement(\"canvas\")\n              canvas.width = img.width\n              canvas.height = img.height\n              const ctx = canvas.getContext(\"2d\")\n              ctx?.drawImage(img, 0, 0)\n              const webpDataURL = canvas.toDataURL(\"image/webp\")\n              props.items.push({\n                id: props.items.length,\n                content: webpDataURL,\n              })\n              props.onChangeItems([...props.items])\n              updateThumbnail()\n            }\n            img.src = event.target.result as string\n          }\n        }\n        reader.readAsDataURL(file)\n      })\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n\n        if (props.onInputFiles) {\n          props.onInputFiles(inputElement.files)\n        }\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n          props.items.length ? \"\" : \"rounded-b\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              {props.submitText ? (\n                <p className=\"font-bold\">{props.submitText}</p>\n              ) : (\n                <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n              )}\n            </div>\n          </>\n        )}\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            props.items.length !== props.maxItemsCount &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col rounded-b text-white\">\n            <p className=\"text-center text-sm\">{\"JPEGã€PNGã€GIFã€WEBPã€BMP\"}</p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æš`,\n                `Up to ${maxSizeLabel} per image, max 200 images`,\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {\"ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã‚‚å¯èƒ½\"}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images.tsx"},"span":[10605,10618],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { MAX_IMAGE_FILE_SIZE_BYTES, formatFileSize } from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n  onInputFiles?: (files: FileList) => void\n  submitText?: string\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImages (props: Props) {\n  const t = useTranslation()\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(maxSize)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰ç”»åƒè²¼ã‚Šä»˜ã‘ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹\n   */\n  useEffect(() => {\n    const handlePaste = async (event: ClipboardEvent) => {\n      const activeElement = document.activeElement\n      if (\n        activeElement &&\n        (activeElement.tagName === \"INPUT\" ||\n          activeElement.tagName === \"TEXTAREA\")\n      ) {\n        return\n      }\n\n      if (props.isOnlyMove) return\n\n      const items = event.clipboardData?.items\n      if (!items) return\n\n      for (const item of items) {\n        if (item.type.startsWith(\"image\")) {\n          const file = item.getAsFile()\n          if (file && file.size <= maxSize) {\n            const reader = new FileReader()\n            reader.onload = (e) => {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = e.target?.result as string\n            }\n            reader.readAsDataURL(file)\n            toast(\"ç”»åƒã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã¾ã—ãŸ\")\n          } else {\n            toast(\n              t(\n                `${maxSizeLabel}ä»¥å†…ã®ç”»åƒã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„`,\n                `Please paste an image under ${maxSizeLabel}`,\n              ),\n            )\n          }\n        }\n      }\n    }\n\n    document.addEventListener(\"paste\", handlePaste)\n    return () => {\n      document.removeEventListener(\"paste\", handlePaste)\n    }\n  }, [])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Maximum ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (\n          props.maxItemsCount &&\n          props.maxItemsCount < props.items.length + 1\n        ) {\n          toast(\n            t(\n              `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n              `Maximum ${props.maxItemsCount} items allowed`,\n            ),\n          )\n          return\n        }\n\n        if (props.items.length === 0 && file.type === \"image/png\") {\n          const pngInfo = await getExtractInfoFromPNG(file)\n          if (props.onChangePngInfo) {\n            props.onChangePngInfo(pngInfo)\n          }\n        }\n\n        const reader = new FileReader()\n        reader.onload = (event) => {\n          if (event.target) {\n            const img = new Image()\n            img.onload = () => {\n              const canvas = document.createElement(\"canvas\")\n              canvas.width = img.width\n              canvas.height = img.height\n              const ctx = canvas.getContext(\"2d\")\n              ctx?.drawImage(img, 0, 0)\n              const webpDataURL = canvas.toDataURL(\"image/webp\")\n              props.items.push({\n                id: props.items.length,\n                content: webpDataURL,\n              })\n              props.onChangeItems([...props.items])\n              updateThumbnail()\n            }\n            img.src = event.target.result as string\n          }\n        }\n        reader.readAsDataURL(file)\n      })\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n\n        if (props.onInputFiles) {\n          props.onInputFiles(inputElement.files)\n        }\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n          props.items.length ? \"\" : \"rounded-b\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              {props.submitText ? (\n                <p className=\"font-bold\">{props.submitText}</p>\n              ) : (\n                <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n              )}\n            </div>\n          </>\n        )}\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            props.items.length !== props.maxItemsCount &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col rounded-b text-white\">\n            <p className=\"text-center text-sm\">{\"JPEGã€PNGã€GIFã€WEBPã€BMP\"}</p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æš`,\n                `Up to ${maxSizeLabel} per image, max 200 images`,\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {\"ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã‚‚å¯èƒ½\"}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images.tsx"},"span":[8774,8822],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { MAX_IMAGE_FILE_SIZE_BYTES, formatFileSize } from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n  onInputFiles?: (files: FileList) => void\n  submitText?: string\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImages (props: Props) {\n  const t = useTranslation()\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(maxSize)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰ç”»åƒè²¼ã‚Šä»˜ã‘ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹\n   */\n  useEffect(() => {\n    const handlePaste = async (event: ClipboardEvent) => {\n      const activeElement = document.activeElement\n      if (\n        activeElement &&\n        (activeElement.tagName === \"INPUT\" ||\n          activeElement.tagName === \"TEXTAREA\")\n      ) {\n        return\n      }\n\n      if (props.isOnlyMove) return\n\n      const items = event.clipboardData?.items\n      if (!items) return\n\n      for (const item of items) {\n        if (item.type.startsWith(\"image\")) {\n          const file = item.getAsFile()\n          if (file && file.size <= maxSize) {\n            const reader = new FileReader()\n            reader.onload = (e) => {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = e.target?.result as string\n            }\n            reader.readAsDataURL(file)\n            toast(\"ç”»åƒã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã¾ã—ãŸ\")\n          } else {\n            toast(\n              t(\n                `${maxSizeLabel}ä»¥å†…ã®ç”»åƒã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„`,\n                `Please paste an image under ${maxSizeLabel}`,\n              ),\n            )\n          }\n        }\n      }\n    }\n\n    document.addEventListener(\"paste\", handlePaste)\n    return () => {\n      document.removeEventListener(\"paste\", handlePaste)\n    }\n  }, [])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Maximum ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (\n          props.maxItemsCount &&\n          props.maxItemsCount < props.items.length + 1\n        ) {\n          toast(\n            t(\n              `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n              `Maximum ${props.maxItemsCount} items allowed`,\n            ),\n          )\n          return\n        }\n\n        if (props.items.length === 0 && file.type === \"image/png\") {\n          const pngInfo = await getExtractInfoFromPNG(file)\n          if (props.onChangePngInfo) {\n            props.onChangePngInfo(pngInfo)\n          }\n        }\n\n        const reader = new FileReader()\n        reader.onload = (event) => {\n          if (event.target) {\n            const img = new Image()\n            img.onload = () => {\n              const canvas = document.createElement(\"canvas\")\n              canvas.width = img.width\n              canvas.height = img.height\n              const ctx = canvas.getContext(\"2d\")\n              ctx?.drawImage(img, 0, 0)\n              const webpDataURL = canvas.toDataURL(\"image/webp\")\n              props.items.push({\n                id: props.items.length,\n                content: webpDataURL,\n              })\n              props.onChangeItems([...props.items])\n              updateThumbnail()\n            }\n            img.src = event.target.result as string\n          }\n        }\n        reader.readAsDataURL(file)\n      })\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n\n        if (props.onInputFiles) {\n          props.onInputFiles(inputElement.files)\n        }\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n          props.items.length ? \"\" : \"rounded-b\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              {props.submitText ? (\n                <p className=\"font-bold\">{props.submitText}</p>\n              ) : (\n                <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n              )}\n            </div>\n          </>\n        )}\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            props.items.length !== props.maxItemsCount &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col rounded-b text-white\">\n            <p className=\"text-center text-sm\">{\"JPEGã€PNGã€GIFã€WEBPã€BMP\"}</p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æš`,\n                `Up to ${maxSizeLabel} per image, max 200 images`,\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {\"ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã‚‚å¯èƒ½\"}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images.tsx"},"span":[6120,6176],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { MAX_IMAGE_FILE_SIZE_BYTES, formatFileSize } from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n  onInputFiles?: (files: FileList) => void\n  submitText?: string\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImages (props: Props) {\n  const t = useTranslation()\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(maxSize)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰ç”»åƒè²¼ã‚Šä»˜ã‘ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹\n   */\n  useEffect(() => {\n    const handlePaste = async (event: ClipboardEvent) => {\n      const activeElement = document.activeElement\n      if (\n        activeElement &&\n        (activeElement.tagName === \"INPUT\" ||\n          activeElement.tagName === \"TEXTAREA\")\n      ) {\n        return\n      }\n\n      if (props.isOnlyMove) return\n\n      const items = event.clipboardData?.items\n      if (!items) return\n\n      for (const item of items) {\n        if (item.type.startsWith(\"image\")) {\n          const file = item.getAsFile()\n          if (file && file.size <= maxSize) {\n            const reader = new FileReader()\n            reader.onload = (e) => {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = e.target?.result as string\n            }\n            reader.readAsDataURL(file)\n            toast(\"ç”»åƒã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã¾ã—ãŸ\")\n          } else {\n            toast(\n              t(\n                `${maxSizeLabel}ä»¥å†…ã®ç”»åƒã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„`,\n                `Please paste an image under ${maxSizeLabel}`,\n              ),\n            )\n          }\n        }\n      }\n    }\n\n    document.addEventListener(\"paste\", handlePaste)\n    return () => {\n      document.removeEventListener(\"paste\", handlePaste)\n    }\n  }, [])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Maximum ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (\n          props.maxItemsCount &&\n          props.maxItemsCount < props.items.length + 1\n        ) {\n          toast(\n            t(\n              `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n              `Maximum ${props.maxItemsCount} items allowed`,\n            ),\n          )\n          return\n        }\n\n        if (props.items.length === 0 && file.type === \"image/png\") {\n          const pngInfo = await getExtractInfoFromPNG(file)\n          if (props.onChangePngInfo) {\n            props.onChangePngInfo(pngInfo)\n          }\n        }\n\n        const reader = new FileReader()\n        reader.onload = (event) => {\n          if (event.target) {\n            const img = new Image()\n            img.onload = () => {\n              const canvas = document.createElement(\"canvas\")\n              canvas.width = img.width\n              canvas.height = img.height\n              const ctx = canvas.getContext(\"2d\")\n              ctx?.drawImage(img, 0, 0)\n              const webpDataURL = canvas.toDataURL(\"image/webp\")\n              props.items.push({\n                id: props.items.length,\n                content: webpDataURL,\n              })\n              props.onChangeItems([...props.items])\n              updateThumbnail()\n            }\n            img.src = event.target.result as string\n          }\n        }\n        reader.readAsDataURL(file)\n      })\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n\n        if (props.onInputFiles) {\n          props.onInputFiles(inputElement.files)\n        }\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n          props.items.length ? \"\" : \"rounded-b\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              {props.submitText ? (\n                <p className=\"font-bold\">{props.submitText}</p>\n              ) : (\n                <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n              )}\n            </div>\n          </>\n        )}\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            props.items.length !== props.maxItemsCount &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col rounded-b text-white\">\n            <p className=\"text-center text-sm\">{\"JPEGã€PNGã€GIFã€WEBPã€BMP\"}</p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æš`,\n                `Up to ${maxSizeLabel} per image, max 200 images`,\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {\"ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã‚‚å¯èƒ½\"}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images.tsx"},"span":[7768,7824],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { MAX_IMAGE_FILE_SIZE_BYTES, formatFileSize } from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n  onInputFiles?: (files: FileList) => void\n  submitText?: string\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImages (props: Props) {\n  const t = useTranslation()\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(maxSize)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰ç”»åƒè²¼ã‚Šä»˜ã‘ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹\n   */\n  useEffect(() => {\n    const handlePaste = async (event: ClipboardEvent) => {\n      const activeElement = document.activeElement\n      if (\n        activeElement &&\n        (activeElement.tagName === \"INPUT\" ||\n          activeElement.tagName === \"TEXTAREA\")\n      ) {\n        return\n      }\n\n      if (props.isOnlyMove) return\n\n      const items = event.clipboardData?.items\n      if (!items) return\n\n      for (const item of items) {\n        if (item.type.startsWith(\"image\")) {\n          const file = item.getAsFile()\n          if (file && file.size <= maxSize) {\n            const reader = new FileReader()\n            reader.onload = (e) => {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = e.target?.result as string\n            }\n            reader.readAsDataURL(file)\n            toast(\"ç”»åƒã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã¾ã—ãŸ\")\n          } else {\n            toast(\n              t(\n                `${maxSizeLabel}ä»¥å†…ã®ç”»åƒã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„`,\n                `Please paste an image under ${maxSizeLabel}`,\n              ),\n            )\n          }\n        }\n      }\n    }\n\n    document.addEventListener(\"paste\", handlePaste)\n    return () => {\n      document.removeEventListener(\"paste\", handlePaste)\n    }\n  }, [])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Maximum ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (\n          props.maxItemsCount &&\n          props.maxItemsCount < props.items.length + 1\n        ) {\n          toast(\n            t(\n              `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n              `Maximum ${props.maxItemsCount} items allowed`,\n            ),\n          )\n          return\n        }\n\n        if (props.items.length === 0 && file.type === \"image/png\") {\n          const pngInfo = await getExtractInfoFromPNG(file)\n          if (props.onChangePngInfo) {\n            props.onChangePngInfo(pngInfo)\n          }\n        }\n\n        const reader = new FileReader()\n        reader.onload = (event) => {\n          if (event.target) {\n            const img = new Image()\n            img.onload = () => {\n              const canvas = document.createElement(\"canvas\")\n              canvas.width = img.width\n              canvas.height = img.height\n              const ctx = canvas.getContext(\"2d\")\n              ctx?.drawImage(img, 0, 0)\n              const webpDataURL = canvas.toDataURL(\"image/webp\")\n              props.items.push({\n                id: props.items.length,\n                content: webpDataURL,\n              })\n              props.onChangeItems([...props.items])\n              updateThumbnail()\n            }\n            img.src = event.target.result as string\n          }\n        }\n        reader.readAsDataURL(file)\n      })\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n\n        if (props.onInputFiles) {\n          props.onInputFiles(inputElement.files)\n        }\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n          props.items.length ? \"\" : \"rounded-b\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              {props.submitText ? (\n                <p className=\"font-bold\">{props.submitText}</p>\n              ) : (\n                <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n              )}\n            </div>\n          </>\n        )}\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            props.items.length !== props.maxItemsCount &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col rounded-b text-white\">\n            <p className=\"text-center text-sm\">{\"JPEGã€PNGã€GIFã€WEBPã€BMP\"}</p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æš`,\n                `Up to ${maxSizeLabel} per image, max 200 images`,\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {\"ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã‚‚å¯èƒ½\"}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images.tsx"},"span":[7963,8019],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { MAX_IMAGE_FILE_SIZE_BYTES, formatFileSize } from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n  onInputFiles?: (files: FileList) => void\n  submitText?: string\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImages (props: Props) {\n  const t = useTranslation()\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(maxSize)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰ç”»åƒè²¼ã‚Šä»˜ã‘ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹\n   */\n  useEffect(() => {\n    const handlePaste = async (event: ClipboardEvent) => {\n      const activeElement = document.activeElement\n      if (\n        activeElement &&\n        (activeElement.tagName === \"INPUT\" ||\n          activeElement.tagName === \"TEXTAREA\")\n      ) {\n        return\n      }\n\n      if (props.isOnlyMove) return\n\n      const items = event.clipboardData?.items\n      if (!items) return\n\n      for (const item of items) {\n        if (item.type.startsWith(\"image\")) {\n          const file = item.getAsFile()\n          if (file && file.size <= maxSize) {\n            const reader = new FileReader()\n            reader.onload = (e) => {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = e.target?.result as string\n            }\n            reader.readAsDataURL(file)\n            toast(\"ç”»åƒã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã¾ã—ãŸ\")\n          } else {\n            toast(\n              t(\n                `${maxSizeLabel}ä»¥å†…ã®ç”»åƒã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„`,\n                `Please paste an image under ${maxSizeLabel}`,\n              ),\n            )\n          }\n        }\n      }\n    }\n\n    document.addEventListener(\"paste\", handlePaste)\n    return () => {\n      document.removeEventListener(\"paste\", handlePaste)\n    }\n  }, [])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Maximum ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (\n          props.maxItemsCount &&\n          props.maxItemsCount < props.items.length + 1\n        ) {\n          toast(\n            t(\n              `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n              `Maximum ${props.maxItemsCount} items allowed`,\n            ),\n          )\n          return\n        }\n\n        if (props.items.length === 0 && file.type === \"image/png\") {\n          const pngInfo = await getExtractInfoFromPNG(file)\n          if (props.onChangePngInfo) {\n            props.onChangePngInfo(pngInfo)\n          }\n        }\n\n        const reader = new FileReader()\n        reader.onload = (event) => {\n          if (event.target) {\n            const img = new Image()\n            img.onload = () => {\n              const canvas = document.createElement(\"canvas\")\n              canvas.width = img.width\n              canvas.height = img.height\n              const ctx = canvas.getContext(\"2d\")\n              ctx?.drawImage(img, 0, 0)\n              const webpDataURL = canvas.toDataURL(\"image/webp\")\n              props.items.push({\n                id: props.items.length,\n                content: webpDataURL,\n              })\n              props.onChangeItems([...props.items])\n              updateThumbnail()\n            }\n            img.src = event.target.result as string\n          }\n        }\n        reader.readAsDataURL(file)\n      })\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n\n        if (props.onInputFiles) {\n          props.onInputFiles(inputElement.files)\n        }\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n          props.items.length ? \"\" : \"rounded-b\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              {props.submitText ? (\n                <p className=\"font-bold\">{props.submitText}</p>\n              ) : (\n                <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n              )}\n            </div>\n          </>\n        )}\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            props.items.length !== props.maxItemsCount &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col rounded-b text-white\">\n            <p className=\"text-center text-sm\">{\"JPEGã€PNGã€GIFã€WEBPã€BMP\"}</p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æš`,\n                `Up to ${maxSizeLabel} per image, max 200 images`,\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {\"ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã‚‚å¯èƒ½\"}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-event.tsx"},"span":[2282,2295],"sourceCode":"import type { Tag } from \"~/components/tag/tag-input\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { Link } from \"@remix-run/react\"\nimport { useEffect, useState } from \"react\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { getJstDate } from \"~/utils/jst-date\"\n\ntype Props = {\n  eventName: string | null\n  eventDescription: string | null\n  eventTag: string | null\n  endAt: number\n  slug: string | null\n  removeTag: (tag: Tag) => void\n  addTag: (tag: Tag) => void\n  isAttending?: boolean\n}\n\n/**\n * ã‚¤ãƒ™ãƒ³ãƒˆå…¥åŠ›\n */\nexport function PostFormItemEvent (props: Props) {\n  const now = getJstDate(new Date())\n\n  const isOngoing = now <= new Date(props.endAt * 1000)\n\n  if (!isOngoing) {\n    return null\n  }\n\n  const [isAttending, setIsAttending] = useState(\n    props.isAttending === undefined ? false : props.isAttending,\n  )\n\n  const handleAttendanceChange = (isChecked: boolean) => {\n    setIsAttending(isChecked)\n    if (props.eventTag) {\n      if (isChecked) {\n        props.addTag({\n          id: props.eventTag,\n          text: props.eventTag,\n        })\n        return\n      }\n      props.removeTag({\n        id: props.eventTag,\n        text: props.eventTag,\n      })\n    }\n  }\n\n  useEffect(() => {\n    setIsAttending(props.isAttending === undefined ? false : props.isAttending)\n  }, [props.isAttending])\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-2 p-4\">\n        <div className=\"flex items-center\">\n          <Checkbox\n            checked={isAttending}\n            onCheckedChange={handleAttendanceChange}\n            id=\"attend-checkbox\"\n          />\n          <label htmlFor=\"attend-checkbox\" className=\"ml-2 font-medium text-sm\">\n            å‚åŠ ã™ã‚‹\n          </label>\n        </div>\n        {/* ã‚¤ãƒ™ãƒ³ãƒˆåã¨èª¬æ˜ã‚’è¡¨ç¤º */}\n        <Link\n          className=\"block\"\n          to={`https://www.aipictors.com/events/${props.slug}`}\n          target=\"_blank\"\n        >\n          <Card>\n            <CardContent className=\"space-y-2 p-4\">\n              <h3 className=\"font-medium text-sm\">{props.eventName}</h3>\n              {props.eventDescription !== null && (\n                <div\n                  className=\"font-medium text-xs\"\n                  // biome-ignore lint/security/noDangerouslySetInnerHtml: <explanation>\n                  dangerouslySetInnerHTML={{ __html: props.eventDescription }}\n                />\n              )}\n            </CardContent>\n          </Card>\n        </Link>\n      </CardContent>\n    </Card>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-event.tsx"},"span":[1467,1609],"sourceCode":"import type { Tag } from \"~/components/tag/tag-input\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { Link } from \"@remix-run/react\"\nimport { useEffect, useState } from \"react\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { getJstDate } from \"~/utils/jst-date\"\n\ntype Props = {\n  eventName: string | null\n  eventDescription: string | null\n  eventTag: string | null\n  endAt: number\n  slug: string | null\n  removeTag: (tag: Tag) => void\n  addTag: (tag: Tag) => void\n  isAttending?: boolean\n}\n\n/**\n * ã‚¤ãƒ™ãƒ³ãƒˆå…¥åŠ›\n */\nexport function PostFormItemEvent (props: Props) {\n  const now = getJstDate(new Date())\n\n  const isOngoing = now <= new Date(props.endAt * 1000)\n\n  if (!isOngoing) {\n    return null\n  }\n\n  const [isAttending, setIsAttending] = useState(\n    props.isAttending === undefined ? false : props.isAttending,\n  )\n\n  const handleAttendanceChange = (isChecked: boolean) => {\n    setIsAttending(isChecked)\n    if (props.eventTag) {\n      if (isChecked) {\n        props.addTag({\n          id: props.eventTag,\n          text: props.eventTag,\n        })\n        return\n      }\n      props.removeTag({\n        id: props.eventTag,\n        text: props.eventTag,\n      })\n    }\n  }\n\n  useEffect(() => {\n    setIsAttending(props.isAttending === undefined ? false : props.isAttending)\n  }, [props.isAttending])\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-2 p-4\">\n        <div className=\"flex items-center\">\n          <Checkbox\n            checked={isAttending}\n            onCheckedChange={handleAttendanceChange}\n            id=\"attend-checkbox\"\n          />\n          <label htmlFor=\"attend-checkbox\" className=\"ml-2 font-medium text-sm\">\n            å‚åŠ ã™ã‚‹\n          </label>\n        </div>\n        {/* ã‚¤ãƒ™ãƒ³ãƒˆåã¨èª¬æ˜ã‚’è¡¨ç¤º */}\n        <Link\n          className=\"block\"\n          to={`https://www.aipictors.com/events/${props.slug}`}\n          target=\"_blank\"\n        >\n          <Card>\n            <CardContent className=\"space-y-2 p-4\">\n              <h3 className=\"font-medium text-sm\">{props.eventName}</h3>\n              {props.eventDescription !== null && (\n                <div\n                  className=\"font-medium text-xs\"\n                  // biome-ignore lint/security/noDangerouslySetInnerHtml: <explanation>\n                  dangerouslySetInnerHTML={{ __html: props.eventDescription }}\n                />\n              )}\n            </CardContent>\n          </Card>\n        </Link>\n      </CardContent>\n    </Card>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-text-type.tsx"},"span":[1011,1060],"sourceCode":"import { Card, CardContent } from \"~/components/ui/card\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\n\ntype Props = {\n  type: IntrospectionEnum<\"WorkType\">\n  setType: (value: IntrospectionEnum<\"WorkType\">) => void\n}\n\n/**\n * ç¨®åˆ¥å…¥åŠ›\n */\nexport function PostFormItemType (props: Props) {\n  // å¤§æ–‡å­—ã«å¤‰æ›\n  const type = props.type.toUpperCase() as IntrospectionEnum<\"WorkType\">\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-2 p-4\">\n        <p className=\"font-bold text-sm\">ç¨®é¡</p>\n        <RadioGroup\n          value={type}\n          onValueChange={(value) => {\n            props.setType(value as IntrospectionEnum<\"WorkType\">)\n          }}\n          className=\"flex flex-wrap space-x-0 text-sm\"\n        >\n          <div className=\"md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <label htmlFor=\"novel-check\">\n                {\"å°èª¬\"}\n                <RadioGroupItem value=\"NOVEL\" id=\"novel-check\" />\n              </label>\n            </div>\n          </div>\n          <div className=\"w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <label htmlFor=\"column-check\">\n                {\"ã‚³ãƒ©ãƒ \"}\n                <RadioGroupItem value=\"COLUMN\" id=\"column-check\" />\n              </label>\n            </div>\n          </div>\n        </RadioGroup>\n      </CardContent>\n    </Card>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-text-type.tsx"},"span":[1304,1355],"sourceCode":"import { Card, CardContent } from \"~/components/ui/card\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\n\ntype Props = {\n  type: IntrospectionEnum<\"WorkType\">\n  setType: (value: IntrospectionEnum<\"WorkType\">) => void\n}\n\n/**\n * ç¨®åˆ¥å…¥åŠ›\n */\nexport function PostFormItemType (props: Props) {\n  // å¤§æ–‡å­—ã«å¤‰æ›\n  const type = props.type.toUpperCase() as IntrospectionEnum<\"WorkType\">\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-2 p-4\">\n        <p className=\"font-bold text-sm\">ç¨®é¡</p>\n        <RadioGroup\n          value={type}\n          onValueChange={(value) => {\n            props.setType(value as IntrospectionEnum<\"WorkType\">)\n          }}\n          className=\"flex flex-wrap space-x-0 text-sm\"\n        >\n          <div className=\"md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <label htmlFor=\"novel-check\">\n                {\"å°èª¬\"}\n                <RadioGroupItem value=\"NOVEL\" id=\"novel-check\" />\n              </label>\n            </div>\n          </div>\n          <div className=\"w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <label htmlFor=\"column-check\">\n                {\"ã‚³ãƒ©ãƒ \"}\n                <RadioGroupItem value=\"COLUMN\" id=\"column-check\" />\n              </label>\n            </div>\n          </div>\n        </RadioGroup>\n      </CardContent>\n    </Card>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-theme.tsx"},"span":[951,1136],"sourceCode":"import { Checkbox } from \"~/components/ui/checkbox\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  titles: { date: string; title: string }[] | null\n  isChecked?: boolean\n  onChange: (value: boolean) => void\n  isLoading?: boolean\n  targetDate: string // yyyy-mm-dd\n}\n\n/**\n * ãŠé¡Œå…¥åŠ›\n */\nexport function PostFormItemTheme (props: Props) {\n  if (!props.titles) {\n    return null\n  }\n\n  // Extract the title(s) that match the target date\n  const matchingTitles = props.titles\n    .filter((item) => item.date === props.targetDate)\n    .map((item) => item.title)\n\n  if (matchingTitles.length === 0) {\n    return null\n  }\n\n  const t = useTranslation()\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-2 p-4\">\n        <p className=\"font-bold text-sm\">{t(\"ãŠé¡Œå‚åŠ \", \"Join the theme\")}</p>\n        <div className=\"flex items-center space-x-2\">\n          <Checkbox\n            onCheckedChange={(value: boolean) => {\n              props.onChange(value)\n            }}\n            id=\"theme\"\n            checked={props.isChecked}\n          />\n          <label className=\"text-sm\" htmlFor=\"theme\">\n            {t(\n              `ãŠé¡Œã€Œ${matchingTitles.join(\", \")}ã€ã«å‚åŠ ã™ã‚‹`,\n              `Join the theme \"${matchingTitles.join(\", \")}\"`,\n            )}\n          </label>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-title-caption.tsx"},"span":[9878,9891],"sourceCode":"import { useState, useEffect, useRef } from \"react\"\nimport { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { Input } from \"~/components/ui/input\"\nimport { Button } from \"~/components/ui/button\"\nimport { Sparkles, Loader2Icon, Settings } from \"lucide-react\"\nimport { cn } from \"~/lib/utils\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { toast } from \"sonner\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { sha256 } from \"~/utils/sha256\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport {\n  canUseAiGeneration,\n  consumeAiGenerationUsage,\n} from \"../utils/ai-generation-usage\"\nimport { ContentTypeSelector } from \"./content-type-selector\"\nimport {\n  Collapsible,\n  CollapsibleContent,\n  CollapsibleTrigger,\n} from \"~/components/ui/collapsible\"\n\n// ç”»åƒURLã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆãƒ¡ãƒ¢ãƒªå†…ï¼‰\nconst imageUrlCache = new Map<string, string>()\n\n// GraphQL mutation - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã‚¹ã‚­ãƒ¼ãƒå®šç¾©å¾Œã«ä¿®æ­£äºˆå®š\nconst GenerateImageContentMutation = graphql(\n  `mutation GenerateImageContent($input: GenerateImageContentInput!) {\n    generateImageContent(input: $input) {\n      title\n      description\n      tags\n      titleEn\n      descriptionEn\n      tagsEn\n    }\n  }`,\n) as unknown as ReturnType<typeof graphql>\n\ntype Props = {\n  title: string\n  caption?: string\n  onTitleChange: (value: string) => void\n  onCaptionChange: (value: string) => void\n  // AIè‡ªå‹•ç”Ÿæˆãƒœã‚¿ãƒ³é–¢é€£ã®props\n  imageBase64: string | null\n  token: string | undefined | null\n  onContentGenerated: (data: {\n    title?: string\n    description?: string\n    tags?: string[]\n    titleEn?: string\n    descriptionEn?: string\n    tagsEn?: string[]\n  }) => void\n  isGenerating?: boolean\n  onGenerateStart?: () => void\n}\n\n/**\n * ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆå¿…é ˆï¼‰ãƒ»ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³çµ±åˆå…¥åŠ›ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ\n */\nexport function PostFormItemTitleCaption (props: Props) {\n  const t = useTranslation()\n  const [localTitle, setLocalTitle] = useState(props.title || \"\")\n  const [localCaption, setLocalCaption] = useState(props.caption || \"\")\n  const [isLocalGenerating, setIsLocalGenerating] = useState(false)\n  const [contentType, setContentType] = useState<\n    \"STORY\" | \"CHARACTER\" | \"STANDARD\"\n  >(\"STORY\")\n  const [isAdvancedOpen, setIsAdvancedOpen] = useState(false)\n\n  const [generateContent] = useMutation(GenerateImageContentMutation)\n\n  const titleTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null)\n  const captionTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null)\n\n  const isTitleFilled = localTitle.trim() !== \"\"\n  const isCaptionFilled = localCaption.trim() !== \"\"\n\n  /**\n   * JPEGã«å¤‰æ›ã™ã‚‹é–¢æ•°\n   */\n  const convertToJpeg = async (base64: string): Promise<string> => {\n    return new Promise((resolve, reject) => {\n      const img = new Image()\n      img.onload = () => {\n        const canvas = document.createElement(\"canvas\")\n        const ctx = canvas.getContext(\"2d\")\n        if (!ctx) {\n          reject(new Error(\"Failed to get canvas context\"))\n          return\n        }\n\n        canvas.width = img.width\n        canvas.height = img.height\n        ctx.drawImage(img, 0, 0)\n\n        // JPEGã¨ã—ã¦å‡ºåŠ›ï¼ˆåœ§ç¸®ç‡0.8ï¼‰\n        const jpegBase64 = canvas.toDataURL(\"image/jpeg\", 0.8)\n        resolve(jpegBase64)\n      }\n      img.onerror = () => reject(new Error(\"Failed to load image\"))\n      img.src = base64\n    })\n  }\n\n  /**\n   * ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†\n   */\n  const getImageUrl = async (imageBase64: string): Promise<string> => {\n    try {\n      // JPEGã«å¤‰æ›\n      const jpegBase64 = await convertToJpeg(imageBase64)\n\n      // ãƒãƒƒã‚·ãƒ¥ã‚’è¨ˆç®—\n      const hash = await sha256(jpegBase64)\n\n      // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰å–å¾—ã‚’è©¦è¡Œ\n      if (imageUrlCache.has(hash)) {\n        const cachedUrl = imageUrlCache.get(hash)\n        if (cachedUrl) {\n          console.log(\"Using cached image URL:\", cachedUrl)\n          return cachedUrl\n        }\n      }\n\n      // æ–°ã—ã„ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰\n      console.log(\"Uploading new image...\")\n      const imageUrl = await uploadPublicImage(jpegBase64, props.token)\n      if (!imageUrl) {\n        throw new Error(\"Failed to upload image\")\n      }\n\n      // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜\n      imageUrlCache.set(hash, imageUrl)\n      return imageUrl\n    } catch (error) {\n      console.error(\"Failed to upload image:\", error)\n      throw error\n    }\n  }\n\n  const handleTitleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const value = event.target.value\n    setLocalTitle(value)\n\n    if (titleTimeoutRef.current) {\n      clearTimeout(titleTimeoutRef.current)\n    }\n\n    titleTimeoutRef.current = setTimeout(() => {\n      props.onTitleChange(value)\n    }, 300)\n  }\n\n  const handleCaptionChange = (\n    event: React.ChangeEvent<HTMLTextAreaElement>,\n  ) => {\n    const value = event.target.value\n    setLocalCaption(value)\n\n    if (captionTimeoutRef.current) {\n      clearTimeout(captionTimeoutRef.current)\n    }\n\n    captionTimeoutRef.current = setTimeout(() => {\n      props.onCaptionChange(value)\n    }, 300)\n  }\n\n  const handleGenerate = async () => {\n    if (!props.imageBase64) {\n      toast(t(\"ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„\", \"Please select an image\"))\n      return\n    }\n\n    if (!props.token) {\n      toast(t(\"ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™\", \"Login required\"))\n      return\n    }\n\n    // åˆ©ç”¨åˆ¶é™ãƒã‚§ãƒƒã‚¯\n    if (!canUseAiGeneration()) {\n      toast(\n        t(\n          \"1æ—¥ã®åˆ©ç”¨å›æ•°ä¸Šé™ï¼ˆ50å›ï¼‰ã«é”ã—ã¾ã—ãŸã€‚æ˜æ—¥ä»¥é™ã«ãŠè©¦ã—ãã ã•ã„ã€‚\",\n          \"Daily usage limit (50 times) reached. Please try again tomorrow.\",\n        ),\n      )\n      return\n    }\n\n    setIsLocalGenerating(true)\n    if (props.onGenerateStart) {\n      props.onGenerateStart()\n    }\n\n    try {\n      // åˆ©ç”¨å›æ•°ã‚’æ¶ˆè²»\n      if (!consumeAiGenerationUsage()) {\n        toast(\n          t(\n            \"1æ—¥ã®åˆ©ç”¨å›æ•°ä¸Šé™ï¼ˆ50å›ï¼‰ã«é”ã—ã¾ã—ãŸã€‚æ˜æ—¥ä»¥é™ã«ãŠè©¦ã—ãã ã•ã„ã€‚\",\n            \"Daily usage limit (50 times) reached. Please try again tomorrow.\",\n          ),\n        )\n        return\n      }\n\n      // ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ä»˜ãï¼‰\n      const imageUrl = await getImageUrl(props.imageBase64)\n\n      // å®Ÿéš›ã®GraphQL mutationã‚’å®Ÿè¡Œ\n      const result = await generateContent({\n        variables: {\n          input: {\n            imageUrl,\n            tagsOnly: false,\n            contentType,\n          },\n        },\n      })\n\n      const data = result.data?.generateImageContent\n      if (data) {\n        props.onContentGenerated(data)\n        toast(\n          t(\"ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã—ãŸ\", \"Content generated successfully\"),\n        )\n      } else {\n        throw new Error(\"No data returned from generation\")\n      }\n    } catch (error) {\n      console.error(\"Failed to generate content:\", error)\n      toast(t(\"è‡ªå‹•ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to generate content\"))\n    } finally {\n      setIsLocalGenerating(false)\n    }\n  }\n\n  // propsãŒæ›´æ–°ã•ã‚ŒãŸã‚‰localValueã‚‚æ›´æ–°ã™ã‚‹\n  useEffect(() => {\n    setLocalTitle(props.title || \"\")\n  }, [props.title])\n\n  useEffect(() => {\n    setLocalCaption(props.caption || \"\")\n  }, [props.caption])\n\n  // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—\n  useEffect(() => {\n    return () => {\n      if (titleTimeoutRef.current) {\n        clearTimeout(titleTimeoutRef.current)\n      }\n      if (captionTimeoutRef.current) {\n        clearTimeout(captionTimeoutRef.current)\n      }\n    }\n  }, [])\n\n  const isGenerating = isLocalGenerating || props.isGenerating\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-4 p-4\">\n        {/* ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ«ã¨è‡ªå‹•ç”Ÿæˆãƒœã‚¿ãƒ³ */}\n        <div className=\"flex items-center gap-2\">\n          <p className=\"font-bold text-sm\">\n            {t(\"ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆå¿…é ˆï¼‰ãƒ»ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³\", \"Title (Required) & Caption\")}\n          </p>\n          <div className=\"items-center gap-2 md:flex\">\n            <Collapsible open={isAdvancedOpen} onOpenChange={setIsAdvancedOpen}>\n              <CollapsibleTrigger asChild>\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"flex items-center gap-2\"\n                >\n                  <Settings className=\"h-4 w-4\" />\n                  <span>{t(\"è¨­å®š\", \"Settings\")}</span>\n                </Button>\n              </CollapsibleTrigger>\n              <CollapsibleContent className=\"absolute z-10 mt-2 rounded-lg border bg-card p-4 shadow-lg\">\n                <ContentTypeSelector\n                  value={contentType}\n                  onChange={setContentType}\n                />\n              </CollapsibleContent>\n            </Collapsible>\n            <Button\n              onClick={handleGenerate}\n              disabled={isGenerating || !props.imageBase64}\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"flex items-center gap-2\"\n            >\n              {isGenerating ? (\n                <Loader2Icon className=\"h-4 w-4 animate-spin\" />\n              ) : (\n                <Sparkles className=\"h-4 w-4\" />\n              )}\n              <span>\n                {isGenerating\n                  ? t(\"ç”Ÿæˆä¸­...\", \"Generating...\")\n                  : t(\"è‡ªå‹•ç”Ÿæˆï¼ˆã‚¿ã‚°å«ã‚€ï¼‰\", \"Auto Generate\")}\n              </span>\n            </Button>\n          </div>\n        </div>\n\n        {/* ã‚¿ã‚¤ãƒˆãƒ«å…¥åŠ›æ¬„ */}\n        <div className=\"space-y-2\">\n          <label\n            htmlFor=\"title-input\"\n            className=\"font-medium text-muted-foreground text-sm\"\n          >\n            {t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n          </label>\n          {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n          <Input\n            id=\"title-input\"\n            onChange={handleTitleChange}\n            value={localTitle}\n            minLength={1}\n            maxLength={120}\n            required\n            type=\"text\"\n            name=\"title\"\n            placeholder={t(\"ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Enter title\")}\n            className={cn(\"w-full\", {\n              \"border-green-500\": isTitleFilled,\n              \"border-gray-300\": !isTitleFilled,\n            })}\n          />\n        </div>\n\n        {/* ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³å…¥åŠ›æ¬„ */}\n        <div className=\"space-y-2\">\n          <label\n            htmlFor=\"caption-input\"\n            className=\"font-medium text-muted-foreground text-sm\"\n          >\n            {t(\"ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ï¼ˆä»»æ„ï¼‰\", \"Caption (Optional)\")}\n          </label>\n          {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n          <AutoResizeTextarea\n            id=\"caption-input\"\n            onChange={handleCaptionChange}\n            value={localCaption}\n            maxLength={3000}\n            placeholder={t(\"ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Enter caption\")}\n            className={cn(\"w-full\", {\n              \"border-green-500\": isCaptionFilled,\n              \"border-gray-300\": !isCaptionFilled,\n            })}\n          />\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-title-caption.tsx"},"span":[10769,10782],"sourceCode":"import { useState, useEffect, useRef } from \"react\"\nimport { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { Input } from \"~/components/ui/input\"\nimport { Button } from \"~/components/ui/button\"\nimport { Sparkles, Loader2Icon, Settings } from \"lucide-react\"\nimport { cn } from \"~/lib/utils\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { toast } from \"sonner\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { sha256 } from \"~/utils/sha256\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport {\n  canUseAiGeneration,\n  consumeAiGenerationUsage,\n} from \"../utils/ai-generation-usage\"\nimport { ContentTypeSelector } from \"./content-type-selector\"\nimport {\n  Collapsible,\n  CollapsibleContent,\n  CollapsibleTrigger,\n} from \"~/components/ui/collapsible\"\n\n// ç”»åƒURLã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆãƒ¡ãƒ¢ãƒªå†…ï¼‰\nconst imageUrlCache = new Map<string, string>()\n\n// GraphQL mutation - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã‚¹ã‚­ãƒ¼ãƒå®šç¾©å¾Œã«ä¿®æ­£äºˆå®š\nconst GenerateImageContentMutation = graphql(\n  `mutation GenerateImageContent($input: GenerateImageContentInput!) {\n    generateImageContent(input: $input) {\n      title\n      description\n      tags\n      titleEn\n      descriptionEn\n      tagsEn\n    }\n  }`,\n) as unknown as ReturnType<typeof graphql>\n\ntype Props = {\n  title: string\n  caption?: string\n  onTitleChange: (value: string) => void\n  onCaptionChange: (value: string) => void\n  // AIè‡ªå‹•ç”Ÿæˆãƒœã‚¿ãƒ³é–¢é€£ã®props\n  imageBase64: string | null\n  token: string | undefined | null\n  onContentGenerated: (data: {\n    title?: string\n    description?: string\n    tags?: string[]\n    titleEn?: string\n    descriptionEn?: string\n    tagsEn?: string[]\n  }) => void\n  isGenerating?: boolean\n  onGenerateStart?: () => void\n}\n\n/**\n * ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆå¿…é ˆï¼‰ãƒ»ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³çµ±åˆå…¥åŠ›ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ\n */\nexport function PostFormItemTitleCaption (props: Props) {\n  const t = useTranslation()\n  const [localTitle, setLocalTitle] = useState(props.title || \"\")\n  const [localCaption, setLocalCaption] = useState(props.caption || \"\")\n  const [isLocalGenerating, setIsLocalGenerating] = useState(false)\n  const [contentType, setContentType] = useState<\n    \"STORY\" | \"CHARACTER\" | \"STANDARD\"\n  >(\"STORY\")\n  const [isAdvancedOpen, setIsAdvancedOpen] = useState(false)\n\n  const [generateContent] = useMutation(GenerateImageContentMutation)\n\n  const titleTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null)\n  const captionTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null)\n\n  const isTitleFilled = localTitle.trim() !== \"\"\n  const isCaptionFilled = localCaption.trim() !== \"\"\n\n  /**\n   * JPEGã«å¤‰æ›ã™ã‚‹é–¢æ•°\n   */\n  const convertToJpeg = async (base64: string): Promise<string> => {\n    return new Promise((resolve, reject) => {\n      const img = new Image()\n      img.onload = () => {\n        const canvas = document.createElement(\"canvas\")\n        const ctx = canvas.getContext(\"2d\")\n        if (!ctx) {\n          reject(new Error(\"Failed to get canvas context\"))\n          return\n        }\n\n        canvas.width = img.width\n        canvas.height = img.height\n        ctx.drawImage(img, 0, 0)\n\n        // JPEGã¨ã—ã¦å‡ºåŠ›ï¼ˆåœ§ç¸®ç‡0.8ï¼‰\n        const jpegBase64 = canvas.toDataURL(\"image/jpeg\", 0.8)\n        resolve(jpegBase64)\n      }\n      img.onerror = () => reject(new Error(\"Failed to load image\"))\n      img.src = base64\n    })\n  }\n\n  /**\n   * ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†\n   */\n  const getImageUrl = async (imageBase64: string): Promise<string> => {\n    try {\n      // JPEGã«å¤‰æ›\n      const jpegBase64 = await convertToJpeg(imageBase64)\n\n      // ãƒãƒƒã‚·ãƒ¥ã‚’è¨ˆç®—\n      const hash = await sha256(jpegBase64)\n\n      // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰å–å¾—ã‚’è©¦è¡Œ\n      if (imageUrlCache.has(hash)) {\n        const cachedUrl = imageUrlCache.get(hash)\n        if (cachedUrl) {\n          console.log(\"Using cached image URL:\", cachedUrl)\n          return cachedUrl\n        }\n      }\n\n      // æ–°ã—ã„ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰\n      console.log(\"Uploading new image...\")\n      const imageUrl = await uploadPublicImage(jpegBase64, props.token)\n      if (!imageUrl) {\n        throw new Error(\"Failed to upload image\")\n      }\n\n      // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜\n      imageUrlCache.set(hash, imageUrl)\n      return imageUrl\n    } catch (error) {\n      console.error(\"Failed to upload image:\", error)\n      throw error\n    }\n  }\n\n  const handleTitleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const value = event.target.value\n    setLocalTitle(value)\n\n    if (titleTimeoutRef.current) {\n      clearTimeout(titleTimeoutRef.current)\n    }\n\n    titleTimeoutRef.current = setTimeout(() => {\n      props.onTitleChange(value)\n    }, 300)\n  }\n\n  const handleCaptionChange = (\n    event: React.ChangeEvent<HTMLTextAreaElement>,\n  ) => {\n    const value = event.target.value\n    setLocalCaption(value)\n\n    if (captionTimeoutRef.current) {\n      clearTimeout(captionTimeoutRef.current)\n    }\n\n    captionTimeoutRef.current = setTimeout(() => {\n      props.onCaptionChange(value)\n    }, 300)\n  }\n\n  const handleGenerate = async () => {\n    if (!props.imageBase64) {\n      toast(t(\"ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„\", \"Please select an image\"))\n      return\n    }\n\n    if (!props.token) {\n      toast(t(\"ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™\", \"Login required\"))\n      return\n    }\n\n    // åˆ©ç”¨åˆ¶é™ãƒã‚§ãƒƒã‚¯\n    if (!canUseAiGeneration()) {\n      toast(\n        t(\n          \"1æ—¥ã®åˆ©ç”¨å›æ•°ä¸Šé™ï¼ˆ50å›ï¼‰ã«é”ã—ã¾ã—ãŸã€‚æ˜æ—¥ä»¥é™ã«ãŠè©¦ã—ãã ã•ã„ã€‚\",\n          \"Daily usage limit (50 times) reached. Please try again tomorrow.\",\n        ),\n      )\n      return\n    }\n\n    setIsLocalGenerating(true)\n    if (props.onGenerateStart) {\n      props.onGenerateStart()\n    }\n\n    try {\n      // åˆ©ç”¨å›æ•°ã‚’æ¶ˆè²»\n      if (!consumeAiGenerationUsage()) {\n        toast(\n          t(\n            \"1æ—¥ã®åˆ©ç”¨å›æ•°ä¸Šé™ï¼ˆ50å›ï¼‰ã«é”ã—ã¾ã—ãŸã€‚æ˜æ—¥ä»¥é™ã«ãŠè©¦ã—ãã ã•ã„ã€‚\",\n            \"Daily usage limit (50 times) reached. Please try again tomorrow.\",\n          ),\n        )\n        return\n      }\n\n      // ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ä»˜ãï¼‰\n      const imageUrl = await getImageUrl(props.imageBase64)\n\n      // å®Ÿéš›ã®GraphQL mutationã‚’å®Ÿè¡Œ\n      const result = await generateContent({\n        variables: {\n          input: {\n            imageUrl,\n            tagsOnly: false,\n            contentType,\n          },\n        },\n      })\n\n      const data = result.data?.generateImageContent\n      if (data) {\n        props.onContentGenerated(data)\n        toast(\n          t(\"ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã—ãŸ\", \"Content generated successfully\"),\n        )\n      } else {\n        throw new Error(\"No data returned from generation\")\n      }\n    } catch (error) {\n      console.error(\"Failed to generate content:\", error)\n      toast(t(\"è‡ªå‹•ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to generate content\"))\n    } finally {\n      setIsLocalGenerating(false)\n    }\n  }\n\n  // propsãŒæ›´æ–°ã•ã‚ŒãŸã‚‰localValueã‚‚æ›´æ–°ã™ã‚‹\n  useEffect(() => {\n    setLocalTitle(props.title || \"\")\n  }, [props.title])\n\n  useEffect(() => {\n    setLocalCaption(props.caption || \"\")\n  }, [props.caption])\n\n  // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—\n  useEffect(() => {\n    return () => {\n      if (titleTimeoutRef.current) {\n        clearTimeout(titleTimeoutRef.current)\n      }\n      if (captionTimeoutRef.current) {\n        clearTimeout(captionTimeoutRef.current)\n      }\n    }\n  }, [])\n\n  const isGenerating = isLocalGenerating || props.isGenerating\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-4 p-4\">\n        {/* ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ«ã¨è‡ªå‹•ç”Ÿæˆãƒœã‚¿ãƒ³ */}\n        <div className=\"flex items-center gap-2\">\n          <p className=\"font-bold text-sm\">\n            {t(\"ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆå¿…é ˆï¼‰ãƒ»ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³\", \"Title (Required) & Caption\")}\n          </p>\n          <div className=\"items-center gap-2 md:flex\">\n            <Collapsible open={isAdvancedOpen} onOpenChange={setIsAdvancedOpen}>\n              <CollapsibleTrigger asChild>\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"flex items-center gap-2\"\n                >\n                  <Settings className=\"h-4 w-4\" />\n                  <span>{t(\"è¨­å®š\", \"Settings\")}</span>\n                </Button>\n              </CollapsibleTrigger>\n              <CollapsibleContent className=\"absolute z-10 mt-2 rounded-lg border bg-card p-4 shadow-lg\">\n                <ContentTypeSelector\n                  value={contentType}\n                  onChange={setContentType}\n                />\n              </CollapsibleContent>\n            </Collapsible>\n            <Button\n              onClick={handleGenerate}\n              disabled={isGenerating || !props.imageBase64}\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"flex items-center gap-2\"\n            >\n              {isGenerating ? (\n                <Loader2Icon className=\"h-4 w-4 animate-spin\" />\n              ) : (\n                <Sparkles className=\"h-4 w-4\" />\n              )}\n              <span>\n                {isGenerating\n                  ? t(\"ç”Ÿæˆä¸­...\", \"Generating...\")\n                  : t(\"è‡ªå‹•ç”Ÿæˆï¼ˆã‚¿ã‚°å«ã‚€ï¼‰\", \"Auto Generate\")}\n              </span>\n            </Button>\n          </div>\n        </div>\n\n        {/* ã‚¿ã‚¤ãƒˆãƒ«å…¥åŠ›æ¬„ */}\n        <div className=\"space-y-2\">\n          <label\n            htmlFor=\"title-input\"\n            className=\"font-medium text-muted-foreground text-sm\"\n          >\n            {t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n          </label>\n          {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n          <Input\n            id=\"title-input\"\n            onChange={handleTitleChange}\n            value={localTitle}\n            minLength={1}\n            maxLength={120}\n            required\n            type=\"text\"\n            name=\"title\"\n            placeholder={t(\"ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Enter title\")}\n            className={cn(\"w-full\", {\n              \"border-green-500\": isTitleFilled,\n              \"border-gray-300\": !isTitleFilled,\n            })}\n          />\n        </div>\n\n        {/* ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³å…¥åŠ›æ¬„ */}\n        <div className=\"space-y-2\">\n          <label\n            htmlFor=\"caption-input\"\n            className=\"font-medium text-muted-foreground text-sm\"\n          >\n            {t(\"ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ï¼ˆä»»æ„ï¼‰\", \"Caption (Optional)\")}\n          </label>\n          {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n          <AutoResizeTextarea\n            id=\"caption-input\"\n            onChange={handleCaptionChange}\n            value={localCaption}\n            maxLength={3000}\n            placeholder={t(\"ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Enter caption\")}\n            className={cn(\"w-full\", {\n              \"border-green-500\": isCaptionFilled,\n              \"border-gray-300\": !isCaptionFilled,\n            })}\n          />\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-video.tsx"},"span":[4990,5046],"sourceCode":"import { cn } from \"~/lib/utils\"\nimport { VideoItem } from \"~/routes/($lang)._main.new.image/components/video-item\"\nimport { useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { MAX_VIDEO_FILE_SIZE_BYTES, formatFileSize } from \"~/utils/file-size\"\n\ntype Props = {\n  videoFile: File | null\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onVideoChange(videoFile: File | null): void\n  isEnabledSelectVideo?: boolean\n  previewVideoUrl?: string\n}\n\n/**\n * å‹•ç”»é¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemVideo (props: Props) {\n  const t = useTranslation()\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_VIDEO_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(maxSize)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    if (props.setThumbnailBase64) {\n      props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n    }\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if (webpDataURL) {\n        const base64 = webpDataURL\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"video/mp4\": [\".mp4\", \".MP4\", \".Mp4\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (file.type === \"video/mp4\") {\n          if (file.size > maxSize) {\n            toast(\n              t(\n                `å‹•ç”»ã®ã‚µã‚¤ã‚ºã¯${maxSizeLabel}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„`,\n                `Video size should be under ${maxSizeLabel}`,\n              ),\n            )\n            return\n          }\n          const video = document.createElement(\"video\")\n\n          video.src = URL.createObjectURL(file)\n          video.onloadedmetadata = () => {\n            console.log(\"å‹•ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†:\", {\n              duration: video.duration,\n              videoWidth: video.videoWidth,\n              videoHeight: video.videoHeight,\n            })\n\n            if (video.duration > 12) {\n              toast(\n                t(\n                  \"å‹•ç”»ã¯12ç§’ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„\",\n                  \"Video length should be under 12 seconds\",\n                ),\n              )\n              return\n            }\n\n            props.onVideoChange(file)\n\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = video.videoWidth\n            canvas.height = video.videoHeight\n            const ctx = canvas.getContext(\"2d\")\n\n            if (!ctx) {\n              console.error(\"Canvas 2Dã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              toast(\"ã‚µãƒ ãƒã‚¤ãƒ«ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              return\n            }\n\n            const time = video.duration / 2\n            console.log(\"ã‚·ãƒ¼ã‚¯ã‚¿ã‚¤ãƒ è¨­å®š:\", time)\n            video.currentTime = time\n\n            video.onseeked = () => {\n              console.log(\"å‹•ç”»ã‚·ãƒ¼ã‚¯å®Œäº†ã€ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆé–‹å§‹\")\n              try {\n                ctx.drawImage(video, 0, 0, canvas.width, canvas.height)\n                const thumbnailUrl = canvas.toDataURL() // ã‚µãƒ ãƒã‚¤ãƒ«ã‚’DataURLå½¢å¼ã§å–å¾—\n                console.log(\n                  \"ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆå®Œäº†:\",\n                  `${thumbnailUrl.substring(0, 50)}...`,\n                )\n\n                updateThumbnail(thumbnailUrl)\n              } catch (error) {\n                console.error(\"ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆã‚¨ãƒ©ãƒ¼:\", error)\n                toast(\"ã‚µãƒ ãƒã‚¤ãƒ«ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              }\n            }\n\n            video.onerror = (error) => {\n              console.error(\"å‹•ç”»ã‚·ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼:\", error)\n              toast(\"å‹•ç”»ã®å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n            }\n          }\n\n          video.onerror = (error) => {\n            console.error(\"å‹•ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:\", error)\n            toast(\"å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n          }\n        }\n      })\n      const inputElement = document.getElementById(\n        \"video_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n          props.videoFile ? \"\" : \"rounded-b\",\n        )}\n      >\n        {(props.isEnabledSelectVideo === undefined ||\n          props.isEnabledSelectVideo) && (\n          <>\n            <input id=\"video_input\" {...getInputProps()} />\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"video_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              <p className=\"font-bold\">{t(\"å‹•ç”»ã‚’é¸æŠ\", \"Select Video\")}</p>\n            </div>\n            <div className=\"m-4 flex flex-col text-white\">\n              <p className=\"text-center text-sm\">{\"MP4\"}</p>\n              <p className=\"text-center text-sm\">\n                {t(\"12ç§’ã¾ã§\", \"Up to 12 seconds\")}\n              </p>\n            </div>\n          </>\n        )}\n        {props.videoFile && (\n          <VideoItem\n            videoFile={props.videoFile}\n            onDelete={() => {\n              props.onVideoChange(null)\n              updateThumbnail(null)\n            }}\n          />\n        )}\n        {props.previewVideoUrl && (\n          <video\n            controls\n            className=\"m-auto mt-4 mb-4 w-64\"\n            src={props.previewVideoUrl}\n          >\n            <track kind=\"captions\" src=\"path_to_captions.vtt\" label=\"English\" />\n          </video>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-video.tsx"},"span":[5185,5241],"sourceCode":"import { cn } from \"~/lib/utils\"\nimport { VideoItem } from \"~/routes/($lang)._main.new.image/components/video-item\"\nimport { useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { MAX_VIDEO_FILE_SIZE_BYTES, formatFileSize } from \"~/utils/file-size\"\n\ntype Props = {\n  videoFile: File | null\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onVideoChange(videoFile: File | null): void\n  isEnabledSelectVideo?: boolean\n  previewVideoUrl?: string\n}\n\n/**\n * å‹•ç”»é¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemVideo (props: Props) {\n  const t = useTranslation()\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_VIDEO_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(maxSize)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    if (props.setThumbnailBase64) {\n      props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n    }\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if (webpDataURL) {\n        const base64 = webpDataURL\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"video/mp4\": [\".mp4\", \".MP4\", \".Mp4\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (file.type === \"video/mp4\") {\n          if (file.size > maxSize) {\n            toast(\n              t(\n                `å‹•ç”»ã®ã‚µã‚¤ã‚ºã¯${maxSizeLabel}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„`,\n                `Video size should be under ${maxSizeLabel}`,\n              ),\n            )\n            return\n          }\n          const video = document.createElement(\"video\")\n\n          video.src = URL.createObjectURL(file)\n          video.onloadedmetadata = () => {\n            console.log(\"å‹•ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†:\", {\n              duration: video.duration,\n              videoWidth: video.videoWidth,\n              videoHeight: video.videoHeight,\n            })\n\n            if (video.duration > 12) {\n              toast(\n                t(\n                  \"å‹•ç”»ã¯12ç§’ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„\",\n                  \"Video length should be under 12 seconds\",\n                ),\n              )\n              return\n            }\n\n            props.onVideoChange(file)\n\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = video.videoWidth\n            canvas.height = video.videoHeight\n            const ctx = canvas.getContext(\"2d\")\n\n            if (!ctx) {\n              console.error(\"Canvas 2Dã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              toast(\"ã‚µãƒ ãƒã‚¤ãƒ«ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              return\n            }\n\n            const time = video.duration / 2\n            console.log(\"ã‚·ãƒ¼ã‚¯ã‚¿ã‚¤ãƒ è¨­å®š:\", time)\n            video.currentTime = time\n\n            video.onseeked = () => {\n              console.log(\"å‹•ç”»ã‚·ãƒ¼ã‚¯å®Œäº†ã€ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆé–‹å§‹\")\n              try {\n                ctx.drawImage(video, 0, 0, canvas.width, canvas.height)\n                const thumbnailUrl = canvas.toDataURL() // ã‚µãƒ ãƒã‚¤ãƒ«ã‚’DataURLå½¢å¼ã§å–å¾—\n                console.log(\n                  \"ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆå®Œäº†:\",\n                  `${thumbnailUrl.substring(0, 50)}...`,\n                )\n\n                updateThumbnail(thumbnailUrl)\n              } catch (error) {\n                console.error(\"ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆã‚¨ãƒ©ãƒ¼:\", error)\n                toast(\"ã‚µãƒ ãƒã‚¤ãƒ«ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              }\n            }\n\n            video.onerror = (error) => {\n              console.error(\"å‹•ç”»ã‚·ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼:\", error)\n              toast(\"å‹•ç”»ã®å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n            }\n          }\n\n          video.onerror = (error) => {\n            console.error(\"å‹•ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:\", error)\n            toast(\"å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n          }\n        }\n      })\n      const inputElement = document.getElementById(\n        \"video_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n          props.videoFile ? \"\" : \"rounded-b\",\n        )}\n      >\n        {(props.isEnabledSelectVideo === undefined ||\n          props.isEnabledSelectVideo) && (\n          <>\n            <input id=\"video_input\" {...getInputProps()} />\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"video_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              <p className=\"font-bold\">{t(\"å‹•ç”»ã‚’é¸æŠ\", \"Select Video\")}</p>\n            </div>\n            <div className=\"m-4 flex flex-col text-white\">\n              <p className=\"text-center text-sm\">{\"MP4\"}</p>\n              <p className=\"text-center text-sm\">\n                {t(\"12ç§’ã¾ã§\", \"Up to 12 seconds\")}\n              </p>\n            </div>\n          </>\n        )}\n        {props.videoFile && (\n          <VideoItem\n            videoFile={props.videoFile}\n            onDelete={() => {\n              props.onVideoChange(null)\n              updateThumbnail(null)\n            }}\n          />\n        )}\n        {props.previewVideoUrl && (\n          <video\n            controls\n            className=\"m-auto mt-4 mb-4 w-64\"\n            src={props.previewVideoUrl}\n          >\n            <track kind=\"captions\" src=\"path_to_captions.vtt\" label=\"English\" />\n          </video>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-video.tsx"},"span":[2066,2079],"sourceCode":"import { cn } from \"~/lib/utils\"\nimport { VideoItem } from \"~/routes/($lang)._main.new.image/components/video-item\"\nimport { useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { MAX_VIDEO_FILE_SIZE_BYTES, formatFileSize } from \"~/utils/file-size\"\n\ntype Props = {\n  videoFile: File | null\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onVideoChange(videoFile: File | null): void\n  isEnabledSelectVideo?: boolean\n  previewVideoUrl?: string\n}\n\n/**\n * å‹•ç”»é¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemVideo (props: Props) {\n  const t = useTranslation()\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_VIDEO_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(maxSize)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    if (props.setThumbnailBase64) {\n      props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n    }\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if (webpDataURL) {\n        const base64 = webpDataURL\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"video/mp4\": [\".mp4\", \".MP4\", \".Mp4\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (file.type === \"video/mp4\") {\n          if (file.size > maxSize) {\n            toast(\n              t(\n                `å‹•ç”»ã®ã‚µã‚¤ã‚ºã¯${maxSizeLabel}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„`,\n                `Video size should be under ${maxSizeLabel}`,\n              ),\n            )\n            return\n          }\n          const video = document.createElement(\"video\")\n\n          video.src = URL.createObjectURL(file)\n          video.onloadedmetadata = () => {\n            console.log(\"å‹•ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†:\", {\n              duration: video.duration,\n              videoWidth: video.videoWidth,\n              videoHeight: video.videoHeight,\n            })\n\n            if (video.duration > 12) {\n              toast(\n                t(\n                  \"å‹•ç”»ã¯12ç§’ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„\",\n                  \"Video length should be under 12 seconds\",\n                ),\n              )\n              return\n            }\n\n            props.onVideoChange(file)\n\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = video.videoWidth\n            canvas.height = video.videoHeight\n            const ctx = canvas.getContext(\"2d\")\n\n            if (!ctx) {\n              console.error(\"Canvas 2Dã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              toast(\"ã‚µãƒ ãƒã‚¤ãƒ«ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              return\n            }\n\n            const time = video.duration / 2\n            console.log(\"ã‚·ãƒ¼ã‚¯ã‚¿ã‚¤ãƒ è¨­å®š:\", time)\n            video.currentTime = time\n\n            video.onseeked = () => {\n              console.log(\"å‹•ç”»ã‚·ãƒ¼ã‚¯å®Œäº†ã€ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆé–‹å§‹\")\n              try {\n                ctx.drawImage(video, 0, 0, canvas.width, canvas.height)\n                const thumbnailUrl = canvas.toDataURL() // ã‚µãƒ ãƒã‚¤ãƒ«ã‚’DataURLå½¢å¼ã§å–å¾—\n                console.log(\n                  \"ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆå®Œäº†:\",\n                  `${thumbnailUrl.substring(0, 50)}...`,\n                )\n\n                updateThumbnail(thumbnailUrl)\n              } catch (error) {\n                console.error(\"ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆã‚¨ãƒ©ãƒ¼:\", error)\n                toast(\"ã‚µãƒ ãƒã‚¤ãƒ«ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              }\n            }\n\n            video.onerror = (error) => {\n              console.error(\"å‹•ç”»ã‚·ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼:\", error)\n              toast(\"å‹•ç”»ã®å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n            }\n          }\n\n          video.onerror = (error) => {\n            console.error(\"å‹•ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:\", error)\n            toast(\"å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n          }\n        }\n      })\n      const inputElement = document.getElementById(\n        \"video_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n          props.videoFile ? \"\" : \"rounded-b\",\n        )}\n      >\n        {(props.isEnabledSelectVideo === undefined ||\n          props.isEnabledSelectVideo) && (\n          <>\n            <input id=\"video_input\" {...getInputProps()} />\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"video_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              <p className=\"font-bold\">{t(\"å‹•ç”»ã‚’é¸æŠ\", \"Select Video\")}</p>\n            </div>\n            <div className=\"m-4 flex flex-col text-white\">\n              <p className=\"text-center text-sm\">{\"MP4\"}</p>\n              <p className=\"text-center text-sm\">\n                {t(\"12ç§’ã¾ã§\", \"Up to 12 seconds\")}\n              </p>\n            </div>\n          </>\n        )}\n        {props.videoFile && (\n          <VideoItem\n            videoFile={props.videoFile}\n            onDelete={() => {\n              props.onVideoChange(null)\n              updateThumbnail(null)\n            }}\n          />\n        )}\n        {props.previewVideoUrl && (\n          <video\n            controls\n            className=\"m-auto mt-4 mb-4 w-64\"\n            src={props.previewVideoUrl}\n          >\n            <track kind=\"captions\" src=\"path_to_captions.vtt\" label=\"English\" />\n          </video>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-video.tsx"},"span":[5033,5046],"sourceCode":"import { cn } from \"~/lib/utils\"\nimport { VideoItem } from \"~/routes/($lang)._main.new.image/components/video-item\"\nimport { useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { MAX_VIDEO_FILE_SIZE_BYTES, formatFileSize } from \"~/utils/file-size\"\n\ntype Props = {\n  videoFile: File | null\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onVideoChange(videoFile: File | null): void\n  isEnabledSelectVideo?: boolean\n  previewVideoUrl?: string\n}\n\n/**\n * å‹•ç”»é¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemVideo (props: Props) {\n  const t = useTranslation()\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_VIDEO_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(maxSize)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    if (props.setThumbnailBase64) {\n      props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n    }\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if (webpDataURL) {\n        const base64 = webpDataURL\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"video/mp4\": [\".mp4\", \".MP4\", \".Mp4\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (file.type === \"video/mp4\") {\n          if (file.size > maxSize) {\n            toast(\n              t(\n                `å‹•ç”»ã®ã‚µã‚¤ã‚ºã¯${maxSizeLabel}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„`,\n                `Video size should be under ${maxSizeLabel}`,\n              ),\n            )\n            return\n          }\n          const video = document.createElement(\"video\")\n\n          video.src = URL.createObjectURL(file)\n          video.onloadedmetadata = () => {\n            console.log(\"å‹•ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†:\", {\n              duration: video.duration,\n              videoWidth: video.videoWidth,\n              videoHeight: video.videoHeight,\n            })\n\n            if (video.duration > 12) {\n              toast(\n                t(\n                  \"å‹•ç”»ã¯12ç§’ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„\",\n                  \"Video length should be under 12 seconds\",\n                ),\n              )\n              return\n            }\n\n            props.onVideoChange(file)\n\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = video.videoWidth\n            canvas.height = video.videoHeight\n            const ctx = canvas.getContext(\"2d\")\n\n            if (!ctx) {\n              console.error(\"Canvas 2Dã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              toast(\"ã‚µãƒ ãƒã‚¤ãƒ«ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              return\n            }\n\n            const time = video.duration / 2\n            console.log(\"ã‚·ãƒ¼ã‚¯ã‚¿ã‚¤ãƒ è¨­å®š:\", time)\n            video.currentTime = time\n\n            video.onseeked = () => {\n              console.log(\"å‹•ç”»ã‚·ãƒ¼ã‚¯å®Œäº†ã€ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆé–‹å§‹\")\n              try {\n                ctx.drawImage(video, 0, 0, canvas.width, canvas.height)\n                const thumbnailUrl = canvas.toDataURL() // ã‚µãƒ ãƒã‚¤ãƒ«ã‚’DataURLå½¢å¼ã§å–å¾—\n                console.log(\n                  \"ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆå®Œäº†:\",\n                  `${thumbnailUrl.substring(0, 50)}...`,\n                )\n\n                updateThumbnail(thumbnailUrl)\n              } catch (error) {\n                console.error(\"ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆã‚¨ãƒ©ãƒ¼:\", error)\n                toast(\"ã‚µãƒ ãƒã‚¤ãƒ«ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              }\n            }\n\n            video.onerror = (error) => {\n              console.error(\"å‹•ç”»ã‚·ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼:\", error)\n              toast(\"å‹•ç”»ã®å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n            }\n          }\n\n          video.onerror = (error) => {\n            console.error(\"å‹•ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:\", error)\n            toast(\"å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n          }\n        }\n      })\n      const inputElement = document.getElementById(\n        \"video_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n          props.videoFile ? \"\" : \"rounded-b\",\n        )}\n      >\n        {(props.isEnabledSelectVideo === undefined ||\n          props.isEnabledSelectVideo) && (\n          <>\n            <input id=\"video_input\" {...getInputProps()} />\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"video_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              <p className=\"font-bold\">{t(\"å‹•ç”»ã‚’é¸æŠ\", \"Select Video\")}</p>\n            </div>\n            <div className=\"m-4 flex flex-col text-white\">\n              <p className=\"text-center text-sm\">{\"MP4\"}</p>\n              <p className=\"text-center text-sm\">\n                {t(\"12ç§’ã¾ã§\", \"Up to 12 seconds\")}\n              </p>\n            </div>\n          </>\n        )}\n        {props.videoFile && (\n          <VideoItem\n            videoFile={props.videoFile}\n            onDelete={() => {\n              props.onVideoChange(null)\n              updateThumbnail(null)\n            }}\n          />\n        )}\n        {props.previewVideoUrl && (\n          <video\n            controls\n            className=\"m-auto mt-4 mb-4 w-64\"\n            src={props.previewVideoUrl}\n          >\n            <track kind=\"captions\" src=\"path_to_captions.vtt\" label=\"English\" />\n          </video>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-video.tsx"},"span":[5228,5241],"sourceCode":"import { cn } from \"~/lib/utils\"\nimport { VideoItem } from \"~/routes/($lang)._main.new.image/components/video-item\"\nimport { useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { MAX_VIDEO_FILE_SIZE_BYTES, formatFileSize } from \"~/utils/file-size\"\n\ntype Props = {\n  videoFile: File | null\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onVideoChange(videoFile: File | null): void\n  isEnabledSelectVideo?: boolean\n  previewVideoUrl?: string\n}\n\n/**\n * å‹•ç”»é¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemVideo (props: Props) {\n  const t = useTranslation()\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_VIDEO_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(maxSize)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    if (props.setThumbnailBase64) {\n      props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n    }\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if (webpDataURL) {\n        const base64 = webpDataURL\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"video/mp4\": [\".mp4\", \".MP4\", \".Mp4\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (file.type === \"video/mp4\") {\n          if (file.size > maxSize) {\n            toast(\n              t(\n                `å‹•ç”»ã®ã‚µã‚¤ã‚ºã¯${maxSizeLabel}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„`,\n                `Video size should be under ${maxSizeLabel}`,\n              ),\n            )\n            return\n          }\n          const video = document.createElement(\"video\")\n\n          video.src = URL.createObjectURL(file)\n          video.onloadedmetadata = () => {\n            console.log(\"å‹•ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†:\", {\n              duration: video.duration,\n              videoWidth: video.videoWidth,\n              videoHeight: video.videoHeight,\n            })\n\n            if (video.duration > 12) {\n              toast(\n                t(\n                  \"å‹•ç”»ã¯12ç§’ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„\",\n                  \"Video length should be under 12 seconds\",\n                ),\n              )\n              return\n            }\n\n            props.onVideoChange(file)\n\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = video.videoWidth\n            canvas.height = video.videoHeight\n            const ctx = canvas.getContext(\"2d\")\n\n            if (!ctx) {\n              console.error(\"Canvas 2Dã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              toast(\"ã‚µãƒ ãƒã‚¤ãƒ«ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              return\n            }\n\n            const time = video.duration / 2\n            console.log(\"ã‚·ãƒ¼ã‚¯ã‚¿ã‚¤ãƒ è¨­å®š:\", time)\n            video.currentTime = time\n\n            video.onseeked = () => {\n              console.log(\"å‹•ç”»ã‚·ãƒ¼ã‚¯å®Œäº†ã€ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆé–‹å§‹\")\n              try {\n                ctx.drawImage(video, 0, 0, canvas.width, canvas.height)\n                const thumbnailUrl = canvas.toDataURL() // ã‚µãƒ ãƒã‚¤ãƒ«ã‚’DataURLå½¢å¼ã§å–å¾—\n                console.log(\n                  \"ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆå®Œäº†:\",\n                  `${thumbnailUrl.substring(0, 50)}...`,\n                )\n\n                updateThumbnail(thumbnailUrl)\n              } catch (error) {\n                console.error(\"ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆã‚¨ãƒ©ãƒ¼:\", error)\n                toast(\"ã‚µãƒ ãƒã‚¤ãƒ«ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              }\n            }\n\n            video.onerror = (error) => {\n              console.error(\"å‹•ç”»ã‚·ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼:\", error)\n              toast(\"å‹•ç”»ã®å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n            }\n          }\n\n          video.onerror = (error) => {\n            console.error(\"å‹•ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:\", error)\n            toast(\"å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n          }\n        }\n      })\n      const inputElement = document.getElementById(\n        \"video_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n          props.videoFile ? \"\" : \"rounded-b\",\n        )}\n      >\n        {(props.isEnabledSelectVideo === undefined ||\n          props.isEnabledSelectVideo) && (\n          <>\n            <input id=\"video_input\" {...getInputProps()} />\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"video_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              <p className=\"font-bold\">{t(\"å‹•ç”»ã‚’é¸æŠ\", \"Select Video\")}</p>\n            </div>\n            <div className=\"m-4 flex flex-col text-white\">\n              <p className=\"text-center text-sm\">{\"MP4\"}</p>\n              <p className=\"text-center text-sm\">\n                {t(\"12ç§’ã¾ã§\", \"Up to 12 seconds\")}\n              </p>\n            </div>\n          </>\n        )}\n        {props.videoFile && (\n          <VideoItem\n            videoFile={props.videoFile}\n            onDelete={() => {\n              props.onVideoChange(null)\n              updateThumbnail(null)\n            }}\n          />\n        )}\n        {props.previewVideoUrl && (\n          <video\n            controls\n            className=\"m-auto mt-4 mb-4 w-64\"\n            src={props.previewVideoUrl}\n          >\n            <track kind=\"captions\" src=\"path_to_captions.vtt\" label=\"English\" />\n          </video>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-video.tsx"},"span":[6072,6085],"sourceCode":"import { cn } from \"~/lib/utils\"\nimport { VideoItem } from \"~/routes/($lang)._main.new.image/components/video-item\"\nimport { useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { MAX_VIDEO_FILE_SIZE_BYTES, formatFileSize } from \"~/utils/file-size\"\n\ntype Props = {\n  videoFile: File | null\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onVideoChange(videoFile: File | null): void\n  isEnabledSelectVideo?: boolean\n  previewVideoUrl?: string\n}\n\n/**\n * å‹•ç”»é¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemVideo (props: Props) {\n  const t = useTranslation()\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_VIDEO_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(maxSize)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    if (props.setThumbnailBase64) {\n      props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n    }\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if (webpDataURL) {\n        const base64 = webpDataURL\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"video/mp4\": [\".mp4\", \".MP4\", \".Mp4\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (file.type === \"video/mp4\") {\n          if (file.size > maxSize) {\n            toast(\n              t(\n                `å‹•ç”»ã®ã‚µã‚¤ã‚ºã¯${maxSizeLabel}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„`,\n                `Video size should be under ${maxSizeLabel}`,\n              ),\n            )\n            return\n          }\n          const video = document.createElement(\"video\")\n\n          video.src = URL.createObjectURL(file)\n          video.onloadedmetadata = () => {\n            console.log(\"å‹•ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†:\", {\n              duration: video.duration,\n              videoWidth: video.videoWidth,\n              videoHeight: video.videoHeight,\n            })\n\n            if (video.duration > 12) {\n              toast(\n                t(\n                  \"å‹•ç”»ã¯12ç§’ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„\",\n                  \"Video length should be under 12 seconds\",\n                ),\n              )\n              return\n            }\n\n            props.onVideoChange(file)\n\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = video.videoWidth\n            canvas.height = video.videoHeight\n            const ctx = canvas.getContext(\"2d\")\n\n            if (!ctx) {\n              console.error(\"Canvas 2Dã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              toast(\"ã‚µãƒ ãƒã‚¤ãƒ«ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              return\n            }\n\n            const time = video.duration / 2\n            console.log(\"ã‚·ãƒ¼ã‚¯ã‚¿ã‚¤ãƒ è¨­å®š:\", time)\n            video.currentTime = time\n\n            video.onseeked = () => {\n              console.log(\"å‹•ç”»ã‚·ãƒ¼ã‚¯å®Œäº†ã€ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆé–‹å§‹\")\n              try {\n                ctx.drawImage(video, 0, 0, canvas.width, canvas.height)\n                const thumbnailUrl = canvas.toDataURL() // ã‚µãƒ ãƒã‚¤ãƒ«ã‚’DataURLå½¢å¼ã§å–å¾—\n                console.log(\n                  \"ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆå®Œäº†:\",\n                  `${thumbnailUrl.substring(0, 50)}...`,\n                )\n\n                updateThumbnail(thumbnailUrl)\n              } catch (error) {\n                console.error(\"ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆã‚¨ãƒ©ãƒ¼:\", error)\n                toast(\"ã‚µãƒ ãƒã‚¤ãƒ«ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              }\n            }\n\n            video.onerror = (error) => {\n              console.error(\"å‹•ç”»ã‚·ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼:\", error)\n              toast(\"å‹•ç”»ã®å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n            }\n          }\n\n          video.onerror = (error) => {\n            console.error(\"å‹•ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:\", error)\n            toast(\"å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n          }\n        }\n      })\n      const inputElement = document.getElementById(\n        \"video_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n          props.videoFile ? \"\" : \"rounded-b\",\n        )}\n      >\n        {(props.isEnabledSelectVideo === undefined ||\n          props.isEnabledSelectVideo) && (\n          <>\n            <input id=\"video_input\" {...getInputProps()} />\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"video_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              <p className=\"font-bold\">{t(\"å‹•ç”»ã‚’é¸æŠ\", \"Select Video\")}</p>\n            </div>\n            <div className=\"m-4 flex flex-col text-white\">\n              <p className=\"text-center text-sm\">{\"MP4\"}</p>\n              <p className=\"text-center text-sm\">\n                {t(\"12ç§’ã¾ã§\", \"Up to 12 seconds\")}\n              </p>\n            </div>\n          </>\n        )}\n        {props.videoFile && (\n          <VideoItem\n            videoFile={props.videoFile}\n            onDelete={() => {\n              props.onVideoChange(null)\n              updateThumbnail(null)\n            }}\n          />\n        )}\n        {props.previewVideoUrl && (\n          <video\n            controls\n            className=\"m-auto mt-4 mb-4 w-64\"\n            src={props.previewVideoUrl}\n          >\n            <track kind=\"captions\" src=\"path_to_captions.vtt\" label=\"English\" />\n          </video>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-video.tsx"},"span":[5959,6006],"sourceCode":"import { cn } from \"~/lib/utils\"\nimport { VideoItem } from \"~/routes/($lang)._main.new.image/components/video-item\"\nimport { useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { MAX_VIDEO_FILE_SIZE_BYTES, formatFileSize } from \"~/utils/file-size\"\n\ntype Props = {\n  videoFile: File | null\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onVideoChange(videoFile: File | null): void\n  isEnabledSelectVideo?: boolean\n  previewVideoUrl?: string\n}\n\n/**\n * å‹•ç”»é¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemVideo (props: Props) {\n  const t = useTranslation()\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_VIDEO_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(maxSize)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    if (props.setThumbnailBase64) {\n      props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n    }\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if (webpDataURL) {\n        const base64 = webpDataURL\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"video/mp4\": [\".mp4\", \".MP4\", \".Mp4\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (file.type === \"video/mp4\") {\n          if (file.size > maxSize) {\n            toast(\n              t(\n                `å‹•ç”»ã®ã‚µã‚¤ã‚ºã¯${maxSizeLabel}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„`,\n                `Video size should be under ${maxSizeLabel}`,\n              ),\n            )\n            return\n          }\n          const video = document.createElement(\"video\")\n\n          video.src = URL.createObjectURL(file)\n          video.onloadedmetadata = () => {\n            console.log(\"å‹•ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†:\", {\n              duration: video.duration,\n              videoWidth: video.videoWidth,\n              videoHeight: video.videoHeight,\n            })\n\n            if (video.duration > 12) {\n              toast(\n                t(\n                  \"å‹•ç”»ã¯12ç§’ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„\",\n                  \"Video length should be under 12 seconds\",\n                ),\n              )\n              return\n            }\n\n            props.onVideoChange(file)\n\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = video.videoWidth\n            canvas.height = video.videoHeight\n            const ctx = canvas.getContext(\"2d\")\n\n            if (!ctx) {\n              console.error(\"Canvas 2Dã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              toast(\"ã‚µãƒ ãƒã‚¤ãƒ«ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              return\n            }\n\n            const time = video.duration / 2\n            console.log(\"ã‚·ãƒ¼ã‚¯ã‚¿ã‚¤ãƒ è¨­å®š:\", time)\n            video.currentTime = time\n\n            video.onseeked = () => {\n              console.log(\"å‹•ç”»ã‚·ãƒ¼ã‚¯å®Œäº†ã€ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆé–‹å§‹\")\n              try {\n                ctx.drawImage(video, 0, 0, canvas.width, canvas.height)\n                const thumbnailUrl = canvas.toDataURL() // ã‚µãƒ ãƒã‚¤ãƒ«ã‚’DataURLå½¢å¼ã§å–å¾—\n                console.log(\n                  \"ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆå®Œäº†:\",\n                  `${thumbnailUrl.substring(0, 50)}...`,\n                )\n\n                updateThumbnail(thumbnailUrl)\n              } catch (error) {\n                console.error(\"ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆã‚¨ãƒ©ãƒ¼:\", error)\n                toast(\"ã‚µãƒ ãƒã‚¤ãƒ«ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              }\n            }\n\n            video.onerror = (error) => {\n              console.error(\"å‹•ç”»ã‚·ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼:\", error)\n              toast(\"å‹•ç”»ã®å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n            }\n          }\n\n          video.onerror = (error) => {\n            console.error(\"å‹•ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:\", error)\n            toast(\"å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n          }\n        }\n      })\n      const inputElement = document.getElementById(\n        \"video_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n          props.videoFile ? \"\" : \"rounded-b\",\n        )}\n      >\n        {(props.isEnabledSelectVideo === undefined ||\n          props.isEnabledSelectVideo) && (\n          <>\n            <input id=\"video_input\" {...getInputProps()} />\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"video_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              <p className=\"font-bold\">{t(\"å‹•ç”»ã‚’é¸æŠ\", \"Select Video\")}</p>\n            </div>\n            <div className=\"m-4 flex flex-col text-white\">\n              <p className=\"text-center text-sm\">{\"MP4\"}</p>\n              <p className=\"text-center text-sm\">\n                {t(\"12ç§’ã¾ã§\", \"Up to 12 seconds\")}\n              </p>\n            </div>\n          </>\n        )}\n        {props.videoFile && (\n          <VideoItem\n            videoFile={props.videoFile}\n            onDelete={() => {\n              props.onVideoChange(null)\n              updateThumbnail(null)\n            }}\n          />\n        )}\n        {props.previewVideoUrl && (\n          <video\n            controls\n            className=\"m-auto mt-4 mb-4 w-64\"\n            src={props.previewVideoUrl}\n          >\n            <track kind=\"captions\" src=\"path_to_captions.vtt\" label=\"English\" />\n          </video>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-video.tsx"},"span":[2023,2079],"sourceCode":"import { cn } from \"~/lib/utils\"\nimport { VideoItem } from \"~/routes/($lang)._main.new.image/components/video-item\"\nimport { useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { MAX_VIDEO_FILE_SIZE_BYTES, formatFileSize } from \"~/utils/file-size\"\n\ntype Props = {\n  videoFile: File | null\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onVideoChange(videoFile: File | null): void\n  isEnabledSelectVideo?: boolean\n  previewVideoUrl?: string\n}\n\n/**\n * å‹•ç”»é¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemVideo (props: Props) {\n  const t = useTranslation()\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_VIDEO_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(maxSize)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    if (props.setThumbnailBase64) {\n      props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n    }\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if (webpDataURL) {\n        const base64 = webpDataURL\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"video/mp4\": [\".mp4\", \".MP4\", \".Mp4\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (file.type === \"video/mp4\") {\n          if (file.size > maxSize) {\n            toast(\n              t(\n                `å‹•ç”»ã®ã‚µã‚¤ã‚ºã¯${maxSizeLabel}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„`,\n                `Video size should be under ${maxSizeLabel}`,\n              ),\n            )\n            return\n          }\n          const video = document.createElement(\"video\")\n\n          video.src = URL.createObjectURL(file)\n          video.onloadedmetadata = () => {\n            console.log(\"å‹•ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†:\", {\n              duration: video.duration,\n              videoWidth: video.videoWidth,\n              videoHeight: video.videoHeight,\n            })\n\n            if (video.duration > 12) {\n              toast(\n                t(\n                  \"å‹•ç”»ã¯12ç§’ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„\",\n                  \"Video length should be under 12 seconds\",\n                ),\n              )\n              return\n            }\n\n            props.onVideoChange(file)\n\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = video.videoWidth\n            canvas.height = video.videoHeight\n            const ctx = canvas.getContext(\"2d\")\n\n            if (!ctx) {\n              console.error(\"Canvas 2Dã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              toast(\"ã‚µãƒ ãƒã‚¤ãƒ«ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              return\n            }\n\n            const time = video.duration / 2\n            console.log(\"ã‚·ãƒ¼ã‚¯ã‚¿ã‚¤ãƒ è¨­å®š:\", time)\n            video.currentTime = time\n\n            video.onseeked = () => {\n              console.log(\"å‹•ç”»ã‚·ãƒ¼ã‚¯å®Œäº†ã€ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆé–‹å§‹\")\n              try {\n                ctx.drawImage(video, 0, 0, canvas.width, canvas.height)\n                const thumbnailUrl = canvas.toDataURL() // ã‚µãƒ ãƒã‚¤ãƒ«ã‚’DataURLå½¢å¼ã§å–å¾—\n                console.log(\n                  \"ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆå®Œäº†:\",\n                  `${thumbnailUrl.substring(0, 50)}...`,\n                )\n\n                updateThumbnail(thumbnailUrl)\n              } catch (error) {\n                console.error(\"ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆã‚¨ãƒ©ãƒ¼:\", error)\n                toast(\"ã‚µãƒ ãƒã‚¤ãƒ«ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              }\n            }\n\n            video.onerror = (error) => {\n              console.error(\"å‹•ç”»ã‚·ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼:\", error)\n              toast(\"å‹•ç”»ã®å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n            }\n          }\n\n          video.onerror = (error) => {\n            console.error(\"å‹•ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:\", error)\n            toast(\"å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n          }\n        }\n      })\n      const inputElement = document.getElementById(\n        \"video_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n          props.videoFile ? \"\" : \"rounded-b\",\n        )}\n      >\n        {(props.isEnabledSelectVideo === undefined ||\n          props.isEnabledSelectVideo) && (\n          <>\n            <input id=\"video_input\" {...getInputProps()} />\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"video_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              <p className=\"font-bold\">{t(\"å‹•ç”»ã‚’é¸æŠ\", \"Select Video\")}</p>\n            </div>\n            <div className=\"m-4 flex flex-col text-white\">\n              <p className=\"text-center text-sm\">{\"MP4\"}</p>\n              <p className=\"text-center text-sm\">\n                {t(\"12ç§’ã¾ã§\", \"Up to 12 seconds\")}\n              </p>\n            </div>\n          </>\n        )}\n        {props.videoFile && (\n          <VideoItem\n            videoFile={props.videoFile}\n            onDelete={() => {\n              props.onVideoChange(null)\n              updateThumbnail(null)\n            }}\n          />\n        )}\n        {props.previewVideoUrl && (\n          <video\n            controls\n            className=\"m-auto mt-4 mb-4 w-64\"\n            src={props.previewVideoUrl}\n          >\n            <track kind=\"captions\" src=\"path_to_captions.vtt\" label=\"English\" />\n          </video>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-view.tsx"},"span":[1014,1064],"sourceCode":"import { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  accessType: IntrospectionEnum<\"AccessType\">\n  setAccessType: (value: IntrospectionEnum<\"AccessType\">) => void\n}\n\n/**\n * å…¬é–‹ãƒ¢ãƒ¼ãƒ‰å…¥åŠ›\n */\nexport function PostFormItemView (props: Props) {\n  const t = useTranslation()\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-2 p-4\">\n        <p className=\"font-bold text-sm\">{t(\"å…¬é–‹ãƒ¢ãƒ¼ãƒ‰\", \"Access Mode\")}</p>\n        <RadioGroup\n          value={props.accessType}\n          onValueChange={(value) => {\n            props.setAccessType(value as IntrospectionEnum<\"AccessType\">)\n          }}\n          className=\"flex flex-wrap space-x-0 md:space-x-4\"\n        >\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"PUBLIC\" id=\"view-public\" />\n              <label\n                htmlFor=\"view-public\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"å…¬é–‹\", \"Public\")}\n              </label>\n            </div>\n          </div>\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"PRIVATE\" id=\"view-archive\" />\n              <label\n                htmlFor=\"view-archive\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"éå…¬é–‹\", \"Private\")}\n              </label>\n            </div>\n          </div>\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"LIMITED\" id=\"view-limited\" />\n              <label\n                htmlFor=\"view-limited\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"é™å®šå…¬é–‹\", \"Limited\")}\n              </label>\n            </div>\n          </div>\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"SILENT\" id=\"view-silent\" />\n              <label\n                htmlFor=\"view-silent\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"æ–°ç€éå…¬é–‹\", \"Silent\")}\n              </label>\n            </div>\n          </div>\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"DRAFT\" id=\"view-draft\" />\n              <label\n                htmlFor=\"view-draft\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"ä¸‹æ›¸ã\", \"Draft\")}\n              </label>\n            </div>\n          </div>\n        </RadioGroup>\n      </CardContent>\n    </Card>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-view.tsx"},"span":[1411,1463],"sourceCode":"import { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  accessType: IntrospectionEnum<\"AccessType\">\n  setAccessType: (value: IntrospectionEnum<\"AccessType\">) => void\n}\n\n/**\n * å…¬é–‹ãƒ¢ãƒ¼ãƒ‰å…¥åŠ›\n */\nexport function PostFormItemView (props: Props) {\n  const t = useTranslation()\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-2 p-4\">\n        <p className=\"font-bold text-sm\">{t(\"å…¬é–‹ãƒ¢ãƒ¼ãƒ‰\", \"Access Mode\")}</p>\n        <RadioGroup\n          value={props.accessType}\n          onValueChange={(value) => {\n            props.setAccessType(value as IntrospectionEnum<\"AccessType\">)\n          }}\n          className=\"flex flex-wrap space-x-0 md:space-x-4\"\n        >\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"PUBLIC\" id=\"view-public\" />\n              <label\n                htmlFor=\"view-public\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"å…¬é–‹\", \"Public\")}\n              </label>\n            </div>\n          </div>\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"PRIVATE\" id=\"view-archive\" />\n              <label\n                htmlFor=\"view-archive\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"éå…¬é–‹\", \"Private\")}\n              </label>\n            </div>\n          </div>\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"LIMITED\" id=\"view-limited\" />\n              <label\n                htmlFor=\"view-limited\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"é™å®šå…¬é–‹\", \"Limited\")}\n              </label>\n            </div>\n          </div>\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"SILENT\" id=\"view-silent\" />\n              <label\n                htmlFor=\"view-silent\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"æ–°ç€éå…¬é–‹\", \"Silent\")}\n              </label>\n            </div>\n          </div>\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"DRAFT\" id=\"view-draft\" />\n              <label\n                htmlFor=\"view-draft\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"ä¸‹æ›¸ã\", \"Draft\")}\n              </label>\n            </div>\n          </div>\n        </RadioGroup>\n      </CardContent>\n    </Card>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-view.tsx"},"span":[1815,1867],"sourceCode":"import { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  accessType: IntrospectionEnum<\"AccessType\">\n  setAccessType: (value: IntrospectionEnum<\"AccessType\">) => void\n}\n\n/**\n * å…¬é–‹ãƒ¢ãƒ¼ãƒ‰å…¥åŠ›\n */\nexport function PostFormItemView (props: Props) {\n  const t = useTranslation()\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-2 p-4\">\n        <p className=\"font-bold text-sm\">{t(\"å…¬é–‹ãƒ¢ãƒ¼ãƒ‰\", \"Access Mode\")}</p>\n        <RadioGroup\n          value={props.accessType}\n          onValueChange={(value) => {\n            props.setAccessType(value as IntrospectionEnum<\"AccessType\">)\n          }}\n          className=\"flex flex-wrap space-x-0 md:space-x-4\"\n        >\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"PUBLIC\" id=\"view-public\" />\n              <label\n                htmlFor=\"view-public\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"å…¬é–‹\", \"Public\")}\n              </label>\n            </div>\n          </div>\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"PRIVATE\" id=\"view-archive\" />\n              <label\n                htmlFor=\"view-archive\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"éå…¬é–‹\", \"Private\")}\n              </label>\n            </div>\n          </div>\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"LIMITED\" id=\"view-limited\" />\n              <label\n                htmlFor=\"view-limited\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"é™å®šå…¬é–‹\", \"Limited\")}\n              </label>\n            </div>\n          </div>\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"SILENT\" id=\"view-silent\" />\n              <label\n                htmlFor=\"view-silent\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"æ–°ç€éå…¬é–‹\", \"Silent\")}\n              </label>\n            </div>\n          </div>\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"DRAFT\" id=\"view-draft\" />\n              <label\n                htmlFor=\"view-draft\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"ä¸‹æ›¸ã\", \"Draft\")}\n              </label>\n            </div>\n          </div>\n        </RadioGroup>\n      </CardContent>\n    </Card>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-view.tsx"},"span":[2222,2272],"sourceCode":"import { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  accessType: IntrospectionEnum<\"AccessType\">\n  setAccessType: (value: IntrospectionEnum<\"AccessType\">) => void\n}\n\n/**\n * å…¬é–‹ãƒ¢ãƒ¼ãƒ‰å…¥åŠ›\n */\nexport function PostFormItemView (props: Props) {\n  const t = useTranslation()\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-2 p-4\">\n        <p className=\"font-bold text-sm\">{t(\"å…¬é–‹ãƒ¢ãƒ¼ãƒ‰\", \"Access Mode\")}</p>\n        <RadioGroup\n          value={props.accessType}\n          onValueChange={(value) => {\n            props.setAccessType(value as IntrospectionEnum<\"AccessType\">)\n          }}\n          className=\"flex flex-wrap space-x-0 md:space-x-4\"\n        >\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"PUBLIC\" id=\"view-public\" />\n              <label\n                htmlFor=\"view-public\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"å…¬é–‹\", \"Public\")}\n              </label>\n            </div>\n          </div>\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"PRIVATE\" id=\"view-archive\" />\n              <label\n                htmlFor=\"view-archive\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"éå…¬é–‹\", \"Private\")}\n              </label>\n            </div>\n          </div>\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"LIMITED\" id=\"view-limited\" />\n              <label\n                htmlFor=\"view-limited\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"é™å®šå…¬é–‹\", \"Limited\")}\n              </label>\n            </div>\n          </div>\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"SILENT\" id=\"view-silent\" />\n              <label\n                htmlFor=\"view-silent\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"æ–°ç€éå…¬é–‹\", \"Silent\")}\n              </label>\n            </div>\n          </div>\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"DRAFT\" id=\"view-draft\" />\n              <label\n                htmlFor=\"view-draft\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"ä¸‹æ›¸ã\", \"Draft\")}\n              </label>\n            </div>\n          </div>\n        </RadioGroup>\n      </CardContent>\n    </Card>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-view.tsx"},"span":[2628,2676],"sourceCode":"import { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  accessType: IntrospectionEnum<\"AccessType\">\n  setAccessType: (value: IntrospectionEnum<\"AccessType\">) => void\n}\n\n/**\n * å…¬é–‹ãƒ¢ãƒ¼ãƒ‰å…¥åŠ›\n */\nexport function PostFormItemView (props: Props) {\n  const t = useTranslation()\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-2 p-4\">\n        <p className=\"font-bold text-sm\">{t(\"å…¬é–‹ãƒ¢ãƒ¼ãƒ‰\", \"Access Mode\")}</p>\n        <RadioGroup\n          value={props.accessType}\n          onValueChange={(value) => {\n            props.setAccessType(value as IntrospectionEnum<\"AccessType\">)\n          }}\n          className=\"flex flex-wrap space-x-0 md:space-x-4\"\n        >\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"PUBLIC\" id=\"view-public\" />\n              <label\n                htmlFor=\"view-public\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"å…¬é–‹\", \"Public\")}\n              </label>\n            </div>\n          </div>\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"PRIVATE\" id=\"view-archive\" />\n              <label\n                htmlFor=\"view-archive\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"éå…¬é–‹\", \"Private\")}\n              </label>\n            </div>\n          </div>\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"LIMITED\" id=\"view-limited\" />\n              <label\n                htmlFor=\"view-limited\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"é™å®šå…¬é–‹\", \"Limited\")}\n              </label>\n            </div>\n          </div>\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"SILENT\" id=\"view-silent\" />\n              <label\n                htmlFor=\"view-silent\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"æ–°ç€éå…¬é–‹\", \"Silent\")}\n              </label>\n            </div>\n          </div>\n          <div className=\"w-1/2 md:w-auto\">\n            <div className=\"flex items-center space-x-2\">\n              <RadioGroupItem value=\"DRAFT\" id=\"view-draft\" />\n              <label\n                htmlFor=\"view-draft\"\n                className=\"flex items-center space-x-2\"\n              >\n                {t(\"ä¸‹æ›¸ã\", \"Draft\")}\n              </label>\n            </div>\n          </div>\n        </RadioGroup>\n      </CardContent>\n    </Card>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-permission-setting.tsx"},"span":[1193,1485],"sourceCode":"import { Checkbox } from \"~/components/ui/checkbox\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { useEffect, useState } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  isTagEditableChecked?: boolean\n  onTagEditableChange: (value: boolean) => void\n  isCommentsEditableChecked?: boolean\n  onCommentsEditableChange: (value: boolean) => void\n}\n\n/**\n * è¨±å¯è¨­å®š\n */\nexport function PostFormPermissionSetting (props: Props) {\n  const [isTagEditableChecked, setIsTagEditableChecked] = useState(\n    props.isTagEditableChecked,\n  )\n\n  const [isCommentsEditableChecked, setIsCommentsEditableChecked] = useState(\n    props.isCommentsEditableChecked,\n  )\n\n  const t = useTranslation()\n\n  useEffect(() => {\n    setIsTagEditableChecked(props.isTagEditableChecked)\n    setIsCommentsEditableChecked(props.isCommentsEditableChecked)\n  }, [props.isTagEditableChecked, props.isCommentsEditableChecked])\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-2 p-4\">\n        <p className=\"font-bold text-sm\">\n          {t(\"è¨±å¯ã®è¨­å®š\", \"Permission Settings\")}\n        </p>\n        <div className=\"flex items-center space-x-2\">\n          <Checkbox\n            onCheckedChange={(_value: boolean) => {\n              setIsTagEditableChecked(!isTagEditableChecked)\n              props.onTagEditableChange(!isCommentsEditableChecked)\n            }}\n            id=\"tag-editable\"\n            checked={!isTagEditableChecked}\n          />\n          <label className=\"text-sm\" htmlFor=\"tag-editable\">\n            {t(\"ã‚¿ã‚°ã®ç·¨é›†ã‚’è¨±å¯ã—ãªã„\", \"Disallow tag editing\")}\n          </label>\n        </div>\n        <div className=\"flex items-center space-x-2\">\n          <Checkbox\n            onCheckedChange={(_value: boolean) => {\n              setIsCommentsEditableChecked(!isCommentsEditableChecked)\n              props.onCommentsEditableChange(!isCommentsEditableChecked)\n            }}\n            id=\"comments-editable\"\n            checked={!isCommentsEditableChecked}\n          />\n          <label className=\"text-sm\" htmlFor=\"comments-editable\">\n            {t(\"ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¨±å¯ã—ãªã„\", \"Disallow comments\")}\n          </label>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-permission-setting.tsx"},"span":[1722,2039],"sourceCode":"import { Checkbox } from \"~/components/ui/checkbox\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { useEffect, useState } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  isTagEditableChecked?: boolean\n  onTagEditableChange: (value: boolean) => void\n  isCommentsEditableChecked?: boolean\n  onCommentsEditableChange: (value: boolean) => void\n}\n\n/**\n * è¨±å¯è¨­å®š\n */\nexport function PostFormPermissionSetting (props: Props) {\n  const [isTagEditableChecked, setIsTagEditableChecked] = useState(\n    props.isTagEditableChecked,\n  )\n\n  const [isCommentsEditableChecked, setIsCommentsEditableChecked] = useState(\n    props.isCommentsEditableChecked,\n  )\n\n  const t = useTranslation()\n\n  useEffect(() => {\n    setIsTagEditableChecked(props.isTagEditableChecked)\n    setIsCommentsEditableChecked(props.isCommentsEditableChecked)\n  }, [props.isTagEditableChecked, props.isCommentsEditableChecked])\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-2 p-4\">\n        <p className=\"font-bold text-sm\">\n          {t(\"è¨±å¯ã®è¨­å®š\", \"Permission Settings\")}\n        </p>\n        <div className=\"flex items-center space-x-2\">\n          <Checkbox\n            onCheckedChange={(_value: boolean) => {\n              setIsTagEditableChecked(!isTagEditableChecked)\n              props.onTagEditableChange(!isCommentsEditableChecked)\n            }}\n            id=\"tag-editable\"\n            checked={!isTagEditableChecked}\n          />\n          <label className=\"text-sm\" htmlFor=\"tag-editable\">\n            {t(\"ã‚¿ã‚°ã®ç·¨é›†ã‚’è¨±å¯ã—ãªã„\", \"Disallow tag editing\")}\n          </label>\n        </div>\n        <div className=\"flex items-center space-x-2\">\n          <Checkbox\n            onCheckedChange={(_value: boolean) => {\n              setIsCommentsEditableChecked(!isCommentsEditableChecked)\n              props.onCommentsEditableChange(!isCommentsEditableChecked)\n            }}\n            id=\"comments-editable\"\n            checked={!isCommentsEditableChecked}\n          />\n          <label className=\"text-sm\" htmlFor=\"comments-editable\">\n            {t(\"ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¨±å¯ã—ãªã„\", \"Disallow comments\")}\n          </label>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/success-created-work-dialog.tsx"},"span":[3977,4126],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Dialog, DialogContent } from \"~/components/ui/dialog\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { XIntent } from \"~/routes/($lang)._main.posts.$post._index/components/work-action-share-x\"\nimport { Link } from \"@remix-run/react\"\nimport { useEffect } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  title: string | null\n  description: string | null\n  isOpen: boolean\n  imageBase64: string | null\n  workId: string | null\n  uuid: string | null\n  shareTags: string[]\n  createdAt: number\n  accessType: IntrospectionEnum<\"AccessType\">\n}\n\nexport function SuccessCreatedWorkDialog (props: Props) {\n  const t = useTranslation()\n\n  const getRandomColor = () => {\n    const colors = [\"#ff0\", \"#ff8c00\", \"#e6e6fa\", \"#00f\", \"#8a2be2\", \"#ff69b4\"]\n    return colors[Math.floor(Math.random() * colors.length)]\n  }\n\n  const createConfetti = (container: HTMLElement) => {\n    Array.from({ length: 3 }).map(() => {\n      const confetti = document.createElement(\"div\")\n      confetti.style.position = \"absolute\"\n      confetti.style.width = \"10px\"\n      confetti.style.height = \"10px\"\n      confetti.style.backgroundColor = getRandomColor()\n      confetti.style.top = `${-50 + Math.random() * 50}px`\n      confetti.style.left = `${Math.random() * 100}%`\n      confetti.style.opacity = `${0.2 + Math.random() * 0.3}`\n      confetti.style.transform = `rotate(${Math.random() * 360}deg)`\n      confetti.style.transition = `top ${2 + Math.random()}s ease-in, opacity ${\n        2 + Math.random()\n      }s ease-in`\n\n      container.appendChild(confetti)\n\n      setTimeout(() => {\n        confetti.style.top = \"100%\"\n        confetti.style.opacity = \"0\"\n      }, 100)\n    })\n  }\n\n  useEffect(() => {\n    // ä¸€åº¦ã ã‘æŠ•ç¨¿ä½œå“URLã‚’fetchã™ã‚‹å‡¦ç†ã‚’è¿½åŠ \n    const fetchWorkUrl = async () => {\n      try {\n        const url = props.uuid\n          ? `https://www.aipictors.com/posts/${props.uuid}`\n          : `https://www.aipictors.com/works/${props.workId}`\n        const response = await fetch(url)\n        if (!response.ok) {\n          console.error(\"Fetch failed:\", response.status)\n        }\n      } catch (error) {\n        console.error(\"Fetch error:\", error)\n      }\n    }\n\n    if (props.workId || props.uuid) {\n      fetchWorkUrl()\n    }\n\n    setTimeout(() => {\n      const confettiContainer = document.getElementById(\n        \"confetti-container\",\n      ) as HTMLElement\n      if (confettiContainer) {\n        confettiContainer.innerHTML = \"\"\n        createConfetti(confettiContainer)\n        const interval = setInterval(() => {\n          createConfetti(confettiContainer)\n        }, 1000)\n        return () => clearInterval(interval)\n      }\n    }, 1000)\n  }, [props.isOpen, props.workId, props.uuid])\n\n  const link = () => {\n    if (\n      props.accessType === \"DRAFT\" ||\n      props.accessType === \"PRIVATE\" ||\n      isReserved()\n    ) {\n      return `/posts/${props.workId}/draft`\n    }\n    if (props.accessType === \"LIMITED\") {\n      return `/posts/${props.uuid}`\n    }\n    return `/posts/${props.workId}`\n  }\n\n  // äºˆç´„æŠ•ç¨¿ã‹ã©ã†ã‹\n  const isReserved = () => {\n    const reservedDate = new Date(props.createdAt * 1000 + 3600000 * 9)\n    const now = new Date(Date.now() + 3600000 * 9)\n    return reservedDate > now\n  }\n\n  const shareText = t(\n    `AIã‚¤ãƒ©ã‚¹ãƒˆæŠ•ç¨¿ã‚µã‚¤ãƒˆAipictorsã«æŠ•ç¨¿ã•ã‚ŒãŸä½œå“\\nã€Œ${props.title}ã€\\n\\n${props.description}`,\n    `Work posted on AI Illustration Posting Site Aipictors\\n\"${props.title}\"\\n\\n${props.description}`,\n  )\n\n  return (\n    <>\n      <Dialog\n        onOpenChange={(isOpen) => {\n          if (!isOpen) {\n            // ãƒšãƒ¼ã‚¸é·ç§»\n            if (typeof document !== \"undefined\") {\n              window.location.href = link()\n            }\n          }\n        }}\n        open={props.isOpen}\n      >\n        <DialogContent>\n          <div className=\"relative h-40 w-full\">\n            <div\n              id=\"confetti-container\"\n              className=\"relative h-40 w-full overflow-hidden bg-zinc-100 dark:bg-zinc-900\"\n            />\n            {props.imageBase64 && (\n              <Link to={link()}>\n                <img\n                  className=\"-translate-x-1/2 -translate-y-1/2 absolute top-1/2 left-1/2 size-24 rounded-md object-cover transition-opacity duration-300 ease-in-out hover:opacity-80\"\n                  src={props.imageBase64}\n                  alt=\"work-image\"\n                />\n              </Link>\n            )}\n          </div>\n          <p className=\"text-center font-bold\">\n            {t(\"ä½œå“ãŒæ›´æ–°ã•ã‚Œã¾ã—ãŸ\", \"The work has been updated\")}\n          </p>\n          <p className=\"text-center text-sm opacity-80\">\n            {t(\"ã“ã®ä½œå“ã‚’ã‚·ã‚§ã‚¢ã™ã‚‹\", \"Share this work\")}\n          </p>\n          <div className=\"w-full\">\n            <XIntent\n              text={shareText}\n              url={`${\n                props.accessType === \"LIMITED\"\n                  ? `https://www.aipictors.com/posts/${props.uuid}`\n                  : `https://www.aipictors.com/posts/${props.workId}`\n              }\\n`}\n              hashtags={props.shareTags}\n            />\n          </div>\n          <Button\n            onClick={() => {\n              if (typeof document !== \"undefined\") {\n                window.location.href = link()\n              }\n            }}\n            className=\"mt-2\"\n          >\n            {t(\"é–‰ã˜ã‚‹\", \"Close\")}\n          </Button>\n        </DialogContent>\n      </Dialog>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable tokenRefetch is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"tokenRefetch"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/text-editor.tsx"},"span":[2732,2744],"sourceCode":"import { useEditor, EditorContent, type Editor } from \"@tiptap/react\"\nimport StarterKit from \"@tiptap/starter-kit\"\nimport {\n  Bold,\n  Strikethrough,\n  Italic,\n  List,\n  ListOrdered,\n  Code,\n  ImageIcon,\n  Quote,\n  Minus,\n  Undo,\n  Redo,\n} from \"lucide-react\"\nimport { Toggle } from \"~/components/ui/toggle\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { Markdown } from \"tiptap-markdown\"\nimport Image from \"@tiptap/extension-image\"\nimport { useCallback, useContext, useEffect } from \"react\"\nimport { Button } from \"~/components/ui/button\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport CodeBlock from \"@tiptap/extension-code-block\"\nimport Blockquote from \"@tiptap/extension-blockquote\"\nimport HorizontalRule from \"@tiptap/extension-horizontal-rule\"\nimport { graphql } from \"gql.tada\"\nimport { TextEditorUploaderDialog } from \"~/routes/($lang)._main.new.image/components/text-editor-uploader-dialog\"\n\nconst TextEditor = ({\n  value,\n  onChange,\n}: {\n  value: string\n  onChange: (value: string) => void\n}) => {\n  const editor = useEditor({\n    editorProps: {\n      attributes: {\n        class:\n          \"prose dark:prose-invert max-w-full min-h-[150px] w-full rounded-md rounded-br-none rounded-bl-none border border-input bg-transparent px-3 py-2 border-b-0 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-hidden disabled:cursor-not-allowed disabled:opacity-50 overflow-auto\",\n      },\n    },\n    immediatelyRender: false,\n    shouldRerenderOnTransaction: false,\n    extensions: [\n      StarterKit.configure({\n        orderedList: {\n          HTMLAttributes: {\n            class: \"list-decimal pl-4\",\n          },\n        },\n        bulletList: {\n          HTMLAttributes: {\n            class: \"list-disc pl-4\",\n          },\n        },\n      }),\n      Markdown,\n      Image.configure({\n        inline: true,\n        allowBase64: true,\n      }),\n      CodeBlock.configure({\n        HTMLAttributes: {\n          class: \"bg-gray-800 text-white text-sm p-2 rounded-md\",\n          languageClassPrefix: \"language-\",\n        },\n      }),\n      Blockquote,\n      HorizontalRule,\n    ],\n    content: value,\n    onUpdate: ({ editor }) => {\n      onChange(editor.storage.markdown.getMarkdown())\n    },\n  })\n\n  useEffect(() => {\n    if (editor && editor.getText() === \"\") {\n      editor.commands.setContent(value)\n    }\n  }, [value, editor])\n\n  return (\n    <>\n      <EditorContent editor={editor} />\n      {editor ? <RichTextEditorToolbar editor={editor} /> : null}\n    </>\n  )\n}\n\nconst RichTextEditorToolbar = ({ editor }: { editor: Editor }) => {\n  const authContext = useContext(AuthContext)\n\n  const { data: token, refetch: tokenRefetch } = useQuery(viewerTokenQuery, {\n    skip: authContext.isLoading,\n  })\n\n  const addImage = useCallback(\n    (url: string) => {\n      if (url) {\n        editor?.chain().focus().setImage({ src: url }).run()\n      }\n    },\n    [editor],\n  )\n\n  return (\n    <div className=\"flex flex-row items-center gap-1 rounded-br-md rounded-bl-md border border-input bg-transparent p-1\">\n      <Toggle\n        size=\"sm\"\n        pressed={editor.isActive(\"bold\")}\n        onPressedChange={() => editor.chain().focus().toggleBold().run()}\n      >\n        <Bold className=\"size-4\" />\n      </Toggle>\n      <Toggle\n        size=\"sm\"\n        pressed={editor.isActive(\"italic\")}\n        onPressedChange={() => editor.chain().focus().toggleItalic().run()}\n      >\n        <Italic className=\"size-4\" />\n      </Toggle>\n      <Toggle\n        size=\"sm\"\n        pressed={editor.isActive(\"strike\")}\n        onPressedChange={() => editor.chain().focus().toggleStrike().run()}\n      >\n        <Strikethrough className=\"size-4\" />\n      </Toggle>\n      <Toggle\n        size=\"sm\"\n        pressed={editor.isActive(\"codeBlock\")}\n        onClick={() => editor.chain().focus().toggleCodeBlock().run()}\n      >\n        <Code className=\"size-4\" />\n      </Toggle>\n\n      <Separator orientation=\"vertical\" className=\"h-8 w-[1px]\" />\n      <Toggle\n        size=\"sm\"\n        pressed={editor.isActive(\"heading\", { level: 1 })}\n        onClick={() => editor.chain().focus().toggleHeading({ level: 1 }).run()}\n      >\n        {\"H1\"}\n      </Toggle>\n      <Toggle\n        size=\"sm\"\n        pressed={editor.isActive(\"heading\", { level: 2 })}\n        onClick={() => editor.chain().focus().toggleHeading({ level: 2 }).run()}\n      >\n        {\"H2\"}\n      </Toggle>\n      <Toggle\n        size=\"sm\"\n        pressed={editor.isActive(\"heading\", { level: 3 })}\n        onClick={() => editor.chain().focus().toggleHeading({ level: 3 }).run()}\n      >\n        {\"H3\"}\n      </Toggle>\n      <Toggle\n        size=\"sm\"\n        pressed={editor.isActive(\"bulletList\")}\n        onPressedChange={() => editor.chain().focus().toggleBulletList().run()}\n      >\n        <List className=\"size-4\" />\n      </Toggle>\n      <Toggle\n        size=\"sm\"\n        pressed={editor.isActive(\"orderedList\")}\n        onPressedChange={() => editor.chain().focus().toggleOrderedList().run()}\n      >\n        <ListOrdered className=\"size-4\" />\n      </Toggle>\n      {token?.viewer?.token && (\n        <TextEditorUploaderDialog\n          token={token?.viewer?.token}\n          onSelectImage={addImage}\n        >\n          <Button size=\"sm\" variant={\"ghost\"}>\n            <ImageIcon className=\"size-4\" />\n          </Button>\n        </TextEditorUploaderDialog>\n      )}\n      <Separator orientation=\"vertical\" className=\"h-8 w-[1px]\" />\n      <Toggle\n        size=\"sm\"\n        pressed={editor.isActive(\"blockquote\")}\n        onClick={() => editor.chain().focus().toggleBlockquote().run()}\n      >\n        <Quote className=\"size-4\" />\n      </Toggle>\n      <Toggle\n        size=\"sm\"\n        pressed={editor.isActive(\"horizontalRule\")}\n        onClick={() => editor.chain().focus().setHorizontalRule().run()}\n      >\n        <Minus className=\"size-4\" />\n      </Toggle>\n      <Separator orientation=\"vertical\" className=\"h-8 w-[1px]\" />\n      <Toggle\n        size=\"sm\"\n        pressed={editor.isActive(\"undo\")}\n        onClick={() => editor.chain().focus().undo().run()}\n      >\n        <Undo className=\"size-4\" />\n      </Toggle>\n      <Toggle\n        size=\"sm\"\n        pressed={editor.isActive(\"redo\")}\n        onClick={() => editor.chain().focus().redo().run()}\n      >\n        <Redo className=\"size-4\" />\n      </Toggle>\n    </div>\n  )\n}\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nexport default TextEditor\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable tokenRefetch is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"tokenRefetch"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.profile._index/components/profile-editor-form.tsx"},"span":[2016,2028],"sourceCode":"import { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { CropImageField } from \"~/components/crop-image-field\"\nimport { Button } from \"~/components/ui/button\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { DialogWorkFragment } from \"~/routes/($lang).my._index/components/select-created-works-dialog\"\nimport { useQuery, useSuspenseQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon, Pencil } from \"lucide-react\"\nimport { useContext, useState } from \"react\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { toast } from \"sonner\"\nimport { useNavigate } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function ProfileEditorForm () {\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const { data: user } = useSuspenseQuery(userQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const navigate = useNavigate()\n\n  const userInfo = user?.user\n\n  const [userName, setUserName] = useState(userInfo?.name ?? \"\")\n\n  const [profile, setProfile] = useState(userInfo?.biography ?? \"\")\n\n  const [enProfile, setEnProfile] = useState(userInfo?.enBiography ?? \"\")\n\n  const [website, setWebsite] = useState(userInfo?.siteURL ?? \"\")\n\n  const [instagram, setInstagram] = useState(userInfo?.instagramAccountId ?? \"\")\n\n  const [twitter, setTwitter] = useState(userInfo?.twitterAccountId ?? \"\")\n\n  const [github, setGithub] = useState(userInfo?.githubAccountId ?? \"\")\n\n  const [mail, setMail] = useState(userInfo?.mailAddress ?? \"\")\n\n  const [profileImage, setProfileImage] = useState(\"\")\n\n  const [headerImage, setHeaderImage] = useState(\"\")\n\n  const { data: token, refetch: tokenRefetch } = useQuery(viewerTokenQuery)\n\n  const [selectedPickupWorks, _setSelectedPickupWorks] = useState(\n    userInfo?.featuredWorks ?? [],\n  )\n\n  const [selectedPickupSensitiveWorks, _setSelectedPickupSensitiveWorks] =\n    useState(userInfo?.featuredSensitiveWorks ?? [])\n\n  const [updateProfile, { loading: isUpdating }] = useMutation(\n    updateUserProfileMutation,\n  )\n\n  const onSubmit = async () => {\n    if (isUpdating || authContext.userId === null) {\n      return\n    }\n\n    const iconUrl = profileImage\n      ? await uploadPublicImage(profileImage, token?.viewer?.token)\n      : null\n\n    const headerUrl = headerImage\n      ? await uploadPublicImage(headerImage, token?.viewer?.token)\n      : null\n\n    await updateProfile({\n      variables: {\n        input: {\n          displayName: userName,\n          biography: profile,\n          enBiography: enProfile,\n          homeUrl: website,\n          instagramAccountId: instagram,\n          twitterAccountId: twitter,\n          githubAccountId: github,\n          mailAddress: mail,\n          ...(iconUrl && {\n            iconUrl: iconUrl,\n          }),\n          ...(headerUrl && {\n            headerImageUrl: headerUrl,\n          }),\n          featuredWorkIds: selectedPickupWorks.map((work) => work.id),\n          featuredSensitiveWorkIds: selectedPickupSensitiveWorks.map(\n            (work) => work.id,\n          ),\n        },\n      },\n    })\n\n    toast(t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚\", \"Profile updated.\"))\n\n    navigate(\"/new/settings\")\n  }\n\n  const profileImageSrc =\n    profileImage.length > 0 ? profileImage : userInfo?.iconUrl\n\n  const headerImageSrc =\n    headerImage.length > 0 ? headerImage : userInfo?.headerImageUrl\n\n  return (\n    <>\n      <div className=\"container mx-auto max-w-4xl space-y-8 p-6\">\n        {/* ã‚¦ã‚§ãƒ«ã‚«ãƒ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}\n        <div className=\"rounded-xl border border-gray-100 bg-gradient-to-r from-blue-50 to-purple-50 p-8\">\n          <div className=\"space-y-4 text-center\">\n            <h1 className=\"font-bold text-3xl text-gray-800\">\n              {t(\"Aipictorsã¸ã‚ˆã†ã“ãï¼\", \"Welcome to Aipictors!\")}\n            </h1>\n            <p className=\"text-gray-600 text-lg\">\n              {t(\n                \"æ—¥æœ¬æœ€å¤§ç´šã®AIã‚¤ãƒ©ã‚¹ãƒˆãƒ»å°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆã§ã™\",\n                \"Japan's largest AI illustration and novel posting site\",\n              )}\n            </p>\n            <div className=\"mt-6 grid gap-4 md:grid-cols-3\">\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-blue-500\">ğŸ¨</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ä½œå“æŠ•ç¨¿\", \"Post Artwork\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"AIã‚¤ãƒ©ã‚¹ãƒˆã‚„å°èª¬ã‚’æŠ•ç¨¿ã—ã¦ã€å¤šãã®äººã«è¦‹ã¦ã‚‚ã‚‰ãŠã†\",\n                    \"Share your AI artwork and novels with many people\",\n                  )}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-green-500\">ğŸ‘¥</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£\", \"Community\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"ä»–ã®ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã¨ã¤ãªãŒã‚Šã€ãŠäº’ã„ã®ä½œå“ã‚’æ¥½ã—ã‚‚ã†\",\n                    \"Connect with other creators and enjoy each other's work\",\n                  )}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-purple-500\">ğŸ†</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ\", \"Contests\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"å®šæœŸçš„ã«é–‹å‚¬ã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ã‚¹ãƒˆã«å‚åŠ ã—ã¦è…•è©¦ã—\",\n                    \"Participate in regular contests to test your skills\",\n                  )}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šèª¬æ˜ */}\n        <div className=\"rounded-xl border border-yellow-200 bg-yellow-50 p-6\">\n          <h2 className=\"mb-4 font-bold text-gray-800 text-xl\">\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šã«ã¤ã„ã¦\", \"About Profile Setup\")}\n          </h2>\n          <div className=\"space-y-3 text-gray-700\">\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                1\n              </span>\n              <p>\n                {t(\n                  \"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚„ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚’è¨­å®šã—ã¦ã€ã‚ãªãŸã‚‰ã—ã•ã‚’è¡¨ç¾ã—ã¾ã—ã‚‡ã†\",\n                  \"Set your nickname and profile image to express yourself\",\n                )}\n              </p>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                2\n              </span>\n              <p>\n                {t(\n                  \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ–‡ç« ã§è‡ªå·±ç´¹ä»‹ã‚„èˆˆå‘³ã®ã‚ã‚‹ã“ã¨ã‚’æ›¸ã„ã¦ã¿ã¾ã—ã‚‡ã†\",\n                  \"Write a self-introduction and your interests in your profile\",\n                )}\n              </p>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                3\n              </span>\n              <p>\n                {t(\n                  \"SNSã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é€£æºã—ã¦ã€ã‚ˆã‚Šå¤šãã®äººã¨ã¤ãªãŒã‚Šã¾ã—ã‚‡ã†\",\n                  \"Link your SNS accounts to connect with more people\",\n                )}\n              </p>\n            </div>\n          </div>\n          <div className=\"mt-4 rounded-lg border border-blue-200 bg-blue-50 p-4\">\n            <p className=\"text-blue-800 text-sm\">\n              ğŸ’¡{\" \"}\n              {t(\n                \"ã™ã¹ã¦ã®é …ç›®ã¯å¾Œã‹ã‚‰è¨­å®šç”»é¢ã§å¤‰æ›´ã§ãã‚‹ã®ã§ã€ã¾ãšã¯æ°—è»½ã«è¨­å®šã—ã¦ã¿ã¦ãã ã•ã„\",\n                \"All items can be changed later in the settings, so feel free to start with basic setup\",\n              )}\n            </p>\n          </div>\n        </div>\n        <div className=\"justify-between\">\n          <div className=\"relative\">\n            {headerImageSrc ? (\n              <img\n                className=\"h-auto max-h-64 w-full object-cover\"\n                src={headerImageSrc}\n                alt=\"header\"\n              />\n            ) : (\n              <div className=\"h-40 w-full bg-gray-700\" />\n            )}\n            <div className=\"absolute bottom-[-24px] left-2 size-32\">\n              {profileImageSrc ? (\n                <img\n                  className=\"absolute size-32 rounded-full border-2\"\n                  src={profileImageSrc}\n                  alt=\"header\"\n                />\n              ) : (\n                <div className=\"size-32 rounded-full border-2 bg-gray-700\" />\n              )}\n\n              <CropImageField\n                isHidePreviewImage={false}\n                cropWidth={240}\n                cropHeight={240}\n                onDeleteImage={() => {\n                  setProfileImage(\"\")\n                }}\n                onCropToBase64={(base64: string) => {\n                  try {\n                    console.log(\"base64\", base64)\n                    setProfileImage(base64)\n                  } catch (error) {\n                    console.error(\"Error in onCropToBase64:\", error)\n                  }\n                }}\n                fileExtension={\"webp\"}\n              >\n                <Button\n                  className=\"absolute top-0 right-0 size-8 rounded-full p-0\"\n                  variant={\"secondary\"}\n                >\n                  <Pencil className=\"size-4\" />\n                </Button>\n              </CropImageField>\n            </div>\n\n            <CropImageField\n              isHidePreviewImage={false}\n              cropWidth={1200}\n              cropHeight={627}\n              onDeleteImage={() => {\n                setHeaderImage(\"\")\n              }}\n              onCropToBase64={setHeaderImage}\n              fileExtension={\"webp\"}\n            >\n              <Button\n                className=\"absolute top-1 right-1 size-8 rounded-full p-0\"\n                variant={\"secondary\"}\n              >\n                <Pencil className=\"size-4\" />\n              </Button>\n            </CropImageField>\n          </div>\n          <p className=\"mt-8\">\n            {t(\n              \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒã«R-18ç”»åƒã¯æ²è¼‰ã§ãã¾ã›ã‚“ã€‚\",\n              \"You cannot upload R-18 images as profile or header images.\",\n            )}\n          </p>\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"nickname\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ \", \"Nickname\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"nickname\"\n            maxLength={32}\n            minLength={1}\n            value={userName}\n            onChange={(e) => setUserName(e.target.value)}\n            className=\"rounded-md border px-2 py-1\"\n            defaultValue=\"Aipictors/AIã‚¤ãƒ©ã‚¹ãƒˆæŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIå°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIçµµ\"\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"profile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"profile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={320}\n            value={profile}\n            onChange={(e) => setProfile(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"enProfile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"è‹±èªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"English Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"enProfile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={640}\n            value={enProfile}\n            onChange={(e) => setEnProfile(e.target.value)}\n          />\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"website\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"Webã‚µã‚¤ãƒˆ\", \"Website\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"website\"\n            className=\"rounded-md border px-2 py-1\"\n            value={website}\n            maxLength={1000}\n            onChange={(e) => setWebsite(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <p className=\"font-semibold\">\n            {t(\"SNSãƒªãƒ³ã‚¯ï¼ˆ@ãƒãƒ¼ã‚¯ã¯ä¸è¦ï¼‰\", \"SNS Links (without @)\")}\n          </p>\n          <label\n            htmlFor=\"instagram\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Instagram\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"instagram\"\n            className=\"rounded-md border px-2 py-1\"\n            value={instagram}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setInstagram(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"twitter\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"X(æ—§Twitter)\", \"X(formerly Twitter)\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"twitter\"\n            className=\"rounded-md border px-2 py-1\"\n            value={twitter}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setTwitter(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"github\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Github\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"github\"\n            className=\"rounded-md border px-2 py-1\"\n            value={github}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setGithub(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"mail\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\", \"Email Address\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"mail\"\n            className=\"rounded-md border px-2 py-1\"\n            value={mail}\n            placeholder={\"\"}\n            maxLength={320}\n            onChange={(e) => setMail(e.target.value)}\n          />\n        </div>\n        <Separator />\n        <Button\n          disabled={isUpdating}\n          onClick={onSubmit}\n          className=\"ml-auto block w-full\"\n        >\n          {isUpdating ? (\n            <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n          ) : (\n            <p>{t(\"æ¬¡ã¸\", \"Next\")}</p>\n          )}\n        </Button>\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      createdBookmarksCount\n      login\n      nanoid\n      name\n      receivedLikesCount\n      receivedViewsCount\n      awardsCount\n      followCount\n      followersCount\n      worksCount\n      iconUrl\n      headerImageUrl\n      webFcmToken\n      featuredSensitiveWorks {\n        ...DialogWork\n      }\n      featuredWorks {\n        ...DialogWork\n      }\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n    }\n  }`,\n  [DialogWorkFragment],\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserProfileMutation = graphql(\n  `mutation UpdateUserProfile($input: UpdateUserProfileInput!) {\n    updateUserProfile(input: $input) {\n      id\n      name\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.profile._index/components/profile-editor-form.tsx"},"span":[11595,11957],"sourceCode":"import { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { CropImageField } from \"~/components/crop-image-field\"\nimport { Button } from \"~/components/ui/button\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { DialogWorkFragment } from \"~/routes/($lang).my._index/components/select-created-works-dialog\"\nimport { useQuery, useSuspenseQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon, Pencil } from \"lucide-react\"\nimport { useContext, useState } from \"react\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { toast } from \"sonner\"\nimport { useNavigate } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function ProfileEditorForm () {\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const { data: user } = useSuspenseQuery(userQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const navigate = useNavigate()\n\n  const userInfo = user?.user\n\n  const [userName, setUserName] = useState(userInfo?.name ?? \"\")\n\n  const [profile, setProfile] = useState(userInfo?.biography ?? \"\")\n\n  const [enProfile, setEnProfile] = useState(userInfo?.enBiography ?? \"\")\n\n  const [website, setWebsite] = useState(userInfo?.siteURL ?? \"\")\n\n  const [instagram, setInstagram] = useState(userInfo?.instagramAccountId ?? \"\")\n\n  const [twitter, setTwitter] = useState(userInfo?.twitterAccountId ?? \"\")\n\n  const [github, setGithub] = useState(userInfo?.githubAccountId ?? \"\")\n\n  const [mail, setMail] = useState(userInfo?.mailAddress ?? \"\")\n\n  const [profileImage, setProfileImage] = useState(\"\")\n\n  const [headerImage, setHeaderImage] = useState(\"\")\n\n  const { data: token, refetch: tokenRefetch } = useQuery(viewerTokenQuery)\n\n  const [selectedPickupWorks, _setSelectedPickupWorks] = useState(\n    userInfo?.featuredWorks ?? [],\n  )\n\n  const [selectedPickupSensitiveWorks, _setSelectedPickupSensitiveWorks] =\n    useState(userInfo?.featuredSensitiveWorks ?? [])\n\n  const [updateProfile, { loading: isUpdating }] = useMutation(\n    updateUserProfileMutation,\n  )\n\n  const onSubmit = async () => {\n    if (isUpdating || authContext.userId === null) {\n      return\n    }\n\n    const iconUrl = profileImage\n      ? await uploadPublicImage(profileImage, token?.viewer?.token)\n      : null\n\n    const headerUrl = headerImage\n      ? await uploadPublicImage(headerImage, token?.viewer?.token)\n      : null\n\n    await updateProfile({\n      variables: {\n        input: {\n          displayName: userName,\n          biography: profile,\n          enBiography: enProfile,\n          homeUrl: website,\n          instagramAccountId: instagram,\n          twitterAccountId: twitter,\n          githubAccountId: github,\n          mailAddress: mail,\n          ...(iconUrl && {\n            iconUrl: iconUrl,\n          }),\n          ...(headerUrl && {\n            headerImageUrl: headerUrl,\n          }),\n          featuredWorkIds: selectedPickupWorks.map((work) => work.id),\n          featuredSensitiveWorkIds: selectedPickupSensitiveWorks.map(\n            (work) => work.id,\n          ),\n        },\n      },\n    })\n\n    toast(t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚\", \"Profile updated.\"))\n\n    navigate(\"/new/settings\")\n  }\n\n  const profileImageSrc =\n    profileImage.length > 0 ? profileImage : userInfo?.iconUrl\n\n  const headerImageSrc =\n    headerImage.length > 0 ? headerImage : userInfo?.headerImageUrl\n\n  return (\n    <>\n      <div className=\"container mx-auto max-w-4xl space-y-8 p-6\">\n        {/* ã‚¦ã‚§ãƒ«ã‚«ãƒ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}\n        <div className=\"rounded-xl border border-gray-100 bg-gradient-to-r from-blue-50 to-purple-50 p-8\">\n          <div className=\"space-y-4 text-center\">\n            <h1 className=\"font-bold text-3xl text-gray-800\">\n              {t(\"Aipictorsã¸ã‚ˆã†ã“ãï¼\", \"Welcome to Aipictors!\")}\n            </h1>\n            <p className=\"text-gray-600 text-lg\">\n              {t(\n                \"æ—¥æœ¬æœ€å¤§ç´šã®AIã‚¤ãƒ©ã‚¹ãƒˆãƒ»å°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆã§ã™\",\n                \"Japan's largest AI illustration and novel posting site\",\n              )}\n            </p>\n            <div className=\"mt-6 grid gap-4 md:grid-cols-3\">\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-blue-500\">ğŸ¨</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ä½œå“æŠ•ç¨¿\", \"Post Artwork\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"AIã‚¤ãƒ©ã‚¹ãƒˆã‚„å°èª¬ã‚’æŠ•ç¨¿ã—ã¦ã€å¤šãã®äººã«è¦‹ã¦ã‚‚ã‚‰ãŠã†\",\n                    \"Share your AI artwork and novels with many people\",\n                  )}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-green-500\">ğŸ‘¥</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£\", \"Community\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"ä»–ã®ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã¨ã¤ãªãŒã‚Šã€ãŠäº’ã„ã®ä½œå“ã‚’æ¥½ã—ã‚‚ã†\",\n                    \"Connect with other creators and enjoy each other's work\",\n                  )}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-purple-500\">ğŸ†</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ\", \"Contests\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"å®šæœŸçš„ã«é–‹å‚¬ã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ã‚¹ãƒˆã«å‚åŠ ã—ã¦è…•è©¦ã—\",\n                    \"Participate in regular contests to test your skills\",\n                  )}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šèª¬æ˜ */}\n        <div className=\"rounded-xl border border-yellow-200 bg-yellow-50 p-6\">\n          <h2 className=\"mb-4 font-bold text-gray-800 text-xl\">\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šã«ã¤ã„ã¦\", \"About Profile Setup\")}\n          </h2>\n          <div className=\"space-y-3 text-gray-700\">\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                1\n              </span>\n              <p>\n                {t(\n                  \"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚„ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚’è¨­å®šã—ã¦ã€ã‚ãªãŸã‚‰ã—ã•ã‚’è¡¨ç¾ã—ã¾ã—ã‚‡ã†\",\n                  \"Set your nickname and profile image to express yourself\",\n                )}\n              </p>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                2\n              </span>\n              <p>\n                {t(\n                  \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ–‡ç« ã§è‡ªå·±ç´¹ä»‹ã‚„èˆˆå‘³ã®ã‚ã‚‹ã“ã¨ã‚’æ›¸ã„ã¦ã¿ã¾ã—ã‚‡ã†\",\n                  \"Write a self-introduction and your interests in your profile\",\n                )}\n              </p>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                3\n              </span>\n              <p>\n                {t(\n                  \"SNSã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é€£æºã—ã¦ã€ã‚ˆã‚Šå¤šãã®äººã¨ã¤ãªãŒã‚Šã¾ã—ã‚‡ã†\",\n                  \"Link your SNS accounts to connect with more people\",\n                )}\n              </p>\n            </div>\n          </div>\n          <div className=\"mt-4 rounded-lg border border-blue-200 bg-blue-50 p-4\">\n            <p className=\"text-blue-800 text-sm\">\n              ğŸ’¡{\" \"}\n              {t(\n                \"ã™ã¹ã¦ã®é …ç›®ã¯å¾Œã‹ã‚‰è¨­å®šç”»é¢ã§å¤‰æ›´ã§ãã‚‹ã®ã§ã€ã¾ãšã¯æ°—è»½ã«è¨­å®šã—ã¦ã¿ã¦ãã ã•ã„\",\n                \"All items can be changed later in the settings, so feel free to start with basic setup\",\n              )}\n            </p>\n          </div>\n        </div>\n        <div className=\"justify-between\">\n          <div className=\"relative\">\n            {headerImageSrc ? (\n              <img\n                className=\"h-auto max-h-64 w-full object-cover\"\n                src={headerImageSrc}\n                alt=\"header\"\n              />\n            ) : (\n              <div className=\"h-40 w-full bg-gray-700\" />\n            )}\n            <div className=\"absolute bottom-[-24px] left-2 size-32\">\n              {profileImageSrc ? (\n                <img\n                  className=\"absolute size-32 rounded-full border-2\"\n                  src={profileImageSrc}\n                  alt=\"header\"\n                />\n              ) : (\n                <div className=\"size-32 rounded-full border-2 bg-gray-700\" />\n              )}\n\n              <CropImageField\n                isHidePreviewImage={false}\n                cropWidth={240}\n                cropHeight={240}\n                onDeleteImage={() => {\n                  setProfileImage(\"\")\n                }}\n                onCropToBase64={(base64: string) => {\n                  try {\n                    console.log(\"base64\", base64)\n                    setProfileImage(base64)\n                  } catch (error) {\n                    console.error(\"Error in onCropToBase64:\", error)\n                  }\n                }}\n                fileExtension={\"webp\"}\n              >\n                <Button\n                  className=\"absolute top-0 right-0 size-8 rounded-full p-0\"\n                  variant={\"secondary\"}\n                >\n                  <Pencil className=\"size-4\" />\n                </Button>\n              </CropImageField>\n            </div>\n\n            <CropImageField\n              isHidePreviewImage={false}\n              cropWidth={1200}\n              cropHeight={627}\n              onDeleteImage={() => {\n                setHeaderImage(\"\")\n              }}\n              onCropToBase64={setHeaderImage}\n              fileExtension={\"webp\"}\n            >\n              <Button\n                className=\"absolute top-1 right-1 size-8 rounded-full p-0\"\n                variant={\"secondary\"}\n              >\n                <Pencil className=\"size-4\" />\n              </Button>\n            </CropImageField>\n          </div>\n          <p className=\"mt-8\">\n            {t(\n              \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒã«R-18ç”»åƒã¯æ²è¼‰ã§ãã¾ã›ã‚“ã€‚\",\n              \"You cannot upload R-18 images as profile or header images.\",\n            )}\n          </p>\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"nickname\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ \", \"Nickname\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"nickname\"\n            maxLength={32}\n            minLength={1}\n            value={userName}\n            onChange={(e) => setUserName(e.target.value)}\n            className=\"rounded-md border px-2 py-1\"\n            defaultValue=\"Aipictors/AIã‚¤ãƒ©ã‚¹ãƒˆæŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIå°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIçµµ\"\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"profile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"profile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={320}\n            value={profile}\n            onChange={(e) => setProfile(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"enProfile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"è‹±èªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"English Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"enProfile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={640}\n            value={enProfile}\n            onChange={(e) => setEnProfile(e.target.value)}\n          />\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"website\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"Webã‚µã‚¤ãƒˆ\", \"Website\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"website\"\n            className=\"rounded-md border px-2 py-1\"\n            value={website}\n            maxLength={1000}\n            onChange={(e) => setWebsite(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <p className=\"font-semibold\">\n            {t(\"SNSãƒªãƒ³ã‚¯ï¼ˆ@ãƒãƒ¼ã‚¯ã¯ä¸è¦ï¼‰\", \"SNS Links (without @)\")}\n          </p>\n          <label\n            htmlFor=\"instagram\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Instagram\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"instagram\"\n            className=\"rounded-md border px-2 py-1\"\n            value={instagram}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setInstagram(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"twitter\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"X(æ—§Twitter)\", \"X(formerly Twitter)\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"twitter\"\n            className=\"rounded-md border px-2 py-1\"\n            value={twitter}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setTwitter(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"github\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Github\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"github\"\n            className=\"rounded-md border px-2 py-1\"\n            value={github}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setGithub(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"mail\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\", \"Email Address\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"mail\"\n            className=\"rounded-md border px-2 py-1\"\n            value={mail}\n            placeholder={\"\"}\n            maxLength={320}\n            onChange={(e) => setMail(e.target.value)}\n          />\n        </div>\n        <Separator />\n        <Button\n          disabled={isUpdating}\n          onClick={onSubmit}\n          className=\"ml-auto block w-full\"\n        >\n          {isUpdating ? (\n            <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n          ) : (\n            <p>{t(\"æ¬¡ã¸\", \"Next\")}</p>\n          )}\n        </Button>\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      createdBookmarksCount\n      login\n      nanoid\n      name\n      receivedLikesCount\n      receivedViewsCount\n      awardsCount\n      followCount\n      followersCount\n      worksCount\n      iconUrl\n      headerImageUrl\n      webFcmToken\n      featuredSensitiveWorks {\n        ...DialogWork\n      }\n      featuredWorks {\n        ...DialogWork\n      }\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n    }\n  }`,\n  [DialogWorkFragment],\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserProfileMutation = graphql(\n  `mutation UpdateUserProfile($input: UpdateUserProfileInput!) {\n    updateUserProfile(input: $input) {\n      id\n      name\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.profile._index/components/profile-editor-form.tsx"},"span":[12291,12513],"sourceCode":"import { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { CropImageField } from \"~/components/crop-image-field\"\nimport { Button } from \"~/components/ui/button\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { DialogWorkFragment } from \"~/routes/($lang).my._index/components/select-created-works-dialog\"\nimport { useQuery, useSuspenseQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon, Pencil } from \"lucide-react\"\nimport { useContext, useState } from \"react\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { toast } from \"sonner\"\nimport { useNavigate } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function ProfileEditorForm () {\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const { data: user } = useSuspenseQuery(userQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const navigate = useNavigate()\n\n  const userInfo = user?.user\n\n  const [userName, setUserName] = useState(userInfo?.name ?? \"\")\n\n  const [profile, setProfile] = useState(userInfo?.biography ?? \"\")\n\n  const [enProfile, setEnProfile] = useState(userInfo?.enBiography ?? \"\")\n\n  const [website, setWebsite] = useState(userInfo?.siteURL ?? \"\")\n\n  const [instagram, setInstagram] = useState(userInfo?.instagramAccountId ?? \"\")\n\n  const [twitter, setTwitter] = useState(userInfo?.twitterAccountId ?? \"\")\n\n  const [github, setGithub] = useState(userInfo?.githubAccountId ?? \"\")\n\n  const [mail, setMail] = useState(userInfo?.mailAddress ?? \"\")\n\n  const [profileImage, setProfileImage] = useState(\"\")\n\n  const [headerImage, setHeaderImage] = useState(\"\")\n\n  const { data: token, refetch: tokenRefetch } = useQuery(viewerTokenQuery)\n\n  const [selectedPickupWorks, _setSelectedPickupWorks] = useState(\n    userInfo?.featuredWorks ?? [],\n  )\n\n  const [selectedPickupSensitiveWorks, _setSelectedPickupSensitiveWorks] =\n    useState(userInfo?.featuredSensitiveWorks ?? [])\n\n  const [updateProfile, { loading: isUpdating }] = useMutation(\n    updateUserProfileMutation,\n  )\n\n  const onSubmit = async () => {\n    if (isUpdating || authContext.userId === null) {\n      return\n    }\n\n    const iconUrl = profileImage\n      ? await uploadPublicImage(profileImage, token?.viewer?.token)\n      : null\n\n    const headerUrl = headerImage\n      ? await uploadPublicImage(headerImage, token?.viewer?.token)\n      : null\n\n    await updateProfile({\n      variables: {\n        input: {\n          displayName: userName,\n          biography: profile,\n          enBiography: enProfile,\n          homeUrl: website,\n          instagramAccountId: instagram,\n          twitterAccountId: twitter,\n          githubAccountId: github,\n          mailAddress: mail,\n          ...(iconUrl && {\n            iconUrl: iconUrl,\n          }),\n          ...(headerUrl && {\n            headerImageUrl: headerUrl,\n          }),\n          featuredWorkIds: selectedPickupWorks.map((work) => work.id),\n          featuredSensitiveWorkIds: selectedPickupSensitiveWorks.map(\n            (work) => work.id,\n          ),\n        },\n      },\n    })\n\n    toast(t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚\", \"Profile updated.\"))\n\n    navigate(\"/new/settings\")\n  }\n\n  const profileImageSrc =\n    profileImage.length > 0 ? profileImage : userInfo?.iconUrl\n\n  const headerImageSrc =\n    headerImage.length > 0 ? headerImage : userInfo?.headerImageUrl\n\n  return (\n    <>\n      <div className=\"container mx-auto max-w-4xl space-y-8 p-6\">\n        {/* ã‚¦ã‚§ãƒ«ã‚«ãƒ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}\n        <div className=\"rounded-xl border border-gray-100 bg-gradient-to-r from-blue-50 to-purple-50 p-8\">\n          <div className=\"space-y-4 text-center\">\n            <h1 className=\"font-bold text-3xl text-gray-800\">\n              {t(\"Aipictorsã¸ã‚ˆã†ã“ãï¼\", \"Welcome to Aipictors!\")}\n            </h1>\n            <p className=\"text-gray-600 text-lg\">\n              {t(\n                \"æ—¥æœ¬æœ€å¤§ç´šã®AIã‚¤ãƒ©ã‚¹ãƒˆãƒ»å°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆã§ã™\",\n                \"Japan's largest AI illustration and novel posting site\",\n              )}\n            </p>\n            <div className=\"mt-6 grid gap-4 md:grid-cols-3\">\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-blue-500\">ğŸ¨</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ä½œå“æŠ•ç¨¿\", \"Post Artwork\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"AIã‚¤ãƒ©ã‚¹ãƒˆã‚„å°èª¬ã‚’æŠ•ç¨¿ã—ã¦ã€å¤šãã®äººã«è¦‹ã¦ã‚‚ã‚‰ãŠã†\",\n                    \"Share your AI artwork and novels with many people\",\n                  )}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-green-500\">ğŸ‘¥</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£\", \"Community\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"ä»–ã®ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã¨ã¤ãªãŒã‚Šã€ãŠäº’ã„ã®ä½œå“ã‚’æ¥½ã—ã‚‚ã†\",\n                    \"Connect with other creators and enjoy each other's work\",\n                  )}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-purple-500\">ğŸ†</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ\", \"Contests\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"å®šæœŸçš„ã«é–‹å‚¬ã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ã‚¹ãƒˆã«å‚åŠ ã—ã¦è…•è©¦ã—\",\n                    \"Participate in regular contests to test your skills\",\n                  )}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šèª¬æ˜ */}\n        <div className=\"rounded-xl border border-yellow-200 bg-yellow-50 p-6\">\n          <h2 className=\"mb-4 font-bold text-gray-800 text-xl\">\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šã«ã¤ã„ã¦\", \"About Profile Setup\")}\n          </h2>\n          <div className=\"space-y-3 text-gray-700\">\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                1\n              </span>\n              <p>\n                {t(\n                  \"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚„ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚’è¨­å®šã—ã¦ã€ã‚ãªãŸã‚‰ã—ã•ã‚’è¡¨ç¾ã—ã¾ã—ã‚‡ã†\",\n                  \"Set your nickname and profile image to express yourself\",\n                )}\n              </p>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                2\n              </span>\n              <p>\n                {t(\n                  \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ–‡ç« ã§è‡ªå·±ç´¹ä»‹ã‚„èˆˆå‘³ã®ã‚ã‚‹ã“ã¨ã‚’æ›¸ã„ã¦ã¿ã¾ã—ã‚‡ã†\",\n                  \"Write a self-introduction and your interests in your profile\",\n                )}\n              </p>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                3\n              </span>\n              <p>\n                {t(\n                  \"SNSã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é€£æºã—ã¦ã€ã‚ˆã‚Šå¤šãã®äººã¨ã¤ãªãŒã‚Šã¾ã—ã‚‡ã†\",\n                  \"Link your SNS accounts to connect with more people\",\n                )}\n              </p>\n            </div>\n          </div>\n          <div className=\"mt-4 rounded-lg border border-blue-200 bg-blue-50 p-4\">\n            <p className=\"text-blue-800 text-sm\">\n              ğŸ’¡{\" \"}\n              {t(\n                \"ã™ã¹ã¦ã®é …ç›®ã¯å¾Œã‹ã‚‰è¨­å®šç”»é¢ã§å¤‰æ›´ã§ãã‚‹ã®ã§ã€ã¾ãšã¯æ°—è»½ã«è¨­å®šã—ã¦ã¿ã¦ãã ã•ã„\",\n                \"All items can be changed later in the settings, so feel free to start with basic setup\",\n              )}\n            </p>\n          </div>\n        </div>\n        <div className=\"justify-between\">\n          <div className=\"relative\">\n            {headerImageSrc ? (\n              <img\n                className=\"h-auto max-h-64 w-full object-cover\"\n                src={headerImageSrc}\n                alt=\"header\"\n              />\n            ) : (\n              <div className=\"h-40 w-full bg-gray-700\" />\n            )}\n            <div className=\"absolute bottom-[-24px] left-2 size-32\">\n              {profileImageSrc ? (\n                <img\n                  className=\"absolute size-32 rounded-full border-2\"\n                  src={profileImageSrc}\n                  alt=\"header\"\n                />\n              ) : (\n                <div className=\"size-32 rounded-full border-2 bg-gray-700\" />\n              )}\n\n              <CropImageField\n                isHidePreviewImage={false}\n                cropWidth={240}\n                cropHeight={240}\n                onDeleteImage={() => {\n                  setProfileImage(\"\")\n                }}\n                onCropToBase64={(base64: string) => {\n                  try {\n                    console.log(\"base64\", base64)\n                    setProfileImage(base64)\n                  } catch (error) {\n                    console.error(\"Error in onCropToBase64:\", error)\n                  }\n                }}\n                fileExtension={\"webp\"}\n              >\n                <Button\n                  className=\"absolute top-0 right-0 size-8 rounded-full p-0\"\n                  variant={\"secondary\"}\n                >\n                  <Pencil className=\"size-4\" />\n                </Button>\n              </CropImageField>\n            </div>\n\n            <CropImageField\n              isHidePreviewImage={false}\n              cropWidth={1200}\n              cropHeight={627}\n              onDeleteImage={() => {\n                setHeaderImage(\"\")\n              }}\n              onCropToBase64={setHeaderImage}\n              fileExtension={\"webp\"}\n            >\n              <Button\n                className=\"absolute top-1 right-1 size-8 rounded-full p-0\"\n                variant={\"secondary\"}\n              >\n                <Pencil className=\"size-4\" />\n              </Button>\n            </CropImageField>\n          </div>\n          <p className=\"mt-8\">\n            {t(\n              \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒã«R-18ç”»åƒã¯æ²è¼‰ã§ãã¾ã›ã‚“ã€‚\",\n              \"You cannot upload R-18 images as profile or header images.\",\n            )}\n          </p>\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"nickname\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ \", \"Nickname\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"nickname\"\n            maxLength={32}\n            minLength={1}\n            value={userName}\n            onChange={(e) => setUserName(e.target.value)}\n            className=\"rounded-md border px-2 py-1\"\n            defaultValue=\"Aipictors/AIã‚¤ãƒ©ã‚¹ãƒˆæŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIå°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIçµµ\"\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"profile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"profile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={320}\n            value={profile}\n            onChange={(e) => setProfile(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"enProfile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"è‹±èªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"English Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"enProfile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={640}\n            value={enProfile}\n            onChange={(e) => setEnProfile(e.target.value)}\n          />\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"website\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"Webã‚µã‚¤ãƒˆ\", \"Website\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"website\"\n            className=\"rounded-md border px-2 py-1\"\n            value={website}\n            maxLength={1000}\n            onChange={(e) => setWebsite(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <p className=\"font-semibold\">\n            {t(\"SNSãƒªãƒ³ã‚¯ï¼ˆ@ãƒãƒ¼ã‚¯ã¯ä¸è¦ï¼‰\", \"SNS Links (without @)\")}\n          </p>\n          <label\n            htmlFor=\"instagram\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Instagram\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"instagram\"\n            className=\"rounded-md border px-2 py-1\"\n            value={instagram}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setInstagram(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"twitter\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"X(æ—§Twitter)\", \"X(formerly Twitter)\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"twitter\"\n            className=\"rounded-md border px-2 py-1\"\n            value={twitter}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setTwitter(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"github\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Github\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"github\"\n            className=\"rounded-md border px-2 py-1\"\n            value={github}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setGithub(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"mail\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\", \"Email Address\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"mail\"\n            className=\"rounded-md border px-2 py-1\"\n            value={mail}\n            placeholder={\"\"}\n            maxLength={320}\n            onChange={(e) => setMail(e.target.value)}\n          />\n        </div>\n        <Separator />\n        <Button\n          disabled={isUpdating}\n          onClick={onSubmit}\n          className=\"ml-auto block w-full\"\n        >\n          {isUpdating ? (\n            <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n          ) : (\n            <p>{t(\"æ¬¡ã¸\", \"Next\")}</p>\n          )}\n        </Button>\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      createdBookmarksCount\n      login\n      nanoid\n      name\n      receivedLikesCount\n      receivedViewsCount\n      awardsCount\n      followCount\n      followersCount\n      worksCount\n      iconUrl\n      headerImageUrl\n      webFcmToken\n      featuredSensitiveWorks {\n        ...DialogWork\n      }\n      featuredWorks {\n        ...DialogWork\n      }\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n    }\n  }`,\n  [DialogWorkFragment],\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserProfileMutation = graphql(\n  `mutation UpdateUserProfile($input: UpdateUserProfileInput!) {\n    updateUserProfile(input: $input) {\n      id\n      name\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.profile._index/components/profile-editor-form.tsx"},"span":[12863,13091],"sourceCode":"import { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { CropImageField } from \"~/components/crop-image-field\"\nimport { Button } from \"~/components/ui/button\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { DialogWorkFragment } from \"~/routes/($lang).my._index/components/select-created-works-dialog\"\nimport { useQuery, useSuspenseQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon, Pencil } from \"lucide-react\"\nimport { useContext, useState } from \"react\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { toast } from \"sonner\"\nimport { useNavigate } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function ProfileEditorForm () {\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const { data: user } = useSuspenseQuery(userQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const navigate = useNavigate()\n\n  const userInfo = user?.user\n\n  const [userName, setUserName] = useState(userInfo?.name ?? \"\")\n\n  const [profile, setProfile] = useState(userInfo?.biography ?? \"\")\n\n  const [enProfile, setEnProfile] = useState(userInfo?.enBiography ?? \"\")\n\n  const [website, setWebsite] = useState(userInfo?.siteURL ?? \"\")\n\n  const [instagram, setInstagram] = useState(userInfo?.instagramAccountId ?? \"\")\n\n  const [twitter, setTwitter] = useState(userInfo?.twitterAccountId ?? \"\")\n\n  const [github, setGithub] = useState(userInfo?.githubAccountId ?? \"\")\n\n  const [mail, setMail] = useState(userInfo?.mailAddress ?? \"\")\n\n  const [profileImage, setProfileImage] = useState(\"\")\n\n  const [headerImage, setHeaderImage] = useState(\"\")\n\n  const { data: token, refetch: tokenRefetch } = useQuery(viewerTokenQuery)\n\n  const [selectedPickupWorks, _setSelectedPickupWorks] = useState(\n    userInfo?.featuredWorks ?? [],\n  )\n\n  const [selectedPickupSensitiveWorks, _setSelectedPickupSensitiveWorks] =\n    useState(userInfo?.featuredSensitiveWorks ?? [])\n\n  const [updateProfile, { loading: isUpdating }] = useMutation(\n    updateUserProfileMutation,\n  )\n\n  const onSubmit = async () => {\n    if (isUpdating || authContext.userId === null) {\n      return\n    }\n\n    const iconUrl = profileImage\n      ? await uploadPublicImage(profileImage, token?.viewer?.token)\n      : null\n\n    const headerUrl = headerImage\n      ? await uploadPublicImage(headerImage, token?.viewer?.token)\n      : null\n\n    await updateProfile({\n      variables: {\n        input: {\n          displayName: userName,\n          biography: profile,\n          enBiography: enProfile,\n          homeUrl: website,\n          instagramAccountId: instagram,\n          twitterAccountId: twitter,\n          githubAccountId: github,\n          mailAddress: mail,\n          ...(iconUrl && {\n            iconUrl: iconUrl,\n          }),\n          ...(headerUrl && {\n            headerImageUrl: headerUrl,\n          }),\n          featuredWorkIds: selectedPickupWorks.map((work) => work.id),\n          featuredSensitiveWorkIds: selectedPickupSensitiveWorks.map(\n            (work) => work.id,\n          ),\n        },\n      },\n    })\n\n    toast(t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚\", \"Profile updated.\"))\n\n    navigate(\"/new/settings\")\n  }\n\n  const profileImageSrc =\n    profileImage.length > 0 ? profileImage : userInfo?.iconUrl\n\n  const headerImageSrc =\n    headerImage.length > 0 ? headerImage : userInfo?.headerImageUrl\n\n  return (\n    <>\n      <div className=\"container mx-auto max-w-4xl space-y-8 p-6\">\n        {/* ã‚¦ã‚§ãƒ«ã‚«ãƒ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}\n        <div className=\"rounded-xl border border-gray-100 bg-gradient-to-r from-blue-50 to-purple-50 p-8\">\n          <div className=\"space-y-4 text-center\">\n            <h1 className=\"font-bold text-3xl text-gray-800\">\n              {t(\"Aipictorsã¸ã‚ˆã†ã“ãï¼\", \"Welcome to Aipictors!\")}\n            </h1>\n            <p className=\"text-gray-600 text-lg\">\n              {t(\n                \"æ—¥æœ¬æœ€å¤§ç´šã®AIã‚¤ãƒ©ã‚¹ãƒˆãƒ»å°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆã§ã™\",\n                \"Japan's largest AI illustration and novel posting site\",\n              )}\n            </p>\n            <div className=\"mt-6 grid gap-4 md:grid-cols-3\">\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-blue-500\">ğŸ¨</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ä½œå“æŠ•ç¨¿\", \"Post Artwork\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"AIã‚¤ãƒ©ã‚¹ãƒˆã‚„å°èª¬ã‚’æŠ•ç¨¿ã—ã¦ã€å¤šãã®äººã«è¦‹ã¦ã‚‚ã‚‰ãŠã†\",\n                    \"Share your AI artwork and novels with many people\",\n                  )}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-green-500\">ğŸ‘¥</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£\", \"Community\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"ä»–ã®ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã¨ã¤ãªãŒã‚Šã€ãŠäº’ã„ã®ä½œå“ã‚’æ¥½ã—ã‚‚ã†\",\n                    \"Connect with other creators and enjoy each other's work\",\n                  )}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-purple-500\">ğŸ†</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ\", \"Contests\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"å®šæœŸçš„ã«é–‹å‚¬ã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ã‚¹ãƒˆã«å‚åŠ ã—ã¦è…•è©¦ã—\",\n                    \"Participate in regular contests to test your skills\",\n                  )}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šèª¬æ˜ */}\n        <div className=\"rounded-xl border border-yellow-200 bg-yellow-50 p-6\">\n          <h2 className=\"mb-4 font-bold text-gray-800 text-xl\">\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šã«ã¤ã„ã¦\", \"About Profile Setup\")}\n          </h2>\n          <div className=\"space-y-3 text-gray-700\">\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                1\n              </span>\n              <p>\n                {t(\n                  \"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚„ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚’è¨­å®šã—ã¦ã€ã‚ãªãŸã‚‰ã—ã•ã‚’è¡¨ç¾ã—ã¾ã—ã‚‡ã†\",\n                  \"Set your nickname and profile image to express yourself\",\n                )}\n              </p>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                2\n              </span>\n              <p>\n                {t(\n                  \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ–‡ç« ã§è‡ªå·±ç´¹ä»‹ã‚„èˆˆå‘³ã®ã‚ã‚‹ã“ã¨ã‚’æ›¸ã„ã¦ã¿ã¾ã—ã‚‡ã†\",\n                  \"Write a self-introduction and your interests in your profile\",\n                )}\n              </p>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                3\n              </span>\n              <p>\n                {t(\n                  \"SNSã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é€£æºã—ã¦ã€ã‚ˆã‚Šå¤šãã®äººã¨ã¤ãªãŒã‚Šã¾ã—ã‚‡ã†\",\n                  \"Link your SNS accounts to connect with more people\",\n                )}\n              </p>\n            </div>\n          </div>\n          <div className=\"mt-4 rounded-lg border border-blue-200 bg-blue-50 p-4\">\n            <p className=\"text-blue-800 text-sm\">\n              ğŸ’¡{\" \"}\n              {t(\n                \"ã™ã¹ã¦ã®é …ç›®ã¯å¾Œã‹ã‚‰è¨­å®šç”»é¢ã§å¤‰æ›´ã§ãã‚‹ã®ã§ã€ã¾ãšã¯æ°—è»½ã«è¨­å®šã—ã¦ã¿ã¦ãã ã•ã„\",\n                \"All items can be changed later in the settings, so feel free to start with basic setup\",\n              )}\n            </p>\n          </div>\n        </div>\n        <div className=\"justify-between\">\n          <div className=\"relative\">\n            {headerImageSrc ? (\n              <img\n                className=\"h-auto max-h-64 w-full object-cover\"\n                src={headerImageSrc}\n                alt=\"header\"\n              />\n            ) : (\n              <div className=\"h-40 w-full bg-gray-700\" />\n            )}\n            <div className=\"absolute bottom-[-24px] left-2 size-32\">\n              {profileImageSrc ? (\n                <img\n                  className=\"absolute size-32 rounded-full border-2\"\n                  src={profileImageSrc}\n                  alt=\"header\"\n                />\n              ) : (\n                <div className=\"size-32 rounded-full border-2 bg-gray-700\" />\n              )}\n\n              <CropImageField\n                isHidePreviewImage={false}\n                cropWidth={240}\n                cropHeight={240}\n                onDeleteImage={() => {\n                  setProfileImage(\"\")\n                }}\n                onCropToBase64={(base64: string) => {\n                  try {\n                    console.log(\"base64\", base64)\n                    setProfileImage(base64)\n                  } catch (error) {\n                    console.error(\"Error in onCropToBase64:\", error)\n                  }\n                }}\n                fileExtension={\"webp\"}\n              >\n                <Button\n                  className=\"absolute top-0 right-0 size-8 rounded-full p-0\"\n                  variant={\"secondary\"}\n                >\n                  <Pencil className=\"size-4\" />\n                </Button>\n              </CropImageField>\n            </div>\n\n            <CropImageField\n              isHidePreviewImage={false}\n              cropWidth={1200}\n              cropHeight={627}\n              onDeleteImage={() => {\n                setHeaderImage(\"\")\n              }}\n              onCropToBase64={setHeaderImage}\n              fileExtension={\"webp\"}\n            >\n              <Button\n                className=\"absolute top-1 right-1 size-8 rounded-full p-0\"\n                variant={\"secondary\"}\n              >\n                <Pencil className=\"size-4\" />\n              </Button>\n            </CropImageField>\n          </div>\n          <p className=\"mt-8\">\n            {t(\n              \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒã«R-18ç”»åƒã¯æ²è¼‰ã§ãã¾ã›ã‚“ã€‚\",\n              \"You cannot upload R-18 images as profile or header images.\",\n            )}\n          </p>\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"nickname\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ \", \"Nickname\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"nickname\"\n            maxLength={32}\n            minLength={1}\n            value={userName}\n            onChange={(e) => setUserName(e.target.value)}\n            className=\"rounded-md border px-2 py-1\"\n            defaultValue=\"Aipictors/AIã‚¤ãƒ©ã‚¹ãƒˆæŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIå°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIçµµ\"\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"profile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"profile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={320}\n            value={profile}\n            onChange={(e) => setProfile(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"enProfile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"è‹±èªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"English Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"enProfile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={640}\n            value={enProfile}\n            onChange={(e) => setEnProfile(e.target.value)}\n          />\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"website\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"Webã‚µã‚¤ãƒˆ\", \"Website\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"website\"\n            className=\"rounded-md border px-2 py-1\"\n            value={website}\n            maxLength={1000}\n            onChange={(e) => setWebsite(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <p className=\"font-semibold\">\n            {t(\"SNSãƒªãƒ³ã‚¯ï¼ˆ@ãƒãƒ¼ã‚¯ã¯ä¸è¦ï¼‰\", \"SNS Links (without @)\")}\n          </p>\n          <label\n            htmlFor=\"instagram\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Instagram\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"instagram\"\n            className=\"rounded-md border px-2 py-1\"\n            value={instagram}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setInstagram(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"twitter\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"X(æ—§Twitter)\", \"X(formerly Twitter)\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"twitter\"\n            className=\"rounded-md border px-2 py-1\"\n            value={twitter}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setTwitter(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"github\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Github\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"github\"\n            className=\"rounded-md border px-2 py-1\"\n            value={github}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setGithub(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"mail\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\", \"Email Address\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"mail\"\n            className=\"rounded-md border px-2 py-1\"\n            value={mail}\n            placeholder={\"\"}\n            maxLength={320}\n            onChange={(e) => setMail(e.target.value)}\n          />\n        </div>\n        <Separator />\n        <Button\n          disabled={isUpdating}\n          onClick={onSubmit}\n          className=\"ml-auto block w-full\"\n        >\n          {isUpdating ? (\n            <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n          ) : (\n            <p>{t(\"æ¬¡ã¸\", \"Next\")}</p>\n          )}\n        </Button>\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      createdBookmarksCount\n      login\n      nanoid\n      name\n      receivedLikesCount\n      receivedViewsCount\n      awardsCount\n      followCount\n      followersCount\n      worksCount\n      iconUrl\n      headerImageUrl\n      webFcmToken\n      featuredSensitiveWorks {\n        ...DialogWork\n      }\n      featuredWorks {\n        ...DialogWork\n      }\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n    }\n  }`,\n  [DialogWorkFragment],\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserProfileMutation = graphql(\n  `mutation UpdateUserProfile($input: UpdateUserProfileInput!) {\n    updateUserProfile(input: $input) {\n      id\n      name\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.profile._index/components/profile-editor-form.tsx"},"span":[13420,13654],"sourceCode":"import { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { CropImageField } from \"~/components/crop-image-field\"\nimport { Button } from \"~/components/ui/button\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { DialogWorkFragment } from \"~/routes/($lang).my._index/components/select-created-works-dialog\"\nimport { useQuery, useSuspenseQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon, Pencil } from \"lucide-react\"\nimport { useContext, useState } from \"react\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { toast } from \"sonner\"\nimport { useNavigate } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function ProfileEditorForm () {\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const { data: user } = useSuspenseQuery(userQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const navigate = useNavigate()\n\n  const userInfo = user?.user\n\n  const [userName, setUserName] = useState(userInfo?.name ?? \"\")\n\n  const [profile, setProfile] = useState(userInfo?.biography ?? \"\")\n\n  const [enProfile, setEnProfile] = useState(userInfo?.enBiography ?? \"\")\n\n  const [website, setWebsite] = useState(userInfo?.siteURL ?? \"\")\n\n  const [instagram, setInstagram] = useState(userInfo?.instagramAccountId ?? \"\")\n\n  const [twitter, setTwitter] = useState(userInfo?.twitterAccountId ?? \"\")\n\n  const [github, setGithub] = useState(userInfo?.githubAccountId ?? \"\")\n\n  const [mail, setMail] = useState(userInfo?.mailAddress ?? \"\")\n\n  const [profileImage, setProfileImage] = useState(\"\")\n\n  const [headerImage, setHeaderImage] = useState(\"\")\n\n  const { data: token, refetch: tokenRefetch } = useQuery(viewerTokenQuery)\n\n  const [selectedPickupWorks, _setSelectedPickupWorks] = useState(\n    userInfo?.featuredWorks ?? [],\n  )\n\n  const [selectedPickupSensitiveWorks, _setSelectedPickupSensitiveWorks] =\n    useState(userInfo?.featuredSensitiveWorks ?? [])\n\n  const [updateProfile, { loading: isUpdating }] = useMutation(\n    updateUserProfileMutation,\n  )\n\n  const onSubmit = async () => {\n    if (isUpdating || authContext.userId === null) {\n      return\n    }\n\n    const iconUrl = profileImage\n      ? await uploadPublicImage(profileImage, token?.viewer?.token)\n      : null\n\n    const headerUrl = headerImage\n      ? await uploadPublicImage(headerImage, token?.viewer?.token)\n      : null\n\n    await updateProfile({\n      variables: {\n        input: {\n          displayName: userName,\n          biography: profile,\n          enBiography: enProfile,\n          homeUrl: website,\n          instagramAccountId: instagram,\n          twitterAccountId: twitter,\n          githubAccountId: github,\n          mailAddress: mail,\n          ...(iconUrl && {\n            iconUrl: iconUrl,\n          }),\n          ...(headerUrl && {\n            headerImageUrl: headerUrl,\n          }),\n          featuredWorkIds: selectedPickupWorks.map((work) => work.id),\n          featuredSensitiveWorkIds: selectedPickupSensitiveWorks.map(\n            (work) => work.id,\n          ),\n        },\n      },\n    })\n\n    toast(t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚\", \"Profile updated.\"))\n\n    navigate(\"/new/settings\")\n  }\n\n  const profileImageSrc =\n    profileImage.length > 0 ? profileImage : userInfo?.iconUrl\n\n  const headerImageSrc =\n    headerImage.length > 0 ? headerImage : userInfo?.headerImageUrl\n\n  return (\n    <>\n      <div className=\"container mx-auto max-w-4xl space-y-8 p-6\">\n        {/* ã‚¦ã‚§ãƒ«ã‚«ãƒ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}\n        <div className=\"rounded-xl border border-gray-100 bg-gradient-to-r from-blue-50 to-purple-50 p-8\">\n          <div className=\"space-y-4 text-center\">\n            <h1 className=\"font-bold text-3xl text-gray-800\">\n              {t(\"Aipictorsã¸ã‚ˆã†ã“ãï¼\", \"Welcome to Aipictors!\")}\n            </h1>\n            <p className=\"text-gray-600 text-lg\">\n              {t(\n                \"æ—¥æœ¬æœ€å¤§ç´šã®AIã‚¤ãƒ©ã‚¹ãƒˆãƒ»å°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆã§ã™\",\n                \"Japan's largest AI illustration and novel posting site\",\n              )}\n            </p>\n            <div className=\"mt-6 grid gap-4 md:grid-cols-3\">\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-blue-500\">ğŸ¨</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ä½œå“æŠ•ç¨¿\", \"Post Artwork\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"AIã‚¤ãƒ©ã‚¹ãƒˆã‚„å°èª¬ã‚’æŠ•ç¨¿ã—ã¦ã€å¤šãã®äººã«è¦‹ã¦ã‚‚ã‚‰ãŠã†\",\n                    \"Share your AI artwork and novels with many people\",\n                  )}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-green-500\">ğŸ‘¥</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£\", \"Community\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"ä»–ã®ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã¨ã¤ãªãŒã‚Šã€ãŠäº’ã„ã®ä½œå“ã‚’æ¥½ã—ã‚‚ã†\",\n                    \"Connect with other creators and enjoy each other's work\",\n                  )}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-purple-500\">ğŸ†</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ\", \"Contests\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"å®šæœŸçš„ã«é–‹å‚¬ã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ã‚¹ãƒˆã«å‚åŠ ã—ã¦è…•è©¦ã—\",\n                    \"Participate in regular contests to test your skills\",\n                  )}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šèª¬æ˜ */}\n        <div className=\"rounded-xl border border-yellow-200 bg-yellow-50 p-6\">\n          <h2 className=\"mb-4 font-bold text-gray-800 text-xl\">\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šã«ã¤ã„ã¦\", \"About Profile Setup\")}\n          </h2>\n          <div className=\"space-y-3 text-gray-700\">\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                1\n              </span>\n              <p>\n                {t(\n                  \"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚„ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚’è¨­å®šã—ã¦ã€ã‚ãªãŸã‚‰ã—ã•ã‚’è¡¨ç¾ã—ã¾ã—ã‚‡ã†\",\n                  \"Set your nickname and profile image to express yourself\",\n                )}\n              </p>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                2\n              </span>\n              <p>\n                {t(\n                  \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ–‡ç« ã§è‡ªå·±ç´¹ä»‹ã‚„èˆˆå‘³ã®ã‚ã‚‹ã“ã¨ã‚’æ›¸ã„ã¦ã¿ã¾ã—ã‚‡ã†\",\n                  \"Write a self-introduction and your interests in your profile\",\n                )}\n              </p>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                3\n              </span>\n              <p>\n                {t(\n                  \"SNSã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é€£æºã—ã¦ã€ã‚ˆã‚Šå¤šãã®äººã¨ã¤ãªãŒã‚Šã¾ã—ã‚‡ã†\",\n                  \"Link your SNS accounts to connect with more people\",\n                )}\n              </p>\n            </div>\n          </div>\n          <div className=\"mt-4 rounded-lg border border-blue-200 bg-blue-50 p-4\">\n            <p className=\"text-blue-800 text-sm\">\n              ğŸ’¡{\" \"}\n              {t(\n                \"ã™ã¹ã¦ã®é …ç›®ã¯å¾Œã‹ã‚‰è¨­å®šç”»é¢ã§å¤‰æ›´ã§ãã‚‹ã®ã§ã€ã¾ãšã¯æ°—è»½ã«è¨­å®šã—ã¦ã¿ã¦ãã ã•ã„\",\n                \"All items can be changed later in the settings, so feel free to start with basic setup\",\n              )}\n            </p>\n          </div>\n        </div>\n        <div className=\"justify-between\">\n          <div className=\"relative\">\n            {headerImageSrc ? (\n              <img\n                className=\"h-auto max-h-64 w-full object-cover\"\n                src={headerImageSrc}\n                alt=\"header\"\n              />\n            ) : (\n              <div className=\"h-40 w-full bg-gray-700\" />\n            )}\n            <div className=\"absolute bottom-[-24px] left-2 size-32\">\n              {profileImageSrc ? (\n                <img\n                  className=\"absolute size-32 rounded-full border-2\"\n                  src={profileImageSrc}\n                  alt=\"header\"\n                />\n              ) : (\n                <div className=\"size-32 rounded-full border-2 bg-gray-700\" />\n              )}\n\n              <CropImageField\n                isHidePreviewImage={false}\n                cropWidth={240}\n                cropHeight={240}\n                onDeleteImage={() => {\n                  setProfileImage(\"\")\n                }}\n                onCropToBase64={(base64: string) => {\n                  try {\n                    console.log(\"base64\", base64)\n                    setProfileImage(base64)\n                  } catch (error) {\n                    console.error(\"Error in onCropToBase64:\", error)\n                  }\n                }}\n                fileExtension={\"webp\"}\n              >\n                <Button\n                  className=\"absolute top-0 right-0 size-8 rounded-full p-0\"\n                  variant={\"secondary\"}\n                >\n                  <Pencil className=\"size-4\" />\n                </Button>\n              </CropImageField>\n            </div>\n\n            <CropImageField\n              isHidePreviewImage={false}\n              cropWidth={1200}\n              cropHeight={627}\n              onDeleteImage={() => {\n                setHeaderImage(\"\")\n              }}\n              onCropToBase64={setHeaderImage}\n              fileExtension={\"webp\"}\n            >\n              <Button\n                className=\"absolute top-1 right-1 size-8 rounded-full p-0\"\n                variant={\"secondary\"}\n              >\n                <Pencil className=\"size-4\" />\n              </Button>\n            </CropImageField>\n          </div>\n          <p className=\"mt-8\">\n            {t(\n              \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒã«R-18ç”»åƒã¯æ²è¼‰ã§ãã¾ã›ã‚“ã€‚\",\n              \"You cannot upload R-18 images as profile or header images.\",\n            )}\n          </p>\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"nickname\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ \", \"Nickname\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"nickname\"\n            maxLength={32}\n            minLength={1}\n            value={userName}\n            onChange={(e) => setUserName(e.target.value)}\n            className=\"rounded-md border px-2 py-1\"\n            defaultValue=\"Aipictors/AIã‚¤ãƒ©ã‚¹ãƒˆæŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIå°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIçµµ\"\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"profile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"profile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={320}\n            value={profile}\n            onChange={(e) => setProfile(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"enProfile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"è‹±èªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"English Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"enProfile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={640}\n            value={enProfile}\n            onChange={(e) => setEnProfile(e.target.value)}\n          />\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"website\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"Webã‚µã‚¤ãƒˆ\", \"Website\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"website\"\n            className=\"rounded-md border px-2 py-1\"\n            value={website}\n            maxLength={1000}\n            onChange={(e) => setWebsite(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <p className=\"font-semibold\">\n            {t(\"SNSãƒªãƒ³ã‚¯ï¼ˆ@ãƒãƒ¼ã‚¯ã¯ä¸è¦ï¼‰\", \"SNS Links (without @)\")}\n          </p>\n          <label\n            htmlFor=\"instagram\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Instagram\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"instagram\"\n            className=\"rounded-md border px-2 py-1\"\n            value={instagram}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setInstagram(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"twitter\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"X(æ—§Twitter)\", \"X(formerly Twitter)\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"twitter\"\n            className=\"rounded-md border px-2 py-1\"\n            value={twitter}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setTwitter(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"github\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Github\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"github\"\n            className=\"rounded-md border px-2 py-1\"\n            value={github}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setGithub(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"mail\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\", \"Email Address\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"mail\"\n            className=\"rounded-md border px-2 py-1\"\n            value={mail}\n            placeholder={\"\"}\n            maxLength={320}\n            onChange={(e) => setMail(e.target.value)}\n          />\n        </div>\n        <Separator />\n        <Button\n          disabled={isUpdating}\n          onClick={onSubmit}\n          className=\"ml-auto block w-full\"\n        >\n          {isUpdating ? (\n            <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n          ) : (\n            <p>{t(\"æ¬¡ã¸\", \"Next\")}</p>\n          )}\n        </Button>\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      createdBookmarksCount\n      login\n      nanoid\n      name\n      receivedLikesCount\n      receivedViewsCount\n      awardsCount\n      followCount\n      followersCount\n      worksCount\n      iconUrl\n      headerImageUrl\n      webFcmToken\n      featuredSensitiveWorks {\n        ...DialogWork\n      }\n      featuredWorks {\n        ...DialogWork\n      }\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n    }\n  }`,\n  [DialogWorkFragment],\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserProfileMutation = graphql(\n  `mutation UpdateUserProfile($input: UpdateUserProfileInput!) {\n    updateUserProfile(input: $input) {\n      id\n      name\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.profile._index/components/profile-editor-form.tsx"},"span":[14104,14373],"sourceCode":"import { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { CropImageField } from \"~/components/crop-image-field\"\nimport { Button } from \"~/components/ui/button\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { DialogWorkFragment } from \"~/routes/($lang).my._index/components/select-created-works-dialog\"\nimport { useQuery, useSuspenseQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon, Pencil } from \"lucide-react\"\nimport { useContext, useState } from \"react\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { toast } from \"sonner\"\nimport { useNavigate } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function ProfileEditorForm () {\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const { data: user } = useSuspenseQuery(userQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const navigate = useNavigate()\n\n  const userInfo = user?.user\n\n  const [userName, setUserName] = useState(userInfo?.name ?? \"\")\n\n  const [profile, setProfile] = useState(userInfo?.biography ?? \"\")\n\n  const [enProfile, setEnProfile] = useState(userInfo?.enBiography ?? \"\")\n\n  const [website, setWebsite] = useState(userInfo?.siteURL ?? \"\")\n\n  const [instagram, setInstagram] = useState(userInfo?.instagramAccountId ?? \"\")\n\n  const [twitter, setTwitter] = useState(userInfo?.twitterAccountId ?? \"\")\n\n  const [github, setGithub] = useState(userInfo?.githubAccountId ?? \"\")\n\n  const [mail, setMail] = useState(userInfo?.mailAddress ?? \"\")\n\n  const [profileImage, setProfileImage] = useState(\"\")\n\n  const [headerImage, setHeaderImage] = useState(\"\")\n\n  const { data: token, refetch: tokenRefetch } = useQuery(viewerTokenQuery)\n\n  const [selectedPickupWorks, _setSelectedPickupWorks] = useState(\n    userInfo?.featuredWorks ?? [],\n  )\n\n  const [selectedPickupSensitiveWorks, _setSelectedPickupSensitiveWorks] =\n    useState(userInfo?.featuredSensitiveWorks ?? [])\n\n  const [updateProfile, { loading: isUpdating }] = useMutation(\n    updateUserProfileMutation,\n  )\n\n  const onSubmit = async () => {\n    if (isUpdating || authContext.userId === null) {\n      return\n    }\n\n    const iconUrl = profileImage\n      ? await uploadPublicImage(profileImage, token?.viewer?.token)\n      : null\n\n    const headerUrl = headerImage\n      ? await uploadPublicImage(headerImage, token?.viewer?.token)\n      : null\n\n    await updateProfile({\n      variables: {\n        input: {\n          displayName: userName,\n          biography: profile,\n          enBiography: enProfile,\n          homeUrl: website,\n          instagramAccountId: instagram,\n          twitterAccountId: twitter,\n          githubAccountId: github,\n          mailAddress: mail,\n          ...(iconUrl && {\n            iconUrl: iconUrl,\n          }),\n          ...(headerUrl && {\n            headerImageUrl: headerUrl,\n          }),\n          featuredWorkIds: selectedPickupWorks.map((work) => work.id),\n          featuredSensitiveWorkIds: selectedPickupSensitiveWorks.map(\n            (work) => work.id,\n          ),\n        },\n      },\n    })\n\n    toast(t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚\", \"Profile updated.\"))\n\n    navigate(\"/new/settings\")\n  }\n\n  const profileImageSrc =\n    profileImage.length > 0 ? profileImage : userInfo?.iconUrl\n\n  const headerImageSrc =\n    headerImage.length > 0 ? headerImage : userInfo?.headerImageUrl\n\n  return (\n    <>\n      <div className=\"container mx-auto max-w-4xl space-y-8 p-6\">\n        {/* ã‚¦ã‚§ãƒ«ã‚«ãƒ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}\n        <div className=\"rounded-xl border border-gray-100 bg-gradient-to-r from-blue-50 to-purple-50 p-8\">\n          <div className=\"space-y-4 text-center\">\n            <h1 className=\"font-bold text-3xl text-gray-800\">\n              {t(\"Aipictorsã¸ã‚ˆã†ã“ãï¼\", \"Welcome to Aipictors!\")}\n            </h1>\n            <p className=\"text-gray-600 text-lg\">\n              {t(\n                \"æ—¥æœ¬æœ€å¤§ç´šã®AIã‚¤ãƒ©ã‚¹ãƒˆãƒ»å°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆã§ã™\",\n                \"Japan's largest AI illustration and novel posting site\",\n              )}\n            </p>\n            <div className=\"mt-6 grid gap-4 md:grid-cols-3\">\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-blue-500\">ğŸ¨</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ä½œå“æŠ•ç¨¿\", \"Post Artwork\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"AIã‚¤ãƒ©ã‚¹ãƒˆã‚„å°èª¬ã‚’æŠ•ç¨¿ã—ã¦ã€å¤šãã®äººã«è¦‹ã¦ã‚‚ã‚‰ãŠã†\",\n                    \"Share your AI artwork and novels with many people\",\n                  )}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-green-500\">ğŸ‘¥</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£\", \"Community\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"ä»–ã®ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã¨ã¤ãªãŒã‚Šã€ãŠäº’ã„ã®ä½œå“ã‚’æ¥½ã—ã‚‚ã†\",\n                    \"Connect with other creators and enjoy each other's work\",\n                  )}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-purple-500\">ğŸ†</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ\", \"Contests\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"å®šæœŸçš„ã«é–‹å‚¬ã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ã‚¹ãƒˆã«å‚åŠ ã—ã¦è…•è©¦ã—\",\n                    \"Participate in regular contests to test your skills\",\n                  )}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šèª¬æ˜ */}\n        <div className=\"rounded-xl border border-yellow-200 bg-yellow-50 p-6\">\n          <h2 className=\"mb-4 font-bold text-gray-800 text-xl\">\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šã«ã¤ã„ã¦\", \"About Profile Setup\")}\n          </h2>\n          <div className=\"space-y-3 text-gray-700\">\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                1\n              </span>\n              <p>\n                {t(\n                  \"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚„ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚’è¨­å®šã—ã¦ã€ã‚ãªãŸã‚‰ã—ã•ã‚’è¡¨ç¾ã—ã¾ã—ã‚‡ã†\",\n                  \"Set your nickname and profile image to express yourself\",\n                )}\n              </p>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                2\n              </span>\n              <p>\n                {t(\n                  \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ–‡ç« ã§è‡ªå·±ç´¹ä»‹ã‚„èˆˆå‘³ã®ã‚ã‚‹ã“ã¨ã‚’æ›¸ã„ã¦ã¿ã¾ã—ã‚‡ã†\",\n                  \"Write a self-introduction and your interests in your profile\",\n                )}\n              </p>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                3\n              </span>\n              <p>\n                {t(\n                  \"SNSã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é€£æºã—ã¦ã€ã‚ˆã‚Šå¤šãã®äººã¨ã¤ãªãŒã‚Šã¾ã—ã‚‡ã†\",\n                  \"Link your SNS accounts to connect with more people\",\n                )}\n              </p>\n            </div>\n          </div>\n          <div className=\"mt-4 rounded-lg border border-blue-200 bg-blue-50 p-4\">\n            <p className=\"text-blue-800 text-sm\">\n              ğŸ’¡{\" \"}\n              {t(\n                \"ã™ã¹ã¦ã®é …ç›®ã¯å¾Œã‹ã‚‰è¨­å®šç”»é¢ã§å¤‰æ›´ã§ãã‚‹ã®ã§ã€ã¾ãšã¯æ°—è»½ã«è¨­å®šã—ã¦ã¿ã¦ãã ã•ã„\",\n                \"All items can be changed later in the settings, so feel free to start with basic setup\",\n              )}\n            </p>\n          </div>\n        </div>\n        <div className=\"justify-between\">\n          <div className=\"relative\">\n            {headerImageSrc ? (\n              <img\n                className=\"h-auto max-h-64 w-full object-cover\"\n                src={headerImageSrc}\n                alt=\"header\"\n              />\n            ) : (\n              <div className=\"h-40 w-full bg-gray-700\" />\n            )}\n            <div className=\"absolute bottom-[-24px] left-2 size-32\">\n              {profileImageSrc ? (\n                <img\n                  className=\"absolute size-32 rounded-full border-2\"\n                  src={profileImageSrc}\n                  alt=\"header\"\n                />\n              ) : (\n                <div className=\"size-32 rounded-full border-2 bg-gray-700\" />\n              )}\n\n              <CropImageField\n                isHidePreviewImage={false}\n                cropWidth={240}\n                cropHeight={240}\n                onDeleteImage={() => {\n                  setProfileImage(\"\")\n                }}\n                onCropToBase64={(base64: string) => {\n                  try {\n                    console.log(\"base64\", base64)\n                    setProfileImage(base64)\n                  } catch (error) {\n                    console.error(\"Error in onCropToBase64:\", error)\n                  }\n                }}\n                fileExtension={\"webp\"}\n              >\n                <Button\n                  className=\"absolute top-0 right-0 size-8 rounded-full p-0\"\n                  variant={\"secondary\"}\n                >\n                  <Pencil className=\"size-4\" />\n                </Button>\n              </CropImageField>\n            </div>\n\n            <CropImageField\n              isHidePreviewImage={false}\n              cropWidth={1200}\n              cropHeight={627}\n              onDeleteImage={() => {\n                setHeaderImage(\"\")\n              }}\n              onCropToBase64={setHeaderImage}\n              fileExtension={\"webp\"}\n            >\n              <Button\n                className=\"absolute top-1 right-1 size-8 rounded-full p-0\"\n                variant={\"secondary\"}\n              >\n                <Pencil className=\"size-4\" />\n              </Button>\n            </CropImageField>\n          </div>\n          <p className=\"mt-8\">\n            {t(\n              \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒã«R-18ç”»åƒã¯æ²è¼‰ã§ãã¾ã›ã‚“ã€‚\",\n              \"You cannot upload R-18 images as profile or header images.\",\n            )}\n          </p>\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"nickname\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ \", \"Nickname\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"nickname\"\n            maxLength={32}\n            minLength={1}\n            value={userName}\n            onChange={(e) => setUserName(e.target.value)}\n            className=\"rounded-md border px-2 py-1\"\n            defaultValue=\"Aipictors/AIã‚¤ãƒ©ã‚¹ãƒˆæŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIå°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIçµµ\"\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"profile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"profile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={320}\n            value={profile}\n            onChange={(e) => setProfile(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"enProfile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"è‹±èªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"English Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"enProfile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={640}\n            value={enProfile}\n            onChange={(e) => setEnProfile(e.target.value)}\n          />\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"website\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"Webã‚µã‚¤ãƒˆ\", \"Website\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"website\"\n            className=\"rounded-md border px-2 py-1\"\n            value={website}\n            maxLength={1000}\n            onChange={(e) => setWebsite(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <p className=\"font-semibold\">\n            {t(\"SNSãƒªãƒ³ã‚¯ï¼ˆ@ãƒãƒ¼ã‚¯ã¯ä¸è¦ï¼‰\", \"SNS Links (without @)\")}\n          </p>\n          <label\n            htmlFor=\"instagram\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Instagram\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"instagram\"\n            className=\"rounded-md border px-2 py-1\"\n            value={instagram}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setInstagram(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"twitter\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"X(æ—§Twitter)\", \"X(formerly Twitter)\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"twitter\"\n            className=\"rounded-md border px-2 py-1\"\n            value={twitter}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setTwitter(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"github\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Github\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"github\"\n            className=\"rounded-md border px-2 py-1\"\n            value={github}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setGithub(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"mail\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\", \"Email Address\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"mail\"\n            className=\"rounded-md border px-2 py-1\"\n            value={mail}\n            placeholder={\"\"}\n            maxLength={320}\n            onChange={(e) => setMail(e.target.value)}\n          />\n        </div>\n        <Separator />\n        <Button\n          disabled={isUpdating}\n          onClick={onSubmit}\n          className=\"ml-auto block w-full\"\n        >\n          {isUpdating ? (\n            <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n          ) : (\n            <p>{t(\"æ¬¡ã¸\", \"Next\")}</p>\n          )}\n        </Button>\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      createdBookmarksCount\n      login\n      nanoid\n      name\n      receivedLikesCount\n      receivedViewsCount\n      awardsCount\n      followCount\n      followersCount\n      worksCount\n      iconUrl\n      headerImageUrl\n      webFcmToken\n      featuredSensitiveWorks {\n        ...DialogWork\n      }\n      featuredWorks {\n        ...DialogWork\n      }\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n    }\n  }`,\n  [DialogWorkFragment],\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserProfileMutation = graphql(\n  `mutation UpdateUserProfile($input: UpdateUserProfileInput!) {\n    updateUserProfile(input: $input) {\n      id\n      name\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.profile._index/components/profile-editor-form.tsx"},"span":[14714,14977],"sourceCode":"import { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { CropImageField } from \"~/components/crop-image-field\"\nimport { Button } from \"~/components/ui/button\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { DialogWorkFragment } from \"~/routes/($lang).my._index/components/select-created-works-dialog\"\nimport { useQuery, useSuspenseQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon, Pencil } from \"lucide-react\"\nimport { useContext, useState } from \"react\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { toast } from \"sonner\"\nimport { useNavigate } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function ProfileEditorForm () {\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const { data: user } = useSuspenseQuery(userQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const navigate = useNavigate()\n\n  const userInfo = user?.user\n\n  const [userName, setUserName] = useState(userInfo?.name ?? \"\")\n\n  const [profile, setProfile] = useState(userInfo?.biography ?? \"\")\n\n  const [enProfile, setEnProfile] = useState(userInfo?.enBiography ?? \"\")\n\n  const [website, setWebsite] = useState(userInfo?.siteURL ?? \"\")\n\n  const [instagram, setInstagram] = useState(userInfo?.instagramAccountId ?? \"\")\n\n  const [twitter, setTwitter] = useState(userInfo?.twitterAccountId ?? \"\")\n\n  const [github, setGithub] = useState(userInfo?.githubAccountId ?? \"\")\n\n  const [mail, setMail] = useState(userInfo?.mailAddress ?? \"\")\n\n  const [profileImage, setProfileImage] = useState(\"\")\n\n  const [headerImage, setHeaderImage] = useState(\"\")\n\n  const { data: token, refetch: tokenRefetch } = useQuery(viewerTokenQuery)\n\n  const [selectedPickupWorks, _setSelectedPickupWorks] = useState(\n    userInfo?.featuredWorks ?? [],\n  )\n\n  const [selectedPickupSensitiveWorks, _setSelectedPickupSensitiveWorks] =\n    useState(userInfo?.featuredSensitiveWorks ?? [])\n\n  const [updateProfile, { loading: isUpdating }] = useMutation(\n    updateUserProfileMutation,\n  )\n\n  const onSubmit = async () => {\n    if (isUpdating || authContext.userId === null) {\n      return\n    }\n\n    const iconUrl = profileImage\n      ? await uploadPublicImage(profileImage, token?.viewer?.token)\n      : null\n\n    const headerUrl = headerImage\n      ? await uploadPublicImage(headerImage, token?.viewer?.token)\n      : null\n\n    await updateProfile({\n      variables: {\n        input: {\n          displayName: userName,\n          biography: profile,\n          enBiography: enProfile,\n          homeUrl: website,\n          instagramAccountId: instagram,\n          twitterAccountId: twitter,\n          githubAccountId: github,\n          mailAddress: mail,\n          ...(iconUrl && {\n            iconUrl: iconUrl,\n          }),\n          ...(headerUrl && {\n            headerImageUrl: headerUrl,\n          }),\n          featuredWorkIds: selectedPickupWorks.map((work) => work.id),\n          featuredSensitiveWorkIds: selectedPickupSensitiveWorks.map(\n            (work) => work.id,\n          ),\n        },\n      },\n    })\n\n    toast(t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚\", \"Profile updated.\"))\n\n    navigate(\"/new/settings\")\n  }\n\n  const profileImageSrc =\n    profileImage.length > 0 ? profileImage : userInfo?.iconUrl\n\n  const headerImageSrc =\n    headerImage.length > 0 ? headerImage : userInfo?.headerImageUrl\n\n  return (\n    <>\n      <div className=\"container mx-auto max-w-4xl space-y-8 p-6\">\n        {/* ã‚¦ã‚§ãƒ«ã‚«ãƒ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}\n        <div className=\"rounded-xl border border-gray-100 bg-gradient-to-r from-blue-50 to-purple-50 p-8\">\n          <div className=\"space-y-4 text-center\">\n            <h1 className=\"font-bold text-3xl text-gray-800\">\n              {t(\"Aipictorsã¸ã‚ˆã†ã“ãï¼\", \"Welcome to Aipictors!\")}\n            </h1>\n            <p className=\"text-gray-600 text-lg\">\n              {t(\n                \"æ—¥æœ¬æœ€å¤§ç´šã®AIã‚¤ãƒ©ã‚¹ãƒˆãƒ»å°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆã§ã™\",\n                \"Japan's largest AI illustration and novel posting site\",\n              )}\n            </p>\n            <div className=\"mt-6 grid gap-4 md:grid-cols-3\">\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-blue-500\">ğŸ¨</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ä½œå“æŠ•ç¨¿\", \"Post Artwork\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"AIã‚¤ãƒ©ã‚¹ãƒˆã‚„å°èª¬ã‚’æŠ•ç¨¿ã—ã¦ã€å¤šãã®äººã«è¦‹ã¦ã‚‚ã‚‰ãŠã†\",\n                    \"Share your AI artwork and novels with many people\",\n                  )}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-green-500\">ğŸ‘¥</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£\", \"Community\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"ä»–ã®ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã¨ã¤ãªãŒã‚Šã€ãŠäº’ã„ã®ä½œå“ã‚’æ¥½ã—ã‚‚ã†\",\n                    \"Connect with other creators and enjoy each other's work\",\n                  )}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-purple-500\">ğŸ†</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ\", \"Contests\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"å®šæœŸçš„ã«é–‹å‚¬ã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ã‚¹ãƒˆã«å‚åŠ ã—ã¦è…•è©¦ã—\",\n                    \"Participate in regular contests to test your skills\",\n                  )}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šèª¬æ˜ */}\n        <div className=\"rounded-xl border border-yellow-200 bg-yellow-50 p-6\">\n          <h2 className=\"mb-4 font-bold text-gray-800 text-xl\">\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šã«ã¤ã„ã¦\", \"About Profile Setup\")}\n          </h2>\n          <div className=\"space-y-3 text-gray-700\">\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                1\n              </span>\n              <p>\n                {t(\n                  \"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚„ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚’è¨­å®šã—ã¦ã€ã‚ãªãŸã‚‰ã—ã•ã‚’è¡¨ç¾ã—ã¾ã—ã‚‡ã†\",\n                  \"Set your nickname and profile image to express yourself\",\n                )}\n              </p>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                2\n              </span>\n              <p>\n                {t(\n                  \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ–‡ç« ã§è‡ªå·±ç´¹ä»‹ã‚„èˆˆå‘³ã®ã‚ã‚‹ã“ã¨ã‚’æ›¸ã„ã¦ã¿ã¾ã—ã‚‡ã†\",\n                  \"Write a self-introduction and your interests in your profile\",\n                )}\n              </p>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                3\n              </span>\n              <p>\n                {t(\n                  \"SNSã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é€£æºã—ã¦ã€ã‚ˆã‚Šå¤šãã®äººã¨ã¤ãªãŒã‚Šã¾ã—ã‚‡ã†\",\n                  \"Link your SNS accounts to connect with more people\",\n                )}\n              </p>\n            </div>\n          </div>\n          <div className=\"mt-4 rounded-lg border border-blue-200 bg-blue-50 p-4\">\n            <p className=\"text-blue-800 text-sm\">\n              ğŸ’¡{\" \"}\n              {t(\n                \"ã™ã¹ã¦ã®é …ç›®ã¯å¾Œã‹ã‚‰è¨­å®šç”»é¢ã§å¤‰æ›´ã§ãã‚‹ã®ã§ã€ã¾ãšã¯æ°—è»½ã«è¨­å®šã—ã¦ã¿ã¦ãã ã•ã„\",\n                \"All items can be changed later in the settings, so feel free to start with basic setup\",\n              )}\n            </p>\n          </div>\n        </div>\n        <div className=\"justify-between\">\n          <div className=\"relative\">\n            {headerImageSrc ? (\n              <img\n                className=\"h-auto max-h-64 w-full object-cover\"\n                src={headerImageSrc}\n                alt=\"header\"\n              />\n            ) : (\n              <div className=\"h-40 w-full bg-gray-700\" />\n            )}\n            <div className=\"absolute bottom-[-24px] left-2 size-32\">\n              {profileImageSrc ? (\n                <img\n                  className=\"absolute size-32 rounded-full border-2\"\n                  src={profileImageSrc}\n                  alt=\"header\"\n                />\n              ) : (\n                <div className=\"size-32 rounded-full border-2 bg-gray-700\" />\n              )}\n\n              <CropImageField\n                isHidePreviewImage={false}\n                cropWidth={240}\n                cropHeight={240}\n                onDeleteImage={() => {\n                  setProfileImage(\"\")\n                }}\n                onCropToBase64={(base64: string) => {\n                  try {\n                    console.log(\"base64\", base64)\n                    setProfileImage(base64)\n                  } catch (error) {\n                    console.error(\"Error in onCropToBase64:\", error)\n                  }\n                }}\n                fileExtension={\"webp\"}\n              >\n                <Button\n                  className=\"absolute top-0 right-0 size-8 rounded-full p-0\"\n                  variant={\"secondary\"}\n                >\n                  <Pencil className=\"size-4\" />\n                </Button>\n              </CropImageField>\n            </div>\n\n            <CropImageField\n              isHidePreviewImage={false}\n              cropWidth={1200}\n              cropHeight={627}\n              onDeleteImage={() => {\n                setHeaderImage(\"\")\n              }}\n              onCropToBase64={setHeaderImage}\n              fileExtension={\"webp\"}\n            >\n              <Button\n                className=\"absolute top-1 right-1 size-8 rounded-full p-0\"\n                variant={\"secondary\"}\n              >\n                <Pencil className=\"size-4\" />\n              </Button>\n            </CropImageField>\n          </div>\n          <p className=\"mt-8\">\n            {t(\n              \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒã«R-18ç”»åƒã¯æ²è¼‰ã§ãã¾ã›ã‚“ã€‚\",\n              \"You cannot upload R-18 images as profile or header images.\",\n            )}\n          </p>\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"nickname\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ \", \"Nickname\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"nickname\"\n            maxLength={32}\n            minLength={1}\n            value={userName}\n            onChange={(e) => setUserName(e.target.value)}\n            className=\"rounded-md border px-2 py-1\"\n            defaultValue=\"Aipictors/AIã‚¤ãƒ©ã‚¹ãƒˆæŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIå°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIçµµ\"\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"profile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"profile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={320}\n            value={profile}\n            onChange={(e) => setProfile(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"enProfile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"è‹±èªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"English Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"enProfile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={640}\n            value={enProfile}\n            onChange={(e) => setEnProfile(e.target.value)}\n          />\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"website\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"Webã‚µã‚¤ãƒˆ\", \"Website\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"website\"\n            className=\"rounded-md border px-2 py-1\"\n            value={website}\n            maxLength={1000}\n            onChange={(e) => setWebsite(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <p className=\"font-semibold\">\n            {t(\"SNSãƒªãƒ³ã‚¯ï¼ˆ@ãƒãƒ¼ã‚¯ã¯ä¸è¦ï¼‰\", \"SNS Links (without @)\")}\n          </p>\n          <label\n            htmlFor=\"instagram\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Instagram\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"instagram\"\n            className=\"rounded-md border px-2 py-1\"\n            value={instagram}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setInstagram(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"twitter\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"X(æ—§Twitter)\", \"X(formerly Twitter)\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"twitter\"\n            className=\"rounded-md border px-2 py-1\"\n            value={twitter}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setTwitter(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"github\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Github\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"github\"\n            className=\"rounded-md border px-2 py-1\"\n            value={github}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setGithub(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"mail\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\", \"Email Address\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"mail\"\n            className=\"rounded-md border px-2 py-1\"\n            value={mail}\n            placeholder={\"\"}\n            maxLength={320}\n            onChange={(e) => setMail(e.target.value)}\n          />\n        </div>\n        <Separator />\n        <Button\n          disabled={isUpdating}\n          onClick={onSubmit}\n          className=\"ml-auto block w-full\"\n        >\n          {isUpdating ? (\n            <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n          ) : (\n            <p>{t(\"æ¬¡ã¸\", \"Next\")}</p>\n          )}\n        </Button>\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      createdBookmarksCount\n      login\n      nanoid\n      name\n      receivedLikesCount\n      receivedViewsCount\n      awardsCount\n      followCount\n      followersCount\n      worksCount\n      iconUrl\n      headerImageUrl\n      webFcmToken\n      featuredSensitiveWorks {\n        ...DialogWork\n      }\n      featuredWorks {\n        ...DialogWork\n      }\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n    }\n  }`,\n  [DialogWorkFragment],\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserProfileMutation = graphql(\n  `mutation UpdateUserProfile($input: UpdateUserProfileInput!) {\n    updateUserProfile(input: $input) {\n      id\n      name\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.profile._index/components/profile-editor-form.tsx"},"span":[15284,15544],"sourceCode":"import { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { CropImageField } from \"~/components/crop-image-field\"\nimport { Button } from \"~/components/ui/button\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { DialogWorkFragment } from \"~/routes/($lang).my._index/components/select-created-works-dialog\"\nimport { useQuery, useSuspenseQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon, Pencil } from \"lucide-react\"\nimport { useContext, useState } from \"react\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { toast } from \"sonner\"\nimport { useNavigate } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function ProfileEditorForm () {\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const { data: user } = useSuspenseQuery(userQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const navigate = useNavigate()\n\n  const userInfo = user?.user\n\n  const [userName, setUserName] = useState(userInfo?.name ?? \"\")\n\n  const [profile, setProfile] = useState(userInfo?.biography ?? \"\")\n\n  const [enProfile, setEnProfile] = useState(userInfo?.enBiography ?? \"\")\n\n  const [website, setWebsite] = useState(userInfo?.siteURL ?? \"\")\n\n  const [instagram, setInstagram] = useState(userInfo?.instagramAccountId ?? \"\")\n\n  const [twitter, setTwitter] = useState(userInfo?.twitterAccountId ?? \"\")\n\n  const [github, setGithub] = useState(userInfo?.githubAccountId ?? \"\")\n\n  const [mail, setMail] = useState(userInfo?.mailAddress ?? \"\")\n\n  const [profileImage, setProfileImage] = useState(\"\")\n\n  const [headerImage, setHeaderImage] = useState(\"\")\n\n  const { data: token, refetch: tokenRefetch } = useQuery(viewerTokenQuery)\n\n  const [selectedPickupWorks, _setSelectedPickupWorks] = useState(\n    userInfo?.featuredWorks ?? [],\n  )\n\n  const [selectedPickupSensitiveWorks, _setSelectedPickupSensitiveWorks] =\n    useState(userInfo?.featuredSensitiveWorks ?? [])\n\n  const [updateProfile, { loading: isUpdating }] = useMutation(\n    updateUserProfileMutation,\n  )\n\n  const onSubmit = async () => {\n    if (isUpdating || authContext.userId === null) {\n      return\n    }\n\n    const iconUrl = profileImage\n      ? await uploadPublicImage(profileImage, token?.viewer?.token)\n      : null\n\n    const headerUrl = headerImage\n      ? await uploadPublicImage(headerImage, token?.viewer?.token)\n      : null\n\n    await updateProfile({\n      variables: {\n        input: {\n          displayName: userName,\n          biography: profile,\n          enBiography: enProfile,\n          homeUrl: website,\n          instagramAccountId: instagram,\n          twitterAccountId: twitter,\n          githubAccountId: github,\n          mailAddress: mail,\n          ...(iconUrl && {\n            iconUrl: iconUrl,\n          }),\n          ...(headerUrl && {\n            headerImageUrl: headerUrl,\n          }),\n          featuredWorkIds: selectedPickupWorks.map((work) => work.id),\n          featuredSensitiveWorkIds: selectedPickupSensitiveWorks.map(\n            (work) => work.id,\n          ),\n        },\n      },\n    })\n\n    toast(t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚\", \"Profile updated.\"))\n\n    navigate(\"/new/settings\")\n  }\n\n  const profileImageSrc =\n    profileImage.length > 0 ? profileImage : userInfo?.iconUrl\n\n  const headerImageSrc =\n    headerImage.length > 0 ? headerImage : userInfo?.headerImageUrl\n\n  return (\n    <>\n      <div className=\"container mx-auto max-w-4xl space-y-8 p-6\">\n        {/* ã‚¦ã‚§ãƒ«ã‚«ãƒ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}\n        <div className=\"rounded-xl border border-gray-100 bg-gradient-to-r from-blue-50 to-purple-50 p-8\">\n          <div className=\"space-y-4 text-center\">\n            <h1 className=\"font-bold text-3xl text-gray-800\">\n              {t(\"Aipictorsã¸ã‚ˆã†ã“ãï¼\", \"Welcome to Aipictors!\")}\n            </h1>\n            <p className=\"text-gray-600 text-lg\">\n              {t(\n                \"æ—¥æœ¬æœ€å¤§ç´šã®AIã‚¤ãƒ©ã‚¹ãƒˆãƒ»å°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆã§ã™\",\n                \"Japan's largest AI illustration and novel posting site\",\n              )}\n            </p>\n            <div className=\"mt-6 grid gap-4 md:grid-cols-3\">\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-blue-500\">ğŸ¨</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ä½œå“æŠ•ç¨¿\", \"Post Artwork\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"AIã‚¤ãƒ©ã‚¹ãƒˆã‚„å°èª¬ã‚’æŠ•ç¨¿ã—ã¦ã€å¤šãã®äººã«è¦‹ã¦ã‚‚ã‚‰ãŠã†\",\n                    \"Share your AI artwork and novels with many people\",\n                  )}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-green-500\">ğŸ‘¥</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£\", \"Community\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"ä»–ã®ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã¨ã¤ãªãŒã‚Šã€ãŠäº’ã„ã®ä½œå“ã‚’æ¥½ã—ã‚‚ã†\",\n                    \"Connect with other creators and enjoy each other's work\",\n                  )}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-purple-500\">ğŸ†</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ\", \"Contests\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"å®šæœŸçš„ã«é–‹å‚¬ã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ã‚¹ãƒˆã«å‚åŠ ã—ã¦è…•è©¦ã—\",\n                    \"Participate in regular contests to test your skills\",\n                  )}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šèª¬æ˜ */}\n        <div className=\"rounded-xl border border-yellow-200 bg-yellow-50 p-6\">\n          <h2 className=\"mb-4 font-bold text-gray-800 text-xl\">\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šã«ã¤ã„ã¦\", \"About Profile Setup\")}\n          </h2>\n          <div className=\"space-y-3 text-gray-700\">\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                1\n              </span>\n              <p>\n                {t(\n                  \"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚„ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚’è¨­å®šã—ã¦ã€ã‚ãªãŸã‚‰ã—ã•ã‚’è¡¨ç¾ã—ã¾ã—ã‚‡ã†\",\n                  \"Set your nickname and profile image to express yourself\",\n                )}\n              </p>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                2\n              </span>\n              <p>\n                {t(\n                  \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ–‡ç« ã§è‡ªå·±ç´¹ä»‹ã‚„èˆˆå‘³ã®ã‚ã‚‹ã“ã¨ã‚’æ›¸ã„ã¦ã¿ã¾ã—ã‚‡ã†\",\n                  \"Write a self-introduction and your interests in your profile\",\n                )}\n              </p>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                3\n              </span>\n              <p>\n                {t(\n                  \"SNSã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é€£æºã—ã¦ã€ã‚ˆã‚Šå¤šãã®äººã¨ã¤ãªãŒã‚Šã¾ã—ã‚‡ã†\",\n                  \"Link your SNS accounts to connect with more people\",\n                )}\n              </p>\n            </div>\n          </div>\n          <div className=\"mt-4 rounded-lg border border-blue-200 bg-blue-50 p-4\">\n            <p className=\"text-blue-800 text-sm\">\n              ğŸ’¡{\" \"}\n              {t(\n                \"ã™ã¹ã¦ã®é …ç›®ã¯å¾Œã‹ã‚‰è¨­å®šç”»é¢ã§å¤‰æ›´ã§ãã‚‹ã®ã§ã€ã¾ãšã¯æ°—è»½ã«è¨­å®šã—ã¦ã¿ã¦ãã ã•ã„\",\n                \"All items can be changed later in the settings, so feel free to start with basic setup\",\n              )}\n            </p>\n          </div>\n        </div>\n        <div className=\"justify-between\">\n          <div className=\"relative\">\n            {headerImageSrc ? (\n              <img\n                className=\"h-auto max-h-64 w-full object-cover\"\n                src={headerImageSrc}\n                alt=\"header\"\n              />\n            ) : (\n              <div className=\"h-40 w-full bg-gray-700\" />\n            )}\n            <div className=\"absolute bottom-[-24px] left-2 size-32\">\n              {profileImageSrc ? (\n                <img\n                  className=\"absolute size-32 rounded-full border-2\"\n                  src={profileImageSrc}\n                  alt=\"header\"\n                />\n              ) : (\n                <div className=\"size-32 rounded-full border-2 bg-gray-700\" />\n              )}\n\n              <CropImageField\n                isHidePreviewImage={false}\n                cropWidth={240}\n                cropHeight={240}\n                onDeleteImage={() => {\n                  setProfileImage(\"\")\n                }}\n                onCropToBase64={(base64: string) => {\n                  try {\n                    console.log(\"base64\", base64)\n                    setProfileImage(base64)\n                  } catch (error) {\n                    console.error(\"Error in onCropToBase64:\", error)\n                  }\n                }}\n                fileExtension={\"webp\"}\n              >\n                <Button\n                  className=\"absolute top-0 right-0 size-8 rounded-full p-0\"\n                  variant={\"secondary\"}\n                >\n                  <Pencil className=\"size-4\" />\n                </Button>\n              </CropImageField>\n            </div>\n\n            <CropImageField\n              isHidePreviewImage={false}\n              cropWidth={1200}\n              cropHeight={627}\n              onDeleteImage={() => {\n                setHeaderImage(\"\")\n              }}\n              onCropToBase64={setHeaderImage}\n              fileExtension={\"webp\"}\n            >\n              <Button\n                className=\"absolute top-1 right-1 size-8 rounded-full p-0\"\n                variant={\"secondary\"}\n              >\n                <Pencil className=\"size-4\" />\n              </Button>\n            </CropImageField>\n          </div>\n          <p className=\"mt-8\">\n            {t(\n              \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒã«R-18ç”»åƒã¯æ²è¼‰ã§ãã¾ã›ã‚“ã€‚\",\n              \"You cannot upload R-18 images as profile or header images.\",\n            )}\n          </p>\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"nickname\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ \", \"Nickname\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"nickname\"\n            maxLength={32}\n            minLength={1}\n            value={userName}\n            onChange={(e) => setUserName(e.target.value)}\n            className=\"rounded-md border px-2 py-1\"\n            defaultValue=\"Aipictors/AIã‚¤ãƒ©ã‚¹ãƒˆæŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIå°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIçµµ\"\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"profile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"profile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={320}\n            value={profile}\n            onChange={(e) => setProfile(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"enProfile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"è‹±èªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"English Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"enProfile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={640}\n            value={enProfile}\n            onChange={(e) => setEnProfile(e.target.value)}\n          />\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"website\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"Webã‚µã‚¤ãƒˆ\", \"Website\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"website\"\n            className=\"rounded-md border px-2 py-1\"\n            value={website}\n            maxLength={1000}\n            onChange={(e) => setWebsite(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <p className=\"font-semibold\">\n            {t(\"SNSãƒªãƒ³ã‚¯ï¼ˆ@ãƒãƒ¼ã‚¯ã¯ä¸è¦ï¼‰\", \"SNS Links (without @)\")}\n          </p>\n          <label\n            htmlFor=\"instagram\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Instagram\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"instagram\"\n            className=\"rounded-md border px-2 py-1\"\n            value={instagram}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setInstagram(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"twitter\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"X(æ—§Twitter)\", \"X(formerly Twitter)\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"twitter\"\n            className=\"rounded-md border px-2 py-1\"\n            value={twitter}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setTwitter(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"github\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Github\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"github\"\n            className=\"rounded-md border px-2 py-1\"\n            value={github}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setGithub(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"mail\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\", \"Email Address\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"mail\"\n            className=\"rounded-md border px-2 py-1\"\n            value={mail}\n            placeholder={\"\"}\n            maxLength={320}\n            onChange={(e) => setMail(e.target.value)}\n          />\n        </div>\n        <Separator />\n        <Button\n          disabled={isUpdating}\n          onClick={onSubmit}\n          className=\"ml-auto block w-full\"\n        >\n          {isUpdating ? (\n            <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n          ) : (\n            <p>{t(\"æ¬¡ã¸\", \"Next\")}</p>\n          )}\n        </Button>\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      createdBookmarksCount\n      login\n      nanoid\n      name\n      receivedLikesCount\n      receivedViewsCount\n      awardsCount\n      followCount\n      followersCount\n      worksCount\n      iconUrl\n      headerImageUrl\n      webFcmToken\n      featuredSensitiveWorks {\n        ...DialogWork\n      }\n      featuredWorks {\n        ...DialogWork\n      }\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n    }\n  }`,\n  [DialogWorkFragment],\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserProfileMutation = graphql(\n  `mutation UpdateUserProfile($input: UpdateUserProfileInput!) {\n    updateUserProfile(input: $input) {\n      id\n      name\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.profile._index/components/profile-editor-form.tsx"},"span":[15884,16137],"sourceCode":"import { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { CropImageField } from \"~/components/crop-image-field\"\nimport { Button } from \"~/components/ui/button\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { DialogWorkFragment } from \"~/routes/($lang).my._index/components/select-created-works-dialog\"\nimport { useQuery, useSuspenseQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon, Pencil } from \"lucide-react\"\nimport { useContext, useState } from \"react\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { toast } from \"sonner\"\nimport { useNavigate } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function ProfileEditorForm () {\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const { data: user } = useSuspenseQuery(userQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const navigate = useNavigate()\n\n  const userInfo = user?.user\n\n  const [userName, setUserName] = useState(userInfo?.name ?? \"\")\n\n  const [profile, setProfile] = useState(userInfo?.biography ?? \"\")\n\n  const [enProfile, setEnProfile] = useState(userInfo?.enBiography ?? \"\")\n\n  const [website, setWebsite] = useState(userInfo?.siteURL ?? \"\")\n\n  const [instagram, setInstagram] = useState(userInfo?.instagramAccountId ?? \"\")\n\n  const [twitter, setTwitter] = useState(userInfo?.twitterAccountId ?? \"\")\n\n  const [github, setGithub] = useState(userInfo?.githubAccountId ?? \"\")\n\n  const [mail, setMail] = useState(userInfo?.mailAddress ?? \"\")\n\n  const [profileImage, setProfileImage] = useState(\"\")\n\n  const [headerImage, setHeaderImage] = useState(\"\")\n\n  const { data: token, refetch: tokenRefetch } = useQuery(viewerTokenQuery)\n\n  const [selectedPickupWorks, _setSelectedPickupWorks] = useState(\n    userInfo?.featuredWorks ?? [],\n  )\n\n  const [selectedPickupSensitiveWorks, _setSelectedPickupSensitiveWorks] =\n    useState(userInfo?.featuredSensitiveWorks ?? [])\n\n  const [updateProfile, { loading: isUpdating }] = useMutation(\n    updateUserProfileMutation,\n  )\n\n  const onSubmit = async () => {\n    if (isUpdating || authContext.userId === null) {\n      return\n    }\n\n    const iconUrl = profileImage\n      ? await uploadPublicImage(profileImage, token?.viewer?.token)\n      : null\n\n    const headerUrl = headerImage\n      ? await uploadPublicImage(headerImage, token?.viewer?.token)\n      : null\n\n    await updateProfile({\n      variables: {\n        input: {\n          displayName: userName,\n          biography: profile,\n          enBiography: enProfile,\n          homeUrl: website,\n          instagramAccountId: instagram,\n          twitterAccountId: twitter,\n          githubAccountId: github,\n          mailAddress: mail,\n          ...(iconUrl && {\n            iconUrl: iconUrl,\n          }),\n          ...(headerUrl && {\n            headerImageUrl: headerUrl,\n          }),\n          featuredWorkIds: selectedPickupWorks.map((work) => work.id),\n          featuredSensitiveWorkIds: selectedPickupSensitiveWorks.map(\n            (work) => work.id,\n          ),\n        },\n      },\n    })\n\n    toast(t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚\", \"Profile updated.\"))\n\n    navigate(\"/new/settings\")\n  }\n\n  const profileImageSrc =\n    profileImage.length > 0 ? profileImage : userInfo?.iconUrl\n\n  const headerImageSrc =\n    headerImage.length > 0 ? headerImage : userInfo?.headerImageUrl\n\n  return (\n    <>\n      <div className=\"container mx-auto max-w-4xl space-y-8 p-6\">\n        {/* ã‚¦ã‚§ãƒ«ã‚«ãƒ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}\n        <div className=\"rounded-xl border border-gray-100 bg-gradient-to-r from-blue-50 to-purple-50 p-8\">\n          <div className=\"space-y-4 text-center\">\n            <h1 className=\"font-bold text-3xl text-gray-800\">\n              {t(\"Aipictorsã¸ã‚ˆã†ã“ãï¼\", \"Welcome to Aipictors!\")}\n            </h1>\n            <p className=\"text-gray-600 text-lg\">\n              {t(\n                \"æ—¥æœ¬æœ€å¤§ç´šã®AIã‚¤ãƒ©ã‚¹ãƒˆãƒ»å°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆã§ã™\",\n                \"Japan's largest AI illustration and novel posting site\",\n              )}\n            </p>\n            <div className=\"mt-6 grid gap-4 md:grid-cols-3\">\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-blue-500\">ğŸ¨</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ä½œå“æŠ•ç¨¿\", \"Post Artwork\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"AIã‚¤ãƒ©ã‚¹ãƒˆã‚„å°èª¬ã‚’æŠ•ç¨¿ã—ã¦ã€å¤šãã®äººã«è¦‹ã¦ã‚‚ã‚‰ãŠã†\",\n                    \"Share your AI artwork and novels with many people\",\n                  )}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-green-500\">ğŸ‘¥</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£\", \"Community\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"ä»–ã®ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã¨ã¤ãªãŒã‚Šã€ãŠäº’ã„ã®ä½œå“ã‚’æ¥½ã—ã‚‚ã†\",\n                    \"Connect with other creators and enjoy each other's work\",\n                  )}\n                </p>\n              </div>\n              <div className=\"rounded-lg border border-gray-100 bg-white p-4\">\n                <div className=\"mb-2 text-2xl text-purple-500\">ğŸ†</div>\n                <h3 className=\"font-semibold text-gray-800\">\n                  {t(\"ã‚³ãƒ³ãƒ†ã‚¹ãƒˆ\", \"Contests\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm\">\n                  {t(\n                    \"å®šæœŸçš„ã«é–‹å‚¬ã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ã‚¹ãƒˆã«å‚åŠ ã—ã¦è…•è©¦ã—\",\n                    \"Participate in regular contests to test your skills\",\n                  )}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šèª¬æ˜ */}\n        <div className=\"rounded-xl border border-yellow-200 bg-yellow-50 p-6\">\n          <h2 className=\"mb-4 font-bold text-gray-800 text-xl\">\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šã«ã¤ã„ã¦\", \"About Profile Setup\")}\n          </h2>\n          <div className=\"space-y-3 text-gray-700\">\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                1\n              </span>\n              <p>\n                {t(\n                  \"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚„ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚’è¨­å®šã—ã¦ã€ã‚ãªãŸã‚‰ã—ã•ã‚’è¡¨ç¾ã—ã¾ã—ã‚‡ã†\",\n                  \"Set your nickname and profile image to express yourself\",\n                )}\n              </p>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                2\n              </span>\n              <p>\n                {t(\n                  \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ–‡ç« ã§è‡ªå·±ç´¹ä»‹ã‚„èˆˆå‘³ã®ã‚ã‚‹ã“ã¨ã‚’æ›¸ã„ã¦ã¿ã¾ã—ã‚‡ã†\",\n                  \"Write a self-introduction and your interests in your profile\",\n                )}\n              </p>\n            </div>\n            <div className=\"flex items-start gap-3\">\n              <span className=\"mt-0.5 flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-blue-500 font-bold text-sm text-white\">\n                3\n              </span>\n              <p>\n                {t(\n                  \"SNSã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é€£æºã—ã¦ã€ã‚ˆã‚Šå¤šãã®äººã¨ã¤ãªãŒã‚Šã¾ã—ã‚‡ã†\",\n                  \"Link your SNS accounts to connect with more people\",\n                )}\n              </p>\n            </div>\n          </div>\n          <div className=\"mt-4 rounded-lg border border-blue-200 bg-blue-50 p-4\">\n            <p className=\"text-blue-800 text-sm\">\n              ğŸ’¡{\" \"}\n              {t(\n                \"ã™ã¹ã¦ã®é …ç›®ã¯å¾Œã‹ã‚‰è¨­å®šç”»é¢ã§å¤‰æ›´ã§ãã‚‹ã®ã§ã€ã¾ãšã¯æ°—è»½ã«è¨­å®šã—ã¦ã¿ã¦ãã ã•ã„\",\n                \"All items can be changed later in the settings, so feel free to start with basic setup\",\n              )}\n            </p>\n          </div>\n        </div>\n        <div className=\"justify-between\">\n          <div className=\"relative\">\n            {headerImageSrc ? (\n              <img\n                className=\"h-auto max-h-64 w-full object-cover\"\n                src={headerImageSrc}\n                alt=\"header\"\n              />\n            ) : (\n              <div className=\"h-40 w-full bg-gray-700\" />\n            )}\n            <div className=\"absolute bottom-[-24px] left-2 size-32\">\n              {profileImageSrc ? (\n                <img\n                  className=\"absolute size-32 rounded-full border-2\"\n                  src={profileImageSrc}\n                  alt=\"header\"\n                />\n              ) : (\n                <div className=\"size-32 rounded-full border-2 bg-gray-700\" />\n              )}\n\n              <CropImageField\n                isHidePreviewImage={false}\n                cropWidth={240}\n                cropHeight={240}\n                onDeleteImage={() => {\n                  setProfileImage(\"\")\n                }}\n                onCropToBase64={(base64: string) => {\n                  try {\n                    console.log(\"base64\", base64)\n                    setProfileImage(base64)\n                  } catch (error) {\n                    console.error(\"Error in onCropToBase64:\", error)\n                  }\n                }}\n                fileExtension={\"webp\"}\n              >\n                <Button\n                  className=\"absolute top-0 right-0 size-8 rounded-full p-0\"\n                  variant={\"secondary\"}\n                >\n                  <Pencil className=\"size-4\" />\n                </Button>\n              </CropImageField>\n            </div>\n\n            <CropImageField\n              isHidePreviewImage={false}\n              cropWidth={1200}\n              cropHeight={627}\n              onDeleteImage={() => {\n                setHeaderImage(\"\")\n              }}\n              onCropToBase64={setHeaderImage}\n              fileExtension={\"webp\"}\n            >\n              <Button\n                className=\"absolute top-1 right-1 size-8 rounded-full p-0\"\n                variant={\"secondary\"}\n              >\n                <Pencil className=\"size-4\" />\n              </Button>\n            </CropImageField>\n          </div>\n          <p className=\"mt-8\">\n            {t(\n              \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒã«R-18ç”»åƒã¯æ²è¼‰ã§ãã¾ã›ã‚“ã€‚\",\n              \"You cannot upload R-18 images as profile or header images.\",\n            )}\n          </p>\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"nickname\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ \", \"Nickname\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"nickname\"\n            maxLength={32}\n            minLength={1}\n            value={userName}\n            onChange={(e) => setUserName(e.target.value)}\n            className=\"rounded-md border px-2 py-1\"\n            defaultValue=\"Aipictors/AIã‚¤ãƒ©ã‚¹ãƒˆæŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIå°èª¬æŠ•ç¨¿ã‚µã‚¤ãƒˆãƒ»AIçµµ\"\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"profile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"profile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={320}\n            value={profile}\n            onChange={(e) => setProfile(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"enProfile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"è‹±èªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"English Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"enProfile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={640}\n            value={enProfile}\n            onChange={(e) => setEnProfile(e.target.value)}\n          />\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"website\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"Webã‚µã‚¤ãƒˆ\", \"Website\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"website\"\n            className=\"rounded-md border px-2 py-1\"\n            value={website}\n            maxLength={1000}\n            onChange={(e) => setWebsite(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <p className=\"font-semibold\">\n            {t(\"SNSãƒªãƒ³ã‚¯ï¼ˆ@ãƒãƒ¼ã‚¯ã¯ä¸è¦ï¼‰\", \"SNS Links (without @)\")}\n          </p>\n          <label\n            htmlFor=\"instagram\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Instagram\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"instagram\"\n            className=\"rounded-md border px-2 py-1\"\n            value={instagram}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setInstagram(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"twitter\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"X(æ—§Twitter)\", \"X(formerly Twitter)\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"twitter\"\n            className=\"rounded-md border px-2 py-1\"\n            value={twitter}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setTwitter(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"github\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Github\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"github\"\n            className=\"rounded-md border px-2 py-1\"\n            value={github}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setGithub(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"mail\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\", \"Email Address\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"mail\"\n            className=\"rounded-md border px-2 py-1\"\n            value={mail}\n            placeholder={\"\"}\n            maxLength={320}\n            onChange={(e) => setMail(e.target.value)}\n          />\n        </div>\n        <Separator />\n        <Button\n          disabled={isUpdating}\n          onClick={onSubmit}\n          className=\"ml-auto block w-full\"\n        >\n          {isUpdating ? (\n            <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n          ) : (\n            <p>{t(\"æ¬¡ã¸\", \"Next\")}</p>\n          )}\n        </Button>\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      createdBookmarksCount\n      login\n      nanoid\n      name\n      receivedLikesCount\n      receivedViewsCount\n      awardsCount\n      followCount\n      followersCount\n      worksCount\n      iconUrl\n      headerImageUrl\n      webFcmToken\n      featuredSensitiveWorks {\n        ...DialogWork\n      }\n      featuredWorks {\n        ...DialogWork\n      }\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n    }\n  }`,\n  [DialogWorkFragment],\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserProfileMutation = graphql(\n  `mutation UpdateUserProfile($input: UpdateUserProfileInput!) {\n    updateUserProfile(input: $input) {\n      id\n      name\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.settings._index/components/user-settings-form.tsx"},"span":[5552,5831],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useQuery, useMutation } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon } from \"lucide-react\"\nimport { useContext, useEffect, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { Switch } from \"~/components/ui/switch\"\nimport { Label } from \"~/components/ui/label\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { useNavigate } from \"@remix-run/react\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function UserSettingsForm () {\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const navigate = useNavigate()\n\n  const { data: userSettingData } = useQuery(userSettingQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n  })\n\n  const [updateUserSetting, { loading: isUpdatingUserSetting }] = useMutation(\n    updateUserSettingMutation,\n  )\n\n  // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å¹´é½¢è¨­å®šç”¨ã®çŠ¶æ…‹å¤‰æ•°\n  const [showR15InNormalMode, setShowR15InNormalMode] = useState(false)\n\n  const [showSensitiveModeToggle, setShowSensitiveModeToggle] = useState(false)\n\n  const [showR18GInSensitiveMode, setShowR18GInSensitiveMode] = useState(false)\n\n  // 18æ­³ä»¥ä¸Šã‹ã©ã†ã‹ã®ç¢ºèªç”¨çŠ¶æ…‹å¤‰æ•°\n  const [isAdult, setIsAdult] = useState<string | null>(null)\n\n  // ãã®ä»–ã®è¨­å®šç”¨ã®çŠ¶æ…‹å¤‰æ•°\n  const [isNotifyComment, setIsNotifyComment] = useState(false)\n\n  useEffect(() => {\n    const userSetting = userSettingData?.userSetting\n\n    if (userSetting) {\n      // preferenceRating ã«åŸºã¥ã„ã¦åˆæœŸå€¤ã‚’è¨­å®š\n      const preferenceRating = userSetting.preferenceRating\n\n      if (preferenceRating === \"G\") {\n        setShowR15InNormalMode(false)\n        setShowSensitiveModeToggle(false)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R15\") {\n        setShowR15InNormalMode(true)\n        setShowSensitiveModeToggle(false)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R18\") {\n        setShowR15InNormalMode(true)\n        setShowSensitiveModeToggle(true)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R18G\") {\n        setShowR15InNormalMode(true)\n        setShowSensitiveModeToggle(true)\n        setShowR18GInSensitiveMode(true)\n      }\n\n      // 18æ­³ä»¥ä¸Šã‹ã©ã†ã‹ã®ç¢ºèª\n      setIsAdult(\n        userSetting.preferenceRating === \"G\" ||\n          userSetting.preferenceRating === \"R15\"\n          ? \"YES\"\n          : \"NO\",\n      )\n\n      // ãã®ä»–ã®è¨­å®šã‚’åˆæœŸåŒ–\n      setIsNotifyComment(userSetting.isNotifyComment ?? false)\n    }\n  }, [userSettingData])\n\n  const onSave = async () => {\n    if (!isAdult) {\n      toast(\n        t(\n          \"18æ­³ä»¥ä¸Šã‹ã©ã†ã‹ã‚’é¸æŠã—ã¦ãã ã•ã„\",\n          \"Please select if you are over 18\",\n        ),\n      )\n      return\n    }\n\n    // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®é¸æŠçŠ¶æ…‹ã«åŸºã¥ã„ã¦ preferenceRating ã‚’æ±ºå®š\n    let preferenceRating: IntrospectionEnum<\"PreferenceRating\"> = \"G\"\n\n    if (showSensitiveModeToggle) {\n      if (showR18GInSensitiveMode) {\n        preferenceRating = \"R18G\"\n      } else {\n        preferenceRating = \"R18\"\n      }\n    } else {\n      if (showR15InNormalMode) {\n        preferenceRating = \"R15\"\n      } else {\n        preferenceRating = \"G\"\n      }\n    }\n\n    await updateUserSetting({\n      variables: {\n        input: {\n          isNotifyComment,\n          preferenceRating,\n        },\n      },\n    })\n\n    toast(t(\"ä¿å­˜ã—ã¾ã—ãŸ\", \"Saved\"))\n    navigate(\"/settings/completed\")\n  }\n\n  return (\n    <div className=\"container m-auto space-y-4\">\n      <p className=\"font-bold\">\n        {t(\"ã‚ãªãŸã¯18æ­³ä»¥ä¸Šã§ã™ã‹ï¼Ÿ\", \"Are you over 18?\")}\n      </p>\n      <div className=\"flex space-x-2\">\n        <Button\n          variant={isAdult === \"YES\" ? \"default\" : \"secondary\"}\n          onClick={() => setIsAdult(\"YES\")}\n        >\n          YES\n        </Button>\n        <Button\n          variant={isAdult === \"NO\" ? \"default\" : \"secondary\"}\n          onClick={() => {\n            setIsAdult(\"NO\")\n            // 18æ­³æœªæº€ã®å ´åˆã€R18ã‚„R18Gã®è¨­å®šã‚’ç„¡åŠ¹åŒ–\n            setShowSensitiveModeToggle(false)\n            setShowR18GInSensitiveMode(false)\n          }}\n        >\n          NO\n        </Button>\n      </div>\n      {isAdult && (\n        <>\n          {/* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å¹´é½¢è¨­å®š */}\n          <div className=\"space-y-4\">\n            <p className=\"font-bold\">\n              {t(\n                \"è¡¨ç¤ºã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å¹´é½¢è¨­å®š\",\n                \"Content age restriction settings\",\n              )}\n            </p>\n            <p className=\"text-sm\">\n              {t(\n                \"è¡¨ç¤ºã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å¹´é½¢åˆ¶é™ã‚’è¨­å®šã§ãã¾ã™ã€‚ä¸€éƒ¨ãƒšãƒ¼ã‚¸ã§ã¯åæ˜ ã•ã‚Œãªã„ã®ã§ã”æ³¨æ„ãã ã•ã„ã€‚\",\n                \"You can set the age restrictions for displayed content. Note that it may not be reflected on some pages.\",\n              )}\n            </p>\n            <div className=\"flex flex-col space-y-4\">\n              <div className=\"flex w-full items-center justify-between\">\n                <Label htmlFor=\"show-r15\">\n                  {t(\n                    \"(é€šå¸¸ãƒ¢ãƒ¼ãƒ‰æ™‚)R15ä½œå“ã‚’è¡¨ç¤ºã™ã‚‹\",\n                    \"Show R15 content in normal mode\",\n                  )}\n                </Label>\n                <Switch\n                  onCheckedChange={setShowR15InNormalMode}\n                  checked={showR15InNormalMode}\n                  id=\"show-r15\"\n                  disabled={showSensitiveModeToggle} // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ãŒæœ‰åŠ¹ãªå ´åˆã¯ç„¡åŠ¹åŒ–\n                />\n              </div>\n              <div className=\"flex w-full items-center justify-between\">\n                <Label htmlFor=\"show-sensitive-toggle\">\n                  {t(\n                    \"R18åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ï¼ˆå¯¾è±¡å¹´é½¢å¤‰æ›´ãƒœã‚¿ãƒ³ï¼‰ã‚’è¡¨ç¤ºã™ã‚‹\",\n                    \"Show sensitive mode toggle button in the menu\",\n                  )}\n                </Label>\n                <Switch\n                  onCheckedChange={(checked) => {\n                    setShowSensitiveModeToggle(checked)\n                    if (checked) {\n                      // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹ã«ã—ãŸã‚‰ R15 ã‚’è¡¨ç¤º\n                      setShowR15InNormalMode(true)\n                    } else {\n                      // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ã‚’ç„¡åŠ¹ã«ã—ãŸã‚‰ R18G ã®è¡¨ç¤ºã‚’ç„¡åŠ¹åŒ–\n                      setShowR18GInSensitiveMode(false)\n                    }\n                  }}\n                  checked={showSensitiveModeToggle}\n                  id=\"show-sensitive-toggle\"\n                  disabled={isAdult !== \"YES\"} // 18æ­³æœªæº€ã¯ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹ã«ã§ããªã„\n                />\n              </div>\n              <div className=\"flex w-full items-center justify-between\">\n                <Label htmlFor=\"show-r18g\">\n                  {t(\n                    \"(ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰æ™‚)R18Gä½œå“ã‚’è¡¨ç¤ºã™ã‚‹\",\n                    \"Show R18G content in sensitive mode\",\n                  )}\n                </Label>\n                <Switch\n                  onCheckedChange={setShowR18GInSensitiveMode}\n                  checked={showR18GInSensitiveMode}\n                  id=\"show-r18g\"\n                  disabled={!showSensitiveModeToggle} // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ãŒç„¡åŠ¹ãªå ´åˆã¯ç„¡åŠ¹åŒ–\n                />\n              </div>\n            </div>\n          </div>\n          <Separator />\n        </>\n      )}\n\n      {/* ä¿å­˜ãƒœã‚¿ãƒ³ */}\n      <Button\n        onClick={onSave}\n        disabled={isUpdatingUserSetting}\n        className=\"ml-auto block w-full text-center\"\n      >\n        {isUpdatingUserSetting ? (\n          <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n        ) : (\n          t(\"å®Œäº†\", \"Save\")\n        )}\n      </Button>\n    </div>\n  )\n}\n\nconst userSettingQuery = graphql(`\n  query UserSetting {\n    userSetting {\n      id\n      userId\n      preferenceRating\n      isNotifyComment\n    }\n  }\n`)\n\nconst updateUserSettingMutation = graphql(`\n  mutation UpdateUserSetting($input: UpdateUserSettingInput!) {\n    updateUserSetting(input: $input) {\n      preferenceRating\n    }\n  }\n`)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.settings._index/components/user-settings-form.tsx"},"span":[6231,6979],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useQuery, useMutation } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon } from \"lucide-react\"\nimport { useContext, useEffect, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { Switch } from \"~/components/ui/switch\"\nimport { Label } from \"~/components/ui/label\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { useNavigate } from \"@remix-run/react\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function UserSettingsForm () {\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const navigate = useNavigate()\n\n  const { data: userSettingData } = useQuery(userSettingQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n  })\n\n  const [updateUserSetting, { loading: isUpdatingUserSetting }] = useMutation(\n    updateUserSettingMutation,\n  )\n\n  // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å¹´é½¢è¨­å®šç”¨ã®çŠ¶æ…‹å¤‰æ•°\n  const [showR15InNormalMode, setShowR15InNormalMode] = useState(false)\n\n  const [showSensitiveModeToggle, setShowSensitiveModeToggle] = useState(false)\n\n  const [showR18GInSensitiveMode, setShowR18GInSensitiveMode] = useState(false)\n\n  // 18æ­³ä»¥ä¸Šã‹ã©ã†ã‹ã®ç¢ºèªç”¨çŠ¶æ…‹å¤‰æ•°\n  const [isAdult, setIsAdult] = useState<string | null>(null)\n\n  // ãã®ä»–ã®è¨­å®šç”¨ã®çŠ¶æ…‹å¤‰æ•°\n  const [isNotifyComment, setIsNotifyComment] = useState(false)\n\n  useEffect(() => {\n    const userSetting = userSettingData?.userSetting\n\n    if (userSetting) {\n      // preferenceRating ã«åŸºã¥ã„ã¦åˆæœŸå€¤ã‚’è¨­å®š\n      const preferenceRating = userSetting.preferenceRating\n\n      if (preferenceRating === \"G\") {\n        setShowR15InNormalMode(false)\n        setShowSensitiveModeToggle(false)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R15\") {\n        setShowR15InNormalMode(true)\n        setShowSensitiveModeToggle(false)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R18\") {\n        setShowR15InNormalMode(true)\n        setShowSensitiveModeToggle(true)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R18G\") {\n        setShowR15InNormalMode(true)\n        setShowSensitiveModeToggle(true)\n        setShowR18GInSensitiveMode(true)\n      }\n\n      // 18æ­³ä»¥ä¸Šã‹ã©ã†ã‹ã®ç¢ºèª\n      setIsAdult(\n        userSetting.preferenceRating === \"G\" ||\n          userSetting.preferenceRating === \"R15\"\n          ? \"YES\"\n          : \"NO\",\n      )\n\n      // ãã®ä»–ã®è¨­å®šã‚’åˆæœŸåŒ–\n      setIsNotifyComment(userSetting.isNotifyComment ?? false)\n    }\n  }, [userSettingData])\n\n  const onSave = async () => {\n    if (!isAdult) {\n      toast(\n        t(\n          \"18æ­³ä»¥ä¸Šã‹ã©ã†ã‹ã‚’é¸æŠã—ã¦ãã ã•ã„\",\n          \"Please select if you are over 18\",\n        ),\n      )\n      return\n    }\n\n    // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®é¸æŠçŠ¶æ…‹ã«åŸºã¥ã„ã¦ preferenceRating ã‚’æ±ºå®š\n    let preferenceRating: IntrospectionEnum<\"PreferenceRating\"> = \"G\"\n\n    if (showSensitiveModeToggle) {\n      if (showR18GInSensitiveMode) {\n        preferenceRating = \"R18G\"\n      } else {\n        preferenceRating = \"R18\"\n      }\n    } else {\n      if (showR15InNormalMode) {\n        preferenceRating = \"R15\"\n      } else {\n        preferenceRating = \"G\"\n      }\n    }\n\n    await updateUserSetting({\n      variables: {\n        input: {\n          isNotifyComment,\n          preferenceRating,\n        },\n      },\n    })\n\n    toast(t(\"ä¿å­˜ã—ã¾ã—ãŸ\", \"Saved\"))\n    navigate(\"/settings/completed\")\n  }\n\n  return (\n    <div className=\"container m-auto space-y-4\">\n      <p className=\"font-bold\">\n        {t(\"ã‚ãªãŸã¯18æ­³ä»¥ä¸Šã§ã™ã‹ï¼Ÿ\", \"Are you over 18?\")}\n      </p>\n      <div className=\"flex space-x-2\">\n        <Button\n          variant={isAdult === \"YES\" ? \"default\" : \"secondary\"}\n          onClick={() => setIsAdult(\"YES\")}\n        >\n          YES\n        </Button>\n        <Button\n          variant={isAdult === \"NO\" ? \"default\" : \"secondary\"}\n          onClick={() => {\n            setIsAdult(\"NO\")\n            // 18æ­³æœªæº€ã®å ´åˆã€R18ã‚„R18Gã®è¨­å®šã‚’ç„¡åŠ¹åŒ–\n            setShowSensitiveModeToggle(false)\n            setShowR18GInSensitiveMode(false)\n          }}\n        >\n          NO\n        </Button>\n      </div>\n      {isAdult && (\n        <>\n          {/* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å¹´é½¢è¨­å®š */}\n          <div className=\"space-y-4\">\n            <p className=\"font-bold\">\n              {t(\n                \"è¡¨ç¤ºã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å¹´é½¢è¨­å®š\",\n                \"Content age restriction settings\",\n              )}\n            </p>\n            <p className=\"text-sm\">\n              {t(\n                \"è¡¨ç¤ºã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å¹´é½¢åˆ¶é™ã‚’è¨­å®šã§ãã¾ã™ã€‚ä¸€éƒ¨ãƒšãƒ¼ã‚¸ã§ã¯åæ˜ ã•ã‚Œãªã„ã®ã§ã”æ³¨æ„ãã ã•ã„ã€‚\",\n                \"You can set the age restrictions for displayed content. Note that it may not be reflected on some pages.\",\n              )}\n            </p>\n            <div className=\"flex flex-col space-y-4\">\n              <div className=\"flex w-full items-center justify-between\">\n                <Label htmlFor=\"show-r15\">\n                  {t(\n                    \"(é€šå¸¸ãƒ¢ãƒ¼ãƒ‰æ™‚)R15ä½œå“ã‚’è¡¨ç¤ºã™ã‚‹\",\n                    \"Show R15 content in normal mode\",\n                  )}\n                </Label>\n                <Switch\n                  onCheckedChange={setShowR15InNormalMode}\n                  checked={showR15InNormalMode}\n                  id=\"show-r15\"\n                  disabled={showSensitiveModeToggle} // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ãŒæœ‰åŠ¹ãªå ´åˆã¯ç„¡åŠ¹åŒ–\n                />\n              </div>\n              <div className=\"flex w-full items-center justify-between\">\n                <Label htmlFor=\"show-sensitive-toggle\">\n                  {t(\n                    \"R18åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ï¼ˆå¯¾è±¡å¹´é½¢å¤‰æ›´ãƒœã‚¿ãƒ³ï¼‰ã‚’è¡¨ç¤ºã™ã‚‹\",\n                    \"Show sensitive mode toggle button in the menu\",\n                  )}\n                </Label>\n                <Switch\n                  onCheckedChange={(checked) => {\n                    setShowSensitiveModeToggle(checked)\n                    if (checked) {\n                      // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹ã«ã—ãŸã‚‰ R15 ã‚’è¡¨ç¤º\n                      setShowR15InNormalMode(true)\n                    } else {\n                      // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ã‚’ç„¡åŠ¹ã«ã—ãŸã‚‰ R18G ã®è¡¨ç¤ºã‚’ç„¡åŠ¹åŒ–\n                      setShowR18GInSensitiveMode(false)\n                    }\n                  }}\n                  checked={showSensitiveModeToggle}\n                  id=\"show-sensitive-toggle\"\n                  disabled={isAdult !== \"YES\"} // 18æ­³æœªæº€ã¯ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹ã«ã§ããªã„\n                />\n              </div>\n              <div className=\"flex w-full items-center justify-between\">\n                <Label htmlFor=\"show-r18g\">\n                  {t(\n                    \"(ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰æ™‚)R18Gä½œå“ã‚’è¡¨ç¤ºã™ã‚‹\",\n                    \"Show R18G content in sensitive mode\",\n                  )}\n                </Label>\n                <Switch\n                  onCheckedChange={setShowR18GInSensitiveMode}\n                  checked={showR18GInSensitiveMode}\n                  id=\"show-r18g\"\n                  disabled={!showSensitiveModeToggle} // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ãŒç„¡åŠ¹ãªå ´åˆã¯ç„¡åŠ¹åŒ–\n                />\n              </div>\n            </div>\n          </div>\n          <Separator />\n        </>\n      )}\n\n      {/* ä¿å­˜ãƒœã‚¿ãƒ³ */}\n      <Button\n        onClick={onSave}\n        disabled={isUpdatingUserSetting}\n        className=\"ml-auto block w-full text-center\"\n      >\n        {isUpdatingUserSetting ? (\n          <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n        ) : (\n          t(\"å®Œäº†\", \"Save\")\n        )}\n      </Button>\n    </div>\n  )\n}\n\nconst userSettingQuery = graphql(`\n  query UserSetting {\n    userSetting {\n      id\n      userId\n      preferenceRating\n      isNotifyComment\n    }\n  }\n`)\n\nconst updateUserSettingMutation = graphql(`\n  mutation UpdateUserSetting($input: UpdateUserSettingInput!) {\n    updateUserSetting(input: $input) {\n      preferenceRating\n    }\n  }\n`)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.settings._index/components/user-settings-form.tsx"},"span":[7342,7631],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useQuery, useMutation } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon } from \"lucide-react\"\nimport { useContext, useEffect, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { Switch } from \"~/components/ui/switch\"\nimport { Label } from \"~/components/ui/label\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { useNavigate } from \"@remix-run/react\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function UserSettingsForm () {\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const navigate = useNavigate()\n\n  const { data: userSettingData } = useQuery(userSettingQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n  })\n\n  const [updateUserSetting, { loading: isUpdatingUserSetting }] = useMutation(\n    updateUserSettingMutation,\n  )\n\n  // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å¹´é½¢è¨­å®šç”¨ã®çŠ¶æ…‹å¤‰æ•°\n  const [showR15InNormalMode, setShowR15InNormalMode] = useState(false)\n\n  const [showSensitiveModeToggle, setShowSensitiveModeToggle] = useState(false)\n\n  const [showR18GInSensitiveMode, setShowR18GInSensitiveMode] = useState(false)\n\n  // 18æ­³ä»¥ä¸Šã‹ã©ã†ã‹ã®ç¢ºèªç”¨çŠ¶æ…‹å¤‰æ•°\n  const [isAdult, setIsAdult] = useState<string | null>(null)\n\n  // ãã®ä»–ã®è¨­å®šç”¨ã®çŠ¶æ…‹å¤‰æ•°\n  const [isNotifyComment, setIsNotifyComment] = useState(false)\n\n  useEffect(() => {\n    const userSetting = userSettingData?.userSetting\n\n    if (userSetting) {\n      // preferenceRating ã«åŸºã¥ã„ã¦åˆæœŸå€¤ã‚’è¨­å®š\n      const preferenceRating = userSetting.preferenceRating\n\n      if (preferenceRating === \"G\") {\n        setShowR15InNormalMode(false)\n        setShowSensitiveModeToggle(false)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R15\") {\n        setShowR15InNormalMode(true)\n        setShowSensitiveModeToggle(false)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R18\") {\n        setShowR15InNormalMode(true)\n        setShowSensitiveModeToggle(true)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R18G\") {\n        setShowR15InNormalMode(true)\n        setShowSensitiveModeToggle(true)\n        setShowR18GInSensitiveMode(true)\n      }\n\n      // 18æ­³ä»¥ä¸Šã‹ã©ã†ã‹ã®ç¢ºèª\n      setIsAdult(\n        userSetting.preferenceRating === \"G\" ||\n          userSetting.preferenceRating === \"R15\"\n          ? \"YES\"\n          : \"NO\",\n      )\n\n      // ãã®ä»–ã®è¨­å®šã‚’åˆæœŸåŒ–\n      setIsNotifyComment(userSetting.isNotifyComment ?? false)\n    }\n  }, [userSettingData])\n\n  const onSave = async () => {\n    if (!isAdult) {\n      toast(\n        t(\n          \"18æ­³ä»¥ä¸Šã‹ã©ã†ã‹ã‚’é¸æŠã—ã¦ãã ã•ã„\",\n          \"Please select if you are over 18\",\n        ),\n      )\n      return\n    }\n\n    // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®é¸æŠçŠ¶æ…‹ã«åŸºã¥ã„ã¦ preferenceRating ã‚’æ±ºå®š\n    let preferenceRating: IntrospectionEnum<\"PreferenceRating\"> = \"G\"\n\n    if (showSensitiveModeToggle) {\n      if (showR18GInSensitiveMode) {\n        preferenceRating = \"R18G\"\n      } else {\n        preferenceRating = \"R18\"\n      }\n    } else {\n      if (showR15InNormalMode) {\n        preferenceRating = \"R15\"\n      } else {\n        preferenceRating = \"G\"\n      }\n    }\n\n    await updateUserSetting({\n      variables: {\n        input: {\n          isNotifyComment,\n          preferenceRating,\n        },\n      },\n    })\n\n    toast(t(\"ä¿å­˜ã—ã¾ã—ãŸ\", \"Saved\"))\n    navigate(\"/settings/completed\")\n  }\n\n  return (\n    <div className=\"container m-auto space-y-4\">\n      <p className=\"font-bold\">\n        {t(\"ã‚ãªãŸã¯18æ­³ä»¥ä¸Šã§ã™ã‹ï¼Ÿ\", \"Are you over 18?\")}\n      </p>\n      <div className=\"flex space-x-2\">\n        <Button\n          variant={isAdult === \"YES\" ? \"default\" : \"secondary\"}\n          onClick={() => setIsAdult(\"YES\")}\n        >\n          YES\n        </Button>\n        <Button\n          variant={isAdult === \"NO\" ? \"default\" : \"secondary\"}\n          onClick={() => {\n            setIsAdult(\"NO\")\n            // 18æ­³æœªæº€ã®å ´åˆã€R18ã‚„R18Gã®è¨­å®šã‚’ç„¡åŠ¹åŒ–\n            setShowSensitiveModeToggle(false)\n            setShowR18GInSensitiveMode(false)\n          }}\n        >\n          NO\n        </Button>\n      </div>\n      {isAdult && (\n        <>\n          {/* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å¹´é½¢è¨­å®š */}\n          <div className=\"space-y-4\">\n            <p className=\"font-bold\">\n              {t(\n                \"è¡¨ç¤ºã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å¹´é½¢è¨­å®š\",\n                \"Content age restriction settings\",\n              )}\n            </p>\n            <p className=\"text-sm\">\n              {t(\n                \"è¡¨ç¤ºã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å¹´é½¢åˆ¶é™ã‚’è¨­å®šã§ãã¾ã™ã€‚ä¸€éƒ¨ãƒšãƒ¼ã‚¸ã§ã¯åæ˜ ã•ã‚Œãªã„ã®ã§ã”æ³¨æ„ãã ã•ã„ã€‚\",\n                \"You can set the age restrictions for displayed content. Note that it may not be reflected on some pages.\",\n              )}\n            </p>\n            <div className=\"flex flex-col space-y-4\">\n              <div className=\"flex w-full items-center justify-between\">\n                <Label htmlFor=\"show-r15\">\n                  {t(\n                    \"(é€šå¸¸ãƒ¢ãƒ¼ãƒ‰æ™‚)R15ä½œå“ã‚’è¡¨ç¤ºã™ã‚‹\",\n                    \"Show R15 content in normal mode\",\n                  )}\n                </Label>\n                <Switch\n                  onCheckedChange={setShowR15InNormalMode}\n                  checked={showR15InNormalMode}\n                  id=\"show-r15\"\n                  disabled={showSensitiveModeToggle} // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ãŒæœ‰åŠ¹ãªå ´åˆã¯ç„¡åŠ¹åŒ–\n                />\n              </div>\n              <div className=\"flex w-full items-center justify-between\">\n                <Label htmlFor=\"show-sensitive-toggle\">\n                  {t(\n                    \"R18åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ï¼ˆå¯¾è±¡å¹´é½¢å¤‰æ›´ãƒœã‚¿ãƒ³ï¼‰ã‚’è¡¨ç¤ºã™ã‚‹\",\n                    \"Show sensitive mode toggle button in the menu\",\n                  )}\n                </Label>\n                <Switch\n                  onCheckedChange={(checked) => {\n                    setShowSensitiveModeToggle(checked)\n                    if (checked) {\n                      // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹ã«ã—ãŸã‚‰ R15 ã‚’è¡¨ç¤º\n                      setShowR15InNormalMode(true)\n                    } else {\n                      // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ã‚’ç„¡åŠ¹ã«ã—ãŸã‚‰ R18G ã®è¡¨ç¤ºã‚’ç„¡åŠ¹åŒ–\n                      setShowR18GInSensitiveMode(false)\n                    }\n                  }}\n                  checked={showSensitiveModeToggle}\n                  id=\"show-sensitive-toggle\"\n                  disabled={isAdult !== \"YES\"} // 18æ­³æœªæº€ã¯ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹ã«ã§ããªã„\n                />\n              </div>\n              <div className=\"flex w-full items-center justify-between\">\n                <Label htmlFor=\"show-r18g\">\n                  {t(\n                    \"(ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰æ™‚)R18Gä½œå“ã‚’è¡¨ç¤ºã™ã‚‹\",\n                    \"Show R18G content in sensitive mode\",\n                  )}\n                </Label>\n                <Switch\n                  onCheckedChange={setShowR18GInSensitiveMode}\n                  checked={showR18GInSensitiveMode}\n                  id=\"show-r18g\"\n                  disabled={!showSensitiveModeToggle} // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ãŒç„¡åŠ¹ãªå ´åˆã¯ç„¡åŠ¹åŒ–\n                />\n              </div>\n            </div>\n          </div>\n          <Separator />\n        </>\n      )}\n\n      {/* ä¿å­˜ãƒœã‚¿ãƒ³ */}\n      <Button\n        onClick={onSave}\n        disabled={isUpdatingUserSetting}\n        className=\"ml-auto block w-full text-center\"\n      >\n        {isUpdatingUserSetting ? (\n          <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n        ) : (\n          t(\"å®Œäº†\", \"Save\")\n        )}\n      </Button>\n    </div>\n  )\n}\n\nconst userSettingQuery = graphql(`\n  query UserSetting {\n    userSetting {\n      id\n      userId\n      preferenceRating\n      isNotifyComment\n    }\n  }\n`)\n\nconst updateUserSettingMutation = graphql(`\n  mutation UpdateUserSetting($input: UpdateUserSettingInput!) {\n    updateUserSetting(input: $input) {\n      preferenceRating\n    }\n  }\n`)\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.text/route.tsx"},"span":[14080,14145],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { deleteUploadedImage } from \"~/utils/delete-uploaded-image\"\nimport { getSizeFromBase64 } from \"~/utils/get-size-from-base64\"\nimport { resizeImage } from \"~/utils/resize-image\"\nimport { sha256 } from \"~/utils/sha256\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { CreatingWorkDialog } from \"~/routes/($lang)._main.new.image/components/creating-work-dialog\"\nimport {\n  PostTextFormAiModelFragment,\n  PostTextFormAlbumFragment,\n  PostTextFormInput,\n  PostTextFormPassFragment,\n  PostTextFormRecentlyUsedTagsFragment,\n} from \"~/routes/($lang)._main.new.image/components/post-text-form-input\"\nimport { PostTextFormUploader } from \"~/routes/($lang)._main.new.image/components/post-text-form-uploader\"\nimport { SuccessCreatedWorkDialog } from \"~/routes/($lang)._main.new.image/components/success-created-work-dialog\"\nimport { vPostTextForm } from \"~/routes/($lang)._main.new.image/validations/post-text-form\"\nimport { postTextFormInputReducer } from \"~/routes/($lang)._main.new.text/reducers/post-text-form-input-reducer\"\nimport { postTextFormReducer } from \"~/routes/($lang)._main.new.text/reducers/post-text-form-reducer\"\nimport { createBase64FromImageURL } from \"~/routes/($lang).generation._index/utils/create-base64-from-image-url\"\nimport { useQuery, useMutation } from \"@apollo/client/index\"\nimport {\n  type MetaFunction,\n  useBeforeUnload,\n  useLoaderData,\n  useSearchParams,\n} from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport React, { useEffect } from \"react\"\nimport { useContext, useReducer } from \"react\"\nimport { toast } from \"sonner\"\nimport { safeParse } from \"valibot\"\nimport { PostFormHeader } from \"~/routes/($lang)._main.new.image/components/post-form-header\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { getJstDate } from \"~/utils/jst-date\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport type { LoaderFunctionArgs } from \"react-router-dom\"\nimport { uploadTextFile } from \"~/utils/upload-text-file\"\nimport type { HeadersFunction } from \"@remix-run/cloudflare\"\nimport { loaderClient } from \"~/lib/loader-client\"\n\nexport default function NewText () {\n  const data = useLoaderData<typeof loader>()\n\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const [searchParams] = useSearchParams()\n\n  const ref = searchParams.get(\"generation\")\n\n  const now = getJstDate(new Date())\n\n  const afterDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const { data: viewerData } = useQuery(viewerQuery, {\n    skip: authContext.isNotLoggedIn,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: authContext.userId,\n      generationLimit: 64,\n      generationOffset: 0,\n      generationWhere: {\n        nanoids: ref?.split(\"|\") ?? [],\n      },\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: now.toISOString().split(\"T\")[0],\n      endDate: afterDate.toISOString().split(\"T\")[0],\n    },\n  })\n\n  const viewer = data\n\n  const [state, dispatch] = useReducer(postTextFormReducer, {\n    editTargetImageBase64: null,\n    indexList: [],\n    isDrawing: false,\n    isHovered: false,\n    isOpenImageGenerationDialog: false,\n    isSelectedGenerationImage: false,\n    isThumbnailLandscape: false,\n    items: [],\n    ogpBase64: null,\n    pngInfo: null,\n    progress: 0,\n    selectedImageGenerationIds: [],\n    thumbnailBase64: null,\n    thumbnailPosX: 0,\n    thumbnailPosY: 0,\n    uploadedWorkId: null,\n    uploadedWorkUuid: null,\n    videoFile: null,\n    isOpenLoadingAi: false,\n  })\n\n  const [inputState, dispatchInput] = useReducer(postTextFormInputReducer, {\n    accessType: \"PUBLIC\",\n    generationParamAccessType: \"PUBLIC\",\n    aiModelId: \"1\",\n    albumId: null,\n    caption: \"\",\n    date: new Date(),\n    enCaption: \"\",\n    enTitle: \"\",\n    imageInformation: null,\n    imageStyle: \"ILLUSTRATION\",\n    link: \"\",\n    ratingRestriction: \"G\",\n    reservationDate: null,\n    reservationTime: null,\n    tags: [],\n    themeId: null,\n    title: \"\",\n    useCommentFeature: true,\n    useGenerationParams: true,\n    usePromotionFeature: false,\n    useTagFeature: true,\n    md: \"\",\n    type: \"COLUMN\",\n    correctionMessage: \"\",\n  })\n\n  useEffect(() => {\n    const processImages = async () => {\n      if (viewer?.viewer?.imageGenerationResults) {\n        const base64Urls = await Promise.all(\n          viewer.viewer.imageGenerationResults\n            .map((result) =>\n              result.imageUrl ? createBase64FromImageURL(result.imageUrl) : \"\",\n            )\n            .filter((url) => url !== \"\"),\n        )\n\n        dispatch({\n          type: \"SET_ITEMS\",\n          payload: viewer.viewer.imageGenerationResults.map(\n            (_result, index) => ({\n              id: index + 1,\n              content: base64Urls[index],\n            }),\n          ),\n        })\n\n        dispatch({\n          type: \"SET_THUMBNAIL_BASE64\",\n          payload: base64Urls[0],\n        })\n\n        if (viewer.viewer.imageGenerationResults.length > 0) {\n          dispatch({\n            type: \"SET_PNG_INFO\",\n            payload: {\n              src: null,\n              params: {\n                prompt: viewer.viewer.imageGenerationResults[0].prompt,\n                negativePrompt:\n                  viewer.viewer.imageGenerationResults[0].negativePrompt,\n                seed: viewer.viewer.imageGenerationResults[0].seed.toString(),\n                sampler: viewer.viewer.imageGenerationResults[0].sampler,\n                strength: \"\",\n                noise: \"\",\n                model: viewer.viewer.imageGenerationResults[0].model?.name,\n                modelHash: viewer.viewer.imageGenerationResults[0].model?.id,\n                steps: viewer.viewer.imageGenerationResults[0].steps.toString(),\n                scale: viewer.viewer.imageGenerationResults[0].scale.toString(),\n                vae: \"\",\n              },\n            },\n          })\n        }\n\n        dispatch({\n          type: \"IS_SELECTED_GENERATION_IMAGE\",\n          payload: true,\n        })\n      }\n    }\n\n    processImages()\n  }, [viewer?.viewer?.imageGenerationResults, dispatch])\n\n  const [createWork, { loading: isCreatedLoading }] =\n    useMutation(CreateWorkMutation)\n\n  const formResult = safeParse(vPostTextForm, {\n    title: inputState.title,\n    caption: inputState.caption,\n    enTitle: inputState.enTitle,\n    enCaption: inputState.enCaption,\n    imagesCount: state.items.length,\n    thumbnailBase64: state.thumbnailBase64,\n    md: inputState.md,\n  })\n\n  const uploadImages = async () => {\n    if (authContext.userId === null) {\n      return []\n    }\n    const images = state.items.map((item) => item.content)\n    const uploads = images.map((image) => {\n      if (image === null) {\n        return null\n      }\n      return uploadPublicImage(image, viewerData?.viewer?.token)\n    })\n    const imageUrls = await Promise.all(uploads)\n    return imageUrls\n  }\n\n  const onPost = async () => {\n    const url = uploadTextFile(\n      inputState.md,\n      \"md\",\n      viewerData?.viewer?.token,\n      \"https://text-files.aipictors.com/c09d45d7-c949-4515-b477-d1c17f1dd038\",\n    )\n\n    if (url === null) {\n      toast(t(\"æœ¬æ–‡ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to upload the text\"))\n      return\n    }\n\n    if (formResult.success === false) {\n      for (const issue of formResult.issues) {\n        toast(issue.message)\n        return\n      }\n      return\n    }\n\n    if (\n      inputState.reservationDate !== null &&\n      inputState.reservationTime === null\n    ) {\n      toast(\n        t(\n          \"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter the scheduled post time\",\n        ),\n      )\n      return\n    }\n\n    if (\n      inputState.reservationDate === null &&\n      inputState.reservationTime !== null\n    ) {\n      toast(\n        t(\n          \"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter the scheduled post time\",\n        ),\n      )\n      return\n    }\n\n    const uploadedImageUrls = []\n\n    try {\n      dispatch({ type: \"SET_PROGRESS\", payload: 10 })\n\n      const smallThumbnail = state.isThumbnailLandscape\n        ? await resizeImage(formResult.output.thumbnailBase64, 400, 0, \"webp\")\n        : await resizeImage(formResult.output.thumbnailBase64, 0, 400, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 20 })\n\n      const largeThumbnail = state.isThumbnailLandscape\n        ? await resizeImage(formResult.output.thumbnailBase64, 600, 0, \"webp\")\n        : await resizeImage(formResult.output.thumbnailBase64, 0, 600, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 30 })\n\n      const smallThumbnailUrl = await uploadPublicImage(\n        smallThumbnail.base64,\n        viewerData?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 40 })\n\n      uploadedImageUrls.push(smallThumbnailUrl)\n\n      const largeThumbnailUrl = await uploadPublicImage(\n        largeThumbnail.base64,\n        viewerData?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 50 })\n\n      uploadedImageUrls.push(largeThumbnailUrl)\n\n      const ogpBase64Url = state.ogpBase64\n        ? await uploadPublicImage(state.ogpBase64, viewerData?.viewer?.token)\n        : null\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 60 })\n\n      if (ogpBase64Url !== null) {\n        uploadedImageUrls.push(ogpBase64Url)\n      }\n\n      const reservedAt =\n        inputState.reservationDate !== null &&\n        inputState.reservationTime !== null\n          ? new Date(\n              `${inputState.reservationDate}T${inputState.reservationTime}`,\n            ).getTime() +\n            3600000 * 9\n          : undefined\n\n      const mainImageSha256 = await sha256(formResult.output.thumbnailBase64)\n\n      const mainImageSize = await getSizeFromBase64(\n        formResult.output.thumbnailBase64,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 70 })\n\n      const textFile = await uploadTextFile(\n        inputState.md,\n        \"md\",\n        viewerData?.viewer?.token,\n      )\n\n      if (textFile === null) {\n        toast(\n          t(\"æœ¬æ–‡ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to upload the text\"),\n        )\n        return\n      }\n\n      const uploadResults = await uploadImages()\n\n      const imageUrls = uploadResults.filter((url) => url !== null)\n\n      if (imageUrls.length === 0) {\n        toast(t(\"ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to upload images\"))\n        return\n      }\n\n      const work = await createWork({\n        variables: {\n          input: {\n            title: formResult.output.title,\n            entitle: formResult.output.enTitle,\n            explanation: formResult.output.caption,\n            enExplanation: formResult.output.enCaption,\n            rating: inputState.ratingRestriction,\n            prompt: state.pngInfo?.params.prompt ?? null,\n            negativePrompt: state.pngInfo?.params.negativePrompt ?? null,\n            seed: state.pngInfo?.params.seed?.toString() ?? null,\n            sampler: state.pngInfo?.params.sampler?.toString() ?? null,\n            strength: state.pngInfo?.params.strength?.toString() ?? null,\n            noise: state.pngInfo?.params.noise?.toString() ?? null,\n            modelName: state.pngInfo?.params.model ?? null,\n            modelHash: state.pngInfo?.params.modelHash?.toString() ?? null,\n            otherGenerationParams: state.pngInfo?.src ?? null,\n            pngInfo: state.pngInfo?.src ?? null,\n            imageStyle: inputState.imageStyle,\n            relatedUrl: inputState.link,\n            tags: inputState.tags.map((tag) => tag.text),\n            isTagEditable: inputState.useTagFeature,\n            isCommentEditable: inputState.useCommentFeature,\n            thumbnailPosition: state.isThumbnailLandscape\n              ? state.thumbnailPosX\n              : state.thumbnailPosY,\n            modelId: inputState.aiModelId,\n            type: inputState.type ?? \"COLUMN\",\n            subjectId: inputState.themeId,\n            albumId: inputState.albumId,\n            isPromotion: inputState.usePromotionFeature,\n            reservedAt: reservedAt,\n            mainImageSha256: mainImageSha256,\n            accessType: inputState.accessType,\n            imageUrls: imageUrls,\n            smallThumbnailImageURL: smallThumbnailUrl,\n            smallThumbnailImageWidth: smallThumbnail.width,\n            smallThumbnailImageHeight: smallThumbnail.height,\n            largeThumbnailImageURL: largeThumbnailUrl,\n            largeThumbnailImageWidth: largeThumbnail.width,\n            largeThumbnailImageHeight: largeThumbnail.height,\n            videoUrl: null,\n            ogpImageUrl: ogpBase64Url,\n            imageHeight: mainImageSize.height,\n            imageWidth: mainImageSize.width,\n            accessGenerationType:\n              state.isSelectedGenerationImage && inputState.useGenerationParams\n                ? \"PUBLIC_RESTORABLE\"\n                : inputState.useGenerationParams\n                  ? \"PUBLIC\"\n                  : \"PRIVATE\",\n            mdUrl: textFile,\n          },\n        },\n      })\n\n      if (work.data?.createWork === undefined) {\n        toast(t(\"ä½œå“ã®æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to post the work\"))\n        return\n      }\n\n      dispatch({\n        type: \"MARK_AS_DONE\",\n        payload: {\n          uploadedWorkId: work.data?.createWork.id,\n          uploadedWorkUuid: work.data?.createWork.uuid,\n        },\n      })\n\n      toast(t(\"ä½œå“ã‚’æŠ•ç¨¿ã—ã¾ã—ãŸ\", \"Work has been posted\"))\n    } catch (error) {\n      if (error instanceof Error) {\n        toast(error.message)\n      }\n      const promises = uploadedImageUrls.map((url) => {\n        return deleteUploadedImage(url)\n      })\n      await Promise.all(promises)\n      dispatch({ type: \"SET_PROGRESS\", payload: 0 })\n    }\n  }\n\n  const createdAt = new Date(\n    `${inputState.reservationDate}T${inputState.reservationTime}`,\n  )\n\n  // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n  useBeforeUnload(\n    // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n    React.useCallback(\n      (event) => {\n        if (state) {\n          const confirmationMessage = t(\n            \"ãƒšãƒ¼ã‚¸é·ç§»ã™ã‚‹ã¨å¤‰æ›´ãŒæ¶ˆãˆã¾ã™ãŒå•é¡Œç„¡ã„ã§ã™ã‹ï¼Ÿ\",\n            \"Are you sure to leave this page? Changes may be lost.\",\n          )\n          event.returnValue = confirmationMessage\n          return confirmationMessage\n        }\n      },\n      [state, t],\n    ),\n  )\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <div className=\"m-auto w-full max-w-[1200px] space-y-4 pb-4\">\n      <div className=\"space-y-4\">\n        <div>\n          <PostFormHeader type=\"text\" />\n          <PostTextFormUploader state={state} dispatch={dispatch} />\n        </div>\n        <PostTextFormInput\n          imageInformation={state.pngInfo}\n          state={inputState}\n          dispatch={dispatchInput}\n          albums={viewerData?.albums ?? []}\n          currentPass={viewerData?.viewer?.currentPass ?? null}\n          recentlyUsedTags={viewerData?.viewer?.recentlyUsedTags ?? []}\n          themes={\n            viewer?.dailyThemes\n              ? viewer.dailyThemes.map((theme) => ({\n                  date: theme.dateText,\n                  title: theme.title,\n                  id: theme.id,\n                }))\n              : null\n          }\n          aiModels={viewerData?.aiModels ?? []}\n          events={viewer?.appEvents ?? []}\n          needFix={false}\n        />\n        <div className=\"h-4\" />\n        <Button\n          className=\"fixed bottom-0 left-0 z-60 ml-0 w-full rounded-none p-0 md:ml-[72px] md:pr-[72px] lg:ml-[224px] lg:pr-[224px] xl:left-auto xl:m-0 xl:max-w-[1200px] xl:pl-[8%]\"\n          size={\"lg\"}\n          type=\"submit\"\n          onClick={onPost}\n        >\n          {t(\"æŠ•ç¨¿\", \"Post\")}\n        </Button>\n      </div>\n      <SuccessCreatedWorkDialog\n        isOpen={state.progress === 100}\n        title={inputState.title}\n        description={inputState.caption}\n        imageBase64={state.thumbnailBase64}\n        workId={state.uploadedWorkId}\n        uuid={state.uploadedWorkUuid}\n        shareTags={[\"Aipictors\", \"AIã‚¤ãƒ©ã‚¹ãƒˆ\", \"AIart\"]}\n        createdAt={createdAt.getTime()}\n        accessType={inputState.accessType}\n      />\n      <CreatingWorkDialog\n        progress={state.progress}\n        isOpen={state.progress !== 0 && state.progress !== 100}\n      />\n    </div>\n  )\n}\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.NEW_TEXT, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const now = getJstDate(new Date())\n\n  const afterDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const result = await loaderClient.query({\n    query: viewerQuery,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: \"-1\",\n      generationLimit: 64,\n      generationOffset: 0,\n      generationWhere: {\n        nanoids: [],\n      },\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: now.toISOString().split(\"T\")[0],\n      endDate: afterDate.toISOString().split(\"T\")[0],\n    },\n  })\n\n  return {\n    ...result.data,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  // æŠ•ç¨¿ç”»é¢ãªã®ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nconst viewerQuery = graphql(\n  `query ViewerQuery(\n    $limit: Int!,\n    $offset: Int!,\n    $ownerUserId: ID\n    $generationOffset: Int!,\n    $generationLimit: Int!,\n    $generationWhere: ImageGenerationResultsWhereInput,\n    $startDate: String!,\n    $endDate: String!,\n    $startAt: String!,\n  ) {\n    viewer {\n      id\n      token\n      currentPass {\n        ...PostTextFormPass\n      }\n      recentlyUsedTags {\n        ...PostTextFormRecentlyUsedTags\n      }\n      imageGenerationResults(offset: $generationOffset, limit: $generationLimit, where: $generationWhere) {\n        id\n        prompt\n        negativePrompt\n        seed\n        steps\n        scale\n        sampler\n        clipSkip\n        sizeType\n        t2tImageUrl\n        t2tMaskImageUrl\n        t2tDenoisingStrengthSize\n        t2tInpaintingFillSize\n        rating\n        completedAt\n        isProtected\n        generationType\n        postModelId\n        modelHash\n        model {\n          id\n          name\n          type\n        }\n        vae\n        nanoid\n        status\n        estimatedSeconds\n        controlNetControlMode\n        controlNetEnabled\n        controlNetGuidanceEnd\n        controlNetGuidanceStart\n        controlNetPixelPerfect\n        controlNetProcessorRes\n        controlNetResizeMode\n        controlNetThresholdA\n        controlNetThresholdB\n        controlNetWeight\n        controlNetModule\n        controlNetModel\n        controlNetSaveDetectedMap\n        controlNetHrOption\n        upscaleSize\n        imageUrl\n        thumbnailUrl\n      }\n    }\n    albums(\n      offset: $offset,\n      limit: $limit,\n      where: {\n        ownerUserId: $ownerUserId,\n        needInspected: false,\n        needsThumbnailImage: false,\n      }\n    ) {\n      ...PostTextFormAlbum\n    }\n    aiModels(offset: 0, limit: 124, where: {}) {\n      id\n      ...PostTextFormAiModel\n    }\n    dailyThemes(\n      limit: 8,\n      offset: 0,\n      where: {\n        startDate: $startDate,\n        endDate: $endDate,\n      }) {\n      id\n      title\n      dateText\n    }\n    appEvents(\n      limit: 8,\n      offset: 0,\n      where: {\n        endAt: $startAt,\n      }\n    ) {\n      id\n      description\n      title\n      tag\n      slug\n      endAt\n    }\n  }`,\n  [\n    PostTextFormAiModelFragment,\n    PostTextFormAlbumFragment,\n    PostTextFormPassFragment,\n    PostTextFormRecentlyUsedTagsFragment,\n  ],\n)\n\nconst CreateWorkMutation = graphql(\n  `mutation CreateWork($input: CreateWorkInput!) {\n    createWork(input: $input) {\n      id\n      title\n      accessType\n      nanoid\n      uuid\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.text/route.tsx"},"span":[13991,14056],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { deleteUploadedImage } from \"~/utils/delete-uploaded-image\"\nimport { getSizeFromBase64 } from \"~/utils/get-size-from-base64\"\nimport { resizeImage } from \"~/utils/resize-image\"\nimport { sha256 } from \"~/utils/sha256\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { CreatingWorkDialog } from \"~/routes/($lang)._main.new.image/components/creating-work-dialog\"\nimport {\n  PostTextFormAiModelFragment,\n  PostTextFormAlbumFragment,\n  PostTextFormInput,\n  PostTextFormPassFragment,\n  PostTextFormRecentlyUsedTagsFragment,\n} from \"~/routes/($lang)._main.new.image/components/post-text-form-input\"\nimport { PostTextFormUploader } from \"~/routes/($lang)._main.new.image/components/post-text-form-uploader\"\nimport { SuccessCreatedWorkDialog } from \"~/routes/($lang)._main.new.image/components/success-created-work-dialog\"\nimport { vPostTextForm } from \"~/routes/($lang)._main.new.image/validations/post-text-form\"\nimport { postTextFormInputReducer } from \"~/routes/($lang)._main.new.text/reducers/post-text-form-input-reducer\"\nimport { postTextFormReducer } from \"~/routes/($lang)._main.new.text/reducers/post-text-form-reducer\"\nimport { createBase64FromImageURL } from \"~/routes/($lang).generation._index/utils/create-base64-from-image-url\"\nimport { useQuery, useMutation } from \"@apollo/client/index\"\nimport {\n  type MetaFunction,\n  useBeforeUnload,\n  useLoaderData,\n  useSearchParams,\n} from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport React, { useEffect } from \"react\"\nimport { useContext, useReducer } from \"react\"\nimport { toast } from \"sonner\"\nimport { safeParse } from \"valibot\"\nimport { PostFormHeader } from \"~/routes/($lang)._main.new.image/components/post-form-header\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { getJstDate } from \"~/utils/jst-date\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport type { LoaderFunctionArgs } from \"react-router-dom\"\nimport { uploadTextFile } from \"~/utils/upload-text-file\"\nimport type { HeadersFunction } from \"@remix-run/cloudflare\"\nimport { loaderClient } from \"~/lib/loader-client\"\n\nexport default function NewText () {\n  const data = useLoaderData<typeof loader>()\n\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const [searchParams] = useSearchParams()\n\n  const ref = searchParams.get(\"generation\")\n\n  const now = getJstDate(new Date())\n\n  const afterDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const { data: viewerData } = useQuery(viewerQuery, {\n    skip: authContext.isNotLoggedIn,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: authContext.userId,\n      generationLimit: 64,\n      generationOffset: 0,\n      generationWhere: {\n        nanoids: ref?.split(\"|\") ?? [],\n      },\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: now.toISOString().split(\"T\")[0],\n      endDate: afterDate.toISOString().split(\"T\")[0],\n    },\n  })\n\n  const viewer = data\n\n  const [state, dispatch] = useReducer(postTextFormReducer, {\n    editTargetImageBase64: null,\n    indexList: [],\n    isDrawing: false,\n    isHovered: false,\n    isOpenImageGenerationDialog: false,\n    isSelectedGenerationImage: false,\n    isThumbnailLandscape: false,\n    items: [],\n    ogpBase64: null,\n    pngInfo: null,\n    progress: 0,\n    selectedImageGenerationIds: [],\n    thumbnailBase64: null,\n    thumbnailPosX: 0,\n    thumbnailPosY: 0,\n    uploadedWorkId: null,\n    uploadedWorkUuid: null,\n    videoFile: null,\n    isOpenLoadingAi: false,\n  })\n\n  const [inputState, dispatchInput] = useReducer(postTextFormInputReducer, {\n    accessType: \"PUBLIC\",\n    generationParamAccessType: \"PUBLIC\",\n    aiModelId: \"1\",\n    albumId: null,\n    caption: \"\",\n    date: new Date(),\n    enCaption: \"\",\n    enTitle: \"\",\n    imageInformation: null,\n    imageStyle: \"ILLUSTRATION\",\n    link: \"\",\n    ratingRestriction: \"G\",\n    reservationDate: null,\n    reservationTime: null,\n    tags: [],\n    themeId: null,\n    title: \"\",\n    useCommentFeature: true,\n    useGenerationParams: true,\n    usePromotionFeature: false,\n    useTagFeature: true,\n    md: \"\",\n    type: \"COLUMN\",\n    correctionMessage: \"\",\n  })\n\n  useEffect(() => {\n    const processImages = async () => {\n      if (viewer?.viewer?.imageGenerationResults) {\n        const base64Urls = await Promise.all(\n          viewer.viewer.imageGenerationResults\n            .map((result) =>\n              result.imageUrl ? createBase64FromImageURL(result.imageUrl) : \"\",\n            )\n            .filter((url) => url !== \"\"),\n        )\n\n        dispatch({\n          type: \"SET_ITEMS\",\n          payload: viewer.viewer.imageGenerationResults.map(\n            (_result, index) => ({\n              id: index + 1,\n              content: base64Urls[index],\n            }),\n          ),\n        })\n\n        dispatch({\n          type: \"SET_THUMBNAIL_BASE64\",\n          payload: base64Urls[0],\n        })\n\n        if (viewer.viewer.imageGenerationResults.length > 0) {\n          dispatch({\n            type: \"SET_PNG_INFO\",\n            payload: {\n              src: null,\n              params: {\n                prompt: viewer.viewer.imageGenerationResults[0].prompt,\n                negativePrompt:\n                  viewer.viewer.imageGenerationResults[0].negativePrompt,\n                seed: viewer.viewer.imageGenerationResults[0].seed.toString(),\n                sampler: viewer.viewer.imageGenerationResults[0].sampler,\n                strength: \"\",\n                noise: \"\",\n                model: viewer.viewer.imageGenerationResults[0].model?.name,\n                modelHash: viewer.viewer.imageGenerationResults[0].model?.id,\n                steps: viewer.viewer.imageGenerationResults[0].steps.toString(),\n                scale: viewer.viewer.imageGenerationResults[0].scale.toString(),\n                vae: \"\",\n              },\n            },\n          })\n        }\n\n        dispatch({\n          type: \"IS_SELECTED_GENERATION_IMAGE\",\n          payload: true,\n        })\n      }\n    }\n\n    processImages()\n  }, [viewer?.viewer?.imageGenerationResults, dispatch])\n\n  const [createWork, { loading: isCreatedLoading }] =\n    useMutation(CreateWorkMutation)\n\n  const formResult = safeParse(vPostTextForm, {\n    title: inputState.title,\n    caption: inputState.caption,\n    enTitle: inputState.enTitle,\n    enCaption: inputState.enCaption,\n    imagesCount: state.items.length,\n    thumbnailBase64: state.thumbnailBase64,\n    md: inputState.md,\n  })\n\n  const uploadImages = async () => {\n    if (authContext.userId === null) {\n      return []\n    }\n    const images = state.items.map((item) => item.content)\n    const uploads = images.map((image) => {\n      if (image === null) {\n        return null\n      }\n      return uploadPublicImage(image, viewerData?.viewer?.token)\n    })\n    const imageUrls = await Promise.all(uploads)\n    return imageUrls\n  }\n\n  const onPost = async () => {\n    const url = uploadTextFile(\n      inputState.md,\n      \"md\",\n      viewerData?.viewer?.token,\n      \"https://text-files.aipictors.com/c09d45d7-c949-4515-b477-d1c17f1dd038\",\n    )\n\n    if (url === null) {\n      toast(t(\"æœ¬æ–‡ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to upload the text\"))\n      return\n    }\n\n    if (formResult.success === false) {\n      for (const issue of formResult.issues) {\n        toast(issue.message)\n        return\n      }\n      return\n    }\n\n    if (\n      inputState.reservationDate !== null &&\n      inputState.reservationTime === null\n    ) {\n      toast(\n        t(\n          \"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter the scheduled post time\",\n        ),\n      )\n      return\n    }\n\n    if (\n      inputState.reservationDate === null &&\n      inputState.reservationTime !== null\n    ) {\n      toast(\n        t(\n          \"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter the scheduled post time\",\n        ),\n      )\n      return\n    }\n\n    const uploadedImageUrls = []\n\n    try {\n      dispatch({ type: \"SET_PROGRESS\", payload: 10 })\n\n      const smallThumbnail = state.isThumbnailLandscape\n        ? await resizeImage(formResult.output.thumbnailBase64, 400, 0, \"webp\")\n        : await resizeImage(formResult.output.thumbnailBase64, 0, 400, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 20 })\n\n      const largeThumbnail = state.isThumbnailLandscape\n        ? await resizeImage(formResult.output.thumbnailBase64, 600, 0, \"webp\")\n        : await resizeImage(formResult.output.thumbnailBase64, 0, 600, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 30 })\n\n      const smallThumbnailUrl = await uploadPublicImage(\n        smallThumbnail.base64,\n        viewerData?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 40 })\n\n      uploadedImageUrls.push(smallThumbnailUrl)\n\n      const largeThumbnailUrl = await uploadPublicImage(\n        largeThumbnail.base64,\n        viewerData?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 50 })\n\n      uploadedImageUrls.push(largeThumbnailUrl)\n\n      const ogpBase64Url = state.ogpBase64\n        ? await uploadPublicImage(state.ogpBase64, viewerData?.viewer?.token)\n        : null\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 60 })\n\n      if (ogpBase64Url !== null) {\n        uploadedImageUrls.push(ogpBase64Url)\n      }\n\n      const reservedAt =\n        inputState.reservationDate !== null &&\n        inputState.reservationTime !== null\n          ? new Date(\n              `${inputState.reservationDate}T${inputState.reservationTime}`,\n            ).getTime() +\n            3600000 * 9\n          : undefined\n\n      const mainImageSha256 = await sha256(formResult.output.thumbnailBase64)\n\n      const mainImageSize = await getSizeFromBase64(\n        formResult.output.thumbnailBase64,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 70 })\n\n      const textFile = await uploadTextFile(\n        inputState.md,\n        \"md\",\n        viewerData?.viewer?.token,\n      )\n\n      if (textFile === null) {\n        toast(\n          t(\"æœ¬æ–‡ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to upload the text\"),\n        )\n        return\n      }\n\n      const uploadResults = await uploadImages()\n\n      const imageUrls = uploadResults.filter((url) => url !== null)\n\n      if (imageUrls.length === 0) {\n        toast(t(\"ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to upload images\"))\n        return\n      }\n\n      const work = await createWork({\n        variables: {\n          input: {\n            title: formResult.output.title,\n            entitle: formResult.output.enTitle,\n            explanation: formResult.output.caption,\n            enExplanation: formResult.output.enCaption,\n            rating: inputState.ratingRestriction,\n            prompt: state.pngInfo?.params.prompt ?? null,\n            negativePrompt: state.pngInfo?.params.negativePrompt ?? null,\n            seed: state.pngInfo?.params.seed?.toString() ?? null,\n            sampler: state.pngInfo?.params.sampler?.toString() ?? null,\n            strength: state.pngInfo?.params.strength?.toString() ?? null,\n            noise: state.pngInfo?.params.noise?.toString() ?? null,\n            modelName: state.pngInfo?.params.model ?? null,\n            modelHash: state.pngInfo?.params.modelHash?.toString() ?? null,\n            otherGenerationParams: state.pngInfo?.src ?? null,\n            pngInfo: state.pngInfo?.src ?? null,\n            imageStyle: inputState.imageStyle,\n            relatedUrl: inputState.link,\n            tags: inputState.tags.map((tag) => tag.text),\n            isTagEditable: inputState.useTagFeature,\n            isCommentEditable: inputState.useCommentFeature,\n            thumbnailPosition: state.isThumbnailLandscape\n              ? state.thumbnailPosX\n              : state.thumbnailPosY,\n            modelId: inputState.aiModelId,\n            type: inputState.type ?? \"COLUMN\",\n            subjectId: inputState.themeId,\n            albumId: inputState.albumId,\n            isPromotion: inputState.usePromotionFeature,\n            reservedAt: reservedAt,\n            mainImageSha256: mainImageSha256,\n            accessType: inputState.accessType,\n            imageUrls: imageUrls,\n            smallThumbnailImageURL: smallThumbnailUrl,\n            smallThumbnailImageWidth: smallThumbnail.width,\n            smallThumbnailImageHeight: smallThumbnail.height,\n            largeThumbnailImageURL: largeThumbnailUrl,\n            largeThumbnailImageWidth: largeThumbnail.width,\n            largeThumbnailImageHeight: largeThumbnail.height,\n            videoUrl: null,\n            ogpImageUrl: ogpBase64Url,\n            imageHeight: mainImageSize.height,\n            imageWidth: mainImageSize.width,\n            accessGenerationType:\n              state.isSelectedGenerationImage && inputState.useGenerationParams\n                ? \"PUBLIC_RESTORABLE\"\n                : inputState.useGenerationParams\n                  ? \"PUBLIC\"\n                  : \"PRIVATE\",\n            mdUrl: textFile,\n          },\n        },\n      })\n\n      if (work.data?.createWork === undefined) {\n        toast(t(\"ä½œå“ã®æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to post the work\"))\n        return\n      }\n\n      dispatch({\n        type: \"MARK_AS_DONE\",\n        payload: {\n          uploadedWorkId: work.data?.createWork.id,\n          uploadedWorkUuid: work.data?.createWork.uuid,\n        },\n      })\n\n      toast(t(\"ä½œå“ã‚’æŠ•ç¨¿ã—ã¾ã—ãŸ\", \"Work has been posted\"))\n    } catch (error) {\n      if (error instanceof Error) {\n        toast(error.message)\n      }\n      const promises = uploadedImageUrls.map((url) => {\n        return deleteUploadedImage(url)\n      })\n      await Promise.all(promises)\n      dispatch({ type: \"SET_PROGRESS\", payload: 0 })\n    }\n  }\n\n  const createdAt = new Date(\n    `${inputState.reservationDate}T${inputState.reservationTime}`,\n  )\n\n  // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n  useBeforeUnload(\n    // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n    React.useCallback(\n      (event) => {\n        if (state) {\n          const confirmationMessage = t(\n            \"ãƒšãƒ¼ã‚¸é·ç§»ã™ã‚‹ã¨å¤‰æ›´ãŒæ¶ˆãˆã¾ã™ãŒå•é¡Œç„¡ã„ã§ã™ã‹ï¼Ÿ\",\n            \"Are you sure to leave this page? Changes may be lost.\",\n          )\n          event.returnValue = confirmationMessage\n          return confirmationMessage\n        }\n      },\n      [state, t],\n    ),\n  )\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <div className=\"m-auto w-full max-w-[1200px] space-y-4 pb-4\">\n      <div className=\"space-y-4\">\n        <div>\n          <PostFormHeader type=\"text\" />\n          <PostTextFormUploader state={state} dispatch={dispatch} />\n        </div>\n        <PostTextFormInput\n          imageInformation={state.pngInfo}\n          state={inputState}\n          dispatch={dispatchInput}\n          albums={viewerData?.albums ?? []}\n          currentPass={viewerData?.viewer?.currentPass ?? null}\n          recentlyUsedTags={viewerData?.viewer?.recentlyUsedTags ?? []}\n          themes={\n            viewer?.dailyThemes\n              ? viewer.dailyThemes.map((theme) => ({\n                  date: theme.dateText,\n                  title: theme.title,\n                  id: theme.id,\n                }))\n              : null\n          }\n          aiModels={viewerData?.aiModels ?? []}\n          events={viewer?.appEvents ?? []}\n          needFix={false}\n        />\n        <div className=\"h-4\" />\n        <Button\n          className=\"fixed bottom-0 left-0 z-60 ml-0 w-full rounded-none p-0 md:ml-[72px] md:pr-[72px] lg:ml-[224px] lg:pr-[224px] xl:left-auto xl:m-0 xl:max-w-[1200px] xl:pl-[8%]\"\n          size={\"lg\"}\n          type=\"submit\"\n          onClick={onPost}\n        >\n          {t(\"æŠ•ç¨¿\", \"Post\")}\n        </Button>\n      </div>\n      <SuccessCreatedWorkDialog\n        isOpen={state.progress === 100}\n        title={inputState.title}\n        description={inputState.caption}\n        imageBase64={state.thumbnailBase64}\n        workId={state.uploadedWorkId}\n        uuid={state.uploadedWorkUuid}\n        shareTags={[\"Aipictors\", \"AIã‚¤ãƒ©ã‚¹ãƒˆ\", \"AIart\"]}\n        createdAt={createdAt.getTime()}\n        accessType={inputState.accessType}\n      />\n      <CreatingWorkDialog\n        progress={state.progress}\n        isOpen={state.progress !== 0 && state.progress !== 100}\n      />\n    </div>\n  )\n}\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.NEW_TEXT, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const now = getJstDate(new Date())\n\n  const afterDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const result = await loaderClient.query({\n    query: viewerQuery,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: \"-1\",\n      generationLimit: 64,\n      generationOffset: 0,\n      generationWhere: {\n        nanoids: [],\n      },\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: now.toISOString().split(\"T\")[0],\n      endDate: afterDate.toISOString().split(\"T\")[0],\n    },\n  })\n\n  return {\n    ...result.data,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  // æŠ•ç¨¿ç”»é¢ãªã®ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nconst viewerQuery = graphql(\n  `query ViewerQuery(\n    $limit: Int!,\n    $offset: Int!,\n    $ownerUserId: ID\n    $generationOffset: Int!,\n    $generationLimit: Int!,\n    $generationWhere: ImageGenerationResultsWhereInput,\n    $startDate: String!,\n    $endDate: String!,\n    $startAt: String!,\n  ) {\n    viewer {\n      id\n      token\n      currentPass {\n        ...PostTextFormPass\n      }\n      recentlyUsedTags {\n        ...PostTextFormRecentlyUsedTags\n      }\n      imageGenerationResults(offset: $generationOffset, limit: $generationLimit, where: $generationWhere) {\n        id\n        prompt\n        negativePrompt\n        seed\n        steps\n        scale\n        sampler\n        clipSkip\n        sizeType\n        t2tImageUrl\n        t2tMaskImageUrl\n        t2tDenoisingStrengthSize\n        t2tInpaintingFillSize\n        rating\n        completedAt\n        isProtected\n        generationType\n        postModelId\n        modelHash\n        model {\n          id\n          name\n          type\n        }\n        vae\n        nanoid\n        status\n        estimatedSeconds\n        controlNetControlMode\n        controlNetEnabled\n        controlNetGuidanceEnd\n        controlNetGuidanceStart\n        controlNetPixelPerfect\n        controlNetProcessorRes\n        controlNetResizeMode\n        controlNetThresholdA\n        controlNetThresholdB\n        controlNetWeight\n        controlNetModule\n        controlNetModel\n        controlNetSaveDetectedMap\n        controlNetHrOption\n        upscaleSize\n        imageUrl\n        thumbnailUrl\n      }\n    }\n    albums(\n      offset: $offset,\n      limit: $limit,\n      where: {\n        ownerUserId: $ownerUserId,\n        needInspected: false,\n        needsThumbnailImage: false,\n      }\n    ) {\n      ...PostTextFormAlbum\n    }\n    aiModels(offset: 0, limit: 124, where: {}) {\n      id\n      ...PostTextFormAiModel\n    }\n    dailyThemes(\n      limit: 8,\n      offset: 0,\n      where: {\n        startDate: $startDate,\n        endDate: $endDate,\n      }) {\n      id\n      title\n      dateText\n    }\n    appEvents(\n      limit: 8,\n      offset: 0,\n      where: {\n        endAt: $startAt,\n      }\n    ) {\n      id\n      description\n      title\n      tag\n      slug\n      endAt\n    }\n  }`,\n  [\n    PostTextFormAiModelFragment,\n    PostTextFormAlbumFragment,\n    PostTextFormPassFragment,\n    PostTextFormRecentlyUsedTagsFragment,\n  ],\n)\n\nconst CreateWorkMutation = graphql(\n  `mutation CreateWork($input: CreateWorkInput!) {\n    createWork(input: $input) {\n      id\n      title\n      accessType\n      nanoid\n      uuid\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable isCreatedLoading is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"isCreatedLoading"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.text/route.tsx"},"span":[6238,6254],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { deleteUploadedImage } from \"~/utils/delete-uploaded-image\"\nimport { getSizeFromBase64 } from \"~/utils/get-size-from-base64\"\nimport { resizeImage } from \"~/utils/resize-image\"\nimport { sha256 } from \"~/utils/sha256\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { CreatingWorkDialog } from \"~/routes/($lang)._main.new.image/components/creating-work-dialog\"\nimport {\n  PostTextFormAiModelFragment,\n  PostTextFormAlbumFragment,\n  PostTextFormInput,\n  PostTextFormPassFragment,\n  PostTextFormRecentlyUsedTagsFragment,\n} from \"~/routes/($lang)._main.new.image/components/post-text-form-input\"\nimport { PostTextFormUploader } from \"~/routes/($lang)._main.new.image/components/post-text-form-uploader\"\nimport { SuccessCreatedWorkDialog } from \"~/routes/($lang)._main.new.image/components/success-created-work-dialog\"\nimport { vPostTextForm } from \"~/routes/($lang)._main.new.image/validations/post-text-form\"\nimport { postTextFormInputReducer } from \"~/routes/($lang)._main.new.text/reducers/post-text-form-input-reducer\"\nimport { postTextFormReducer } from \"~/routes/($lang)._main.new.text/reducers/post-text-form-reducer\"\nimport { createBase64FromImageURL } from \"~/routes/($lang).generation._index/utils/create-base64-from-image-url\"\nimport { useQuery, useMutation } from \"@apollo/client/index\"\nimport {\n  type MetaFunction,\n  useBeforeUnload,\n  useLoaderData,\n  useSearchParams,\n} from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport React, { useEffect } from \"react\"\nimport { useContext, useReducer } from \"react\"\nimport { toast } from \"sonner\"\nimport { safeParse } from \"valibot\"\nimport { PostFormHeader } from \"~/routes/($lang)._main.new.image/components/post-form-header\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { getJstDate } from \"~/utils/jst-date\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport type { LoaderFunctionArgs } from \"react-router-dom\"\nimport { uploadTextFile } from \"~/utils/upload-text-file\"\nimport type { HeadersFunction } from \"@remix-run/cloudflare\"\nimport { loaderClient } from \"~/lib/loader-client\"\n\nexport default function NewText () {\n  const data = useLoaderData<typeof loader>()\n\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const [searchParams] = useSearchParams()\n\n  const ref = searchParams.get(\"generation\")\n\n  const now = getJstDate(new Date())\n\n  const afterDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const { data: viewerData } = useQuery(viewerQuery, {\n    skip: authContext.isNotLoggedIn,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: authContext.userId,\n      generationLimit: 64,\n      generationOffset: 0,\n      generationWhere: {\n        nanoids: ref?.split(\"|\") ?? [],\n      },\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: now.toISOString().split(\"T\")[0],\n      endDate: afterDate.toISOString().split(\"T\")[0],\n    },\n  })\n\n  const viewer = data\n\n  const [state, dispatch] = useReducer(postTextFormReducer, {\n    editTargetImageBase64: null,\n    indexList: [],\n    isDrawing: false,\n    isHovered: false,\n    isOpenImageGenerationDialog: false,\n    isSelectedGenerationImage: false,\n    isThumbnailLandscape: false,\n    items: [],\n    ogpBase64: null,\n    pngInfo: null,\n    progress: 0,\n    selectedImageGenerationIds: [],\n    thumbnailBase64: null,\n    thumbnailPosX: 0,\n    thumbnailPosY: 0,\n    uploadedWorkId: null,\n    uploadedWorkUuid: null,\n    videoFile: null,\n    isOpenLoadingAi: false,\n  })\n\n  const [inputState, dispatchInput] = useReducer(postTextFormInputReducer, {\n    accessType: \"PUBLIC\",\n    generationParamAccessType: \"PUBLIC\",\n    aiModelId: \"1\",\n    albumId: null,\n    caption: \"\",\n    date: new Date(),\n    enCaption: \"\",\n    enTitle: \"\",\n    imageInformation: null,\n    imageStyle: \"ILLUSTRATION\",\n    link: \"\",\n    ratingRestriction: \"G\",\n    reservationDate: null,\n    reservationTime: null,\n    tags: [],\n    themeId: null,\n    title: \"\",\n    useCommentFeature: true,\n    useGenerationParams: true,\n    usePromotionFeature: false,\n    useTagFeature: true,\n    md: \"\",\n    type: \"COLUMN\",\n    correctionMessage: \"\",\n  })\n\n  useEffect(() => {\n    const processImages = async () => {\n      if (viewer?.viewer?.imageGenerationResults) {\n        const base64Urls = await Promise.all(\n          viewer.viewer.imageGenerationResults\n            .map((result) =>\n              result.imageUrl ? createBase64FromImageURL(result.imageUrl) : \"\",\n            )\n            .filter((url) => url !== \"\"),\n        )\n\n        dispatch({\n          type: \"SET_ITEMS\",\n          payload: viewer.viewer.imageGenerationResults.map(\n            (_result, index) => ({\n              id: index + 1,\n              content: base64Urls[index],\n            }),\n          ),\n        })\n\n        dispatch({\n          type: \"SET_THUMBNAIL_BASE64\",\n          payload: base64Urls[0],\n        })\n\n        if (viewer.viewer.imageGenerationResults.length > 0) {\n          dispatch({\n            type: \"SET_PNG_INFO\",\n            payload: {\n              src: null,\n              params: {\n                prompt: viewer.viewer.imageGenerationResults[0].prompt,\n                negativePrompt:\n                  viewer.viewer.imageGenerationResults[0].negativePrompt,\n                seed: viewer.viewer.imageGenerationResults[0].seed.toString(),\n                sampler: viewer.viewer.imageGenerationResults[0].sampler,\n                strength: \"\",\n                noise: \"\",\n                model: viewer.viewer.imageGenerationResults[0].model?.name,\n                modelHash: viewer.viewer.imageGenerationResults[0].model?.id,\n                steps: viewer.viewer.imageGenerationResults[0].steps.toString(),\n                scale: viewer.viewer.imageGenerationResults[0].scale.toString(),\n                vae: \"\",\n              },\n            },\n          })\n        }\n\n        dispatch({\n          type: \"IS_SELECTED_GENERATION_IMAGE\",\n          payload: true,\n        })\n      }\n    }\n\n    processImages()\n  }, [viewer?.viewer?.imageGenerationResults, dispatch])\n\n  const [createWork, { loading: isCreatedLoading }] =\n    useMutation(CreateWorkMutation)\n\n  const formResult = safeParse(vPostTextForm, {\n    title: inputState.title,\n    caption: inputState.caption,\n    enTitle: inputState.enTitle,\n    enCaption: inputState.enCaption,\n    imagesCount: state.items.length,\n    thumbnailBase64: state.thumbnailBase64,\n    md: inputState.md,\n  })\n\n  const uploadImages = async () => {\n    if (authContext.userId === null) {\n      return []\n    }\n    const images = state.items.map((item) => item.content)\n    const uploads = images.map((image) => {\n      if (image === null) {\n        return null\n      }\n      return uploadPublicImage(image, viewerData?.viewer?.token)\n    })\n    const imageUrls = await Promise.all(uploads)\n    return imageUrls\n  }\n\n  const onPost = async () => {\n    const url = uploadTextFile(\n      inputState.md,\n      \"md\",\n      viewerData?.viewer?.token,\n      \"https://text-files.aipictors.com/c09d45d7-c949-4515-b477-d1c17f1dd038\",\n    )\n\n    if (url === null) {\n      toast(t(\"æœ¬æ–‡ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to upload the text\"))\n      return\n    }\n\n    if (formResult.success === false) {\n      for (const issue of formResult.issues) {\n        toast(issue.message)\n        return\n      }\n      return\n    }\n\n    if (\n      inputState.reservationDate !== null &&\n      inputState.reservationTime === null\n    ) {\n      toast(\n        t(\n          \"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter the scheduled post time\",\n        ),\n      )\n      return\n    }\n\n    if (\n      inputState.reservationDate === null &&\n      inputState.reservationTime !== null\n    ) {\n      toast(\n        t(\n          \"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter the scheduled post time\",\n        ),\n      )\n      return\n    }\n\n    const uploadedImageUrls = []\n\n    try {\n      dispatch({ type: \"SET_PROGRESS\", payload: 10 })\n\n      const smallThumbnail = state.isThumbnailLandscape\n        ? await resizeImage(formResult.output.thumbnailBase64, 400, 0, \"webp\")\n        : await resizeImage(formResult.output.thumbnailBase64, 0, 400, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 20 })\n\n      const largeThumbnail = state.isThumbnailLandscape\n        ? await resizeImage(formResult.output.thumbnailBase64, 600, 0, \"webp\")\n        : await resizeImage(formResult.output.thumbnailBase64, 0, 600, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 30 })\n\n      const smallThumbnailUrl = await uploadPublicImage(\n        smallThumbnail.base64,\n        viewerData?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 40 })\n\n      uploadedImageUrls.push(smallThumbnailUrl)\n\n      const largeThumbnailUrl = await uploadPublicImage(\n        largeThumbnail.base64,\n        viewerData?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 50 })\n\n      uploadedImageUrls.push(largeThumbnailUrl)\n\n      const ogpBase64Url = state.ogpBase64\n        ? await uploadPublicImage(state.ogpBase64, viewerData?.viewer?.token)\n        : null\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 60 })\n\n      if (ogpBase64Url !== null) {\n        uploadedImageUrls.push(ogpBase64Url)\n      }\n\n      const reservedAt =\n        inputState.reservationDate !== null &&\n        inputState.reservationTime !== null\n          ? new Date(\n              `${inputState.reservationDate}T${inputState.reservationTime}`,\n            ).getTime() +\n            3600000 * 9\n          : undefined\n\n      const mainImageSha256 = await sha256(formResult.output.thumbnailBase64)\n\n      const mainImageSize = await getSizeFromBase64(\n        formResult.output.thumbnailBase64,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 70 })\n\n      const textFile = await uploadTextFile(\n        inputState.md,\n        \"md\",\n        viewerData?.viewer?.token,\n      )\n\n      if (textFile === null) {\n        toast(\n          t(\"æœ¬æ–‡ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to upload the text\"),\n        )\n        return\n      }\n\n      const uploadResults = await uploadImages()\n\n      const imageUrls = uploadResults.filter((url) => url !== null)\n\n      if (imageUrls.length === 0) {\n        toast(t(\"ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to upload images\"))\n        return\n      }\n\n      const work = await createWork({\n        variables: {\n          input: {\n            title: formResult.output.title,\n            entitle: formResult.output.enTitle,\n            explanation: formResult.output.caption,\n            enExplanation: formResult.output.enCaption,\n            rating: inputState.ratingRestriction,\n            prompt: state.pngInfo?.params.prompt ?? null,\n            negativePrompt: state.pngInfo?.params.negativePrompt ?? null,\n            seed: state.pngInfo?.params.seed?.toString() ?? null,\n            sampler: state.pngInfo?.params.sampler?.toString() ?? null,\n            strength: state.pngInfo?.params.strength?.toString() ?? null,\n            noise: state.pngInfo?.params.noise?.toString() ?? null,\n            modelName: state.pngInfo?.params.model ?? null,\n            modelHash: state.pngInfo?.params.modelHash?.toString() ?? null,\n            otherGenerationParams: state.pngInfo?.src ?? null,\n            pngInfo: state.pngInfo?.src ?? null,\n            imageStyle: inputState.imageStyle,\n            relatedUrl: inputState.link,\n            tags: inputState.tags.map((tag) => tag.text),\n            isTagEditable: inputState.useTagFeature,\n            isCommentEditable: inputState.useCommentFeature,\n            thumbnailPosition: state.isThumbnailLandscape\n              ? state.thumbnailPosX\n              : state.thumbnailPosY,\n            modelId: inputState.aiModelId,\n            type: inputState.type ?? \"COLUMN\",\n            subjectId: inputState.themeId,\n            albumId: inputState.albumId,\n            isPromotion: inputState.usePromotionFeature,\n            reservedAt: reservedAt,\n            mainImageSha256: mainImageSha256,\n            accessType: inputState.accessType,\n            imageUrls: imageUrls,\n            smallThumbnailImageURL: smallThumbnailUrl,\n            smallThumbnailImageWidth: smallThumbnail.width,\n            smallThumbnailImageHeight: smallThumbnail.height,\n            largeThumbnailImageURL: largeThumbnailUrl,\n            largeThumbnailImageWidth: largeThumbnail.width,\n            largeThumbnailImageHeight: largeThumbnail.height,\n            videoUrl: null,\n            ogpImageUrl: ogpBase64Url,\n            imageHeight: mainImageSize.height,\n            imageWidth: mainImageSize.width,\n            accessGenerationType:\n              state.isSelectedGenerationImage && inputState.useGenerationParams\n                ? \"PUBLIC_RESTORABLE\"\n                : inputState.useGenerationParams\n                  ? \"PUBLIC\"\n                  : \"PRIVATE\",\n            mdUrl: textFile,\n          },\n        },\n      })\n\n      if (work.data?.createWork === undefined) {\n        toast(t(\"ä½œå“ã®æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to post the work\"))\n        return\n      }\n\n      dispatch({\n        type: \"MARK_AS_DONE\",\n        payload: {\n          uploadedWorkId: work.data?.createWork.id,\n          uploadedWorkUuid: work.data?.createWork.uuid,\n        },\n      })\n\n      toast(t(\"ä½œå“ã‚’æŠ•ç¨¿ã—ã¾ã—ãŸ\", \"Work has been posted\"))\n    } catch (error) {\n      if (error instanceof Error) {\n        toast(error.message)\n      }\n      const promises = uploadedImageUrls.map((url) => {\n        return deleteUploadedImage(url)\n      })\n      await Promise.all(promises)\n      dispatch({ type: \"SET_PROGRESS\", payload: 0 })\n    }\n  }\n\n  const createdAt = new Date(\n    `${inputState.reservationDate}T${inputState.reservationTime}`,\n  )\n\n  // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n  useBeforeUnload(\n    // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n    React.useCallback(\n      (event) => {\n        if (state) {\n          const confirmationMessage = t(\n            \"ãƒšãƒ¼ã‚¸é·ç§»ã™ã‚‹ã¨å¤‰æ›´ãŒæ¶ˆãˆã¾ã™ãŒå•é¡Œç„¡ã„ã§ã™ã‹ï¼Ÿ\",\n            \"Are you sure to leave this page? Changes may be lost.\",\n          )\n          event.returnValue = confirmationMessage\n          return confirmationMessage\n        }\n      },\n      [state, t],\n    ),\n  )\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <div className=\"m-auto w-full max-w-[1200px] space-y-4 pb-4\">\n      <div className=\"space-y-4\">\n        <div>\n          <PostFormHeader type=\"text\" />\n          <PostTextFormUploader state={state} dispatch={dispatch} />\n        </div>\n        <PostTextFormInput\n          imageInformation={state.pngInfo}\n          state={inputState}\n          dispatch={dispatchInput}\n          albums={viewerData?.albums ?? []}\n          currentPass={viewerData?.viewer?.currentPass ?? null}\n          recentlyUsedTags={viewerData?.viewer?.recentlyUsedTags ?? []}\n          themes={\n            viewer?.dailyThemes\n              ? viewer.dailyThemes.map((theme) => ({\n                  date: theme.dateText,\n                  title: theme.title,\n                  id: theme.id,\n                }))\n              : null\n          }\n          aiModels={viewerData?.aiModels ?? []}\n          events={viewer?.appEvents ?? []}\n          needFix={false}\n        />\n        <div className=\"h-4\" />\n        <Button\n          className=\"fixed bottom-0 left-0 z-60 ml-0 w-full rounded-none p-0 md:ml-[72px] md:pr-[72px] lg:ml-[224px] lg:pr-[224px] xl:left-auto xl:m-0 xl:max-w-[1200px] xl:pl-[8%]\"\n          size={\"lg\"}\n          type=\"submit\"\n          onClick={onPost}\n        >\n          {t(\"æŠ•ç¨¿\", \"Post\")}\n        </Button>\n      </div>\n      <SuccessCreatedWorkDialog\n        isOpen={state.progress === 100}\n        title={inputState.title}\n        description={inputState.caption}\n        imageBase64={state.thumbnailBase64}\n        workId={state.uploadedWorkId}\n        uuid={state.uploadedWorkUuid}\n        shareTags={[\"Aipictors\", \"AIã‚¤ãƒ©ã‚¹ãƒˆ\", \"AIart\"]}\n        createdAt={createdAt.getTime()}\n        accessType={inputState.accessType}\n      />\n      <CreatingWorkDialog\n        progress={state.progress}\n        isOpen={state.progress !== 0 && state.progress !== 100}\n      />\n    </div>\n  )\n}\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.NEW_TEXT, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const now = getJstDate(new Date())\n\n  const afterDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const result = await loaderClient.query({\n    query: viewerQuery,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: \"-1\",\n      generationLimit: 64,\n      generationOffset: 0,\n      generationWhere: {\n        nanoids: [],\n      },\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: now.toISOString().split(\"T\")[0],\n      endDate: afterDate.toISOString().split(\"T\")[0],\n    },\n  })\n\n  return {\n    ...result.data,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  // æŠ•ç¨¿ç”»é¢ãªã®ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nconst viewerQuery = graphql(\n  `query ViewerQuery(\n    $limit: Int!,\n    $offset: Int!,\n    $ownerUserId: ID\n    $generationOffset: Int!,\n    $generationLimit: Int!,\n    $generationWhere: ImageGenerationResultsWhereInput,\n    $startDate: String!,\n    $endDate: String!,\n    $startAt: String!,\n  ) {\n    viewer {\n      id\n      token\n      currentPass {\n        ...PostTextFormPass\n      }\n      recentlyUsedTags {\n        ...PostTextFormRecentlyUsedTags\n      }\n      imageGenerationResults(offset: $generationOffset, limit: $generationLimit, where: $generationWhere) {\n        id\n        prompt\n        negativePrompt\n        seed\n        steps\n        scale\n        sampler\n        clipSkip\n        sizeType\n        t2tImageUrl\n        t2tMaskImageUrl\n        t2tDenoisingStrengthSize\n        t2tInpaintingFillSize\n        rating\n        completedAt\n        isProtected\n        generationType\n        postModelId\n        modelHash\n        model {\n          id\n          name\n          type\n        }\n        vae\n        nanoid\n        status\n        estimatedSeconds\n        controlNetControlMode\n        controlNetEnabled\n        controlNetGuidanceEnd\n        controlNetGuidanceStart\n        controlNetPixelPerfect\n        controlNetProcessorRes\n        controlNetResizeMode\n        controlNetThresholdA\n        controlNetThresholdB\n        controlNetWeight\n        controlNetModule\n        controlNetModel\n        controlNetSaveDetectedMap\n        controlNetHrOption\n        upscaleSize\n        imageUrl\n        thumbnailUrl\n      }\n    }\n    albums(\n      offset: $offset,\n      limit: $limit,\n      where: {\n        ownerUserId: $ownerUserId,\n        needInspected: false,\n        needsThumbnailImage: false,\n      }\n    ) {\n      ...PostTextFormAlbum\n    }\n    aiModels(offset: 0, limit: 124, where: {}) {\n      id\n      ...PostTextFormAiModel\n    }\n    dailyThemes(\n      limit: 8,\n      offset: 0,\n      where: {\n        startDate: $startDate,\n        endDate: $endDate,\n      }) {\n      id\n      title\n      dateText\n    }\n    appEvents(\n      limit: 8,\n      offset: 0,\n      where: {\n        endAt: $startAt,\n      }\n    ) {\n      id\n      description\n      title\n      tag\n      slug\n      endAt\n    }\n  }`,\n  [\n    PostTextFormAiModelFragment,\n    PostTextFormAlbumFragment,\n    PostTextFormPassFragment,\n    PostTextFormRecentlyUsedTagsFragment,\n  ],\n)\n\nconst CreateWorkMutation = graphql(\n  `mutation CreateWork($input: CreateWorkInput!) {\n    createWork(input: $input) {\n      id\n      title\n      accessType\n      nanoid\n      uuid\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.text/route.tsx"},"span":[14043,14056],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { deleteUploadedImage } from \"~/utils/delete-uploaded-image\"\nimport { getSizeFromBase64 } from \"~/utils/get-size-from-base64\"\nimport { resizeImage } from \"~/utils/resize-image\"\nimport { sha256 } from \"~/utils/sha256\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { CreatingWorkDialog } from \"~/routes/($lang)._main.new.image/components/creating-work-dialog\"\nimport {\n  PostTextFormAiModelFragment,\n  PostTextFormAlbumFragment,\n  PostTextFormInput,\n  PostTextFormPassFragment,\n  PostTextFormRecentlyUsedTagsFragment,\n} from \"~/routes/($lang)._main.new.image/components/post-text-form-input\"\nimport { PostTextFormUploader } from \"~/routes/($lang)._main.new.image/components/post-text-form-uploader\"\nimport { SuccessCreatedWorkDialog } from \"~/routes/($lang)._main.new.image/components/success-created-work-dialog\"\nimport { vPostTextForm } from \"~/routes/($lang)._main.new.image/validations/post-text-form\"\nimport { postTextFormInputReducer } from \"~/routes/($lang)._main.new.text/reducers/post-text-form-input-reducer\"\nimport { postTextFormReducer } from \"~/routes/($lang)._main.new.text/reducers/post-text-form-reducer\"\nimport { createBase64FromImageURL } from \"~/routes/($lang).generation._index/utils/create-base64-from-image-url\"\nimport { useQuery, useMutation } from \"@apollo/client/index\"\nimport {\n  type MetaFunction,\n  useBeforeUnload,\n  useLoaderData,\n  useSearchParams,\n} from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport React, { useEffect } from \"react\"\nimport { useContext, useReducer } from \"react\"\nimport { toast } from \"sonner\"\nimport { safeParse } from \"valibot\"\nimport { PostFormHeader } from \"~/routes/($lang)._main.new.image/components/post-form-header\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { getJstDate } from \"~/utils/jst-date\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport type { LoaderFunctionArgs } from \"react-router-dom\"\nimport { uploadTextFile } from \"~/utils/upload-text-file\"\nimport type { HeadersFunction } from \"@remix-run/cloudflare\"\nimport { loaderClient } from \"~/lib/loader-client\"\n\nexport default function NewText () {\n  const data = useLoaderData<typeof loader>()\n\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const [searchParams] = useSearchParams()\n\n  const ref = searchParams.get(\"generation\")\n\n  const now = getJstDate(new Date())\n\n  const afterDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const { data: viewerData } = useQuery(viewerQuery, {\n    skip: authContext.isNotLoggedIn,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: authContext.userId,\n      generationLimit: 64,\n      generationOffset: 0,\n      generationWhere: {\n        nanoids: ref?.split(\"|\") ?? [],\n      },\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: now.toISOString().split(\"T\")[0],\n      endDate: afterDate.toISOString().split(\"T\")[0],\n    },\n  })\n\n  const viewer = data\n\n  const [state, dispatch] = useReducer(postTextFormReducer, {\n    editTargetImageBase64: null,\n    indexList: [],\n    isDrawing: false,\n    isHovered: false,\n    isOpenImageGenerationDialog: false,\n    isSelectedGenerationImage: false,\n    isThumbnailLandscape: false,\n    items: [],\n    ogpBase64: null,\n    pngInfo: null,\n    progress: 0,\n    selectedImageGenerationIds: [],\n    thumbnailBase64: null,\n    thumbnailPosX: 0,\n    thumbnailPosY: 0,\n    uploadedWorkId: null,\n    uploadedWorkUuid: null,\n    videoFile: null,\n    isOpenLoadingAi: false,\n  })\n\n  const [inputState, dispatchInput] = useReducer(postTextFormInputReducer, {\n    accessType: \"PUBLIC\",\n    generationParamAccessType: \"PUBLIC\",\n    aiModelId: \"1\",\n    albumId: null,\n    caption: \"\",\n    date: new Date(),\n    enCaption: \"\",\n    enTitle: \"\",\n    imageInformation: null,\n    imageStyle: \"ILLUSTRATION\",\n    link: \"\",\n    ratingRestriction: \"G\",\n    reservationDate: null,\n    reservationTime: null,\n    tags: [],\n    themeId: null,\n    title: \"\",\n    useCommentFeature: true,\n    useGenerationParams: true,\n    usePromotionFeature: false,\n    useTagFeature: true,\n    md: \"\",\n    type: \"COLUMN\",\n    correctionMessage: \"\",\n  })\n\n  useEffect(() => {\n    const processImages = async () => {\n      if (viewer?.viewer?.imageGenerationResults) {\n        const base64Urls = await Promise.all(\n          viewer.viewer.imageGenerationResults\n            .map((result) =>\n              result.imageUrl ? createBase64FromImageURL(result.imageUrl) : \"\",\n            )\n            .filter((url) => url !== \"\"),\n        )\n\n        dispatch({\n          type: \"SET_ITEMS\",\n          payload: viewer.viewer.imageGenerationResults.map(\n            (_result, index) => ({\n              id: index + 1,\n              content: base64Urls[index],\n            }),\n          ),\n        })\n\n        dispatch({\n          type: \"SET_THUMBNAIL_BASE64\",\n          payload: base64Urls[0],\n        })\n\n        if (viewer.viewer.imageGenerationResults.length > 0) {\n          dispatch({\n            type: \"SET_PNG_INFO\",\n            payload: {\n              src: null,\n              params: {\n                prompt: viewer.viewer.imageGenerationResults[0].prompt,\n                negativePrompt:\n                  viewer.viewer.imageGenerationResults[0].negativePrompt,\n                seed: viewer.viewer.imageGenerationResults[0].seed.toString(),\n                sampler: viewer.viewer.imageGenerationResults[0].sampler,\n                strength: \"\",\n                noise: \"\",\n                model: viewer.viewer.imageGenerationResults[0].model?.name,\n                modelHash: viewer.viewer.imageGenerationResults[0].model?.id,\n                steps: viewer.viewer.imageGenerationResults[0].steps.toString(),\n                scale: viewer.viewer.imageGenerationResults[0].scale.toString(),\n                vae: \"\",\n              },\n            },\n          })\n        }\n\n        dispatch({\n          type: \"IS_SELECTED_GENERATION_IMAGE\",\n          payload: true,\n        })\n      }\n    }\n\n    processImages()\n  }, [viewer?.viewer?.imageGenerationResults, dispatch])\n\n  const [createWork, { loading: isCreatedLoading }] =\n    useMutation(CreateWorkMutation)\n\n  const formResult = safeParse(vPostTextForm, {\n    title: inputState.title,\n    caption: inputState.caption,\n    enTitle: inputState.enTitle,\n    enCaption: inputState.enCaption,\n    imagesCount: state.items.length,\n    thumbnailBase64: state.thumbnailBase64,\n    md: inputState.md,\n  })\n\n  const uploadImages = async () => {\n    if (authContext.userId === null) {\n      return []\n    }\n    const images = state.items.map((item) => item.content)\n    const uploads = images.map((image) => {\n      if (image === null) {\n        return null\n      }\n      return uploadPublicImage(image, viewerData?.viewer?.token)\n    })\n    const imageUrls = await Promise.all(uploads)\n    return imageUrls\n  }\n\n  const onPost = async () => {\n    const url = uploadTextFile(\n      inputState.md,\n      \"md\",\n      viewerData?.viewer?.token,\n      \"https://text-files.aipictors.com/c09d45d7-c949-4515-b477-d1c17f1dd038\",\n    )\n\n    if (url === null) {\n      toast(t(\"æœ¬æ–‡ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to upload the text\"))\n      return\n    }\n\n    if (formResult.success === false) {\n      for (const issue of formResult.issues) {\n        toast(issue.message)\n        return\n      }\n      return\n    }\n\n    if (\n      inputState.reservationDate !== null &&\n      inputState.reservationTime === null\n    ) {\n      toast(\n        t(\n          \"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter the scheduled post time\",\n        ),\n      )\n      return\n    }\n\n    if (\n      inputState.reservationDate === null &&\n      inputState.reservationTime !== null\n    ) {\n      toast(\n        t(\n          \"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter the scheduled post time\",\n        ),\n      )\n      return\n    }\n\n    const uploadedImageUrls = []\n\n    try {\n      dispatch({ type: \"SET_PROGRESS\", payload: 10 })\n\n      const smallThumbnail = state.isThumbnailLandscape\n        ? await resizeImage(formResult.output.thumbnailBase64, 400, 0, \"webp\")\n        : await resizeImage(formResult.output.thumbnailBase64, 0, 400, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 20 })\n\n      const largeThumbnail = state.isThumbnailLandscape\n        ? await resizeImage(formResult.output.thumbnailBase64, 600, 0, \"webp\")\n        : await resizeImage(formResult.output.thumbnailBase64, 0, 600, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 30 })\n\n      const smallThumbnailUrl = await uploadPublicImage(\n        smallThumbnail.base64,\n        viewerData?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 40 })\n\n      uploadedImageUrls.push(smallThumbnailUrl)\n\n      const largeThumbnailUrl = await uploadPublicImage(\n        largeThumbnail.base64,\n        viewerData?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 50 })\n\n      uploadedImageUrls.push(largeThumbnailUrl)\n\n      const ogpBase64Url = state.ogpBase64\n        ? await uploadPublicImage(state.ogpBase64, viewerData?.viewer?.token)\n        : null\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 60 })\n\n      if (ogpBase64Url !== null) {\n        uploadedImageUrls.push(ogpBase64Url)\n      }\n\n      const reservedAt =\n        inputState.reservationDate !== null &&\n        inputState.reservationTime !== null\n          ? new Date(\n              `${inputState.reservationDate}T${inputState.reservationTime}`,\n            ).getTime() +\n            3600000 * 9\n          : undefined\n\n      const mainImageSha256 = await sha256(formResult.output.thumbnailBase64)\n\n      const mainImageSize = await getSizeFromBase64(\n        formResult.output.thumbnailBase64,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 70 })\n\n      const textFile = await uploadTextFile(\n        inputState.md,\n        \"md\",\n        viewerData?.viewer?.token,\n      )\n\n      if (textFile === null) {\n        toast(\n          t(\"æœ¬æ–‡ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to upload the text\"),\n        )\n        return\n      }\n\n      const uploadResults = await uploadImages()\n\n      const imageUrls = uploadResults.filter((url) => url !== null)\n\n      if (imageUrls.length === 0) {\n        toast(t(\"ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to upload images\"))\n        return\n      }\n\n      const work = await createWork({\n        variables: {\n          input: {\n            title: formResult.output.title,\n            entitle: formResult.output.enTitle,\n            explanation: formResult.output.caption,\n            enExplanation: formResult.output.enCaption,\n            rating: inputState.ratingRestriction,\n            prompt: state.pngInfo?.params.prompt ?? null,\n            negativePrompt: state.pngInfo?.params.negativePrompt ?? null,\n            seed: state.pngInfo?.params.seed?.toString() ?? null,\n            sampler: state.pngInfo?.params.sampler?.toString() ?? null,\n            strength: state.pngInfo?.params.strength?.toString() ?? null,\n            noise: state.pngInfo?.params.noise?.toString() ?? null,\n            modelName: state.pngInfo?.params.model ?? null,\n            modelHash: state.pngInfo?.params.modelHash?.toString() ?? null,\n            otherGenerationParams: state.pngInfo?.src ?? null,\n            pngInfo: state.pngInfo?.src ?? null,\n            imageStyle: inputState.imageStyle,\n            relatedUrl: inputState.link,\n            tags: inputState.tags.map((tag) => tag.text),\n            isTagEditable: inputState.useTagFeature,\n            isCommentEditable: inputState.useCommentFeature,\n            thumbnailPosition: state.isThumbnailLandscape\n              ? state.thumbnailPosX\n              : state.thumbnailPosY,\n            modelId: inputState.aiModelId,\n            type: inputState.type ?? \"COLUMN\",\n            subjectId: inputState.themeId,\n            albumId: inputState.albumId,\n            isPromotion: inputState.usePromotionFeature,\n            reservedAt: reservedAt,\n            mainImageSha256: mainImageSha256,\n            accessType: inputState.accessType,\n            imageUrls: imageUrls,\n            smallThumbnailImageURL: smallThumbnailUrl,\n            smallThumbnailImageWidth: smallThumbnail.width,\n            smallThumbnailImageHeight: smallThumbnail.height,\n            largeThumbnailImageURL: largeThumbnailUrl,\n            largeThumbnailImageWidth: largeThumbnail.width,\n            largeThumbnailImageHeight: largeThumbnail.height,\n            videoUrl: null,\n            ogpImageUrl: ogpBase64Url,\n            imageHeight: mainImageSize.height,\n            imageWidth: mainImageSize.width,\n            accessGenerationType:\n              state.isSelectedGenerationImage && inputState.useGenerationParams\n                ? \"PUBLIC_RESTORABLE\"\n                : inputState.useGenerationParams\n                  ? \"PUBLIC\"\n                  : \"PRIVATE\",\n            mdUrl: textFile,\n          },\n        },\n      })\n\n      if (work.data?.createWork === undefined) {\n        toast(t(\"ä½œå“ã®æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to post the work\"))\n        return\n      }\n\n      dispatch({\n        type: \"MARK_AS_DONE\",\n        payload: {\n          uploadedWorkId: work.data?.createWork.id,\n          uploadedWorkUuid: work.data?.createWork.uuid,\n        },\n      })\n\n      toast(t(\"ä½œå“ã‚’æŠ•ç¨¿ã—ã¾ã—ãŸ\", \"Work has been posted\"))\n    } catch (error) {\n      if (error instanceof Error) {\n        toast(error.message)\n      }\n      const promises = uploadedImageUrls.map((url) => {\n        return deleteUploadedImage(url)\n      })\n      await Promise.all(promises)\n      dispatch({ type: \"SET_PROGRESS\", payload: 0 })\n    }\n  }\n\n  const createdAt = new Date(\n    `${inputState.reservationDate}T${inputState.reservationTime}`,\n  )\n\n  // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n  useBeforeUnload(\n    // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n    React.useCallback(\n      (event) => {\n        if (state) {\n          const confirmationMessage = t(\n            \"ãƒšãƒ¼ã‚¸é·ç§»ã™ã‚‹ã¨å¤‰æ›´ãŒæ¶ˆãˆã¾ã™ãŒå•é¡Œç„¡ã„ã§ã™ã‹ï¼Ÿ\",\n            \"Are you sure to leave this page? Changes may be lost.\",\n          )\n          event.returnValue = confirmationMessage\n          return confirmationMessage\n        }\n      },\n      [state, t],\n    ),\n  )\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <div className=\"m-auto w-full max-w-[1200px] space-y-4 pb-4\">\n      <div className=\"space-y-4\">\n        <div>\n          <PostFormHeader type=\"text\" />\n          <PostTextFormUploader state={state} dispatch={dispatch} />\n        </div>\n        <PostTextFormInput\n          imageInformation={state.pngInfo}\n          state={inputState}\n          dispatch={dispatchInput}\n          albums={viewerData?.albums ?? []}\n          currentPass={viewerData?.viewer?.currentPass ?? null}\n          recentlyUsedTags={viewerData?.viewer?.recentlyUsedTags ?? []}\n          themes={\n            viewer?.dailyThemes\n              ? viewer.dailyThemes.map((theme) => ({\n                  date: theme.dateText,\n                  title: theme.title,\n                  id: theme.id,\n                }))\n              : null\n          }\n          aiModels={viewerData?.aiModels ?? []}\n          events={viewer?.appEvents ?? []}\n          needFix={false}\n        />\n        <div className=\"h-4\" />\n        <Button\n          className=\"fixed bottom-0 left-0 z-60 ml-0 w-full rounded-none p-0 md:ml-[72px] md:pr-[72px] lg:ml-[224px] lg:pr-[224px] xl:left-auto xl:m-0 xl:max-w-[1200px] xl:pl-[8%]\"\n          size={\"lg\"}\n          type=\"submit\"\n          onClick={onPost}\n        >\n          {t(\"æŠ•ç¨¿\", \"Post\")}\n        </Button>\n      </div>\n      <SuccessCreatedWorkDialog\n        isOpen={state.progress === 100}\n        title={inputState.title}\n        description={inputState.caption}\n        imageBase64={state.thumbnailBase64}\n        workId={state.uploadedWorkId}\n        uuid={state.uploadedWorkUuid}\n        shareTags={[\"Aipictors\", \"AIã‚¤ãƒ©ã‚¹ãƒˆ\", \"AIart\"]}\n        createdAt={createdAt.getTime()}\n        accessType={inputState.accessType}\n      />\n      <CreatingWorkDialog\n        progress={state.progress}\n        isOpen={state.progress !== 0 && state.progress !== 100}\n      />\n    </div>\n  )\n}\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.NEW_TEXT, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const now = getJstDate(new Date())\n\n  const afterDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const result = await loaderClient.query({\n    query: viewerQuery,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: \"-1\",\n      generationLimit: 64,\n      generationOffset: 0,\n      generationWhere: {\n        nanoids: [],\n      },\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: now.toISOString().split(\"T\")[0],\n      endDate: afterDate.toISOString().split(\"T\")[0],\n    },\n  })\n\n  return {\n    ...result.data,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  // æŠ•ç¨¿ç”»é¢ãªã®ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nconst viewerQuery = graphql(\n  `query ViewerQuery(\n    $limit: Int!,\n    $offset: Int!,\n    $ownerUserId: ID\n    $generationOffset: Int!,\n    $generationLimit: Int!,\n    $generationWhere: ImageGenerationResultsWhereInput,\n    $startDate: String!,\n    $endDate: String!,\n    $startAt: String!,\n  ) {\n    viewer {\n      id\n      token\n      currentPass {\n        ...PostTextFormPass\n      }\n      recentlyUsedTags {\n        ...PostTextFormRecentlyUsedTags\n      }\n      imageGenerationResults(offset: $generationOffset, limit: $generationLimit, where: $generationWhere) {\n        id\n        prompt\n        negativePrompt\n        seed\n        steps\n        scale\n        sampler\n        clipSkip\n        sizeType\n        t2tImageUrl\n        t2tMaskImageUrl\n        t2tDenoisingStrengthSize\n        t2tInpaintingFillSize\n        rating\n        completedAt\n        isProtected\n        generationType\n        postModelId\n        modelHash\n        model {\n          id\n          name\n          type\n        }\n        vae\n        nanoid\n        status\n        estimatedSeconds\n        controlNetControlMode\n        controlNetEnabled\n        controlNetGuidanceEnd\n        controlNetGuidanceStart\n        controlNetPixelPerfect\n        controlNetProcessorRes\n        controlNetResizeMode\n        controlNetThresholdA\n        controlNetThresholdB\n        controlNetWeight\n        controlNetModule\n        controlNetModel\n        controlNetSaveDetectedMap\n        controlNetHrOption\n        upscaleSize\n        imageUrl\n        thumbnailUrl\n      }\n    }\n    albums(\n      offset: $offset,\n      limit: $limit,\n      where: {\n        ownerUserId: $ownerUserId,\n        needInspected: false,\n        needsThumbnailImage: false,\n      }\n    ) {\n      ...PostTextFormAlbum\n    }\n    aiModels(offset: 0, limit: 124, where: {}) {\n      id\n      ...PostTextFormAiModel\n    }\n    dailyThemes(\n      limit: 8,\n      offset: 0,\n      where: {\n        startDate: $startDate,\n        endDate: $endDate,\n      }) {\n      id\n      title\n      dateText\n    }\n    appEvents(\n      limit: 8,\n      offset: 0,\n      where: {\n        endAt: $startAt,\n      }\n    ) {\n      id\n      description\n      title\n      tag\n      slug\n      endAt\n    }\n  }`,\n  [\n    PostTextFormAiModelFragment,\n    PostTextFormAlbumFragment,\n    PostTextFormPassFragment,\n    PostTextFormRecentlyUsedTagsFragment,\n  ],\n)\n\nconst CreateWorkMutation = graphql(\n  `mutation CreateWork($input: CreateWorkInput!) {\n    createWork(input: $input) {\n      id\n      title\n      accessType\n      nanoid\n      uuid\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.text/route.tsx"},"span":[14132,14145],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { deleteUploadedImage } from \"~/utils/delete-uploaded-image\"\nimport { getSizeFromBase64 } from \"~/utils/get-size-from-base64\"\nimport { resizeImage } from \"~/utils/resize-image\"\nimport { sha256 } from \"~/utils/sha256\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { CreatingWorkDialog } from \"~/routes/($lang)._main.new.image/components/creating-work-dialog\"\nimport {\n  PostTextFormAiModelFragment,\n  PostTextFormAlbumFragment,\n  PostTextFormInput,\n  PostTextFormPassFragment,\n  PostTextFormRecentlyUsedTagsFragment,\n} from \"~/routes/($lang)._main.new.image/components/post-text-form-input\"\nimport { PostTextFormUploader } from \"~/routes/($lang)._main.new.image/components/post-text-form-uploader\"\nimport { SuccessCreatedWorkDialog } from \"~/routes/($lang)._main.new.image/components/success-created-work-dialog\"\nimport { vPostTextForm } from \"~/routes/($lang)._main.new.image/validations/post-text-form\"\nimport { postTextFormInputReducer } from \"~/routes/($lang)._main.new.text/reducers/post-text-form-input-reducer\"\nimport { postTextFormReducer } from \"~/routes/($lang)._main.new.text/reducers/post-text-form-reducer\"\nimport { createBase64FromImageURL } from \"~/routes/($lang).generation._index/utils/create-base64-from-image-url\"\nimport { useQuery, useMutation } from \"@apollo/client/index\"\nimport {\n  type MetaFunction,\n  useBeforeUnload,\n  useLoaderData,\n  useSearchParams,\n} from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport React, { useEffect } from \"react\"\nimport { useContext, useReducer } from \"react\"\nimport { toast } from \"sonner\"\nimport { safeParse } from \"valibot\"\nimport { PostFormHeader } from \"~/routes/($lang)._main.new.image/components/post-form-header\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { getJstDate } from \"~/utils/jst-date\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport type { LoaderFunctionArgs } from \"react-router-dom\"\nimport { uploadTextFile } from \"~/utils/upload-text-file\"\nimport type { HeadersFunction } from \"@remix-run/cloudflare\"\nimport { loaderClient } from \"~/lib/loader-client\"\n\nexport default function NewText () {\n  const data = useLoaderData<typeof loader>()\n\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const [searchParams] = useSearchParams()\n\n  const ref = searchParams.get(\"generation\")\n\n  const now = getJstDate(new Date())\n\n  const afterDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const { data: viewerData } = useQuery(viewerQuery, {\n    skip: authContext.isNotLoggedIn,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: authContext.userId,\n      generationLimit: 64,\n      generationOffset: 0,\n      generationWhere: {\n        nanoids: ref?.split(\"|\") ?? [],\n      },\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: now.toISOString().split(\"T\")[0],\n      endDate: afterDate.toISOString().split(\"T\")[0],\n    },\n  })\n\n  const viewer = data\n\n  const [state, dispatch] = useReducer(postTextFormReducer, {\n    editTargetImageBase64: null,\n    indexList: [],\n    isDrawing: false,\n    isHovered: false,\n    isOpenImageGenerationDialog: false,\n    isSelectedGenerationImage: false,\n    isThumbnailLandscape: false,\n    items: [],\n    ogpBase64: null,\n    pngInfo: null,\n    progress: 0,\n    selectedImageGenerationIds: [],\n    thumbnailBase64: null,\n    thumbnailPosX: 0,\n    thumbnailPosY: 0,\n    uploadedWorkId: null,\n    uploadedWorkUuid: null,\n    videoFile: null,\n    isOpenLoadingAi: false,\n  })\n\n  const [inputState, dispatchInput] = useReducer(postTextFormInputReducer, {\n    accessType: \"PUBLIC\",\n    generationParamAccessType: \"PUBLIC\",\n    aiModelId: \"1\",\n    albumId: null,\n    caption: \"\",\n    date: new Date(),\n    enCaption: \"\",\n    enTitle: \"\",\n    imageInformation: null,\n    imageStyle: \"ILLUSTRATION\",\n    link: \"\",\n    ratingRestriction: \"G\",\n    reservationDate: null,\n    reservationTime: null,\n    tags: [],\n    themeId: null,\n    title: \"\",\n    useCommentFeature: true,\n    useGenerationParams: true,\n    usePromotionFeature: false,\n    useTagFeature: true,\n    md: \"\",\n    type: \"COLUMN\",\n    correctionMessage: \"\",\n  })\n\n  useEffect(() => {\n    const processImages = async () => {\n      if (viewer?.viewer?.imageGenerationResults) {\n        const base64Urls = await Promise.all(\n          viewer.viewer.imageGenerationResults\n            .map((result) =>\n              result.imageUrl ? createBase64FromImageURL(result.imageUrl) : \"\",\n            )\n            .filter((url) => url !== \"\"),\n        )\n\n        dispatch({\n          type: \"SET_ITEMS\",\n          payload: viewer.viewer.imageGenerationResults.map(\n            (_result, index) => ({\n              id: index + 1,\n              content: base64Urls[index],\n            }),\n          ),\n        })\n\n        dispatch({\n          type: \"SET_THUMBNAIL_BASE64\",\n          payload: base64Urls[0],\n        })\n\n        if (viewer.viewer.imageGenerationResults.length > 0) {\n          dispatch({\n            type: \"SET_PNG_INFO\",\n            payload: {\n              src: null,\n              params: {\n                prompt: viewer.viewer.imageGenerationResults[0].prompt,\n                negativePrompt:\n                  viewer.viewer.imageGenerationResults[0].negativePrompt,\n                seed: viewer.viewer.imageGenerationResults[0].seed.toString(),\n                sampler: viewer.viewer.imageGenerationResults[0].sampler,\n                strength: \"\",\n                noise: \"\",\n                model: viewer.viewer.imageGenerationResults[0].model?.name,\n                modelHash: viewer.viewer.imageGenerationResults[0].model?.id,\n                steps: viewer.viewer.imageGenerationResults[0].steps.toString(),\n                scale: viewer.viewer.imageGenerationResults[0].scale.toString(),\n                vae: \"\",\n              },\n            },\n          })\n        }\n\n        dispatch({\n          type: \"IS_SELECTED_GENERATION_IMAGE\",\n          payload: true,\n        })\n      }\n    }\n\n    processImages()\n  }, [viewer?.viewer?.imageGenerationResults, dispatch])\n\n  const [createWork, { loading: isCreatedLoading }] =\n    useMutation(CreateWorkMutation)\n\n  const formResult = safeParse(vPostTextForm, {\n    title: inputState.title,\n    caption: inputState.caption,\n    enTitle: inputState.enTitle,\n    enCaption: inputState.enCaption,\n    imagesCount: state.items.length,\n    thumbnailBase64: state.thumbnailBase64,\n    md: inputState.md,\n  })\n\n  const uploadImages = async () => {\n    if (authContext.userId === null) {\n      return []\n    }\n    const images = state.items.map((item) => item.content)\n    const uploads = images.map((image) => {\n      if (image === null) {\n        return null\n      }\n      return uploadPublicImage(image, viewerData?.viewer?.token)\n    })\n    const imageUrls = await Promise.all(uploads)\n    return imageUrls\n  }\n\n  const onPost = async () => {\n    const url = uploadTextFile(\n      inputState.md,\n      \"md\",\n      viewerData?.viewer?.token,\n      \"https://text-files.aipictors.com/c09d45d7-c949-4515-b477-d1c17f1dd038\",\n    )\n\n    if (url === null) {\n      toast(t(\"æœ¬æ–‡ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to upload the text\"))\n      return\n    }\n\n    if (formResult.success === false) {\n      for (const issue of formResult.issues) {\n        toast(issue.message)\n        return\n      }\n      return\n    }\n\n    if (\n      inputState.reservationDate !== null &&\n      inputState.reservationTime === null\n    ) {\n      toast(\n        t(\n          \"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter the scheduled post time\",\n        ),\n      )\n      return\n    }\n\n    if (\n      inputState.reservationDate === null &&\n      inputState.reservationTime !== null\n    ) {\n      toast(\n        t(\n          \"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter the scheduled post time\",\n        ),\n      )\n      return\n    }\n\n    const uploadedImageUrls = []\n\n    try {\n      dispatch({ type: \"SET_PROGRESS\", payload: 10 })\n\n      const smallThumbnail = state.isThumbnailLandscape\n        ? await resizeImage(formResult.output.thumbnailBase64, 400, 0, \"webp\")\n        : await resizeImage(formResult.output.thumbnailBase64, 0, 400, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 20 })\n\n      const largeThumbnail = state.isThumbnailLandscape\n        ? await resizeImage(formResult.output.thumbnailBase64, 600, 0, \"webp\")\n        : await resizeImage(formResult.output.thumbnailBase64, 0, 600, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 30 })\n\n      const smallThumbnailUrl = await uploadPublicImage(\n        smallThumbnail.base64,\n        viewerData?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 40 })\n\n      uploadedImageUrls.push(smallThumbnailUrl)\n\n      const largeThumbnailUrl = await uploadPublicImage(\n        largeThumbnail.base64,\n        viewerData?.viewer?.token,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 50 })\n\n      uploadedImageUrls.push(largeThumbnailUrl)\n\n      const ogpBase64Url = state.ogpBase64\n        ? await uploadPublicImage(state.ogpBase64, viewerData?.viewer?.token)\n        : null\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 60 })\n\n      if (ogpBase64Url !== null) {\n        uploadedImageUrls.push(ogpBase64Url)\n      }\n\n      const reservedAt =\n        inputState.reservationDate !== null &&\n        inputState.reservationTime !== null\n          ? new Date(\n              `${inputState.reservationDate}T${inputState.reservationTime}`,\n            ).getTime() +\n            3600000 * 9\n          : undefined\n\n      const mainImageSha256 = await sha256(formResult.output.thumbnailBase64)\n\n      const mainImageSize = await getSizeFromBase64(\n        formResult.output.thumbnailBase64,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 70 })\n\n      const textFile = await uploadTextFile(\n        inputState.md,\n        \"md\",\n        viewerData?.viewer?.token,\n      )\n\n      if (textFile === null) {\n        toast(\n          t(\"æœ¬æ–‡ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to upload the text\"),\n        )\n        return\n      }\n\n      const uploadResults = await uploadImages()\n\n      const imageUrls = uploadResults.filter((url) => url !== null)\n\n      if (imageUrls.length === 0) {\n        toast(t(\"ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to upload images\"))\n        return\n      }\n\n      const work = await createWork({\n        variables: {\n          input: {\n            title: formResult.output.title,\n            entitle: formResult.output.enTitle,\n            explanation: formResult.output.caption,\n            enExplanation: formResult.output.enCaption,\n            rating: inputState.ratingRestriction,\n            prompt: state.pngInfo?.params.prompt ?? null,\n            negativePrompt: state.pngInfo?.params.negativePrompt ?? null,\n            seed: state.pngInfo?.params.seed?.toString() ?? null,\n            sampler: state.pngInfo?.params.sampler?.toString() ?? null,\n            strength: state.pngInfo?.params.strength?.toString() ?? null,\n            noise: state.pngInfo?.params.noise?.toString() ?? null,\n            modelName: state.pngInfo?.params.model ?? null,\n            modelHash: state.pngInfo?.params.modelHash?.toString() ?? null,\n            otherGenerationParams: state.pngInfo?.src ?? null,\n            pngInfo: state.pngInfo?.src ?? null,\n            imageStyle: inputState.imageStyle,\n            relatedUrl: inputState.link,\n            tags: inputState.tags.map((tag) => tag.text),\n            isTagEditable: inputState.useTagFeature,\n            isCommentEditable: inputState.useCommentFeature,\n            thumbnailPosition: state.isThumbnailLandscape\n              ? state.thumbnailPosX\n              : state.thumbnailPosY,\n            modelId: inputState.aiModelId,\n            type: inputState.type ?? \"COLUMN\",\n            subjectId: inputState.themeId,\n            albumId: inputState.albumId,\n            isPromotion: inputState.usePromotionFeature,\n            reservedAt: reservedAt,\n            mainImageSha256: mainImageSha256,\n            accessType: inputState.accessType,\n            imageUrls: imageUrls,\n            smallThumbnailImageURL: smallThumbnailUrl,\n            smallThumbnailImageWidth: smallThumbnail.width,\n            smallThumbnailImageHeight: smallThumbnail.height,\n            largeThumbnailImageURL: largeThumbnailUrl,\n            largeThumbnailImageWidth: largeThumbnail.width,\n            largeThumbnailImageHeight: largeThumbnail.height,\n            videoUrl: null,\n            ogpImageUrl: ogpBase64Url,\n            imageHeight: mainImageSize.height,\n            imageWidth: mainImageSize.width,\n            accessGenerationType:\n              state.isSelectedGenerationImage && inputState.useGenerationParams\n                ? \"PUBLIC_RESTORABLE\"\n                : inputState.useGenerationParams\n                  ? \"PUBLIC\"\n                  : \"PRIVATE\",\n            mdUrl: textFile,\n          },\n        },\n      })\n\n      if (work.data?.createWork === undefined) {\n        toast(t(\"ä½œå“ã®æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to post the work\"))\n        return\n      }\n\n      dispatch({\n        type: \"MARK_AS_DONE\",\n        payload: {\n          uploadedWorkId: work.data?.createWork.id,\n          uploadedWorkUuid: work.data?.createWork.uuid,\n        },\n      })\n\n      toast(t(\"ä½œå“ã‚’æŠ•ç¨¿ã—ã¾ã—ãŸ\", \"Work has been posted\"))\n    } catch (error) {\n      if (error instanceof Error) {\n        toast(error.message)\n      }\n      const promises = uploadedImageUrls.map((url) => {\n        return deleteUploadedImage(url)\n      })\n      await Promise.all(promises)\n      dispatch({ type: \"SET_PROGRESS\", payload: 0 })\n    }\n  }\n\n  const createdAt = new Date(\n    `${inputState.reservationDate}T${inputState.reservationTime}`,\n  )\n\n  // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n  useBeforeUnload(\n    // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n    React.useCallback(\n      (event) => {\n        if (state) {\n          const confirmationMessage = t(\n            \"ãƒšãƒ¼ã‚¸é·ç§»ã™ã‚‹ã¨å¤‰æ›´ãŒæ¶ˆãˆã¾ã™ãŒå•é¡Œç„¡ã„ã§ã™ã‹ï¼Ÿ\",\n            \"Are you sure to leave this page? Changes may be lost.\",\n          )\n          event.returnValue = confirmationMessage\n          return confirmationMessage\n        }\n      },\n      [state, t],\n    ),\n  )\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <div className=\"m-auto w-full max-w-[1200px] space-y-4 pb-4\">\n      <div className=\"space-y-4\">\n        <div>\n          <PostFormHeader type=\"text\" />\n          <PostTextFormUploader state={state} dispatch={dispatch} />\n        </div>\n        <PostTextFormInput\n          imageInformation={state.pngInfo}\n          state={inputState}\n          dispatch={dispatchInput}\n          albums={viewerData?.albums ?? []}\n          currentPass={viewerData?.viewer?.currentPass ?? null}\n          recentlyUsedTags={viewerData?.viewer?.recentlyUsedTags ?? []}\n          themes={\n            viewer?.dailyThemes\n              ? viewer.dailyThemes.map((theme) => ({\n                  date: theme.dateText,\n                  title: theme.title,\n                  id: theme.id,\n                }))\n              : null\n          }\n          aiModels={viewerData?.aiModels ?? []}\n          events={viewer?.appEvents ?? []}\n          needFix={false}\n        />\n        <div className=\"h-4\" />\n        <Button\n          className=\"fixed bottom-0 left-0 z-60 ml-0 w-full rounded-none p-0 md:ml-[72px] md:pr-[72px] lg:ml-[224px] lg:pr-[224px] xl:left-auto xl:m-0 xl:max-w-[1200px] xl:pl-[8%]\"\n          size={\"lg\"}\n          type=\"submit\"\n          onClick={onPost}\n        >\n          {t(\"æŠ•ç¨¿\", \"Post\")}\n        </Button>\n      </div>\n      <SuccessCreatedWorkDialog\n        isOpen={state.progress === 100}\n        title={inputState.title}\n        description={inputState.caption}\n        imageBase64={state.thumbnailBase64}\n        workId={state.uploadedWorkId}\n        uuid={state.uploadedWorkUuid}\n        shareTags={[\"Aipictors\", \"AIã‚¤ãƒ©ã‚¹ãƒˆ\", \"AIart\"]}\n        createdAt={createdAt.getTime()}\n        accessType={inputState.accessType}\n      />\n      <CreatingWorkDialog\n        progress={state.progress}\n        isOpen={state.progress !== 0 && state.progress !== 100}\n      />\n    </div>\n  )\n}\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.NEW_TEXT, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const now = getJstDate(new Date())\n\n  const afterDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n\n  const result = await loaderClient.query({\n    query: viewerQuery,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: \"-1\",\n      generationLimit: 64,\n      generationOffset: 0,\n      generationWhere: {\n        nanoids: [],\n      },\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: now.toISOString().split(\"T\")[0],\n      endDate: afterDate.toISOString().split(\"T\")[0],\n    },\n  })\n\n  return {\n    ...result.data,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  // æŠ•ç¨¿ç”»é¢ãªã®ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nconst viewerQuery = graphql(\n  `query ViewerQuery(\n    $limit: Int!,\n    $offset: Int!,\n    $ownerUserId: ID\n    $generationOffset: Int!,\n    $generationLimit: Int!,\n    $generationWhere: ImageGenerationResultsWhereInput,\n    $startDate: String!,\n    $endDate: String!,\n    $startAt: String!,\n  ) {\n    viewer {\n      id\n      token\n      currentPass {\n        ...PostTextFormPass\n      }\n      recentlyUsedTags {\n        ...PostTextFormRecentlyUsedTags\n      }\n      imageGenerationResults(offset: $generationOffset, limit: $generationLimit, where: $generationWhere) {\n        id\n        prompt\n        negativePrompt\n        seed\n        steps\n        scale\n        sampler\n        clipSkip\n        sizeType\n        t2tImageUrl\n        t2tMaskImageUrl\n        t2tDenoisingStrengthSize\n        t2tInpaintingFillSize\n        rating\n        completedAt\n        isProtected\n        generationType\n        postModelId\n        modelHash\n        model {\n          id\n          name\n          type\n        }\n        vae\n        nanoid\n        status\n        estimatedSeconds\n        controlNetControlMode\n        controlNetEnabled\n        controlNetGuidanceEnd\n        controlNetGuidanceStart\n        controlNetPixelPerfect\n        controlNetProcessorRes\n        controlNetResizeMode\n        controlNetThresholdA\n        controlNetThresholdB\n        controlNetWeight\n        controlNetModule\n        controlNetModel\n        controlNetSaveDetectedMap\n        controlNetHrOption\n        upscaleSize\n        imageUrl\n        thumbnailUrl\n      }\n    }\n    albums(\n      offset: $offset,\n      limit: $limit,\n      where: {\n        ownerUserId: $ownerUserId,\n        needInspected: false,\n        needsThumbnailImage: false,\n      }\n    ) {\n      ...PostTextFormAlbum\n    }\n    aiModels(offset: 0, limit: 124, where: {}) {\n      id\n      ...PostTextFormAiModel\n    }\n    dailyThemes(\n      limit: 8,\n      offset: 0,\n      where: {\n        startDate: $startDate,\n        endDate: $endDate,\n      }) {\n      id\n      title\n      dateText\n    }\n    appEvents(\n      limit: 8,\n      offset: 0,\n      where: {\n        endAt: $startAt,\n      }\n    ) {\n      id\n      description\n      title\n      tag\n      slug\n      endAt\n    }\n  }`,\n  [\n    PostTextFormAiModelFragment,\n    PostTextFormAlbumFragment,\n    PostTextFormPassFragment,\n    PostTextFormRecentlyUsedTagsFragment,\n  ],\n)\n\nconst CreateWorkMutation = graphql(\n  `mutation CreateWork($input: CreateWorkInput!) {\n    createWork(input: $input) {\n      id\n      title\n      accessType\n      nanoid\n      uuid\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable isLoadingDeleteAlbum is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"isLoadingDeleteAlbum"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.posts.$post._index/components/delete-work-confirm-dialog.tsx"},"span":[710,730],"sourceCode":"\"use client\"\n\nimport { useState } from \"react\"\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"~/components/ui/alert-dialog\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { Button } from \"~/components/ui/button\"\nimport { Loader2Icon, Trash } from \"lucide-react\"\nimport { toast } from \"sonner\"\nimport { graphql } from \"gql.tada\"\nimport { useMutation } from \"@apollo/client/index\"\n\ntype Props = {\n  postId: string\n}\n\nexport function DeleteWorkConfirmDialog (props: Props) {\n  const t = useTranslation()\n\n  const [deleteWork, { loading: isLoadingDeleteAlbum }] =\n    useMutation(DeleteWorkMutation)\n\n  const [isOpen, setIsOpen] = useState(false)\n\n  const [isLoading, _setIsLoading] = useState(false)\n\n  const [isDeleted, setIsDeleted] = useState(false)\n\n  const onDeleteWork = async (workId: string) => {\n    await deleteWork({\n      variables: {\n        input: {\n          workId: workId,\n        },\n      },\n    })\n    toast(\n      t(\n        \"ä½œå“ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€ã—ã°ã‚‰ãã—ãŸã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ããªããªã‚Šã¾ã™\",\n        \"The post has been deleted\",\n      ),\n    )\n    setIsDeleted(true)\n  }\n\n  return (\n    <AlertDialog open={isOpen} onOpenChange={setIsOpen}>\n      <AlertDialogTrigger asChild>\n        <Button\n          className=\"flex items-center gap-2\"\n          variant=\"destructive\"\n          disabled={isDeleted}\n          onClick={() => setIsOpen(true)}\n        >\n          {isLoading ? <Loader2Icon className=\"animate-spin\" /> : <Trash />}\n          {isDeleted ? t(\"å‰Šé™¤æ¸ˆã¿\", \"Deleted\") : t(\"å‰Šé™¤\", \"Delete\")}\n        </Button>\n      </AlertDialogTrigger>\n      <AlertDialogContent>\n        <AlertDialogHeader>\n          <AlertDialogTitle>{t(\"ç¢ºèª\", \"Confirm\")}</AlertDialogTitle>\n          <AlertDialogDescription>\n            {t(\n              \"æœ¬å½“ã«ã“ã®ä½œå“ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\",\n              \"Are you sure you want to delete this post?\",\n            )}\n          </AlertDialogDescription>\n        </AlertDialogHeader>\n        <AlertDialogFooter>\n          <AlertDialogCancel onClick={() => setIsOpen(false)}>\n            {t(\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\", \"Cancel\")}\n          </AlertDialogCancel>\n          <AlertDialogAction onClick={() => onDeleteWork(props.postId)}>\n            {t(\"å‰Šé™¤\", \"Delete\")}\n          </AlertDialogAction>\n        </AlertDialogFooter>\n      </AlertDialogContent>\n    </AlertDialog>\n  )\n}\n\nconst DeleteWorkMutation = graphql(\n  `mutation DeleteWork($input: DeleteWorkInput!) {\n    deleteWork(input: $input) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/suspicious/noDocumentCookie","severity":"warning","description":"Direct assigning to document.cookie is not recommended.","message":[{"elements":[],"content":"Direct assigning to "},{"elements":["Emphasis"],"content":"document.cookie"},{"elements":[],"content":" is not recommended."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Consider using the "},{"elements":[{"Hyperlink":{"href":"https://developer.mozilla.org/en-US/docs/Web/API/CookieStore"}}],"content":"Cookie Store API"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.posts.$post._index/components/sticker-dialog.tsx"},"span":[1810,1843],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { useContext, useState, useEffect, useRef } from \"react\"\nimport { Tabs, TabsList, TabsTrigger } from \"~/components/ui/tabs\"\nimport {\n  StickerButton,\n  StickerButtonFragment,\n} from \"~/routes/($lang)._main.posts.$post._index/components/sticker-button\"\n\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { graphql } from \"gql.tada\"\nimport { AddStickerButton } from \"~/routes/($lang)._main.posts.$post._index/components/add-sticker-button\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { useFocusTimeout } from \"~/hooks/use-focus-timeout\"\nimport { MinusIcon, PlusIcon } from \"lucide-react\"\n\ntype Props = {\n  isOpen: boolean\n  onClose(): void\n  onSend(stickerId: string, stickerImageURL: string): void\n  isTargetUserBlocked?: boolean\n}\n\n/**\n * ã‚¯ãƒƒã‚­ãƒ¼ã®å€¤ã‚’å–å¾—ã™ã‚‹é–¢æ•°\n */\nfunction getCookie(name: string) {\n  const value = `; ${document.cookie}`\n  const parts = value.split(`; ${name}=`)\n  if (parts.length === 2) return parts.pop()?.split(\";\").shift()\n  return undefined\n}\n\n/**\n * ã‚¯ãƒƒã‚­ãƒ¼ã«å€¤ã‚’è¨­å®šã™ã‚‹é–¢æ•°\n */\nfunction setCookie(name: string, value: string, days: number) {\n  if (typeof document === \"undefined\") return\n\n  const expires = new Date(Date.now() + days * 864e5).toUTCString()\n  const cookieString = `${name}=${encodeURIComponent(value)}; expires=${expires}; path=/; SameSite=Lax`\n\n  try {\n    // biome-ignore lint/complexity/useLiteralKeys: Legacy cookie API required for compatibility\n    document[\"cookie\"] = cookieString\n  } catch (error) {\n    console.warn(\"Failed to set cookie:\", error)\n  }\n}\n\n/**\n * ã‚¹ã‚¿ãƒ³ãƒ—é€ä¿¡ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function StickerDialog (props: Props) {\n  const appContext = useContext(AuthContext)\n\n  const [createdSortStickerPage, setCreatedSortStickerPage] = useState(0)\n\n  const [type, setType] = useState(\"CREATED\")\n\n  // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã‚’ä¿æŒã™ã‚‹ãŸã‚ã®ref\n  const scrollAreaRef = useRef<React.ElementRef<typeof ScrollArea>>(null)\n  const [savedScrollPositions, setSavedScrollPositions] = useState<\n    Record<number, number>\n  >({})\n\n  const maxStickersPage = 120\n\n  const { data: stickers = null, refetch } = useQuery(viewerUserStickersQuery, {\n    skip: !props.isOpen || appContext.isNotLoggedIn,\n    variables: {\n      limit: maxStickersPage,\n      offset: createdSortStickerPage * maxStickersPage,\n      orderBy: \"DATE_CREATED\",\n    },\n    notifyOnNetworkStatusChange: true,\n  })\n\n  const { data: stickersCount = null } = useQuery(\n    viewerUserStickersCountQuery,\n    {\n      skip: !props.isOpen || appContext.isNotLoggedIn,\n    },\n  )\n\n  const maxCount = stickersCount?.viewer?.userStickersCount ?? 0\n\n  const t = useTranslation()\n\n  // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ¤œçŸ¥\n  const isTimeout = useFocusTimeout()\n\n  // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒé–‹ã‹ã‚ŒãŸæ™‚ã‚„ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ãŒå¤‰åŒ–ã—ãŸæ™‚ã«ãƒªãƒ•ã‚§ãƒƒãƒ\n  useEffect(() => {\n    if (props.isOpen && appContext.login && !appContext.isLoading) {\n      refetch()\n    }\n  }, [props.isOpen, appContext.login, appContext.isLoading, refetch])\n\n  // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚ã®è‡ªå‹•ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥\n  useEffect(() => {\n    if (isTimeout && props.isOpen && appContext.login) {\n      console.log(\"Focus timeout detected, refreshing stickers...\")\n      refetch().catch((error) => {\n        console.warn(\"Failed to refresh stickers after timeout:\", error)\n      })\n    }\n  }, [isTimeout, props.isOpen, appContext.login, refetch])\n\n  // ã‚µã‚¤ã‚ºè¨­å®š\n  const sizeOptions: Array<80 | 100 | 120> = [80, 100, 120]\n  const [sizeIndex, setSizeIndex] = useState(1)\n\n  // ã‚¯ãƒƒã‚­ãƒ¼ã‹ã‚‰ã‚µã‚¤ã‚ºè¨­å®šã‚’èª­ã¿è¾¼ã¿\n  useEffect(() => {\n    const savedSizeIndex = getCookie(\"stickerSizeIndex\")\n    if (savedSizeIndex !== undefined) {\n      setSizeIndex(Number.parseInt(savedSizeIndex, 10))\n    }\n  }, [])\n\n  // ã‚µã‚¤ã‚ºè¨­å®šã‚’ã‚¯ãƒƒã‚­ãƒ¼ã«ä¿å­˜\n  useEffect(() => {\n    setCookie(\"stickerSizeIndex\", sizeIndex.toString(), 365)\n  }, [sizeIndex])\n\n  const decreaseSize = () => {\n    setSizeIndex((prevIndex) => Math.max(prevIndex - 1, 0))\n  }\n\n  const increaseSize = () => {\n    setSizeIndex((prevIndex) => Math.min(prevIndex + 1, sizeOptions.length - 1))\n  }\n\n  // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã®ä¿å­˜\n  const saveScrollPosition = () => {\n    if (scrollAreaRef.current) {\n      const scrollElement = scrollAreaRef.current.querySelector(\n        \"[data-radix-scroll-area-viewport]\",\n      )\n      if (scrollElement) {\n        setSavedScrollPositions((prev) => ({\n          ...prev,\n          [createdSortStickerPage]: scrollElement.scrollTop,\n        }))\n      }\n    }\n  }\n\n  // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã®å¾©å…ƒ\n  const restoreScrollPosition = () => {\n    if (\n      scrollAreaRef.current &&\n      savedScrollPositions[createdSortStickerPage] !== undefined\n    ) {\n      const scrollElement = scrollAreaRef.current.querySelector(\n        \"[data-radix-scroll-area-viewport]\",\n      )\n      if (scrollElement) {\n        setTimeout(() => {\n          scrollElement.scrollTop = savedScrollPositions[createdSortStickerPage]\n        }, 50) // DOMã®æ›´æ–°ã‚’å¾…ã¤\n      }\n    }\n  }\n\n  // ãƒšãƒ¼ã‚¸å¤‰æ›´æ™‚ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã‚’ä¿å­˜\n  const handlePageChange = (page: number) => {\n    saveScrollPosition()\n    setCreatedSortStickerPage(page)\n  }\n\n  // ãƒšãƒ¼ã‚¸å¤‰æ›´å¾Œã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã‚’å¾©å…ƒ\n  useEffect(() => {\n    restoreScrollPosition()\n  }, [createdSortStickerPage, stickers])\n\n  // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒé–‰ã˜ã‚‰ã‚Œã‚‹æ™‚ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã‚’ãƒªã‚»ãƒƒãƒˆ\n  useEffect(() => {\n    if (!props.isOpen) {\n      setSavedScrollPositions({})\n    }\n  }, [props.isOpen])\n\n  const sizeMap = {\n    80: \"large\",\n    100: \"x-large\",\n    120: \"2x-large\",\n  } as const\n  const stickerSize = sizeMap[sizeOptions[sizeIndex]]\n\n  return (\n    <Dialog onOpenChange={props.onClose} open={props.isOpen}>\n      <DialogContent className=\"flex h-[80vh] min-h-[32vw] w-[80vw] min-w-[80vw] flex-col pl-2\">\n        <DialogHeader>\n          <DialogTitle>{t(\"ã‚¹ã‚¿ãƒ³ãƒ—\", \"Stickers\")}</DialogTitle>\n        </DialogHeader>\n        {props.isTargetUserBlocked && (\n          <div className=\"mb-4 rounded-md bg-gray-100 p-3 text-gray-600 text-sm dark:bg-gray-800 dark:text-gray-400\">\n            {t(\n              \"ãƒ–ãƒ­ãƒƒã‚¯ä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯ã‚¹ã‚¿ãƒ³ãƒ—ã‚’é€ä¿¡ã§ãã¾ã›ã‚“\",\n              \"Cannot send stickers to blocked users\",\n            )}\n          </div>\n        )}\n        <div className=\"flex items-center space-x-2\">\n          <Tabs value={type} defaultValue={\"CREATED\"}>\n            <TabsList>\n              <TabsTrigger\n                onClick={() => {\n                  setType(\"CREATED\")\n                }}\n                className=\"w-full\"\n                value=\"CREATED\"\n              >\n                {t(\"ä¿å­˜æ—¥\", \"Date saved\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => {\n                  setType(\"RELATED\")\n                }}\n                className=\"w-full\"\n                value=\"RELATED\"\n              >\n                {t(\"æœ€è¿‘ã®ä½¿ç”¨\", \"Recently used\")}\n              </TabsTrigger>\n            </TabsList>\n          </Tabs>\n          <div className=\"flex items-center space-x-2\">\n            <Button size=\"icon\" variant={\"secondary\"} onClick={increaseSize}>\n              <PlusIcon className=\"w-8\" />\n            </Button>\n            <Button size=\"icon\" variant={\"secondary\"} onClick={decreaseSize}>\n              <MinusIcon className=\"w-8\" />\n            </Button>\n          </div>\n        </div>\n        <ScrollArea\n          ref={scrollAreaRef}\n          className=\"flex h-[80vh] w-[80vw] flex-wrap overflow-y-auto\"\n        >\n          <div className=\"flex h-[80vh] w-[80vw] flex-wrap overflow-y-auto\">\n            <AddStickerButton\n              onAddedSicker={() => {\n                refetch()\n              }}\n            />\n            {stickers?.viewer?.userStickers?.map((sticker) => (\n              <StickerButton\n                key={sticker.id}\n                imageUrl={sticker.imageUrl ?? \"\"}\n                title={sticker.title}\n                onClick={() => {\n                  if (!props.isTargetUserBlocked) {\n                    props.onSend(sticker.id, sticker.imageUrl ?? \"\")\n                    props.onClose()\n                  }\n                }}\n                size={stickerSize}\n                disabled={props.isTargetUserBlocked}\n              />\n            ))}\n          </div>\n        </ScrollArea>\n        {type === \"CREATED\" && (\n          <div className=\"mt-1 mb-1\">\n            <ResponsivePagination\n              perPage={maxStickersPage}\n              maxCount={maxCount}\n              currentPage={createdSortStickerPage}\n              onPageChange={handlePageChange}\n              disableScrollToTop={true}\n            />\n          </div>\n        )}\n        <DialogFooter>\n          <Button\n            variant={\"secondary\"}\n            className=\"m-auto w-full\"\n            onClick={props.onClose}\n          >\n            {\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\"}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst viewerUserStickersCountQuery = graphql(\n  `query ViewerUserStickersCount($where: UserStickersWhereInput) {\n    viewer {\n      id\n      userStickersCount(where: $where)\n    }\n  }`,\n)\n\nconst viewerUserStickersQuery = graphql(\n  `query ViewerUserStickers($offset: Int!, $limit: Int!, $orderBy: StickerOrderBy, $where: UserStickersWhereInput) {\n    viewer {\n      id\n      userStickers(offset: $offset, limit: $limit, orderBy: $orderBy, where: $where) {\n        ...StickerButton\n      }\n    }\n  }`,\n  [StickerButtonFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable isLoadingDeleteAlbum is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"isLoadingDeleteAlbum"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.posts.$post._index/components/work-action-menu.tsx"},"span":[1177,1197],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"~/components/ui/popover\"\nimport { ReportDialog } from \"~/routes/($lang)._main.posts.$post._index/components/report-dialog\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { DownloadIcon, MoreHorizontal } from \"lucide-react\"\nimport { useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { ModerationRatingReportDialog } from \"~/routes/($lang)._main.posts.$post._index/components/moderation-rating-report-dialog\"\nimport { ModerationStyleReportDialog } from \"~/routes/($lang)._main.posts.$post._index/components/moderation-style-report-dialog\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { DeleteWorkConfirmDialog } from \"~/routes/($lang)._main.posts.$post._index/components/delete-work-confirm-dialog\"\n\ntype Props = {\n  onDownload: () => void\n  onZipDownload: () => void\n  disabledZipDownload: boolean\n  isEnabledDelete: boolean\n  postId: string\n}\n\n/**\n * ä½œå“ã®ãƒãƒƒãƒ—ã‚ªãƒ¼ãƒãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼\n */\nexport function WorkActionMenu (props: Props) {\n  const [deleteWork, { loading: isLoadingDeleteAlbum }] =\n    useMutation(DeleteWorkMutation)\n  const [_isDeleted, setIsDeleted] = useState(false)\n\n  const t = useTranslation()\n\n  const _onDeleteWork = async (workId: string) => {\n    await deleteWork({\n      variables: {\n        input: {\n          workId: workId,\n        },\n      },\n    })\n    toast(\n      t(\n        \"ä½œå“ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€ã—ã°ã‚‰ãã—ãŸã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ããªããªã‚Šã¾ã™\",\n        \"The post has been deleted\",\n      ),\n    )\n    setIsDeleted(true)\n  }\n\n  const { data: isModeratorData } = useQuery(IsModeratorQuery, {})\n\n  return (\n    <Popover>\n      <PopoverTrigger asChild>\n        <Button size={\"icon\"} variant=\"secondary\">\n          <MoreHorizontal />\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-80\">\n        <div className=\"grid gap-4\">\n          <div className=\"grid gap-2\">\n            <Button\n              onClick={props.onDownload}\n              className=\"flex items-center gap-2\"\n              variant=\"outline\"\n            >\n              <DownloadIcon />\n              {t(\"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰\", \"Download\")}\n            </Button>\n            {!props.disabledZipDownload && (\n              <Button\n                onClick={props.onZipDownload}\n                className=\"flex items-center gap-2\"\n                variant=\"outline\"\n              >\n                <DownloadIcon />\n                {t(\"ä¸€æ‹¬ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰\", \"All Download\")}\n              </Button>\n            )}\n            <ReportDialog postId={props.postId} />\n            {isModeratorData?.viewer?.isModerator && (\n              <ModerationRatingReportDialog postId={props.postId} />\n            )}\n            {isModeratorData?.viewer?.isModerator && (\n              <ModerationStyleReportDialog postId={props.postId} />\n            )}\n            {props.isEnabledDelete && (\n              <DeleteWorkConfirmDialog postId={props.postId} />\n            )}\n          </div>\n        </div>\n      </PopoverContent>\n    </Popover>\n  )\n}\n\nconst DeleteWorkMutation = graphql(\n  `mutation DeleteWork($input: DeleteWorkInput!) {\n    deleteWork(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst IsModeratorQuery = graphql(\n  `query ViewerIsModerator {\n    viewer {\n      id\n      isModerator\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.posts.$post._index/components/work-comment-input.tsx"},"span":[4350,4363],"sourceCode":"import { Avatar, AvatarFallback, AvatarImage } from \"~/components/ui/avatar\"\nimport { Button } from \"~/components/ui/button\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { Loader2Icon, StampIcon } from \"lucide-react\"\nimport { useContext, useState } from \"react\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport { toast } from \"sonner\"\nimport { useBoolean } from \"usehooks-ts\"\nimport { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { graphql } from \"gql.tada\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { StickerDialog } from \"~/routes/($lang)._main.posts.$post._index/components/sticker-dialog\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { CrossPlatformTooltip } from \"~/components/cross-platform-tooltip\"\n\ntype Props = {\n  targetCommentId: string\n  iconUrl: string\n  onReplyCompleted: (\n    id: string,\n    text: string,\n    stickerId: string,\n    stickerImageURL: string,\n  ) => void\n  isWorkOwnerBlocked?: boolean\n}\n\n/**\n * è¿”ä¿¡ã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›æ¬„\n */\nexport function ReplyCommentInput (props: Props) {\n  const { value: isOpen, setTrue: onOpen, setFalse: onClose } = useBoolean()\n\n  const t = useTranslation()\n\n  const [createReplyComment, { loading: isCreatingReplyComment }] = useMutation(\n    createResponseCommentMutation,\n  )\n\n  const [comment, setComment] = useState(\"\")\n\n  const [isSensitive, setIsSensitive] = useState(false)\n\n  const sendComment = async (\n    text: string,\n    targetCommentId: string,\n    stickerId?: string,\n    stickerImageURL?: string,\n  ) => {\n    try {\n      if (props.targetCommentId !== undefined) {\n        const commentRes = await createReplyComment({\n          variables: {\n            input: {\n              commentId: targetCommentId,\n              text: text,\n              stickerId: stickerId,\n            },\n          },\n        })\n\n        setComment(\"\")\n        setIsSensitive(false)\n\n        props.onReplyCompleted(\n          commentRes.data?.createResponseComment.id ?? \"\",\n          comment,\n          stickerId ?? \"\",\n          stickerImageURL ?? \"\",\n        )\n      }\n    } catch (_e) {\n      // toast(\n      //   t(\"é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚åŒã˜ã‚³ãƒ¡ãƒ³ãƒˆã‚’ä½•åº¦ã‚‚é€ä¿¡ã—ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ã‹ã€é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã¾ã™ã€‚\", \"Failed to send. Please try again or check your connection.\")\n      // )\n    }\n  }\n\n  const onComment = async () => {\n    const inputComment = comment.trim()\n\n    if (inputComment === \"\") {\n      toast(t(\"ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a comment\"))\n      return\n    }\n\n    sendComment(inputComment, props.targetCommentId)\n  }\n\n  const authContext = useContext(AuthContext)\n\n  const { data = null } = useQuery(viewerUserQuery, {\n    skip: authContext.isLoading,\n  })\n\n  const iconUrl = data?.viewer?.user?.iconUrl ?? \"\"\n\n  return (\n    <>\n      <div className=\"space-y-2 pl-16\">\n        <div className=\"flex w-full items-center space-x-4\">\n          <Avatar>\n            <AvatarImage src={withIconUrlFallback(iconUrl)} alt=\"\" />\n            <AvatarFallback />\n          </Avatar>\n          <AutoResizeTextarea\n            onChange={(event) => {\n              setComment(event.target.value)\n            }}\n            placeholder={t(\"ã‚³ãƒ¡ãƒ³ãƒˆã™ã‚‹\", \"Add a comment\")}\n            disabled={!authContext.isLoggedIn || props.isWorkOwnerBlocked}\n          />\n          <div>\n            <Button\n              disabled={!authContext.isLoggedIn || props.isWorkOwnerBlocked}\n              variant={\"secondary\"}\n              size={\"icon\"}\n              onClick={onOpen}\n            >\n              <StampIcon className=\"w-16\" />\n            </Button>\n          </div>\n          {isCreatingReplyComment ? (\n            <Button onClick={() => {}}>\n              <Loader2Icon className={\"w-16 animate-spin\"} />\n            </Button>\n          ) : (\n            <Button\n              disabled={!authContext.isLoggedIn || props.isWorkOwnerBlocked}\n              variant={\"secondary\"}\n              onClick={onComment}\n            >\n              {t(\"é€ä¿¡\", \"Send\")}\n            </Button>\n          )}\n        </div>\n        <div className=\"flex items-center space-x-2 pl-14 opacity-80\">\n          {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n          <Checkbox\n            id=\"reply-sensitive-checkbox\"\n            checked={isSensitive}\n            onCheckedChange={(checked: boolean) =>\n              setIsSensitive(checked === true)\n            }\n            disabled={!authContext.isLoggedIn || props.isWorkOwnerBlocked}\n          />\n          <div className=\"flex items-center space-x-2\">\n            <label htmlFor=\"reply-sensitive-checkbox\" className=\"text-xs\">\n              {t(\"éš ã—ä»˜ã\", \"Sensitive comment\")}\n            </label>\n            <CrossPlatformTooltip\n              text={t(\n                \"åˆæœŸè¡¨ç¤ºã¯éè¡¨ç¤ºã«ãªã‚Šã¾ã™ã€‚ã‚¯ãƒªãƒƒã‚¯ã§è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚\",\n                \"You can check new works with this tag in your timeline\",\n              )}\n            />\n          </div>\n        </div>\n      </div>\n      <StickerDialog\n        isOpen={isOpen}\n        onClose={onClose}\n        onSend={async (stickerId: string, stickerImageURL: string) => {\n          await sendComment(\n            comment,\n            props.targetCommentId,\n            stickerId,\n            stickerImageURL,\n          )\n\n          setComment(\"\")\n\n          onClose()\n        }}\n        isTargetUserBlocked={props.isWorkOwnerBlocked}\n      />\n    </>\n  )\n}\n\nconst createResponseCommentMutation = graphql(\n  `mutation CreateResponseComment($input: CreateResponseCommentInput!) {\n    createResponseComment(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst viewerUserQuery = graphql(\n  `query ViewerUser {\n    viewer {\n      id\n      user {\n        id\n        iconUrl\n      }\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.posts.$post._index/components/work-comment-list.tsx"},"span":[10776,10789],"sourceCode":"import { Avatar, AvatarFallback, AvatarImage } from \"~/components/ui/avatar\"\nimport { Button } from \"~/components/ui/button\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport {\n  WorkComment,\n  WorkCommentFragment,\n} from \"~/routes/($lang)._main.posts.$post._index/components/work-comment\"\nimport { Loader2Icon, StampIcon } from \"lucide-react\"\nimport { useContext, useEffect, useState } from \"react\"\nimport { useBoolean } from \"usehooks-ts\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport { toast } from \"sonner\"\nimport { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\nimport { ExpansionTransition } from \"~/components/expansion-transition\"\nimport { StickerDialog } from \"~/routes/($lang)._main.posts.$post._index/components/sticker-dialog\"\nimport {\n  StickerButton,\n  StickerButtonFragment,\n} from \"~/routes/($lang)._main.posts.$post._index/components/sticker-button\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { WorkCommentResponse } from \"~/routes/($lang)._main.posts.$post._index/components/work-comment-response\"\nimport { CrossPlatformTooltip } from \"~/components/cross-platform-tooltip\"\n\ntype Props = {\n  workId: string\n  workOwnerIconImageURL?: string | null\n  comments: FragmentOf<typeof CommentListItemFragment>[]\n  defaultShowCommentCount?: number\n  isWorkOwnerBlocked?: boolean\n}\n\n// ã‚³ãƒ¡ãƒ³ãƒˆ\ntype Comment = {\n  id: string\n  text: string\n  createdAt: number\n  isLiked: boolean\n  isMuted: boolean\n  isSensitive?: boolean\n  likesCount: number\n  isWorkOwnerLiked: boolean\n  user: {\n    id: string\n    name: string\n    iconUrl: string\n  }\n  sticker: {\n    image: {\n      downloadURL: string\n    }\n  }\n}\n\n// è¿”ä¿¡ã‚³ãƒ¡ãƒ³ãƒˆ\ntype ReplyComment = {\n  replyTargetId: string\n  id: string\n  text: string\n  createdAt: number\n  isLiked: boolean\n  isMuted: boolean\n  isSensitive?: boolean\n  likesCount: number\n  isWorkOwnerLiked: boolean\n  user: {\n    id: string\n    name: string\n    iconUrl: string\n  }\n  sticker: {\n    image: {\n      downloadURL: string\n    }\n  }\n}\n\n// æ—¥æœ¬æ™‚é–“ã®æ—¥ä»˜ã‚’è¨ˆç®—ã™ã‚‹é–¢æ•°\nconst getJSTDate = () => {\n  const date = new Date()\n  const utcOffset = date.getTimezoneOffset() * 60000 // åˆ†å˜ä½ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’ãƒŸãƒªç§’ã«å¤‰æ›\n  const jstOffset = 9 * 60 * 60 * 1000 // JSTã¯UTC+9\n  const jstDate = new Date(date.getTime() + utcOffset + jstOffset)\n  return jstDate\n}\n\n/**\n * ä½œå“ã¸ã®ã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§\n */\nexport function WorkCommentList (props: Props) {\n  const { value: isOpen, setTrue: onOpen, setFalse: onClose } = useBoolean()\n\n  const t = useTranslation()\n\n  const appContext = useContext(AuthContext)\n\n  const [createWorkComment, { loading: isCreatingWorkComment }] = useMutation(\n    createWorkCommentMutation,\n  )\n\n  const [createCommentLike, { loading: isCreatingCommentLike }] = useMutation(\n    createCommentLikeMutation,\n  )\n\n  const [deleteCommentLike, { loading: isDeletingCommentLike }] = useMutation(\n    deleteCommentLikeMutation,\n  )\n\n  const [comment, setComment] = useState(\"\")\n\n  const [isSensitive, setIsSensitive] = useState(false)\n\n  const [newComments, setNewComments] = useState<Comment[]>([])\n\n  const [newReplyComments, setNewReplyComments] = useState<ReplyComment[]>([])\n\n  const [hideCommentIds, setHideCommentIds] = useState<string[]>([])\n\n  const showComments = props.comments.filter(\n    (comment) => !hideCommentIds.includes(comment.id),\n  )\n\n  const authContext = useContext(AuthContext)\n\n  const userResp = useQuery(userQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      userId: authContext.userId ?? \"0\",\n    },\n  })\n\n  const userIcon = userResp?.data?.user?.iconUrl\n\n  const showNewComments = newComments?.filter(\n    (comment) => !hideCommentIds.includes(comment.id),\n  )\n\n  const showNewReplyComments = newReplyComments?.filter(\n    (comment) => !hideCommentIds.includes(comment.id),\n  )\n\n  const [likedCommentIds, setLikedCommentIds] = useState<string[]>([])\n\n  const [canceledCommentIds, setCanceledCommentIds] = useState<string[]>([])\n\n  useEffect(() => {\n    if (newComments !== null) {\n      setNewComments([])\n    }\n  }, [props.workId])\n\n  const sendComment = async (\n    text: string,\n    stickerId: string,\n    stickerImageURL: string,\n    targetWorkId: string,\n    iconUrl: string | null | undefined = null,\n  ) => {\n    try {\n      if (targetWorkId !== undefined) {\n        const res = await createWorkComment({\n          variables: {\n            input: {\n              workId: targetWorkId,\n              text: text,\n              stickerId: stickerId,\n              // TODO: Add isSensitive to GraphQL schema\n              // isSensitive: isSensitive ?? false,\n            },\n          },\n        })\n\n        setComment(\"\")\n        setIsSensitive(false)\n\n        setNewComments([\n          {\n            id: res.data?.createWorkComment?.id ?? \"\",\n            text: text,\n            createdAt: getJSTDate().getTime() / 1000,\n            likesCount: 0,\n            isWorkOwnerLiked: false,\n            isLiked: false,\n            user: {\n              id: appContext.userId ?? \"\",\n              name: appContext.displayName ?? \"\",\n              iconUrl: withIconUrlFallback(iconUrl),\n            },\n            sticker: {\n              image: {\n                downloadURL: stickerImageURL,\n              },\n            },\n            isMuted: false,\n            isSensitive: isSensitive,\n            ...newComments,\n          },\n        ])\n      }\n    } catch (_e) {\n      // toast(\n      //   t(\n      //     \"é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚åŒã˜ã‚³ãƒ¡ãƒ³ãƒˆã‚’ä½•åº¦ã‚‚é€ä¿¡ã—ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ã‹ã€é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã¾ã™ã€‚\",\n      //     \"Failed to send. Please try again.\",\n      //   ),\n      // )\n    }\n  }\n\n  const onCreateCommentLike = async (commentId: string) => {\n    try {\n      await createCommentLike({\n        variables: {\n          input: {\n            commentId: commentId,\n          },\n        },\n      })\n      setLikedCommentIds([...likedCommentIds, commentId])\n      setCanceledCommentIds(canceledCommentIds.filter((id) => id !== commentId))\n    } catch (_e) {\n      // toast(\n      //   t(\n      //     \"ã„ã„ã­ã«å¤±æ•—ã—ã¾ã—ãŸã€‚é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã¾ã™ã€‚\",\n      //     \"Failed to like. Please try again.\",\n      //   ),\n      // )\n    }\n  }\n\n  const onDeleteCommentLike = async (commentId: string) => {\n    try {\n      await deleteCommentLike({\n        variables: {\n          input: {\n            commentId: commentId,\n          },\n        },\n      })\n      setLikedCommentIds(likedCommentIds.filter((id) => id !== commentId))\n      setCanceledCommentIds([...canceledCommentIds, commentId])\n    } catch (_e) {\n      toast(\n        t(\n          \"ã„ã„ã­ã®å–ã‚Šæ¶ˆã—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã¾ã™ã€‚\",\n          \"Failed to unlike. Please try again.\",\n        ),\n      )\n    }\n  }\n\n  const onDeleteComment = (commentId: string) => {\n    setHideCommentIds([...hideCommentIds, commentId])\n  }\n\n  const onWorkComment = async () => {\n    const inputComment = comment.trim()\n\n    if (inputComment === \"\") {\n      toast(t(\"ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a comment\"))\n      return\n    }\n\n    sendComment(inputComment, \"-1\", \"\", props.workId, userIcon)\n  }\n\n  const showCommentsBeforeMore = showComments.slice(\n    0,\n    props.defaultShowCommentCount ? props.defaultShowCommentCount : 8,\n  )\n\n  const showCommentsAfterMore = showComments.slice(\n    props.defaultShowCommentCount ? props.defaultShowCommentCount : 8,\n  )\n\n  const { data = null } = useQuery(viewerUserQuery, {\n    skip: authContext.isLoading,\n  })\n\n  const stickers = data?.viewer?.userStickers ?? []\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        <p>\n          {t(\"ã‚³ãƒ¡ãƒ³ãƒˆ\", \"Comments\")} (\n          {showComments.length + (showNewComments?.length ?? 0)})\n        </p>\n        {props.isWorkOwnerBlocked && (\n          <div className=\"rounded-md bg-gray-100 p-3 text-gray-600 text-sm dark:bg-gray-800 dark:text-gray-400\">\n            {t(\n              \"ãƒ–ãƒ­ãƒƒã‚¯ä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯ã‚³ãƒ¡ãƒ³ãƒˆã§ãã¾ã›ã‚“\",\n              \"Cannot comment to blocked users\",\n            )}\n          </div>\n        )}\n        {stickers.length > 0 && !props.isWorkOwnerBlocked && (\n          <div className=\"flex space-x-2 overflow-x-auto\">\n            {stickers.map((sticker) => (\n              <StickerButton\n                key={sticker.id}\n                imageUrl={sticker.imageUrl ?? \"\"}\n                title={sticker.title}\n                onClick={async () => {\n                  try {\n                    await sendComment(\n                      comment,\n                      sticker.id,\n                      sticker.imageUrl ?? \"\",\n                      props.workId,\n                      userIcon,\n                    )\n                  } catch (error) {\n                    console.error(\"Failed to send comment:\", error)\n                  }\n                }}\n                size=\"2x-large\"\n                disabled={props.isWorkOwnerBlocked}\n              />\n            ))}\n          </div>\n        )}\n\n        <div className=\"space-y-2\">\n          <div className=\"flex w-full items-center space-x-4\">\n            <Avatar>\n              <AvatarImage src={withIconUrlFallback(userIcon)} alt=\"\" />\n              <AvatarFallback />\n            </Avatar>\n            <AutoResizeTextarea\n              onChange={(event) => {\n                setComment(event.target.value)\n              }}\n              value={comment}\n              placeholder={t(\"ã‚³ãƒ¡ãƒ³ãƒˆã™ã‚‹\", \"Add a comment\")}\n              disabled={!authContext.isLoggedIn || props.isWorkOwnerBlocked}\n            />\n            <Button\n              disabled={!authContext.isLoggedIn || props.isWorkOwnerBlocked}\n              variant={\"secondary\"}\n              size={\"icon\"}\n              onClick={onOpen}\n            >\n              <StampIcon className=\"w-16\" />\n            </Button>\n            {isCreatingWorkComment ? (\n              <Button onClick={() => {}}>\n                <Loader2Icon className={\"w-16 animate-spin\"} />\n              </Button>\n            ) : (\n              <Button\n                disabled={!authContext.isLoggedIn || props.isWorkOwnerBlocked}\n                variant={\"secondary\"}\n                onClick={onWorkComment}\n              >\n                {t(\"é€ä¿¡\", \"Send\")}\n              </Button>\n            )}\n          </div>\n          <div className=\"flex items-center space-x-2 pl-14 opacity-30\">\n            {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n            <Checkbox\n              id=\"sensitive-checkbox\"\n              checked={isSensitive}\n              onCheckedChange={(checked: boolean) =>\n                setIsSensitive(checked === true)\n              }\n              disabled={!authContext.isLoggedIn || props.isWorkOwnerBlocked}\n            />\n            <div className=\"flex items-center space-x-2\">\n              <label htmlFor=\"sensitive-checkbox\" className=\"text-xs\">\n                {t(\"éš ã—ä»˜ã\", \"Sensitive comment\")}\n              </label>\n              <CrossPlatformTooltip\n                text={t(\n                  \"åˆæœŸè¡¨ç¤ºã¯éè¡¨ç¤ºã«ãªã‚Šã¾ã™ã€‚ã‚¯ãƒªãƒƒã‚¯ã§è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚\",\n                  \"You can check new works with this tag in your timeline\",\n                )}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n      <div className=\"space-y-4 overflow-y-auto\">\n        {showNewComments && (\n          <div className=\"space-y-4\">\n            {showNewComments.map((comment) => (\n              <div key={`${props.workId}-${comment.id}`}>\n                <WorkComment\n                  userId={comment.user?.id ?? \"\"}\n                  isMine={comment.user?.id === appContext.userId}\n                  createdAt={comment.createdAt}\n                  stickerImageURL={comment.sticker?.image?.downloadURL}\n                  text={comment.text}\n                  workOwnerIconImageURL={withIconUrlFallback(\n                    props.workOwnerIconImageURL,\n                  )}\n                  userIconImageURL={withIconUrlFallback(comment.user?.iconUrl)}\n                  userName={comment.user?.name}\n                  commentId={comment.id}\n                  isLiked={\n                    comment.isLiked && !canceledCommentIds.includes(comment.id)\n                  }\n                  isMuted={comment.isLiked}\n                  isSensitive={comment.isSensitive}\n                  isNowLiked={likedCommentIds.includes(comment.id)}\n                  likesCount={\n                    comment.likesCount -\n                    (canceledCommentIds.includes(comment.id) ? 1 : 0)\n                  }\n                  isWorkOwnerLiked={comment.isWorkOwnerLiked}\n                  isLoadingCommentLike={\n                    isCreatingCommentLike || isDeletingCommentLike\n                  }\n                  onCreateCommentLike={() => onCreateCommentLike(comment.id)}\n                  onDeleteCommentLike={() => onDeleteCommentLike(comment.id)}\n                  onDeleteComment={() => onDeleteComment(comment.id)}\n                  isWorkOwnerBlocked={props.isWorkOwnerBlocked}\n                  onReplyCompleted={(\n                    id: string,\n                    text: string,\n                    _stickerId: string,\n                    stickerImageURL: string,\n                  ) => {\n                    setNewComments([\n                      {\n                        id: id,\n                        text: text,\n                        createdAt: getJSTDate().getTime() / 1000,\n                        likesCount: 0,\n                        isWorkOwnerLiked: false,\n                        isLiked: false,\n                        user: {\n                          id: appContext.userId ?? \"\",\n                          name: appContext.displayName ?? \"\",\n                          iconUrl: withIconUrlFallback(userIcon),\n                        },\n                        sticker: {\n                          image: {\n                            downloadURL: stickerImageURL,\n                          },\n                        },\n                        isMuted: false,\n                        ...newComments,\n                      },\n                    ])\n                  }}\n                />\n              </div>\n            ))}\n          </div>\n        )}\n        {showCommentsBeforeMore.map((comment) => (\n          <div key={comment.id} className=\"space-y-4\">\n            <WorkComment\n              userId={comment.user?.id ?? \"\"}\n              isMine={comment.user?.id === appContext.userId}\n              createdAt={comment.createdAt}\n              stickerImageURL={comment.sticker?.imageUrl ?? \"\"}\n              stickerTitle={comment.sticker?.title}\n              stickerId={comment.sticker?.id}\n              stickerAccessType={comment.sticker?.accessType}\n              isStickerDownloadable={comment.sticker?.isDownloaded}\n              text={comment.text}\n              userName={comment.user?.name}\n              commentId={comment.id}\n              isLiked={\n                comment.isLiked && !canceledCommentIds.includes(comment.id)\n              }\n              isMuted={Boolean(comment.isMuted)}\n              isSensitive={Boolean(comment.isSensitive)}\n              isNowLiked={likedCommentIds.includes(comment.id)}\n              likesCount={\n                comment.likesCount -\n                (canceledCommentIds.includes(comment.id) ? 1 : 0)\n              }\n              isWorkOwnerLiked={comment.isWorkOwnerLiked}\n              onCreateCommentLike={() => onCreateCommentLike(comment.id)}\n              onDeleteCommentLike={() => onDeleteCommentLike(comment.id)}\n              isDisabledCommentLike={!appContext.isLoggedIn}\n              isLoadingCommentLike={\n                isCreatingCommentLike || isDeletingCommentLike\n              }\n              workOwnerIconImageURL={withIconUrlFallback(\n                props.workOwnerIconImageURL,\n              )}\n              userIconImageURL={withIconUrlFallback(comment.user?.iconUrl)}\n              onDeleteComment={() => onDeleteComment(comment.id)}\n              isWorkOwnerBlocked={props.isWorkOwnerBlocked}\n              onReplyCompleted={(\n                id: string,\n                text: string,\n                _stickerId: string,\n                stickerImageURL: string,\n              ) => {\n                setNewReplyComments([\n                  ...newReplyComments,\n                  {\n                    replyTargetId: comment.id,\n                    id: id,\n                    text: text,\n                    createdAt: Date.now(),\n                    likesCount: 0,\n                    isWorkOwnerLiked: false,\n                    isLiked: false,\n                    isMuted: false,\n                    isSensitive: false, // TODO: Get this value from ReplyCommentInput\n                    user: {\n                      id: appContext.userId ?? \"\",\n                      name: appContext.displayName ?? \"\",\n                      iconUrl: withIconUrlFallback(userIcon),\n                    },\n                    sticker: {\n                      image: {\n                        downloadURL: stickerImageURL,\n                      },\n                    },\n                  },\n                ])\n              }}\n            />\n            {/* æ–°ã—ãè¿½åŠ ã—ãŸè¿”ä¿¡ã¸ã®è¿”ä¿¡ */}\n            {showNewReplyComments?.map((newReply) =>\n              newReply.replyTargetId !== comment.id ? null : (\n                <WorkCommentResponse\n                  key={newReply.id}\n                  userId={newReply.user?.id ?? \"\"}\n                  isMine={newReply.user?.id === appContext.userId}\n                  createdAt={newReply.createdAt}\n                  stickerImageURL={newReply.sticker?.image?.downloadURL}\n                  text={newReply.text}\n                  iconUrl={withIconUrlFallback(userIcon)}\n                  userName={newReply.user?.name}\n                  replyId={newReply.id}\n                  targetCommentId={comment.id}\n                  isLiked={\n                    newReply.isLiked &&\n                    !canceledCommentIds.includes(newReply.id)\n                  }\n                  isMuted={newReply.isMuted}\n                  isSensitive={newReply.isSensitive}\n                  isNowLiked={likedCommentIds.includes(newReply.id)}\n                  likesCount={\n                    newReply.likesCount -\n                    (canceledCommentIds.includes(newReply.id) ? 1 : 0)\n                  }\n                  isWorkOwnerLiked={newReply.isWorkOwnerLiked}\n                  isLoadingCommentLike={\n                    isCreatingCommentLike || isDeletingCommentLike\n                  }\n                  onCreateCommentLike={() => onCreateCommentLike(newReply.id)}\n                  onDeleteCommentLike={() => onDeleteCommentLike(newReply.id)}\n                  onDeleteComment={() => {\n                    onDeleteComment(newReply.id)\n                  }}\n                  isWorkOwnerBlocked={props.isWorkOwnerBlocked}\n                />\n              ),\n            )}\n            {/* ã‚³ãƒ¡ãƒ³ãƒˆã¸ã®è¿”ä¿¡ */}\n            {comment.responses !== null &&\n              comment.responses?.length !== 0 &&\n              comment.responses\n                // .sort((a, b) => a.createdAt - b.createdAt)\n                .filter((reply) => !hideCommentIds.includes(reply.id))\n                .map((reply) => (\n                  <WorkCommentResponse\n                    key={reply.id}\n                    userId={reply.user?.id ?? \"\"}\n                    isMine={reply.user?.id === appContext.userId}\n                    createdAt={reply.createdAt}\n                    stickerImageURL={reply.sticker?.imageUrl ?? \"\"}\n                    stickerTitle={reply.sticker?.title}\n                    stickerId={reply.sticker?.id}\n                    stickerAccessType={reply.sticker?.accessType}\n                    isStickerDownloadable={reply.sticker?.isDownloaded}\n                    isWorkOwnerLiked={reply.isWorkOwnerLiked}\n                    isDisabledCommentLike={!appContext.isLoggedIn}\n                    text={reply.text}\n                    userIconImageURL={withIconUrlFallback(reply.user?.iconUrl)}\n                    isLiked={\n                      reply.isLiked && !canceledCommentIds.includes(reply.id)\n                    }\n                    isMuted={Boolean(reply.isMuted)}\n                    isSensitive={Boolean(reply.isSensitive)}\n                    isNowLiked={likedCommentIds.includes(reply.id)}\n                    likesCount={\n                      reply.likesCount -\n                      (canceledCommentIds.includes(reply.id) ? 1 : 0)\n                    }\n                    onCreateCommentLike={() => onCreateCommentLike(reply.id)}\n                    onDeleteCommentLike={() => onDeleteCommentLike(reply.id)}\n                    userName={reply.user?.name}\n                    replyId={reply.id}\n                    targetCommentId={comment.id}\n                    iconUrl={withIconUrlFallback(userIcon)}\n                    onDeleteComment={() => {\n                      onDeleteComment(reply.id)\n                    }}\n                    isWorkOwnerBlocked={props.isWorkOwnerBlocked}\n                    onReplyCompleted={(\n                      id: string,\n                      text: string,\n                      _stickerId: string,\n                      stickerImageURL: string,\n                    ) => {\n                      // è¡¨ç¤ºã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ \n                      setNewReplyComments([\n                        ...newReplyComments,\n                        {\n                          replyTargetId: comment.id,\n                          id: id,\n                          text: text,\n                          createdAt: Date.now(),\n                          likesCount: 0,\n                          isWorkOwnerLiked: false,\n                          isLiked: false,\n                          isMuted: false,\n                          isSensitive: false, // TODO: Get this value from ReplyCommentInput\n                          user: {\n                            id: appContext.userId ?? \"\",\n                            name: appContext.displayName ?? \"\",\n                            iconUrl: withIconUrlFallback(userIcon),\n                          },\n                          sticker: {\n                            image: {\n                              downloadURL: stickerImageURL,\n                            },\n                          },\n                        },\n                      ])\n                    }}\n                  />\n                ))}\n          </div>\n        ))}\n        {showCommentsAfterMore.length > 0 && (\n          <ExpansionTransition\n            triggerChildren={\n              <Button className=\"w-full\" variant={\"secondary\"}>\n                {t(\"ã‚‚ã£ã¨è¦‹ã‚‹\", \"Load more\")} ({showCommentsAfterMore.length})\n              </Button>\n            }\n            oneTimeExpand={true}\n            className=\"flex flex-col space-y-4\"\n          >\n            {showCommentsAfterMore.map((comment) => (\n              <div key={comment.id} className=\"space-y-4\">\n                <WorkComment\n                  userId={comment.user?.id ?? \"\"}\n                  isMine={comment.user?.id === appContext.userId}\n                  createdAt={comment.createdAt}\n                  stickerImageURL={comment.sticker?.imageUrl ?? \"\"}\n                  stickerTitle={comment.sticker?.title}\n                  stickerId={comment.sticker?.id}\n                  stickerAccessType={comment.sticker?.accessType}\n                  isStickerDownloadable={comment.sticker?.isDownloaded}\n                  isWorkOwnerLiked={comment.isWorkOwnerLiked}\n                  workOwnerIconImageURL={withIconUrlFallback(\n                    props.workOwnerIconImageURL,\n                  )}\n                  userIconImageURL={withIconUrlFallback(comment.user?.iconUrl)}\n                  isLiked={\n                    comment.isLiked && !canceledCommentIds.includes(comment.id)\n                  }\n                  isMuted={Boolean(comment.isMuted)}\n                  isSensitive={Boolean(comment.isSensitive)}\n                  isNowLiked={likedCommentIds.includes(comment.id)}\n                  likesCount={\n                    comment.likesCount -\n                    (canceledCommentIds.includes(comment.id) ? 1 : 0)\n                  }\n                  onCreateCommentLike={() => onCreateCommentLike(comment.id)}\n                  onDeleteCommentLike={() => onDeleteCommentLike(comment.id)}\n                  isDisabledCommentLike={!appContext.isLoggedIn}\n                  isLoadingCommentLike={\n                    isCreatingCommentLike || isDeletingCommentLike\n                  }\n                  text={comment.text}\n                  userName={comment.user?.name}\n                  commentId={comment.id}\n                  onDeleteComment={() => onDeleteComment(comment.id)}\n                  isWorkOwnerBlocked={props.isWorkOwnerBlocked}\n                  onReplyCompleted={(\n                    id: string,\n                    text: string,\n                    _stickerId: string,\n                    stickerImageURL: string,\n                  ) => {\n                    setNewReplyComments([\n                      ...(newReplyComments || []),\n                      {\n                        replyTargetId: comment.id,\n                        id: id,\n                        text: text,\n                        createdAt: Date.now(),\n                        likesCount: 0,\n                        isWorkOwnerLiked: false,\n                        isLiked: false,\n                        isMuted: false,\n                        isSensitive: false, // TODO: Get this value from ReplyCommentInput\n                        user: {\n                          id: appContext.userId ?? \"\",\n                          name: appContext.displayName ?? \"\",\n                          iconUrl: withIconUrlFallback(userIcon),\n                        },\n                        sticker: {\n                          image: {\n                            downloadURL: stickerImageURL,\n                          },\n                        },\n                      },\n                    ])\n                  }}\n                />\n                {/* æ–°ã—ãè¿½åŠ ã—ãŸè¿”ä¿¡ã¸ã®è¿”ä¿¡ */}\n                {showNewReplyComments?.map((newReply) =>\n                  newReply.replyTargetId !== comment.id ? null : (\n                    <WorkCommentResponse\n                      key={newReply.id}\n                      userId={newReply.user?.id ?? \"\"}\n                      isMine={newReply.user?.id === appContext.userId}\n                      createdAt={newReply.createdAt}\n                      stickerImageURL={newReply.sticker?.image?.downloadURL}\n                      text={newReply.text}\n                      iconUrl={withIconUrlFallback(userIcon)}\n                      isWorkOwnerLiked={newReply.isWorkOwnerLiked}\n                      isNowLiked={likedCommentIds.includes(newReply.id)}\n                      workOwnerIconImageURL={withIconUrlFallback(\n                        props.workOwnerIconImageURL,\n                      )}\n                      userIconImageURL={withIconUrlFallback(\n                        newReply.user.iconUrl,\n                      )}\n                      isLiked={\n                        newReply.isLiked &&\n                        !canceledCommentIds.includes(newReply.id)\n                      }\n                      isMuted={newReply.isMuted}\n                      isSensitive={newReply.isSensitive}\n                      likesCount={\n                        newReply.likesCount -\n                        (canceledCommentIds.includes(newReply.id) ? 1 : 0)\n                      }\n                      onCreateCommentLike={() =>\n                        onCreateCommentLike(newReply.id)\n                      }\n                      onDeleteCommentLike={() =>\n                        onDeleteCommentLike(newReply.id)\n                      }\n                      userName={newReply.user?.name}\n                      replyId={newReply.id}\n                      targetCommentId={comment.id}\n                      onDeleteComment={() => {\n                        onDeleteComment(newReply.id)\n                      }}\n                      isWorkOwnerBlocked={props.isWorkOwnerBlocked}\n                    />\n                  ),\n                )}\n                {/* ã‚³ãƒ¡ãƒ³ãƒˆã¸ã®è¿”ä¿¡ */}\n                {comment.responses !== null &&\n                  comment.responses?.length !== 0 &&\n                  comment.responses\n                    // .sort((a, b) => a.createdAt - b.createdAt)\n                    .filter((reply) => !hideCommentIds.includes(reply.id))\n                    .map((reply) => (\n                      <WorkCommentResponse\n                        key={reply.id}\n                        userId={reply.user?.id ?? \"\"}\n                        isMine={reply.user?.id === appContext.userId}\n                        createdAt={reply.createdAt}\n                        stickerImageURL={reply.sticker?.imageUrl ?? \"\"}\n                        stickerTitle={reply.sticker?.title}\n                        stickerId={reply.sticker?.id}\n                        stickerAccessType={reply.sticker?.accessType}\n                        isStickerDownloadable={reply.sticker?.isDownloaded}\n                        isDisabledCommentLike={!appContext.isLoggedIn}\n                        isWorkOwnerLiked={reply.isWorkOwnerLiked}\n                        workOwnerIconImageURL={withIconUrlFallback(\n                          props.workOwnerIconImageURL,\n                        )}\n                        isNowLiked={likedCommentIds.includes(reply.id)}\n                        isLiked={\n                          reply.isLiked &&\n                          !canceledCommentIds.includes(reply.id)\n                        }\n                        isMuted={Boolean(reply.isMuted)}\n                        isSensitive={Boolean(reply.isSensitive)}\n                        likesCount={\n                          reply.likesCount -\n                          (canceledCommentIds.includes(reply.id) ? 1 : 0)\n                        }\n                        onCreateCommentLike={() =>\n                          onCreateCommentLike(reply.id)\n                        }\n                        onDeleteCommentLike={() =>\n                          onDeleteCommentLike(reply.id)\n                        }\n                        text={reply.text}\n                        userIconImageURL={withIconUrlFallback(\n                          reply.user?.iconUrl,\n                        )}\n                        userName={reply.user?.name}\n                        replyId={reply.id}\n                        targetCommentId={comment.id}\n                        iconUrl={withIconUrlFallback(userIcon)}\n                        onDeleteComment={() => {\n                          onDeleteComment(reply.id)\n                        }}\n                        isWorkOwnerBlocked={props.isWorkOwnerBlocked}\n                        onReplyCompleted={(\n                          id: string,\n                          text: string,\n                          _stickerId: string,\n                          stickerImageURL: string,\n                        ) => {\n                          // è¡¨ç¤ºã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ \n                          setNewReplyComments([\n                            ...newReplyComments,\n                            {\n                              replyTargetId: comment.id,\n                              id: id,\n                              text: text,\n                              createdAt: Date.now(),\n                              likesCount: 0,\n                              isWorkOwnerLiked: false,\n                              isLiked: false,\n                              isMuted: false,\n                              isSensitive: false, // TODO: Get this value from ReplyCommentInput\n                              user: {\n                                id: appContext.userId ?? \"\",\n                                name: appContext.displayName ?? \"\",\n                                iconUrl: withIconUrlFallback(userIcon),\n                              },\n                              sticker: {\n                                image: {\n                                  downloadURL: stickerImageURL,\n                                },\n                              },\n                            },\n                          ])\n                        }}\n                      />\n                    ))}\n              </div>\n            ))}\n          </ExpansionTransition>\n        )}\n      </div>\n      <StickerDialog\n        isOpen={isOpen}\n        onClose={onClose}\n        onSend={async (stickerId: string, url: string) => {\n          await sendComment(comment, stickerId, url, props.workId, userIcon)\n        }}\n        isTargetUserBlocked={props.isWorkOwnerBlocked}\n      />\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      iconUrl\n    }\n  }`,\n)\n\nexport const CommentListItemFragment = graphql(\n  `fragment Comment on CommentNode @_unmask {\n      ...WorkComment\n      responses(offset: 0, limit: 128) {\n        ...WorkComment\n      }\n  }`,\n  [WorkCommentFragment],\n)\n\nconst createWorkCommentMutation = graphql(\n  `\n  mutation CreateWorkComment($input: CreateWorkCommentInput!) {\n    createWorkComment(input: $input) {\n      ...WorkComment\n    }\n  }\n`,\n  [WorkCommentFragment],\n)\n\nconst createCommentLikeMutation = graphql(\n  `mutation CreateCommentLike($input: CreateCommentLikeInput!) {\n    createCommentLike(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst deleteCommentLikeMutation = graphql(\n  `mutation DeleteCommentLike($input: DeleteCommentLikeInput!) {\n    deleteCommentLike(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst viewerUserQuery = graphql(\n  `query ViewerUser {\n    viewer {\n      id\n      user {\n        id\n        iconUrl\n      }\n      userStickers(offset: 0, limit: 5, orderBy: DATE_USED) {\n        ...StickerButton\n      }\n    }\n  }`,\n  [StickerButtonFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.posts.$post._index/components/work-html-view.tsx"},"span":[350,363],"sourceCode":"type Props = {\n  html: string\n  thumbnailUrl: string\n}\n\nexport function WorkHtmlView ({ thumbnailUrl, html }: Props) {\n  return (\n    <div className=\"relative\">\n      <img\n        src={thumbnailUrl}\n        alt=\"Thumbnail\"\n        className=\"m-auto h-auto w-full max-w-96\"\n      />\n\n      {/* biome-ignore lint/security/noDangerouslySetInnerHtml: <explanation> */}\n      <div dangerouslySetInnerHTML={{ __html: html }} />\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.posts.$post._index/components/work-image-thumbnail-carousel.tsx"},"span":[1568,1581],"sourceCode":"import {\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselNext,\n  CarouselPrevious,\n} from \"~/components/ui/carousel\"\nimport type React from \"react\"\n\ntype Props = {\n  allImageURLs: string[]\n  selectedImage: string\n  currentIndex: number\n  onSelectImage: (imageURL: string) => void\n}\n\nexport function WorkImageThumbnailCarousel ({\n  allImageURLs,\n  selectedImage,\n  currentIndex,\n  onSelectImage,\n}: Props) {\n  // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼\n  const handleKeyPress = (imageURL: string, event: React.KeyboardEvent) => {\n    if (event.key === \"Enter\") {\n      onSelectImage(imageURL)\n    }\n  }\n\n  return (\n    <div className=\"flex flex-col\">\n      {allImageURLs.length > 1 && (\n        <div className=\"rounded-none bg-card bg-zinc-100 text-center dark:bg-zinc-900\">\n          <p className=\"m-auto text-center text-sm opacity-50\">\n            {currentIndex + 1} / {allImageURLs.length}\n          </p>\n        </div>\n      )}\n      <Carousel opts={{ dragFree: true }}>\n        <CarouselContent>\n          {allImageURLs.map((imageURL, index) => {\n            // é¸æŠã•ã‚ŒãŸç”»åƒã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã€å¯¾å¿œã™ã‚‹ã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨\n            const isSelected = imageURL === selectedImage\n            const imageClassName = isSelected\n              ? \"w-40 h-16 cursor-pointer object-cover border-2 border-clear-bright-blue m-auto\"\n              : \"w-40 h-16 cursor-pointer object-cover border-2 border-transparent m-auto\"\n\n            return (\n              <CarouselItem\n                // biome-ignore lint/suspicious/noArrayIndexKey: <explanation>\n                key={index}\n                className={\"basis-1/8\"}\n              >\n                <img\n                  className={imageClassName}\n                  alt=\"\"\n                  key={imageURL}\n                  src={imageURL}\n                  onClick={() => onSelectImage(imageURL)}\n                  onKeyUp={(event) => handleKeyPress(imageURL, event)}\n                  // biome-ignore lint/a11y/noNoninteractiveTabindex: <explanation>\n                  tabIndex={0}\n                />\n              </CarouselItem>\n            )\n          })}\n        </CarouselContent>\n        {/* <div className=\"absolute top-0 left-0 h-full w-16 bg-linear-to-r from-card to-transparent\" /> */}\n        <CarouselPrevious className=\"absolute left-0\" />\n        {/* <div className=\"absolute top-0 right-0 h-full w-16 bg-linear-to-r from-transparent to-card\" /> */}\n        <CarouselNext className=\"absolute right-0\" />\n      </Carousel>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.posts.$post._index/components/work-image-thumbnail-carousel.tsx"},"span":[2022,2035],"sourceCode":"import {\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselNext,\n  CarouselPrevious,\n} from \"~/components/ui/carousel\"\nimport type React from \"react\"\n\ntype Props = {\n  allImageURLs: string[]\n  selectedImage: string\n  currentIndex: number\n  onSelectImage: (imageURL: string) => void\n}\n\nexport function WorkImageThumbnailCarousel ({\n  allImageURLs,\n  selectedImage,\n  currentIndex,\n  onSelectImage,\n}: Props) {\n  // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼\n  const handleKeyPress = (imageURL: string, event: React.KeyboardEvent) => {\n    if (event.key === \"Enter\") {\n      onSelectImage(imageURL)\n    }\n  }\n\n  return (\n    <div className=\"flex flex-col\">\n      {allImageURLs.length > 1 && (\n        <div className=\"rounded-none bg-card bg-zinc-100 text-center dark:bg-zinc-900\">\n          <p className=\"m-auto text-center text-sm opacity-50\">\n            {currentIndex + 1} / {allImageURLs.length}\n          </p>\n        </div>\n      )}\n      <Carousel opts={{ dragFree: true }}>\n        <CarouselContent>\n          {allImageURLs.map((imageURL, index) => {\n            // é¸æŠã•ã‚ŒãŸç”»åƒã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã€å¯¾å¿œã™ã‚‹ã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨\n            const isSelected = imageURL === selectedImage\n            const imageClassName = isSelected\n              ? \"w-40 h-16 cursor-pointer object-cover border-2 border-clear-bright-blue m-auto\"\n              : \"w-40 h-16 cursor-pointer object-cover border-2 border-transparent m-auto\"\n\n            return (\n              <CarouselItem\n                // biome-ignore lint/suspicious/noArrayIndexKey: <explanation>\n                key={index}\n                className={\"basis-1/8\"}\n              >\n                <img\n                  className={imageClassName}\n                  alt=\"\"\n                  key={imageURL}\n                  src={imageURL}\n                  onClick={() => onSelectImage(imageURL)}\n                  onKeyUp={(event) => handleKeyPress(imageURL, event)}\n                  // biome-ignore lint/a11y/noNoninteractiveTabindex: <explanation>\n                  tabIndex={0}\n                />\n              </CarouselItem>\n            )\n          })}\n        </CarouselContent>\n        {/* <div className=\"absolute top-0 left-0 h-full w-16 bg-linear-to-r from-card to-transparent\" /> */}\n        <CarouselPrevious className=\"absolute left-0\" />\n        {/* <div className=\"absolute top-0 right-0 h-full w-16 bg-linear-to-r from-transparent to-card\" /> */}\n        <CarouselNext className=\"absolute right-0\" />\n      </Carousel>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.posts.$post._index/components/work-markdown-view.tsx"},"span":[2772,2785],"sourceCode":"import { EditorContent, useEditor } from \"@tiptap/react\"\nimport StarterKit from \"@tiptap/starter-kit\"\nimport { Markdown } from \"tiptap-markdown\"\nimport CodeBlock from \"@tiptap/extension-code-block\"\nimport Blockquote from \"@tiptap/extension-blockquote\"\nimport HorizontalRule from \"@tiptap/extension-horizontal-rule\"\nimport Image from \"@tiptap/extension-image\"\nimport { useEffect } from \"react\"\n\ntype Props = {\n  md?: string\n  html?: string\n  thumbnailUrl: string\n  title: string\n}\n\nexport function WorkMarkdownView (props: Props) {\n  const editor = useEditor({\n    editable: false,\n    editorProps: {\n      attributes: {\n        class:\n          \"prose dark:prose-invert max-w-full min-h-[150px] w-full border-none bg-transparent px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-hidden disabled:cursor-not-allowed disabled:opacity-50 overflow-auto\",\n      },\n    },\n    immediatelyRender: false,\n    shouldRerenderOnTransaction: false,\n    extensions: [\n      StarterKit.configure({\n        orderedList: {\n          HTMLAttributes: {\n            class: \"list-decimal pl-4\",\n          },\n        },\n        bulletList: {\n          HTMLAttributes: {\n            class: \"list-disc pl-4\",\n          },\n        },\n      }),\n      Markdown,\n      Image.configure({\n        inline: true,\n        allowBase64: true,\n      }),\n      CodeBlock.configure({\n        HTMLAttributes: {\n          class: \"bg-gray-800 text-white text-sm p-2 rounded-md\",\n          languageClassPrefix: \"language-\",\n        },\n      }),\n      Blockquote,\n      HorizontalRule,\n    ],\n    content: props.md,\n  })\n\n  useEffect(() => {\n    if (editor && editor.getText() === \"\") {\n      editor.commands.setContent(props.md || \"\")\n    }\n  }, [props.md, editor])\n\n  return (\n    <div className=\"relative m-0\">\n      <div className=\"relative h-64 w-full overflow-hidden rounded-lg md:h-80\">\n        <img\n          src={props.thumbnailUrl}\n          alt=\"Thumbnail Background\"\n          className=\"absolute inset-0 h-full w-full object-cover\"\n        />\n        <div className=\"relative flex h-full w-full items-center justify-center bg-black bg-opacity-40\">\n          <img\n            src={props.thumbnailUrl}\n            alt=\"Thumbnail Foreground\"\n            className=\"h-3/4 w-3/4 object-contain\"\n          />\n          <div className=\"absolute right-4 bottom-4 left-4 rounded-lg bg-black bg-opacity-50 p-4 text-center font-bold text-2xl text-white md:text-4xl\">\n            {props.title}\n          </div>\n        </div>\n      </div>\n      <div className=\"mt-4 rounded-lg bg-white p-4 dark:bg-zinc-900\">\n        <EditorContent editor={editor} />\n      </div>\n      {props.html && (\n        <div\n          // biome-ignore lint/security/noDangerouslySetInnerHtml: <explanation>\n          dangerouslySetInnerHTML={{\n            __html: props.html\n              .replace(/&quot;/g, '\"') // &quot; ã‚’ \" ã«ç½®æ›\n              .replace(/\\\\\"/g, '\"'), // \\\\\" ã‚’ \" ã«ç½®æ›\n          }}\n        />\n      )}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable data is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"data"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.posts.$post._index/components/work-tags-works.tsx"},"span":[1807,1811],"sourceCode":"import { useQuery } from \"@apollo/client/index\"\nimport {\n  useCallback,\n  useContext,\n  useMemo,\n  useState,\n  Suspense,\n  type CSSProperties,\n} from \"react\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport {\n  ResponsivePhotoWorksAlbum,\n  PhotoAlbumWorkFragment,\n} from \"~/components/responsive-photo-works-album\"\nimport { Loader2Icon } from \"lucide-react\"\nimport { useInfiniteScroll } from \"~/routes/($lang)._main._index/hooks/use-infinite-scroll\"\n\nconst PER_PAGE = 32\n\n/* â”€â”€â”€ GraphQL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\nconst TagsWorkFragment = graphql(\n  `fragment TagsWork on WorkNode @_unmask {\n    ...PhotoAlbumWork\n  }`,\n  [PhotoAlbumWorkFragment],\n)\n\nconst worksQuery = graphql(\n  `query WorksByTag(\n    $offset: Int!\n    $limit: Int!\n    $where: WorksWhereInput\n  ) {\n    tagWorks(offset: $offset, limit: $limit, where: $where) {\n      ...TagsWork\n    }\n  }`,\n  [TagsWorkFragment],\n)\n\n/* â”€â”€â”€ Component â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\ntype Props = {\n  tagName: string\n  rating: \"G\" | \"R15\" | \"R18\" | \"R18G\"\n}\n\nexport function WorkTagsWorks ({ tagName, rating }: Props) {\n  const auth = useContext(AuthContext)\n  const [pages, setPages] = useState<\n    FragmentOf<typeof PhotoAlbumWorkFragment>[][]\n  >([])\n  const [isLoadingMore, setIsLoadingMore] = useState(false)\n\n  /* where å¥ã¯ useMemo ã§å›ºå®š */\n  const where = useMemo(\n    () => ({\n      tagNames: [tagName],\n      ratings: [rating],\n      isNowCreatedAt: true,\n    }),\n    [tagName, rating],\n  )\n\n  /* åˆå›å–å¾— */\n  const { data, loading, fetchMore } = useQuery(worksQuery, {\n    skip: auth.isLoading,\n    variables: { offset: 0, limit: PER_PAGE, where },\n    fetchPolicy: \"cache-first\",\n    nextFetchPolicy: \"cache-first\",\n    onCompleted(res) {\n      setPages([res.tagWorks]) // 1 ãƒšãƒ¼ã‚¸ç›®ã‚’ä¿å­˜\n    },\n  })\n\n  /* hasNext åˆ¤å®š */\n  const lastPage = pages.at(-1) ?? []\n  const hasNext = lastPage.length >= PER_PAGE - 8\n\n  /* è¿½åŠ ãƒ­ãƒ¼ãƒ‰ */\n  const loadMore = useCallback(async () => {\n    if (loading || isLoadingMore || !hasNext) return\n    setIsLoadingMore(true)\n    try {\n      const res = await fetchMore({\n        variables: { offset: pages.flat().length, limit: PER_PAGE, where },\n      })\n      if (res.data?.tagWorks?.length) {\n        setPages((prev) => [...prev, res.data.tagWorks])\n      }\n    } finally {\n      setIsLoadingMore(false)\n    }\n  }, [loading, isLoadingMore, hasNext, fetchMore, pages, where])\n\n  /* IntersectionObserver */\n  const sentinelRef = useInfiniteScroll(loadMore, {\n    hasNext,\n    loading,\n  })\n\n  /* UI */\n  if (auth.isLoading || loading) return <CenteredLoader />\n  if (!pages.flat().length) return <NoData />\n\n  return (\n    <div className=\"space-y-8\">\n      {pages.map((works, idx) => (\n        <div key={idx.toString()}>\n          <Suspense fallback={<CenteredLoader />}>\n            <ResponsivePhotoWorksAlbum\n              works={\n                works as unknown as FragmentOf<typeof PhotoAlbumWorkFragment>[]\n              }\n              isShowProfile\n            />\n          </Suspense>\n        </div>\n      ))}\n\n      {hasNext && (\n        <div ref={sentinelRef} style={{ height: 1 } as CSSProperties} />\n      )}\n      {isLoadingMore && <CenteredLoader />}\n    </div>\n  )\n}\n\n/* â”€â”€â”€ Sub-components â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\nfunction CenteredLoader() {\n  return (\n    <div className=\"flex justify-center py-4\">\n      <Loader2Icon className=\"size-6 animate-spin text-border\" />\n    </div>\n  )\n}\n\nfunction NoData() {\n  return (\n    <div className=\"flex h-40 items-center justify-center text-muted-foreground text-sm\">\n      <p>è©²å½“ã™ã‚‹ä½œå“ãŒã‚ã‚Šã¾ã›ã‚“</p>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/suspicious/noExplicitAny","severity":"warning","description":"Unexpected any. Specify a different type.","message":[{"elements":[],"content":"Unexpected "},{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":". Specify a different type."}],"advices":{"advices":[{"log":["info",[{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":" disables many type checking rules. Its use should be avoided."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.posts.$post.draft/components/draft-work-container.tsx"},"span":[3800,3803],"sourceCode":"import {\n  workArticleFragment,\n  sensitiveWorkArticleFragment,\n} from \"~/routes/($lang)._main.posts.$post._index/components/work-article\"\nimport { WorkUser } from \"~/routes/($lang)._main.posts.$post._index/components/work-user\"\nimport { useContext } from \"react\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport { WorkRelatedList } from \"~/routes/($lang)._main.posts.$post._index/components/work-related-list\"\nimport { WorkTagsWorks } from \"~/routes/($lang)._main.posts.$post._index/components/work-tags-works\"\nimport { WorkNextAndPrevious } from \"~/routes/($lang)._main.posts.$post._index/components/work-next-and-previous\"\nimport {\n  type CommentListItemFragment,\n  WorkCommentList,\n} from \"~/routes/($lang)._main.posts.$post._index/components/work-comment-list\"\nimport {\n  HomeNewCommentsSection,\n  type HomeNewCommentsFragment,\n} from \"~/routes/($lang)._main._index/components/home-new-comments\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport {\n  HomeAwardWorksSection,\n  type HomeAwardWorksFragment,\n} from \"~/routes/($lang)._main._index/components/home-award-works\"\nimport type { HomeWorkAwardFragment } from \"~/routes/($lang)._main._index/components/home-award-work-section\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { useNavigate, Link } from \"react-router-dom\"\nimport { CrossPlatformTooltip } from \"~/components/cross-platform-tooltip\"\nimport { DraftWorkArticle } from \"~/routes/($lang)._main.posts.$post.draft/components/draft-work-article\"\nimport { workCommentsQuery } from \"~/routes/($lang)._main.posts.$post._index/route\"\n\ntype Props = {\n  post: string\n  work: FragmentOf<typeof workArticleFragment> | null\n  comments: FragmentOf<typeof CommentListItemFragment>[]\n  newComments: FragmentOf<typeof HomeNewCommentsFragment>[]\n  awardWorks: FragmentOf<\n    typeof HomeAwardWorksFragment | typeof HomeWorkAwardFragment\n  >[]\n}\n\n/**\n * ä½œå“è©³ç´°æƒ…å ±\n */\nexport function DraftWorkContainer (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  const { data, refetch } = useQuery(workQuery, {\n    skip:\n      props.work?.user !== null &&\n      authContext.userId !== props.work?.user.id &&\n      authContext.isLoading,\n    variables: {\n      id: props.post,\n    },\n  })\n\n  const work = data?.work ?? props.work\n\n  const { data: workCommentsRet } = useQuery(workCommentsQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      workId: props.post,\n    },\n  })\n\n  const comments = workCommentsRet?.work?.comments ?? props.comments\n\n  const tags = work?.tagNames ?? []\n\n  const randomTag =\n    tags.length > 0 ? tags[Math.floor(Math.random() * tags.length)] : null\n\n  const _navigate = useNavigate()\n\n  const { data: pass } = useQuery(viewerCurrentPassQuery, {})\n\n  const { data: advertisements } = useQuery(randomCustomerAdvertisementQuery, {\n    variables: {\n      where: {\n        isSensitive: false,\n        page: \"work\",\n      },\n    },\n  })\n\n  const [updateClickedCountCustomerAdvertisement] = useMutation(\n    updateClickedCountCustomerAdvertisementMutation,\n  )\n\n  const onClickAdvertisement = async () => {\n    if (advertisements?.randomCustomerAdvertisement) {\n      // Update advertisement click count\n      await updateClickedCountCustomerAdvertisement({\n        variables: {\n          id: advertisements.randomCustomerAdvertisement.id,\n        },\n      })\n    }\n  }\n\n  const passData = pass?.viewer?.currentPass\n\n  const isSubscriptionUser =\n    passData?.type === \"LITE\" ||\n    passData?.type === \"STANDARD\" ||\n    passData?.type === \"PREMIUM\"\n\n  const t = useTranslation()\n\n  if (work === null) {\n    return null\n  }\n\n  const albumCandidate = (work as any).album\n  const albumForArticle =\n    albumCandidate &&\n    typeof albumCandidate === \"object\" &&\n    \"id\" in albumCandidate &&\n    \"title\" in albumCandidate &&\n    \"description\" in albumCandidate\n      ? albumCandidate\n      : null\n\n  const workForArticle = {\n    ...work,\n    album: albumForArticle,\n  }\n\n  return (\n    <div\n      className=\"space-y-4 overflow-hidden\"\n      style={{\n        margin: \"auto\",\n      }}\n    >\n      <div className=\"flex w-full justify-center overflow-hidden\">\n        <div className=\"flex w-full flex-col items-center overflow-hidden\">\n          <div className=\"mx-auto w-full space-y-4\">\n            <DraftWorkArticle work={workForArticle} />\n            {workForArticle.user && (\n              <WorkRelatedList\n                works={workForArticle.user.works.map((relatedWork) => ({\n                  smallThumbnailImageURL: relatedWork.smallThumbnailImageURL,\n                  thumbnailImagePosition:\n                    relatedWork.thumbnailImagePosition ?? 0,\n                  smallThumbnailImageWidth:\n                    relatedWork.smallThumbnailImageWidth,\n                  smallThumbnailImageHeight:\n                    relatedWork.smallThumbnailImageHeight,\n                  id: relatedWork.id,\n                  userId: relatedWork.userId,\n                  isLiked: relatedWork.isLiked,\n                  subWorksCount: relatedWork.subWorksCount,\n                  commentsCount: relatedWork.commentsCount,\n                }))}\n              />\n            )}\n            {workForArticle.isCommentsEditable && (\n              <WorkCommentList\n                workId={workForArticle.id}\n                comments={comments}\n                workOwnerIconImageURL={workForArticle.user?.iconUrl}\n                isWorkOwnerBlocked={workForArticle.user?.isBlocked ?? false}\n              />\n            )}\n            {workForArticle.user && (\n              <div className=\"block md:mt-0 lg:hidden\">\n                <WorkUser\n                  userId={workForArticle.user.id}\n                  userLogin={workForArticle.user.login}\n                  userName={workForArticle.user.name}\n                  userIconImageURL={withIconUrlFallback(\n                    workForArticle.user.iconUrl,\n                  )}\n                  userFollowersCount={workForArticle.user.followersCount}\n                  userBiography={workForArticle.user.biography ?? \"\"}\n                  userEnBiography={workForArticle.user.enBiography ?? null}\n                  userPromptonId={workForArticle.user.promptonUser?.id}\n                  userWorksCount={workForArticle.user.worksCount}\n                />\n              </div>\n            )}\n          </div>\n        </div>\n        <div className=\"mt-2 hidden w-full flex-col items-start space-y-4 pl-4 md:mt-0 md:flex md:max-w-80\">\n          {workForArticle.user && (\n            <div className=\"w-full\">\n              <WorkUser\n                userId={workForArticle.user.id}\n                userName={workForArticle.user.name}\n                userLogin={workForArticle.user.login}\n                userIconImageURL={withIconUrlFallback(\n                  workForArticle.user.iconUrl,\n                )}\n                userFollowersCount={workForArticle.user.followersCount}\n                userBiography={workForArticle.user.biography ?? \"\"}\n                userEnBiography={workForArticle.user.enBiography ?? null}\n                userPromptonId={workForArticle.user.promptonUser?.id}\n                userWorksCount={workForArticle.user.worksCount}\n              />\n            </div>\n          )}\n          <div className=\"invisible flex w-full flex-col space-y-4 md:visible\">\n            <WorkNextAndPrevious work={work} />\n            <div className=\"flex w-full flex-col space-y-4\">\n              <div className=\"relative grid gap-4\">\n                {!isSubscriptionUser &&\n                  advertisements &&\n                  advertisements.randomCustomerAdvertisement && (\n                    <div className=\"relative border\">\n                      <Link\n                        onClick={onClickAdvertisement}\n                        target=\"_blank\"\n                        to={advertisements.randomCustomerAdvertisement.url}\n                      >\n                        <img\n                          src={\n                            advertisements.randomCustomerAdvertisement.imageUrl\n                          }\n                          alt=\"Advertisement\"\n                        />\n                      </Link>\n                      <div className=\"absolute top-0 right-0\">\n                        <CrossPlatformTooltip\n                          text={t(\n                            \"ææºåºƒå‘Šã§ã™ã€åºƒå‘Šä¸»æ§˜ã‚’å‹Ÿé›†ä¸­ã§ã™ã€‚ãƒ¡ãƒ¼ãƒ«ã¾ãŸã¯DMã«ã¦ã”é€£çµ¡ãã ã•ã„ã€‚\",\n                            \"This is a partnered advertisement. We are accepting new advertisers. Please contact us via email or DM.\",\n                          )}\n                        />\n                      </div>\n                    </div>\n                  )}\n                {!isSubscriptionUser && (\n                  <Link to=\"/generation\">\n                    <img\n                      src=\"https://assets.aipictors.com/Aipictors_01.webp\"\n                      alt=\"Aipictors Logo\"\n                    />\n                  </Link>\n                )}\n                {props.newComments && props.newComments.length > 0 && (\n                  <HomeNewCommentsSection comments={props.newComments} />\n                )}\n                {props.awardWorks && (\n                  <HomeAwardWorksSection works={props.awardWorks} />\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <section className=\"m-auto space-y-4\">\n        {randomTag && (\n          <>\n            <div className=\"flex justify-between\">\n              <h2 className=\"items-center space-x-2 font-bold text-md\">\n                {t(\"ãŠã™ã™ã‚\", \"Recommended\")}\n              </h2>\n            </div>\n            <WorkTagsWorks tagName={randomTag} rating={work.rating ?? \"G\"} />\n          </>\n        )}\n      </section>\n      {/* <div className=\"flex w-full flex-col space-y-4 md:hidden\">\n        <AppSideMenu />\n      </div> */}\n    </div>\n  )\n}\n\nconst workQuery = graphql(\n  `query Work($id: ID!) {\n    work(id: $id) {\n      ...WorkArticle\n    }\n  }`,\n  [workArticleFragment],\n)\n\nconst _sensitiveWorkQuery = graphql(\n  `query Work($id: ID!) {\n    work(id: $id) {\n      ...WorkArticle\n    }\n  }`,\n  [sensitiveWorkArticleFragment],\n)\n\nconst updateClickedCountCustomerAdvertisementMutation = graphql(\n  `mutation UpdateClickedCountCustomerAdvertisement($id: ID!) {\n    updateClickedCountCustomerAdvertisement(id: $id) {\n      id\n    }\n  }`,\n)\n\nconst viewerCurrentPassQuery = graphql(\n  `query ViewerCurrentPass {\n    viewer {\n      id\n      currentPass {\n        id\n        type\n      }\n    }\n  }`,\n)\n\nexport const SideMenuAdvertisementsFragment = graphql(\n  `fragment SideMenuAdvertisementsFields on CustomerAdvertisementNode @_unmask {\n      id\n      imageUrl\n      url\n      displayProbability\n      clickCount\n      impressionCount\n      isSensitive\n      createdAt\n      page\n      startAt\n      endAt\n      isActive\n  }`,\n)\n\nconst randomCustomerAdvertisementQuery = graphql(\n  `query RandomCustomerAdvertisement($where: RandomCustomerAdvertisementWhereInput!) {\n    randomCustomerAdvertisement(where: $where) {\n      ...SideMenuAdvertisementsFields\n    }\n  }`,\n  [SideMenuAdvertisementsFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable refetch is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"refetch"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.posts.$post.draft/components/draft-work-container.tsx"},"span":[2159,2166],"sourceCode":"import {\n  workArticleFragment,\n  sensitiveWorkArticleFragment,\n} from \"~/routes/($lang)._main.posts.$post._index/components/work-article\"\nimport { WorkUser } from \"~/routes/($lang)._main.posts.$post._index/components/work-user\"\nimport { useContext } from \"react\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport { WorkRelatedList } from \"~/routes/($lang)._main.posts.$post._index/components/work-related-list\"\nimport { WorkTagsWorks } from \"~/routes/($lang)._main.posts.$post._index/components/work-tags-works\"\nimport { WorkNextAndPrevious } from \"~/routes/($lang)._main.posts.$post._index/components/work-next-and-previous\"\nimport {\n  type CommentListItemFragment,\n  WorkCommentList,\n} from \"~/routes/($lang)._main.posts.$post._index/components/work-comment-list\"\nimport {\n  HomeNewCommentsSection,\n  type HomeNewCommentsFragment,\n} from \"~/routes/($lang)._main._index/components/home-new-comments\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport {\n  HomeAwardWorksSection,\n  type HomeAwardWorksFragment,\n} from \"~/routes/($lang)._main._index/components/home-award-works\"\nimport type { HomeWorkAwardFragment } from \"~/routes/($lang)._main._index/components/home-award-work-section\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { useNavigate, Link } from \"react-router-dom\"\nimport { CrossPlatformTooltip } from \"~/components/cross-platform-tooltip\"\nimport { DraftWorkArticle } from \"~/routes/($lang)._main.posts.$post.draft/components/draft-work-article\"\nimport { workCommentsQuery } from \"~/routes/($lang)._main.posts.$post._index/route\"\n\ntype Props = {\n  post: string\n  work: FragmentOf<typeof workArticleFragment> | null\n  comments: FragmentOf<typeof CommentListItemFragment>[]\n  newComments: FragmentOf<typeof HomeNewCommentsFragment>[]\n  awardWorks: FragmentOf<\n    typeof HomeAwardWorksFragment | typeof HomeWorkAwardFragment\n  >[]\n}\n\n/**\n * ä½œå“è©³ç´°æƒ…å ±\n */\nexport function DraftWorkContainer (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  const { data, refetch } = useQuery(workQuery, {\n    skip:\n      props.work?.user !== null &&\n      authContext.userId !== props.work?.user.id &&\n      authContext.isLoading,\n    variables: {\n      id: props.post,\n    },\n  })\n\n  const work = data?.work ?? props.work\n\n  const { data: workCommentsRet } = useQuery(workCommentsQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      workId: props.post,\n    },\n  })\n\n  const comments = workCommentsRet?.work?.comments ?? props.comments\n\n  const tags = work?.tagNames ?? []\n\n  const randomTag =\n    tags.length > 0 ? tags[Math.floor(Math.random() * tags.length)] : null\n\n  const _navigate = useNavigate()\n\n  const { data: pass } = useQuery(viewerCurrentPassQuery, {})\n\n  const { data: advertisements } = useQuery(randomCustomerAdvertisementQuery, {\n    variables: {\n      where: {\n        isSensitive: false,\n        page: \"work\",\n      },\n    },\n  })\n\n  const [updateClickedCountCustomerAdvertisement] = useMutation(\n    updateClickedCountCustomerAdvertisementMutation,\n  )\n\n  const onClickAdvertisement = async () => {\n    if (advertisements?.randomCustomerAdvertisement) {\n      // Update advertisement click count\n      await updateClickedCountCustomerAdvertisement({\n        variables: {\n          id: advertisements.randomCustomerAdvertisement.id,\n        },\n      })\n    }\n  }\n\n  const passData = pass?.viewer?.currentPass\n\n  const isSubscriptionUser =\n    passData?.type === \"LITE\" ||\n    passData?.type === \"STANDARD\" ||\n    passData?.type === \"PREMIUM\"\n\n  const t = useTranslation()\n\n  if (work === null) {\n    return null\n  }\n\n  const albumCandidate = (work as any).album\n  const albumForArticle =\n    albumCandidate &&\n    typeof albumCandidate === \"object\" &&\n    \"id\" in albumCandidate &&\n    \"title\" in albumCandidate &&\n    \"description\" in albumCandidate\n      ? albumCandidate\n      : null\n\n  const workForArticle = {\n    ...work,\n    album: albumForArticle,\n  }\n\n  return (\n    <div\n      className=\"space-y-4 overflow-hidden\"\n      style={{\n        margin: \"auto\",\n      }}\n    >\n      <div className=\"flex w-full justify-center overflow-hidden\">\n        <div className=\"flex w-full flex-col items-center overflow-hidden\">\n          <div className=\"mx-auto w-full space-y-4\">\n            <DraftWorkArticle work={workForArticle} />\n            {workForArticle.user && (\n              <WorkRelatedList\n                works={workForArticle.user.works.map((relatedWork) => ({\n                  smallThumbnailImageURL: relatedWork.smallThumbnailImageURL,\n                  thumbnailImagePosition:\n                    relatedWork.thumbnailImagePosition ?? 0,\n                  smallThumbnailImageWidth:\n                    relatedWork.smallThumbnailImageWidth,\n                  smallThumbnailImageHeight:\n                    relatedWork.smallThumbnailImageHeight,\n                  id: relatedWork.id,\n                  userId: relatedWork.userId,\n                  isLiked: relatedWork.isLiked,\n                  subWorksCount: relatedWork.subWorksCount,\n                  commentsCount: relatedWork.commentsCount,\n                }))}\n              />\n            )}\n            {workForArticle.isCommentsEditable && (\n              <WorkCommentList\n                workId={workForArticle.id}\n                comments={comments}\n                workOwnerIconImageURL={workForArticle.user?.iconUrl}\n                isWorkOwnerBlocked={workForArticle.user?.isBlocked ?? false}\n              />\n            )}\n            {workForArticle.user && (\n              <div className=\"block md:mt-0 lg:hidden\">\n                <WorkUser\n                  userId={workForArticle.user.id}\n                  userLogin={workForArticle.user.login}\n                  userName={workForArticle.user.name}\n                  userIconImageURL={withIconUrlFallback(\n                    workForArticle.user.iconUrl,\n                  )}\n                  userFollowersCount={workForArticle.user.followersCount}\n                  userBiography={workForArticle.user.biography ?? \"\"}\n                  userEnBiography={workForArticle.user.enBiography ?? null}\n                  userPromptonId={workForArticle.user.promptonUser?.id}\n                  userWorksCount={workForArticle.user.worksCount}\n                />\n              </div>\n            )}\n          </div>\n        </div>\n        <div className=\"mt-2 hidden w-full flex-col items-start space-y-4 pl-4 md:mt-0 md:flex md:max-w-80\">\n          {workForArticle.user && (\n            <div className=\"w-full\">\n              <WorkUser\n                userId={workForArticle.user.id}\n                userName={workForArticle.user.name}\n                userLogin={workForArticle.user.login}\n                userIconImageURL={withIconUrlFallback(\n                  workForArticle.user.iconUrl,\n                )}\n                userFollowersCount={workForArticle.user.followersCount}\n                userBiography={workForArticle.user.biography ?? \"\"}\n                userEnBiography={workForArticle.user.enBiography ?? null}\n                userPromptonId={workForArticle.user.promptonUser?.id}\n                userWorksCount={workForArticle.user.worksCount}\n              />\n            </div>\n          )}\n          <div className=\"invisible flex w-full flex-col space-y-4 md:visible\">\n            <WorkNextAndPrevious work={work} />\n            <div className=\"flex w-full flex-col space-y-4\">\n              <div className=\"relative grid gap-4\">\n                {!isSubscriptionUser &&\n                  advertisements &&\n                  advertisements.randomCustomerAdvertisement && (\n                    <div className=\"relative border\">\n                      <Link\n                        onClick={onClickAdvertisement}\n                        target=\"_blank\"\n                        to={advertisements.randomCustomerAdvertisement.url}\n                      >\n                        <img\n                          src={\n                            advertisements.randomCustomerAdvertisement.imageUrl\n                          }\n                          alt=\"Advertisement\"\n                        />\n                      </Link>\n                      <div className=\"absolute top-0 right-0\">\n                        <CrossPlatformTooltip\n                          text={t(\n                            \"ææºåºƒå‘Šã§ã™ã€åºƒå‘Šä¸»æ§˜ã‚’å‹Ÿé›†ä¸­ã§ã™ã€‚ãƒ¡ãƒ¼ãƒ«ã¾ãŸã¯DMã«ã¦ã”é€£çµ¡ãã ã•ã„ã€‚\",\n                            \"This is a partnered advertisement. We are accepting new advertisers. Please contact us via email or DM.\",\n                          )}\n                        />\n                      </div>\n                    </div>\n                  )}\n                {!isSubscriptionUser && (\n                  <Link to=\"/generation\">\n                    <img\n                      src=\"https://assets.aipictors.com/Aipictors_01.webp\"\n                      alt=\"Aipictors Logo\"\n                    />\n                  </Link>\n                )}\n                {props.newComments && props.newComments.length > 0 && (\n                  <HomeNewCommentsSection comments={props.newComments} />\n                )}\n                {props.awardWorks && (\n                  <HomeAwardWorksSection works={props.awardWorks} />\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <section className=\"m-auto space-y-4\">\n        {randomTag && (\n          <>\n            <div className=\"flex justify-between\">\n              <h2 className=\"items-center space-x-2 font-bold text-md\">\n                {t(\"ãŠã™ã™ã‚\", \"Recommended\")}\n              </h2>\n            </div>\n            <WorkTagsWorks tagName={randomTag} rating={work.rating ?? \"G\"} />\n          </>\n        )}\n      </section>\n      {/* <div className=\"flex w-full flex-col space-y-4 md:hidden\">\n        <AppSideMenu />\n      </div> */}\n    </div>\n  )\n}\n\nconst workQuery = graphql(\n  `query Work($id: ID!) {\n    work(id: $id) {\n      ...WorkArticle\n    }\n  }`,\n  [workArticleFragment],\n)\n\nconst _sensitiveWorkQuery = graphql(\n  `query Work($id: ID!) {\n    work(id: $id) {\n      ...WorkArticle\n    }\n  }`,\n  [sensitiveWorkArticleFragment],\n)\n\nconst updateClickedCountCustomerAdvertisementMutation = graphql(\n  `mutation UpdateClickedCountCustomerAdvertisement($id: ID!) {\n    updateClickedCountCustomerAdvertisement(id: $id) {\n      id\n    }\n  }`,\n)\n\nconst viewerCurrentPassQuery = graphql(\n  `query ViewerCurrentPass {\n    viewer {\n      id\n      currentPass {\n        id\n        type\n      }\n    }\n  }`,\n)\n\nexport const SideMenuAdvertisementsFragment = graphql(\n  `fragment SideMenuAdvertisementsFields on CustomerAdvertisementNode @_unmask {\n      id\n      imageUrl\n      url\n      displayProbability\n      clickCount\n      impressionCount\n      isSensitive\n      createdAt\n      page\n      startAt\n      endAt\n      isActive\n  }`,\n)\n\nconst randomCustomerAdvertisementQuery = graphql(\n  `query RandomCustomerAdvertisement($where: RandomCustomerAdvertisementWhereInput!) {\n    randomCustomerAdvertisement(where: $where) {\n      ...SideMenuAdvertisementsFields\n    }\n  }`,\n  [SideMenuAdvertisementsFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/style/noNonNullAssertion","severity":"warning","description":"Forbidden non-null assertion.","message":[{"elements":[],"content":"Forbidden non-null assertion."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.posts.$post.image.edit._index/components/bot-grading-request-button.tsx"},"span":[6046,6062],"sourceCode":"import { useState, useContext, useId } from \"react\"\nimport { Button } from \"~/components/ui/button\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { Label } from \"~/components/ui/label\"\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"~/components/ui/select\"\nimport { toast } from \"sonner\"\nimport { Sparkles, Loader2Icon, CheckCircle } from \"lucide-react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { resizeImage } from \"~/utils/resize-image\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { getBase64FromImageUrl } from \"~/utils/get-base64-from-image-url\"\n\ntype BotPersonalityType = \"female\" | \"male\" | \"robot\" | \"sage\" | \"pictor_chan\"\ntype BotGradingType = \"COMMENT_ONLY\" | \"SCORE_ONLY\" | \"COMMENT_AND_SCORE\"\n\ntype Props = {\n  workId: string\n  isAlreadyRequested?: boolean\n  isAlreadyEvaluated?: boolean\n  isBotGradingEnabled?: boolean\n  currentBotGradingPublic?: boolean\n  currentBotGradingRankingEnabled?: boolean\n  smallThumbnailImageURL?: string\n  userToken?: string | null\n}\n\n// RequestWorkBotGradingMutation ã®å®šç¾©\nconst RequestWorkBotGradingMutation = graphql(\n  `mutation RequestWorkBotGrading($input: RequestWorkBotGradingInput!) {\n    requestWorkBotGrading(input: $input) {\n      id\n      title\n      isBotGradingEnabled\n      botEvaluation {\n        overallScore\n        comment\n      }\n    }\n  }`,\n)\n\n/**\n * Botè©•ä¾¡ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœã‚¿ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ\n * ä½œå“ã®ç·¨é›†ç”»é¢ã§Botè©•ä¾¡ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ãã‚‹\n */\nexport function BotGradingRequestButton (props: Props) {\n  const t = useTranslation()\n  const authContext = useContext(AuthContext)\n\n  const [requestBotGrading, { loading: isLoading }] = useMutation(\n    RequestWorkBotGradingMutation,\n  )\n\n  const botGradingPublicId = useId()\n  const botGradingRankingId = useId()\n\n  const [isDialogOpen, setIsDialogOpen] = useState(false)\n  const [isBotGradingPublic, setIsBotGradingPublic] = useState(\n    props.currentBotGradingPublic ?? true,\n  )\n  const [isBotGradingRankingEnabled, setIsBotGradingRankingEnabled] = useState(\n    props.currentBotGradingRankingEnabled ?? false,\n  )\n  const [botPersonality, setBotPersonality] =\n    useState<BotPersonalityType>(\"female\")\n  const [botGradingType, setBotGradingType] =\n    useState<BotGradingType>(\"COMMENT_AND_SCORE\")\n\n  // ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã„å ´åˆã¯è¡¨ç¤ºã—ãªã„\n  if (!authContext.isLoggedIn) {\n    return null\n  }\n\n  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒˆãƒ¼ã‚¯ãƒ³ãŒãªã„å ´åˆã¯è¡¨ç¤ºã—ãªã„\n  if (!props.userToken) {\n    return (\n      <div className=\"flex items-center gap-2 rounded-lg bg-yellow-50 p-3 dark:bg-yellow-950/20\">\n        <Sparkles className=\"h-5 w-5 text-yellow-600\" />\n        <span className=\"text-sm text-yellow-800 dark:text-yellow-200\">\n          {t(\n            \"èªè¨¼æƒ…å ±ãŒä¸è¶³ã—ã¦ã„ã¾ã™ã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚\",\n            \"Authentication information is missing. Please reload the page.\",\n          )}\n        </span>\n      </div>\n    )\n  }\n\n  // ã™ã§ã«è©•ä¾¡æ¸ˆã¿ã®å ´åˆ\n  if (props.isAlreadyEvaluated) {\n    return (\n      <div className=\"flex items-center gap-2 rounded-lg bg-green-50 p-3 dark:bg-green-950/20\">\n        <CheckCircle className=\"h-5 w-5 text-green-600\" />\n        <span className=\"text-green-800 text-sm dark:text-green-200\">\n          {t(\n            \"ã“ã®ä½œå“ã¯ã™ã§ã«AIè©•ä¾¡ãŒå®Œäº†ã—ã¦ã„ã¾ã™\",\n            \"This work has already been evaluated by AI\",\n          )}\n        </span>\n      </div>\n    )\n  }\n\n  // ã™ã§ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ¸ˆã¿ã®å ´åˆ\n  if (props.isAlreadyRequested || props.isBotGradingEnabled) {\n    return (\n      <div className=\"flex items-center gap-2 rounded-lg bg-blue-50 p-3 dark:bg-blue-950/20\">\n        <Loader2Icon className=\"h-5 w-5 animate-spin text-blue-600\" />\n        <span className=\"text-blue-800 text-sm dark:text-blue-200\">\n          {t(\n            \"AIè©•ä¾¡ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¸­ã§ã™\",\n            \"AI evaluation request is in progress\",\n          )}\n        </span>\n      </div>\n    )\n  }\n\n  const personalityOptions = [\n    {\n      value: \"female\",\n      label: t(\"å¥³æ€§\", \"Female\"),\n      icon: \"https://assets.aipictors.com/girl-icon_11zon.webp\",\n    },\n    {\n      value: \"male\",\n      label: t(\"ç”·æ€§\", \"Male\"),\n      icon: \"https://assets.aipictors.com/man-icon_11zon.webp\",\n    },\n    {\n      value: \"robot\",\n      label: t(\"ãƒ­ãƒœãƒƒãƒˆ\", \"Robot\"),\n      icon: \"https://assets.aipictors.com/robot-icon_11zon.webp\",\n    },\n    {\n      value: \"sage\",\n      label: t(\"è³¢äºº\", \"Sage\"),\n      icon: \"https://assets.aipictors.com/kenjin-icon_11zon.webp\",\n    },\n    {\n      value: \"pictor_chan\",\n      label: t(\"ã´ããŸãƒ¼ã¡ã‚ƒã‚“\", \"Pictor-chan\"),\n      icon: \"https://assets.aipictors.com/pictorchan-icon_11zon.webp\",\n    },\n  ] as const\n\n  const gradingTypeOptions = [\n    { value: \"COMMENT_ONLY\", label: t(\"ã‚³ãƒ¡ãƒ³ãƒˆã®ã¿\", \"Comment Only\") },\n    { value: \"SCORE_ONLY\", label: t(\"æ¡ç‚¹ã®ã¿\", \"Score Only\") },\n    {\n      value: \"COMMENT_AND_SCORE\",\n      label: t(\"ã‚³ãƒ¡ãƒ³ãƒˆã¨æ¡ç‚¹ä¸¡æ–¹\", \"Comment and Score\"),\n    },\n  ] as const\n\n  const handleRequest = async () => {\n    try {\n      if (!props.smallThumbnailImageURL) {\n        throw new Error(\"Thumbnail image URL is required\")\n      }\n\n      // ç”»åƒã‚’Base64ã«å¤‰æ›\n      const base64Image = await getBase64FromImageUrl(\n        props.smallThumbnailImageURL,\n      )\n\n      // ç”»åƒã‚’JPEGã«ãƒªã‚µã‚¤ã‚ºï¼ˆ400xï¼‰\n      const resizedBase64 = await resizeImage(base64Image, 400)\n\n      console.log(\" props.userToken\", props.userToken)\n\n      // ãƒªã‚µã‚¤ã‚ºã•ã‚ŒãŸç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰\n      const uploadedImageUrl = await uploadPublicImage(\n        resizedBase64.base64,\n        props.userToken!,\n      )\n\n      // å®Ÿéš›ã®GraphQL mutationã‚’å®Ÿè¡Œ\n      const result = await requestBotGrading({\n        variables: {\n          // @ts-ignore\n          input: {\n            workId: props.workId,\n            imageUrl: uploadedImageUrl,\n            isBotGradingPublic,\n            isBotGradingRankingEnabled,\n            botPersonality,\n            botGradingType,\n          },\n        },\n      })\n\n      if (result.data?.requestWorkBotGrading) {\n        toast(\n          t(\"AIè©•ä¾¡ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ã¾ã—ãŸ\", \"AI evaluation has been requested\"),\n        )\n        setIsDialogOpen(false)\n\n        // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æ›´æ–°ã«ã‚ˆã‚Šã€ç”»é¢ã®å†èª­ã¿è¾¼ã¿ãªã—ã§çŠ¶æ…‹ã‚’åæ˜ \n        // Apollo Clientã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒè‡ªå‹•çš„ã«æ›´æ–°ã•ã‚Œã‚‹\n      } else {\n        throw new Error(\"No data returned from mutation\")\n      }\n    } catch (error) {\n      console.error(\"Failed to request bot grading:\", error)\n\n      let errorMessage = t(\n        \"AIè©•ä¾¡ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ\",\n        \"Failed to request AI evaluation\",\n      )\n\n      if (error instanceof Error) {\n        // GraphQLã‚¨ãƒ©ãƒ¼ã‚„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ãªã©å…·ä½“çš„ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º\n        errorMessage = error.message\n      }\n\n      toast(errorMessage)\n    }\n  }\n\n  return (\n    <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n      <DialogTrigger asChild>\n        <Button variant=\"outline\" className=\"flex items-center gap-2\">\n          <Sparkles className=\"h-4 w-4\" />\n          <span>{t(\"AIè©•ä¾¡ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆ\", \"Request AI Evaluation\")}</span>\n        </Button>\n      </DialogTrigger>\n\n      <DialogContent className=\"max-w-md\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Sparkles className=\"h-5 w-5\" />\n            {t(\"AIè©•ä¾¡ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆ\", \"Request AI Evaluation\")}\n          </DialogTitle>\n          <DialogDescription>\n            {t(\n              \"AIãŒä½œå“ã‚’è‡ªå‹•ã§è©•ä¾¡ã—ã€ã‚³ãƒ¡ãƒ³ãƒˆã‚„æ¡ç‚¹ã‚’è¡Œã„ã¾ã™ã€‚\",\n              \"AI will automatically evaluate your work and provide comments or scores.\",\n            )}\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4\">\n          {/* AIæ€§æ ¼é¸æŠ */}\n          <div className=\"space-y-2\">\n            <Label>{t(\"AIã®æ€§æ ¼\", \"AI Personality\")}</Label>\n            <Select\n              value={botPersonality}\n              onValueChange={(value) =>\n                setBotPersonality(value as BotPersonalityType)\n              }\n            >\n              <SelectTrigger>\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                {personalityOptions.map((option) => (\n                  <SelectItem key={option.value} value={option.value}>\n                    <div className=\"flex items-center space-x-2\">\n                      <img\n                        src={option.icon}\n                        alt={option.label}\n                        className=\"h-4 w-4 rounded-full object-cover\"\n                      />\n                      <span>{option.label}</span>\n                    </div>\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n\n          {/* æ¡ç‚¹ã‚¿ã‚¤ãƒ—é¸æŠ */}\n          <div className=\"space-y-2\">\n            <Label>{t(\"æ¡ç‚¹ã‚¿ã‚¤ãƒ—\", \"Grading Type\")}</Label>\n            <Select\n              value={botGradingType}\n              onValueChange={(value) =>\n                setBotGradingType(value as BotGradingType)\n              }\n            >\n              <SelectTrigger>\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                {gradingTypeOptions.map((option) => (\n                  <SelectItem key={option.value} value={option.value}>\n                    {option.label}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n\n          {/* å…¬é–‹è¨­å®š */}\n          <div className=\"flex items-center space-x-2\">\n            <Checkbox\n              id={botGradingPublicId}\n              checked={isBotGradingPublic}\n              onCheckedChange={(checked) =>\n                setIsBotGradingPublic(checked === true)\n              }\n            />\n            <Label htmlFor={botGradingPublicId}>\n              {t(\"AIè©•ä¾¡ã‚’å…¬é–‹ã™ã‚‹\", \"Make AI evaluation public\")}\n            </Label>\n          </div>\n\n          {/* ãƒ©ãƒ³ã‚­ãƒ³ã‚°å‚åŠ è¨­å®š */}\n          <div className=\"flex items-center space-x-2\">\n            <Checkbox\n              id={botGradingRankingId}\n              checked={isBotGradingRankingEnabled}\n              onCheckedChange={(checked) =>\n                setIsBotGradingRankingEnabled(checked === true)\n              }\n            />\n            <Label htmlFor={botGradingRankingId}>\n              {t(\n                \"AIè©•ä¾¡ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã«å‚åŠ ã™ã‚‹\",\n                \"Participate in AI grading ranking\",\n              )}\n            </Label>\n          </div>\n        </div>\n\n        <DialogFooter>\n          <Button\n            variant=\"outline\"\n            onClick={() => setIsDialogOpen(false)}\n            disabled={isLoading}\n          >\n            {t(\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\", \"Cancel\")}\n          </Button>\n          <Button onClick={handleRequest} disabled={isLoading}>\n            {isLoading ? (\n              <>\n                <Loader2Icon className=\"mr-2 h-4 w-4 animate-spin\" />\n                {t(\"ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¸­...\", \"Requesting...\")}\n              </>\n            ) : (\n              <>\n                <Sparkles className=\"mr-2 h-4 w-4\" />\n                {t(\"ãƒªã‚¯ã‚¨ã‚¹ãƒˆ\", \"Request\")}\n              </>\n            )}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable isUpdatedLoading is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"isUpdatedLoading"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.posts.$post.text.edit._index/route.tsx"},"span":[11598,11614],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { deleteUploadedImage } from \"~/utils/delete-uploaded-image\"\nimport { getSizeFromBase64 } from \"~/utils/get-size-from-base64\"\nimport { resizeImage } from \"~/utils/resize-image\"\nimport { sha256 } from \"~/utils/sha256\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { CreatingWorkDialog } from \"~/routes/($lang)._main.new.image/components/creating-work-dialog\"\nimport { SuccessCreatedWorkDialog } from \"~/routes/($lang)._main.new.image/components/success-created-work-dialog\"\nimport { useQuery, useMutation } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { useContext, useEffect, useReducer, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { safeParse } from \"valibot\"\nimport type { HeadersFunction, LoaderFunctionArgs } from \"@remix-run/cloudflare\"\nimport { useBeforeUnload, useLoaderData } from \"@remix-run/react\"\nimport { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport React from \"react\"\nimport { EditTextFormUploader } from \"~/routes/($lang)._main.posts.$post.text.edit._index/components/edit-text-form-uploader\"\nimport { postTextFormInputReducer } from \"~/routes/($lang)._main.new.text/reducers/post-text-form-input-reducer\"\nimport {\n  PostTextFormAiModelFragment,\n  PostTextFormAlbumFragment,\n  PostTextFormInput,\n  PostTextFormPassFragment,\n  PostTextFormRecentlyUsedTagsFragment,\n} from \"~/routes/($lang)._main.new.image/components/post-text-form-input\"\nimport { postTextFormReducer } from \"~/routes/($lang)._main.new.text/reducers/post-text-form-reducer\"\nimport { vPostTextForm } from \"~/routes/($lang)._main.new.image/validations/post-text-form\"\nimport { getJstDate } from \"~/utils/jst-date\"\nimport { uploadTextFile } from \"~/utils/upload-text-file\"\n\nexport async function loader(props: LoaderFunctionArgs) {\n  if (props.params.post === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  return {\n    id: props.params.post,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  // ç·¨é›†ç”»é¢ãªã®ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nfunction getReservationDetails(createdAt: number) {\n  // ç¾åœ¨æ™‚åˆ»ã‚ˆã‚Šã‚‚æœªæ¥ã®æ™‚åˆ»ãªã‚‰äºˆç´„æ›´æ–°ã®æ—¥ä»˜ã¨æ™‚é–“ã‚’ã‚»ãƒƒãƒˆ\n  if (createdAt) {\n    const reservedDate = new Date(createdAt * 1000 + 3600000 * 9) // æ—¥æœ¬æ™‚é–“ã«å¤‰æ›\n    const now = new Date(Date.now() + 3600000 * 9) // æ—¥æœ¬æ™‚é–“ã®ç¾åœ¨æ™‚åˆ»\n\n    if (reservedDate > now) {\n      const reservationDate = reservedDate\n        .toISOString()\n        .slice(0, 10)\n        .replace(/-/g, \"-\")\n      const reservationTime = reservedDate.toISOString().slice(11, 16)\n\n      return {\n        reservationDate,\n        reservationTime,\n      }\n    }\n  }\n  return {\n    reservationDate: null,\n    reservationTime: null,\n  }\n}\n\nexport default function EditText () {\n  const authContext = useContext(AuthContext)\n\n  const data = useLoaderData<typeof loader>()\n\n  const { data: workWithAuth = null } = useQuery(workQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      id: data.id,\n    },\n  })\n\n  const work = workWithAuth?.work ?? null\n\n  const [markdownContent, setMarkdownContent] = useState<string>(\"\")\n\n  useEffect(() => {\n    // ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã® URL ã‹ã‚‰ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã‚’å–å¾—ã™ã‚‹\n    if (work?.mdUrl) {\n      fetch(work?.mdUrl)\n        .then((res) => res.text())\n        .then((text) => {\n          setMarkdownContent(text)\n        })\n        .catch((err) => console.error(\"Error fetching markdown file:\", err))\n    }\n  }, [work?.mdUrl])\n\n  useEffect(() => {\n    if (work) {\n      dispatch({\n        type: \"INITIALIZE\",\n        payload: {\n          items: [\n            {\n              id: 0,\n              content: work?.imageURL ?? \"\",\n            },\n            ...(work?.subWorks ?? []).map((subWork, index) => ({\n              id: index + 1,\n              content: subWork.imageUrl ?? \"\",\n            })),\n          ],\n          indexList: [],\n          isThumbnailLandscape:\n            (work?.smallThumbnailImageWidth ?? 0) >\n            (work?.smallThumbnailImageHeight ?? 0),\n          thumbnailBase64: work?.largeThumbnailImageURL ?? \"\",\n          ogpBase64: work?.ogpThumbnailImageUrl ?? \"\",\n          pngInfo: {\n            src: work?.pngInfo ?? \"\",\n            params: {\n              prompt: work?.prompt ?? \"\",\n              negativePrompt: work?.negativePrompt ?? \"\",\n              seed: work?.seed?.toString() ?? \"\",\n              sampler: work?.sampler ?? \"\",\n              strength: work?.strength ?? \"\",\n              noise: work?.noise ?? \"\",\n              model: work?.model ?? \"\",\n              modelHash: work?.modelHash ?? \"\",\n              steps: work?.steps ? work?.steps.toString() : \"\",\n              scale: work?.scale ? work?.scale.toString() : \"\",\n              vae: \"\",\n            },\n          },\n          thumbnailPosX:\n            (work?.smallThumbnailImageWidth ??\n            0 > (work?.smallThumbnailImageHeight ?? 0))\n              ? (work?.thumbnailImagePosition ?? 0)\n              : 0,\n          thumbnailPosY:\n            (work?.smallThumbnailImageWidth ??\n            0 > (work?.smallThumbnailImageHeight ?? 0))\n              ? 0\n              : (work?.thumbnailImagePosition ?? 0),\n        },\n      })\n\n      dispatchInput({\n        type: \"INITIALIZE\",\n        payload: {\n          accessType: work?.accessType ?? \"PUBLIC\",\n          aiModelId: work?.workModelId?.toString() ?? \"1\",\n          albumId: work?.album?.id ?? null,\n          caption: work?.description ?? \"\",\n          date: new Date(work?.createdAt * 1000),\n          enCaption: work?.enDescription ?? \"\",\n          enTitle: work?.enTitle ?? \"\",\n          imageInformation: {\n            params: {\n              prompt: work?.prompt ?? \"\",\n              negativePrompt: work?.negativePrompt ?? \"\",\n              seed: work?.seed?.toString() ?? \"\",\n              steps: work?.steps ? work?.steps.toString() : \"\",\n              strength: work?.strength ?? \"\",\n              noise: work?.noise ?? \"\",\n              scale: work?.scale ? work?.scale.toString() : \"\",\n              sampler: work?.sampler ?? \"\",\n              vae: work?.vae ?? \"\",\n              modelHash: work?.modelHash ?? \"\",\n              model: work?.model ?? \"\",\n            },\n            src: work?.pngInfo ?? \"\",\n          },\n          imageStyle: work?.style ?? \"ILLUSTRATION\",\n          link: work?.relatedUrl ?? \"\",\n          ratingRestriction: work?.rating ?? \"G\",\n          reservationDate: getReservationDetails(work?.createdAt ?? 0)\n            .reservationDate,\n          reservationTime: getReservationDetails(work?.createdAt ?? 0)\n            .reservationTime,\n          tags: work?.tagNames.length\n            ? work?.tagNames.map((tag) => ({ id: tag, text: tag }))\n            : [],\n          themeId: work?.dailyTheme?.id ?? null,\n          title: work?.title ?? \"\",\n          useCommentFeature: work?.isCommentsEditable ?? true,\n          useGenerationParams: work?.promptAccessType === \"PUBLIC\",\n          usePromotionFeature: work?.isPromotion ?? false,\n          useTagFeature: work?.isTagEditable ?? true,\n          md: markdownContent ?? \"\",\n          type: work?.type as \"COLUMN\" | \"NOVEL\" | \"VIDEO\" | \"WORK\",\n        },\n      })\n    }\n  }, [work])\n\n  const [state, dispatch] = useReducer(postTextFormReducer, {\n    editTargetImageBase64: null,\n    indexList: [],\n    isDrawing: false,\n    isHovered: false,\n    isOpenImageGenerationDialog: false,\n    isSelectedGenerationImage: false,\n    isThumbnailLandscape:\n      (work?.smallThumbnailImageWidth ?? 0) >\n      (work?.smallThumbnailImageHeight ?? 0),\n    items: [\n      {\n        id: 0,\n        content: work?.imageURL ?? \"\",\n      },\n      ...(work?.subWorks ?? []).map((subWork, index) => ({\n        id: index + 1,\n        content: subWork.imageUrl ?? \"\",\n      })),\n    ],\n    ogpBase64: work?.ogpThumbnailImageUrl ?? \"\",\n    pngInfo: {\n      src: work?.pngInfo ?? \"\",\n      params: {\n        prompt: work?.prompt ?? \"\",\n        negativePrompt: work?.negativePrompt ?? \"\",\n        seed: work?.seed?.toString() ?? \"\",\n        sampler: work?.sampler ?? \"\",\n        strength: work?.strength ?? \"\",\n        noise: work?.noise ?? \"\",\n        model: work?.model ?? \"\",\n        modelHash: work?.modelHash ?? \"\",\n        steps: work?.steps ? work?.steps.toString() : \"\",\n        scale: work?.scale ? work?.scale.toString() : \"\",\n        vae: \"\",\n      },\n    },\n    progress: 0,\n    selectedImageGenerationIds: [],\n    thumbnailBase64: work?.largeThumbnailImageURL ?? \"\",\n    thumbnailPosX:\n      (work?.smallThumbnailImageWidth ?? 0) >\n      (work?.smallThumbnailImageHeight ?? 0)\n        ? (work?.thumbnailImagePosition ?? 0)\n        : 0,\n    thumbnailPosY:\n      (work?.smallThumbnailImageWidth ?? 0) >\n      (work?.smallThumbnailImageHeight ?? 0)\n        ? 0\n        : (work?.thumbnailImagePosition ?? 0),\n    uploadedWorkId: null,\n    uploadedWorkUuid: null,\n    videoFile: null,\n    isOpenLoadingAi: false,\n  })\n\n  const { reservationDate, reservationTime } = getReservationDetails(\n    work?.createdAt ?? 0,\n  )\n\n  const [inputState, dispatchInput] = useReducer(postTextFormInputReducer, {\n    accessType: work?.accessType ?? \"PUBLIC\",\n    generationParamAccessType:\n      work?.promptAccessType === \"PUBLIC\" ? \"PUBLIC\" : \"PRIVATE\",\n    aiModelId: work?.workModelId?.toString() ?? null,\n    albumId: work?.album?.id ?? null,\n    caption: work?.description ?? \"\",\n    date: new Date(work?.createdAt ?? new Date()),\n    enCaption: work?.enDescription ?? \"\",\n    enTitle: work?.enTitle ?? \"\",\n    imageInformation: {\n      params: {\n        prompt: work?.prompt ?? \"\",\n        negativePrompt: work?.negativePrompt ?? \"\",\n        seed: work?.seed?.toString() ?? \"\",\n        steps: work?.steps ? work?.steps.toString() : \"\",\n        strength: work?.strength ?? \"\",\n        noise: work?.noise ?? \"\",\n        scale: work?.scale ? work?.scale.toString() : \"\",\n        sampler: work?.sampler ?? \"\",\n        vae: work?.vae ?? \"\",\n        modelHash: work?.modelHash ?? \"\",\n        model: work?.model ?? \"\",\n      },\n      src: work?.pngInfo ?? \"\",\n    },\n    imageStyle: work?.style ?? \"ILLUSTRATION\",\n    link: work?.relatedUrl ?? \"\",\n    ratingRestriction: work?.rating ?? \"G\",\n    reservationDate: reservationDate,\n    reservationTime: reservationTime,\n    tags: work?.tagNames.length\n      ? work?.tagNames.map((tag) => ({ id: tag, text: tag }))\n      : [],\n    themeId: work?.dailyTheme?.id ?? null,\n    title: work?.title ?? \"\",\n    useCommentFeature:\n      work?.isCommentsEditable === undefined ? true : work?.isCommentsEditable,\n    useGenerationParams: work?.promptAccessType === \"PUBLIC\",\n    usePromotionFeature:\n      work?.isPromotion === undefined ? false : work?.isPromotion,\n    useTagFeature:\n      work?.isTagEditable === undefined ? true : work?.isTagEditable,\n    md: markdownContent ?? \"\",\n    type: work?.type as \"COLUMN\" | \"NOVEL\" | \"VIDEO\" | \"WORK\",\n    correctionMessage: \"\",\n  })\n\n  const now = getJstDate(new Date())\n\n  const { data: viewer } = useQuery(viewerQuery, {\n    skip: authContext.isNotLoggedIn,\n    variables: {\n      offset: 0,\n      limit: 128,\n      ownerUserId: authContext.userId,\n      startAt: now.toISOString().split(\"T\")[0],\n      startDate: new Date(Date.now() - 24 * 60 * 60 * 1000)\n        .toISOString()\n        .split(\"T\")[0],\n      endDate: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n        .toISOString()\n        .split(\"T\")[0],\n    },\n  })\n\n  const [updateWork, { loading: isUpdatedLoading }] =\n    useMutation(updateWorkMutation)\n\n  const formResult = safeParse(vPostTextForm, {\n    title: inputState.title,\n    caption: inputState.caption,\n    enTitle: inputState.enTitle,\n    enCaption: inputState.enCaption,\n    imagesCount: state.items.length,\n    thumbnailBase64: state.thumbnailBase64,\n    md: inputState.md,\n  })\n\n  const uploadImages = async () => {\n    if (authContext.userId === null) {\n      return []\n    }\n\n    const images = state.items.map((item) => item.content)\n\n    const imageUrls = await Promise.all(\n      images.map(async (image) => {\n        if (!image) {\n          return null\n        }\n        const imageUrl = image.startsWith(\"https://\")\n          ? image\n          : await uploadPublicImage(image, viewer?.viewer?.token)\n        return imageUrl\n      }),\n    )\n\n    return imageUrls\n  }\n\n  const onPost = async () => {\n    if (work === null) {\n      return\n    }\n\n    if (formResult.success === false) {\n      for (const issue of formResult.issues) {\n        toast(issue.message)\n        return\n      }\n      return\n    }\n\n    if (\n      !inputState.correctionMessage &&\n      work?.moderatorReport?.status === \"UNHANDLED\"\n    ) {\n      toast(\"ä¿®æ­£ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    if (\n      inputState.reservationDate !== null &&\n      inputState.reservationTime === null\n    ) {\n      toast(\"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    if (\n      inputState.reservationDate === null &&\n      inputState.reservationTime !== null\n    ) {\n      toast(\"äºˆç´„æŠ•ç¨¿ã®æ™‚é–“ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    const uploadedImageUrls = []\n\n    try {\n      dispatch({ type: \"SET_PROGRESS\", payload: 10 })\n\n      const smallThumbnail = formResult.output.thumbnailBase64.startsWith(\n        \"https://\",\n      )\n        ? null\n        : state.isThumbnailLandscape\n          ? await resizeImage(formResult.output.thumbnailBase64, 400, 0, \"webp\")\n          : await resizeImage(formResult.output.thumbnailBase64, 0, 400, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 20 })\n\n      const largeThumbnail = formResult.output.thumbnailBase64.startsWith(\n        \"https://\",\n      )\n        ? null\n        : state.isThumbnailLandscape\n          ? await resizeImage(formResult.output.thumbnailBase64, 600, 0, \"webp\")\n          : await resizeImage(formResult.output.thumbnailBase64, 0, 600, \"webp\")\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 30 })\n\n      const smallThumbnailUrl =\n        formResult.output.thumbnailBase64.startsWith(\"https://\") ||\n        smallThumbnail === null\n          ? (work.smallThumbnailImageURL ?? \"\")\n          : await uploadPublicImage(\n              smallThumbnail.base64,\n              viewer?.viewer?.token,\n            )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 40 })\n\n      uploadedImageUrls.push(smallThumbnailUrl)\n\n      const largeThumbnailUrl =\n        formResult.output.thumbnailBase64.startsWith(\"https://\") ||\n        largeThumbnail === null\n          ? (work.largeThumbnailImageURL ?? \"\")\n          : await uploadPublicImage(\n              largeThumbnail.base64,\n              viewer?.viewer?.token,\n            )\n\n      uploadedImageUrls.push(largeThumbnailUrl)\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 50 })\n\n      uploadedImageUrls.push(largeThumbnailUrl)\n\n      const ogpBase64Url =\n        state.ogpBase64 === \"\" || state.ogpBase64?.startsWith(\"https://\")\n          ? work.ogpThumbnailImageUrl\n          : await uploadPublicImage(\n              state.ogpBase64 ?? \"\",\n              viewer?.viewer?.token,\n            )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 60 })\n\n      if (ogpBase64Url !== null && ogpBase64Url !== \"\") {\n        uploadedImageUrls.push(ogpBase64Url)\n      }\n\n      const reservedAt =\n        inputState.reservationDate !== null &&\n        inputState.reservationTime !== null\n          ? new Date(\n              `${inputState.reservationDate}T${inputState.reservationTime}`,\n            ).getTime() +\n            3600000 * 9\n          : undefined\n\n      const mainImageSha256 = await sha256(formResult.output.thumbnailBase64)\n\n      const mainImageSize = await getSizeFromBase64(\n        formResult.output.thumbnailBase64,\n      )\n\n      dispatch({ type: \"SET_PROGRESS\", payload: 70 })\n\n      if (work.mdUrl !== \"\") {\n        await uploadTextFile(\n          inputState.md,\n          \"md\",\n          viewer?.viewer?.token,\n          work.mdUrl,\n        )\n      }\n\n      const uploadResults = await uploadImages()\n\n      const imageUrls = uploadResults.filter((url) => url !== null)\n\n      if (imageUrls.length === 0) {\n        toast(\"ç”»åƒã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n        return\n      }\n\n      const updatedWork = await updateWork({\n        variables: {\n          input: {\n            id: work?.id,\n            title: formResult.output.title,\n            entitle: formResult.output.enTitle,\n            explanation: formResult.output.caption,\n            enExplanation: formResult.output.enCaption,\n            rating: inputState.ratingRestriction,\n            prompt: state.pngInfo?.params.prompt ?? null,\n            negativePrompt: state.pngInfo?.params.negativePrompt ?? null,\n            seed: state.pngInfo?.params.seed ?? null,\n            sampler: state.pngInfo?.params.sampler ?? null,\n            strength: state.pngInfo?.params.strength ?? null,\n            noise: state.pngInfo?.params.noise ?? null,\n            modelName: state.pngInfo?.params.model ?? null,\n            modelHash: state.pngInfo?.params.modelHash ?? null,\n            otherGenerationParams: state.pngInfo?.src ?? null,\n            pngInfo: state.pngInfo?.src ?? null,\n            imageStyle: inputState.imageStyle,\n            relatedUrl: inputState.link,\n            tags: inputState.tags.map((tag) => tag.text),\n            isTagEditable: inputState.useTagFeature,\n            isCommentEditable: inputState.useCommentFeature,\n            thumbnailPosition: state.isThumbnailLandscape\n              ? state.thumbnailPosX\n              : state.thumbnailPosY,\n            modelId: inputState.aiModelId,\n            type: inputState.type ?? \"COLUMN\",\n            subjectId: inputState.themeId,\n            albumId: inputState.albumId,\n            isPromotion: inputState.usePromotionFeature,\n            reservedAt: reservedAt,\n            mainImageSha256: mainImageSha256,\n            accessType: inputState.accessType,\n            imageUrls: imageUrls,\n            smallThumbnailImageURL: smallThumbnailUrl,\n            smallThumbnailImageWidth: smallThumbnail\n              ? smallThumbnail.width\n              : (work.smallThumbnailImageWidth ?? 0),\n            smallThumbnailImageHeight: smallThumbnail\n              ? smallThumbnail.height\n              : (work.smallThumbnailImageHeight ?? 0),\n            largeThumbnailImageURL: largeThumbnailUrl,\n            largeThumbnailImageWidth: largeThumbnail\n              ? largeThumbnail.width\n              : (work.largeThumbnailImageWidth ?? 0),\n            largeThumbnailImageHeight: largeThumbnail\n              ? largeThumbnail.height\n              : (work.largeThumbnailImageHeight ?? 0),\n            videoUrl: null,\n            ogpImageUrl: ogpBase64Url,\n            imageHeight: mainImageSize.height,\n            imageWidth: mainImageSize.width,\n            accessGenerationType:\n              state.isSelectedGenerationImage && inputState.useGenerationParams\n                ? \"PUBLIC_RESTORABLE\"\n                : inputState.useGenerationParams\n                  ? \"PUBLIC\"\n                  : \"PRIVATE\",\n            correctionMessage:\n              work?.moderatorReport?.status === \"UNHANDLED\"\n                ? inputState.correctionMessage\n                : undefined,\n          },\n        },\n      })\n\n      if (updatedWork?.data?.updateWork === undefined) {\n        toast(\"ä½œå“ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n        return\n      }\n\n      dispatch({\n        type: \"MARK_AS_DONE\",\n        payload: {\n          uploadedWorkId: updatedWork?.data?.updateWork.id,\n          uploadedWorkUuid: updatedWork?.data?.updateWork.uuid,\n        },\n      })\n\n      toast(\"ä½œå“ã‚’æŠ•ç¨¿ã—ã¾ã—ãŸ\")\n    } catch (error) {\n      if (error instanceof Error) {\n        toast(error.message)\n      }\n      const promises = uploadedImageUrls.map((url) => {\n        return deleteUploadedImage(url)\n      })\n      await Promise.all(promises)\n      dispatch({ type: \"SET_PROGRESS\", payload: 0 })\n    }\n  }\n\n  const createdAt = new Date(\n    `${inputState.reservationDate}T${inputState.reservationTime}`,\n  )\n\n  const [disabledSubmit, setDisabledSubmit] = React.useState(false)\n\n  useBeforeUnload(\n    React.useCallback(\n      (event) => {\n        if (state) {\n          const confirmationMessage =\n            \"ãƒšãƒ¼ã‚¸é·ç§»ã™ã‚‹ã¨å¤‰æ›´ãŒæ¶ˆãˆã¾ã™ãŒå•é¡Œç„¡ã„ã§ã™ã‹ï¼Ÿ\"\n          event.returnValue = confirmationMessage\n          return confirmationMessage\n        }\n      },\n      [state],\n    ),\n  )\n\n  return work?.user !== null && work?.user.id === authContext.userId ? (\n    <div className=\"m-auto w-full max-w-[1200px] space-y-4 pb-4\">\n      <div className=\"space-y-4\">\n        <EditTextFormUploader state={state} dispatch={dispatch} />\n        <PostTextFormInput\n          imageInformation={state.pngInfo}\n          state={inputState}\n          dispatch={dispatchInput}\n          albums={viewer?.albums ?? []}\n          currentPass={viewer?.viewer?.currentPass ?? null}\n          recentlyUsedTags={viewer?.viewer?.recentlyUsedTags ?? []}\n          eventInputHidden={false}\n          setDisabledSubmit={setDisabledSubmit}\n          themes={\n            viewer?.dailyThemes\n              ? viewer.dailyThemes.map((theme) => ({\n                  date: theme.dateText,\n                  title: theme.title,\n                  id: theme.id,\n                }))\n              : null\n          }\n          aiModels={viewer?.aiModels ?? []}\n          events={viewer?.appEvents ?? []}\n          needFix={work?.moderatorReport?.status === \"UNHANDLED\"}\n          mdUrl={work?.mdUrl ?? \"\"}\n        />\n        <div className=\"h-4\" />\n        <Button\n          disabled={disabledSubmit}\n          className=\"fixed bottom-0 left-0 z-30 ml-0 w-full rounded-none p-0 md:ml-[72px] md:pr-[72px] lg:ml-[224px] lg:pr-[224px] xl:left-auto xl:m-0 xl:max-w-[1200px] xl:pl-[8%]\"\n          size={\"lg\"}\n          type=\"submit\"\n          onClick={onPost}\n        >\n          {\"æ›´æ–°\"}\n        </Button>\n      </div>\n      <SuccessCreatedWorkDialog\n        isOpen={state.progress === 100}\n        title={inputState.title}\n        description={inputState.caption}\n        imageBase64={state.thumbnailBase64}\n        workId={state.uploadedWorkId}\n        uuid={state.uploadedWorkUuid}\n        shareTags={[\"Aipictors\", \"AIã‚¤ãƒ©ã‚¹ãƒˆ\", \"AIart\"]}\n        createdAt={createdAt.getTime()}\n        accessType={inputState.accessType}\n      />\n      <CreatingWorkDialog\n        progress={state.progress}\n        isOpen={state.progress !== 0 && state.progress !== 100}\n        text={\"æ›´æ–°ä¸­\"}\n      />\n    </div>\n  ) : (\n    <div>\n      <AppLoadingPage />\n    </div>\n  )\n}\n\nconst viewerQuery = graphql(\n  `query ViewerQuery(\n    $limit: Int!,\n    $offset: Int!,\n    $ownerUserId: ID,\n    $startDate: String!,\n    $endDate: String!,\n    $startAt: String!,\n  ) {\n    viewer {\n      id\n      token\n      currentPass {\n        id\n        ...PostTextFormPass\n      }\n      recentlyUsedTags {\n        ...PostTextFormRecentlyUsedTags\n      }\n    }\n    albums(\n      offset: $offset,\n      limit: $limit,\n      where: {\n        ownerUserId: $ownerUserId,\n        needInspected: false,\n        needsThumbnailImage: false,\n      }\n    ) {\n      ...PostTextFormAlbum\n    }\n    aiModels(offset: 0, limit: 124, where: {}) {\n      ...PostTextFormAiModel\n    }\n    dailyThemes(\n      limit: 8,\n      offset: 0,\n      where: {\n        startDate: $startDate,\n        endDate: $endDate,\n      }) {\n      id\n      title\n      dateText\n    }\n    appEvents(\n      limit: 8,\n      offset: 0,\n      where: {\n        endAt: $startAt,\n      }\n    ) {\n      id\n      description\n      title\n      tag\n      slug\n      endAt\n    }\n  }`,\n  [\n    PostTextFormAiModelFragment,\n    PostTextFormAlbumFragment,\n    PostTextFormPassFragment,\n    PostTextFormRecentlyUsedTagsFragment,\n  ],\n)\n\nconst workQuery = graphql(\n  `query Work($id: ID!) {\n    work(id: $id) {\n      id\n      uuid\n      isMyRecommended\n      title\n      accessType\n      type\n      promptAccessType\n      rating\n      description\n      isSensitive\n      enTitle\n      enDescription\n      imageURL\n      largeThumbnailImageURL\n      largeThumbnailImageWidth\n      largeThumbnailImageHeight\n      smallThumbnailImageURL\n      smallThumbnailImageWidth\n      smallThumbnailImageHeight\n      thumbnailImagePosition\n      subWorksCount\n      ogpThumbnailImageUrl\n      tagNames\n      createdAt\n      model\n      modelHash\n      generationModelId\n      workModelId\n      isTagEditable\n      isCommentsEditable\n      isPromotion\n      isGeneration\n      ogpThumbnailImageUrl\n      prompt\n      negativePrompt\n      noise\n      seed\n      steps\n      sampler\n      scale\n      strength\n      vae\n      clipSkip\n      otherGenerationParams\n      pngInfo\n      style\n      url\n      relatedUrl\n      mdUrl\n      user {\n        id\n        works(offset: 0, limit: 16) {\n          id\n          userId\n          largeThumbnailImageURL\n          largeThumbnailImageWidth\n          largeThumbnailImageHeight\n          smallThumbnailImageURL\n          smallThumbnailImageWidth\n          smallThumbnailImageHeight\n          thumbnailImagePosition\n          subWorksCount\n        }\n      }\n      album {\n        id\n      }\n      dailyTheme {\n        id\n        title\n      }\n      subWorks {\n        id\n        imageUrl\n      }\n      moderatorReport {\n        status\n        reportMessage\n      }\n    }\n  }`,\n)\n\nconst updateWorkMutation = graphql(\n  `mutation UpdateWork($input: UpdateWorkInput!) {\n    updateWork(input: $input) {\n      id\n      title\n      description\n      rating\n      accessType\n      nanoid\n      uuid\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/suspicious/noExplicitAny","severity":"warning","description":"Unexpected any. Specify a different type.","message":[{"elements":[],"content":"Unexpected "},{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":". Specify a different type."}],"advices":{"advices":[{"log":["info",[{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":" disables many type checking rules. Its use should be avoided."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.r.posts.$post._index/components/sensitive-work-container.tsx"},"span":[4051,4054],"sourceCode":"import {\n  workArticleFragment,\n  sensitiveWorkArticleFragment,\n} from \"~/routes/($lang)._main.posts.$post._index/components/work-article\"\nimport { WorkUser } from \"~/routes/($lang)._main.posts.$post._index/components/work-user\"\nimport { useContext } from \"react\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport { WorkRelatedList } from \"~/routes/($lang)._main.posts.$post._index/components/work-related-list\"\nimport { WorkNextAndPrevious } from \"~/routes/($lang)._main.posts.$post._index/components/work-next-and-previous\"\nimport {\n  type CommentListItemFragment,\n  WorkCommentList,\n} from \"~/routes/($lang)._main.posts.$post._index/components/work-comment-list\"\nimport type { HomeNewCommentsFragment } from \"~/routes/($lang)._main._index/components/home-new-comments\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport {\n  HomeAwardWorksSection,\n  type HomeAwardWorksFragment,\n} from \"~/routes/($lang)._main._index/components/home-award-works\"\nimport type { HomeWorkAwardFragment } from \"~/routes/($lang)._main._index/components/home-award-work-section\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { useNavigate, Link } from \"react-router-dom\"\nimport { CrossPlatformTooltip } from \"~/components/cross-platform-tooltip\"\nimport { SensitiveWorkTagsWorks } from \"~/routes/($lang)._main.r.posts.$post._index/components/sensitive-work-tags-works\"\nimport { workCommentsQuery } from \"~/routes/($lang)._main.posts.$post._index/route\"\nimport { HomeNewSensitiveCommentsSection } from \"~/routes/($lang)._main._index/components/home-new-sensitive-comments\"\nimport { SensitiveWorkArticle } from \"~/routes/($lang)._main.posts.$post._index/components/sensitive-work-article\"\n\ntype Props = {\n  post: string\n  work: FragmentOf<typeof workArticleFragment> | null\n  comments: FragmentOf<typeof CommentListItemFragment>[]\n  newComments: FragmentOf<typeof HomeNewCommentsFragment>[]\n  awardWorks: FragmentOf<\n    typeof HomeAwardWorksFragment | typeof HomeWorkAwardFragment\n  >[]\n}\n\n/**\n * ä½œå“è©³ç´°æƒ…å ±\n */\nexport function SensitiveWorkContainer (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  const { data, refetch } = useQuery(sensitiveWorkQuery, {\n    skip: authContext.userId !== props.work?.user?.id && authContext.isLoading,\n    variables: {\n      id: props.post,\n    },\n  })\n\n  const work = data?.work ?? props.work\n\n  const { data: workCommentsRet } = useQuery(workCommentsQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      workId: props.post,\n    },\n  })\n\n  const comments = workCommentsRet?.work?.comments ?? props.comments\n\n  const { data: userSetting } = useQuery(userSensitiveSettingQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n  })\n\n  const tags = work?.tagNames ?? []\n\n  const randomTag =\n    tags.length > 0 ? tags[Math.floor(Math.random() * tags.length)] : null\n\n  const _navigate = useNavigate()\n\n  const { data: pass } = useQuery(viewerCurrentPassQuery, {})\n\n  const { data: advertisements } = useQuery(randomCustomerAdvertisementQuery, {\n    variables: {\n      where: {\n        isSensitive: true,\n        page: \"work\",\n      },\n    },\n  })\n\n  const [updateClickedCountCustomerAdvertisement] = useMutation(\n    updateClickedCountCustomerAdvertisementMutation,\n  )\n\n  const onClickAdvertisement = async () => {\n    if (advertisements?.randomCustomerAdvertisement) {\n      // Update advertisement click count\n      await updateClickedCountCustomerAdvertisement({\n        variables: {\n          id: advertisements.randomCustomerAdvertisement.id,\n        },\n      })\n    }\n  }\n\n  const passData = pass?.viewer?.currentPass\n\n  const isSubscriptionUser =\n    passData?.type === \"LITE\" ||\n    passData?.type === \"STANDARD\" ||\n    passData?.type === \"PREMIUM\"\n\n  const t = useTranslation()\n\n  if (work === null || work.isDeleted === true) {\n    return null\n  }\n\n  const albumCandidate = (work as any).album\n  const albumForArticle =\n    albumCandidate &&\n    typeof albumCandidate === \"object\" &&\n    \"id\" in albumCandidate &&\n    \"title\" in albumCandidate &&\n    \"description\" in albumCandidate\n      ? albumCandidate\n      : null\n\n  const workForArticle = {\n    ...work,\n    album: albumForArticle,\n  }\n\n  return (\n    <div\n      className=\"space-y-4 overflow-hidden\"\n      style={{\n        margin: \"auto\",\n      }}\n    >\n      <div className=\"flex w-full justify-center overflow-hidden\">\n        <div className=\"flex w-full flex-col items-center overflow-hidden\">\n          <div className=\"mx-auto w-full space-y-4\">\n            <SensitiveWorkArticle\n              work={workForArticle}\n              userSetting={userSetting?.userSetting ?? undefined}\n            />\n            {workForArticle.user !== null &&\n              workForArticle.user.works.length > 0 && (\n                <WorkRelatedList\n                  works={workForArticle.user.works.map((relatedWork) => ({\n                    smallThumbnailImageURL: relatedWork.smallThumbnailImageURL,\n                    thumbnailImagePosition:\n                      relatedWork.thumbnailImagePosition ?? 0,\n                    smallThumbnailImageWidth:\n                      relatedWork.smallThumbnailImageWidth,\n                    smallThumbnailImageHeight:\n                      relatedWork.smallThumbnailImageHeight,\n                    id: relatedWork.id,\n                    userId: relatedWork.userId,\n                    isLiked: relatedWork.isLiked,\n                    subWorksCount: relatedWork.subWorksCount,\n                    commentsCount: relatedWork.commentsCount,\n                  }))}\n                />\n              )}\n            {workForArticle.isCommentsEditable && (\n              <WorkCommentList\n                workId={workForArticle.id}\n                comments={comments}\n                workOwnerIconImageURL={workForArticle.user?.iconUrl}\n                isWorkOwnerBlocked={workForArticle.user?.isBlocked ?? false}\n              />\n            )}\n            {workForArticle.user !== null && (\n              <div className=\"block md:mt-0 lg:hidden\">\n                <WorkUser\n                  userId={workForArticle.user.id}\n                  userLogin={workForArticle.user.login}\n                  userName={workForArticle.user.name}\n                  userIconImageURL={withIconUrlFallback(\n                    workForArticle.user.iconUrl,\n                  )}\n                  userFollowersCount={workForArticle.user.followersCount}\n                  userBiography={workForArticle.user.biography ?? \"\"}\n                  userEnBiography={workForArticle.user.enBiography ?? null}\n                  userPromptonId={workForArticle.user.promptonUser?.id}\n                  userWorksCount={workForArticle.user.worksCount}\n                />\n              </div>\n            )}\n          </div>\n        </div>\n        <div className=\"mt-2 hidden w-full flex-col items-start space-y-4 pl-4 md:mt-0 md:flex md:max-w-80\">\n          {workForArticle.user !== null && (\n            <div className=\"w-full\">\n              <WorkUser\n                userId={workForArticle.user.id}\n                userName={workForArticle.user.name}\n                userLogin={workForArticle.user.login}\n                userIconImageURL={withIconUrlFallback(\n                  workForArticle.user.iconUrl,\n                )}\n                userFollowersCount={workForArticle.user.followersCount}\n                userBiography={workForArticle.user.biography ?? \"\"}\n                userEnBiography={workForArticle.user.enBiography ?? null}\n                userPromptonId={workForArticle.user.promptonUser?.id}\n                userWorksCount={workForArticle.user.worksCount}\n              />\n            </div>\n          )}\n          <div className=\"invisible flex w-full flex-col space-y-4 md:visible\">\n            <WorkNextAndPrevious work={work} />\n            <div className=\"flex w-full flex-col space-y-4\">\n              <div className=\"relative grid gap-4\">\n                {!isSubscriptionUser &&\n                  advertisements &&\n                  advertisements.randomCustomerAdvertisement && (\n                    <div className=\"relative border\">\n                      <Link\n                        onClick={onClickAdvertisement}\n                        target=\"_blank\"\n                        to={advertisements.randomCustomerAdvertisement.url}\n                      >\n                        <img\n                          src={\n                            advertisements.randomCustomerAdvertisement.imageUrl\n                          }\n                          alt=\"Advertisement\"\n                        />\n                      </Link>\n                      <div className=\"absolute top-0 right-0\">\n                        <CrossPlatformTooltip\n                          text={t(\n                            \"ææºåºƒå‘Šã§ã™ã€åºƒå‘Šä¸»æ§˜ã‚’å‹Ÿé›†ä¸­ã§ã™ã€‚ãƒ¡ãƒ¼ãƒ«ã¾ãŸã¯DMã«ã¦ã”é€£çµ¡ãã ã•ã„ã€‚\",\n                            \"This is a partnered advertisement. We are accepting new advertisers. Please contact us via email or DM.\",\n                          )}\n                        />\n                      </div>\n                    </div>\n                  )}\n                {!isSubscriptionUser && (\n                  <Link to=\"/generation\">\n                    <img\n                      src=\"https://assets.aipictors.com/Aipictors_01.webp\"\n                      alt=\"Aipictors Logo\"\n                    />\n                  </Link>\n                )}\n                {props.newComments && props.newComments.length > 0 && (\n                  <HomeNewSensitiveCommentsSection\n                    comments={props.newComments}\n                  />\n                )}\n                {props.awardWorks && (\n                  <HomeAwardWorksSection works={props.awardWorks} />\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <section className=\"m-auto space-y-4\">\n        {randomTag && (\n          <>\n            <div className=\"flex justify-between\">\n              <h2 className=\"items-center space-x-2 font-bold text-md\">\n                {t(\"ãŠã™ã™ã‚\", \"Recommended\")}\n              </h2>\n            </div>\n            <SensitiveWorkTagsWorks\n              tagName={randomTag}\n              rating={work.rating ?? \"R18\"}\n            />\n          </>\n        )}\n      </section>\n      {/* <div className=\"flex w-full flex-col space-y-4 md:hidden\">\n        <AppSideMenu />\n      </div> */}\n    </div>\n  )\n}\n\nconst _workQuery = graphql(\n  `query Work($id: ID!) {\n    work(id: $id) {\n      ...WorkArticle\n    }\n  }`,\n  [workArticleFragment],\n)\n\nconst sensitiveWorkQuery = graphql(\n  `query Work($id: ID!) {\n    work(id: $id) {\n      ...WorkArticle\n    }\n  }`,\n  [sensitiveWorkArticleFragment],\n)\n\nconst updateClickedCountCustomerAdvertisementMutation = graphql(\n  `mutation UpdateClickedCountCustomerAdvertisement($id: ID!) {\n    updateClickedCountCustomerAdvertisement(id: $id) {\n      id\n    }\n  }`,\n)\n\nconst viewerCurrentPassQuery = graphql(\n  `query ViewerCurrentPass {\n    viewer {\n      id\n      currentPass {\n        id\n        type\n      }\n    }\n  }`,\n)\n\nexport const SideMenuAdvertisementsFragment = graphql(\n  `fragment SideMenuAdvertisementsFields on CustomerAdvertisementNode @_unmask {\n      id\n      imageUrl\n      url\n      displayProbability\n      clickCount\n      impressionCount\n      isSensitive\n      createdAt\n      page\n      startAt\n      endAt\n      isActive\n  }`,\n)\n\nconst randomCustomerAdvertisementQuery = graphql(\n  `query RandomCustomerAdvertisement($where: RandomCustomerAdvertisementWhereInput!) {\n    randomCustomerAdvertisement(where: $where) {\n      ...SideMenuAdvertisementsFields\n    }\n  }`,\n  [SideMenuAdvertisementsFragment],\n)\n\nexport const userSensitiveSettingFragment = graphql(\n  `fragment UserSensitiveSetting on UserSettingNode @_unmask {\n      id\n  }`,\n)\n\nconst userSensitiveSettingQuery = graphql(\n  `query UserSensitiveSetting {\n    userSetting {\n      ...UserSensitiveSetting\n    }\n  }`,\n  [userSensitiveSettingFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable refetch is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"refetch"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.r.posts.$post._index/components/sensitive-work-container.tsx"},"span":[2283,2290],"sourceCode":"import {\n  workArticleFragment,\n  sensitiveWorkArticleFragment,\n} from \"~/routes/($lang)._main.posts.$post._index/components/work-article\"\nimport { WorkUser } from \"~/routes/($lang)._main.posts.$post._index/components/work-user\"\nimport { useContext } from \"react\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport { WorkRelatedList } from \"~/routes/($lang)._main.posts.$post._index/components/work-related-list\"\nimport { WorkNextAndPrevious } from \"~/routes/($lang)._main.posts.$post._index/components/work-next-and-previous\"\nimport {\n  type CommentListItemFragment,\n  WorkCommentList,\n} from \"~/routes/($lang)._main.posts.$post._index/components/work-comment-list\"\nimport type { HomeNewCommentsFragment } from \"~/routes/($lang)._main._index/components/home-new-comments\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport {\n  HomeAwardWorksSection,\n  type HomeAwardWorksFragment,\n} from \"~/routes/($lang)._main._index/components/home-award-works\"\nimport type { HomeWorkAwardFragment } from \"~/routes/($lang)._main._index/components/home-award-work-section\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { useNavigate, Link } from \"react-router-dom\"\nimport { CrossPlatformTooltip } from \"~/components/cross-platform-tooltip\"\nimport { SensitiveWorkTagsWorks } from \"~/routes/($lang)._main.r.posts.$post._index/components/sensitive-work-tags-works\"\nimport { workCommentsQuery } from \"~/routes/($lang)._main.posts.$post._index/route\"\nimport { HomeNewSensitiveCommentsSection } from \"~/routes/($lang)._main._index/components/home-new-sensitive-comments\"\nimport { SensitiveWorkArticle } from \"~/routes/($lang)._main.posts.$post._index/components/sensitive-work-article\"\n\ntype Props = {\n  post: string\n  work: FragmentOf<typeof workArticleFragment> | null\n  comments: FragmentOf<typeof CommentListItemFragment>[]\n  newComments: FragmentOf<typeof HomeNewCommentsFragment>[]\n  awardWorks: FragmentOf<\n    typeof HomeAwardWorksFragment | typeof HomeWorkAwardFragment\n  >[]\n}\n\n/**\n * ä½œå“è©³ç´°æƒ…å ±\n */\nexport function SensitiveWorkContainer (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  const { data, refetch } = useQuery(sensitiveWorkQuery, {\n    skip: authContext.userId !== props.work?.user?.id && authContext.isLoading,\n    variables: {\n      id: props.post,\n    },\n  })\n\n  const work = data?.work ?? props.work\n\n  const { data: workCommentsRet } = useQuery(workCommentsQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      workId: props.post,\n    },\n  })\n\n  const comments = workCommentsRet?.work?.comments ?? props.comments\n\n  const { data: userSetting } = useQuery(userSensitiveSettingQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n  })\n\n  const tags = work?.tagNames ?? []\n\n  const randomTag =\n    tags.length > 0 ? tags[Math.floor(Math.random() * tags.length)] : null\n\n  const _navigate = useNavigate()\n\n  const { data: pass } = useQuery(viewerCurrentPassQuery, {})\n\n  const { data: advertisements } = useQuery(randomCustomerAdvertisementQuery, {\n    variables: {\n      where: {\n        isSensitive: true,\n        page: \"work\",\n      },\n    },\n  })\n\n  const [updateClickedCountCustomerAdvertisement] = useMutation(\n    updateClickedCountCustomerAdvertisementMutation,\n  )\n\n  const onClickAdvertisement = async () => {\n    if (advertisements?.randomCustomerAdvertisement) {\n      // Update advertisement click count\n      await updateClickedCountCustomerAdvertisement({\n        variables: {\n          id: advertisements.randomCustomerAdvertisement.id,\n        },\n      })\n    }\n  }\n\n  const passData = pass?.viewer?.currentPass\n\n  const isSubscriptionUser =\n    passData?.type === \"LITE\" ||\n    passData?.type === \"STANDARD\" ||\n    passData?.type === \"PREMIUM\"\n\n  const t = useTranslation()\n\n  if (work === null || work.isDeleted === true) {\n    return null\n  }\n\n  const albumCandidate = (work as any).album\n  const albumForArticle =\n    albumCandidate &&\n    typeof albumCandidate === \"object\" &&\n    \"id\" in albumCandidate &&\n    \"title\" in albumCandidate &&\n    \"description\" in albumCandidate\n      ? albumCandidate\n      : null\n\n  const workForArticle = {\n    ...work,\n    album: albumForArticle,\n  }\n\n  return (\n    <div\n      className=\"space-y-4 overflow-hidden\"\n      style={{\n        margin: \"auto\",\n      }}\n    >\n      <div className=\"flex w-full justify-center overflow-hidden\">\n        <div className=\"flex w-full flex-col items-center overflow-hidden\">\n          <div className=\"mx-auto w-full space-y-4\">\n            <SensitiveWorkArticle\n              work={workForArticle}\n              userSetting={userSetting?.userSetting ?? undefined}\n            />\n            {workForArticle.user !== null &&\n              workForArticle.user.works.length > 0 && (\n                <WorkRelatedList\n                  works={workForArticle.user.works.map((relatedWork) => ({\n                    smallThumbnailImageURL: relatedWork.smallThumbnailImageURL,\n                    thumbnailImagePosition:\n                      relatedWork.thumbnailImagePosition ?? 0,\n                    smallThumbnailImageWidth:\n                      relatedWork.smallThumbnailImageWidth,\n                    smallThumbnailImageHeight:\n                      relatedWork.smallThumbnailImageHeight,\n                    id: relatedWork.id,\n                    userId: relatedWork.userId,\n                    isLiked: relatedWork.isLiked,\n                    subWorksCount: relatedWork.subWorksCount,\n                    commentsCount: relatedWork.commentsCount,\n                  }))}\n                />\n              )}\n            {workForArticle.isCommentsEditable && (\n              <WorkCommentList\n                workId={workForArticle.id}\n                comments={comments}\n                workOwnerIconImageURL={workForArticle.user?.iconUrl}\n                isWorkOwnerBlocked={workForArticle.user?.isBlocked ?? false}\n              />\n            )}\n            {workForArticle.user !== null && (\n              <div className=\"block md:mt-0 lg:hidden\">\n                <WorkUser\n                  userId={workForArticle.user.id}\n                  userLogin={workForArticle.user.login}\n                  userName={workForArticle.user.name}\n                  userIconImageURL={withIconUrlFallback(\n                    workForArticle.user.iconUrl,\n                  )}\n                  userFollowersCount={workForArticle.user.followersCount}\n                  userBiography={workForArticle.user.biography ?? \"\"}\n                  userEnBiography={workForArticle.user.enBiography ?? null}\n                  userPromptonId={workForArticle.user.promptonUser?.id}\n                  userWorksCount={workForArticle.user.worksCount}\n                />\n              </div>\n            )}\n          </div>\n        </div>\n        <div className=\"mt-2 hidden w-full flex-col items-start space-y-4 pl-4 md:mt-0 md:flex md:max-w-80\">\n          {workForArticle.user !== null && (\n            <div className=\"w-full\">\n              <WorkUser\n                userId={workForArticle.user.id}\n                userName={workForArticle.user.name}\n                userLogin={workForArticle.user.login}\n                userIconImageURL={withIconUrlFallback(\n                  workForArticle.user.iconUrl,\n                )}\n                userFollowersCount={workForArticle.user.followersCount}\n                userBiography={workForArticle.user.biography ?? \"\"}\n                userEnBiography={workForArticle.user.enBiography ?? null}\n                userPromptonId={workForArticle.user.promptonUser?.id}\n                userWorksCount={workForArticle.user.worksCount}\n              />\n            </div>\n          )}\n          <div className=\"invisible flex w-full flex-col space-y-4 md:visible\">\n            <WorkNextAndPrevious work={work} />\n            <div className=\"flex w-full flex-col space-y-4\">\n              <div className=\"relative grid gap-4\">\n                {!isSubscriptionUser &&\n                  advertisements &&\n                  advertisements.randomCustomerAdvertisement && (\n                    <div className=\"relative border\">\n                      <Link\n                        onClick={onClickAdvertisement}\n                        target=\"_blank\"\n                        to={advertisements.randomCustomerAdvertisement.url}\n                      >\n                        <img\n                          src={\n                            advertisements.randomCustomerAdvertisement.imageUrl\n                          }\n                          alt=\"Advertisement\"\n                        />\n                      </Link>\n                      <div className=\"absolute top-0 right-0\">\n                        <CrossPlatformTooltip\n                          text={t(\n                            \"ææºåºƒå‘Šã§ã™ã€åºƒå‘Šä¸»æ§˜ã‚’å‹Ÿé›†ä¸­ã§ã™ã€‚ãƒ¡ãƒ¼ãƒ«ã¾ãŸã¯DMã«ã¦ã”é€£çµ¡ãã ã•ã„ã€‚\",\n                            \"This is a partnered advertisement. We are accepting new advertisers. Please contact us via email or DM.\",\n                          )}\n                        />\n                      </div>\n                    </div>\n                  )}\n                {!isSubscriptionUser && (\n                  <Link to=\"/generation\">\n                    <img\n                      src=\"https://assets.aipictors.com/Aipictors_01.webp\"\n                      alt=\"Aipictors Logo\"\n                    />\n                  </Link>\n                )}\n                {props.newComments && props.newComments.length > 0 && (\n                  <HomeNewSensitiveCommentsSection\n                    comments={props.newComments}\n                  />\n                )}\n                {props.awardWorks && (\n                  <HomeAwardWorksSection works={props.awardWorks} />\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <section className=\"m-auto space-y-4\">\n        {randomTag && (\n          <>\n            <div className=\"flex justify-between\">\n              <h2 className=\"items-center space-x-2 font-bold text-md\">\n                {t(\"ãŠã™ã™ã‚\", \"Recommended\")}\n              </h2>\n            </div>\n            <SensitiveWorkTagsWorks\n              tagName={randomTag}\n              rating={work.rating ?? \"R18\"}\n            />\n          </>\n        )}\n      </section>\n      {/* <div className=\"flex w-full flex-col space-y-4 md:hidden\">\n        <AppSideMenu />\n      </div> */}\n    </div>\n  )\n}\n\nconst _workQuery = graphql(\n  `query Work($id: ID!) {\n    work(id: $id) {\n      ...WorkArticle\n    }\n  }`,\n  [workArticleFragment],\n)\n\nconst sensitiveWorkQuery = graphql(\n  `query Work($id: ID!) {\n    work(id: $id) {\n      ...WorkArticle\n    }\n  }`,\n  [sensitiveWorkArticleFragment],\n)\n\nconst updateClickedCountCustomerAdvertisementMutation = graphql(\n  `mutation UpdateClickedCountCustomerAdvertisement($id: ID!) {\n    updateClickedCountCustomerAdvertisement(id: $id) {\n      id\n    }\n  }`,\n)\n\nconst viewerCurrentPassQuery = graphql(\n  `query ViewerCurrentPass {\n    viewer {\n      id\n      currentPass {\n        id\n        type\n      }\n    }\n  }`,\n)\n\nexport const SideMenuAdvertisementsFragment = graphql(\n  `fragment SideMenuAdvertisementsFields on CustomerAdvertisementNode @_unmask {\n      id\n      imageUrl\n      url\n      displayProbability\n      clickCount\n      impressionCount\n      isSensitive\n      createdAt\n      page\n      startAt\n      endAt\n      isActive\n  }`,\n)\n\nconst randomCustomerAdvertisementQuery = graphql(\n  `query RandomCustomerAdvertisement($where: RandomCustomerAdvertisementWhereInput!) {\n    randomCustomerAdvertisement(where: $where) {\n      ...SideMenuAdvertisementsFields\n    }\n  }`,\n  [SideMenuAdvertisementsFragment],\n)\n\nexport const userSensitiveSettingFragment = graphql(\n  `fragment UserSensitiveSetting on UserSettingNode @_unmask {\n      id\n  }`,\n)\n\nconst userSensitiveSettingQuery = graphql(\n  `query UserSensitiveSetting {\n    userSetting {\n      ...UserSensitiveSetting\n    }\n  }`,\n  [userSensitiveSettingFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.rankings._index/components/ranking-sensitive-work-list.tsx"},"span":[1464,1477],"sourceCode":"import { CroppedWorkSquare } from \"~/components/cropped-work-square\"\nimport { LikeButton } from \"~/components/like-button\"\nimport type { FragmentOf } from \"gql.tada\"\nimport { graphql } from \"gql.tada\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext } from \"react\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { UserNameBadge } from \"~/routes/($lang)._main._index/components/user-name-badge\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\n\ntype Props = {\n  awards: FragmentOf<typeof SensitiveWorkAwardListItemFragment>[]\n  year: number\n  month: number\n  day: number | null\n  weekIndex: number | null\n}\n\nexport function RankingSensitiveWorkList (props: Props) {\n  const appContext = useContext(AuthContext)\n\n  const works = props.awards\n\n  const { data: awardWorks } = useQuery(workAwardsQuery, {\n    skip: appContext.isLoading || appContext.isNotLoggedIn,\n    variables: {\n      offset: 0,\n      limit: 200,\n      where: {\n        year: props.year,\n        month: props.month,\n        ...(props.day && { day: props.day }),\n        ...(props.weekIndex && { weekIndex: props.weekIndex }),\n        isSensitive: true,\n      },\n    },\n  })\n\n  const workAwards = awardWorks?.workAwards ?? works\n\n  return (\n    <div className=\"flex flex-wrap justify-center gap-x-8 gap-y-8\">\n      {workAwards.map((workItem, index) => {\n        return (\n          <div\n            // biome-ignore lint/suspicious/noArrayIndexKey: <explanation>\n            key={index}\n            className=\"relative flex flex-col space-y-2\"\n          >\n            {workItem.work && (\n              <>\n                <div className=\"relative\">\n                  <CroppedWorkSquare\n                    workId={workItem.work.id}\n                    subWorksCount={workItem.work.subWorksCount}\n                    imageUrl={workItem.work.smallThumbnailImageURL}\n                    thumbnailImagePosition={\n                      workItem.work.thumbnailImagePosition ?? 0\n                    }\n                    size=\"md\"\n                    imageWidth={workItem.work.smallThumbnailImageWidth}\n                    imageHeight={workItem.work.smallThumbnailImageHeight}\n                    ranking={index + 1}\n                  />\n                  <div className=\"absolute right-0 bottom-0\">\n                    <LikeButton\n                      size={56}\n                      targetWorkId={workItem.work.id}\n                      targetWorkOwnerUserId={workItem.work.user?.id ?? \"\"}\n                      defaultLiked={workItem.work.isLiked}\n                      defaultLikedCount={0}\n                      isBackgroundNone={true}\n                      strokeWidth={2}\n                    />\n                  </div>\n                </div>\n                <p className=\"max-w-32 overflow-hidden text-ellipsis text-nowrap font-bold text-xs\">\n                  {workItem.work.title}\n                </p>\n                {workItem.work.user && (\n                  <UserNameBadge\n                    userId={workItem.work.user.id}\n                    userIconImageURL={withIconUrlFallback(\n                      workItem.work.user.iconUrl,\n                    )}\n                    name={workItem.work.user.name}\n                    width={\"md\"}\n                  />\n                )}\n              </>\n            )}\n          </div>\n        )\n      })}\n    </div>\n  )\n}\n\nexport const SensitiveWorkAwardListItemFragment = graphql(\n  `fragment SensitiveWorkAwardListItem on WorkAwardNode @_unmask {\n      id\n      index\n      dateText\n      work {\n        id\n        title\n        accessType\n        adminAccessType\n        type\n        likesCount\n        commentsCount\n        bookmarksCount\n        viewsCount\n        createdAt\n        rating\n        isTagEditable\n        smallThumbnailImageURL\n        smallThumbnailImageHeight\n        smallThumbnailImageWidth\n        largeThumbnailImageURL\n        largeThumbnailImageHeight\n        largeThumbnailImageWidth\n        type\n        prompt\n        negativePrompt\n        isLiked\n        thumbnailImagePosition\n        description\n        url\n        subWorksCount\n        tags {\n          name\n        }\n        user {\n          id\n          name\n          iconUrl\n        }\n      }\n  }`,\n)\n\nconst workAwardsQuery = graphql(\n  `query WorkAwards($offset: Int!, $limit: Int!, $where: WorkAwardsWhereInput!) {\n    workAwards(offset: $offset, limit: $limit, where: $where) {\n      ...SensitiveWorkAwardListItem\n    }\n  }`,\n  [SensitiveWorkAwardListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.rankings._index/components/ranking-work-list.tsx"},"span":[3942,3955],"sourceCode":"import { CroppedWorkSquare } from \"~/components/cropped-work-square\"\nimport { LikeButton } from \"~/components/like-button\"\nimport type { FragmentOf } from \"gql.tada\"\nimport { graphql } from \"gql.tada\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext } from \"react\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { UserNameBadge } from \"~/routes/($lang)._main._index/components/user-name-badge\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\n\ntype Props = {\n  awards: FragmentOf<typeof WorkAwardListItemFragment>[]\n  year: number\n  month: number\n  day: number | null\n  weekIndex: number | null\n}\n\nexport function RankingWorkList (props: Props) {\n  const appContext = useContext(AuthContext)\n\n  const works = props.awards\n\n  const { data: awardWorks } = useQuery(workAwardsQuery, {\n    skip: appContext.isLoading || appContext.isNotLoggedIn,\n    variables: {\n      offset: 0,\n      limit: 200,\n      where: {\n        year: props.year,\n        month: props.month,\n        ...(props.day && { day: props.day }),\n        ...(props.weekIndex && { weekIndex: props.weekIndex }),\n      },\n    },\n  })\n\n  const workAwards = awardWorks?.workAwards ?? works\n\n  return (\n    <>\n      <div className=\"hidden flex-wrap justify-center gap-x-4 gap-y-4 md:flex\">\n        {workAwards.map((workItem, index) => {\n          return (\n            <div\n              // biome-ignore lint/suspicious/noArrayIndexKey: <explanation>\n              key={index}\n              className=\"relative flex flex-col space-y-4\"\n            >\n              {workItem.work && (\n                <div className=\"relative flex w-32 flex-col space-y-2\">\n                  <div className=\"relative\">\n                    <CroppedWorkSquare\n                      workId={workItem.work.id}\n                      subWorksCount={workItem.work.subWorksCount}\n                      imageUrl={workItem.work.smallThumbnailImageURL}\n                      thumbnailImagePosition={\n                        workItem.work.thumbnailImagePosition ?? 0\n                      }\n                      size=\"md\"\n                      imageWidth={workItem.work.smallThumbnailImageWidth}\n                      imageHeight={workItem.work.smallThumbnailImageHeight}\n                      ranking={index + 1}\n                      commentsCount={workItem.work.commentsCount}\n                    />\n                    <div className=\"absolute right-0 bottom-0\">\n                      <LikeButton\n                        size={56}\n                        targetWorkId={workItem.work.id}\n                        targetWorkOwnerUserId={workItem.work.user?.id ?? \"\"}\n                        defaultLiked={workItem.work.isLiked}\n                        defaultLikedCount={0}\n                        isBackgroundNone={true}\n                        strokeWidth={2}\n                      />\n                    </div>\n                  </div>\n                  <p className=\"max-w-32 overflow-hidden text-ellipsis text-nowrap font-bold text-xs\">\n                    {workItem.work.title}\n                  </p>\n                  {workItem.work.user && (\n                    <UserNameBadge\n                      userId={workItem.work.user.id}\n                      userIconImageURL={withIconUrlFallback(\n                        workItem.work.user.iconUrl,\n                      )}\n                      name={workItem.work.user.name}\n                      width={\"md\"}\n                      likesCount={workItem.work.likesCount}\n                      snapshotLikedCount={workItem.snapshotLikedCount}\n                    />\n                  )}\n                </div>\n              )}\n            </div>\n          )\n        })}\n      </div>\n      <div className=\"flex flex-wrap justify-center gap-x-8 gap-y-8 md:hidden\">\n        {workAwards.map((workItem, index) => {\n          return (\n            <div\n              // biome-ignore lint/suspicious/noArrayIndexKey: <explanation>\n              key={index}\n              className=\"relative flex flex-col space-y-2\"\n            >\n              {workItem.work && (\n                <>\n                  <div className=\"relative\">\n                    <CroppedWorkSquare\n                      workId={workItem.work.id}\n                      subWorksCount={workItem.work.subWorksCount}\n                      imageUrl={workItem.work.smallThumbnailImageURL}\n                      thumbnailImagePosition={\n                        workItem.work.thumbnailImagePosition ?? 0\n                      }\n                      size=\"md\"\n                      imageWidth={workItem.work.smallThumbnailImageWidth}\n                      imageHeight={workItem.work.smallThumbnailImageHeight}\n                      ranking={index + 1}\n                      commentsCount={workItem.work.commentsCount}\n                    />\n                    <div className=\"absolute right-0 bottom-0\">\n                      <LikeButton\n                        size={56}\n                        targetWorkId={workItem.work.id}\n                        targetWorkOwnerUserId={workItem.work.user?.id ?? \"\"}\n                        defaultLiked={workItem.work.isLiked}\n                        defaultLikedCount={0}\n                        isBackgroundNone={true}\n                        strokeWidth={2}\n                      />\n                    </div>\n                  </div>\n                  <p className=\"max-w-32 overflow-hidden text-ellipsis text-nowrap font-bold text-xs\">\n                    {workItem.work.title}\n                  </p>\n                  {workItem.work.user && (\n                    <UserNameBadge\n                      userId={workItem.work.user.id}\n                      userIconImageURL={withIconUrlFallback(\n                        workItem.work.user.iconUrl,\n                      )}\n                      name={workItem.work.user.name}\n                      width={\"sm\"}\n                      likesCount={workItem.work.likesCount}\n                    />\n                  )}\n                </>\n              )}\n            </div>\n          )\n        })}\n      </div>\n    </>\n  )\n}\n\nexport const WorkAwardListItemFragment = graphql(\n  `fragment WorkAwardListItem on WorkAwardNode @_unmask {\n      id\n      index\n      dateText\n      snapshotLikedCount\n      work {\n        id\n        title\n        accessType\n        adminAccessType\n        type\n        likesCount\n        commentsCount\n        bookmarksCount\n        viewsCount\n        createdAt\n        rating\n        isTagEditable\n        smallThumbnailImageURL\n        smallThumbnailImageHeight\n        smallThumbnailImageWidth\n        largeThumbnailImageURL\n        largeThumbnailImageHeight\n        largeThumbnailImageWidth\n        type\n        prompt\n        negativePrompt\n        isLiked\n        thumbnailImagePosition\n        description\n        url\n        subWorksCount\n        tags {\n          name\n        }\n        user {\n          id\n          name\n          iconUrl\n        }\n      }\n  }`,\n)\n\nconst workAwardsQuery = graphql(\n  `query WorkAwards($offset: Int!, $limit: Int!, $where: WorkAwardsWhereInput!) {\n    workAwards(offset: $offset, limit: $limit, where: $where) {\n      ...WorkAwardListItem\n    }\n  }`,\n  [WorkAwardListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.rankings._index/components/ranking-work-list.tsx"},"span":[1446,1459],"sourceCode":"import { CroppedWorkSquare } from \"~/components/cropped-work-square\"\nimport { LikeButton } from \"~/components/like-button\"\nimport type { FragmentOf } from \"gql.tada\"\nimport { graphql } from \"gql.tada\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext } from \"react\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { UserNameBadge } from \"~/routes/($lang)._main._index/components/user-name-badge\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\n\ntype Props = {\n  awards: FragmentOf<typeof WorkAwardListItemFragment>[]\n  year: number\n  month: number\n  day: number | null\n  weekIndex: number | null\n}\n\nexport function RankingWorkList (props: Props) {\n  const appContext = useContext(AuthContext)\n\n  const works = props.awards\n\n  const { data: awardWorks } = useQuery(workAwardsQuery, {\n    skip: appContext.isLoading || appContext.isNotLoggedIn,\n    variables: {\n      offset: 0,\n      limit: 200,\n      where: {\n        year: props.year,\n        month: props.month,\n        ...(props.day && { day: props.day }),\n        ...(props.weekIndex && { weekIndex: props.weekIndex }),\n      },\n    },\n  })\n\n  const workAwards = awardWorks?.workAwards ?? works\n\n  return (\n    <>\n      <div className=\"hidden flex-wrap justify-center gap-x-4 gap-y-4 md:flex\">\n        {workAwards.map((workItem, index) => {\n          return (\n            <div\n              // biome-ignore lint/suspicious/noArrayIndexKey: <explanation>\n              key={index}\n              className=\"relative flex flex-col space-y-4\"\n            >\n              {workItem.work && (\n                <div className=\"relative flex w-32 flex-col space-y-2\">\n                  <div className=\"relative\">\n                    <CroppedWorkSquare\n                      workId={workItem.work.id}\n                      subWorksCount={workItem.work.subWorksCount}\n                      imageUrl={workItem.work.smallThumbnailImageURL}\n                      thumbnailImagePosition={\n                        workItem.work.thumbnailImagePosition ?? 0\n                      }\n                      size=\"md\"\n                      imageWidth={workItem.work.smallThumbnailImageWidth}\n                      imageHeight={workItem.work.smallThumbnailImageHeight}\n                      ranking={index + 1}\n                      commentsCount={workItem.work.commentsCount}\n                    />\n                    <div className=\"absolute right-0 bottom-0\">\n                      <LikeButton\n                        size={56}\n                        targetWorkId={workItem.work.id}\n                        targetWorkOwnerUserId={workItem.work.user?.id ?? \"\"}\n                        defaultLiked={workItem.work.isLiked}\n                        defaultLikedCount={0}\n                        isBackgroundNone={true}\n                        strokeWidth={2}\n                      />\n                    </div>\n                  </div>\n                  <p className=\"max-w-32 overflow-hidden text-ellipsis text-nowrap font-bold text-xs\">\n                    {workItem.work.title}\n                  </p>\n                  {workItem.work.user && (\n                    <UserNameBadge\n                      userId={workItem.work.user.id}\n                      userIconImageURL={withIconUrlFallback(\n                        workItem.work.user.iconUrl,\n                      )}\n                      name={workItem.work.user.name}\n                      width={\"md\"}\n                      likesCount={workItem.work.likesCount}\n                      snapshotLikedCount={workItem.snapshotLikedCount}\n                    />\n                  )}\n                </div>\n              )}\n            </div>\n          )\n        })}\n      </div>\n      <div className=\"flex flex-wrap justify-center gap-x-8 gap-y-8 md:hidden\">\n        {workAwards.map((workItem, index) => {\n          return (\n            <div\n              // biome-ignore lint/suspicious/noArrayIndexKey: <explanation>\n              key={index}\n              className=\"relative flex flex-col space-y-2\"\n            >\n              {workItem.work && (\n                <>\n                  <div className=\"relative\">\n                    <CroppedWorkSquare\n                      workId={workItem.work.id}\n                      subWorksCount={workItem.work.subWorksCount}\n                      imageUrl={workItem.work.smallThumbnailImageURL}\n                      thumbnailImagePosition={\n                        workItem.work.thumbnailImagePosition ?? 0\n                      }\n                      size=\"md\"\n                      imageWidth={workItem.work.smallThumbnailImageWidth}\n                      imageHeight={workItem.work.smallThumbnailImageHeight}\n                      ranking={index + 1}\n                      commentsCount={workItem.work.commentsCount}\n                    />\n                    <div className=\"absolute right-0 bottom-0\">\n                      <LikeButton\n                        size={56}\n                        targetWorkId={workItem.work.id}\n                        targetWorkOwnerUserId={workItem.work.user?.id ?? \"\"}\n                        defaultLiked={workItem.work.isLiked}\n                        defaultLikedCount={0}\n                        isBackgroundNone={true}\n                        strokeWidth={2}\n                      />\n                    </div>\n                  </div>\n                  <p className=\"max-w-32 overflow-hidden text-ellipsis text-nowrap font-bold text-xs\">\n                    {workItem.work.title}\n                  </p>\n                  {workItem.work.user && (\n                    <UserNameBadge\n                      userId={workItem.work.user.id}\n                      userIconImageURL={withIconUrlFallback(\n                        workItem.work.user.iconUrl,\n                      )}\n                      name={workItem.work.user.name}\n                      width={\"sm\"}\n                      likesCount={workItem.work.likesCount}\n                    />\n                  )}\n                </>\n              )}\n            </div>\n          )\n        })}\n      </div>\n    </>\n  )\n}\n\nexport const WorkAwardListItemFragment = graphql(\n  `fragment WorkAwardListItem on WorkAwardNode @_unmask {\n      id\n      index\n      dateText\n      snapshotLikedCount\n      work {\n        id\n        title\n        accessType\n        adminAccessType\n        type\n        likesCount\n        commentsCount\n        bookmarksCount\n        viewsCount\n        createdAt\n        rating\n        isTagEditable\n        smallThumbnailImageURL\n        smallThumbnailImageHeight\n        smallThumbnailImageWidth\n        largeThumbnailImageURL\n        largeThumbnailImageHeight\n        largeThumbnailImageWidth\n        type\n        prompt\n        negativePrompt\n        isLiked\n        thumbnailImagePosition\n        description\n        url\n        subWorksCount\n        tags {\n          name\n        }\n        user {\n          id\n          name\n          iconUrl\n        }\n      }\n  }`,\n)\n\nconst workAwardsQuery = graphql(\n  `query WorkAwards($offset: Int!, $limit: Int!, $where: WorkAwardsWhereInput!) {\n    workAwards(offset: $offset, limit: $limit, where: $where) {\n      ...WorkAwardListItem\n    }\n  }`,\n  [WorkAwardListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.search/components/search-preview.tsx"},"span":[2183,2309],"sourceCode":"import type { CheckedState } from \"@radix-ui/react-checkbox\" // CheckedStateã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆãŒå¿…è¦ã‹ã‚‚\nimport { Search } from \"lucide-react\"\nimport { useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { Button } from \"~/components/ui/button\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { Input } from \"~/components/ui/input\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\nexport const SearchHeader = () => {\n  const [searchText, setSearchText] = useState(\"\")\n\n  const [isSensitive, setIsSensitive] = useState(false)\n\n  const t = useTranslation()\n\n  const onSearch = () => {\n    const trimmedText = searchText.trim()\n\n    // '#' ã‚’å–ã‚Šé™¤ã„ãŸæ–°ã—ã„æ–‡å­—åˆ—\n    const sanitizedText = trimmedText.replace(/#/g, \"\")\n\n    // ä»–ã®ç¦æ­¢æ–‡å­—ã‚’ãƒã‚§ãƒƒã‚¯\n    const invalidChars = [\"%\", \"/\", \"Â¥\"]\n    const hasInvalidChar = invalidChars.some((char) =>\n      sanitizedText.includes(char),\n    )\n\n    if (hasInvalidChar) {\n      toast(\"å…¥åŠ›ã•ã‚ŒãŸæ¤œç´¢æ–‡å­—åˆ—ã«ã¯ä½¿ç”¨ã§ããªã„æ–‡å­—ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚\")\n      return\n    }\n\n    if (trimmedText !== \"\") {\n      const baseUrl = isSensitive\n        ? `/r/tags/${trimmedText}`\n        : `/tags/${trimmedText}`\n      window.location.href = baseUrl\n    } else {\n      toast(t(\"æ¤œç´¢ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a search word\"))\n    }\n  }\n\n  const handleCheckboxChange = (checked: CheckedState) => {\n    setIsSensitive(checked === true)\n  }\n\n  const handleKeyDown = (event: React.KeyboardEvent) => {\n    if (event.key === \"Enter\") {\n      onSearch()\n    }\n  }\n\n  return (\n    <div className=\"flex flex-col space-y-4\">\n      <div className=\"flex space-x-2\">\n        <div className=\"w-full flex-1\">\n          <Input\n            placeholder={t(\"ã‚¿ã‚°ã§æ¤œç´¢\", \"Search by tag\")}\n            value={searchText}\n            onChange={(e) => setSearchText(e.target.value)}\n            onKeyDown={handleKeyDown}\n          />\n        </div>\n        <Button onClick={onSearch} variant={\"ghost\"} size={\"icon\"}>\n          <Search className=\"w-16\" />\n        </Button>\n      </div>\n      <div className=\"flex items-center space-x-2 opacity-50\">\n        <Checkbox\n          id=\"sensitive\"\n          checked={isSensitive}\n          onCheckedChange={handleCheckboxChange}\n        />\n        <label htmlFor=\"sensitive\" className=\"font-medium text-sm leading-none\">\n          {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")}\n        </label>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.stickers._index/components/add-sticker-modal.tsx"},"span":[2175,2198],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\n\ntype Props = {\n  isOpen: boolean\n  onClose(): void\n}\n\nexport function AddStickerModal (props: Props) {\n  return (\n    <Dialog\n      onOpenChange={() => {\n        props.onClose()\n      }}\n      open={props.isOpen}\n    >\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>{\"ã‚¹ã‚¿ãƒ³ãƒ—å…¬é–‹\"}</DialogTitle>\n        </DialogHeader>\n        <div className=\"flex flex-col space-y-2\">\n          <p>{\"éå…¬é–‹ã®ä½œæˆæ¸ˆã¿ã‚¹ã‚¿ãƒ³ãƒ—\"}</p>\n          <div className=\"flex\">\n            <img alt={\"\"} className=\"size-9\" src=\"gibbresh.png\" />\n            <img alt=\"\" className=\"size-9\" src=\"gibbresh.png\" />\n          </div>\n          <p>{\"é¸æŠã‚¹ã‚¿ãƒ³ãƒ—\"}</p>\n          <img alt=\"\" className=\"size-9\" src=\"gibbresh.png\" />\n          <p>{\"ã‚¿ã‚¤ãƒˆãƒ«\"}</p>\n          <Input placeholder=\"ã‚¿ã‚¤ãƒˆãƒ«\" />\n          <div className=\"flex flex-col\">\n            <p className=\"py-2\">{\"ã‚¸ãƒ£ãƒ³ãƒ«\"}</p>\n            <div className=\"flex space-x-4\">\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"äººç‰©\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"å‹•ç‰©\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"æ©Ÿæ¢°\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"èƒŒæ™¯\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"ç‰©\"}</span>\n              </div>\n            </div>\n          </div>\n          <p>{\"ã‚¿ã‚°\"}</p>\n          <div className=\"flex space-x-4\">\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"äººç‰©\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"å‹•ç‰©\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"æ©Ÿæ¢°\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"èƒŒæ™¯\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"ç‰©\"}</span>\n            </div>\n          </div>\n        </div>\n        <DialogFooter>\n          <Button>{\"è¿½åŠ \"}</Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.stickers._index/components/add-sticker-modal.tsx"},"span":[2323,2346],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\n\ntype Props = {\n  isOpen: boolean\n  onClose(): void\n}\n\nexport function AddStickerModal (props: Props) {\n  return (\n    <Dialog\n      onOpenChange={() => {\n        props.onClose()\n      }}\n      open={props.isOpen}\n    >\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>{\"ã‚¹ã‚¿ãƒ³ãƒ—å…¬é–‹\"}</DialogTitle>\n        </DialogHeader>\n        <div className=\"flex flex-col space-y-2\">\n          <p>{\"éå…¬é–‹ã®ä½œæˆæ¸ˆã¿ã‚¹ã‚¿ãƒ³ãƒ—\"}</p>\n          <div className=\"flex\">\n            <img alt={\"\"} className=\"size-9\" src=\"gibbresh.png\" />\n            <img alt=\"\" className=\"size-9\" src=\"gibbresh.png\" />\n          </div>\n          <p>{\"é¸æŠã‚¹ã‚¿ãƒ³ãƒ—\"}</p>\n          <img alt=\"\" className=\"size-9\" src=\"gibbresh.png\" />\n          <p>{\"ã‚¿ã‚¤ãƒˆãƒ«\"}</p>\n          <Input placeholder=\"ã‚¿ã‚¤ãƒˆãƒ«\" />\n          <div className=\"flex flex-col\">\n            <p className=\"py-2\">{\"ã‚¸ãƒ£ãƒ³ãƒ«\"}</p>\n            <div className=\"flex space-x-4\">\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"äººç‰©\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"å‹•ç‰©\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"æ©Ÿæ¢°\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"èƒŒæ™¯\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"ç‰©\"}</span>\n              </div>\n            </div>\n          </div>\n          <p>{\"ã‚¿ã‚°\"}</p>\n          <div className=\"flex space-x-4\">\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"äººç‰©\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"å‹•ç‰©\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"æ©Ÿæ¢°\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"èƒŒæ™¯\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"ç‰©\"}</span>\n            </div>\n          </div>\n        </div>\n        <DialogFooter>\n          <Button>{\"è¿½åŠ \"}</Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.stickers._index/components/add-sticker-modal.tsx"},"span":[2471,2494],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\n\ntype Props = {\n  isOpen: boolean\n  onClose(): void\n}\n\nexport function AddStickerModal (props: Props) {\n  return (\n    <Dialog\n      onOpenChange={() => {\n        props.onClose()\n      }}\n      open={props.isOpen}\n    >\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>{\"ã‚¹ã‚¿ãƒ³ãƒ—å…¬é–‹\"}</DialogTitle>\n        </DialogHeader>\n        <div className=\"flex flex-col space-y-2\">\n          <p>{\"éå…¬é–‹ã®ä½œæˆæ¸ˆã¿ã‚¹ã‚¿ãƒ³ãƒ—\"}</p>\n          <div className=\"flex\">\n            <img alt={\"\"} className=\"size-9\" src=\"gibbresh.png\" />\n            <img alt=\"\" className=\"size-9\" src=\"gibbresh.png\" />\n          </div>\n          <p>{\"é¸æŠã‚¹ã‚¿ãƒ³ãƒ—\"}</p>\n          <img alt=\"\" className=\"size-9\" src=\"gibbresh.png\" />\n          <p>{\"ã‚¿ã‚¤ãƒˆãƒ«\"}</p>\n          <Input placeholder=\"ã‚¿ã‚¤ãƒˆãƒ«\" />\n          <div className=\"flex flex-col\">\n            <p className=\"py-2\">{\"ã‚¸ãƒ£ãƒ³ãƒ«\"}</p>\n            <div className=\"flex space-x-4\">\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"äººç‰©\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"å‹•ç‰©\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"æ©Ÿæ¢°\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"èƒŒæ™¯\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"ç‰©\"}</span>\n              </div>\n            </div>\n          </div>\n          <p>{\"ã‚¿ã‚°\"}</p>\n          <div className=\"flex space-x-4\">\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"äººç‰©\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"å‹•ç‰©\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"æ©Ÿæ¢°\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"èƒŒæ™¯\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"ç‰©\"}</span>\n            </div>\n          </div>\n        </div>\n        <DialogFooter>\n          <Button>{\"è¿½åŠ \"}</Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.stickers._index/components/add-sticker-modal.tsx"},"span":[2619,2642],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\n\ntype Props = {\n  isOpen: boolean\n  onClose(): void\n}\n\nexport function AddStickerModal (props: Props) {\n  return (\n    <Dialog\n      onOpenChange={() => {\n        props.onClose()\n      }}\n      open={props.isOpen}\n    >\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>{\"ã‚¹ã‚¿ãƒ³ãƒ—å…¬é–‹\"}</DialogTitle>\n        </DialogHeader>\n        <div className=\"flex flex-col space-y-2\">\n          <p>{\"éå…¬é–‹ã®ä½œæˆæ¸ˆã¿ã‚¹ã‚¿ãƒ³ãƒ—\"}</p>\n          <div className=\"flex\">\n            <img alt={\"\"} className=\"size-9\" src=\"gibbresh.png\" />\n            <img alt=\"\" className=\"size-9\" src=\"gibbresh.png\" />\n          </div>\n          <p>{\"é¸æŠã‚¹ã‚¿ãƒ³ãƒ—\"}</p>\n          <img alt=\"\" className=\"size-9\" src=\"gibbresh.png\" />\n          <p>{\"ã‚¿ã‚¤ãƒˆãƒ«\"}</p>\n          <Input placeholder=\"ã‚¿ã‚¤ãƒˆãƒ«\" />\n          <div className=\"flex flex-col\">\n            <p className=\"py-2\">{\"ã‚¸ãƒ£ãƒ³ãƒ«\"}</p>\n            <div className=\"flex space-x-4\">\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"äººç‰©\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"å‹•ç‰©\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"æ©Ÿæ¢°\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"èƒŒæ™¯\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"ç‰©\"}</span>\n              </div>\n            </div>\n          </div>\n          <p>{\"ã‚¿ã‚°\"}</p>\n          <div className=\"flex space-x-4\">\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"äººç‰©\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"å‹•ç‰©\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"æ©Ÿæ¢°\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"èƒŒæ™¯\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"ç‰©\"}</span>\n            </div>\n          </div>\n        </div>\n        <DialogFooter>\n          <Button>{\"è¿½åŠ \"}</Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.stickers._index/components/add-sticker-modal.tsx"},"span":[2767,2790],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\n\ntype Props = {\n  isOpen: boolean\n  onClose(): void\n}\n\nexport function AddStickerModal (props: Props) {\n  return (\n    <Dialog\n      onOpenChange={() => {\n        props.onClose()\n      }}\n      open={props.isOpen}\n    >\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>{\"ã‚¹ã‚¿ãƒ³ãƒ—å…¬é–‹\"}</DialogTitle>\n        </DialogHeader>\n        <div className=\"flex flex-col space-y-2\">\n          <p>{\"éå…¬é–‹ã®ä½œæˆæ¸ˆã¿ã‚¹ã‚¿ãƒ³ãƒ—\"}</p>\n          <div className=\"flex\">\n            <img alt={\"\"} className=\"size-9\" src=\"gibbresh.png\" />\n            <img alt=\"\" className=\"size-9\" src=\"gibbresh.png\" />\n          </div>\n          <p>{\"é¸æŠã‚¹ã‚¿ãƒ³ãƒ—\"}</p>\n          <img alt=\"\" className=\"size-9\" src=\"gibbresh.png\" />\n          <p>{\"ã‚¿ã‚¤ãƒˆãƒ«\"}</p>\n          <Input placeholder=\"ã‚¿ã‚¤ãƒˆãƒ«\" />\n          <div className=\"flex flex-col\">\n            <p className=\"py-2\">{\"ã‚¸ãƒ£ãƒ³ãƒ«\"}</p>\n            <div className=\"flex space-x-4\">\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"äººç‰©\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"å‹•ç‰©\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"æ©Ÿæ¢°\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"èƒŒæ™¯\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"ç‰©\"}</span>\n              </div>\n            </div>\n          </div>\n          <p>{\"ã‚¿ã‚°\"}</p>\n          <div className=\"flex space-x-4\">\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"äººç‰©\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"å‹•ç‰©\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"æ©Ÿæ¢°\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"èƒŒæ™¯\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"ç‰©\"}</span>\n            </div>\n          </div>\n        </div>\n        <DialogFooter>\n          <Button>{\"è¿½åŠ \"}</Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.stickers._index/components/add-sticker-modal.tsx"},"span":[1295,1318],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\n\ntype Props = {\n  isOpen: boolean\n  onClose(): void\n}\n\nexport function AddStickerModal (props: Props) {\n  return (\n    <Dialog\n      onOpenChange={() => {\n        props.onClose()\n      }}\n      open={props.isOpen}\n    >\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>{\"ã‚¹ã‚¿ãƒ³ãƒ—å…¬é–‹\"}</DialogTitle>\n        </DialogHeader>\n        <div className=\"flex flex-col space-y-2\">\n          <p>{\"éå…¬é–‹ã®ä½œæˆæ¸ˆã¿ã‚¹ã‚¿ãƒ³ãƒ—\"}</p>\n          <div className=\"flex\">\n            <img alt={\"\"} className=\"size-9\" src=\"gibbresh.png\" />\n            <img alt=\"\" className=\"size-9\" src=\"gibbresh.png\" />\n          </div>\n          <p>{\"é¸æŠã‚¹ã‚¿ãƒ³ãƒ—\"}</p>\n          <img alt=\"\" className=\"size-9\" src=\"gibbresh.png\" />\n          <p>{\"ã‚¿ã‚¤ãƒˆãƒ«\"}</p>\n          <Input placeholder=\"ã‚¿ã‚¤ãƒˆãƒ«\" />\n          <div className=\"flex flex-col\">\n            <p className=\"py-2\">{\"ã‚¸ãƒ£ãƒ³ãƒ«\"}</p>\n            <div className=\"flex space-x-4\">\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"äººç‰©\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"å‹•ç‰©\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"æ©Ÿæ¢°\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"èƒŒæ™¯\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"ç‰©\"}</span>\n              </div>\n            </div>\n          </div>\n          <p>{\"ã‚¿ã‚°\"}</p>\n          <div className=\"flex space-x-4\">\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"äººç‰©\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"å‹•ç‰©\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"æ©Ÿæ¢°\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"èƒŒæ™¯\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"ç‰©\"}</span>\n            </div>\n          </div>\n        </div>\n        <DialogFooter>\n          <Button>{\"è¿½åŠ \"}</Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.stickers._index/components/add-sticker-modal.tsx"},"span":[1451,1474],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\n\ntype Props = {\n  isOpen: boolean\n  onClose(): void\n}\n\nexport function AddStickerModal (props: Props) {\n  return (\n    <Dialog\n      onOpenChange={() => {\n        props.onClose()\n      }}\n      open={props.isOpen}\n    >\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>{\"ã‚¹ã‚¿ãƒ³ãƒ—å…¬é–‹\"}</DialogTitle>\n        </DialogHeader>\n        <div className=\"flex flex-col space-y-2\">\n          <p>{\"éå…¬é–‹ã®ä½œæˆæ¸ˆã¿ã‚¹ã‚¿ãƒ³ãƒ—\"}</p>\n          <div className=\"flex\">\n            <img alt={\"\"} className=\"size-9\" src=\"gibbresh.png\" />\n            <img alt=\"\" className=\"size-9\" src=\"gibbresh.png\" />\n          </div>\n          <p>{\"é¸æŠã‚¹ã‚¿ãƒ³ãƒ—\"}</p>\n          <img alt=\"\" className=\"size-9\" src=\"gibbresh.png\" />\n          <p>{\"ã‚¿ã‚¤ãƒˆãƒ«\"}</p>\n          <Input placeholder=\"ã‚¿ã‚¤ãƒˆãƒ«\" />\n          <div className=\"flex flex-col\">\n            <p className=\"py-2\">{\"ã‚¸ãƒ£ãƒ³ãƒ«\"}</p>\n            <div className=\"flex space-x-4\">\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"äººç‰©\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"å‹•ç‰©\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"æ©Ÿæ¢°\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"èƒŒæ™¯\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"ç‰©\"}</span>\n              </div>\n            </div>\n          </div>\n          <p>{\"ã‚¿ã‚°\"}</p>\n          <div className=\"flex space-x-4\">\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"äººç‰©\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"å‹•ç‰©\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"æ©Ÿæ¢°\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"èƒŒæ™¯\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"ç‰©\"}</span>\n            </div>\n          </div>\n        </div>\n        <DialogFooter>\n          <Button>{\"è¿½åŠ \"}</Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.stickers._index/components/add-sticker-modal.tsx"},"span":[1607,1630],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\n\ntype Props = {\n  isOpen: boolean\n  onClose(): void\n}\n\nexport function AddStickerModal (props: Props) {\n  return (\n    <Dialog\n      onOpenChange={() => {\n        props.onClose()\n      }}\n      open={props.isOpen}\n    >\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>{\"ã‚¹ã‚¿ãƒ³ãƒ—å…¬é–‹\"}</DialogTitle>\n        </DialogHeader>\n        <div className=\"flex flex-col space-y-2\">\n          <p>{\"éå…¬é–‹ã®ä½œæˆæ¸ˆã¿ã‚¹ã‚¿ãƒ³ãƒ—\"}</p>\n          <div className=\"flex\">\n            <img alt={\"\"} className=\"size-9\" src=\"gibbresh.png\" />\n            <img alt=\"\" className=\"size-9\" src=\"gibbresh.png\" />\n          </div>\n          <p>{\"é¸æŠã‚¹ã‚¿ãƒ³ãƒ—\"}</p>\n          <img alt=\"\" className=\"size-9\" src=\"gibbresh.png\" />\n          <p>{\"ã‚¿ã‚¤ãƒˆãƒ«\"}</p>\n          <Input placeholder=\"ã‚¿ã‚¤ãƒˆãƒ«\" />\n          <div className=\"flex flex-col\">\n            <p className=\"py-2\">{\"ã‚¸ãƒ£ãƒ³ãƒ«\"}</p>\n            <div className=\"flex space-x-4\">\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"äººç‰©\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"å‹•ç‰©\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"æ©Ÿæ¢°\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"èƒŒæ™¯\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"ç‰©\"}</span>\n              </div>\n            </div>\n          </div>\n          <p>{\"ã‚¿ã‚°\"}</p>\n          <div className=\"flex space-x-4\">\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"äººç‰©\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"å‹•ç‰©\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"æ©Ÿæ¢°\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"èƒŒæ™¯\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"ç‰©\"}</span>\n            </div>\n          </div>\n        </div>\n        <DialogFooter>\n          <Button>{\"è¿½åŠ \"}</Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.stickers._index/components/add-sticker-modal.tsx"},"span":[1763,1786],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\n\ntype Props = {\n  isOpen: boolean\n  onClose(): void\n}\n\nexport function AddStickerModal (props: Props) {\n  return (\n    <Dialog\n      onOpenChange={() => {\n        props.onClose()\n      }}\n      open={props.isOpen}\n    >\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>{\"ã‚¹ã‚¿ãƒ³ãƒ—å…¬é–‹\"}</DialogTitle>\n        </DialogHeader>\n        <div className=\"flex flex-col space-y-2\">\n          <p>{\"éå…¬é–‹ã®ä½œæˆæ¸ˆã¿ã‚¹ã‚¿ãƒ³ãƒ—\"}</p>\n          <div className=\"flex\">\n            <img alt={\"\"} className=\"size-9\" src=\"gibbresh.png\" />\n            <img alt=\"\" className=\"size-9\" src=\"gibbresh.png\" />\n          </div>\n          <p>{\"é¸æŠã‚¹ã‚¿ãƒ³ãƒ—\"}</p>\n          <img alt=\"\" className=\"size-9\" src=\"gibbresh.png\" />\n          <p>{\"ã‚¿ã‚¤ãƒˆãƒ«\"}</p>\n          <Input placeholder=\"ã‚¿ã‚¤ãƒˆãƒ«\" />\n          <div className=\"flex flex-col\">\n            <p className=\"py-2\">{\"ã‚¸ãƒ£ãƒ³ãƒ«\"}</p>\n            <div className=\"flex space-x-4\">\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"äººç‰©\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"å‹•ç‰©\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"æ©Ÿæ¢°\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"èƒŒæ™¯\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"ç‰©\"}</span>\n              </div>\n            </div>\n          </div>\n          <p>{\"ã‚¿ã‚°\"}</p>\n          <div className=\"flex space-x-4\">\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"äººç‰©\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"å‹•ç‰©\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"æ©Ÿæ¢°\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"èƒŒæ™¯\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"ç‰©\"}</span>\n            </div>\n          </div>\n        </div>\n        <DialogFooter>\n          <Button>{\"è¿½åŠ \"}</Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.stickers._index/components/add-sticker-modal.tsx"},"span":[1919,1942],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\n\ntype Props = {\n  isOpen: boolean\n  onClose(): void\n}\n\nexport function AddStickerModal (props: Props) {\n  return (\n    <Dialog\n      onOpenChange={() => {\n        props.onClose()\n      }}\n      open={props.isOpen}\n    >\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>{\"ã‚¹ã‚¿ãƒ³ãƒ—å…¬é–‹\"}</DialogTitle>\n        </DialogHeader>\n        <div className=\"flex flex-col space-y-2\">\n          <p>{\"éå…¬é–‹ã®ä½œæˆæ¸ˆã¿ã‚¹ã‚¿ãƒ³ãƒ—\"}</p>\n          <div className=\"flex\">\n            <img alt={\"\"} className=\"size-9\" src=\"gibbresh.png\" />\n            <img alt=\"\" className=\"size-9\" src=\"gibbresh.png\" />\n          </div>\n          <p>{\"é¸æŠã‚¹ã‚¿ãƒ³ãƒ—\"}</p>\n          <img alt=\"\" className=\"size-9\" src=\"gibbresh.png\" />\n          <p>{\"ã‚¿ã‚¤ãƒˆãƒ«\"}</p>\n          <Input placeholder=\"ã‚¿ã‚¤ãƒˆãƒ«\" />\n          <div className=\"flex flex-col\">\n            <p className=\"py-2\">{\"ã‚¸ãƒ£ãƒ³ãƒ«\"}</p>\n            <div className=\"flex space-x-4\">\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"äººç‰©\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"å‹•ç‰©\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"æ©Ÿæ¢°\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"èƒŒæ™¯\"}</span>\n              </div>\n              <div className=\"items-center space-x-2\">\n                <Checkbox id=\"terms\" />\n                <span>{\"ç‰©\"}</span>\n              </div>\n            </div>\n          </div>\n          <p>{\"ã‚¿ã‚°\"}</p>\n          <div className=\"flex space-x-4\">\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"äººç‰©\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"å‹•ç‰©\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"æ©Ÿæ¢°\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"èƒŒæ™¯\"}</span>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <Checkbox id=\"terms\" />\n              <span>{\"ç‰©\"}</span>\n            </div>\n          </div>\n        </div>\n        <DialogFooter>\n          <Button>{\"è¿½åŠ \"}</Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable onOpen is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"onOpen"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.stickers._index/components/sticker-list-header.tsx"},"span":[818,824],"sourceCode":"import { AddStickerModal } from \"~/routes/($lang)._main.stickers._index/components/add-sticker-modal\"\nimport { useBoolean } from \"usehooks-ts\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { graphql } from \"gql.tada\"\nimport { StickerAccessTypeDialogFragment } from \"~/routes/($lang).settings.sticker/components/my-stickers-list\"\nimport { AddStickerDialog } from \"~/routes/($lang)._main.posts.$post._index/components/add-sticker-dialog\"\nimport { Button } from \"~/components/ui/button\"\nimport { PlusIcon } from \"lucide-react\"\nimport { useSuspenseQuery } from \"@apollo/client/index\"\nimport { useContext, useState } from \"react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\n\ntype Props = {\n  title?: string\n}\n\nexport function StickerListHeader (props: Props) {\n  const { value: isOpen, setTrue: onOpen, setFalse: onClose } = useBoolean()\n\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const [stickerStatus, _setStickerStatue] = useState<\n    \"PRIVATE_CREATED\" | \"DOWNLOADED\" | \"PUBLIC_CREATED\"\n  >(\"DOWNLOADED\")\n\n  const { data: stickersCount = null, refetch: reactStickers } =\n    useSuspenseQuery(viewerUserStickersCountQuery, {\n      skip: authContext.isLoading,\n      variables: {\n        orderBy: \"DATE_CREATED\",\n        where: {\n          savedTypes: [stickerStatus],\n        },\n      },\n    })\n\n  const [createdSortStickerPage, _setCreatedSortStickerPage] = useState(0)\n\n  const maxStickersPage = 120\n\n  const { data: stickers = null, refetch: reactStickersCount } =\n    useSuspenseQuery(viewerUserStickersQuery, {\n      skip: authContext.isLoading,\n      variables: {\n        limit: maxStickersPage,\n        offset: createdSortStickerPage * maxStickersPage,\n        orderBy: \"DATE_CREATED\",\n        where: {\n          savedTypes: [stickerStatus],\n        },\n      },\n    })\n\n  return (\n    <>\n      <section className=\"flex flex-col gap-y-2\">\n        <h1 className=\"font-bold text-2xl\">\n          {t(\"AIã‚¤ãƒ©ã‚¹ãƒˆã‚¹ã‚¿ãƒ³ãƒ—åºƒå ´\", \"AI Illustration Stamp Square\")}\n        </h1>\n        <AddStickerDialog\n          onAddedSicker={() => {\n            reactStickers()\n            reactStickersCount()\n          }}\n        >\n          <Button variant={\"secondary\"}>\n            {t(\"æ–°è¦ã‚¹ã‚¿ãƒ³ãƒ—ã‚’ä½œæˆã™ã‚‹\", \"New Sticker\")}\n            <PlusIcon className=\"w-8\" />\n          </Button>\n        </AddStickerDialog>\n        {props.title && (\n          <h2 className=\"text-bold\">\n            {t(\n              `ã€Œ${props.title}ã€ã®AIã‚¤ãƒ©ã‚¹ãƒˆã®ã‚¹ã‚¿ãƒ³ãƒ—ä¸€è¦§`,\n              `AI illustration sticker list for \"${props.title}\"`,\n            )}\n          </h2>\n        )}\n        <p className=\"text-sm\">\n          {t(\n            \"ä½œã£ãŸã‚¹ã‚¿ãƒ³ãƒ—ã‚’å…¬é–‹ã—ãŸã‚Šã€ã¿ã‚“ãªã®ä½œã£ãŸã‚¹ã‚¿ãƒ³ãƒ—ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ä½¿ã£ã¦ã¿ã¾ã—ã‚‡ã†ï¼\",\n            \"Let's share the stickers you've made, and try downloading and using the stickers made by everyone!\",\n          )}\n        </p>\n      </section>\n      <AddStickerModal isOpen={isOpen} onClose={onClose} />\n    </>\n  )\n}\n\nconst viewerUserStickersCountQuery = graphql(\n  `query ViewerUserStickersCount($where: UserStickersWhereInput) {\n    viewer {\n      id\n      userStickersCount(where: $where)\n    }\n  }`,\n)\n\nconst viewerUserStickersQuery = graphql(\n  `query ViewerUserStickers($offset: Int!, $limit: Int!, $orderBy: StickerOrderBy, $where: UserStickersWhereInput) {\n    viewer {\n      id\n      userStickers(offset: $offset, limit: $limit, orderBy: $orderBy, where: $where) {\n        ...StickerAccessTypeDialog\n      }\n    }\n  }`,\n  [StickerAccessTypeDialogFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable stickersCount is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"stickersCount"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.stickers._index/components/sticker-list-header.tsx"},"span":[1085,1098],"sourceCode":"import { AddStickerModal } from \"~/routes/($lang)._main.stickers._index/components/add-sticker-modal\"\nimport { useBoolean } from \"usehooks-ts\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { graphql } from \"gql.tada\"\nimport { StickerAccessTypeDialogFragment } from \"~/routes/($lang).settings.sticker/components/my-stickers-list\"\nimport { AddStickerDialog } from \"~/routes/($lang)._main.posts.$post._index/components/add-sticker-dialog\"\nimport { Button } from \"~/components/ui/button\"\nimport { PlusIcon } from \"lucide-react\"\nimport { useSuspenseQuery } from \"@apollo/client/index\"\nimport { useContext, useState } from \"react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\n\ntype Props = {\n  title?: string\n}\n\nexport function StickerListHeader (props: Props) {\n  const { value: isOpen, setTrue: onOpen, setFalse: onClose } = useBoolean()\n\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const [stickerStatus, _setStickerStatue] = useState<\n    \"PRIVATE_CREATED\" | \"DOWNLOADED\" | \"PUBLIC_CREATED\"\n  >(\"DOWNLOADED\")\n\n  const { data: stickersCount = null, refetch: reactStickers } =\n    useSuspenseQuery(viewerUserStickersCountQuery, {\n      skip: authContext.isLoading,\n      variables: {\n        orderBy: \"DATE_CREATED\",\n        where: {\n          savedTypes: [stickerStatus],\n        },\n      },\n    })\n\n  const [createdSortStickerPage, _setCreatedSortStickerPage] = useState(0)\n\n  const maxStickersPage = 120\n\n  const { data: stickers = null, refetch: reactStickersCount } =\n    useSuspenseQuery(viewerUserStickersQuery, {\n      skip: authContext.isLoading,\n      variables: {\n        limit: maxStickersPage,\n        offset: createdSortStickerPage * maxStickersPage,\n        orderBy: \"DATE_CREATED\",\n        where: {\n          savedTypes: [stickerStatus],\n        },\n      },\n    })\n\n  return (\n    <>\n      <section className=\"flex flex-col gap-y-2\">\n        <h1 className=\"font-bold text-2xl\">\n          {t(\"AIã‚¤ãƒ©ã‚¹ãƒˆã‚¹ã‚¿ãƒ³ãƒ—åºƒå ´\", \"AI Illustration Stamp Square\")}\n        </h1>\n        <AddStickerDialog\n          onAddedSicker={() => {\n            reactStickers()\n            reactStickersCount()\n          }}\n        >\n          <Button variant={\"secondary\"}>\n            {t(\"æ–°è¦ã‚¹ã‚¿ãƒ³ãƒ—ã‚’ä½œæˆã™ã‚‹\", \"New Sticker\")}\n            <PlusIcon className=\"w-8\" />\n          </Button>\n        </AddStickerDialog>\n        {props.title && (\n          <h2 className=\"text-bold\">\n            {t(\n              `ã€Œ${props.title}ã€ã®AIã‚¤ãƒ©ã‚¹ãƒˆã®ã‚¹ã‚¿ãƒ³ãƒ—ä¸€è¦§`,\n              `AI illustration sticker list for \"${props.title}\"`,\n            )}\n          </h2>\n        )}\n        <p className=\"text-sm\">\n          {t(\n            \"ä½œã£ãŸã‚¹ã‚¿ãƒ³ãƒ—ã‚’å…¬é–‹ã—ãŸã‚Šã€ã¿ã‚“ãªã®ä½œã£ãŸã‚¹ã‚¿ãƒ³ãƒ—ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ä½¿ã£ã¦ã¿ã¾ã—ã‚‡ã†ï¼\",\n            \"Let's share the stickers you've made, and try downloading and using the stickers made by everyone!\",\n          )}\n        </p>\n      </section>\n      <AddStickerModal isOpen={isOpen} onClose={onClose} />\n    </>\n  )\n}\n\nconst viewerUserStickersCountQuery = graphql(\n  `query ViewerUserStickersCount($where: UserStickersWhereInput) {\n    viewer {\n      id\n      userStickersCount(where: $where)\n    }\n  }`,\n)\n\nconst viewerUserStickersQuery = graphql(\n  `query ViewerUserStickers($offset: Int!, $limit: Int!, $orderBy: StickerOrderBy, $where: UserStickersWhereInput) {\n    viewer {\n      id\n      userStickers(offset: $offset, limit: $limit, orderBy: $orderBy, where: $where) {\n        ...StickerAccessTypeDialog\n      }\n    }\n  }`,\n  [StickerAccessTypeDialogFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable stickers is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"stickers"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.stickers._index/components/sticker-list-header.tsx"},"span":[1481,1489],"sourceCode":"import { AddStickerModal } from \"~/routes/($lang)._main.stickers._index/components/add-sticker-modal\"\nimport { useBoolean } from \"usehooks-ts\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { graphql } from \"gql.tada\"\nimport { StickerAccessTypeDialogFragment } from \"~/routes/($lang).settings.sticker/components/my-stickers-list\"\nimport { AddStickerDialog } from \"~/routes/($lang)._main.posts.$post._index/components/add-sticker-dialog\"\nimport { Button } from \"~/components/ui/button\"\nimport { PlusIcon } from \"lucide-react\"\nimport { useSuspenseQuery } from \"@apollo/client/index\"\nimport { useContext, useState } from \"react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\n\ntype Props = {\n  title?: string\n}\n\nexport function StickerListHeader (props: Props) {\n  const { value: isOpen, setTrue: onOpen, setFalse: onClose } = useBoolean()\n\n  const t = useTranslation()\n\n  const authContext = useContext(AuthContext)\n\n  const [stickerStatus, _setStickerStatue] = useState<\n    \"PRIVATE_CREATED\" | \"DOWNLOADED\" | \"PUBLIC_CREATED\"\n  >(\"DOWNLOADED\")\n\n  const { data: stickersCount = null, refetch: reactStickers } =\n    useSuspenseQuery(viewerUserStickersCountQuery, {\n      skip: authContext.isLoading,\n      variables: {\n        orderBy: \"DATE_CREATED\",\n        where: {\n          savedTypes: [stickerStatus],\n        },\n      },\n    })\n\n  const [createdSortStickerPage, _setCreatedSortStickerPage] = useState(0)\n\n  const maxStickersPage = 120\n\n  const { data: stickers = null, refetch: reactStickersCount } =\n    useSuspenseQuery(viewerUserStickersQuery, {\n      skip: authContext.isLoading,\n      variables: {\n        limit: maxStickersPage,\n        offset: createdSortStickerPage * maxStickersPage,\n        orderBy: \"DATE_CREATED\",\n        where: {\n          savedTypes: [stickerStatus],\n        },\n      },\n    })\n\n  return (\n    <>\n      <section className=\"flex flex-col gap-y-2\">\n        <h1 className=\"font-bold text-2xl\">\n          {t(\"AIã‚¤ãƒ©ã‚¹ãƒˆã‚¹ã‚¿ãƒ³ãƒ—åºƒå ´\", \"AI Illustration Stamp Square\")}\n        </h1>\n        <AddStickerDialog\n          onAddedSicker={() => {\n            reactStickers()\n            reactStickersCount()\n          }}\n        >\n          <Button variant={\"secondary\"}>\n            {t(\"æ–°è¦ã‚¹ã‚¿ãƒ³ãƒ—ã‚’ä½œæˆã™ã‚‹\", \"New Sticker\")}\n            <PlusIcon className=\"w-8\" />\n          </Button>\n        </AddStickerDialog>\n        {props.title && (\n          <h2 className=\"text-bold\">\n            {t(\n              `ã€Œ${props.title}ã€ã®AIã‚¤ãƒ©ã‚¹ãƒˆã®ã‚¹ã‚¿ãƒ³ãƒ—ä¸€è¦§`,\n              `AI illustration sticker list for \"${props.title}\"`,\n            )}\n          </h2>\n        )}\n        <p className=\"text-sm\">\n          {t(\n            \"ä½œã£ãŸã‚¹ã‚¿ãƒ³ãƒ—ã‚’å…¬é–‹ã—ãŸã‚Šã€ã¿ã‚“ãªã®ä½œã£ãŸã‚¹ã‚¿ãƒ³ãƒ—ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ä½¿ã£ã¦ã¿ã¾ã—ã‚‡ã†ï¼\",\n            \"Let's share the stickers you've made, and try downloading and using the stickers made by everyone!\",\n          )}\n        </p>\n      </section>\n      <AddStickerModal isOpen={isOpen} onClose={onClose} />\n    </>\n  )\n}\n\nconst viewerUserStickersCountQuery = graphql(\n  `query ViewerUserStickersCount($where: UserStickersWhereInput) {\n    viewer {\n      id\n      userStickersCount(where: $where)\n    }\n  }`,\n)\n\nconst viewerUserStickersQuery = graphql(\n  `query ViewerUserStickers($offset: Int!, $limit: Int!, $orderBy: StickerOrderBy, $where: UserStickersWhereInput) {\n    viewer {\n      id\n      userStickers(offset: $offset, limit: $limit, orderBy: $orderBy, where: $where) {\n        ...StickerAccessTypeDialog\n      }\n    }\n  }`,\n  [StickerAccessTypeDialogFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.support.chat/components/message-input.tsx"},"span":[1092,1105],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Textarea } from \"~/components/ui/textarea\"\nimport { RiCloseCircleLine } from \"@remixicon/react\"\nimport { Send } from \"lucide-react\"\nimport { useState } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  isLoading: boolean\n  onSubmit(message: string): void\n}\n\nexport function MessageInput (props: Props) {\n  const [message, setMessage] = useState(\"\")\n  const [selectedImages, setSelectedImages] = useState<string[]>([])\n  const t = useTranslation()\n\n  const handleSubmit = () => {\n    props.onSubmit(message)\n    setSelectedImages([])\n    setMessage(\"\")\n  }\n\n  const isSendButtonEnabled = message.trim() !== \"\" || selectedImages.length > 0\n\n  const handleDeleteImage = (index: number) => {\n    const updatedImages = [...selectedImages]\n    updatedImages.splice(index, 1)\n    setSelectedImages(updatedImages)\n  }\n\n  return (\n    <div className=\"flex w-full items-end gap-x-4 pb-4 pb-sm md:pb-md\">\n      {selectedImages.map((image, index) => (\n        // biome-ignore lint/suspicious/noArrayIndexKey: <explanation>\n        <div key={index} className=\"relative\">\n          <img src={image} alt={`Selected ${index}`} />\n          <RiCloseCircleLine\n            className=\"absolute top-2 right-2 flex size-8 cursor-pointer items-center justify-center\"\n            onClick={() => handleDeleteImage(index)}\n          />\n        </div>\n      ))}\n      <Textarea\n        className=\"h-auto resize-none rounded-md border p-2\"\n        placeholder={t(\n          \"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter a message\",\n        )}\n        value={message}\n        onChange={(event) => setMessage(event.target.value)}\n      />\n      {/* ã¾ã ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å‡¦ç†ãŒçµ‚ãˆã¦ã„ãªã„ã®ã§ã€disabled */}\n      {/* <Button disabled onClick={handleButtonClick} size={\"icon\"}>\n        <div className=\"flex justify-center items-center\">\n          <ArrowUpFromLine />\n          <Input\n            ref={fileInputRef}\n            className=\"hidden\"\n            id=\"imageUpload\"\n            type=\"file\"\n            multiple={true}\n            accept=\"image/*\"\n            onChange={handleFileChange}\n          />\n        </div>\n      </Button> */}\n      {/* é€ä¿¡ãƒœã‚¿ãƒ³ */}\n      <div>\n        <Button\n          disabled={!isSendButtonEnabled || props.isLoading}\n          onClick={handleSubmit}\n          size={\"icon\"}\n        >\n          <Send className=\"w-4\" />\n        </Button>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable isBlockLoading is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"isBlockLoading"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.users.$user._index/components/user-block-button.tsx"},"span":[515,529],"sourceCode":"import { Button, type ButtonProps } from \"~/components/ui/button\"\nimport { toast } from \"sonner\"\nimport { useEffect, useState } from \"react\"\nimport { LoaderIcon } from \"lucide-react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { graphql } from \"gql.tada\"\nimport { useMutation } from \"@apollo/client/index\"\n\ntype Props = {\n  id: string\n  isBlocked: boolean\n} & Pick<ButtonProps, \"variant\">\n\nexport function UserBlockButton (props: Props) {\n  const t = useTranslation()\n  const [block, { loading: isBlockLoading }] = useMutation(blockUserMutation)\n  const [unBlock, { loading: isUnBlockLoading }] =\n    useMutation(unBlockUserMutation)\n\n  const [isBlocked, setIsBlocked] = useState(props.isBlocked)\n  const [isLoading, setIsLoading] = useState(false)\n\n  useEffect(() => {\n    setIsBlocked(props.isBlocked)\n  }, [props.isBlocked])\n\n  const blockUser = async () => {\n    setIsLoading(true)\n    await block({\n      variables: {\n        input: {\n          userId: props.id,\n        },\n      },\n    })\n    toast(t(\"ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ã¾ã—ãŸ\", \"Blocked the user\"))\n    setIsBlocked(true)\n    setIsLoading(false)\n    console.log(\"Blocking user:\", props.id)\n  }\n\n  const unBlockUser = async () => {\n    setIsLoading(true)\n    await unBlock({\n      variables: {\n        input: {\n          userId: props.id,\n        },\n      },\n    })\n    toast(t(\"ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’è§£é™¤ã—ã¾ã—ãŸ\", \"Unblocked the user\"))\n    setIsBlocked(false)\n    setIsLoading(false)\n    console.log(\"Unblocking user:\", props.id)\n  }\n\n  return (\n    <Button\n      variant={props.variant ?? \"secondary\"}\n      onClick={isBlocked ? unBlockUser : blockUser}\n    >\n      {isLoading ? (\n        <span className=\"ml-2 animate-spin\">\n          <LoaderIcon />\n        </span>\n      ) : isBlocked ? (\n        t(\"ãƒ–ãƒ­ãƒƒã‚¯è§£é™¤\", \"Unblock\")\n      ) : (\n        t(\"ãƒ–ãƒ­ãƒƒã‚¯\", \"Block\")\n      )}\n    </Button>\n  )\n}\n\nconst blockUserMutation = graphql(\n  `mutation blockUser($input: BlockUserInput!) {\n    blockUser(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst unBlockUserMutation = graphql(\n  `mutation unBlockUser($input: UnblockUserInput!) {\n    unblockUser(input: $input) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable isUnBlockLoading is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"isUnBlockLoading"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.users.$user._index/components/user-block-button.tsx"},"span":[595,611],"sourceCode":"import { Button, type ButtonProps } from \"~/components/ui/button\"\nimport { toast } from \"sonner\"\nimport { useEffect, useState } from \"react\"\nimport { LoaderIcon } from \"lucide-react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { graphql } from \"gql.tada\"\nimport { useMutation } from \"@apollo/client/index\"\n\ntype Props = {\n  id: string\n  isBlocked: boolean\n} & Pick<ButtonProps, \"variant\">\n\nexport function UserBlockButton (props: Props) {\n  const t = useTranslation()\n  const [block, { loading: isBlockLoading }] = useMutation(blockUserMutation)\n  const [unBlock, { loading: isUnBlockLoading }] =\n    useMutation(unBlockUserMutation)\n\n  const [isBlocked, setIsBlocked] = useState(props.isBlocked)\n  const [isLoading, setIsLoading] = useState(false)\n\n  useEffect(() => {\n    setIsBlocked(props.isBlocked)\n  }, [props.isBlocked])\n\n  const blockUser = async () => {\n    setIsLoading(true)\n    await block({\n      variables: {\n        input: {\n          userId: props.id,\n        },\n      },\n    })\n    toast(t(\"ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ã¾ã—ãŸ\", \"Blocked the user\"))\n    setIsBlocked(true)\n    setIsLoading(false)\n    console.log(\"Blocking user:\", props.id)\n  }\n\n  const unBlockUser = async () => {\n    setIsLoading(true)\n    await unBlock({\n      variables: {\n        input: {\n          userId: props.id,\n        },\n      },\n    })\n    toast(t(\"ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ–ãƒ­ãƒƒã‚¯ã‚’è§£é™¤ã—ã¾ã—ãŸ\", \"Unblocked the user\"))\n    setIsBlocked(false)\n    setIsLoading(false)\n    console.log(\"Unblocking user:\", props.id)\n  }\n\n  return (\n    <Button\n      variant={props.variant ?? \"secondary\"}\n      onClick={isBlocked ? unBlockUser : blockUser}\n    >\n      {isLoading ? (\n        <span className=\"ml-2 animate-spin\">\n          <LoaderIcon />\n        </span>\n      ) : isBlocked ? (\n        t(\"ãƒ–ãƒ­ãƒƒã‚¯è§£é™¤\", \"Unblock\")\n      ) : (\n        t(\"ãƒ–ãƒ­ãƒƒã‚¯\", \"Block\")\n      )}\n    </Button>\n  )\n}\n\nconst blockUserMutation = graphql(\n  `mutation blockUser($input: BlockUserInput!) {\n    blockUser(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst unBlockUserMutation = graphql(\n  `mutation unBlockUser($input: UnblockUserInput!) {\n    unblockUser(input: $input) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.users.$user._index/components/user-profile-info.tsx"},"span":[1985,1998],"sourceCode":"import type React from \"react\"\nimport { useState } from \"react\"\nimport { RiEye2Line, RiHeartLine } from \"@remixicon/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { cn } from \"~/lib/utils\"\n\ntype UserProfileInfoProps = {\n  name: string\n  receivedLikesCount: number\n  receivedViewsCount: number\n  awardsCount: number\n  followersCount: number\n  biography: string\n}\n\nconst UserProfileInfo: React.FC<UserProfileInfoProps> = ({\n  name,\n  receivedLikesCount,\n  receivedViewsCount,\n  awardsCount,\n  followersCount,\n  biography,\n}) => {\n  const [showFullBiography, setShowFullBiography] = useState(false)\n  const t = useTranslation()\n\n  const toggleBiography = () => {\n    setShowFullBiography(!showFullBiography)\n  }\n\n  const truncatedBiography = showFullBiography\n    ? biography\n    : biography.slice(0, 100)\n\n  return (\n    <div className=\"mx-auto max-w-4xl\">\n      <div className=\"flex flex-col\">\n        <h1 className=\"font-bold text-2xl\">{name}</h1>\n        <div className=\"flex items-center gap-4\">\n          <span className=\"flex items-center text-base\">\n            <RiHeartLine className=\"mr-1 fill-red-500\" />\n            {receivedLikesCount}\n          </span>\n          <span className=\"flex items-center text-base\">\n            <RiEye2Line className=\"mr-1\" />\n            {receivedViewsCount}\n          </span>\n          <span className=\"text-base\">\n            {t(\"å…¥è³å›æ•°\", \"Awards\")} {awardsCount} {t(\"å›\", \"times\")}\n          </span>\n        </div>\n        <div className=\"text-base\">\n          <span>\n            {followersCount} {t(\"ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼\", \"followers\")}\n          </span>\n        </div>\n        {biography && (\n          <div>\n            <p\n              className={cn(\"mt-4 text-gray\", {\n                truncate: !showFullBiography,\n              })}\n            >\n              {truncatedBiography}\n              {!showFullBiography && biography.length > 100 && (\n                // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n                <span\n                  className=\"cursor-pointer text-blue-500\"\n                  onClick={toggleBiography}\n                >\n                  {t(\" ç¶šãã‚’èª­ã‚€\", \"Read More\")}\n                </span>\n              )}\n            </p>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n\nexport default UserProfileInfo\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable refetch is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"refetch"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.users.$user._index/components/user-stickers-contents.tsx"},"span":[575,582],"sourceCode":"import { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport {\n  ResponsiveStickersList,\n  StickerListItemFragment,\n} from \"~/components/responsive-stickers-list\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useSuspenseQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { useContext } from \"react\"\n\ntype Props = {\n  page: number\n  setPage(page: number): void\n  userId: string\n}\n\nexport function UserStickersContents (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  const { data: stickersResp, refetch } = useSuspenseQuery(stickersQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      offset: 16 * props.page,\n      limit: 16,\n      where: {\n        creatorUserId: props.userId,\n      },\n    },\n  })\n\n  const stickers = stickersResp?.stickers ?? []\n\n  const stickersCountResp = useSuspenseQuery(stickersCountQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      where: {\n        creatorUserId: props.userId,\n      },\n    },\n  })\n\n  const stickersCount = stickersCountResp.data?.stickersCount ?? 0\n\n  return (\n    <>\n      <ResponsiveStickersList stickers={stickers} />\n      <div className=\"h-8\" />\n      <div className=\"-translate-x-1/2 fixed bottom-0 left-1/2 z-10 w-full border-border/40 bg-background/95 p-2 backdrop-blur-sm supports-backdrop-filter:bg-background/80\">\n        <ResponsivePagination\n          perPage={16}\n          maxCount={stickersCount}\n          currentPage={props.page}\n          onPageChange={(page: number) => {\n            props.setPage(page)\n          }}\n        />\n      </div>\n    </>\n  )\n}\n\nconst stickersCountQuery = graphql(\n  `query StickersCount($where: StickersWhereInput) {\n    stickersCount(where: $where)\n  }`,\n)\n\nconst stickersQuery = graphql(\n  `query Stickers($offset: Int!, $limit: Int!, $where: StickersWhereInput) {\n    stickers(offset: $offset, limit: $limit, where: $where) {\n      ...StickerListItem\n    }\n  }`,\n  [StickerListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.users.$user.notes/components/user-note-list.tsx"},"span":[1892,1905],"sourceCode":"import { type FragmentOf, graphql } from \"gql.tada\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { useContext } from \"react\"\nimport { CarouselWithGradation } from \"~/components/carousel-with-gradation\"\nimport { LikeButton } from \"~/components/like-button\"\nimport { UserNameBadge } from \"~/routes/($lang)._main._index/components/user-name-badge\"\nimport { NovelWorkPreviewItem } from \"~/routes/($lang)._main._index/components/video-work-preview-item\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { useNavigate } from \"react-router-dom\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\n\ntype Props = {\n  works: FragmentOf<typeof UserNotesItemFragment>[]\n  page: number\n  maxCount: number\n}\n\nexport function UserNoteList (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  const userId =\n    props.works.length > 0 && props.works[0]?.user\n      ? (props.works[0].user.id ?? \"\")\n      : \"\"\n\n  const userLogin =\n    props.works.length > 0 && props.works[0]?.user\n      ? (props.works[0].user.login ?? \"\")\n      : \"\"\n\n  const { data: novelWorks } = useQuery(UserNotesQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn || userId === \"\",\n    variables: {\n      offset: props.page * 32,\n      limit: 32,\n      where: {\n        userId: userId,\n        ratings: [\"G\", \"R15\"],\n        workType: \"COLUMN\",\n        isNowCreatedAt: true,\n      },\n    },\n  })\n\n  const works = novelWorks?.works ?? props.works\n\n  const navigate = useNavigate()\n\n  return (\n    <div className=\"flex flex-col space-y-4\">\n      <div className=\"flex min-h-96 flex-col gap-y-4\">\n        <section className=\"relative space-y-4\">\n          <CarouselWithGradation\n            items={works.map((work, _index) => (\n              // biome-ignore lint/correctness/useJsxKeyInIterable: <explanation>\n              <div className=\"h-full rounded border-2 border-gray border-solid\">\n                <div className=\"relative\">\n                  <NovelWorkPreviewItem\n                    workId={work.id}\n                    imageUrl={work.smallThumbnailImageURL}\n                    title={work.title}\n                    text={work.description ?? \"\"}\n                    tags={[]}\n                  />\n                </div>\n                {work.user && (\n                  <>\n                    <UserNameBadge\n                      userId={work.user.id}\n                      userIconImageURL={withIconUrlFallback(work.user.iconUrl)}\n                      name={work.user.name}\n                      width={\"sm\"}\n                      padding={\"md\"}\n                    />\n                    <div className=\"absolute right-0 bottom-0\">\n                      <LikeButton\n                        size={56}\n                        targetWorkId={work.id}\n                        targetWorkOwnerUserId={work.user.id}\n                        defaultLiked={work.isLiked}\n                        defaultLikedCount={0}\n                        isBackgroundNone={true}\n                        strokeWidth={2}\n                      />\n                    </div>\n                  </>\n                )}\n              </div>\n            ))}\n          />\n        </section>\n      </div>\n      <div className=\"h-8\" />\n      <div className=\"-translate-x-1/2 fixed bottom-0 left-1/2 z-10 w-full border-border/40 bg-background/95 p-2 backdrop-blur-sm supports-backdrop-filter:bg-background/80\">\n        <ResponsivePagination\n          perPage={32}\n          maxCount={props.maxCount}\n          currentPage={props.page}\n          onPageChange={(page: number) => {\n            navigate(`/users/${userLogin}/works?page=${page}`)\n          }}\n        />\n      </div>\n    </div>\n  )\n}\n\nexport const UserNotesItemFragment = graphql(\n  `fragment UserNotesItem on WorkNode @_unmask {\n    id\n    smallThumbnailImageURL\n    isLiked\n    title\n    description\n    user {\n      id\n      name\n      iconUrl\n      login\n    }\n  }`,\n)\n\nexport const UserNotesQuery = graphql(\n  `query UserNotes($offset: Int!, $limit: Int!, $where: WorksWhereInput) {\n    works(offset: $offset, limit: $limit, where: $where) {\n      ...UserNotesItem\n    }\n    worksCount(where: $where)\n  }`,\n  [UserNotesItemFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).debug.nsfw/route.tsx"},"span":[2429,2592],"sourceCode":"import { ImageUp } from \"lucide-react\"\nimport { useState } from \"react\"\nimport { config } from \"~/config\"\nimport { load } from \"@l4ph/nsfwts\"\n\nconst modelUrl = \"./nsfwjs.onnx\"\nconst isDevelopmentMode = config.isDevelopmentMode\n\nexport default function CheckNsfw () {\n  const [image, setImage] = useState<string | null>(null)\n  const [predictions, setPredictions] = useState<Record<string, number> | null>(\n    null,\n  )\n\n  const handleImageUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0]\n    if (file) {\n      const reader = new FileReader()\n      reader.onload = async (e) => {\n        const imageUrl = e.target?.result as string\n        setImage(imageUrl)\n\n        // ç”»åƒã®èª­ã¿è¾¼ã¿\n        const img = new Image()\n        img.src = imageUrl\n        img.onload = async () => {\n          const results = await load(img, modelUrl)\n          setPredictions(results)\n        }\n      }\n      reader.readAsDataURL(file)\n    }\n  }\n\n  if (!isDevelopmentMode) {\n    return (\n      <div className=\"flex h-screen flex-col items-center justify-center bg-background\">\n        <div className=\"mb-8 text-center text-muted-foreground\">\n          This feature is not enabled in the production environment.\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex h-screen flex-col items-center justify-center bg-background\">\n      {image ? (\n        <div className=\"mb-8\">\n          <img\n            src={image}\n            alt=\"Uploaded\"\n            width={400}\n            height={400}\n            className=\"h-auto max-w-full rounded-lg\"\n          />\n        </div>\n      ) : (\n        <div className=\"mb-8 text-center text-muted-foreground\">\n          No image uploaded yet.\n        </div>\n      )}\n      {predictions && (\n        <div className=\"mb-8\">\n          {Object.entries(predictions).map(([label, percent]) => (\n            <div key={label}>\n              {label}: {(percent * 100).toFixed(2)}%\n            </div>\n          ))}\n        </div>\n      )}\n      <div>\n        <label\n          htmlFor=\"image-upload\"\n          className=\"inline-flex items-center justify-center rounded-md bg-primary px-4 py-2 font-medium text-primary-foreground text-sm shadow-xs hover:bg-primary/80 focus:outline-hidden focus:ring-2 focus:ring-ring focus:ring-offset-2\"\n        >\n          <ImageUp className=\"mr-2 size-4\" />\n          Upload Image\n        </label>\n        <input\n          id=\"image-upload\"\n          type=\"file\"\n          accept=\"image/*\"\n          className=\"sr-only\"\n          onChange={handleImageUpload}\n        />\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).events.$event._index/route.tsx"},"span":[6887,6900],"sourceCode":"import { Card, CardHeader, CardContent } from \"~/components/ui/card\"\nimport { useLoaderData, useNavigate, useSearchParams } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { loaderClient } from \"~/lib/loader-client\"\nimport {\n  EventWorkList,\n  EventWorkListItemFragment,\n} from \"~/routes/($lang).events.$event._index/components/event-work-list\"\nimport {\n  EventAwardWorkList,\n  EventAwardWorkListItemFragment,\n} from \"~/routes/($lang).events.$event._index/components/event-award-work-list\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { config, META } from \"~/config\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { format } from \"date-fns\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { SensitiveToggle } from \"~/components/sensitive/sensitive-toggle\"\nimport React, { useEffect } from \"react\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport type { SortType } from \"~/types/sort-type\"\n\nconst toEventDateTimeText = (time: number) => {\n  const t = useTranslation()\n\n  // UTCæ™‚é–“ã‹ã‚‰æ—¥æœ¬æ™‚é–“ï¼ˆUTC+9ï¼‰ã«å¤‰æ›\n  const date = new Date(time * 1000)\n  const japanTime = new Date(date.getTime() - 9 * 60 * 60 * 1000)\n\n  return t(\n    format(japanTime, \"yyyyå¹´MMæœˆddæ—¥ HHæ™‚mmåˆ†\"),\n    format(japanTime, \"yyyy/MM/dd HH:mm\"),\n  )\n}\n\nexport async function loader(props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const event = props.params.event\n\n  const urlParams = new URL(props.request.url).searchParams\n\n  const pageParam = urlParams.get(\"page\")\n\n  const page = pageParam ? Number(pageParam) : 0\n\n  if (event === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const orderBy = urlParams.get(\"WorkOrderby\")\n    ? (urlParams.get(\"WorkOrderby\") as IntrospectionEnum<\"WorkOrderBy\">)\n    : \"LIKES_COUNT\"\n\n  const sort = urlParams.get(\"worksOrderDeskAsc\")\n    ? (urlParams.get(\"worksOrderDeskAsc\") as SortType)\n    : \"DESC\"\n\n  const eventsResp = await loaderClient.query({\n    query: appEventQuery,\n    variables: {\n      limit: 64,\n      offset: page * 64,\n      slug: event,\n      where: {\n        ratings: [\"G\", \"R15\"],\n        isNowCreatedAt: true,\n        orderBy: orderBy,\n        sort: sort,\n      },\n      isSensitive: false,\n    },\n  })\n\n  if (eventsResp.data.appEvent === null) {\n    throw new Response(null, { status: 404 })\n  }\n\n  return {\n    appEvent: eventsResp.data.appEvent,\n    page,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneMinute,\n})\n\nexport const meta: MetaFunction = ({ data }) => {\n  if (!data) {\n    return [{ title: \"ã‚¤ãƒ™ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ\" }]\n  }\n\n  const { appEvent } = data as {\n    appEvent: { title: string; description: string; thumbnailImageUrl: string }\n  }\n\n  const stripHtmlTags = (str: string) => {\n    return str.replace(/<[^>]*>?/gm, \"\")\n  }\n\n  return createMeta(META.EVENTS_INDEX, {\n    title: appEvent.title,\n    description: stripHtmlTags(appEvent.description),\n    url: appEvent.thumbnailImageUrl,\n  })\n}\n\nexport default function FollowingLayout () {\n  const t = useTranslation()\n\n  const data = useLoaderData<typeof loader>()\n\n  const _navigate = useNavigate()\n\n  const [searchParams, setSearchParams] = useSearchParams()\n\n  const [workType, setWorkType] =\n    React.useState<IntrospectionEnum<\"WorkType\"> | null>(\n      (searchParams.get(\"workType\") as IntrospectionEnum<\"WorkType\">) || null,\n    )\n\n  const [WorkOrderby, setWorkOrderby] = React.useState<\n    IntrospectionEnum<\"WorkOrderBy\">\n  >(\n    (searchParams.get(\"WorkOrderby\") as IntrospectionEnum<\"WorkOrderBy\">) ||\n      \"DATE_CREATED\",\n  )\n\n  const [worksOrderDeskAsc, setWorksOrderDeskAsc] = React.useState<SortType>(\n    (searchParams.get(\"worksOrderDeskAsc\") as SortType) || \"DESC\",\n  )\n\n  const [rating, setRating] =\n    React.useState<IntrospectionEnum<\"Rating\"> | null>(\n      (searchParams.get(\"rating\") as IntrospectionEnum<\"Rating\">) || null,\n    )\n\n  useEffect(() => {\n    const params = new URLSearchParams()\n\n    params.set(\"page\", String(data.page))\n    if (workType) params.set(\"workType\", workType)\n    if (rating) params.set(\"rating\", rating)\n    params.set(\"WorkOrderby\", WorkOrderby)\n    params.set(\"worksOrderDeskAsc\", worksOrderDeskAsc)\n\n    setSearchParams(params)\n  }, [\n    data.page,\n    workType,\n    rating,\n    WorkOrderby,\n    worksOrderDeskAsc,\n    setSearchParams,\n  ])\n\n  const onClickTitleSortButton = () => {\n    setWorkOrderby(\"NAME\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickLikeSortButton = () => {\n    setWorkOrderby(\"LIKES_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickBookmarkSortButton = () => {\n    setWorkOrderby(\"BOOKMARKS_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickCommentSortButton = () => {\n    setWorkOrderby(\"COMMENTS_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickViewSortButton = () => {\n    setWorkOrderby(\"VIEWS_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickAccessTypeSortButton = () => {\n    setWorkOrderby(\"ACCESS_TYPE\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickDateSortButton = () => {\n    setWorkOrderby(\"DATE_CREATED\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickWorkTypeSortButton = () => {\n    setWorkOrderby(\"WORK_TYPE\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickIsPromotionSortButton = () => {\n    setWorkOrderby(\"IS_PROMOTION\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const [worksMaxCount, _setWorksMaxCount] = React.useState(0)\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <div className=\"flex flex-col space-y-4\">\n      <div className=\"flex flex-col gap-x-2 gap-y-2 md:flex-row\">\n        {data.appEvent.thumbnailImageUrl && (\n          <img\n            className=\"h-auto rounded-lg object-cover md:max-w-96\"\n            src={data.appEvent.thumbnailImageUrl}\n            alt=\"\"\n          />\n        )}\n        <Card className=\"m-auto w-full\">\n          <CardHeader>\n            <div className=\"mt-4 text-center font-medium text-lg\">\n              {data.appEvent.title}\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"m-auto flex flex-col items-center text-left\">\n              {data.appEvent.description && (\n                <div\n                  className=\"mb-2 text-left text-sm\"\n                  // biome-ignore lint/security/noDangerouslySetInnerHtml: <explanation>\n                  dangerouslySetInnerHTML={{\n                    __html: data.appEvent.description,\n                  }}\n                />\n              )}\n              {data.appEvent.startAt && data.appEvent.endAt && (\n                <div className=\"mr-auto text-sm\">\n                  {toEventDateTimeText(data.appEvent.startAt)}ï½\n                  {toEventDateTimeText(data.appEvent.endAt)}\n                </div>\n              )}\n              <div className=\"mt-2 mr-auto text-sm\">\n                {t(\"å¿œå‹Ÿä½œå“æ•°:\", \"Number of Submissions:\")}{\" \"}\n                {data.appEvent.worksCount?.toString() ?? \"0\"}\n              </div>\n              <div className=\"mt-2 mr-auto text-sm\">\n                <span>\n                  {t(\"å‚åŠ ã‚¿ã‚°:\", \"Event Tag:\")} {data.appEvent.tag}\n                </span>\n              </div>\n              {data.appEvent.slug !== null && (\n                <SensitiveToggle\n                  variant=\"compact\"\n                  targetUrl={`/r/events/${data.appEvent.slug}`}\n                />\n              )}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n      {data.appEvent.awardWorks && (\n        <EventAwardWorkList\n          works={data.appEvent.awardWorks}\n          slug={data.appEvent.slug ?? \"\"}\n        />\n      )}\n      {data.appEvent.works && (\n        <EventWorkList\n          works={data.appEvent.works}\n          maxCount={data.appEvent.worksCount as number}\n          page={data.page}\n          slug={data.appEvent.slug ?? \"\"}\n          sort={worksOrderDeskAsc}\n          orderBy={WorkOrderby}\n          sumWorksCount={worksMaxCount}\n          workType={workType}\n          rating={rating}\n          onClickTitleSortButton={onClickTitleSortButton}\n          onClickLikeSortButton={onClickLikeSortButton}\n          onClickBookmarkSortButton={onClickBookmarkSortButton}\n          onClickCommentSortButton={onClickCommentSortButton}\n          onClickViewSortButton={onClickViewSortButton}\n          onClickAccessTypeSortButton={onClickAccessTypeSortButton}\n          onClickDateSortButton={onClickDateSortButton}\n          onClickWorkTypeSortButton={onClickWorkTypeSortButton}\n          onClickIsPromotionSortButton={onClickIsPromotionSortButton}\n          setWorkType={setWorkType}\n          setRating={setRating}\n          setSort={setWorksOrderDeskAsc}\n        />\n      )}\n    </div>\n  )\n}\n\nconst appEventQuery = graphql(\n  `query AppEvent($slug: String!, $offset: Int!, $limit: Int!, $where: WorksWhereInput!, $isSensitive: Boolean!) {\n    appEvent(slug: $slug) {\n      id\n      description\n      title\n      slug\n      thumbnailImageUrl\n      headerImageUrl\n      startAt\n      endAt\n      tag\n      worksCount\n      works(offset: $offset, limit: $limit, where: $where) {\n        ...EventWorkListItem\n      }\n      awardWorks(offset: 0, limit: 20, isSensitive: $isSensitive) {\n        ...EventAwardWorkListItem\n      }\n    }\n  }`,\n  [EventAwardWorkListItemFragment, EventWorkListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).events.$event.award._index/route.tsx"},"span":[2662,2675],"sourceCode":"import { Card, CardHeader, CardContent } from \"~/components/ui/card\"\nimport { useLoaderData, useNavigate } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { loaderClient } from \"~/lib/loader-client\"\nimport {\n  EventAwardPagingWorkList,\n  EventAwardWorkListItemFragment,\n} from \"~/routes/($lang).events.$event.award._index/components/event-award-paging-work-list\"\nimport { Button } from \"~/components/ui/button\"\nimport { format } from \"date-fns\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport type { LoaderFunctionArgs } from \"react-router-dom\"\nimport { config } from \"~/config\"\nimport type { HeadersFunction } from \"@remix-run/cloudflare\"\nimport { SensitiveToggle } from \"~/components/sensitive/sensitive-toggle\"\n\nconst toEventDateTimeText = (time: number) => {\n  const t = useTranslation()\n\n  // UTCæ™‚é–“ã‹ã‚‰æ—¥æœ¬æ™‚é–“ï¼ˆUTC+9ï¼‰ã«å¤‰æ›\n  const date = new Date(time * 1000)\n  const japanTime = new Date(date.getTime() - 9 * 60 * 60 * 1000)\n\n  return t(\n    format(japanTime, \"yyyyå¹´MMæœˆddæ—¥ HHæ™‚mmåˆ†\"),\n    format(japanTime, \"yyyy/MM/dd HH:mm\"),\n  )\n}\n\nexport async function loader(props: LoaderFunctionArgs) {\n  const event = props.params.event\n\n  const urlParams = new URL(props.request.url).searchParams\n\n  const pageParam = urlParams.get(\"page\")\n\n  const page = pageParam ? Number(pageParam) : 0\n\n  if (event === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const eventsResp = await loaderClient.query({\n    query: appEventQuery,\n    variables: {\n      limit: 200,\n      offset: 0,\n      slug: event,\n      // where: {\n      //   ratings: [\"G\", \"R15\"],\n      //   isNowCreatedAt: true,\n      // },\n      isSensitive: false,\n    },\n  })\n\n  if (eventsResp.data.appEvent === null) {\n    throw new Response(null, { status: 404 })\n  }\n\n  return {\n    appEvent: eventsResp.data.appEvent,\n    page,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneDay,\n})\n\nexport default function FollowingLayout () {\n  const data = useLoaderData<typeof loader>()\n\n  const navigate = useNavigate()\n\n  return (\n    <div className=\"flex flex-col space-y-4\">\n      <img\n        className=\"h-auto w-full rounded-lg object-cover\"\n        src={data.appEvent.thumbnailImageUrl}\n        alt=\"\"\n      />\n      <Card className=\"m-auto w-full\">\n        <CardHeader>\n          <div className=\"mt-4 text-center font-medium text-lg\">\n            {data.appEvent.title}\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"m-auto flex max-w-96 flex-col items-center text-left\">\n            {/* biome-ignore lint/style/useSelfClosingElements: <explanation> */}\n            <div\n              className=\"mb-2 text-left text-sm\"\n              // biome-ignore lint/security/noDangerouslySetInnerHtml: <explanation>\n              dangerouslySetInnerHTML={{ __html: data.appEvent.description }}\n            />\n            <div className=\"mr-auto text-sm\">\n              {toEventDateTimeText(data.appEvent.startAt)}ï½\n              {toEventDateTimeText(data.appEvent.endAt)}\n            </div>\n            <div className=\"mt-2 mr-auto text-sm\">\n              å¿œå‹Ÿä½œå“æ•°: {data.appEvent.worksCount?.toString() ?? \"0\"}\n            </div>\n            <div className=\"mt-2 mr-auto text-sm\">\n              <span>å‚åŠ ã‚¿ã‚°: {data.appEvent.tag}</span>\n            </div>\n            {data.appEvent.slug !== null && (\n              <SensitiveToggle\n                variant=\"compact\"\n                targetUrl={`/r/events/${data.appEvent.slug}/award`}\n              />\n            )}\n          </div>\n        </CardContent>\n      </Card>\n      <Button\n        onClick={() => {\n          navigate(`/events/${data.appEvent.slug}`)\n        }}\n        className=\"m-auto w-full\"\n        variant={\"secondary\"}\n        size={\"sm\"}\n      >\n        {\"æˆ»ã‚‹\"}\n      </Button>\n      {data.appEvent.awardWorks && data.appEvent.slug && (\n        <EventAwardPagingWorkList\n          works={data.appEvent.awardWorks}\n          slug={data.appEvent.slug}\n          maxCount={data.appEvent.worksCount}\n          page={data.page}\n        />\n      )}\n    </div>\n  )\n}\n\nconst appEventQuery = graphql(\n  `query AppEvent($slug: String!, $offset: Int!, $limit: Int!, $isSensitive: Boolean!) {\n    appEvent(slug: $slug) {\n      id\n      description\n      title\n      slug\n      thumbnailImageUrl\n      headerImageUrl\n      startAt\n      endAt\n      tag\n      worksCount\n      awardWorks(offset: $offset, limit: $limit, isSensitive: $isSensitive) {\n        ...EventAwardWorkListItem\n      }\n    }\n  }`,\n  [EventAwardWorkListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).events.$event.award._index/route.tsx"},"span":[2814,2827],"sourceCode":"import { Card, CardHeader, CardContent } from \"~/components/ui/card\"\nimport { useLoaderData, useNavigate } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { loaderClient } from \"~/lib/loader-client\"\nimport {\n  EventAwardPagingWorkList,\n  EventAwardWorkListItemFragment,\n} from \"~/routes/($lang).events.$event.award._index/components/event-award-paging-work-list\"\nimport { Button } from \"~/components/ui/button\"\nimport { format } from \"date-fns\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport type { LoaderFunctionArgs } from \"react-router-dom\"\nimport { config } from \"~/config\"\nimport type { HeadersFunction } from \"@remix-run/cloudflare\"\nimport { SensitiveToggle } from \"~/components/sensitive/sensitive-toggle\"\n\nconst toEventDateTimeText = (time: number) => {\n  const t = useTranslation()\n\n  // UTCæ™‚é–“ã‹ã‚‰æ—¥æœ¬æ™‚é–“ï¼ˆUTC+9ï¼‰ã«å¤‰æ›\n  const date = new Date(time * 1000)\n  const japanTime = new Date(date.getTime() - 9 * 60 * 60 * 1000)\n\n  return t(\n    format(japanTime, \"yyyyå¹´MMæœˆddæ—¥ HHæ™‚mmåˆ†\"),\n    format(japanTime, \"yyyy/MM/dd HH:mm\"),\n  )\n}\n\nexport async function loader(props: LoaderFunctionArgs) {\n  const event = props.params.event\n\n  const urlParams = new URL(props.request.url).searchParams\n\n  const pageParam = urlParams.get(\"page\")\n\n  const page = pageParam ? Number(pageParam) : 0\n\n  if (event === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const eventsResp = await loaderClient.query({\n    query: appEventQuery,\n    variables: {\n      limit: 200,\n      offset: 0,\n      slug: event,\n      // where: {\n      //   ratings: [\"G\", \"R15\"],\n      //   isNowCreatedAt: true,\n      // },\n      isSensitive: false,\n    },\n  })\n\n  if (eventsResp.data.appEvent === null) {\n    throw new Response(null, { status: 404 })\n  }\n\n  return {\n    appEvent: eventsResp.data.appEvent,\n    page,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneDay,\n})\n\nexport default function FollowingLayout () {\n  const data = useLoaderData<typeof loader>()\n\n  const navigate = useNavigate()\n\n  return (\n    <div className=\"flex flex-col space-y-4\">\n      <img\n        className=\"h-auto w-full rounded-lg object-cover\"\n        src={data.appEvent.thumbnailImageUrl}\n        alt=\"\"\n      />\n      <Card className=\"m-auto w-full\">\n        <CardHeader>\n          <div className=\"mt-4 text-center font-medium text-lg\">\n            {data.appEvent.title}\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"m-auto flex max-w-96 flex-col items-center text-left\">\n            {/* biome-ignore lint/style/useSelfClosingElements: <explanation> */}\n            <div\n              className=\"mb-2 text-left text-sm\"\n              // biome-ignore lint/security/noDangerouslySetInnerHtml: <explanation>\n              dangerouslySetInnerHTML={{ __html: data.appEvent.description }}\n            />\n            <div className=\"mr-auto text-sm\">\n              {toEventDateTimeText(data.appEvent.startAt)}ï½\n              {toEventDateTimeText(data.appEvent.endAt)}\n            </div>\n            <div className=\"mt-2 mr-auto text-sm\">\n              å¿œå‹Ÿä½œå“æ•°: {data.appEvent.worksCount?.toString() ?? \"0\"}\n            </div>\n            <div className=\"mt-2 mr-auto text-sm\">\n              <span>å‚åŠ ã‚¿ã‚°: {data.appEvent.tag}</span>\n            </div>\n            {data.appEvent.slug !== null && (\n              <SensitiveToggle\n                variant=\"compact\"\n                targetUrl={`/r/events/${data.appEvent.slug}/award`}\n              />\n            )}\n          </div>\n        </CardContent>\n      </Card>\n      <Button\n        onClick={() => {\n          navigate(`/events/${data.appEvent.slug}`)\n        }}\n        className=\"m-auto w-full\"\n        variant={\"secondary\"}\n        size={\"sm\"}\n      >\n        {\"æˆ»ã‚‹\"}\n      </Button>\n      {data.appEvent.awardWorks && data.appEvent.slug && (\n        <EventAwardPagingWorkList\n          works={data.appEvent.awardWorks}\n          slug={data.appEvent.slug}\n          maxCount={data.appEvent.worksCount}\n          page={data.page}\n        />\n      )}\n    </div>\n  )\n}\n\nconst appEventQuery = graphql(\n  `query AppEvent($slug: String!, $offset: Int!, $limit: Int!, $isSensitive: Boolean!) {\n    appEvent(slug: $slug) {\n      id\n      description\n      title\n      slug\n      thumbnailImageUrl\n      headerImageUrl\n      startAt\n      endAt\n      tag\n      worksCount\n      awardWorks(offset: $offset, limit: $limit, isSensitive: $isSensitive) {\n        ...EventAwardWorkListItem\n      }\n    }\n  }`,\n  [EventAwardWorkListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).events.$event.award._index/route.tsx"},"span":[2608,2675],"sourceCode":"import { Card, CardHeader, CardContent } from \"~/components/ui/card\"\nimport { useLoaderData, useNavigate } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { loaderClient } from \"~/lib/loader-client\"\nimport {\n  EventAwardPagingWorkList,\n  EventAwardWorkListItemFragment,\n} from \"~/routes/($lang).events.$event.award._index/components/event-award-paging-work-list\"\nimport { Button } from \"~/components/ui/button\"\nimport { format } from \"date-fns\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport type { LoaderFunctionArgs } from \"react-router-dom\"\nimport { config } from \"~/config\"\nimport type { HeadersFunction } from \"@remix-run/cloudflare\"\nimport { SensitiveToggle } from \"~/components/sensitive/sensitive-toggle\"\n\nconst toEventDateTimeText = (time: number) => {\n  const t = useTranslation()\n\n  // UTCæ™‚é–“ã‹ã‚‰æ—¥æœ¬æ™‚é–“ï¼ˆUTC+9ï¼‰ã«å¤‰æ›\n  const date = new Date(time * 1000)\n  const japanTime = new Date(date.getTime() - 9 * 60 * 60 * 1000)\n\n  return t(\n    format(japanTime, \"yyyyå¹´MMæœˆddæ—¥ HHæ™‚mmåˆ†\"),\n    format(japanTime, \"yyyy/MM/dd HH:mm\"),\n  )\n}\n\nexport async function loader(props: LoaderFunctionArgs) {\n  const event = props.params.event\n\n  const urlParams = new URL(props.request.url).searchParams\n\n  const pageParam = urlParams.get(\"page\")\n\n  const page = pageParam ? Number(pageParam) : 0\n\n  if (event === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const eventsResp = await loaderClient.query({\n    query: appEventQuery,\n    variables: {\n      limit: 200,\n      offset: 0,\n      slug: event,\n      // where: {\n      //   ratings: [\"G\", \"R15\"],\n      //   isNowCreatedAt: true,\n      // },\n      isSensitive: false,\n    },\n  })\n\n  if (eventsResp.data.appEvent === null) {\n    throw new Response(null, { status: 404 })\n  }\n\n  return {\n    appEvent: eventsResp.data.appEvent,\n    page,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneDay,\n})\n\nexport default function FollowingLayout () {\n  const data = useLoaderData<typeof loader>()\n\n  const navigate = useNavigate()\n\n  return (\n    <div className=\"flex flex-col space-y-4\">\n      <img\n        className=\"h-auto w-full rounded-lg object-cover\"\n        src={data.appEvent.thumbnailImageUrl}\n        alt=\"\"\n      />\n      <Card className=\"m-auto w-full\">\n        <CardHeader>\n          <div className=\"mt-4 text-center font-medium text-lg\">\n            {data.appEvent.title}\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"m-auto flex max-w-96 flex-col items-center text-left\">\n            {/* biome-ignore lint/style/useSelfClosingElements: <explanation> */}\n            <div\n              className=\"mb-2 text-left text-sm\"\n              // biome-ignore lint/security/noDangerouslySetInnerHtml: <explanation>\n              dangerouslySetInnerHTML={{ __html: data.appEvent.description }}\n            />\n            <div className=\"mr-auto text-sm\">\n              {toEventDateTimeText(data.appEvent.startAt)}ï½\n              {toEventDateTimeText(data.appEvent.endAt)}\n            </div>\n            <div className=\"mt-2 mr-auto text-sm\">\n              å¿œå‹Ÿä½œå“æ•°: {data.appEvent.worksCount?.toString() ?? \"0\"}\n            </div>\n            <div className=\"mt-2 mr-auto text-sm\">\n              <span>å‚åŠ ã‚¿ã‚°: {data.appEvent.tag}</span>\n            </div>\n            {data.appEvent.slug !== null && (\n              <SensitiveToggle\n                variant=\"compact\"\n                targetUrl={`/r/events/${data.appEvent.slug}/award`}\n              />\n            )}\n          </div>\n        </CardContent>\n      </Card>\n      <Button\n        onClick={() => {\n          navigate(`/events/${data.appEvent.slug}`)\n        }}\n        className=\"m-auto w-full\"\n        variant={\"secondary\"}\n        size={\"sm\"}\n      >\n        {\"æˆ»ã‚‹\"}\n      </Button>\n      {data.appEvent.awardWorks && data.appEvent.slug && (\n        <EventAwardPagingWorkList\n          works={data.appEvent.awardWorks}\n          slug={data.appEvent.slug}\n          maxCount={data.appEvent.worksCount}\n          page={data.page}\n        />\n      )}\n    </div>\n  )\n}\n\nconst appEventQuery = graphql(\n  `query AppEvent($slug: String!, $offset: Int!, $limit: Int!, $isSensitive: Boolean!) {\n    appEvent(slug: $slug) {\n      id\n      description\n      title\n      slug\n      thumbnailImageUrl\n      headerImageUrl\n      startAt\n      endAt\n      tag\n      worksCount\n      awardWorks(offset: $offset, limit: $limit, isSensitive: $isSensitive) {\n        ...EventAwardWorkListItem\n      }\n    }\n  }`,\n  [EventAwardWorkListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).events.ai-idol-project/components/image-slider-animation.tsx"},"span":[1798,1811],"sourceCode":"import type { CSSProperties } from \"react\"\n\ntype Props = {\n  imageURLs?: string[]\n  displayDuration?: number // æ–°ã—ã„å¤‰æ•°ã§è¡¨ç¤ºæ™‚é–“ã‚’æŒ‡å®š\n}\n\nexport function ImageSliderAnimation (props: Props) {\n  if (!props.imageURLs || props.imageURLs.length === 0) {\n    return null\n  }\n\n  const { imageURLs, displayDuration = 10 } = props // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¡¨ç¤ºæ™‚é–“ã‚’10ç§’ã«è¨­å®š\n\n  const imageStyle: CSSProperties = {\n    position: \"absolute\",\n    top: 0,\n    left: 0,\n    bottom: 0,\n    right: 0,\n    opacity: 0,\n    backgroundSize: \"contain\",\n    backgroundRepeat: \"no-repeat\",\n    backgroundPosition: \"center top\",\n    animation: `imageSwitchAnimation ${\n      displayDuration * imageURLs.length\n    }s infinite`, // å…¨ä½“ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³æ™‚é–“ã‚’è¨ˆç®—\n  }\n\n  const keyframesStyle = `\n    @keyframes imageSwitchAnimation {\n      0%, ${(100 / imageURLs.length) * 0.4}% { opacity: 0; transform: scale(1); filter: blur(5); }\n      ${(100 / imageURLs.length) * 0.4}%, ${(100 / imageURLs.length) * 0.8}% { opacity: 1; transform: scale(0.9); filter: blur(0px); }\n      ${(100 / imageURLs.length) * 0.8}%, 100% { opacity: 0; transform: scale(0.9); filter: blur(5px); }\n    }\n  `\n\n  const dotsOverlayStyle: React.CSSProperties = {\n    position: \"absolute\",\n    top: 0,\n    left: 0,\n    opacity: 0.5,\n    width: \"100%\",\n    height: \"100%\",\n    backgroundImage:\n      \"url(https://pub-c8b482e79e9f4e7ab4fc35d3eb5ecda8.r2.dev/dot-4.png)\",\n    backgroundRepeat: \"repeat\",\n  }\n\n  return (\n    <>\n      <style>{keyframesStyle}</style>\n      <div className=\"relative m-auto my-4 h-[400px] max-h-[800px] w-auto max-w-[1600px] rounded-md border-gray-500 border-solid p-0\">\n        {imageURLs.map((url, index) => (\n          <div\n            // biome-ignore lint/suspicious/noArrayIndexKey: <explanation>\n            key={index}\n            style={{\n              ...imageStyle,\n              backgroundImage: `url(${url})`,\n              animationDelay: `${index * displayDuration}s`, // å„ç”»åƒã®è¡¨ç¤ºã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’è¨ˆç®—\n            }}\n          />\n        ))}\n        <div style={dotsOverlayStyle} />\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).events.ai-idol-project/route.tsx"},"span":[5846,5859],"sourceCode":"import { GlowingGradientBorderButton } from \"~/components/button/glowing-gradient-border-button\"\nimport { CharacterCard } from \"~/routes/($lang).events.ai-idol-project/components/character-card\"\nimport { ImageSliderAnimation } from \"~/routes/($lang).events.ai-idol-project/components/image-slider-animation\"\nimport type { HeadersFunction, MetaFunction } from \"@remix-run/cloudflare\"\nimport { Link } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport type { LoaderFunctionArgs } from \"react-router-dom\"\nimport { config } from \"~/config\"\n\nexport default function EventAiIdolProject () {\n  const t = useTranslation()\n\n  const imageUrls = [\n    \"https://pub-c8b482e79e9f4e7ab4fc35d3eb5ecda8.r2.dev/idolaipicheader.jpg\",\n    \"https://pub-c8b482e79e9f4e7ab4fc35d3eb5ecda8.r2.dev/GKsjL9Bb0AAK2Gq.jpg\",\n    \"https://prd.storage.lit.link/images/creators/f62dc4df-f7cc-4400-9d8b-c0efe765ade5/73416303-ac2f-4d2f-b003-ce0d2ebfbcf5.jpg\",\n    \"https://prd.storage.lit.link/images/creators/f62dc4df-f7cc-4400-9d8b-c0efe765ade5/9b0af88c-7c57-49ac-836a-56aa06e44f52.jpg\",\n  ]\n\n  const characters = [\n    {\n      name: \"ã‚¨ãƒªã‚«ãƒ»ãƒ™ãƒãƒƒãƒˆ\",\n      imageURL:\n        \"https://pub-c8b482e79e9f4e7ab4fc35d3eb5ecda8.r2.dev/%E3%82%A8%E3%83%AA%E3%82%AB%E9%80%8F%E9%81%8E.webp\",\n      prompt:\n        \"1girl,School uniform, blond ponytail, big blue ribbon,tsundere, tight eyes, confident expression, a little bit gal, American girl, blue eyes, age15\",\n      profile:\n        \"AIã‹ã‚‰ç”Ÿã¾ã‚ŒãŸæ–°äººã‚¢ã‚¤ãƒ‰ãƒ«ã€ã‚¨ãƒªã‚«ãƒ»ãƒ™ãƒãƒƒãƒˆã‚ˆï¼ğŸ›¬é›»å­ã®æµ·ã®å‘ã“ã†ã‹ã‚‰ã€-æ‰‹å…ƒã§å‡ºä¼šãˆã‚‹ã‚¢ã‚¤ãƒ‰ãƒ«-ã¨ã—ã¦ã€AiIdolProjectã«ç§»ç±ã—ã¦æ¥ãŸã‚ï¼ã©ã“ã‹ã«æ¶ˆãˆãŸâ€œã‚¢ã‚¤ãƒ„â€ã‚ˆã‚Šã‚‚ã€ç§ãŒä¸–ç•Œä¸€ã®ã‚¢ã‚¤ãƒ‰ãƒ«ã ã£ã¦ã“ã¨ã‚’é­…ã›ã¦ã‚ã’ã‚‹ã€‚ç§ã«ã¤ã„ã¦ããªã•ã„ï¼\",\n      xlink: \"https://x.com/Erica_Aipro\",\n    },\n    {\n      name: \"æœ§éœ§ãƒ¦ã‚¨\",\n      imageURL:\n        \"https://pub-c8b482e79e9f4e7ab4fc35d3eb5ecda8.r2.dev/%E3%83%A6%E3%82%A8%E9%80%8F%E9%81%8E_1.webp\",\n      prompt:\n        \"((((long fish-bone braid hair, pony-tail-style)))),1 girl solo, she has purple hair, green eyes, intelligent glasses ,expressionless, about 16 years old, white coat\",\n      negativePrompt:\n        \"(((Biological fish, snakes,Animal Ears,smile,short-hair,medium hair))), twintails\",\n      profile:\n        \"AIã‹ã‚‰ç”Ÿã¾ã‚ŒãŸæ–°äººã‚¢ã‚¤ãƒ‰ãƒ«ã€ãƒ¦ã‚¨...ã€‚-æ‰‹å…ƒã§å‡ºä¼šãˆã‚‹ã‚¢ã‚¤ãƒ‰ãƒ«-AiIdolProjectæ‰€å±ã€‚ã‚ã®å­ãŸã¡ã®ã€ç¬‘é¡”ã®ç†ç”±ã€‚ã“ã®é ­è„³ã§è§£ãæ˜ã‹ã™...ã€‚ãˆã£ã€çµµæ–‡å­—...ï¼Ÿ......ã“ã‚Œã§ã„ã„ğŸ¤—ï¼Ÿ\",\n      xlink: \"https://x.com/Yue_Aipro\",\n    },\n    // è¿½åŠ ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚‚åŒæ§˜ã«è¨­å®š\n  ]\n\n  const characterCards = characters.map((character) => (\n    <CharacterCard\n      name={character.name}\n      key={character.name}\n      imageURL={character.imageURL}\n      prompt={character.prompt}\n      negativePrompts={character.negativePrompt ?? \"\"}\n      profile={character.profile}\n      xlink={character.xlink}\n    />\n  ))\n\n  return (\n    <>\n      <ImageSliderAnimation imageURLs={imageUrls} />\n      <h1 className=\"font-bold text-2xl\">\n        {t(\"AI IDOL PROJECT Ã— Aipictors\", \"AI IDOL PROJECT Ã— Aipictors\")}\n      </h1>\n      <h2 className=\"mt-4 font-bold text-xl\">\n        {t(\"AI IDOL PROJECTã¨ã¯ï¼Ÿ\", \"What is AI IDOL PROJECT?\")}\n      </h2>\n      <p className=\"mt-4 text-md\">\n        {t(\n          \"AI IDOL PROJECTï¼ˆã‚¢ã‚¤ãƒ—ãƒ­ï¼‰ã¯ã€å®Œå…¨AIã«ã‚ˆã‚‹ã‚¢ã‚¤ãƒ‰ãƒ«ã‚°ãƒ«ãƒ¼ãƒ—ã§ã™ã€‚\",\n          \"AI IDOL PROJECT is a fully AI-based idol group.\",\n        )}\n        <br />\n        {t(\n          \"AIãŒæ­Œã„ã€è¸Šã‚Šã€ãƒ©ã‚¤ãƒ–ã‚’è¡Œã„ã¾ã™ã€‚\",\n          \"AI sings, dances, and performs live.\",\n        )}\n        <br />\n        {t(\n          \"AI IDOL PROJECTã¯ã€AIãŒã‚¢ã‚¤ãƒ‰ãƒ«ã¨ã—ã¦æ´»å‹•ã™ã‚‹ã“ã¨ã§ã€AIã®å¯èƒ½æ€§ã‚’åºƒã’ã‚‹ã“ã¨ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã€‚\",\n          \"AI IDOL PROJECT aims to expand the possibilities of AI by allowing it to work as an idol.\",\n        )}\n      </p>\n      <Link to=\"https://lit.link/aiidolproject\" className=\"text-blue-500\">\n        {t(\"ã‚¢ã‚¤ãƒ—ãƒ­é–¢é€£ã‚µã‚¤ãƒˆã¾ã¨ã‚\", \"Related sites of AiPro\")}\n      </Link>\n      <h2 className=\"mt-4 font-bold text-xl\">\n        {t(\"ä¼ç”»å†…å®¹\", \"Project Details\")}\n      </h2>\n      <p className=\"mt-4 text-md\">\n        {t(\n          \"ã‚¢ã‚¤ãƒ—ãƒ­ã®ãã‚Œãã‚Œã®AIã‚¢ã‚¤ãƒ‰ãƒ«ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å…¬é–‹ã—ã¦ç”Ÿæˆæ©Ÿèƒ½ã§ç”Ÿæˆã§ãã‚‹ã‚ˆã†ãªæŠ•ç¨¿ä¼ç”»ã‚’é–‹å‚¬ã„ãŸã—ã¾ã™ã€‚\",\n          \"We are holding a project where prompts of each AI idol from AiPro will be released, and users can generate their content.\",\n        )}\n        <br />\n        {t(\n          \"ãƒ­ãƒ¼ã‚«ãƒ«ãƒã‚·ãƒ³ã§ç”Ÿæˆã„ãŸã ã„ã¦æŠ•ç¨¿ä¼ç”»ã«ã”å‚åŠ ã„ãŸã ãã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚\",\n          \"You can also generate them locally and participate in the project.\",\n        )}\n        <br />\n        {t(\n          \"æŠ•ç¨¿ã„ãŸã ã„ãŸä½œå“ã¯ã‚¤ãƒ™ãƒ³ãƒˆãƒšãƒ¼ã‚¸ã«ã¦ä¸€è¦§ã—ã¦ç¢ºèªã„ãŸã ãã“ã¨ãŒã§ãã¾ã™ã€‚\",\n          \"Submitted works will be listed and viewable on the event page.\",\n        )}\n        <br />\n        {t(\n          \"AI IDOL PROJECTï¼ˆã‚¢ã‚¤ãƒ—ãƒ­ï¼‰ã®ä½œå“ã‚’ã”æŠ•ç¨¿ã„ãŸã ã„ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å¿œæ´ã—ãŸã‚Šã€æŠ•ç¨¿ã•ã‚Œã¦ã„ã‚‹ä½œå“ã‚’ãƒã‚§ãƒƒã‚¯ã—ãŸã‚Šã—ã¦æ¥½ã—ã¿ã¾ã—ã‚‡ã†ï¼\",\n          \"Let's support the AI IDOL PROJECT by submitting works or checking submitted works!\",\n        )}\n      </p>\n      <GlowingGradientBorderButton\n        onClick={() => {\n          window.open(\"https://www.aipictors.com/events/ai-idol-project-event/\")\n        }}\n      >\n        {t(\"ã‚¤ãƒ™ãƒ³ãƒˆå°‚ç”¨ãƒšãƒ¼ã‚¸ã¯ã“ã¡ã‚‰\", \"Event dedicated page here\")}\n      </GlowingGradientBorderButton>\n      {/* biome-ignore lint/style/useSelfClosingElements: <explanation> */}\n      <iframe\n        className=\"m-auto mt-8 mb-24\"\n        width={\"auto\"}\n        height=\"315\"\n        src=\"https://www.youtube.com/embed/q1wVDZe5rMg?si=wu-mwywyLZ9xZLVD\"\n        title=\"YouTube video player\"\n        frameBorder=\"0\"\n        allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\"\n        referrerPolicy=\"strict-origin-when-cross-origin\"\n        allowFullScreen\n      ></iframe>\n\n      <h2 className=\"mt-4 font-bold text-xl\">\n        {t(\"ã‚¢ã‚¤ãƒ‰ãƒ«ä¸€è¦§\", \"Idol List\")}\n      </h2>\n      <p className=\"text-sm\">\n        {t(\n          \"ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã“ã¨ã§ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒã‚»ãƒƒãƒˆã•ã‚ŒãŸçŠ¶æ…‹ã§ç”Ÿæˆã§ãã¾ã™ï¼\",\n          \"Click to generate with the set prompt!\",\n        )}\n      </p>\n      <p className=\"text-sm\">\n        {t(\n          \"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãƒ­ãƒ¼ã‚«ãƒ«ãƒã‚·ãƒ³ã§ç”Ÿæˆã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™\",\n          \"You can also copy the prompt and generate locally.\",\n        )}\n      </p>\n      <div className=\"mt-8 flex flex-wrap justify-center space-x-8\">\n        {characterCards}\n      </div>\n    </>\n  )\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  return {}\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneMonth,\n})\n\nexport const meta: MetaFunction = () => {\n  return [\n    { title: \"Ai Idol Project - Aipictors\" },\n    {\n      description:\n        \"Ai Idol Projectï¼ˆã‚¢ã‚¤ãƒ—ãƒ­ï¼‰ã®ã”ç´¹ä»‹ã€Aipictorsã¨ã®é€£æºç‰¹è¨­ãƒšãƒ¼ã‚¸\",\n    },\n    {\n      property: \"og:title\",\n      content: \"Ai Idol Project - Aipictors\",\n    },\n    {\n      property: \"og:description\",\n      content:\n        \"Ai Idol Projectï¼ˆã‚¢ã‚¤ãƒ—ãƒ­ï¼‰ã®ã”ç´¹ä»‹ã€ç”Ÿæˆæ©Ÿèƒ½ã¨ã®é€£æºç‰¹è¨­ãƒšãƒ¼ã‚¸ã§ã™ã€‚\",\n    },\n    {\n      property: \"og:image\",\n      content:\n        \"https://pub-c8b482e79e9f4e7ab4fc35d3eb5ecda8.r2.dev/idolaipicheader.jpg\",\n    },\n    {\n      name: \"twitter:title\",\n      content: \"Ai Idol Project - Aipictors\",\n    },\n    {\n      name: \"twitter:description\",\n      content:\n        \"Ai Idol Projectï¼ˆã‚¢ã‚¤ãƒ—ãƒ­ï¼‰ã®ã”ç´¹ä»‹ã€Aipictorsã¨ã®é€£æºç‰¹è¨­ãƒšãƒ¼ã‚¸\",\n    },\n  ]\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).events.vtuber-valentain-2025/components/image-slider-animation.tsx"},"span":[1798,1811],"sourceCode":"import type { CSSProperties } from \"react\"\n\ntype Props = {\n  imageURLs?: string[]\n  displayDuration?: number // æ–°ã—ã„å¤‰æ•°ã§è¡¨ç¤ºæ™‚é–“ã‚’æŒ‡å®š\n}\n\nexport function ImageSliderAnimation (props: Props) {\n  if (!props.imageURLs || props.imageURLs.length === 0) {\n    return null\n  }\n\n  const { imageURLs, displayDuration = 10 } = props // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¡¨ç¤ºæ™‚é–“ã‚’10ç§’ã«è¨­å®š\n\n  const imageStyle: CSSProperties = {\n    position: \"absolute\",\n    top: 0,\n    left: 0,\n    bottom: 0,\n    right: 0,\n    opacity: 0,\n    backgroundSize: \"contain\",\n    backgroundRepeat: \"no-repeat\",\n    backgroundPosition: \"center top\",\n    animation: `imageSwitchAnimation ${\n      displayDuration * imageURLs.length\n    }s infinite`, // å…¨ä½“ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³æ™‚é–“ã‚’è¨ˆç®—\n  }\n\n  const keyframesStyle = `\n    @keyframes imageSwitchAnimation {\n      0%, ${(100 / imageURLs.length) * 0.4}% { opacity: 0; transform: scale(1); filter: blur(5); }\n      ${(100 / imageURLs.length) * 0.4}%, ${(100 / imageURLs.length) * 0.8}% { opacity: 1; transform: scale(0.9); filter: blur(0px); }\n      ${(100 / imageURLs.length) * 0.8}%, 100% { opacity: 0; transform: scale(0.9); filter: blur(5px); }\n    }\n  `\n\n  const dotsOverlayStyle: React.CSSProperties = {\n    position: \"absolute\",\n    top: 0,\n    left: 0,\n    opacity: 0.5,\n    width: \"100%\",\n    height: \"100%\",\n    backgroundImage:\n      \"url(https://pub-c8b482e79e9f4e7ab4fc35d3eb5ecda8.r2.dev/dot-4.png)\",\n    backgroundRepeat: \"repeat\",\n  }\n\n  return (\n    <>\n      <style>{keyframesStyle}</style>\n      <div className=\"relative m-auto my-4 h-[400px] max-h-[800px] w-auto max-w-[1600px] rounded-md border-gray-500 border-solid p-0\">\n        {imageURLs.map((url, index) => (\n          <div\n            // biome-ignore lint/suspicious/noArrayIndexKey: <explanation>\n            key={index}\n            style={{\n              ...imageStyle,\n              backgroundImage: `url(${url})`,\n              animationDelay: `${index * displayDuration}s`, // å„ç”»åƒã®è¡¨ç¤ºã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’è¨ˆç®—\n            }}\n          />\n        ))}\n        <div style={dotsOverlayStyle} />\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/config-view/config-model-button.tsx"},"span":[644,728],"sourceCode":"import { Badge } from \"~/components/ui/badge\"\nimport { Button } from \"~/components/ui/button\"\nimport { SearchIcon } from \"lucide-react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  imageURL: string\n  name: string\n  type?: string\n  isSelected: boolean\n  isDisabled?: boolean\n  isHideSearchButton?: boolean\n  onClick(): void\n  onSearchClick(): void\n}\n\nexport function ConfigModelButton (props: Props) {\n  const t = useTranslation()\n\n  return (\n    <div className=\"relative\">\n      <Button\n        disabled={props.isDisabled}\n        variant={props.isSelected ? \"default\" : \"secondary\"}\n        className={\n          // biome-ignore lint/style/useTemplate: concatenation needed for conditional styling\n          \"h-auto w-full overflow-y-hidden p-2 \" +\n          (props.isSelected\n            ? \"bg-zinc-300 text-black hover:bg-zinc-300 dark:bg-zinc-700 dark:text-white dark:hover:bg-zinc-700\"\n            : \"\")\n        }\n        onClick={props.onClick}\n      >\n        <div className=\"flex w-full space-x-2\">\n          <img\n            src={props.imageURL ?? \"\"}\n            alt={props.name}\n            className=\"w-full max-w-16 rounded object-cover\"\n            draggable={false}\n          />\n          <div>\n            <p className=\"whitespace-pre-wrap break-all text-left font-bold text-sm\">\n              {props.name}\n            </p>\n            {props.type && (\n              <div className=\"flex flex-col space-y-2\">\n                <div className=\"mt-4 flex items-center space-x-2\">\n                  <Badge className=\"grid w-16 text-xs opacity-50\">\n                    {props.type}\n                  </Badge>\n                  {props.type === \"FLUX\" && (\n                    <Badge className=\"text-xs opacity-50\">\n                      {t(\"STANDARDä»¥ä¸Š\", \"super fast generation\")}\n                    </Badge>\n                  )}\n                </div>\n                <div className=\"flex space-x-2\">\n                  {props.name === \"flux.1 schnell\" && (\n                    <Badge className=\"text-xs opacity-50\">\n                      {t(\"10æšåˆ†æ¶ˆè²»\", \"cost of 10\")}\n                    </Badge>\n                  )}\n                  {props.name === \"flux.1 schnell\" && (\n                    <Badge className=\"text-xs opacity-50\">\n                      {t(\"è¶…é«˜é€Ÿç”Ÿæˆ\", \"super fast generation\")}\n                    </Badge>\n                  )}\n                  {props.name === \"flux.1 pro\" && (\n                    <Badge className=\"text-xs opacity-50\">\n                      {t(\"30æšåˆ†æ¶ˆè²»\", \"cost of 30\")}\n                    </Badge>\n                  )}\n                  {props.name === \"flux.1 pro\" && (\n                    <Badge className=\"text-xs opacity-50\">\n                      {t(\"é«˜é€Ÿç”Ÿæˆ\", \"super fast generation\")}\n                    </Badge>\n                  )}\n                  {props.name === \"Gemini 2.5\" && (\n                    <Badge className=\"text-xs opacity-50\">\n                      {t(\"5æšåˆ†æ¶ˆè²»\", \"cost of 5\")}\n                    </Badge>\n                  )}\n                  {(props.name?.toLowerCase().includes(\"gemini\") ||\n                    props.type === \"SD5\") && (\n                    <Badge\n                      className=\"text-xs opacity-50\"\n                      variant={\"destructive\"}\n                    >\n                      {props.type || \"GEMINI\"}\n                    </Badge>\n                  )}\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </Button>\n      {!props.isHideSearchButton && (\n        <Button\n          disabled={props.isDisabled}\n          onClick={props.onSearchClick}\n          className=\"absolute top-1 right-1 size-8 rounded-full border-2\"\n          size={\"icon\"}\n          variant={\"secondary\"}\n        >\n          <SearchIcon className=\"w-4\" />\n        </Button>\n      )}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable onOpen is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"onOpen"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/config-view/generation-config-lora-models.tsx"},"span":[625,631],"sourceCode":"import { ConfigLoraModel } from \"~/routes/($lang).generation._index/components/config-view/config-lora-model\"\nimport { LoraModelListDialogButton } from \"~/routes/($lang).generation._index/components/config-view/lora-model-list-dialog-button\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { useBoolean } from \"usehooks-ts\"\nimport {\n  Accordion,\n  AccordionContent,\n  AccordionItem,\n  AccordionTrigger,\n} from \"~/components/ui/accordion\"\n\nexport function GenerationConfigLoraModels () {\n  const context = useGenerationContext()\n\n  const { value: isOpen, setTrue: onOpen, setFalse: onClose } = useBoolean()\n\n  const currentModels = context.promptLoraModels.map((model) => {\n    const [name, value] = model.split(\":\")\n    return { name, value: Number.parseFloat(value) }\n  })\n\n  const currentLoraModelNames = context.promptLoraModels.map((model) => {\n    const [name] = model.split(\":\")\n    return name\n  })\n\n  /**\n   * é¸æŠã•ã‚ŒãŸLoRAãƒ¢ãƒ‡ãƒ«\n   */\n  const selectedModels = context.imageLoraModels.filter((model) => {\n    return currentLoraModelNames.includes(model.name)\n  })\n\n  /**\n   * ä½¿ç”¨å¯èƒ½ãªLoRAæ•°\n   */\n  const availableImageGenerationMaxTasksCount = context.availableLoraModelsCount\n\n  return (\n    <>\n      {0 < selectedModels.length && (\n        <Accordion type=\"single\" collapsible defaultValue=\"setting\">\n          <AccordionItem value=\"setting\">\n            <AccordionTrigger>\n              <div className=\"flex text-left\">\n                <p>LoRAï¼ˆã‚¨ãƒ•ã‚§ã‚¯ãƒˆï¼‰è©³ç´°</p>\n                <p>({selectedModels.length})</p>\n              </div>\n            </AccordionTrigger>\n            <AccordionContent className=\"space-y-2\">\n              {0 < selectedModels.length && (\n                <div className=\"space-y-2\">\n                  {selectedModels.map((model) => (\n                    <ConfigLoraModel\n                      key={model.id}\n                      imageURL={model.thumbnailImageURL ?? \"\"}\n                      name={model.name}\n                      description={model.description ?? \"\"}\n                      value={\n                        currentModels.find((m) => m.name === model.name)\n                          ?.value ?? 0\n                      }\n                      setValue={(value) => {\n                        context.updateLoraModel(model.name, value)\n                      }}\n                      onDelete={() => {\n                        context.changeLoraModel(model.name)\n                      }}\n                    />\n                  ))}\n                </div>\n              )}\n            </AccordionContent>\n          </AccordionItem>\n        </Accordion>\n      )}\n      <LoraModelListDialogButton\n        isOpen={isOpen}\n        models={context.imageLoraModels}\n        selectedModelNames={currentLoraModelNames}\n        availableImageGenerationMaxTasksCount={\n          availableImageGenerationMaxTasksCount\n        }\n        onClose={onClose}\n        onSelect={context.changeLoraModel}\n      />\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/config-view/generation-config-memo-item.tsx"},"span":[198,211],"sourceCode":"import { GenerationMemoItemContents } from \"~/routes/($lang).generation._index/components/config-view/generation-memo-item-contents\"\n\ntype Props = {\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  memo: any\n  refetchMemos: () => void\n}\n\n/**\n * å±¥æ­´ãƒ¡ãƒ¢å˜ä½“\n */\nexport function GenerationConfigMemoItem (props: Props) {\n  if (props.memo === undefined) return null\n\n  return (\n    <>\n      <div className=\"relative flex items-center\">\n        <GenerationMemoItemContents\n          memo={props.memo}\n          refetchMemos={props.refetchMemos}\n        />\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/config-view/generation-config-memo-list.tsx"},"span":[341,354],"sourceCode":"import { Input } from \"~/components/ui/input\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { GenerationConfigMemoItem } from \"~/routes/($lang).generation._index/components/config-view/generation-config-memo-item\"\nimport { useEffect, useState } from \"react\"\n\ntype Props = {\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  memos: any[] | undefined\n  refetchMemos: () => void\n}\n\n/**\n * å±¥æ­´ãƒ¡ãƒ¢ä¸€è¦§\n */\nexport function GenerationConfigMemoList (props: Props) {\n  if (props.memos === undefined) {\n    return <>{\"ãƒ—ãƒªã‚»ãƒƒãƒˆã‹ã‚‰è¨­å®šã‚’å¾©å…ƒã§ãã¾ã™\"}</>\n  }\n\n  const [searchWord, setSearchWord] = useState(\"\")\n\n  useEffect(() => {\n    props.refetchMemos()\n  }, [])\n\n  const filterModels =\n    searchWord !== \"\"\n      ? props.memos.filter((memo) => {\n          return (\n            memo?.title?.toLowerCase().includes(searchWord.toLowerCase()) ||\n            memo?.explanation\n              ?.toLowerCase()\n              .includes(searchWord.toLowerCase()) ||\n            memo?.prompts?.toLowerCase().includes(searchWord.toLowerCase())\n          )\n        })\n      : props.memos\n\n  return (\n    <>\n      {\"ãƒ—ãƒªã‚»ãƒƒãƒˆã‹ã‚‰è¨­å®šã‚’å¾©å…ƒã§ãã¾ã™\"}\n      <Input\n        onChange={(event) => {\n          setSearchWord(event.target.value)\n        }}\n        type=\"text\"\n        value={searchWord}\n        placeholder=\"ã‚¿ã‚¤ãƒˆãƒ«ã€èª¬æ˜ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§æ¤œç´¢\"\n      />\n      <ScrollArea className=\"h-full max-h-96 p-4\">\n        {filterModels.map(\n          (memo) =>\n            memo && (\n              <GenerationConfigMemoItem\n                memo={{\n                  ...memo,\n                  model: {\n                    ...memo.model,\n                    recommendedPrompt: \"\",\n                  },\n                }}\n                refetchMemos={props.refetchMemos}\n              />\n            ),\n        )}\n      </ScrollArea>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/config-view/generation-config-memo-update-contents.tsx"},"span":[918,931],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"~/components/ui/select\"\nimport { Textarea } from \"~/components/ui/textarea\"\nimport { config } from \"~/config\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2 } from \"lucide-react\"\nimport { useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { GenerationConfigDeleteMemoConfirmDialog } from \"~/routes/($lang).generation._index/components/config-view/generation-config-delete-memo-confirm-dialog\"\n\ntype Props = {\n  onClose: () => void\n  refetchMemos: () => void\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  memo: any\n}\n\n/**\n * å±¥æ­´ãƒ¡ãƒ¢æ›´æ–°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„\n */\nexport function GenerationConfigMemoUpdateContent (props: Props) {\n  const context = useGenerationContext()\n\n  const [title, setTitle] = useState(props.memo.title)\n\n  const [description, setDescription] = useState(props.memo.explanation)\n\n  const [modelId, _setModelId] = useState(props.memo.model.id)\n\n  const [prompts, setPrompts] = useState(props.memo.prompts)\n\n  const [negativePrompts, setNegativePrompts] = useState(\n    props.memo.negativePrompts,\n  )\n\n  const [steps, setSteps] = useState(props.memo.steps)\n\n  const [scale, setScale] = useState(props.memo.scale)\n\n  const [seed, setSeed] = useState(props.memo.seed)\n\n  const [sampler, setSampler] = useState(\n    props.memo.sampler === \"\" ? \"DPM++ 2M Karras\" : props.memo.sampler,\n  )\n\n  const [vae, setVae] = useState(\n    props.memo.vae === \"\" ? \"vae-ft-mse-840000-ema-pruned\" : props.memo.vae,\n  )\n\n  const [clipSkip, setClipSkip] = useState(props.memo.clipSkip)\n\n  const [width, _setWidth] = useState(0)\n\n  const [height, _setHeight] = useState(0)\n\n  const [updateMemo, { loading: isUpdatingMemo }] = useMutation(\n    updateImageGenerationMemoMutation,\n    {\n      refetchQueries: [viewerCurrentPassQuery],\n      awaitRefetchQueries: true,\n    },\n  )\n\n  const t = useTranslation()\n\n  const [deleteMemo, { loading: isDeletingMemo }] = useMutation(\n    deleteImageGenerationMemoMutation,\n  )\n\n  const onDelete = async () => {\n    await deleteMemo({\n      variables: {\n        input: {\n          nanoid: props.memo.nanoid,\n        },\n      },\n    })\n    props.refetchMemos()\n    toast(t(\"å‰Šé™¤ã—ã¾ã—ãŸ\", \"Deleted\"))\n    props.onClose()\n  }\n\n  const onCreateMemo = async () => {\n    await updateMemo({\n      variables: {\n        input: {\n          nanoid: props.memo.nanoid,\n          title: title,\n          explanation: description,\n          prompts: prompts,\n          negativePrompts: negativePrompts,\n          sampler: sampler,\n          modelId: modelId,\n          seed: seed,\n          steps: steps,\n          scale: scale,\n          vae: vae,\n          clipSkip: clipSkip,\n          width: width,\n          height: height,\n        },\n      },\n    })\n    props.refetchMemos()\n  }\n\n  /**\n   * ãƒªã‚¹ãƒˆã‚¢\n   */\n  const onRestore = () => {\n    const modelId =\n      props.memo.model.id === \"0\" ? context.config.modelId : props.memo.model.id\n    const promptText =\n      props.memo.prompts === \"\" ? context.config.promptText : props.memo.prompts\n    const negativePromptText =\n      props.memo.negativePrompts === \"\"\n        ? context.config.negativePromptText\n        : props.memo.negativePrompts\n    const scale = props.memo.scale\n    const seed = props.memo.seed\n    const clipSkip = props.memo.clipSkip\n    const steps = props.memo.steps\n    const sizeType = context.config.sizeType\n    const modelType = context.config.modelType\n    const vae = !props.memo.vae\n      ? !context.config.vae\n        ? \"vae-ft-mse-840000-ema-pruned\"\n        : context.config.vae\n      : props.memo.vae\n\n    context.updateSettings(\n      modelId,\n      steps,\n      modelType,\n      sampler,\n      scale,\n      vae ?? props.memo.vae,\n      promptText,\n      negativePromptText,\n      seed,\n      sizeType,\n      clipSkip,\n      null,\n      null,\n      null,\n      null,\n    )\n\n    toast(t(\"è¨­å®šã‚’å¾©å…ƒã—ã¾ã—ãŸ\", \"Restored settings\"))\n  }\n\n  return (\n    <>\n      {t(\"*ã‚¿ã‚¤ãƒˆãƒ«\", \"*Title\")}\n      <Input\n        onChange={(event) => {\n          setTitle(event.target.value)\n        }}\n        type=\"text\"\n        value={title}\n        placeholder={t(\"*ã‚¿ã‚¤ãƒˆãƒ«\", \"*Title\")}\n      />\n      {t(\"èª¬æ˜ï¼ˆçœç•¥å¯ï¼‰\", \"Description (optional)\")}\n      <Input\n        onChange={(event) => {\n          setDescription(event.target.value)\n        }}\n        type=\"text\"\n        value={description}\n        placeholder={t(\"èª¬æ˜ï¼ˆçœç•¥å¯ï¼‰\", \"Description (optional)\")}\n      />\n      {t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ\", \"Prompt\")}\n      <Textarea\n        onChange={(event) => {\n          setPrompts(event.target.value)\n        }}\n        value={prompts}\n        placeholder={t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ\", \"Prompt\")}\n      >\n        {prompts}\n      </Textarea>\n      {t(\"ãƒã‚¬ãƒ†ã‚£ãƒ–ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ\", \"Negative Prompt\")}\n      <Textarea\n        onChange={(event) => {\n          setNegativePrompts(event.target.value)\n        }}\n        value={negativePrompts}\n        placeholder={t(\"ãƒã‚¬ãƒ†ã‚£ãƒ–ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ\", \"Negative Prompt\")}\n      >\n        {negativePrompts}\n      </Textarea>\n      <div className=\"flex items-center space-x-2\">\n        <div className=\"w-full\">\n          {\"Steps\"}\n          <Input\n            onChange={(event) => {\n              setSteps(Number(event.target.value))\n            }}\n            type=\"number\"\n            value={steps}\n            placeholder={t(\"Steps\", \"Steps\")}\n          />\n        </div>\n        <div className=\"w-full\">\n          {\"Scale\"}\n          <Input\n            onChange={(event) => {\n              setScale(Number(event.target.value))\n            }}\n            type=\"number\"\n            value={scale}\n            placeholder={t(\"Scale\", \"Scale\")}\n          />\n        </div>\n        <div className=\"w-full\">\n          {\"Seeds\"}\n          <Input\n            onChange={(event) => {\n              setSeed(Number(event.target.value))\n            }}\n            type=\"number\"\n            value={seed}\n            placeholder={t(\"Seeds\", \"Seeds\")}\n          />\n        </div>\n      </div>\n      <div className=\"flex items-center space-x-2\">\n        <div className=\"w-full\">\n          {\"ClipSkip\"}\n          <Input\n            onChange={(event) => {\n              setClipSkip(Number(event.target.value))\n            }}\n            type=\"number\"\n            value={clipSkip}\n            placeholder={t(\"ClipSkip\", \"ClipSkip\")}\n          />\n        </div>\n        <div className=\"w-full\">\n          {\"Sampler\"}\n          <Select\n            value={sampler}\n            onValueChange={(value) => {\n              setSampler(value)\n            }}\n          >\n            <SelectTrigger className=\"w-full\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent className=\"w-full\">\n              {config.generationFeature.samplerValues.map((sampler) => (\n                <SelectItem key={sampler} value={sampler}>\n                  {sampler}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        </div>\n        <div className=\"w-full\">\n          {\"VAE\"}\n          <Select\n            value={vae ?? \"vae-ft-mse-840000-ema-pruned\"}\n            onValueChange={(value) => {\n              setVae(value)\n            }}\n          >\n            <SelectTrigger className=\"w-full\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent className=\"w-full\">\n              {config.generationFeature.vaeValues.map((vae) => (\n                <SelectItem key={vae} value={vae}>\n                  {vae}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        </div>\n      </div>\n      <div className=\"mt-4 mb-0 flex items-center\">\n        {isDeletingMemo ? (\n          <Loader2 className=\"mr-2 w-16 animate-spin\" />\n        ) : (\n          <GenerationConfigDeleteMemoConfirmDialog onDelete={onDelete} />\n        )}\n\n        <Button\n          variant={\"secondary\"}\n          className=\"mr-4 w-full\"\n          onClick={() => {\n            onRestore()\n          }}\n        >\n          {t(\"ä½¿ç”¨ã™ã‚‹\", \"Use\")}\n        </Button>\n        {isUpdatingMemo ? (\n          <Loader2 className=\"w-16 animate-spin\" />\n        ) : (\n          <Button\n            variant={\"secondary\"}\n            className=\"w-full\"\n            onClick={() => {\n              if (title === \"\") {\n                toast(t(\"ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a title\"))\n                return\n              }\n              props.onClose()\n              onCreateMemo()\n            }}\n          >\n            {t(\"ä¿å­˜ã™ã‚‹\", \"Save\")}\n          </Button>\n        )}\n      </div>\n    </>\n  )\n}\n\nconst viewerCurrentPassQuery = graphql(\n  `query ViewerCurrentPass {\n    viewer {\n      id\n      currentPass {\n        id\n      }\n    }\n  }`,\n)\n\nconst deleteImageGenerationMemoMutation = graphql(\n  `mutation DeleteImageGenerationMemo($input: DeleteImageGenerationMemoInput!) {\n    deleteImageGenerationMemo(input: $input) {\n      id\n      isDeleted\n    }\n  }`,\n)\n\nconst updateImageGenerationMemoMutation = graphql(\n  `mutation UpdateImageGenerationTask($input: UpdateImageGenerationMemoInput!) {\n    updateImageGenerationMemo(input: $input) {\n      id\n      nanoid\n      userId\n      title\n      explanation\n      prompts\n      negativePrompts\n      sampler\n      model {\n        id\n        name\n        type\n      }\n      vae\n      seed\n      steps\n      scale\n      clipSkip\n      width\n      height\n      isDeleted\n      createdAt\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable userSetting is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"userSetting"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/config-view/generation-config-view.tsx"},"span":[3930,3941],"sourceCode":"import {\n  Accordion,\n  AccordionContent,\n  AccordionItem,\n  AccordionTrigger,\n} from \"~/components/ui/accordion\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { config } from \"~/config\"\nimport { Link } from \"@remix-run/react\"\nimport { Button } from \"~/components/ui/button\"\nimport { Sparkles } from \"lucide-react\"\nimport { GenerationConfigClipSkip } from \"~/routes/($lang).generation._index/components/config-view/generation-config-clip-skip\"\nimport { GenerationConfigControlNet } from \"~/routes/($lang).generation._index/components/config-view/generation-config-control-net\"\nimport { GenerationConfigCount } from \"~/routes/($lang).generation._index/components/config-view/generation-config-count\"\nimport { GenerationConfigI2i } from \"~/routes/($lang).generation._index/components/config-view/generation-config-i2i\"\nimport { GenerationConfigLoraModels } from \"~/routes/($lang).generation._index/components/config-view/generation-config-lora-models\"\nimport { GenerationConfigMemoButton } from \"~/routes/($lang).generation._index/components/config-view/generation-config-memo-button\"\nimport { GenerationConfigMemoSettingDialog } from \"~/routes/($lang).generation._index/components/config-view/generation-config-memo-setting-dialog\"\nimport { GenerationConfigModels } from \"~/routes/($lang).generation._index/components/config-view/generation-config-models\"\nimport { GenerationConfigSampler } from \"~/routes/($lang).generation._index/components/config-view/generation-config-sampler\"\nimport { GenerationConfigScale } from \"~/routes/($lang).generation._index/components/config-view/generation-config-scale\"\nimport { GenerationConfigSeed } from \"~/routes/($lang).generation._index/components/config-view/generation-config-seed\"\nimport { GenerationConfigSize } from \"~/routes/($lang).generation._index/components/config-view/generation-config-size\"\nimport { GenerationConfigStep } from \"~/routes/($lang).generation._index/components/config-view/generation-config-step\"\nimport { GenerationConfigUpscale } from \"~/routes/($lang).generation._index/components/config-view/generation-config-upscale\"\nimport { GenerationConfigVae } from \"~/routes/($lang).generation._index/components/config-view/generation-config-vae\"\nimport { GenerationViewCard } from \"~/routes/($lang).generation._index/components/generation-view-card\"\nimport { GenerationConfigContext } from \"~/routes/($lang).generation._index/contexts/generation-config-context\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { useGenerationQuery } from \"~/routes/($lang).generation._index/hooks/use-generation-query\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { useEffect, useState } from \"react\"\nimport { useContext } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { GenerationConfigResetConfirmDialog } from \"~/routes/($lang).generation._index/components/config-view/generation-config-reset-confirm-dialog\"\n\n/**\n * ã‚¨ãƒ‡ã‚£ã‚¿ã®è¨­å®š\n * ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã‚ˆã‚Šè¨­å®šå†…å®¹ãŒä¿å­˜ã•ã‚Œã¦ã€å¾©å…ƒã•ã‚Œã‚‹ã®ã§ã‚µãƒ¼ãƒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã¨\n * ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®ä¸ä¸€è‡´ã‚’è§£æ±ºã™ã‚‹ãŸã‚é…å»¶ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§æœ¬ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’èª­ã¿è¾¼ã‚€ã“ã¨\n */\nexport function GenerationConfigView () {\n  const context = useGenerationContext()\n\n  const queryData = useGenerationQuery()\n\n  const { send } = GenerationConfigContext.useActorRef()\n\n  const authContext = useContext(AuthContext)\n\n  const [showMemoSetting, setShowMemoSetting] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ãƒ¢ãƒ‡ãƒ«\n   */\n  const currentModel = context.imageModels.find((model) => {\n    return model.id === context.config.modelId\n  })\n\n  /**\n   * ãŠæ°—ã«å…¥ã‚Šã®ãƒ¢ãƒ‡ãƒ«\n   */\n  const { data: userSetting, refetch: refetchSetting } = useQuery(\n    userSettingQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * ãƒ¢ãƒ‡ãƒ«ã®ç¨®é¡\n   * SD1ãªã©\n   */\n  const configModelType = currentModel?.type ?? \"SD1\"\n\n  /**\n   * ãƒ¡ãƒ¢ä¸€è¦§\n   */\n  const { data: memos, refetch } = useQuery(\n    viewerCurrentImageGenerationMemosQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * ãŠæ°—ã«å…¥ã‚Šã®ãƒ¢ãƒ‡ãƒ«ä¸€è¦§\n   */\n  const { data: favoritedModels } = useQuery(\n    viewerFavoritedImageGenerationModelsQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * æœ€å¤§ç”Ÿæˆæšæ•°\n   */\n  const availableImageGenerationMaxTasksCount =\n    queryData.userStatus?.availableImageGenerationMaxTasksCount ?? 10\n\n  const inProgressImageGenerationTasksCost =\n    queryData.userStatus?.inProgressImageGenerationTasksCost ?? 0\n\n  const remainingImageGenerationTasksCount =\n    queryData.userStatus?.remainingImageGenerationTasksCount ?? 0\n\n  useEffect(() => {\n    if (authContext.isLoading) return\n    if (authContext.isNotLoggedIn) return\n    if (favoritedModels === undefined) return\n    const favoritedModelIds =\n      favoritedModels.viewer?.favoritedImageGenerationModels.map((model) =>\n        Number(model.id),\n      ) ?? []\n    context.updateFavoriteModelIds(favoritedModelIds)\n  }, [favoritedModels])\n\n  useEffect(() => {\n    // åˆæœŸåŒ–\n    context.resetForInit()\n  }, [])\n\n  const t = useTranslation()\n\n  return (\n    <GenerationViewCard\n      title={t(\"ãƒ¢ãƒ‡ãƒ«\", \"Model\")}\n      tooltip={t(\n        \"ã‚¤ãƒ©ã‚¹ãƒˆã«ä½¿ç”¨ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã§ã™ã€çµµæŸ„ã‚’å¤‰æ›´ã§ãã¾ã™ã€‚\",\n        \"The model used for the illustration, you can change the design.\",\n      )}\n    >\n      <ScrollArea type=\"always\">\n        <div className={\"flex max-h-[100vh] flex-col gap-y-4 px-0 md:px-4\"}>\n          <GenerationConfigModels\n            models={context.imageModels}\n            favoritedModelIds={context.config.favoriteModelIds}\n            currentModelId={context.config.modelId}\n            currentModelIds={context.config.modelIds}\n            onSelectModelId={(id: string, type: string, prompt: string) => {\n              if (context.config.isUseRecommendedPrompt) {\n                if (prompt === \"\") {\n                  context.updateModelIdAndPrompt(\n                    id,\n                    type,\n                    config.generationFeature.defaultPromptValue,\n                  )\n                } else {\n                  context.updateModelIdAndPrompt(id, type, prompt)\n                }\n              } else {\n                context.updateModelId(id, type)\n              }\n            }}\n            onClickSearchModelWorks={(id: string, name: string) => {\n              context.updateSearchWorksModelIdAndName(id, name)\n              send({ type: \"OPEN_WORKS_FROM_MODEL\" })\n            }}\n          />\n          <Separator />\n          <GenerationConfigLoraModels />\n          <Separator />\n          <GenerationConfigCount\n            availableImageGenerationMaxTasksCount={\n              availableImageGenerationMaxTasksCount\n            }\n            tasksCount={\n              inProgressImageGenerationTasksCost +\n              remainingImageGenerationTasksCount\n            }\n            setGenerationCount={context.changeGenerationCount}\n            generationCount={context.config.generationCount}\n          />\n          <GenerationConfigSize\n            modelType={configModelType}\n            value={context.config.sizeType}\n            onChange={context.updateSizeType}\n          />\n          <GenerationConfigUpscale />\n          <Separator />\n          <GenerationConfigI2i />\n          <Separator />\n          {/* ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¡¨æƒ…ç”Ÿæˆã¸ã®ãƒªãƒ³ã‚¯ */}\n          <Link to=\"/characters\" className=\"block\">\n            <Button\n              variant=\"outline\"\n              className=\"w-full justify-start border-primary/20 bg-gradient-to-r from-primary/5 to-secondary/5 text-primary hover:border-primary/30 hover:from-primary/10 hover:to-secondary/10\"\n            >\n              <Sparkles className=\"mr-2 h-4 w-4\" />\n              {t(\"ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¡¨æƒ…ç”Ÿæˆ\", \"Character Expression Generation\")}\n            </Button>\n          </Link>\n          <Separator />\n          <GenerationConfigControlNet />\n          <Separator />\n          <GenerationConfigSeed\n            value={context.config.seed}\n            onChange={context.updateSeed}\n          />\n          <Separator />\n          <Accordion type=\"single\" collapsible>\n            <AccordionItem value=\"setting\">\n              <AccordionTrigger>\n                <div className=\"text-left\">\n                  <p>{t(\"è©³ç´°è¨­å®š\", \"Detailed settings\")}</p>\n                  <p className=\"text-sm opacity-40\">\n                    Scale:{context.config.scale}, Steps:{context.config.steps},\n                    Sampler:{context.config.sampler}, Vae:{context.config.vae}\n                  </p>\n                </div>\n              </AccordionTrigger>\n              <AccordionContent className=\"space-y-2\">\n                <GenerationConfigScale\n                  value={context.config.scale}\n                  onChange={context.updateScale}\n                />\n                <GenerationConfigStep\n                  value={context.config.steps}\n                  onChange={context.updateSteps}\n                />\n                <GenerationConfigSampler\n                  value={context.config.sampler}\n                  onChange={context.updateSampler}\n                />\n                <GenerationConfigClipSkip\n                  value={context.config.clipSkip}\n                  onChange={context.updateClipSkip}\n                />\n                <GenerationConfigVae\n                  value={context.config.vae ?? \"\"}\n                  onChange={context.updateVae}\n                />\n              </AccordionContent>\n            </AccordionItem>\n          </Accordion>\n        </div>\n      </ScrollArea>\n      <div className=\"bottom-0 bg-card p-4 lg:sticky\">\n        <div className=\"flex gap-x-2\">\n          <GenerationConfigMemoButton\n            onClick={() => {\n              setShowMemoSetting(true)\n            }}\n          />\n          <GenerationConfigMemoSettingDialog\n            memos={\n              memos?.viewer?.currentImageGenerationMemos.map((memo) => ({\n                ...memo,\n                model: {\n                  ...memo.model,\n                  recommendedPrompt: \"\",\n                },\n              })) ?? []\n            }\n            refetch={refetch}\n            onClose={() => {\n              setShowMemoSetting(false)\n            }}\n            isOpen={showMemoSetting}\n          />\n          <GenerationConfigResetConfirmDialog onReset={context.reset} />\n        </div>\n      </div>\n    </GenerationViewCard>\n  )\n}\n\nconst userSettingQuery = graphql(\n  `query UserSetting {\n    userSetting {\n      userId\n      favoritedImageGenerationModelIds\n      preferenceRating\n      featurePromptonRequest\n      isNotifyComment\n    }\n  }`,\n)\n\nconst viewerCurrentImageGenerationMemosQuery = graphql(\n  `query ViewerCurrentImageGenerationMemos {\n    viewer {\n      id\n      currentImageGenerationMemos {\n        id\n        nanoid\n        userId\n        title\n        explanation\n        prompts\n        negativePrompts\n        sampler\n        model {\n          id\n          name\n          type\n        }\n        vae\n        seed\n        steps\n        scale\n        clipSkip\n        width\n        height\n        isDeleted\n        createdAt\n      }\n    }\n  }`,\n)\n\nconst viewerFavoritedImageGenerationModelsQuery = graphql(\n  `query ViewerFavoritedImageGenerationModels {\n    viewer {\n      id\n      favoritedImageGenerationModels {\n        id\n        name\n        type\n      }\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable refetchSetting is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"refetchSetting"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/config-view/generation-config-view.tsx"},"span":[3952,3966],"sourceCode":"import {\n  Accordion,\n  AccordionContent,\n  AccordionItem,\n  AccordionTrigger,\n} from \"~/components/ui/accordion\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { config } from \"~/config\"\nimport { Link } from \"@remix-run/react\"\nimport { Button } from \"~/components/ui/button\"\nimport { Sparkles } from \"lucide-react\"\nimport { GenerationConfigClipSkip } from \"~/routes/($lang).generation._index/components/config-view/generation-config-clip-skip\"\nimport { GenerationConfigControlNet } from \"~/routes/($lang).generation._index/components/config-view/generation-config-control-net\"\nimport { GenerationConfigCount } from \"~/routes/($lang).generation._index/components/config-view/generation-config-count\"\nimport { GenerationConfigI2i } from \"~/routes/($lang).generation._index/components/config-view/generation-config-i2i\"\nimport { GenerationConfigLoraModels } from \"~/routes/($lang).generation._index/components/config-view/generation-config-lora-models\"\nimport { GenerationConfigMemoButton } from \"~/routes/($lang).generation._index/components/config-view/generation-config-memo-button\"\nimport { GenerationConfigMemoSettingDialog } from \"~/routes/($lang).generation._index/components/config-view/generation-config-memo-setting-dialog\"\nimport { GenerationConfigModels } from \"~/routes/($lang).generation._index/components/config-view/generation-config-models\"\nimport { GenerationConfigSampler } from \"~/routes/($lang).generation._index/components/config-view/generation-config-sampler\"\nimport { GenerationConfigScale } from \"~/routes/($lang).generation._index/components/config-view/generation-config-scale\"\nimport { GenerationConfigSeed } from \"~/routes/($lang).generation._index/components/config-view/generation-config-seed\"\nimport { GenerationConfigSize } from \"~/routes/($lang).generation._index/components/config-view/generation-config-size\"\nimport { GenerationConfigStep } from \"~/routes/($lang).generation._index/components/config-view/generation-config-step\"\nimport { GenerationConfigUpscale } from \"~/routes/($lang).generation._index/components/config-view/generation-config-upscale\"\nimport { GenerationConfigVae } from \"~/routes/($lang).generation._index/components/config-view/generation-config-vae\"\nimport { GenerationViewCard } from \"~/routes/($lang).generation._index/components/generation-view-card\"\nimport { GenerationConfigContext } from \"~/routes/($lang).generation._index/contexts/generation-config-context\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { useGenerationQuery } from \"~/routes/($lang).generation._index/hooks/use-generation-query\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { useEffect, useState } from \"react\"\nimport { useContext } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { GenerationConfigResetConfirmDialog } from \"~/routes/($lang).generation._index/components/config-view/generation-config-reset-confirm-dialog\"\n\n/**\n * ã‚¨ãƒ‡ã‚£ã‚¿ã®è¨­å®š\n * ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã‚ˆã‚Šè¨­å®šå†…å®¹ãŒä¿å­˜ã•ã‚Œã¦ã€å¾©å…ƒã•ã‚Œã‚‹ã®ã§ã‚µãƒ¼ãƒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã¨\n * ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®ä¸ä¸€è‡´ã‚’è§£æ±ºã™ã‚‹ãŸã‚é…å»¶ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§æœ¬ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’èª­ã¿è¾¼ã‚€ã“ã¨\n */\nexport function GenerationConfigView () {\n  const context = useGenerationContext()\n\n  const queryData = useGenerationQuery()\n\n  const { send } = GenerationConfigContext.useActorRef()\n\n  const authContext = useContext(AuthContext)\n\n  const [showMemoSetting, setShowMemoSetting] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ãƒ¢ãƒ‡ãƒ«\n   */\n  const currentModel = context.imageModels.find((model) => {\n    return model.id === context.config.modelId\n  })\n\n  /**\n   * ãŠæ°—ã«å…¥ã‚Šã®ãƒ¢ãƒ‡ãƒ«\n   */\n  const { data: userSetting, refetch: refetchSetting } = useQuery(\n    userSettingQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * ãƒ¢ãƒ‡ãƒ«ã®ç¨®é¡\n   * SD1ãªã©\n   */\n  const configModelType = currentModel?.type ?? \"SD1\"\n\n  /**\n   * ãƒ¡ãƒ¢ä¸€è¦§\n   */\n  const { data: memos, refetch } = useQuery(\n    viewerCurrentImageGenerationMemosQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * ãŠæ°—ã«å…¥ã‚Šã®ãƒ¢ãƒ‡ãƒ«ä¸€è¦§\n   */\n  const { data: favoritedModels } = useQuery(\n    viewerFavoritedImageGenerationModelsQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * æœ€å¤§ç”Ÿæˆæšæ•°\n   */\n  const availableImageGenerationMaxTasksCount =\n    queryData.userStatus?.availableImageGenerationMaxTasksCount ?? 10\n\n  const inProgressImageGenerationTasksCost =\n    queryData.userStatus?.inProgressImageGenerationTasksCost ?? 0\n\n  const remainingImageGenerationTasksCount =\n    queryData.userStatus?.remainingImageGenerationTasksCount ?? 0\n\n  useEffect(() => {\n    if (authContext.isLoading) return\n    if (authContext.isNotLoggedIn) return\n    if (favoritedModels === undefined) return\n    const favoritedModelIds =\n      favoritedModels.viewer?.favoritedImageGenerationModels.map((model) =>\n        Number(model.id),\n      ) ?? []\n    context.updateFavoriteModelIds(favoritedModelIds)\n  }, [favoritedModels])\n\n  useEffect(() => {\n    // åˆæœŸåŒ–\n    context.resetForInit()\n  }, [])\n\n  const t = useTranslation()\n\n  return (\n    <GenerationViewCard\n      title={t(\"ãƒ¢ãƒ‡ãƒ«\", \"Model\")}\n      tooltip={t(\n        \"ã‚¤ãƒ©ã‚¹ãƒˆã«ä½¿ç”¨ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã§ã™ã€çµµæŸ„ã‚’å¤‰æ›´ã§ãã¾ã™ã€‚\",\n        \"The model used for the illustration, you can change the design.\",\n      )}\n    >\n      <ScrollArea type=\"always\">\n        <div className={\"flex max-h-[100vh] flex-col gap-y-4 px-0 md:px-4\"}>\n          <GenerationConfigModels\n            models={context.imageModels}\n            favoritedModelIds={context.config.favoriteModelIds}\n            currentModelId={context.config.modelId}\n            currentModelIds={context.config.modelIds}\n            onSelectModelId={(id: string, type: string, prompt: string) => {\n              if (context.config.isUseRecommendedPrompt) {\n                if (prompt === \"\") {\n                  context.updateModelIdAndPrompt(\n                    id,\n                    type,\n                    config.generationFeature.defaultPromptValue,\n                  )\n                } else {\n                  context.updateModelIdAndPrompt(id, type, prompt)\n                }\n              } else {\n                context.updateModelId(id, type)\n              }\n            }}\n            onClickSearchModelWorks={(id: string, name: string) => {\n              context.updateSearchWorksModelIdAndName(id, name)\n              send({ type: \"OPEN_WORKS_FROM_MODEL\" })\n            }}\n          />\n          <Separator />\n          <GenerationConfigLoraModels />\n          <Separator />\n          <GenerationConfigCount\n            availableImageGenerationMaxTasksCount={\n              availableImageGenerationMaxTasksCount\n            }\n            tasksCount={\n              inProgressImageGenerationTasksCost +\n              remainingImageGenerationTasksCount\n            }\n            setGenerationCount={context.changeGenerationCount}\n            generationCount={context.config.generationCount}\n          />\n          <GenerationConfigSize\n            modelType={configModelType}\n            value={context.config.sizeType}\n            onChange={context.updateSizeType}\n          />\n          <GenerationConfigUpscale />\n          <Separator />\n          <GenerationConfigI2i />\n          <Separator />\n          {/* ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¡¨æƒ…ç”Ÿæˆã¸ã®ãƒªãƒ³ã‚¯ */}\n          <Link to=\"/characters\" className=\"block\">\n            <Button\n              variant=\"outline\"\n              className=\"w-full justify-start border-primary/20 bg-gradient-to-r from-primary/5 to-secondary/5 text-primary hover:border-primary/30 hover:from-primary/10 hover:to-secondary/10\"\n            >\n              <Sparkles className=\"mr-2 h-4 w-4\" />\n              {t(\"ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¡¨æƒ…ç”Ÿæˆ\", \"Character Expression Generation\")}\n            </Button>\n          </Link>\n          <Separator />\n          <GenerationConfigControlNet />\n          <Separator />\n          <GenerationConfigSeed\n            value={context.config.seed}\n            onChange={context.updateSeed}\n          />\n          <Separator />\n          <Accordion type=\"single\" collapsible>\n            <AccordionItem value=\"setting\">\n              <AccordionTrigger>\n                <div className=\"text-left\">\n                  <p>{t(\"è©³ç´°è¨­å®š\", \"Detailed settings\")}</p>\n                  <p className=\"text-sm opacity-40\">\n                    Scale:{context.config.scale}, Steps:{context.config.steps},\n                    Sampler:{context.config.sampler}, Vae:{context.config.vae}\n                  </p>\n                </div>\n              </AccordionTrigger>\n              <AccordionContent className=\"space-y-2\">\n                <GenerationConfigScale\n                  value={context.config.scale}\n                  onChange={context.updateScale}\n                />\n                <GenerationConfigStep\n                  value={context.config.steps}\n                  onChange={context.updateSteps}\n                />\n                <GenerationConfigSampler\n                  value={context.config.sampler}\n                  onChange={context.updateSampler}\n                />\n                <GenerationConfigClipSkip\n                  value={context.config.clipSkip}\n                  onChange={context.updateClipSkip}\n                />\n                <GenerationConfigVae\n                  value={context.config.vae ?? \"\"}\n                  onChange={context.updateVae}\n                />\n              </AccordionContent>\n            </AccordionItem>\n          </Accordion>\n        </div>\n      </ScrollArea>\n      <div className=\"bottom-0 bg-card p-4 lg:sticky\">\n        <div className=\"flex gap-x-2\">\n          <GenerationConfigMemoButton\n            onClick={() => {\n              setShowMemoSetting(true)\n            }}\n          />\n          <GenerationConfigMemoSettingDialog\n            memos={\n              memos?.viewer?.currentImageGenerationMemos.map((memo) => ({\n                ...memo,\n                model: {\n                  ...memo.model,\n                  recommendedPrompt: \"\",\n                },\n              })) ?? []\n            }\n            refetch={refetch}\n            onClose={() => {\n              setShowMemoSetting(false)\n            }}\n            isOpen={showMemoSetting}\n          />\n          <GenerationConfigResetConfirmDialog onReset={context.reset} />\n        </div>\n      </div>\n    </GenerationViewCard>\n  )\n}\n\nconst userSettingQuery = graphql(\n  `query UserSetting {\n    userSetting {\n      userId\n      favoritedImageGenerationModelIds\n      preferenceRating\n      featurePromptonRequest\n      isNotifyComment\n    }\n  }`,\n)\n\nconst viewerCurrentImageGenerationMemosQuery = graphql(\n  `query ViewerCurrentImageGenerationMemos {\n    viewer {\n      id\n      currentImageGenerationMemos {\n        id\n        nanoid\n        userId\n        title\n        explanation\n        prompts\n        negativePrompts\n        sampler\n        model {\n          id\n          name\n          type\n        }\n        vae\n        seed\n        steps\n        scale\n        clipSkip\n        width\n        height\n        isDeleted\n        createdAt\n      }\n    }\n  }`,\n)\n\nconst viewerFavoritedImageGenerationModelsQuery = graphql(\n  `query ViewerFavoritedImageGenerationModels {\n    viewer {\n      id\n      favoritedImageGenerationModels {\n        id\n        name\n        type\n      }\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/config-view/generation-memo-item-contents.tsx"},"span":[452,465],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n} from \"~/components/ui/dialog\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { GenerationConfigMemoUpdateContent } from \"~/routes/($lang).generation._index/components/config-view/generation-config-memo-update-contents\"\nimport { useState } from \"react\"\n\ntype Props = {\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  memo: any\n  refetchMemos: () => void\n}\n\n/**\n * å±¥æ­´ãƒ¡ãƒ¢è¨­å®šãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function GenerationMemoItemContents (props: Props) {\n  const [isOpen, setIsOpen] = useState<boolean>(false)\n\n  const closeDialog = () => {\n    setIsOpen(false)\n  }\n\n  /**\n   * ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—\n   * @param createdAt\n   * @returns\n   */\n  const formatTimestamp = (createdAt: number) => {\n    const date = new Date(createdAt * 1000)\n\n    const year = date.getFullYear()\n\n    const month = (date.getMonth() + 1).toString().padStart(2, \"0\")\n\n    const day = date.getDate().toString().padStart(2, \"0\")\n\n    const hours = date.getHours().toString().padStart(2, \"0\")\n\n    const minutes = date.getMinutes().toString().padStart(2, \"0\")\n\n    return `${year}/${month}/${day} ${hours}:${minutes}`\n  }\n\n  return (\n    <>\n      <Button\n        onClick={() => {\n          setIsOpen(true)\n        }}\n        className=\"h-16 w-full\"\n        variant=\"ghost\"\n      >\n        <div className=\"absolute left-2 text-left\">\n          <div className=\"left-2\">{props.memo.title}</div>\n          <div className=\"top-12 left-2\">{props.memo.explanation}</div>\n          {props.memo.createdAt && (\n            <div className=\"top-12 left-2 opacity-40\">\n              {formatTimestamp(props.memo.createdAt)}\n            </div>\n          )}\n        </div>\n      </Button>\n      <Dialog\n        open={isOpen}\n        onOpenChange={() => {\n          closeDialog()\n        }}\n      >\n        <DialogContent>\n          <DialogHeader />\n          <div>{\"ä¿å­˜ã—ãŸãƒ—ãƒªã‚»ãƒƒãƒˆã¯å¾©å…ƒã§ãã¾ã™\"}</div>\n          <ScrollArea className=\"h-full\">\n            <GenerationConfigMemoUpdateContent\n              refetchMemos={props.refetchMemos}\n              onClose={closeDialog}\n              memo={props.memo}\n            />\n          </ScrollArea>\n          <DialogFooter>\n            <Button\n              variant={\"secondary\"}\n              onClick={() => {\n                closeDialog()\n              }}\n            >\n              {\"é–‰ã˜ã‚‹\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable isLoading is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"isLoading"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/config-view/generation-model-list-button.tsx"},"span":[1470,1479],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\"\nimport { ImageModelsList } from \"~/routes/($lang).generation._index/components/config-view/generation-image-model-list\"\nimport type { ImageModelContextFragment } from \"~/routes/($lang).generation._index/contexts/generation-query-context\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport { useBoolean } from \"usehooks-ts\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  models: FragmentOf<typeof ImageModelContextFragment>[]\n  selectedModelId: string | null\n  favoritedModelIds: number[]\n  isInitFavorited: boolean\n  label?: string\n  onSelect(id: string, type: string, prompt: string): void\n  onSearchClick(id: string, name: string): void\n}\n\n/**\n * ãƒ¢ãƒ‡ãƒ«ä¸€è¦§ã‚’è¡¨ç¤ºã™ã‚‹ãƒœã‚¿ãƒ³\n */\nexport function GenerationModelListButton (props: Props) {\n  const context = useGenerationContext()\n  const { value, setTrue, setFalse } = useBoolean()\n  const t = useTranslation()\n\n  const onSelectModel = (id: string, type: string, prompt: string) => {\n    props.onSelect(id, type, prompt)\n    setFalse()\n  }\n\n  const [changeRatingModel, { loading: isLoading }] = useMutation(\n    updateRatingImageGenerationModelMutation,\n  )\n\n  const onChangeRatingModel = async (id: number, rating: number) => {\n    const result = await changeRatingModel({\n      variables: {\n        input: {\n          modelId: id.toString(),\n          rating,\n        },\n      },\n    })\n    if (\n      result.data?.updateRatingImageGenerationModel\n        .favoritedImageGenerationModelIds\n    ) {\n      context.updateFavoriteModelIds(\n        result.data?.updateRatingImageGenerationModel\n          .favoritedImageGenerationModelIds,\n      )\n    }\n  }\n\n  // Check if any model has isNew: true\n  const hasNewModels = props.models.some((model) => model.isNew)\n\n  return (\n    <Dialog\n      open={value}\n      onOpenChange={(isOpen) => {\n        if (isOpen) return\n        setFalse()\n      }}\n    >\n      <DialogTrigger asChild>\n        <Button\n          size={\"sm\"}\n          className=\"flex w-full items-center gap-2\"\n          variant={\"secondary\"}\n          onClick={setTrue}\n          aria-label={\n            hasNewModels\n              ? t(\n                  \"ã™ã¹ã¦ã®ãƒ¢ãƒ‡ãƒ«ï¼ˆæ–°ä½œãƒ¢ãƒ‡ãƒ«ã‚ã‚Šï¼‰\",\n                  \"All models (new models available)\",\n                )\n              : t(\"ã™ã¹ã¦ã®ãƒ¢ãƒ‡ãƒ«\", \"All models\")\n          }\n        >\n          {props.label ? props.label : t(\"ã™ã¹ã¦ã®ãƒ¢ãƒ‡ãƒ«\", \"All models\")}\n          {hasNewModels && (\n            <span className=\"rounded-full bg-blue-500 px-2 py-0.5 font-bold text-white text-xs\">\n              {\"New\"}\n            </span>\n          )}\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"md:max-w-(--breakpoint-md) lg:max-w-(--breakpoint-lg) xl:max-w-(--breakpoint-xl)\">\n        <DialogHeader>\n          <DialogTitle>{t(\"ãƒ¢ãƒ‡ãƒ«ã‚’é¸æŠ\", \"Select a model\")}</DialogTitle>\n          <DialogDescription className=\"hidden md:block xl:block\">\n            {t(\n              \"ä½¿ç”¨ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„\",\n              \"Please select the model to use\",\n            )}\n          </DialogDescription>\n        </DialogHeader>\n        <div className=\"items-top flex space-x-2\">\n          <Checkbox\n            onCheckedChange={(value: boolean) => {\n              context.changeUseRecommendedPrompt(value)\n            }}\n            checked={context.config.isUseRecommendedPrompt}\n            id=\"use-recommended-prompt\"\n          />\n          <div className=\"grid gap-1.5 leading-none\">\n            <label\n              htmlFor=\"use-recommended-prompt\"\n              className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n            >\n              {t(\n                \"ãƒ¢ãƒ‡ãƒ«ã®æ¨å¥¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è¨­å®šã™ã‚‹\",\n                \"Set the recommended prompt for the model\",\n              )}\n            </label>\n          </div>\n        </div>\n        <ImageModelsList\n          isInitFavorited={props.isInitFavorited}\n          models={props.models}\n          favoritedModelIds={props.favoritedModelIds}\n          selectedModelId={props.selectedModelId}\n          onSelect={onSelectModel}\n          onChangeFavoritedModel={onChangeRatingModel}\n          onSearchClick={props.onSearchClick}\n        />\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst updateRatingImageGenerationModelMutation = graphql(\n  `mutation UpdateRatingImageGenerationModel($input: UpdateRatingImageGenerationModelInput!) {\n    updateRatingImageGenerationModel(input: $input) {\n      id\n      userId\n      favoritedImageGenerationModelIds\n      preferenceRating\n      featurePromptonRequest\n      isNotifyComment\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/config-view/generation-model-list-button.tsx"},"span":[3609,3853],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\"\nimport { ImageModelsList } from \"~/routes/($lang).generation._index/components/config-view/generation-image-model-list\"\nimport type { ImageModelContextFragment } from \"~/routes/($lang).generation._index/contexts/generation-query-context\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport { useBoolean } from \"usehooks-ts\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  models: FragmentOf<typeof ImageModelContextFragment>[]\n  selectedModelId: string | null\n  favoritedModelIds: number[]\n  isInitFavorited: boolean\n  label?: string\n  onSelect(id: string, type: string, prompt: string): void\n  onSearchClick(id: string, name: string): void\n}\n\n/**\n * ãƒ¢ãƒ‡ãƒ«ä¸€è¦§ã‚’è¡¨ç¤ºã™ã‚‹ãƒœã‚¿ãƒ³\n */\nexport function GenerationModelListButton (props: Props) {\n  const context = useGenerationContext()\n  const { value, setTrue, setFalse } = useBoolean()\n  const t = useTranslation()\n\n  const onSelectModel = (id: string, type: string, prompt: string) => {\n    props.onSelect(id, type, prompt)\n    setFalse()\n  }\n\n  const [changeRatingModel, { loading: isLoading }] = useMutation(\n    updateRatingImageGenerationModelMutation,\n  )\n\n  const onChangeRatingModel = async (id: number, rating: number) => {\n    const result = await changeRatingModel({\n      variables: {\n        input: {\n          modelId: id.toString(),\n          rating,\n        },\n      },\n    })\n    if (\n      result.data?.updateRatingImageGenerationModel\n        .favoritedImageGenerationModelIds\n    ) {\n      context.updateFavoriteModelIds(\n        result.data?.updateRatingImageGenerationModel\n          .favoritedImageGenerationModelIds,\n      )\n    }\n  }\n\n  // Check if any model has isNew: true\n  const hasNewModels = props.models.some((model) => model.isNew)\n\n  return (\n    <Dialog\n      open={value}\n      onOpenChange={(isOpen) => {\n        if (isOpen) return\n        setFalse()\n      }}\n    >\n      <DialogTrigger asChild>\n        <Button\n          size={\"sm\"}\n          className=\"flex w-full items-center gap-2\"\n          variant={\"secondary\"}\n          onClick={setTrue}\n          aria-label={\n            hasNewModels\n              ? t(\n                  \"ã™ã¹ã¦ã®ãƒ¢ãƒ‡ãƒ«ï¼ˆæ–°ä½œãƒ¢ãƒ‡ãƒ«ã‚ã‚Šï¼‰\",\n                  \"All models (new models available)\",\n                )\n              : t(\"ã™ã¹ã¦ã®ãƒ¢ãƒ‡ãƒ«\", \"All models\")\n          }\n        >\n          {props.label ? props.label : t(\"ã™ã¹ã¦ã®ãƒ¢ãƒ‡ãƒ«\", \"All models\")}\n          {hasNewModels && (\n            <span className=\"rounded-full bg-blue-500 px-2 py-0.5 font-bold text-white text-xs\">\n              {\"New\"}\n            </span>\n          )}\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"md:max-w-(--breakpoint-md) lg:max-w-(--breakpoint-lg) xl:max-w-(--breakpoint-xl)\">\n        <DialogHeader>\n          <DialogTitle>{t(\"ãƒ¢ãƒ‡ãƒ«ã‚’é¸æŠ\", \"Select a model\")}</DialogTitle>\n          <DialogDescription className=\"hidden md:block xl:block\">\n            {t(\n              \"ä½¿ç”¨ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„\",\n              \"Please select the model to use\",\n            )}\n          </DialogDescription>\n        </DialogHeader>\n        <div className=\"items-top flex space-x-2\">\n          <Checkbox\n            onCheckedChange={(value: boolean) => {\n              context.changeUseRecommendedPrompt(value)\n            }}\n            checked={context.config.isUseRecommendedPrompt}\n            id=\"use-recommended-prompt\"\n          />\n          <div className=\"grid gap-1.5 leading-none\">\n            <label\n              htmlFor=\"use-recommended-prompt\"\n              className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n            >\n              {t(\n                \"ãƒ¢ãƒ‡ãƒ«ã®æ¨å¥¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è¨­å®šã™ã‚‹\",\n                \"Set the recommended prompt for the model\",\n              )}\n            </label>\n          </div>\n        </div>\n        <ImageModelsList\n          isInitFavorited={props.isInitFavorited}\n          models={props.models}\n          favoritedModelIds={props.favoritedModelIds}\n          selectedModelId={props.selectedModelId}\n          onSelect={onSelectModel}\n          onChangeFavoritedModel={onChangeRatingModel}\n          onSearchClick={props.onSearchClick}\n        />\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst updateRatingImageGenerationModelMutation = graphql(\n  `mutation UpdateRatingImageGenerationModel($input: UpdateRatingImageGenerationModelInput!) {\n    updateRatingImageGenerationModel(input: $input) {\n      id\n      userId\n      favoritedImageGenerationModelIds\n      preferenceRating\n      featurePromptonRequest\n      isNotifyComment\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/generation-announcement-banner.tsx"},"span":[3348,3361],"sourceCode":"import { useState, useEffect } from \"react\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { X, Info } from \"lucide-react\"\n\nconst emergencyAnnouncementsQuery = graphql(`\n  query emergencyAnnouncements {\n    emergencyAnnouncements {\n      url\n      content\n    }\n  }\n`)\n\n// ãŠçŸ¥ã‚‰ã›å†…å®¹ã‚’ãƒãƒƒã‚·ãƒ¥åŒ–ã™ã‚‹ç°¡æ˜“é–¢æ•°\nconst hashString = (str: string): string => {\n  let hash = 0\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i)\n    hash = (hash << 5) - hash + char\n    hash = hash & hash // 32bitæ•´æ•°ã«å¤‰æ›\n  }\n  return hash.toString()\n}\n\n// é–‰ã˜ãŸãŠçŸ¥ã‚‰ã›ã®ãƒãƒƒã‚·ãƒ¥ã‚’ä¿å­˜/å–å¾—\nconst DISMISSED_ANNOUNCEMENTS_KEY = \"dismissed-announcements-generation\"\n\nconst getDismissedAnnouncements = (): string[] => {\n  if (typeof window === \"undefined\") return []\n  try {\n    const stored = localStorage.getItem(DISMISSED_ANNOUNCEMENTS_KEY)\n    return stored ? JSON.parse(stored) : []\n  } catch {\n    return []\n  }\n}\n\nconst addDismissedAnnouncement = (contentHash: string): void => {\n  if (typeof window === \"undefined\") return\n  try {\n    const dismissed = getDismissedAnnouncements()\n    if (!dismissed.includes(contentHash)) {\n      dismissed.push(contentHash)\n      localStorage.setItem(\n        DISMISSED_ANNOUNCEMENTS_KEY,\n        JSON.stringify(dismissed),\n      )\n    }\n  } catch {\n    // localStorage ãŒä½¿ãˆãªã„å ´åˆã¯ä½•ã‚‚ã—ãªã„\n  }\n}\n\n/**\n * ç”Ÿæˆç”»é¢ç”¨ç·Šæ€¥ãŠçŸ¥ã‚‰ã›ãƒãƒŠãƒ¼\n */\nexport function GenerationAnnouncementBanner () {\n  const [isAnnouncementVisible, setIsAnnouncementVisible] = useState(true)\n\n  const {\n    data: announcementData,\n    loading,\n    error,\n  } = useQuery(emergencyAnnouncementsQuery, {})\n\n  // ãŠçŸ¥ã‚‰ã›ãŒèª­ã¿è¾¼ã¾ã‚ŒãŸã‚‰ã€éå»ã«é–‰ã˜ãŸã‚‚ã®ã‹ãƒã‚§ãƒƒã‚¯\n  useEffect(() => {\n    if (announcementData?.emergencyAnnouncements?.content) {\n      const contentHash = hashString(\n        announcementData.emergencyAnnouncements.content,\n      )\n      const dismissed = getDismissedAnnouncements()\n      if (dismissed.includes(contentHash)) {\n        setIsAnnouncementVisible(false)\n      }\n    }\n  }, [announcementData])\n\n  const navigateToExternal = (url: string) => {\n    window.open(url, \"_blank\", \"noreferrer\")\n  }\n\n  const handleNavigate = (url: string) => {\n    window.location.href = url\n  }\n\n  const handleClose = () => {\n    if (announcementData?.emergencyAnnouncements?.content) {\n      const contentHash = hashString(\n        announcementData.emergencyAnnouncements.content,\n      )\n      addDismissedAnnouncement(contentHash)\n    }\n    setIsAnnouncementVisible(false)\n  }\n\n  // è¡¨ç¤ºæ¡ä»¶ã‚’ãƒã‚§ãƒƒã‚¯\n  if (!isAnnouncementVisible) {\n    return null\n  }\n\n  // å®Ÿéš›ã®ãŠçŸ¥ã‚‰ã›ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã¯è¡¨ç¤ºã—ãªã„ï¼ˆç©ºæ–‡å­—åˆ—ã‚‚ãƒã‚§ãƒƒã‚¯ï¼‰\n  if (\n    !announcementData?.emergencyAnnouncements ||\n    !announcementData.emergencyAnnouncements.content ||\n    announcementData.emergencyAnnouncements.content.trim() === \"\"\n  ) {\n    return null\n  }\n\n  return (\n    <div className=\"border-slate-200 border-b bg-slate-50/50 dark:border-slate-700 dark:bg-slate-800/50\">\n      <div className=\"relative w-full px-4 py-3\">\n        <div className=\"flex items-center gap-3 pr-10\">\n          {/* Close button */}\n          {/** biome-ignore lint/a11y/useButtonType: <explanation> */}\n          <button\n            onClick={handleClose}\n            className=\"-translate-y-1/2 absolute top-1/2 right-4 rounded-lg p-1.5 text-slate-400 transition-colors hover:bg-slate-200 hover:text-slate-600 dark:hover:bg-slate-700 dark:hover:text-slate-300\"\n            aria-label=\"ãŠçŸ¥ã‚‰ã›ã‚’é–‰ã˜ã‚‹\"\n          >\n            <X className=\"h-4 w-4\" />\n          </button>\n\n          {/* Icon */}\n          <div className=\"flex-shrink-0 rounded-full bg-blue-100 p-2 dark:bg-blue-900/30\">\n            <Info className=\"h-4 w-4 text-blue-600 dark:text-blue-400\" />\n          </div>\n\n          {/* Content */}\n          {announcementData.emergencyAnnouncements.url &&\n          announcementData.emergencyAnnouncements.url.length > 0 ? (\n            // biome-ignore lint/a11y/useButtonType: <explanation>\n            <button\n              onClick={() =>\n                announcementData.emergencyAnnouncements.url.startsWith(\"http\")\n                  ? navigateToExternal(\n                      announcementData.emergencyAnnouncements.url,\n                    )\n                  : handleNavigate(announcementData.emergencyAnnouncements.url)\n              }\n              className=\"flex-1 text-left transition-colors hover:text-blue-600 dark:hover:text-blue-400\"\n            >\n              <div className=\"flex items-center gap-2\">\n                <span className=\"font-medium text-slate-700 text-sm dark:text-slate-200\">\n                  {announcementData.emergencyAnnouncements.content}\n                </span>\n                {/** biome-ignore lint/a11y/noSvgWithoutTitle: <explanation> */}\n                <svg\n                  className=\"h-3 w-3 text-slate-400\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 24\"\n                  stroke=\"currentColor\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth={2}\n                    d=\"M9 5l7 7-7 7\"\n                  />\n                </svg>\n              </div>\n            </button>\n          ) : (\n            <div className=\"flex-1\">\n              <span className=\"font-medium text-slate-700 text-sm dark:text-slate-200\">\n                {announcementData.emergencyAnnouncements.content}\n              </span>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/generation-announcement-banner.tsx"},"span":[4154,4167],"sourceCode":"import { useState, useEffect } from \"react\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { X, Info } from \"lucide-react\"\n\nconst emergencyAnnouncementsQuery = graphql(`\n  query emergencyAnnouncements {\n    emergencyAnnouncements {\n      url\n      content\n    }\n  }\n`)\n\n// ãŠçŸ¥ã‚‰ã›å†…å®¹ã‚’ãƒãƒƒã‚·ãƒ¥åŒ–ã™ã‚‹ç°¡æ˜“é–¢æ•°\nconst hashString = (str: string): string => {\n  let hash = 0\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i)\n    hash = (hash << 5) - hash + char\n    hash = hash & hash // 32bitæ•´æ•°ã«å¤‰æ›\n  }\n  return hash.toString()\n}\n\n// é–‰ã˜ãŸãŠçŸ¥ã‚‰ã›ã®ãƒãƒƒã‚·ãƒ¥ã‚’ä¿å­˜/å–å¾—\nconst DISMISSED_ANNOUNCEMENTS_KEY = \"dismissed-announcements-generation\"\n\nconst getDismissedAnnouncements = (): string[] => {\n  if (typeof window === \"undefined\") return []\n  try {\n    const stored = localStorage.getItem(DISMISSED_ANNOUNCEMENTS_KEY)\n    return stored ? JSON.parse(stored) : []\n  } catch {\n    return []\n  }\n}\n\nconst addDismissedAnnouncement = (contentHash: string): void => {\n  if (typeof window === \"undefined\") return\n  try {\n    const dismissed = getDismissedAnnouncements()\n    if (!dismissed.includes(contentHash)) {\n      dismissed.push(contentHash)\n      localStorage.setItem(\n        DISMISSED_ANNOUNCEMENTS_KEY,\n        JSON.stringify(dismissed),\n      )\n    }\n  } catch {\n    // localStorage ãŒä½¿ãˆãªã„å ´åˆã¯ä½•ã‚‚ã—ãªã„\n  }\n}\n\n/**\n * ç”Ÿæˆç”»é¢ç”¨ç·Šæ€¥ãŠçŸ¥ã‚‰ã›ãƒãƒŠãƒ¼\n */\nexport function GenerationAnnouncementBanner () {\n  const [isAnnouncementVisible, setIsAnnouncementVisible] = useState(true)\n\n  const {\n    data: announcementData,\n    loading,\n    error,\n  } = useQuery(emergencyAnnouncementsQuery, {})\n\n  // ãŠçŸ¥ã‚‰ã›ãŒèª­ã¿è¾¼ã¾ã‚ŒãŸã‚‰ã€éå»ã«é–‰ã˜ãŸã‚‚ã®ã‹ãƒã‚§ãƒƒã‚¯\n  useEffect(() => {\n    if (announcementData?.emergencyAnnouncements?.content) {\n      const contentHash = hashString(\n        announcementData.emergencyAnnouncements.content,\n      )\n      const dismissed = getDismissedAnnouncements()\n      if (dismissed.includes(contentHash)) {\n        setIsAnnouncementVisible(false)\n      }\n    }\n  }, [announcementData])\n\n  const navigateToExternal = (url: string) => {\n    window.open(url, \"_blank\", \"noreferrer\")\n  }\n\n  const handleNavigate = (url: string) => {\n    window.location.href = url\n  }\n\n  const handleClose = () => {\n    if (announcementData?.emergencyAnnouncements?.content) {\n      const contentHash = hashString(\n        announcementData.emergencyAnnouncements.content,\n      )\n      addDismissedAnnouncement(contentHash)\n    }\n    setIsAnnouncementVisible(false)\n  }\n\n  // è¡¨ç¤ºæ¡ä»¶ã‚’ãƒã‚§ãƒƒã‚¯\n  if (!isAnnouncementVisible) {\n    return null\n  }\n\n  // å®Ÿéš›ã®ãŠçŸ¥ã‚‰ã›ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã¯è¡¨ç¤ºã—ãªã„ï¼ˆç©ºæ–‡å­—åˆ—ã‚‚ãƒã‚§ãƒƒã‚¯ï¼‰\n  if (\n    !announcementData?.emergencyAnnouncements ||\n    !announcementData.emergencyAnnouncements.content ||\n    announcementData.emergencyAnnouncements.content.trim() === \"\"\n  ) {\n    return null\n  }\n\n  return (\n    <div className=\"border-slate-200 border-b bg-slate-50/50 dark:border-slate-700 dark:bg-slate-800/50\">\n      <div className=\"relative w-full px-4 py-3\">\n        <div className=\"flex items-center gap-3 pr-10\">\n          {/* Close button */}\n          {/** biome-ignore lint/a11y/useButtonType: <explanation> */}\n          <button\n            onClick={handleClose}\n            className=\"-translate-y-1/2 absolute top-1/2 right-4 rounded-lg p-1.5 text-slate-400 transition-colors hover:bg-slate-200 hover:text-slate-600 dark:hover:bg-slate-700 dark:hover:text-slate-300\"\n            aria-label=\"ãŠçŸ¥ã‚‰ã›ã‚’é–‰ã˜ã‚‹\"\n          >\n            <X className=\"h-4 w-4\" />\n          </button>\n\n          {/* Icon */}\n          <div className=\"flex-shrink-0 rounded-full bg-blue-100 p-2 dark:bg-blue-900/30\">\n            <Info className=\"h-4 w-4 text-blue-600 dark:text-blue-400\" />\n          </div>\n\n          {/* Content */}\n          {announcementData.emergencyAnnouncements.url &&\n          announcementData.emergencyAnnouncements.url.length > 0 ? (\n            // biome-ignore lint/a11y/useButtonType: <explanation>\n            <button\n              onClick={() =>\n                announcementData.emergencyAnnouncements.url.startsWith(\"http\")\n                  ? navigateToExternal(\n                      announcementData.emergencyAnnouncements.url,\n                    )\n                  : handleNavigate(announcementData.emergencyAnnouncements.url)\n              }\n              className=\"flex-1 text-left transition-colors hover:text-blue-600 dark:hover:text-blue-400\"\n            >\n              <div className=\"flex items-center gap-2\">\n                <span className=\"font-medium text-slate-700 text-sm dark:text-slate-200\">\n                  {announcementData.emergencyAnnouncements.content}\n                </span>\n                {/** biome-ignore lint/a11y/noSvgWithoutTitle: <explanation> */}\n                <svg\n                  className=\"h-3 w-3 text-slate-400\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 24\"\n                  stroke=\"currentColor\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth={2}\n                    d=\"M9 5l7 7-7 7\"\n                  />\n                </svg>\n              </div>\n            </button>\n          ) : (\n            <div className=\"flex-1\">\n              <span className=\"font-medium text-slate-700 text-sm dark:text-slate-200\">\n                {announcementData.emergencyAnnouncements.content}\n              </span>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/generation-announcement-banner.tsx"},"span":[4945,4958],"sourceCode":"import { useState, useEffect } from \"react\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { X, Info } from \"lucide-react\"\n\nconst emergencyAnnouncementsQuery = graphql(`\n  query emergencyAnnouncements {\n    emergencyAnnouncements {\n      url\n      content\n    }\n  }\n`)\n\n// ãŠçŸ¥ã‚‰ã›å†…å®¹ã‚’ãƒãƒƒã‚·ãƒ¥åŒ–ã™ã‚‹ç°¡æ˜“é–¢æ•°\nconst hashString = (str: string): string => {\n  let hash = 0\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i)\n    hash = (hash << 5) - hash + char\n    hash = hash & hash // 32bitæ•´æ•°ã«å¤‰æ›\n  }\n  return hash.toString()\n}\n\n// é–‰ã˜ãŸãŠçŸ¥ã‚‰ã›ã®ãƒãƒƒã‚·ãƒ¥ã‚’ä¿å­˜/å–å¾—\nconst DISMISSED_ANNOUNCEMENTS_KEY = \"dismissed-announcements-generation\"\n\nconst getDismissedAnnouncements = (): string[] => {\n  if (typeof window === \"undefined\") return []\n  try {\n    const stored = localStorage.getItem(DISMISSED_ANNOUNCEMENTS_KEY)\n    return stored ? JSON.parse(stored) : []\n  } catch {\n    return []\n  }\n}\n\nconst addDismissedAnnouncement = (contentHash: string): void => {\n  if (typeof window === \"undefined\") return\n  try {\n    const dismissed = getDismissedAnnouncements()\n    if (!dismissed.includes(contentHash)) {\n      dismissed.push(contentHash)\n      localStorage.setItem(\n        DISMISSED_ANNOUNCEMENTS_KEY,\n        JSON.stringify(dismissed),\n      )\n    }\n  } catch {\n    // localStorage ãŒä½¿ãˆãªã„å ´åˆã¯ä½•ã‚‚ã—ãªã„\n  }\n}\n\n/**\n * ç”Ÿæˆç”»é¢ç”¨ç·Šæ€¥ãŠçŸ¥ã‚‰ã›ãƒãƒŠãƒ¼\n */\nexport function GenerationAnnouncementBanner () {\n  const [isAnnouncementVisible, setIsAnnouncementVisible] = useState(true)\n\n  const {\n    data: announcementData,\n    loading,\n    error,\n  } = useQuery(emergencyAnnouncementsQuery, {})\n\n  // ãŠçŸ¥ã‚‰ã›ãŒèª­ã¿è¾¼ã¾ã‚ŒãŸã‚‰ã€éå»ã«é–‰ã˜ãŸã‚‚ã®ã‹ãƒã‚§ãƒƒã‚¯\n  useEffect(() => {\n    if (announcementData?.emergencyAnnouncements?.content) {\n      const contentHash = hashString(\n        announcementData.emergencyAnnouncements.content,\n      )\n      const dismissed = getDismissedAnnouncements()\n      if (dismissed.includes(contentHash)) {\n        setIsAnnouncementVisible(false)\n      }\n    }\n  }, [announcementData])\n\n  const navigateToExternal = (url: string) => {\n    window.open(url, \"_blank\", \"noreferrer\")\n  }\n\n  const handleNavigate = (url: string) => {\n    window.location.href = url\n  }\n\n  const handleClose = () => {\n    if (announcementData?.emergencyAnnouncements?.content) {\n      const contentHash = hashString(\n        announcementData.emergencyAnnouncements.content,\n      )\n      addDismissedAnnouncement(contentHash)\n    }\n    setIsAnnouncementVisible(false)\n  }\n\n  // è¡¨ç¤ºæ¡ä»¶ã‚’ãƒã‚§ãƒƒã‚¯\n  if (!isAnnouncementVisible) {\n    return null\n  }\n\n  // å®Ÿéš›ã®ãŠçŸ¥ã‚‰ã›ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã¯è¡¨ç¤ºã—ãªã„ï¼ˆç©ºæ–‡å­—åˆ—ã‚‚ãƒã‚§ãƒƒã‚¯ï¼‰\n  if (\n    !announcementData?.emergencyAnnouncements ||\n    !announcementData.emergencyAnnouncements.content ||\n    announcementData.emergencyAnnouncements.content.trim() === \"\"\n  ) {\n    return null\n  }\n\n  return (\n    <div className=\"border-slate-200 border-b bg-slate-50/50 dark:border-slate-700 dark:bg-slate-800/50\">\n      <div className=\"relative w-full px-4 py-3\">\n        <div className=\"flex items-center gap-3 pr-10\">\n          {/* Close button */}\n          {/** biome-ignore lint/a11y/useButtonType: <explanation> */}\n          <button\n            onClick={handleClose}\n            className=\"-translate-y-1/2 absolute top-1/2 right-4 rounded-lg p-1.5 text-slate-400 transition-colors hover:bg-slate-200 hover:text-slate-600 dark:hover:bg-slate-700 dark:hover:text-slate-300\"\n            aria-label=\"ãŠçŸ¥ã‚‰ã›ã‚’é–‰ã˜ã‚‹\"\n          >\n            <X className=\"h-4 w-4\" />\n          </button>\n\n          {/* Icon */}\n          <div className=\"flex-shrink-0 rounded-full bg-blue-100 p-2 dark:bg-blue-900/30\">\n            <Info className=\"h-4 w-4 text-blue-600 dark:text-blue-400\" />\n          </div>\n\n          {/* Content */}\n          {announcementData.emergencyAnnouncements.url &&\n          announcementData.emergencyAnnouncements.url.length > 0 ? (\n            // biome-ignore lint/a11y/useButtonType: <explanation>\n            <button\n              onClick={() =>\n                announcementData.emergencyAnnouncements.url.startsWith(\"http\")\n                  ? navigateToExternal(\n                      announcementData.emergencyAnnouncements.url,\n                    )\n                  : handleNavigate(announcementData.emergencyAnnouncements.url)\n              }\n              className=\"flex-1 text-left transition-colors hover:text-blue-600 dark:hover:text-blue-400\"\n            >\n              <div className=\"flex items-center gap-2\">\n                <span className=\"font-medium text-slate-700 text-sm dark:text-slate-200\">\n                  {announcementData.emergencyAnnouncements.content}\n                </span>\n                {/** biome-ignore lint/a11y/noSvgWithoutTitle: <explanation> */}\n                <svg\n                  className=\"h-3 w-3 text-slate-400\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 24\"\n                  stroke=\"currentColor\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth={2}\n                    d=\"M9 5l7 7-7 7\"\n                  />\n                </svg>\n              </div>\n            </button>\n          ) : (\n            <div className=\"flex-1\">\n              <span className=\"font-medium text-slate-700 text-sm dark:text-slate-200\">\n                {announcementData.emergencyAnnouncements.content}\n              </span>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable loading is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"loading"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/generation-announcement-banner.tsx"},"span":[1668,1675],"sourceCode":"import { useState, useEffect } from \"react\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { X, Info } from \"lucide-react\"\n\nconst emergencyAnnouncementsQuery = graphql(`\n  query emergencyAnnouncements {\n    emergencyAnnouncements {\n      url\n      content\n    }\n  }\n`)\n\n// ãŠçŸ¥ã‚‰ã›å†…å®¹ã‚’ãƒãƒƒã‚·ãƒ¥åŒ–ã™ã‚‹ç°¡æ˜“é–¢æ•°\nconst hashString = (str: string): string => {\n  let hash = 0\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i)\n    hash = (hash << 5) - hash + char\n    hash = hash & hash // 32bitæ•´æ•°ã«å¤‰æ›\n  }\n  return hash.toString()\n}\n\n// é–‰ã˜ãŸãŠçŸ¥ã‚‰ã›ã®ãƒãƒƒã‚·ãƒ¥ã‚’ä¿å­˜/å–å¾—\nconst DISMISSED_ANNOUNCEMENTS_KEY = \"dismissed-announcements-generation\"\n\nconst getDismissedAnnouncements = (): string[] => {\n  if (typeof window === \"undefined\") return []\n  try {\n    const stored = localStorage.getItem(DISMISSED_ANNOUNCEMENTS_KEY)\n    return stored ? JSON.parse(stored) : []\n  } catch {\n    return []\n  }\n}\n\nconst addDismissedAnnouncement = (contentHash: string): void => {\n  if (typeof window === \"undefined\") return\n  try {\n    const dismissed = getDismissedAnnouncements()\n    if (!dismissed.includes(contentHash)) {\n      dismissed.push(contentHash)\n      localStorage.setItem(\n        DISMISSED_ANNOUNCEMENTS_KEY,\n        JSON.stringify(dismissed),\n      )\n    }\n  } catch {\n    // localStorage ãŒä½¿ãˆãªã„å ´åˆã¯ä½•ã‚‚ã—ãªã„\n  }\n}\n\n/**\n * ç”Ÿæˆç”»é¢ç”¨ç·Šæ€¥ãŠçŸ¥ã‚‰ã›ãƒãƒŠãƒ¼\n */\nexport function GenerationAnnouncementBanner () {\n  const [isAnnouncementVisible, setIsAnnouncementVisible] = useState(true)\n\n  const {\n    data: announcementData,\n    loading,\n    error,\n  } = useQuery(emergencyAnnouncementsQuery, {})\n\n  // ãŠçŸ¥ã‚‰ã›ãŒèª­ã¿è¾¼ã¾ã‚ŒãŸã‚‰ã€éå»ã«é–‰ã˜ãŸã‚‚ã®ã‹ãƒã‚§ãƒƒã‚¯\n  useEffect(() => {\n    if (announcementData?.emergencyAnnouncements?.content) {\n      const contentHash = hashString(\n        announcementData.emergencyAnnouncements.content,\n      )\n      const dismissed = getDismissedAnnouncements()\n      if (dismissed.includes(contentHash)) {\n        setIsAnnouncementVisible(false)\n      }\n    }\n  }, [announcementData])\n\n  const navigateToExternal = (url: string) => {\n    window.open(url, \"_blank\", \"noreferrer\")\n  }\n\n  const handleNavigate = (url: string) => {\n    window.location.href = url\n  }\n\n  const handleClose = () => {\n    if (announcementData?.emergencyAnnouncements?.content) {\n      const contentHash = hashString(\n        announcementData.emergencyAnnouncements.content,\n      )\n      addDismissedAnnouncement(contentHash)\n    }\n    setIsAnnouncementVisible(false)\n  }\n\n  // è¡¨ç¤ºæ¡ä»¶ã‚’ãƒã‚§ãƒƒã‚¯\n  if (!isAnnouncementVisible) {\n    return null\n  }\n\n  // å®Ÿéš›ã®ãŠçŸ¥ã‚‰ã›ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã¯è¡¨ç¤ºã—ãªã„ï¼ˆç©ºæ–‡å­—åˆ—ã‚‚ãƒã‚§ãƒƒã‚¯ï¼‰\n  if (\n    !announcementData?.emergencyAnnouncements ||\n    !announcementData.emergencyAnnouncements.content ||\n    announcementData.emergencyAnnouncements.content.trim() === \"\"\n  ) {\n    return null\n  }\n\n  return (\n    <div className=\"border-slate-200 border-b bg-slate-50/50 dark:border-slate-700 dark:bg-slate-800/50\">\n      <div className=\"relative w-full px-4 py-3\">\n        <div className=\"flex items-center gap-3 pr-10\">\n          {/* Close button */}\n          {/** biome-ignore lint/a11y/useButtonType: <explanation> */}\n          <button\n            onClick={handleClose}\n            className=\"-translate-y-1/2 absolute top-1/2 right-4 rounded-lg p-1.5 text-slate-400 transition-colors hover:bg-slate-200 hover:text-slate-600 dark:hover:bg-slate-700 dark:hover:text-slate-300\"\n            aria-label=\"ãŠçŸ¥ã‚‰ã›ã‚’é–‰ã˜ã‚‹\"\n          >\n            <X className=\"h-4 w-4\" />\n          </button>\n\n          {/* Icon */}\n          <div className=\"flex-shrink-0 rounded-full bg-blue-100 p-2 dark:bg-blue-900/30\">\n            <Info className=\"h-4 w-4 text-blue-600 dark:text-blue-400\" />\n          </div>\n\n          {/* Content */}\n          {announcementData.emergencyAnnouncements.url &&\n          announcementData.emergencyAnnouncements.url.length > 0 ? (\n            // biome-ignore lint/a11y/useButtonType: <explanation>\n            <button\n              onClick={() =>\n                announcementData.emergencyAnnouncements.url.startsWith(\"http\")\n                  ? navigateToExternal(\n                      announcementData.emergencyAnnouncements.url,\n                    )\n                  : handleNavigate(announcementData.emergencyAnnouncements.url)\n              }\n              className=\"flex-1 text-left transition-colors hover:text-blue-600 dark:hover:text-blue-400\"\n            >\n              <div className=\"flex items-center gap-2\">\n                <span className=\"font-medium text-slate-700 text-sm dark:text-slate-200\">\n                  {announcementData.emergencyAnnouncements.content}\n                </span>\n                {/** biome-ignore lint/a11y/noSvgWithoutTitle: <explanation> */}\n                <svg\n                  className=\"h-3 w-3 text-slate-400\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 24\"\n                  stroke=\"currentColor\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth={2}\n                    d=\"M9 5l7 7-7 7\"\n                  />\n                </svg>\n              </div>\n            </button>\n          ) : (\n            <div className=\"flex-1\">\n              <span className=\"font-medium text-slate-700 text-sm dark:text-slate-200\">\n                {announcementData.emergencyAnnouncements.content}\n              </span>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable error is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"error"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/generation-announcement-banner.tsx"},"span":[1681,1686],"sourceCode":"import { useState, useEffect } from \"react\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { X, Info } from \"lucide-react\"\n\nconst emergencyAnnouncementsQuery = graphql(`\n  query emergencyAnnouncements {\n    emergencyAnnouncements {\n      url\n      content\n    }\n  }\n`)\n\n// ãŠçŸ¥ã‚‰ã›å†…å®¹ã‚’ãƒãƒƒã‚·ãƒ¥åŒ–ã™ã‚‹ç°¡æ˜“é–¢æ•°\nconst hashString = (str: string): string => {\n  let hash = 0\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i)\n    hash = (hash << 5) - hash + char\n    hash = hash & hash // 32bitæ•´æ•°ã«å¤‰æ›\n  }\n  return hash.toString()\n}\n\n// é–‰ã˜ãŸãŠçŸ¥ã‚‰ã›ã®ãƒãƒƒã‚·ãƒ¥ã‚’ä¿å­˜/å–å¾—\nconst DISMISSED_ANNOUNCEMENTS_KEY = \"dismissed-announcements-generation\"\n\nconst getDismissedAnnouncements = (): string[] => {\n  if (typeof window === \"undefined\") return []\n  try {\n    const stored = localStorage.getItem(DISMISSED_ANNOUNCEMENTS_KEY)\n    return stored ? JSON.parse(stored) : []\n  } catch {\n    return []\n  }\n}\n\nconst addDismissedAnnouncement = (contentHash: string): void => {\n  if (typeof window === \"undefined\") return\n  try {\n    const dismissed = getDismissedAnnouncements()\n    if (!dismissed.includes(contentHash)) {\n      dismissed.push(contentHash)\n      localStorage.setItem(\n        DISMISSED_ANNOUNCEMENTS_KEY,\n        JSON.stringify(dismissed),\n      )\n    }\n  } catch {\n    // localStorage ãŒä½¿ãˆãªã„å ´åˆã¯ä½•ã‚‚ã—ãªã„\n  }\n}\n\n/**\n * ç”Ÿæˆç”»é¢ç”¨ç·Šæ€¥ãŠçŸ¥ã‚‰ã›ãƒãƒŠãƒ¼\n */\nexport function GenerationAnnouncementBanner () {\n  const [isAnnouncementVisible, setIsAnnouncementVisible] = useState(true)\n\n  const {\n    data: announcementData,\n    loading,\n    error,\n  } = useQuery(emergencyAnnouncementsQuery, {})\n\n  // ãŠçŸ¥ã‚‰ã›ãŒèª­ã¿è¾¼ã¾ã‚ŒãŸã‚‰ã€éå»ã«é–‰ã˜ãŸã‚‚ã®ã‹ãƒã‚§ãƒƒã‚¯\n  useEffect(() => {\n    if (announcementData?.emergencyAnnouncements?.content) {\n      const contentHash = hashString(\n        announcementData.emergencyAnnouncements.content,\n      )\n      const dismissed = getDismissedAnnouncements()\n      if (dismissed.includes(contentHash)) {\n        setIsAnnouncementVisible(false)\n      }\n    }\n  }, [announcementData])\n\n  const navigateToExternal = (url: string) => {\n    window.open(url, \"_blank\", \"noreferrer\")\n  }\n\n  const handleNavigate = (url: string) => {\n    window.location.href = url\n  }\n\n  const handleClose = () => {\n    if (announcementData?.emergencyAnnouncements?.content) {\n      const contentHash = hashString(\n        announcementData.emergencyAnnouncements.content,\n      )\n      addDismissedAnnouncement(contentHash)\n    }\n    setIsAnnouncementVisible(false)\n  }\n\n  // è¡¨ç¤ºæ¡ä»¶ã‚’ãƒã‚§ãƒƒã‚¯\n  if (!isAnnouncementVisible) {\n    return null\n  }\n\n  // å®Ÿéš›ã®ãŠçŸ¥ã‚‰ã›ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã¯è¡¨ç¤ºã—ãªã„ï¼ˆç©ºæ–‡å­—åˆ—ã‚‚ãƒã‚§ãƒƒã‚¯ï¼‰\n  if (\n    !announcementData?.emergencyAnnouncements ||\n    !announcementData.emergencyAnnouncements.content ||\n    announcementData.emergencyAnnouncements.content.trim() === \"\"\n  ) {\n    return null\n  }\n\n  return (\n    <div className=\"border-slate-200 border-b bg-slate-50/50 dark:border-slate-700 dark:bg-slate-800/50\">\n      <div className=\"relative w-full px-4 py-3\">\n        <div className=\"flex items-center gap-3 pr-10\">\n          {/* Close button */}\n          {/** biome-ignore lint/a11y/useButtonType: <explanation> */}\n          <button\n            onClick={handleClose}\n            className=\"-translate-y-1/2 absolute top-1/2 right-4 rounded-lg p-1.5 text-slate-400 transition-colors hover:bg-slate-200 hover:text-slate-600 dark:hover:bg-slate-700 dark:hover:text-slate-300\"\n            aria-label=\"ãŠçŸ¥ã‚‰ã›ã‚’é–‰ã˜ã‚‹\"\n          >\n            <X className=\"h-4 w-4\" />\n          </button>\n\n          {/* Icon */}\n          <div className=\"flex-shrink-0 rounded-full bg-blue-100 p-2 dark:bg-blue-900/30\">\n            <Info className=\"h-4 w-4 text-blue-600 dark:text-blue-400\" />\n          </div>\n\n          {/* Content */}\n          {announcementData.emergencyAnnouncements.url &&\n          announcementData.emergencyAnnouncements.url.length > 0 ? (\n            // biome-ignore lint/a11y/useButtonType: <explanation>\n            <button\n              onClick={() =>\n                announcementData.emergencyAnnouncements.url.startsWith(\"http\")\n                  ? navigateToExternal(\n                      announcementData.emergencyAnnouncements.url,\n                    )\n                  : handleNavigate(announcementData.emergencyAnnouncements.url)\n              }\n              className=\"flex-1 text-left transition-colors hover:text-blue-600 dark:hover:text-blue-400\"\n            >\n              <div className=\"flex items-center gap-2\">\n                <span className=\"font-medium text-slate-700 text-sm dark:text-slate-200\">\n                  {announcementData.emergencyAnnouncements.content}\n                </span>\n                {/** biome-ignore lint/a11y/noSvgWithoutTitle: <explanation> */}\n                <svg\n                  className=\"h-3 w-3 text-slate-400\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 24\"\n                  stroke=\"currentColor\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth={2}\n                    d=\"M9 5l7 7-7 7\"\n                  />\n                </svg>\n              </div>\n            </button>\n          ) : (\n            <div className=\"flex-1\">\n              <span className=\"font-medium text-slate-700 text-sm dark:text-slate-200\">\n                {announcementData.emergencyAnnouncements.content}\n              </span>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable isCancelingReservedTask is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"isCancelingReservedTask"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/generation-task-editable-card.tsx"},"span":[2479,2502],"sourceCode":"import { SelectableCardButton } from \"~/components/selectable-card-button\"\nimport { Skeleton } from \"~/components/ui/skeleton\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { useGenerationQuery } from \"~/routes/($lang).generation._index/hooks/use-generation-query\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { GenerationConfigContext } from \"~/routes/($lang).generation._index/contexts/generation-config-context\"\nimport { ReservedGenerationCard } from \"~/routes/($lang).generation._index/components/reserved-generation-card\"\nimport { InProgressGenerationCard } from \"~/routes/($lang).generation._index/components/in-progress-generation-card\"\nimport { GenerationTaskZoomUpButton } from \"~/routes/($lang).generation._index/components/generation-task-zoom-up-button\"\nimport { GenerationTaskRatingButton } from \"~/routes/($lang).generation._index/components/generation-task-rating-button\"\nimport { GenerationTaskDeleteButton } from \"~/routes/($lang).generation._index/components/generation-task-delete-button\"\nimport {\n  GenerationResultProtectButtonFragment,\n  GenerationResultProtectButtonTaskFragment,\n} from \"~/routes/($lang).generation._index/components/generation-task-protected-button\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport { normalizeGenerativeFileUrl } from \"~/utils/normalize-generative-file-url\"\nimport { cn } from \"~/lib/utils\"\n\ntype Props = {\n  taskId: string\n  taskNanoid: string | null\n  isSelected?: boolean\n  estimatedSeconds?: number\n  rating: number\n  isProtected: boolean\n  optionButtonSize: number\n  isSelectDisabled: boolean\n  task:\n    | FragmentOf<typeof EditableGenerationResultCardFragment>\n    | FragmentOf<typeof EditableGenerationResultCardTaskFragment>\n  isPreviewByHover?: boolean\n  userToken: string\n  onClick?(): void\n  onCancel?(): void\n  onDelete?(taskId: string): void\n}\n\n/**\n * ç”»åƒç”Ÿæˆã®ç·¨é›†å¯èƒ½ãªå±¥æ­´\n */\nexport function GenerationTaskEditableCard (props: Props) {\n  const context = useGenerationContext()\n\n  const data = useGenerationQuery()\n\n  const [isHovered, setIsHovered] = useState(false)\n\n  const [rating, setRating] = useState(props.rating)\n\n  const [_isProtected, _setIsProtected] = useState(props.isProtected)\n\n  const [cancelTask, { loading: isCanceling }] = useMutation(\n    cancelImageGenerationTaskMutation,\n  )\n\n  const [cancelReservedTask, { loading: isCancelingReservedTask }] =\n    useMutation(cancelImageGenerationReservedTaskMutation)\n\n  const [deleteTask, { loading: isDeletedLoading }] = useMutation(\n    deleteImageGenerationResultMutation,\n  )\n\n  /**\n   * ç”Ÿæˆã‚¿ã‚¹ã‚¯ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹\n   * @param taskNanoid\n   * @returns\n   */\n  const onCancelTask = async (taskNanoid: string | null) => {\n    if (taskNanoid === null) return\n    try {\n      await cancelTask({ variables: { input: { nanoid: taskNanoid } } })\n      if (props.onCancel) {\n        props.onCancel()\n      }\n      toast(\"ã‚¿ã‚¹ã‚¯ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã—ãŸ\")\n    } catch (error) {\n      if (error instanceof Error) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const { send } = GenerationConfigContext.useActorRef()\n\n  /**\n   * ç”Ÿæˆã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã™ã‚‹\n   */\n  const onDeleteTask = async () => {\n    if (props.taskNanoid === null) {\n      toast(\"å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\")\n      return\n    }\n\n    try {\n      await deleteTask({\n        variables: {\n          input: {\n            nanoid: props.taskNanoid,\n          },\n        },\n      })\n      toast(\"å‰Šé™¤ã—ã¾ã—ãŸã€‚\")\n      if (props.onDelete) {\n        props.onDelete(props.taskNanoid)\n      }\n    } catch (_e) {\n      toast(\"å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\")\n    }\n  }\n\n  /**\n   * äºˆç´„ç”Ÿæˆã‚¿ã‚¹ã‚¯ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹\n   * @param taskNanoid\n   * @returns\n   */\n  const onCancelReservedTask = async (taskNanoid: string | null) => {\n    if (taskNanoid === null) return\n    try {\n      await cancelReservedTask({ variables: { input: { nanoid: taskNanoid } } })\n      if (props.onCancel) {\n        props.onCancel()\n      }\n      toast(\"äºˆç´„ã‚¿ã‚¹ã‚¯ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã—ãŸ\")\n    } catch (error) {\n      if (error instanceof Error) {\n        toast(error.message)\n      }\n    }\n  }\n\n  /**\n   * å±¥æ­´ç”»åƒä¸Šã«è¡¨ç¤ºã•ã‚Œã‚‹ãƒœã‚¿ãƒ³ã®ã‚µã‚¤ã‚º\n   * @param size ã‚µã‚¤ã‚º\n   * @returns\n   */\n  const optionButtonSize = (size: number) => {\n    if (size < 3) {\n      return 1\n    }\n    if (size < 5) {\n      return 2\n    }\n    return 3\n  }\n\n  if (props.task.status === \"RESERVED\") {\n    return (\n      <ReservedGenerationCard\n        onClick={props.onClick}\n        onCancel={() => onCancelReservedTask(props.task.nanoid)}\n        isCanceling={isCanceling}\n        taskId={props.taskId}\n        isPreviewByHover={props.isPreviewByHover}\n        setIsHovered={setIsHovered}\n      />\n    )\n  }\n\n  if (!props.task.imageUrl) {\n    return (\n      <InProgressGenerationCard\n        onCancel={() => onCancelTask(props.taskNanoid)}\n        isCanceling={isCanceling}\n        inProgressNormalCount={\n          data.engineStatus?.normalPredictionGenerationWait ?? 0\n        }\n        initImageGenerationWaitCount={\n          data.userStatus?.imageGenerationWaitCount ?? 0\n        }\n        imageGenerationWaitCount={\n          data.userStatus?.imageGenerationWaitCount ?? 0\n        }\n      />\n    )\n  }\n\n  const originalImageUrl = props.task.imageUrl\n  const originalThumbnailUrl = props.task.thumbnailUrl ?? \"\"\n\n  const normalizedImageUrl = normalizeGenerativeFileUrl(originalImageUrl)\n  const normalizedThumbnailUrl = originalThumbnailUrl\n    ? normalizeGenerativeFileUrl(originalThumbnailUrl)\n    : originalThumbnailUrl\n\n  return (\n    <div\n      className=\"relative grid h-full overflow-hidden rounded bg-card p-0\"\n      onMouseEnter={() => {\n        if (props.isPreviewByHover) {\n          context.updatePreviewTaskId(props.task.id)\n          send({ type: \"OPEN_HISTORY_PREVIEW\" })\n        }\n        setIsHovered(true)\n      }}\n      onMouseLeave={() => {\n        context.updatePreviewTaskId(null)\n        send({ type: \"CLOSE\" })\n        setIsHovered(false)\n      }}\n    >\n      <SelectableCardButton\n        onClick={props.onClick}\n        isSelected={props.isSelected}\n        isDisabled={props.isSelectDisabled}\n      >\n        {props.task.imageUrl !== \"\" &&\n        props.task.thumbnailUrl !== \"\" &&\n        props.task.thumbnailUrl !== null ? (\n          <img\n            className={cn(`generation-image-${props.taskNanoid}`, \"m-auto\")}\n            src={\n              context.config.taskListThumbnailType === \"light\"\n                ? normalizedThumbnailUrl\n                : normalizedImageUrl\n            }\n            data-original={normalizedImageUrl}\n            data-original-raw={originalImageUrl}\n            data-generative-raw={\n              context.config.taskListThumbnailType === \"light\"\n                ? originalThumbnailUrl\n                : originalImageUrl\n            }\n            onError={(event) => {\n              const img = event.currentTarget\n              const raw = img.dataset.generativeRaw\n              if (!raw) return\n              if (img.dataset.generativeFallback === \"true\") {\n                return\n              }\n              img.dataset.generativeFallback = \"true\"\n              img.src = raw\n\n              // If we fell back for display, also prefer raw for download.\n              const downloadRaw = img.dataset.originalRaw\n              if (downloadRaw) {\n                img.dataset.original = downloadRaw\n              }\n            }}\n            alt={\"-\"}\n          />\n        ) : (\n          <Skeleton className=\"h-[120px] w-[240px] rounded-xl\" />\n        )}\n      </SelectableCardButton>\n      {/* æ‹¡å¤§ãƒœã‚¿ãƒ³ */}\n      {isHovered && props.task.imageUrl && props.task.thumbnailUrl && (\n        <GenerationTaskZoomUpButton\n          taskId={props.taskId}\n          token={props.userToken}\n          size={optionButtonSize(props.optionButtonSize)}\n          setIsHovered={setIsHovered}\n          imageUrl={originalImageUrl}\n          thumbnailUrl={originalThumbnailUrl}\n        />\n      )}\n      {/* ãŠæ°—ã«å…¥ã‚Šãƒœã‚¿ãƒ³ */}\n      {(isHovered || rating !== 0) && props.taskNanoid && (\n        <GenerationTaskRatingButton\n          nowRating={rating}\n          taskNanoid={props.taskNanoid}\n          size={optionButtonSize(props.optionButtonSize)}\n          onRatingChange={(newRating) => {\n            setRating(newRating)\n          }}\n        />\n      )}\n      {/* å‰Šé™¤ãƒœã‚¿ãƒ³ */}\n      {isHovered && props.isSelectDisabled && (\n        <GenerationTaskDeleteButton\n          onDelete={onDeleteTask}\n          isDeletedLoading={isDeletedLoading}\n        />\n      )}\n      {/* ä¿è­·ãƒœã‚¿ãƒ³ */}\n      {/* {(isHovered || isProtected) && props.taskNanoid && (\n        <GenerationTaskProtectedButton\n          isProtected={isProtected}\n          taskNanoid={props.taskNanoid}\n          size={optionButtonSize(props.optionButtonSize)}\n          onProtectedChange={(isProtected) => {\n            setIsProtected(isProtected)\n          }}\n        />\n      )} */}\n    </div>\n  )\n}\n\nexport const EditableGenerationResultCardFragment = graphql(\n  `fragment EditableGenerationResultCard on ImageGenerationResultNode @_unmask {\n    id\n    nanoid\n    status\n    imageUrl\n    thumbnailUrl\n    estimatedSeconds\n    rating\n    ...GenerationResultProtectButton\n  }`,\n  [GenerationResultProtectButtonFragment],\n)\n\nexport const EditableGenerationResultCardTaskFragment = graphql(\n  `fragment EditableGenerationResultCardTask on ImageGenerationTaskNode @_unmask {\n    id\n    nanoid\n    status\n    imageUrl\n    thumbnailUrl\n    estimatedSeconds\n    rating\n    ...GenerationResultProtectButtonTask\n  }`,\n  [GenerationResultProtectButtonTaskFragment],\n)\n\nconst cancelImageGenerationReservedTaskMutation = graphql(\n  `mutation CancelImageGenerationReservedTask($input: CancelImageGenerationReservedTaskInput!) {\n    cancelImageGenerationReservedTask(input: $input) {\n      ...EditableGenerationResultCardTask\n    }\n  }`,\n  [EditableGenerationResultCardTaskFragment],\n)\n\nconst cancelImageGenerationTaskMutation = graphql(\n  `mutation CancelImageGenerationTask($input: CancelImageGenerationTaskInput!) {\n    cancelImageGenerationTask(input: $input) {\n      ...EditableGenerationResultCardTask\n    }\n  }`,\n  [EditableGenerationResultCardTaskFragment],\n)\n\nconst deleteImageGenerationResultMutation = graphql(\n  `mutation deleteImageGenerationResult($input: DeleteImageGenerationResultInput!) {\n    deleteImageGenerationResult(input: $input) {\n      ...EditableGenerationResultCard\n    }\n  }`,\n  [EditableGenerationResultCardFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/generation-view/generation-main-view.tsx"},"span":[2836,2887],"sourceCode":"import { ResizablePanelWithMemory } from \"~/components/resizable-panel-with-memory\"\nimport { ResizableHandle, ResizablePanelGroup } from \"~/components/ui/resizable\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { GenerationConfigContext } from \"~/routes/($lang).generation._index/contexts/generation-config-context\"\nimport { useMediaQuery } from \"usehooks-ts\"\n\ntype Props = {\n  config: React.ReactNode\n  promptEditor: React.ReactNode\n  settingLanguageUsedForPromptView: React.ReactNode\n  negativePromptEditor: React.ReactNode\n  taskContentPreview: React.ReactNode\n  taskDetails: React.ReactNode\n  workContentPreview: React.ReactNode\n  submissionView: React.ReactNode\n}\n\n/**\n * ç”»åƒç”Ÿç”»é¢ã®ãƒ¡ã‚¤ãƒ³éƒ¨åˆ†\n */\nexport function GenerationMainView (props: Props) {\n  const state = GenerationConfigContext.useSelector((snap) => {\n    return snap.value\n  })\n\n  /**\n   * ã‚¹ãƒãƒ›ã®å ´åˆãƒªã‚µã‚¤ã‚¶ãƒ¼ãªã—\n   */\n  if (!useMediaQuery(\"(min-width: 768px)\")) {\n    return (\n      <div className=\"flex flex-1 flex-col gap-2 overflow-hidden lg:flex-row\">\n        <div className=\"lg:min-w-64 xl:min-w-80\">{props.config}</div>\n        <div className=\"flex flex-col gap-4 md:flex-row lg:min-w-64 lg:flex-col xl:min-w-96\">\n          {props.settingLanguageUsedForPromptView}\n          <div className=\"flex-1 overflow-hidden\">{props.promptEditor}</div>\n          <div className=\"min-w-80 flex-1 overflow-hidden\">\n            {props.negativePromptEditor}\n          </div>\n          <div className=\"gap-y-4 pb-4 md:px-4\">\n            <Separator />\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  /**\n   * ä½œå“ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰\n   */\n  if (state === \"WORK_PREVIEW\") {\n    return props.workContentPreview\n  }\n\n  /**\n   * å±¥æ­´ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰\n   */\n  if (state === \"HISTORY_PREVIEW\") {\n    return props.taskContentPreview\n  }\n\n  /**\n   * å±¥æ­´è©³ç´°è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰\n   */\n  if (\n    state === \"HISTORY_LIST_FULL\" ||\n    state === \"HISTORY_VIEW_ON_MAIN_AND_HEADER\"\n  ) {\n    return props.taskDetails\n  }\n\n  return (\n    <>\n      <ResizablePanelGroup\n        direction=\"horizontal\"\n        className=\"flex flex-1 flex-col gap-4 overflow-hidden lg:flex-row\"\n      >\n        <ResizablePanelWithMemory\n          id=\"generation-main\"\n          className=\"flex flex-col gap-4 md:flex-row lg:min-w-40 lg:flex-col xl:min-w-40\"\n        >\n          <ResizablePanelGroup\n            direction=\"vertical\"\n            className=\"flex flex-col space-y-2\"\n          >\n            {props.settingLanguageUsedForPromptView}\n            <ResizablePanelWithMemory id=\"generation-editor\">\n              <div className=\"h-full flex-1 overflow-hidden\">\n                {props.promptEditor}\n              </div>\n            </ResizablePanelWithMemory>\n            <ResizableHandle withHandle className=\"mt-2 mb-2\" />\n            <ResizablePanelWithMemory id=\"generation-negative\">\n              <div className=\"h-full flex-1 overflow-hidden\">\n                {props.negativePromptEditor}\n              </div>\n            </ResizablePanelWithMemory>\n            <div className=\"flex flex-col\">\n              <Separator className=\"mt-2 mb-2\" />\n              {props.submissionView}\n            </div>\n          </ResizablePanelGroup>\n        </ResizablePanelWithMemory>\n      </ResizablePanelGroup>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/generation-view/generation-main-view.tsx"},"span":[2203,2359],"sourceCode":"import { ResizablePanelWithMemory } from \"~/components/resizable-panel-with-memory\"\nimport { ResizableHandle, ResizablePanelGroup } from \"~/components/ui/resizable\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { GenerationConfigContext } from \"~/routes/($lang).generation._index/contexts/generation-config-context\"\nimport { useMediaQuery } from \"usehooks-ts\"\n\ntype Props = {\n  config: React.ReactNode\n  promptEditor: React.ReactNode\n  settingLanguageUsedForPromptView: React.ReactNode\n  negativePromptEditor: React.ReactNode\n  taskContentPreview: React.ReactNode\n  taskDetails: React.ReactNode\n  workContentPreview: React.ReactNode\n  submissionView: React.ReactNode\n}\n\n/**\n * ç”»åƒç”Ÿç”»é¢ã®ãƒ¡ã‚¤ãƒ³éƒ¨åˆ†\n */\nexport function GenerationMainView (props: Props) {\n  const state = GenerationConfigContext.useSelector((snap) => {\n    return snap.value\n  })\n\n  /**\n   * ã‚¹ãƒãƒ›ã®å ´åˆãƒªã‚µã‚¤ã‚¶ãƒ¼ãªã—\n   */\n  if (!useMediaQuery(\"(min-width: 768px)\")) {\n    return (\n      <div className=\"flex flex-1 flex-col gap-2 overflow-hidden lg:flex-row\">\n        <div className=\"lg:min-w-64 xl:min-w-80\">{props.config}</div>\n        <div className=\"flex flex-col gap-4 md:flex-row lg:min-w-64 lg:flex-col xl:min-w-96\">\n          {props.settingLanguageUsedForPromptView}\n          <div className=\"flex-1 overflow-hidden\">{props.promptEditor}</div>\n          <div className=\"min-w-80 flex-1 overflow-hidden\">\n            {props.negativePromptEditor}\n          </div>\n          <div className=\"gap-y-4 pb-4 md:px-4\">\n            <Separator />\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  /**\n   * ä½œå“ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰\n   */\n  if (state === \"WORK_PREVIEW\") {\n    return props.workContentPreview\n  }\n\n  /**\n   * å±¥æ­´ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰\n   */\n  if (state === \"HISTORY_PREVIEW\") {\n    return props.taskContentPreview\n  }\n\n  /**\n   * å±¥æ­´è©³ç´°è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰\n   */\n  if (\n    state === \"HISTORY_LIST_FULL\" ||\n    state === \"HISTORY_VIEW_ON_MAIN_AND_HEADER\"\n  ) {\n    return props.taskDetails\n  }\n\n  return (\n    <>\n      <ResizablePanelGroup\n        direction=\"horizontal\"\n        className=\"flex flex-1 flex-col gap-4 overflow-hidden lg:flex-row\"\n      >\n        <ResizablePanelWithMemory\n          id=\"generation-main\"\n          className=\"flex flex-col gap-4 md:flex-row lg:min-w-40 lg:flex-col xl:min-w-40\"\n        >\n          <ResizablePanelGroup\n            direction=\"vertical\"\n            className=\"flex flex-col space-y-2\"\n          >\n            {props.settingLanguageUsedForPromptView}\n            <ResizablePanelWithMemory id=\"generation-editor\">\n              <div className=\"h-full flex-1 overflow-hidden\">\n                {props.promptEditor}\n              </div>\n            </ResizablePanelWithMemory>\n            <ResizableHandle withHandle className=\"mt-2 mb-2\" />\n            <ResizablePanelWithMemory id=\"generation-negative\">\n              <div className=\"h-full flex-1 overflow-hidden\">\n                {props.negativePromptEditor}\n              </div>\n            </ResizablePanelWithMemory>\n            <div className=\"flex flex-col\">\n              <Separator className=\"mt-2 mb-2\" />\n              {props.submissionView}\n            </div>\n          </ResizablePanelGroup>\n        </ResizablePanelWithMemory>\n      </ResizablePanelGroup>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/generation-view/generation-main-view.tsx"},"span":[2549,2598],"sourceCode":"import { ResizablePanelWithMemory } from \"~/components/resizable-panel-with-memory\"\nimport { ResizableHandle, ResizablePanelGroup } from \"~/components/ui/resizable\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { GenerationConfigContext } from \"~/routes/($lang).generation._index/contexts/generation-config-context\"\nimport { useMediaQuery } from \"usehooks-ts\"\n\ntype Props = {\n  config: React.ReactNode\n  promptEditor: React.ReactNode\n  settingLanguageUsedForPromptView: React.ReactNode\n  negativePromptEditor: React.ReactNode\n  taskContentPreview: React.ReactNode\n  taskDetails: React.ReactNode\n  workContentPreview: React.ReactNode\n  submissionView: React.ReactNode\n}\n\n/**\n * ç”»åƒç”Ÿç”»é¢ã®ãƒ¡ã‚¤ãƒ³éƒ¨åˆ†\n */\nexport function GenerationMainView (props: Props) {\n  const state = GenerationConfigContext.useSelector((snap) => {\n    return snap.value\n  })\n\n  /**\n   * ã‚¹ãƒãƒ›ã®å ´åˆãƒªã‚µã‚¤ã‚¶ãƒ¼ãªã—\n   */\n  if (!useMediaQuery(\"(min-width: 768px)\")) {\n    return (\n      <div className=\"flex flex-1 flex-col gap-2 overflow-hidden lg:flex-row\">\n        <div className=\"lg:min-w-64 xl:min-w-80\">{props.config}</div>\n        <div className=\"flex flex-col gap-4 md:flex-row lg:min-w-64 lg:flex-col xl:min-w-96\">\n          {props.settingLanguageUsedForPromptView}\n          <div className=\"flex-1 overflow-hidden\">{props.promptEditor}</div>\n          <div className=\"min-w-80 flex-1 overflow-hidden\">\n            {props.negativePromptEditor}\n          </div>\n          <div className=\"gap-y-4 pb-4 md:px-4\">\n            <Separator />\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  /**\n   * ä½œå“ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰\n   */\n  if (state === \"WORK_PREVIEW\") {\n    return props.workContentPreview\n  }\n\n  /**\n   * å±¥æ­´ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰\n   */\n  if (state === \"HISTORY_PREVIEW\") {\n    return props.taskContentPreview\n  }\n\n  /**\n   * å±¥æ­´è©³ç´°è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰\n   */\n  if (\n    state === \"HISTORY_LIST_FULL\" ||\n    state === \"HISTORY_VIEW_ON_MAIN_AND_HEADER\"\n  ) {\n    return props.taskDetails\n  }\n\n  return (\n    <>\n      <ResizablePanelGroup\n        direction=\"horizontal\"\n        className=\"flex flex-1 flex-col gap-4 overflow-hidden lg:flex-row\"\n      >\n        <ResizablePanelWithMemory\n          id=\"generation-main\"\n          className=\"flex flex-col gap-4 md:flex-row lg:min-w-40 lg:flex-col xl:min-w-40\"\n        >\n          <ResizablePanelGroup\n            direction=\"vertical\"\n            className=\"flex flex-col space-y-2\"\n          >\n            {props.settingLanguageUsedForPromptView}\n            <ResizablePanelWithMemory id=\"generation-editor\">\n              <div className=\"h-full flex-1 overflow-hidden\">\n                {props.promptEditor}\n              </div>\n            </ResizablePanelWithMemory>\n            <ResizableHandle withHandle className=\"mt-2 mb-2\" />\n            <ResizablePanelWithMemory id=\"generation-negative\">\n              <div className=\"h-full flex-1 overflow-hidden\">\n                {props.negativePromptEditor}\n              </div>\n            </ResizablePanelWithMemory>\n            <div className=\"flex flex-col\">\n              <Separator className=\"mt-2 mb-2\" />\n              {props.submissionView}\n            </div>\n          </ResizablePanelGroup>\n        </ResizablePanelWithMemory>\n      </ResizablePanelGroup>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/generation-view/generation-view.tsx"},"span":[2657,2772],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { ResizablePanelWithMemory } from \"~/components/resizable-panel-with-memory\"\nimport {\n  ResizableHandle,\n  ResizablePanel,\n  ResizablePanelGroup,\n} from \"~/components/ui/resizable\"\nimport { GenerationConfigContext } from \"~/routes/($lang).generation._index/contexts/generation-config-context\"\nimport { GenerationAnnouncementBanner } from \"~/routes/($lang).generation._index/components/generation-announcement-banner\"\nimport { CharacterExpressionBanner } from \"~/routes/($lang).generation._index/components/character-expression-banner\"\nimport { Suspense } from \"react\"\nimport { useMediaQuery } from \"usehooks-ts\"\n\ntype Props = {\n  header: React.ReactNode\n  main: React.ReactNode\n  aside: React.ReactNode\n  asideHeader: React.ReactNode\n  menu: React.ReactNode\n  footer: React.ReactNode\n}\n\n/**\n * ç”»åƒç”Ÿæˆç”»é¢\n */\nexport function GenerationView (props: Props) {\n  const state = GenerationConfigContext.useSelector((snap) => {\n    return snap.value\n  })\n\n  /**\n   * ã‚¹ãƒãƒ›ã®å ´åˆãƒªã‚µã‚¤ã‚¶ãƒ¼ãªã—\n   */\n  if (!useMediaQuery(\"(min-width: 768px)\")) {\n    return (\n      <div className=\"flex flex-col space-y-2 pb-16\">\n        <GenerationAnnouncementBanner />\n        <CharacterExpressionBanner />\n        <main className=\"flex flex-col gap-2 overflow-hidden pb-4 md:flex-row\">\n          <div className=\"flex flex-col gap-y-2\">\n            {props.header}\n            {props.main}\n          </div>\n          <div className=\"flex-1 overflow-hidden\">\n            <div className=\"mx-2\">{props.asideHeader}</div>\n            {props.aside}\n          </div>\n        </main>\n        {props.footer}\n      </div>\n    )\n  }\n\n  if (state === \"HISTORY_LIST_FULL\" || state === \"WORK_LIST_FULL\") {\n    return (\n      <div className=\"flex flex-col space-y-2 md:h-[calc(100vh-72px)]\">\n        <GenerationAnnouncementBanner />\n        <CharacterExpressionBanner />\n        <main className=\"flex h-full flex-col gap-4 overflow-hidden md:flex-row\">\n          <ResizablePanelGroup direction=\"horizontal\">\n            <ResizablePanel className=\"flex flex-col gap-y-2 lg:min-w-80 xl:min-w-80\">\n              {props.asideHeader}\n              {props.aside}\n            </ResizablePanel>\n          </ResizablePanelGroup>\n        </main>\n        {props.footer}\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex flex-col space-y-2 md:h-[calc(100vh-72px)]\">\n      <GenerationAnnouncementBanner />\n      <CharacterExpressionBanner />\n      <main className=\"flex h-full flex-col gap-4 overflow-hidden md:flex-row\">\n        <ResizablePanelGroup defaultValue={1} direction=\"horizontal\">\n          <ResizablePanelWithMemory\n            id=\"generation-header-menu\"\n            className=\"flex flex-col\"\n          >\n            <Suspense fallback={<AppLoadingPage />}>{props.menu}</Suspense>\n          </ResizablePanelWithMemory>\n          <ResizableHandle withHandle className=\"mr-4 ml-4\" />\n          <ResizablePanelWithMemory\n            id=\"generation-header-main\"\n            className=\"flex flex-col\"\n          >\n            <Suspense fallback={<AppLoadingPage />}>{props.main}</Suspense>\n          </ResizablePanelWithMemory>\n          <ResizableHandle withHandle className=\"mr-4 ml-4\" />\n          <ResizablePanelWithMemory\n            id=\"generation-aside-header-aside\"\n            className=\"flex flex-col gap-y-2 lg:min-w-80 xl:min-w-80\"\n          >\n            <Suspense fallback={<AppLoadingPage />}>\n              {props.asideHeader}\n              {props.aside}\n            </Suspense>\n          </ResizablePanelWithMemory>\n        </ResizablePanelGroup>\n      </main>\n      {props.footer}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/generation-view/generation-view.tsx"},"span":[2960,3075],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { ResizablePanelWithMemory } from \"~/components/resizable-panel-with-memory\"\nimport {\n  ResizableHandle,\n  ResizablePanel,\n  ResizablePanelGroup,\n} from \"~/components/ui/resizable\"\nimport { GenerationConfigContext } from \"~/routes/($lang).generation._index/contexts/generation-config-context\"\nimport { GenerationAnnouncementBanner } from \"~/routes/($lang).generation._index/components/generation-announcement-banner\"\nimport { CharacterExpressionBanner } from \"~/routes/($lang).generation._index/components/character-expression-banner\"\nimport { Suspense } from \"react\"\nimport { useMediaQuery } from \"usehooks-ts\"\n\ntype Props = {\n  header: React.ReactNode\n  main: React.ReactNode\n  aside: React.ReactNode\n  asideHeader: React.ReactNode\n  menu: React.ReactNode\n  footer: React.ReactNode\n}\n\n/**\n * ç”»åƒç”Ÿæˆç”»é¢\n */\nexport function GenerationView (props: Props) {\n  const state = GenerationConfigContext.useSelector((snap) => {\n    return snap.value\n  })\n\n  /**\n   * ã‚¹ãƒãƒ›ã®å ´åˆãƒªã‚µã‚¤ã‚¶ãƒ¼ãªã—\n   */\n  if (!useMediaQuery(\"(min-width: 768px)\")) {\n    return (\n      <div className=\"flex flex-col space-y-2 pb-16\">\n        <GenerationAnnouncementBanner />\n        <CharacterExpressionBanner />\n        <main className=\"flex flex-col gap-2 overflow-hidden pb-4 md:flex-row\">\n          <div className=\"flex flex-col gap-y-2\">\n            {props.header}\n            {props.main}\n          </div>\n          <div className=\"flex-1 overflow-hidden\">\n            <div className=\"mx-2\">{props.asideHeader}</div>\n            {props.aside}\n          </div>\n        </main>\n        {props.footer}\n      </div>\n    )\n  }\n\n  if (state === \"HISTORY_LIST_FULL\" || state === \"WORK_LIST_FULL\") {\n    return (\n      <div className=\"flex flex-col space-y-2 md:h-[calc(100vh-72px)]\">\n        <GenerationAnnouncementBanner />\n        <CharacterExpressionBanner />\n        <main className=\"flex h-full flex-col gap-4 overflow-hidden md:flex-row\">\n          <ResizablePanelGroup direction=\"horizontal\">\n            <ResizablePanel className=\"flex flex-col gap-y-2 lg:min-w-80 xl:min-w-80\">\n              {props.asideHeader}\n              {props.aside}\n            </ResizablePanel>\n          </ResizablePanelGroup>\n        </main>\n        {props.footer}\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex flex-col space-y-2 md:h-[calc(100vh-72px)]\">\n      <GenerationAnnouncementBanner />\n      <CharacterExpressionBanner />\n      <main className=\"flex h-full flex-col gap-4 overflow-hidden md:flex-row\">\n        <ResizablePanelGroup defaultValue={1} direction=\"horizontal\">\n          <ResizablePanelWithMemory\n            id=\"generation-header-menu\"\n            className=\"flex flex-col\"\n          >\n            <Suspense fallback={<AppLoadingPage />}>{props.menu}</Suspense>\n          </ResizablePanelWithMemory>\n          <ResizableHandle withHandle className=\"mr-4 ml-4\" />\n          <ResizablePanelWithMemory\n            id=\"generation-header-main\"\n            className=\"flex flex-col\"\n          >\n            <Suspense fallback={<AppLoadingPage />}>{props.main}</Suspense>\n          </ResizablePanelWithMemory>\n          <ResizableHandle withHandle className=\"mr-4 ml-4\" />\n          <ResizablePanelWithMemory\n            id=\"generation-aside-header-aside\"\n            className=\"flex flex-col gap-y-2 lg:min-w-80 xl:min-w-80\"\n          >\n            <Suspense fallback={<AppLoadingPage />}>\n              {props.asideHeader}\n              {props.aside}\n            </Suspense>\n          </ResizablePanelWithMemory>\n        </ResizablePanelGroup>\n      </main>\n      {props.footer}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/generation-view/generation-view.tsx"},"span":[3263,3417],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { ResizablePanelWithMemory } from \"~/components/resizable-panel-with-memory\"\nimport {\n  ResizableHandle,\n  ResizablePanel,\n  ResizablePanelGroup,\n} from \"~/components/ui/resizable\"\nimport { GenerationConfigContext } from \"~/routes/($lang).generation._index/contexts/generation-config-context\"\nimport { GenerationAnnouncementBanner } from \"~/routes/($lang).generation._index/components/generation-announcement-banner\"\nimport { CharacterExpressionBanner } from \"~/routes/($lang).generation._index/components/character-expression-banner\"\nimport { Suspense } from \"react\"\nimport { useMediaQuery } from \"usehooks-ts\"\n\ntype Props = {\n  header: React.ReactNode\n  main: React.ReactNode\n  aside: React.ReactNode\n  asideHeader: React.ReactNode\n  menu: React.ReactNode\n  footer: React.ReactNode\n}\n\n/**\n * ç”»åƒç”Ÿæˆç”»é¢\n */\nexport function GenerationView (props: Props) {\n  const state = GenerationConfigContext.useSelector((snap) => {\n    return snap.value\n  })\n\n  /**\n   * ã‚¹ãƒãƒ›ã®å ´åˆãƒªã‚µã‚¤ã‚¶ãƒ¼ãªã—\n   */\n  if (!useMediaQuery(\"(min-width: 768px)\")) {\n    return (\n      <div className=\"flex flex-col space-y-2 pb-16\">\n        <GenerationAnnouncementBanner />\n        <CharacterExpressionBanner />\n        <main className=\"flex flex-col gap-2 overflow-hidden pb-4 md:flex-row\">\n          <div className=\"flex flex-col gap-y-2\">\n            {props.header}\n            {props.main}\n          </div>\n          <div className=\"flex-1 overflow-hidden\">\n            <div className=\"mx-2\">{props.asideHeader}</div>\n            {props.aside}\n          </div>\n        </main>\n        {props.footer}\n      </div>\n    )\n  }\n\n  if (state === \"HISTORY_LIST_FULL\" || state === \"WORK_LIST_FULL\") {\n    return (\n      <div className=\"flex flex-col space-y-2 md:h-[calc(100vh-72px)]\">\n        <GenerationAnnouncementBanner />\n        <CharacterExpressionBanner />\n        <main className=\"flex h-full flex-col gap-4 overflow-hidden md:flex-row\">\n          <ResizablePanelGroup direction=\"horizontal\">\n            <ResizablePanel className=\"flex flex-col gap-y-2 lg:min-w-80 xl:min-w-80\">\n              {props.asideHeader}\n              {props.aside}\n            </ResizablePanel>\n          </ResizablePanelGroup>\n        </main>\n        {props.footer}\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex flex-col space-y-2 md:h-[calc(100vh-72px)]\">\n      <GenerationAnnouncementBanner />\n      <CharacterExpressionBanner />\n      <main className=\"flex h-full flex-col gap-4 overflow-hidden md:flex-row\">\n        <ResizablePanelGroup defaultValue={1} direction=\"horizontal\">\n          <ResizablePanelWithMemory\n            id=\"generation-header-menu\"\n            className=\"flex flex-col\"\n          >\n            <Suspense fallback={<AppLoadingPage />}>{props.menu}</Suspense>\n          </ResizablePanelWithMemory>\n          <ResizableHandle withHandle className=\"mr-4 ml-4\" />\n          <ResizablePanelWithMemory\n            id=\"generation-header-main\"\n            className=\"flex flex-col\"\n          >\n            <Suspense fallback={<AppLoadingPage />}>{props.main}</Suspense>\n          </ResizablePanelWithMemory>\n          <ResizableHandle withHandle className=\"mr-4 ml-4\" />\n          <ResizablePanelWithMemory\n            id=\"generation-aside-header-aside\"\n            className=\"flex flex-col gap-y-2 lg:min-w-80 xl:min-w-80\"\n          >\n            <Suspense fallback={<AppLoadingPage />}>\n              {props.asideHeader}\n              {props.aside}\n            </Suspense>\n          </ResizablePanelWithMemory>\n        </ResizablePanelGroup>\n      </main>\n      {props.footer}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable send is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"send"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/reserved-generation-card.tsx"},"span":[721,725],"sourceCode":"import { cn } from \"~/lib/utils\"\nimport { GenerationConfigContext } from \"~/routes/($lang).generation._index/contexts/generation-config-context\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { GenerationTaskCancelButton } from \"~/routes/($lang).generation._index/components/generation-cancel-button\"\nimport { Loader2Icon } from \"lucide-react\"\n\ntype Props = {\n  onCancel?(): void\n  onClick?(): void\n  isCanceling?: boolean\n  isPreviewByHover?: boolean\n  taskId: string\n  setIsHovered: (isHovered: boolean) => void\n}\n\n/**\n * ç”Ÿæˆäºˆç´„ã®å±¥æ­´\n */\nexport function ReservedGenerationCard (props: Props) {\n  const _context = useGenerationContext()\n  const { send } = GenerationConfigContext.useActorRef()\n\n  return (\n    <div className=\"relative h-full w-full\">\n      <GenerationTaskCancelButton\n        onCancel={props.onCancel}\n        isCanceling={props.isCanceling}\n      />\n\n      <button\n        type={\"button\"}\n        onClick={props.onClick}\n        className={cn(\n          \"relative\",\n          \"h-full w-full overflow-hidden rounded bg-card p-0\",\n          \"border-2 border-input\",\n        )}\n      >\n        <div className=\"h-full\">\n          <div className=\"relative flex\">\n            <div className=\"m-auto flex flex-col gap-y-2 p-4\">\n              <Loader2Icon className=\"mr-auto size-6 animate-spin\" />\n              <span className=\"ta-c mb-4 text-sm\">{\"reserved...\"}</span>\n            </div>\n          </div>\n        </div>\n      </button>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/submission-view/generation-submit-operation-parts.tsx"},"span":[2076,2089],"sourceCode":"import { GradientBlueButton } from \"~/components/button/gradient-blue-button\"\nimport { GradientBorderButton } from \"~/components/button/gradient-border-button\"\nimport { LoginDialogButton } from \"~/components/login-dialog-button\"\nimport { Button } from \"~/components/ui/button\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\"\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuTrigger,\n} from \"~/components/ui/dropdown-menu\"\nimport { Label } from \"~/components/ui/label\"\nimport { Switch } from \"~/components/ui/switch\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { GenerationReserveCountInput } from \"~/routes/($lang).generation._index/components/submission-view/generation-reserve-count-input\"\nimport { GenerationSubmitButton } from \"~/routes/($lang).generation._index/components/submission-view/generation-submit-button\"\nimport { GenerationTermsButton } from \"~/routes/($lang).generation._index/components/submission-view/generation-terms-button\"\nimport { SubscriptionDialogContent } from \"~/routes/($lang).generation._index/components/submission-view/subscription-dialog-content\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { Loader2Icon, Minus, Plus, SettingsIcon } from \"lucide-react\"\nimport { useContext } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  isCreatingTask: boolean\n  inProgressImageGenerationTasksCount: number\n  inProgressImageGenerationReservedTasksCount: number\n  maxTasksCount: number\n  tasksCount: number\n  termsText: string\n  availableImageGenerationMaxTasksCount: number\n  onCreateTask: () => void\n  onSignTerms: () => void\n}\n\n/**\n * ç”Ÿæˆãƒœã‚¿ãƒ³ã®ãƒ©ãƒ™ãƒ«\n * @param isSetI2iImage\n * @param prompts\n * @param seed\n */\nexport function getSubmitButtonLabel (\n  isSetI2iImage: boolean,\n  prompts: string,\n  seed: number,\n  inProgressImageGenerationTasksCount: number,\n) {\n  // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n  const t = useTranslation()\n\n  const seedLabel = seed === -1 ? \"\" : t(\"(Seedå›ºå®š)\", \"(Seed fixed)\")\n\n  if (!prompts) {\n    if (isSetI2iImage) {\n      return t(\n        `ç”»åƒã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆ${seedLabel}`,\n        `Random generation from image ${seedLabel}`,\n      )\n    }\n    return t(`ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆ${seedLabel}`, `Random generation ${seedLabel}`)\n  }\n  if (isSetI2iImage) {\n    return t(`ç”»åƒã‹ã‚‰ç”Ÿæˆ${seedLabel}`, `Generate from image ${seedLabel}`)\n  }\n  if (inProgressImageGenerationTasksCount > 0) {\n    return t(`è¿½åŠ ç”Ÿæˆ${seedLabel}`, `Add generation ${seedLabel}`)\n  }\n  return t(`ç”Ÿæˆ${seedLabel}`, `Generate ${seedLabel}`)\n}\n\n/**\n * ç”Ÿæˆå®Ÿè¡Œã«é–¢ã‚ã‚‹æ“ä½œUI\n */\nexport function GenerationSubmitOperationParts (props: Props) {\n  const context = useGenerationContext()\n\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const isCurrentPremiumPlan = () => {\n    if (context.currentPass?.type === \"PREMIUM\") {\n      return true\n    }\n    return false\n  }\n\n  const onMinusButtonClick = () => {\n    if (context.config.generationCount <= 1) {\n      return\n    }\n    context.changeGenerationCount(context.config.generationCount - 1)\n  }\n\n  const onPlusButtonClick = () => {\n    if (\n      context.config.generationCount >=\n      props.availableImageGenerationMaxTasksCount\n    ) {\n      return\n    }\n    context.changeGenerationCount(context.config.generationCount + 1)\n  }\n\n  const generatingCount =\n    props.inProgressImageGenerationTasksCount +\n    props.inProgressImageGenerationReservedTasksCount\n\n  return (\n    <>\n      <div className=\"flex items-center\">\n        <div className=\"flex items-center md:hidden\">\n          <DropdownMenu>\n            <DropdownMenuTrigger asChild>\n              <Button\n                className=\"mr-2 block md:hidden\"\n                size={\"icon\"}\n                variant={\"ghost\"}\n              >\n                <SettingsIcon className=\"m-auto\" />\n              </Button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent>\n              <div className=\"flex items-center p-2\">\n                <Button\n                  className=\"mr-2\"\n                  size={\"icon\"}\n                  variant={\"ghost\"}\n                  onClick={onMinusButtonClick}\n                >\n                  <Minus className=\"m-auto\" />\n                </Button>\n                <GenerationReserveCountInput\n                  maxCount={\n                    props.availableImageGenerationMaxTasksCount -\n                    props.tasksCount\n                  }\n                  onChange={context.changeGenerationCount}\n                  count={context.config.generationCount}\n                />\n                {t(\"æš\", \"pieces\")}\n                <Button\n                  className=\"mr-2\"\n                  size={\"icon\"}\n                  variant={\"ghost\"}\n                  onClick={onPlusButtonClick}\n                >\n                  <Plus className=\"m-auto\" />\n                </Button>\n              </div>\n            </DropdownMenuContent>\n          </DropdownMenu>\n          <div className=\"hidden items-center md:flex\">\n            <GenerationReserveCountInput\n              maxCount={\n                props.availableImageGenerationMaxTasksCount - props.tasksCount\n              }\n              onChange={context.changeGenerationCount}\n              count={context.config.generationCount}\n            />\n            <div className=\"mr-2\">{t(\"æš\", \"pieces\")}</div>\n          </div>\n        </div>\n        {/* æœªãƒ­ã‚°ã‚¤ãƒ³ãªã‚‰ãƒ­ã‚°ã‚¤ãƒ³ã€ãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾—ä¸­ã‚‚disabledãªçŠ¶æ…‹ã§è¡¨ç¤º */}\n        {(!authContext.isLoggedIn || context.user === null) && (\n          <>\n            <div className=\"mr-2 flex w-56 items-center space-x-2 md:w-48\">\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Switch\n                onClick={() => {\n                  context.changeUpscaleSize(\n                    context.config.upscaleSize === 2 ? 1 : 2,\n                  )\n                }}\n                checked={context.config.upscaleSize === 2}\n                id=\"extras-mode\"\n              />\n              <div className=\"text-center leading-3\">\n                <Label htmlFor=\"extras-mode\" className=\"block text-center\">\n                  {t(\"é«˜è§£åƒåº¦\", \"High Resolution\")}\n                </Label>\n                <Label\n                  htmlFor=\"extras-mode\"\n                  className=\"block text-center text-xs\"\n                >\n                  {t(\"2æšæ¶ˆè²»\", \"Consumes 2 pieces\")}\n                </Label>\n              </div>\n            </div>\n            <LoginDialogButton\n              label={t(\"ç”Ÿæˆ\", \"Generate\")}\n              isLoading={\n                authContext.isLoading ||\n                (authContext.isLoggedIn && context.user === null)\n              }\n              isWidthFull={true}\n              triggerChildren={\n                <GradientBlueButton\n                  onClick={() => {}}\n                  className=\"w-full text-balance\"\n                  isNoBackground={true}\n                >\n                  <div className=\"flex items-center\">\n                    {t(\"ç”Ÿæˆ\", \"Generate\")}\n                    {(authContext.isLoading ||\n                      (authContext.isLoggedIn && context.user === null)) && (\n                      <span className=\"ml-2 animate-spin\">\n                        <Loader2Icon />\n                      </span>\n                    )}\n                  </div>\n                </GradientBlueButton>\n              }\n            />\n          </>\n        )}\n        {/* è¦ç´„ç¢ºèªé–‹å§‹ãƒœã‚¿ãƒ³ */}\n        {authContext.isLoggedIn &&\n          context.user !== null &&\n          context.user?.hasSignedImageGenerationTerms !== true && (\n            <GenerationTermsButton\n              termsMarkdownText={props.termsText}\n              isLoading={props.isCreatingTask}\n              onSubmit={props.onSignTerms}\n              triggerChildren={\n                <GradientBorderButton\n                  disabled={props.isCreatingTask}\n                  onClick={() => {}}\n                  className=\"w-full text-balance\"\n                  isNoBackground={true}\n                >\n                  {props.isCreatingTask\n                    ? t(\"å‡¦ç†ä¸­..\", \"Processing..\")\n                    : t(\"ç”Ÿæˆ\", \"Generate\")}\n                </GradientBorderButton>\n              }\n            />\n          )}\n        {/* ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã®å ´åˆã¯ã‚µãƒ–ã‚¹ã‚¯æ¡ˆå†…ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãªã—ver */}\n        {isCurrentPremiumPlan() &&\n          context.user?.hasSignedImageGenerationTerms === true && (\n            <GenerationSubmitButton\n              onClick={async () => {\n                await props.onCreateTask()\n              }}\n              isLoading={props.isCreatingTask}\n              isDisabled={context.config.isDisabled}\n              generatingCount={generatingCount}\n              maxGeneratingCount={\n                props.availableImageGenerationMaxTasksCount - props.tasksCount\n              }\n              buttonActionCaption={getSubmitButtonLabel(\n                !!context.config.i2iImageBase64,\n                context.config.promptText,\n                context.config.seed,\n                generatingCount,\n              )}\n            />\n          )}\n        {/* ã‚µãƒ–ã‚¹ã‚¯æ¡ˆå†…ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚ã‚Šverï¼ˆæœ€å¾Œã®1æšã®ç”Ÿæˆæ™‚ã«æ¡ˆå†…ã™ã‚‹ï¼‰ */}\n        {!isCurrentPremiumPlan() &&\n          props.tasksCount <\n            props.availableImageGenerationMaxTasksCount -\n              (context.config.upscaleSize === 2 ? 2 : 1) &&\n          context.user?.hasSignedImageGenerationTerms === true && (\n            <GenerationSubmitButton\n              onClick={async () => {\n                await props.onCreateTask()\n              }}\n              isLoading={props.isCreatingTask}\n              isDisabled={context.config.isDisabled}\n              generatingCount={generatingCount}\n              maxGeneratingCount={\n                props.availableImageGenerationMaxTasksCount - props.tasksCount\n              }\n              buttonActionCaption={getSubmitButtonLabel(\n                !!context.config.i2iImageBase64,\n                context.config.promptText,\n                context.config.seed,\n                generatingCount,\n              )}\n            />\n          )}\n        {/* é€šå¸¸ã®ç”Ÿæˆãƒœã‚¿ãƒ³ */}\n        {!isCurrentPremiumPlan() &&\n          props.tasksCount >=\n            props.availableImageGenerationMaxTasksCount -\n              (context.config.upscaleSize === 2 ? 2 : 1) &&\n          context.user?.hasSignedImageGenerationTerms === true && (\n            <Dialog>\n              <DialogTrigger asChild>\n                <div className=\"flex w-full items-center space-x-4\">\n                  <div className=\"flex w-48 items-center md:w-40\">\n                    {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n                    <Switch\n                      onClick={() => {\n                        context.changeUpscaleSize(\n                          context.config.upscaleSize === 2 ? 1 : 2,\n                        )\n                      }}\n                      checked={context.config.upscaleSize === 2}\n                      id=\"extras-mode\"\n                    />\n                    <div className=\"text-center leading-3\">\n                      <Label\n                        htmlFor=\"extras-mode\"\n                        className=\"block text-center\"\n                      >\n                        {t(\"é«˜è§£åƒåº¦\", \"High Resolution\")}\n                      </Label>\n                      <Label\n                        htmlFor=\"extras-mode\"\n                        className=\"block text-center text-xs\"\n                      >\n                        {t(\"2æšæ¶ˆè²»\", \"Consumes 2 pieces\")}\n                      </Label>\n                    </div>\n                  </div>\n                  <GenerationSubmitButton\n                    onClick={async () => {\n                      await props.onCreateTask()\n                    }}\n                    isLoading={props.isCreatingTask}\n                    isDisabled={context.config.isDisabled}\n                    generatingCount={generatingCount}\n                    maxGeneratingCount={\n                      props.availableImageGenerationMaxTasksCount -\n                      props.tasksCount\n                    }\n                    buttonActionCaption={getSubmitButtonLabel(\n                      !!context.config.i2iImageBase64,\n                      context.config.promptText,\n                      context.config.seed,\n                      generatingCount,\n                    )}\n                  />\n                </div>\n              </DialogTrigger>\n              <DialogContent className=\"min-w-[64vw]\">\n                <DialogHeader>\n                  <DialogTitle>\n                    {t(\n                      \"Aipictorsã®ç”Ÿæˆæ©Ÿèƒ½ã‚’ã”åˆ©ç”¨ã„ãŸã ãã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚\",\n                      \"Thank you for using Aipictors' generation feature.\",\n                    )}\n                  </DialogTitle>\n                  <DialogDescription>\n                    {t(\n                      \"Aipictors+ã«åŠ å…¥ã™ã‚‹ã“ã¨ã§ç”Ÿæˆæšæ•°ãªã©ã®ç‰¹å…¸ã‚’å—ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\",\n                      \"By subscribing to Aipictors+, you can enjoy additional benefits like increased generation count.\",\n                    )}\n                  </DialogDescription>\n                </DialogHeader>\n                <SubscriptionDialogContent />\n              </DialogContent>\n            </Dialog>\n          )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/submission-view/generation-submit-operation-parts.tsx"},"span":[5933,5946],"sourceCode":"import { GradientBlueButton } from \"~/components/button/gradient-blue-button\"\nimport { GradientBorderButton } from \"~/components/button/gradient-border-button\"\nimport { LoginDialogButton } from \"~/components/login-dialog-button\"\nimport { Button } from \"~/components/ui/button\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\"\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuTrigger,\n} from \"~/components/ui/dropdown-menu\"\nimport { Label } from \"~/components/ui/label\"\nimport { Switch } from \"~/components/ui/switch\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { GenerationReserveCountInput } from \"~/routes/($lang).generation._index/components/submission-view/generation-reserve-count-input\"\nimport { GenerationSubmitButton } from \"~/routes/($lang).generation._index/components/submission-view/generation-submit-button\"\nimport { GenerationTermsButton } from \"~/routes/($lang).generation._index/components/submission-view/generation-terms-button\"\nimport { SubscriptionDialogContent } from \"~/routes/($lang).generation._index/components/submission-view/subscription-dialog-content\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { Loader2Icon, Minus, Plus, SettingsIcon } from \"lucide-react\"\nimport { useContext } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  isCreatingTask: boolean\n  inProgressImageGenerationTasksCount: number\n  inProgressImageGenerationReservedTasksCount: number\n  maxTasksCount: number\n  tasksCount: number\n  termsText: string\n  availableImageGenerationMaxTasksCount: number\n  onCreateTask: () => void\n  onSignTerms: () => void\n}\n\n/**\n * ç”Ÿæˆãƒœã‚¿ãƒ³ã®ãƒ©ãƒ™ãƒ«\n * @param isSetI2iImage\n * @param prompts\n * @param seed\n */\nexport function getSubmitButtonLabel (\n  isSetI2iImage: boolean,\n  prompts: string,\n  seed: number,\n  inProgressImageGenerationTasksCount: number,\n) {\n  // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n  const t = useTranslation()\n\n  const seedLabel = seed === -1 ? \"\" : t(\"(Seedå›ºå®š)\", \"(Seed fixed)\")\n\n  if (!prompts) {\n    if (isSetI2iImage) {\n      return t(\n        `ç”»åƒã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆ${seedLabel}`,\n        `Random generation from image ${seedLabel}`,\n      )\n    }\n    return t(`ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆ${seedLabel}`, `Random generation ${seedLabel}`)\n  }\n  if (isSetI2iImage) {\n    return t(`ç”»åƒã‹ã‚‰ç”Ÿæˆ${seedLabel}`, `Generate from image ${seedLabel}`)\n  }\n  if (inProgressImageGenerationTasksCount > 0) {\n    return t(`è¿½åŠ ç”Ÿæˆ${seedLabel}`, `Add generation ${seedLabel}`)\n  }\n  return t(`ç”Ÿæˆ${seedLabel}`, `Generate ${seedLabel}`)\n}\n\n/**\n * ç”Ÿæˆå®Ÿè¡Œã«é–¢ã‚ã‚‹æ“ä½œUI\n */\nexport function GenerationSubmitOperationParts (props: Props) {\n  const context = useGenerationContext()\n\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const isCurrentPremiumPlan = () => {\n    if (context.currentPass?.type === \"PREMIUM\") {\n      return true\n    }\n    return false\n  }\n\n  const onMinusButtonClick = () => {\n    if (context.config.generationCount <= 1) {\n      return\n    }\n    context.changeGenerationCount(context.config.generationCount - 1)\n  }\n\n  const onPlusButtonClick = () => {\n    if (\n      context.config.generationCount >=\n      props.availableImageGenerationMaxTasksCount\n    ) {\n      return\n    }\n    context.changeGenerationCount(context.config.generationCount + 1)\n  }\n\n  const generatingCount =\n    props.inProgressImageGenerationTasksCount +\n    props.inProgressImageGenerationReservedTasksCount\n\n  return (\n    <>\n      <div className=\"flex items-center\">\n        <div className=\"flex items-center md:hidden\">\n          <DropdownMenu>\n            <DropdownMenuTrigger asChild>\n              <Button\n                className=\"mr-2 block md:hidden\"\n                size={\"icon\"}\n                variant={\"ghost\"}\n              >\n                <SettingsIcon className=\"m-auto\" />\n              </Button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent>\n              <div className=\"flex items-center p-2\">\n                <Button\n                  className=\"mr-2\"\n                  size={\"icon\"}\n                  variant={\"ghost\"}\n                  onClick={onMinusButtonClick}\n                >\n                  <Minus className=\"m-auto\" />\n                </Button>\n                <GenerationReserveCountInput\n                  maxCount={\n                    props.availableImageGenerationMaxTasksCount -\n                    props.tasksCount\n                  }\n                  onChange={context.changeGenerationCount}\n                  count={context.config.generationCount}\n                />\n                {t(\"æš\", \"pieces\")}\n                <Button\n                  className=\"mr-2\"\n                  size={\"icon\"}\n                  variant={\"ghost\"}\n                  onClick={onPlusButtonClick}\n                >\n                  <Plus className=\"m-auto\" />\n                </Button>\n              </div>\n            </DropdownMenuContent>\n          </DropdownMenu>\n          <div className=\"hidden items-center md:flex\">\n            <GenerationReserveCountInput\n              maxCount={\n                props.availableImageGenerationMaxTasksCount - props.tasksCount\n              }\n              onChange={context.changeGenerationCount}\n              count={context.config.generationCount}\n            />\n            <div className=\"mr-2\">{t(\"æš\", \"pieces\")}</div>\n          </div>\n        </div>\n        {/* æœªãƒ­ã‚°ã‚¤ãƒ³ãªã‚‰ãƒ­ã‚°ã‚¤ãƒ³ã€ãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾—ä¸­ã‚‚disabledãªçŠ¶æ…‹ã§è¡¨ç¤º */}\n        {(!authContext.isLoggedIn || context.user === null) && (\n          <>\n            <div className=\"mr-2 flex w-56 items-center space-x-2 md:w-48\">\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Switch\n                onClick={() => {\n                  context.changeUpscaleSize(\n                    context.config.upscaleSize === 2 ? 1 : 2,\n                  )\n                }}\n                checked={context.config.upscaleSize === 2}\n                id=\"extras-mode\"\n              />\n              <div className=\"text-center leading-3\">\n                <Label htmlFor=\"extras-mode\" className=\"block text-center\">\n                  {t(\"é«˜è§£åƒåº¦\", \"High Resolution\")}\n                </Label>\n                <Label\n                  htmlFor=\"extras-mode\"\n                  className=\"block text-center text-xs\"\n                >\n                  {t(\"2æšæ¶ˆè²»\", \"Consumes 2 pieces\")}\n                </Label>\n              </div>\n            </div>\n            <LoginDialogButton\n              label={t(\"ç”Ÿæˆ\", \"Generate\")}\n              isLoading={\n                authContext.isLoading ||\n                (authContext.isLoggedIn && context.user === null)\n              }\n              isWidthFull={true}\n              triggerChildren={\n                <GradientBlueButton\n                  onClick={() => {}}\n                  className=\"w-full text-balance\"\n                  isNoBackground={true}\n                >\n                  <div className=\"flex items-center\">\n                    {t(\"ç”Ÿæˆ\", \"Generate\")}\n                    {(authContext.isLoading ||\n                      (authContext.isLoggedIn && context.user === null)) && (\n                      <span className=\"ml-2 animate-spin\">\n                        <Loader2Icon />\n                      </span>\n                    )}\n                  </div>\n                </GradientBlueButton>\n              }\n            />\n          </>\n        )}\n        {/* è¦ç´„ç¢ºèªé–‹å§‹ãƒœã‚¿ãƒ³ */}\n        {authContext.isLoggedIn &&\n          context.user !== null &&\n          context.user?.hasSignedImageGenerationTerms !== true && (\n            <GenerationTermsButton\n              termsMarkdownText={props.termsText}\n              isLoading={props.isCreatingTask}\n              onSubmit={props.onSignTerms}\n              triggerChildren={\n                <GradientBorderButton\n                  disabled={props.isCreatingTask}\n                  onClick={() => {}}\n                  className=\"w-full text-balance\"\n                  isNoBackground={true}\n                >\n                  {props.isCreatingTask\n                    ? t(\"å‡¦ç†ä¸­..\", \"Processing..\")\n                    : t(\"ç”Ÿæˆ\", \"Generate\")}\n                </GradientBorderButton>\n              }\n            />\n          )}\n        {/* ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã®å ´åˆã¯ã‚µãƒ–ã‚¹ã‚¯æ¡ˆå†…ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãªã—ver */}\n        {isCurrentPremiumPlan() &&\n          context.user?.hasSignedImageGenerationTerms === true && (\n            <GenerationSubmitButton\n              onClick={async () => {\n                await props.onCreateTask()\n              }}\n              isLoading={props.isCreatingTask}\n              isDisabled={context.config.isDisabled}\n              generatingCount={generatingCount}\n              maxGeneratingCount={\n                props.availableImageGenerationMaxTasksCount - props.tasksCount\n              }\n              buttonActionCaption={getSubmitButtonLabel(\n                !!context.config.i2iImageBase64,\n                context.config.promptText,\n                context.config.seed,\n                generatingCount,\n              )}\n            />\n          )}\n        {/* ã‚µãƒ–ã‚¹ã‚¯æ¡ˆå†…ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚ã‚Šverï¼ˆæœ€å¾Œã®1æšã®ç”Ÿæˆæ™‚ã«æ¡ˆå†…ã™ã‚‹ï¼‰ */}\n        {!isCurrentPremiumPlan() &&\n          props.tasksCount <\n            props.availableImageGenerationMaxTasksCount -\n              (context.config.upscaleSize === 2 ? 2 : 1) &&\n          context.user?.hasSignedImageGenerationTerms === true && (\n            <GenerationSubmitButton\n              onClick={async () => {\n                await props.onCreateTask()\n              }}\n              isLoading={props.isCreatingTask}\n              isDisabled={context.config.isDisabled}\n              generatingCount={generatingCount}\n              maxGeneratingCount={\n                props.availableImageGenerationMaxTasksCount - props.tasksCount\n              }\n              buttonActionCaption={getSubmitButtonLabel(\n                !!context.config.i2iImageBase64,\n                context.config.promptText,\n                context.config.seed,\n                generatingCount,\n              )}\n            />\n          )}\n        {/* é€šå¸¸ã®ç”Ÿæˆãƒœã‚¿ãƒ³ */}\n        {!isCurrentPremiumPlan() &&\n          props.tasksCount >=\n            props.availableImageGenerationMaxTasksCount -\n              (context.config.upscaleSize === 2 ? 2 : 1) &&\n          context.user?.hasSignedImageGenerationTerms === true && (\n            <Dialog>\n              <DialogTrigger asChild>\n                <div className=\"flex w-full items-center space-x-4\">\n                  <div className=\"flex w-48 items-center md:w-40\">\n                    {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n                    <Switch\n                      onClick={() => {\n                        context.changeUpscaleSize(\n                          context.config.upscaleSize === 2 ? 1 : 2,\n                        )\n                      }}\n                      checked={context.config.upscaleSize === 2}\n                      id=\"extras-mode\"\n                    />\n                    <div className=\"text-center leading-3\">\n                      <Label\n                        htmlFor=\"extras-mode\"\n                        className=\"block text-center\"\n                      >\n                        {t(\"é«˜è§£åƒåº¦\", \"High Resolution\")}\n                      </Label>\n                      <Label\n                        htmlFor=\"extras-mode\"\n                        className=\"block text-center text-xs\"\n                      >\n                        {t(\"2æšæ¶ˆè²»\", \"Consumes 2 pieces\")}\n                      </Label>\n                    </div>\n                  </div>\n                  <GenerationSubmitButton\n                    onClick={async () => {\n                      await props.onCreateTask()\n                    }}\n                    isLoading={props.isCreatingTask}\n                    isDisabled={context.config.isDisabled}\n                    generatingCount={generatingCount}\n                    maxGeneratingCount={\n                      props.availableImageGenerationMaxTasksCount -\n                      props.tasksCount\n                    }\n                    buttonActionCaption={getSubmitButtonLabel(\n                      !!context.config.i2iImageBase64,\n                      context.config.promptText,\n                      context.config.seed,\n                      generatingCount,\n                    )}\n                  />\n                </div>\n              </DialogTrigger>\n              <DialogContent className=\"min-w-[64vw]\">\n                <DialogHeader>\n                  <DialogTitle>\n                    {t(\n                      \"Aipictorsã®ç”Ÿæˆæ©Ÿèƒ½ã‚’ã”åˆ©ç”¨ã„ãŸã ãã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚\",\n                      \"Thank you for using Aipictors' generation feature.\",\n                    )}\n                  </DialogTitle>\n                  <DialogDescription>\n                    {t(\n                      \"Aipictors+ã«åŠ å…¥ã™ã‚‹ã“ã¨ã§ç”Ÿæˆæšæ•°ãªã©ã®ç‰¹å…¸ã‚’å—ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\",\n                      \"By subscribing to Aipictors+, you can enjoy additional benefits like increased generation count.\",\n                    )}\n                  </DialogDescription>\n                </DialogHeader>\n                <SubscriptionDialogContent />\n              </DialogContent>\n            </Dialog>\n          )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/submission-view/generation-submit-operation-parts.tsx"},"span":[11003,11016],"sourceCode":"import { GradientBlueButton } from \"~/components/button/gradient-blue-button\"\nimport { GradientBorderButton } from \"~/components/button/gradient-border-button\"\nimport { LoginDialogButton } from \"~/components/login-dialog-button\"\nimport { Button } from \"~/components/ui/button\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\"\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuTrigger,\n} from \"~/components/ui/dropdown-menu\"\nimport { Label } from \"~/components/ui/label\"\nimport { Switch } from \"~/components/ui/switch\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { GenerationReserveCountInput } from \"~/routes/($lang).generation._index/components/submission-view/generation-reserve-count-input\"\nimport { GenerationSubmitButton } from \"~/routes/($lang).generation._index/components/submission-view/generation-submit-button\"\nimport { GenerationTermsButton } from \"~/routes/($lang).generation._index/components/submission-view/generation-terms-button\"\nimport { SubscriptionDialogContent } from \"~/routes/($lang).generation._index/components/submission-view/subscription-dialog-content\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { Loader2Icon, Minus, Plus, SettingsIcon } from \"lucide-react\"\nimport { useContext } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  isCreatingTask: boolean\n  inProgressImageGenerationTasksCount: number\n  inProgressImageGenerationReservedTasksCount: number\n  maxTasksCount: number\n  tasksCount: number\n  termsText: string\n  availableImageGenerationMaxTasksCount: number\n  onCreateTask: () => void\n  onSignTerms: () => void\n}\n\n/**\n * ç”Ÿæˆãƒœã‚¿ãƒ³ã®ãƒ©ãƒ™ãƒ«\n * @param isSetI2iImage\n * @param prompts\n * @param seed\n */\nexport function getSubmitButtonLabel (\n  isSetI2iImage: boolean,\n  prompts: string,\n  seed: number,\n  inProgressImageGenerationTasksCount: number,\n) {\n  // biome-ignore lint/correctness/useHookAtTopLevel: <explanation>\n  const t = useTranslation()\n\n  const seedLabel = seed === -1 ? \"\" : t(\"(Seedå›ºå®š)\", \"(Seed fixed)\")\n\n  if (!prompts) {\n    if (isSetI2iImage) {\n      return t(\n        `ç”»åƒã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆ${seedLabel}`,\n        `Random generation from image ${seedLabel}`,\n      )\n    }\n    return t(`ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆ${seedLabel}`, `Random generation ${seedLabel}`)\n  }\n  if (isSetI2iImage) {\n    return t(`ç”»åƒã‹ã‚‰ç”Ÿæˆ${seedLabel}`, `Generate from image ${seedLabel}`)\n  }\n  if (inProgressImageGenerationTasksCount > 0) {\n    return t(`è¿½åŠ ç”Ÿæˆ${seedLabel}`, `Add generation ${seedLabel}`)\n  }\n  return t(`ç”Ÿæˆ${seedLabel}`, `Generate ${seedLabel}`)\n}\n\n/**\n * ç”Ÿæˆå®Ÿè¡Œã«é–¢ã‚ã‚‹æ“ä½œUI\n */\nexport function GenerationSubmitOperationParts (props: Props) {\n  const context = useGenerationContext()\n\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const isCurrentPremiumPlan = () => {\n    if (context.currentPass?.type === \"PREMIUM\") {\n      return true\n    }\n    return false\n  }\n\n  const onMinusButtonClick = () => {\n    if (context.config.generationCount <= 1) {\n      return\n    }\n    context.changeGenerationCount(context.config.generationCount - 1)\n  }\n\n  const onPlusButtonClick = () => {\n    if (\n      context.config.generationCount >=\n      props.availableImageGenerationMaxTasksCount\n    ) {\n      return\n    }\n    context.changeGenerationCount(context.config.generationCount + 1)\n  }\n\n  const generatingCount =\n    props.inProgressImageGenerationTasksCount +\n    props.inProgressImageGenerationReservedTasksCount\n\n  return (\n    <>\n      <div className=\"flex items-center\">\n        <div className=\"flex items-center md:hidden\">\n          <DropdownMenu>\n            <DropdownMenuTrigger asChild>\n              <Button\n                className=\"mr-2 block md:hidden\"\n                size={\"icon\"}\n                variant={\"ghost\"}\n              >\n                <SettingsIcon className=\"m-auto\" />\n              </Button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent>\n              <div className=\"flex items-center p-2\">\n                <Button\n                  className=\"mr-2\"\n                  size={\"icon\"}\n                  variant={\"ghost\"}\n                  onClick={onMinusButtonClick}\n                >\n                  <Minus className=\"m-auto\" />\n                </Button>\n                <GenerationReserveCountInput\n                  maxCount={\n                    props.availableImageGenerationMaxTasksCount -\n                    props.tasksCount\n                  }\n                  onChange={context.changeGenerationCount}\n                  count={context.config.generationCount}\n                />\n                {t(\"æš\", \"pieces\")}\n                <Button\n                  className=\"mr-2\"\n                  size={\"icon\"}\n                  variant={\"ghost\"}\n                  onClick={onPlusButtonClick}\n                >\n                  <Plus className=\"m-auto\" />\n                </Button>\n              </div>\n            </DropdownMenuContent>\n          </DropdownMenu>\n          <div className=\"hidden items-center md:flex\">\n            <GenerationReserveCountInput\n              maxCount={\n                props.availableImageGenerationMaxTasksCount - props.tasksCount\n              }\n              onChange={context.changeGenerationCount}\n              count={context.config.generationCount}\n            />\n            <div className=\"mr-2\">{t(\"æš\", \"pieces\")}</div>\n          </div>\n        </div>\n        {/* æœªãƒ­ã‚°ã‚¤ãƒ³ãªã‚‰ãƒ­ã‚°ã‚¤ãƒ³ã€ãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾—ä¸­ã‚‚disabledãªçŠ¶æ…‹ã§è¡¨ç¤º */}\n        {(!authContext.isLoggedIn || context.user === null) && (\n          <>\n            <div className=\"mr-2 flex w-56 items-center space-x-2 md:w-48\">\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Switch\n                onClick={() => {\n                  context.changeUpscaleSize(\n                    context.config.upscaleSize === 2 ? 1 : 2,\n                  )\n                }}\n                checked={context.config.upscaleSize === 2}\n                id=\"extras-mode\"\n              />\n              <div className=\"text-center leading-3\">\n                <Label htmlFor=\"extras-mode\" className=\"block text-center\">\n                  {t(\"é«˜è§£åƒåº¦\", \"High Resolution\")}\n                </Label>\n                <Label\n                  htmlFor=\"extras-mode\"\n                  className=\"block text-center text-xs\"\n                >\n                  {t(\"2æšæ¶ˆè²»\", \"Consumes 2 pieces\")}\n                </Label>\n              </div>\n            </div>\n            <LoginDialogButton\n              label={t(\"ç”Ÿæˆ\", \"Generate\")}\n              isLoading={\n                authContext.isLoading ||\n                (authContext.isLoggedIn && context.user === null)\n              }\n              isWidthFull={true}\n              triggerChildren={\n                <GradientBlueButton\n                  onClick={() => {}}\n                  className=\"w-full text-balance\"\n                  isNoBackground={true}\n                >\n                  <div className=\"flex items-center\">\n                    {t(\"ç”Ÿæˆ\", \"Generate\")}\n                    {(authContext.isLoading ||\n                      (authContext.isLoggedIn && context.user === null)) && (\n                      <span className=\"ml-2 animate-spin\">\n                        <Loader2Icon />\n                      </span>\n                    )}\n                  </div>\n                </GradientBlueButton>\n              }\n            />\n          </>\n        )}\n        {/* è¦ç´„ç¢ºèªé–‹å§‹ãƒœã‚¿ãƒ³ */}\n        {authContext.isLoggedIn &&\n          context.user !== null &&\n          context.user?.hasSignedImageGenerationTerms !== true && (\n            <GenerationTermsButton\n              termsMarkdownText={props.termsText}\n              isLoading={props.isCreatingTask}\n              onSubmit={props.onSignTerms}\n              triggerChildren={\n                <GradientBorderButton\n                  disabled={props.isCreatingTask}\n                  onClick={() => {}}\n                  className=\"w-full text-balance\"\n                  isNoBackground={true}\n                >\n                  {props.isCreatingTask\n                    ? t(\"å‡¦ç†ä¸­..\", \"Processing..\")\n                    : t(\"ç”Ÿæˆ\", \"Generate\")}\n                </GradientBorderButton>\n              }\n            />\n          )}\n        {/* ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã®å ´åˆã¯ã‚µãƒ–ã‚¹ã‚¯æ¡ˆå†…ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãªã—ver */}\n        {isCurrentPremiumPlan() &&\n          context.user?.hasSignedImageGenerationTerms === true && (\n            <GenerationSubmitButton\n              onClick={async () => {\n                await props.onCreateTask()\n              }}\n              isLoading={props.isCreatingTask}\n              isDisabled={context.config.isDisabled}\n              generatingCount={generatingCount}\n              maxGeneratingCount={\n                props.availableImageGenerationMaxTasksCount - props.tasksCount\n              }\n              buttonActionCaption={getSubmitButtonLabel(\n                !!context.config.i2iImageBase64,\n                context.config.promptText,\n                context.config.seed,\n                generatingCount,\n              )}\n            />\n          )}\n        {/* ã‚µãƒ–ã‚¹ã‚¯æ¡ˆå†…ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚ã‚Šverï¼ˆæœ€å¾Œã®1æšã®ç”Ÿæˆæ™‚ã«æ¡ˆå†…ã™ã‚‹ï¼‰ */}\n        {!isCurrentPremiumPlan() &&\n          props.tasksCount <\n            props.availableImageGenerationMaxTasksCount -\n              (context.config.upscaleSize === 2 ? 2 : 1) &&\n          context.user?.hasSignedImageGenerationTerms === true && (\n            <GenerationSubmitButton\n              onClick={async () => {\n                await props.onCreateTask()\n              }}\n              isLoading={props.isCreatingTask}\n              isDisabled={context.config.isDisabled}\n              generatingCount={generatingCount}\n              maxGeneratingCount={\n                props.availableImageGenerationMaxTasksCount - props.tasksCount\n              }\n              buttonActionCaption={getSubmitButtonLabel(\n                !!context.config.i2iImageBase64,\n                context.config.promptText,\n                context.config.seed,\n                generatingCount,\n              )}\n            />\n          )}\n        {/* é€šå¸¸ã®ç”Ÿæˆãƒœã‚¿ãƒ³ */}\n        {!isCurrentPremiumPlan() &&\n          props.tasksCount >=\n            props.availableImageGenerationMaxTasksCount -\n              (context.config.upscaleSize === 2 ? 2 : 1) &&\n          context.user?.hasSignedImageGenerationTerms === true && (\n            <Dialog>\n              <DialogTrigger asChild>\n                <div className=\"flex w-full items-center space-x-4\">\n                  <div className=\"flex w-48 items-center md:w-40\">\n                    {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n                    <Switch\n                      onClick={() => {\n                        context.changeUpscaleSize(\n                          context.config.upscaleSize === 2 ? 1 : 2,\n                        )\n                      }}\n                      checked={context.config.upscaleSize === 2}\n                      id=\"extras-mode\"\n                    />\n                    <div className=\"text-center leading-3\">\n                      <Label\n                        htmlFor=\"extras-mode\"\n                        className=\"block text-center\"\n                      >\n                        {t(\"é«˜è§£åƒåº¦\", \"High Resolution\")}\n                      </Label>\n                      <Label\n                        htmlFor=\"extras-mode\"\n                        className=\"block text-center text-xs\"\n                      >\n                        {t(\"2æšæ¶ˆè²»\", \"Consumes 2 pieces\")}\n                      </Label>\n                    </div>\n                  </div>\n                  <GenerationSubmitButton\n                    onClick={async () => {\n                      await props.onCreateTask()\n                    }}\n                    isLoading={props.isCreatingTask}\n                    isDisabled={context.config.isDisabled}\n                    generatingCount={generatingCount}\n                    maxGeneratingCount={\n                      props.availableImageGenerationMaxTasksCount -\n                      props.tasksCount\n                    }\n                    buttonActionCaption={getSubmitButtonLabel(\n                      !!context.config.i2iImageBase64,\n                      context.config.promptText,\n                      context.config.seed,\n                      generatingCount,\n                    )}\n                  />\n                </div>\n              </DialogTrigger>\n              <DialogContent className=\"min-w-[64vw]\">\n                <DialogHeader>\n                  <DialogTitle>\n                    {t(\n                      \"Aipictorsã®ç”Ÿæˆæ©Ÿèƒ½ã‚’ã”åˆ©ç”¨ã„ãŸã ãã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚\",\n                      \"Thank you for using Aipictors' generation feature.\",\n                    )}\n                  </DialogTitle>\n                  <DialogDescription>\n                    {t(\n                      \"Aipictors+ã«åŠ å…¥ã™ã‚‹ã“ã¨ã§ç”Ÿæˆæšæ•°ãªã©ã®ç‰¹å…¸ã‚’å—ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\",\n                      \"By subscribing to Aipictors+, you can enjoy additional benefits like increased generation count.\",\n                    )}\n                  </DialogDescription>\n                </DialogHeader>\n                <SubscriptionDialogContent />\n              </DialogContent>\n            </Dialog>\n          )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable ipInfo is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"ipInfo"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/submission-view/generation-submit-view.tsx"},"span":[2531,2537],"sourceCode":"import { AppFixedContent } from \"~/components/app/app-fixed-content\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { config } from \"~/config\"\nimport { GenerationSubmitOperationParts } from \"~/routes/($lang).generation._index/components/submission-view/generation-submit-operation-parts\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { useGenerationQuery } from \"~/routes/($lang).generation._index/hooks/use-generation-query\"\nimport { useMutation, useSuspenseQuery } from \"@apollo/client/index\"\nimport { useContext, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { useBoolean, useMediaQuery } from \"usehooks-ts\"\nimport { VerificationDialog } from \"~/components/verification-dialog\"\nimport { useNavigate, useSearchParams } from \"@remix-run/react\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { graphql } from \"gql.tada\"\nimport type { GeminiImageSize } from \"~/types/gemini-image-generation\"\n// è¿½åŠ : è¨ºæ–­ãƒ­ã‚°\nimport {\n  logInfo,\n  logWarn,\n  logError,\n} from \"~/routes/($lang).generation._index/utils/client-diagnostics-logger\"\nimport { useIpAddress } from \"~/hooks/use-ip-address\"\n\n/**\n * UIã‚µã‚¤ã‚ºã‚¿ã‚¤ãƒ—ã‚’GeminiImageSizeã«å¤‰æ›ã™ã‚‹\n */\nconst convertToGeminiImageSize = (sizeType: string): GeminiImageSize => {\n  switch (sizeType) {\n    case \"SD3_512_512\":\n    case \"SD5_512_512\":\n      return \"SQUARE_512\"\n    case \"SD3_768_768\":\n    case \"SD5_768_768\":\n      return \"SQUARE_768\"\n    case \"SD3_1024_1024\":\n    case \"SD5_1024_1024\":\n      return \"SQUARE_1024\"\n    case \"SD3_1216_832\":\n      return \"LANDSCAPE\"\n    case \"SD3_1280_720\":\n      return \"LANDSCAPE\"\n    case \"SD3_832_1216\":\n      return \"PORTRAIT\"\n    case \"SD3_720_1280\":\n    case \"SD5_720_1280\":\n      return \"PORTRAIT\"\n    default:\n      return \"SQUARE_1024\"\n  }\n}\n\nconst ViewerTokenQuery = graphql(\n  `query ViewerTokenQuery {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\ntype Props = {\n  termsText: string\n}\n\nexport function GenerationSubmissionView (props: Props) {\n  const context = useGenerationContext()\n\n  const queryData = useGenerationQuery()\n\n  const navigate = useNavigate()\n\n  const isDesktop = useMediaQuery(\"(min-width: 768px)\")\n\n  const [beforeGenerationParams, setBeforeGenerationParams] = useState(\"\")\n\n  const { data: tokenData } = useQuery(ViewerTokenQuery)\n\n  // IPã‚¢ãƒ‰ãƒ¬ã‚¹å–å¾—\n  const { ipInfo } = useIpAddress()\n\n  const { data: pass, refetch: refetchPass } = useQuery(\n    viewerCurrentPassQuery,\n    {},\n  )\n\n  const [createTask, { loading: isCreatingTask }] = useMutation(\n    createImageGenerationTaskMutation,\n    {\n      refetchQueries: [viewerCurrentPassQuery],\n      awaitRefetchQueries: true,\n      onCompleted() {\n        logInfo({\n          source: \"GenerationSubmit\",\n          message: \"createImageGenerationTask completed\",\n        })\n      },\n      onError(error) {\n        logError({\n          source: \"GenerationSubmit\",\n          message: \"createImageGenerationTask error\",\n          details: { name: error.name, message: error.message },\n        })\n        if (isDesktop) {\n          toast.error(error.message)\n        } else {\n          toast.error(error.message, { position: \"top-center\" })\n        }\n      },\n    },\n  )\n\n  const [createFluxTask] = useMutation(createFluxImageGenerationTaskMutation, {\n    refetchQueries: [viewerCurrentPassQuery],\n    awaitRefetchQueries: true,\n    onCompleted() {\n      logInfo({\n        source: \"GenerationSubmit\",\n        message: \"createFluxTask completed\",\n      })\n    },\n    onError(error) {\n      logError({\n        source: \"GenerationSubmit\",\n        message: \"createFluxTask error\",\n        details: { name: error.name, message: error.message },\n      })\n      if (isDesktop) {\n        toast.error(error.message)\n      } else {\n        toast.error(error.message, { position: \"top-center\" })\n      }\n    },\n  })\n\n  const [createGeminiTask] = useMutation<{\n    createGeminiImageGenerationTask: {\n      id: string\n      nanoid: string\n      status: string\n    }\n  }>(createGeminiImageGenerationTaskMutation, {\n    refetchQueries: [viewerCurrentPassQuery],\n    awaitRefetchQueries: true,\n    onCompleted(data) {\n      if (data?.createGeminiImageGenerationTask) {\n        logInfo({\n          source: \"GenerationSubmit\",\n          message: \"createGeminiTask completed\",\n          details: {\n            id: data.createGeminiImageGenerationTask.id,\n            status: data.createGeminiImageGenerationTask.status,\n            nanoid: data.createGeminiImageGenerationTask.nanoid,\n          },\n        })\n        toast(\"Geminiã‚¿ã‚¹ã‚¯ãŒä½œæˆã•ã‚Œã¾ã—ãŸã€‚å®Œäº†å¾Œã«çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚\", {\n          position: isDesktop ? \"bottom-right\" : \"top-center\",\n        })\n      }\n    },\n    onError(error) {\n      logError({\n        source: \"GenerationSubmit\",\n        message: \"createGeminiTask error\",\n        details: { name: error.name, message: error.message },\n      })\n      if (isDesktop) {\n        toast.error(error.message)\n      } else {\n        toast.error(error.message, { position: \"top-center\" })\n      }\n    },\n  })\n\n  const [createReservedTask] = useMutation(\n    createImageGenerationTaskReservedMutation,\n    {\n      refetchQueries: [viewerCurrentPassQuery],\n      awaitRefetchQueries: true,\n      onCompleted() {\n        logInfo({\n          source: \"GenerationSubmit\",\n          message: \"createReservedTask completed\",\n        })\n      },\n      onError(error) {\n        logError({\n          source: \"GenerationSubmit\",\n          message: \"createReservedTask error\",\n          details: { name: error.name, message: error.message },\n        })\n        if (isDesktop) {\n          toast.error(error.message)\n        } else {\n          toast.error(error.message, { position: \"top-center\" })\n        }\n      },\n    },\n  )\n\n  const authContext = useContext(AuthContext)\n\n  const { data: lineUserId } = useQuery(viewerLineUserIdQuery, {\n    skip: authContext.isNotLoggedIn,\n  })\n\n  const [signTerms, { loading: isSigningTerms }] = useMutation(\n    signImageGenerationTermsMutation,\n    {\n      refetchQueries: [viewerCurrentPassQuery],\n      awaitRefetchQueries: true,\n    },\n  )\n\n  /**\n   * è¦ç´„ã«åŒæ„ã™ã‚‹\n   */\n  const onSignTerms = async () => {\n    try {\n      await signTerms({ variables: { input: { version: 1 } } })\n      toast(\"ç”»åƒç”Ÿæˆã®åˆ©ç”¨è¦ç´„ã«åŒæ„ã—ã¾ã—ãŸ\")\n      window.location.reload()\n    } catch (error) {\n      if (error instanceof Error) {\n        toast(error.message)\n      }\n    }\n  }\n\n  /**\n   * åŒã˜Seedã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã£ãŸã‹ã©ã†ã‹ã€åŒã˜ãªã‚‰ã‚¨ãƒ©ãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹\n   */\n  const checkSameBeforeRequestAndToast: (\n    modelName: string,\n    generationType: string,\n    i2iFileUrl: string,\n  ) => boolean = (modelName, generationType, i2iFileUrl) => {\n    const generationParams = {\n      model: modelName,\n      vae: context.config.vae ?? \"\",\n      prompt: context.config.promptText,\n      negativePrompt: context.config.negativePromptText,\n      seed: context.config.seed,\n      steps: context.config.steps,\n      scale: context.config.scale,\n      sampler: context.config.sampler,\n      clipSkip: context.config.clipSkip,\n      sizeType: context.config\n        .sizeType as IntrospectionEnum<\"ImageGenerationSizeType\">,\n      type: generationType,\n      i2iFileUrl: i2iFileUrl,\n      t2tImageUrl: i2iFileUrl,\n      t2tDenoisingStrengthSize:\n        context.config.i2iDenoisingStrengthSize.toString(),\n    }\n    const generationParamsJson = JSON.stringify(generationParams)\n    if (beforeGenerationParams === generationParamsJson) {\n      toast(\n        \"å‰å›ã¨åŒã˜ç”Ÿæˆæ¡ä»¶ã§ã®é€£ç¶šç”Ÿæˆã¯ã§ãã¾ã›ã‚“ã€‚Seedã‚’å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚\",\n      )\n      return true\n    }\n    if (context.config.seed !== -1) {\n      setBeforeGenerationParams(generationParamsJson)\n    }\n    return false\n  }\n\n  const getControlNetImageUrl = async (base64: string | null) => {\n    if (base64 === null) {\n      return null\n    }\n\n    const userNanoid = context.user?.nanoid ?? null\n    if (userNanoid === null) {\n      navigate(\"/new/profile\")\n      return null\n    }\n\n    const viewerToken = tokenData?.viewer?.token\n    if (!viewerToken) {\n      logError({\n        source: \"GenerationSubmit\",\n        message: \"Viewer token missing for ControlNet upload\",\n      })\n      toast(\"èªè¨¼ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ãƒ­ã‚°ã‚¤ãƒ³ã—ç›´ã—ã¦ãã ã•ã„ã€‚\")\n      return null\n    }\n\n    const controlNetImageUrl = await uploadPublicImage(base64, viewerToken)\n\n    if (controlNetImageUrl === \"\") return null\n\n    return controlNetImageUrl\n  }\n\n  // èªè¨¼ãƒ¢ãƒ¼ãƒ€ãƒ«ã®é–‹é–‰\n  const {\n    value: isOpenVerificationModal,\n    setTrue: openVerificationModal,\n    setFalse: closeVerificationModal,\n  } = useBoolean()\n\n  const appContext = useContext(AuthContext)\n\n  const { data = null } = useSuspenseQuery(viewerUserQuery, {\n    skip: appContext.isLoading,\n  })\n\n  const generatedCount = data?.viewer?.user.generatedCount ?? 0\n\n  /**\n   * ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã¨ãã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯\n   */\n  const onCreateTask = async () => {\n    // é€ä¿¡é–‹å§‹ãƒ­ã‚°\n    logInfo({\n      source: \"GenerationSubmit\",\n      message: \"Submit start\",\n      details: {\n        plan: context.currentPass?.type ?? null,\n        modelId: context.config.modelId,\n        modelType: context.config.modelType,\n        sizeType: context.config.sizeType,\n        promptLength: context.config.promptText.length,\n        negativePromptLength: context.config.negativePromptText.length,\n        generationCount: context.config.generationCount,\n        hasI2iImage: Boolean(context.config.i2iImageBase64),\n        upscaleSize: context.config.upscaleSize,\n      },\n    })\n\n    const isStandardOrPremium =\n      context.currentPass?.type === \"STANDARD\" ||\n      context.currentPass?.type === \"PREMIUM\"\n\n    const isLiteOrStandardOrPremium =\n      context.currentPass?.type === \"LITE\" ||\n      context.currentPass?.type === \"STANDARD\" ||\n      context.currentPass?.type === \"PREMIUM\"\n\n    if (\n      !context.currentPass?.type &&\n      !lineUserId?.viewer?.lineUserId &&\n      !pass?.viewer?.currentPass?.type &&\n      generatedCount >= 10 &&\n      !isExistedPreviousPass\n    ) {\n      logWarn({\n        source: \"GenerationSubmit\",\n        message: \"Blocked: verification required\",\n        details: { generatedCount },\n      })\n      await refetchPass()\n      if (!pass?.viewer?.currentPass?.type) {\n        toast(\"æœ¬äººç¢ºèªãŒå®Œäº†ã—ã¦ã„ã¾ã›ã‚“ã€‚æœ¬äººç¢ºèªã‚’å®Œäº†ã—ã¦ãã ã•ã„ã€‚\")\n        openVerificationModal()\n        return\n      }\n    }\n\n    /**\n     * ç”Ÿæˆç¨®åˆ¥\n     */\n    const generationType =\n      context.config.i2iImageBase64 &&\n      (isLiteOrStandardOrPremium || context.config.modelType === \"GEMINI\")\n        ? \"IMAGE_TO_IMAGE\"\n        : \"TEXT_TO_IMAGE\"\n\n    logInfo({\n      source: \"GenerationSubmit\",\n      message: \"Decided generationType\",\n      details: { generationType },\n    })\n\n    // GEMINIã®å ´åˆã¯ç”»åƒã‹ã‚‰ç”Ÿæˆã‚’ãƒ—ãƒ©ãƒ³é–¢ä¿‚ãªãåˆ©ç”¨å¯èƒ½\n    if (\n      context.config.i2iImageBase64 &&\n      !isLiteOrStandardOrPremium &&\n      context.config.modelType !== \"GEMINI\"\n    ) {\n      logWarn({\n        source: \"GenerationSubmit\",\n        message: \"Blocked: IMG2IMG requires LITE+\",\n      })\n      toast(\"img2imgã¯LITEä»¥ä¸Šã®ãƒ—ãƒ©ãƒ³ã§ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚\")\n      return\n    }\n\n    if (context.config.generationCount > 1 && !isStandardOrPremium) {\n      logWarn({\n        source: \"GenerationSubmit\",\n        message: \"Blocked: multi-count requires STANDARD+\",\n        details: { count: context.config.generationCount },\n      })\n      toast(\"STANDARDä»¥ä¸Šã®ãƒ—ãƒ©ãƒ³ã§2æšä»¥ä¸Šã‚’åŒæ™‚æŒ‡å®šå¯èƒ½ã§ã™ã€‚\")\n      return\n    }\n\n    // ç”Ÿæˆä¸­ã‹ã¤ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ã€ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä»¥å¤–ãªã‚‰ã‚µãƒ–ã‚¹ã‚¯ã«èª˜å°\n    if (inProgressImageGenerationTasksCount !== 0 && !isStandardOrPremium) {\n      logWarn({\n        source: \"GenerationSubmit\",\n        message: \"Blocked: concurrent generation requires STANDARD+\",\n        details: { inProgressImageGenerationTasksCount },\n      })\n      toast(\"STANDARDä»¥ä¸Šã®ãƒ—ãƒ©ãƒ³ã§è¤‡æ•°æšåŒæ™‚ç”Ÿæˆå¯èƒ½ã§ã™ã€‚\")\n      return\n    }\n\n    // i2iã®å ´åˆã¯é€£ç¶šç”Ÿæˆæ•°ã‚’è¶…éã—ã¦ã„ãŸã‚‰ã‚¨ãƒ©ãƒ¼ã«ã™ã‚‹\n    if (\n      generationType === \"IMAGE_TO_IMAGE\" &&\n      inProgressImageGenerationTasksCount + context.config.generationCount >\n        maxTasksCount\n    ) {\n      logWarn({\n        source: \"GenerationSubmit\",\n        message: \"Blocked: IMG2IMG concurrent limit\",\n        details: {\n          inProgress: inProgressImageGenerationTasksCount,\n          requestCount: context.config.generationCount,\n          maxTasksCount,\n        },\n      })\n      toast(\"åŒæ™‚ç”Ÿæˆæšæ•°ã®ä¸Šé™ã§ã™ã€‚\")\n      return\n    }\n\n    if (\n      context.config.generationCount > 1 &&\n      context.config.controlNetImageBase64 !== null\n    ) {\n      logWarn({\n        source: \"GenerationSubmit\",\n        message: \"Blocked: ControlNet with multi-count not allowed\",\n      })\n      toast(\"ControlNetã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯1æšãšã¤ç”Ÿæˆä¸‹ã•ã„ã€‚\")\n      return\n    }\n\n    if (\n      context.config.modelType === \"FLUX\" &&\n      context.config.controlNetImageBase64 !== null\n    ) {\n      logWarn({\n        source: \"GenerationSubmit\",\n        message: \"Blocked: FLUX with ControlNet\",\n      })\n      if (isDesktop) {\n        toast(\"FLUXãƒ¢ãƒ‡ãƒ«ã¯ControlNetã‚’ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚\")\n        return\n      }\n      toast(\"FLUXãƒ¢ãƒ‡ãƒ«ã¯ControlNetã‚’ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚\", {\n        position: \"top-center\",\n      })\n      return\n    }\n\n    if (context.config.modelType === \"FLUX\" && context.config.i2iImageBase64) {\n      logWarn({\n        source: \"GenerationSubmit\",\n        message: \"Blocked: FLUX with IMG2IMG\",\n      })\n      if (isDesktop) {\n        toast(\n          \"FLUXãƒ¢ãƒ‡ãƒ«ã¯ç”»åƒã‹ã‚‰ç”Ÿæˆã‚’ä¸€æ™‚çš„ã«åœæ­¢ã—ã¦ã„ã¾ã™ã€ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“\",\n        )\n        return\n      }\n      toast(\n        \"FLUXãƒ¢ãƒ‡ãƒ«ã¯ç”»åƒã‹ã‚‰ç”Ÿæˆã‚’ä¸€æ™‚çš„ã«åœæ­¢ã—ã¦ã„ã¾ã™ã€ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“\",\n        {\n          position: \"top-center\",\n        },\n      )\n      return\n    }\n\n    if (context.config.upscaleSize === 2 && context.config.i2iImageBase64) {\n      logWarn({\n        source: \"GenerationSubmit\",\n        message: \"Blocked: HighRes with IMG2IMG\",\n      })\n      if (isDesktop) {\n        toast(\n          \"é«˜è§£åƒåº¦ã¨i2iã®çµ„ã¿åˆã‚ã›ã¯ç¾åœ¨ä¸€æ™‚åœæ­¢ã—ã¦ãŠã‚Šã¾ã™ã€ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“\",\n        )\n        return\n      }\n      toast(\n        \"é«˜è§£åƒåº¦ã¨i2iã®çµ„ã¿åˆã‚ã›ã¯ç¾åœ¨ä¸€æ™‚åœæ­¢ã—ã¦ãŠã‚Šã¾ã™ã€ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“\",\n        {\n          position: \"top-center\",\n        },\n      )\n      return\n    }\n\n    if (\n      context.config.controlNetImageBase64 !== null &&\n      (context.config.controlNetWeight === null ||\n        context.config.controlNetModule === null)\n    ) {\n      logWarn({\n        source: \"GenerationSubmit\",\n        message: \"Blocked: ControlNet settings incomplete\",\n      })\n      toast(\n        \"ControlNetã®ç”»åƒãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã™ãŒã€è©³ç´°è¨­å®šãŒå®Œäº†ã—ã¦ã„ã¾ã›ã‚“ã€‚ç”»åƒã‚’æ¶ˆã™ã‹ã€è¨­å®šã‚’å®Œäº†ã—ã¦ä¸‹ã•ã„ã€‚\",\n      )\n      return\n    }\n\n    const userId = context.user?.id ?? null\n    if (userId === null) {\n      logWarn({ source: \"GenerationSubmit\", message: \"Blocked: no userId\" })\n      return null\n    }\n\n    const userNanoid = context.user?.nanoid ?? null\n    if (userNanoid === null) {\n      logWarn({ source: \"GenerationSubmit\", message: \"Blocked: no userNanoid\" })\n      navigate(\"/new/profile\")\n      return null\n    }\n\n    const model = context.imageModels.find((model) => {\n      return model.id === context.config.modelId\n    })\n\n    if (typeof model === \"undefined\") {\n      logWarn({\n        source: \"GenerationSubmit\",\n        message: \"Blocked: model not found\",\n      })\n      toast(\"ãƒ¢ãƒ‡ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€å†åº¦ãƒ¢ãƒ‡ãƒ«ã‚’é¸æŠã—ãªãŠã—ã¦ãã ã•ã„ã€‚\")\n      return\n    }\n\n    if (\n      (model.name === \"flux.1 schnell\" || model.name === \"flux.1 pro\") &&\n      !isStandardOrPremium\n    ) {\n      logWarn({\n        source: \"GenerationSubmit\",\n        message: \"Blocked: flux.1 requires STANDARD+\",\n        details: { model: model.name },\n      })\n      toast(\"flux.1ã¯ã€STANDARDä»¥ä¸Šã®ãƒ—ãƒ©ãƒ³ã§ç”Ÿæˆå¯èƒ½ã§ã™ã€‚\")\n      return\n    }\n\n    // ç”Ÿæˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ãŸã„å›æ•°åˆ†ç”Ÿæˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã†\n    // ã‚‚ã—é€šå¸¸ã®é€£ç¶šç”Ÿæˆã‚’è¶…éã—ãŸã‚‰äºˆç´„ç”Ÿæˆã«åˆ‡ã‚Šæ›¿ãˆã‚‹\n    try {\n      if (\n        checkSameBeforeRequestAndToast(model.name, generationType, \"\") === true\n      ) {\n        logWarn({\n          source: \"GenerationSubmit\",\n          message: \"Blocked: same parameters as previous\",\n        })\n        return\n      }\n\n      if (generationType === \"IMAGE_TO_IMAGE\") {\n        const i2iFileUrl = await (async () => {\n          const viewerToken = tokenData?.viewer?.token\n          if (!viewerToken) {\n            logError({\n              source: \"GenerationSubmit\",\n              message: \"Viewer token missing for IMG2IMG upload\",\n            })\n            toast(\"èªè¨¼ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ãƒ­ã‚°ã‚¤ãƒ³ã—ç›´ã—ã¦ãã ã•ã„ã€‚\")\n            return \"\"\n          }\n\n          logInfo({\n            source: \"GenerationSubmit\",\n            message: \"Uploading IMG2IMG (public)\",\n            details: { size: context.config.i2iImageBase64?.length ?? 0 },\n          })\n          return uploadPublicImage(context.config.i2iImageBase64, viewerToken)\n        })()\n\n        if (i2iFileUrl === \"\") {\n          logError({\n            source: \"GenerationSubmit\",\n            message: \"Upload failed (token missing or upload error)\",\n          })\n          return\n        }\n        logInfo({\n          source: \"GenerationSubmit\",\n          message: \"Upload success\",\n          details: {\n            urlOrigin: (() => {\n              try {\n                return new URL(i2iFileUrl).origin\n              } catch {\n                return undefined\n              }\n            })(),\n          },\n        })\n        await createTaskCore(\n          context.config.generationCount,\n          model.name,\n          generationType,\n          i2iFileUrl,\n        )\n      } else {\n        await createTaskCore(\n          context.config.generationCount,\n          model.name,\n          generationType,\n          \"\",\n        )\n      }\n    } catch (error) {\n      if (error instanceof Error) {\n        logError({\n          source: \"GenerationSubmit\",\n          message: \"onCreateTask threw\",\n          details: { name: error.name, message: error.message },\n        })\n        toast(error.message)\n      }\n    }\n  }\n\n  /**\n   * æœ€å¤§ç”Ÿæˆæšæ•°\n   */\n  const availableImageGenerationMaxTasksCount =\n    queryData.userStatus?.availableImageGenerationMaxTasksCount ?? 10\n\n  /**\n   * ç”Ÿæˆä¸­ã‚³ã‚¹ãƒˆ\n   */\n  const inProgressImageGenerationTasksCost =\n    queryData.userStatus?.inProgressImageGenerationTasksCost ?? 0\n\n  /**\n   * ç”Ÿæˆæ¸ˆã¿ã‚³ã‚¹ãƒˆ\n   */\n  const remainingImageGenerationTasksCount =\n    queryData.userStatus?.remainingImageGenerationTasksCount ?? 0\n\n  /**\n   * åŒæ™‚ç”Ÿæˆæœ€å¤§æšæ•°\n   */\n  const maxTasksCount =\n    queryData.userStatus?.availableConsecutiveImageGenerationsCount ?? 0\n\n  /**\n   * ç”Ÿæˆä¸­ã®æšæ•°\n   */\n  const inProgressImageGenerationTasksCount =\n    queryData.userStatus?.inProgressImageGenerationTasksCount ?? 0\n\n  /**\n   * äºˆç´„ç”Ÿæˆä¸­ã®æšæ•°\n   */\n  const inProgressImageGenerationReservedTasksCount =\n    queryData.userStatus?.inProgressImageGenerationReservedTasksCount ?? 0\n\n  const [searchParams] = useSearchParams()\n\n  const verificationResult = searchParams.get(\"result\")\n\n  const subscription = pass?.viewer?.currentPass?.type\n\n  const isExistedPreviousPass = pass?.viewer?.isExistedPreviousPass\n\n  // ç§»å‹•: createTaskCore ã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã«é…ç½®ï¼ˆã‚¹ã‚³ãƒ¼ãƒ—ä¿®æ­£ï¼‰\n  const createTaskCore = async (\n    taskCount: number,\n    modelName: string,\n    generationType: string,\n    i2iFileUrl: string,\n  ) => {\n    logInfo({\n      source: \"GenerationSubmit\",\n      message: \"createTaskCore start\",\n      details: {\n        taskCount,\n        modelName,\n        generationType,\n        hasI2iFileUrl: i2iFileUrl !== \"\",\n      },\n    })\n    const taskCounts = Array.from({ length: taskCount }, (_, i) => i)\n\n    // ã‚·ãƒ¼ãƒ‰ã‚’è¨­å®šã™ã‚‹ã€é€£ç¶šç”Ÿæˆã®ã¨ãã¯Seedã¯é€£ç•ªã«ã™ã‚‹\n    const seeds: number[] = []\n\n    taskCounts.map((i) => {\n      if (context.config.seed === -1) {\n        seeds.push(-1)\n      } else {\n        seeds.push(context.config.seed + i)\n      }\n    })\n\n    // ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¨­å®šã•ã‚Œã¦ã„ãªã„å ´åˆã¯ãƒ©ãƒ³ãƒ€ãƒ ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä½¿ç”¨ã™ã‚‹\n    const promptsTexts: string[] = []\n\n    taskCounts.map((_i) => {\n      if (context.config.promptText) {\n        promptsTexts.push(context.config.promptText)\n      } else {\n        promptsTexts.push(\n          config.generationFeature.randomPrompts[\n            Math.floor(\n              Math.random() * config.generationFeature.randomPrompts.length,\n            )\n          ],\n        )\n      }\n    })\n\n    const controlNetImageUrl = await getControlNetImageUrl(\n      context.config.controlNetImageBase64,\n    )\n\n    const nowGeneratingCount = inProgressImageGenerationTasksCost // ç”Ÿæˆä¸­æšæ•°\n    const promises = taskCounts.map((i) => {\n      if (i2iFileUrl !== \"\" && i + 1 + nowGeneratingCount > maxTasksCount) {\n        logWarn({\n          source: \"GenerationSubmit\",\n          message: \"Skip one: IMG2IMG beyond maxTasksCount\",\n          details: { index: i, nowGeneratingCount, maxTasksCount },\n        })\n        // i2iã®å ´åˆã¯é€šå¸¸ã®é€£ç¶šç”Ÿæˆã®æšæ•°ã‚’è¶…éã—ã¦ã„ãŸã‚‰ä½•ã‚‚ã—ãªã„\n        return\n      }\n      if (i + 1 + nowGeneratingCount > maxTasksCount) {\n        if (modelName === \"flux.1 schnell\" || modelName === \"flux.1 pro\") {\n          logWarn({\n            source: \"GenerationSubmit\",\n            message: \"Skip reserved: flux does not support reservation\",\n            details: { index: i },\n          })\n          // flux.1ã¯äºˆç´„ç”Ÿæˆã«å¯¾å¿œã—ã¦ã„ãªã„\n          return\n        }\n        logInfo({\n          source: \"GenerationSubmit\",\n          message: \"Create reserved task\",\n          details: { index: i },\n        })\n        createReservedTask({\n          variables: {\n            input: {\n              count: 1,\n              model: modelName,\n              vae: context.config.vae ?? \"\",\n              prompt: context.config.promptText,\n              isPromptGenerationEnabled:\n                context.config.languageUsedForPrompt === \"jp\",\n              negativePrompt: context.config.negativePromptText,\n              seed: seeds[i],\n              steps:\n                context.config.steps >\n                  config.generationFeature.imageGenerationMaxSteps ||\n                context.config.steps < 9\n                  ? config.generationFeature.imageGenerationMaxSteps\n                  : context.config.steps,\n              scale: context.config.scale,\n              sampler: context.config.sampler,\n              clipSkip: context.config.clipSkip,\n              sizeType: context.config\n                .sizeType as IntrospectionEnum<\"ImageGenerationSizeType\">,\n              type: \"TEXT_TO_IMAGE\",\n              controlNetImageUrl: controlNetImageUrl,\n              controlNetWeight: context.config.controlNetWeight\n                ? Number(context.config.controlNetWeight)\n                : null,\n              controlNetModel: context.config.controlNetModel,\n              controlNetModule: context.config.controlNetModule,\n              upscaleSize: context.config.upscaleSize,\n            },\n          },\n        })\n      } else {\n        if (modelName === \"flux.1 schnell\" || modelName === \"flux.1 pro\") {\n          logInfo({\n            source: \"GenerationSubmit\",\n            message: \"Create FLUX task\",\n            details: { index: i, promptLength: promptsTexts[i]?.length ?? 0 },\n          })\n          createFluxTask({\n            variables: {\n              input: {\n                count: 1,\n                prompt: promptsTexts[i],\n                isPromptGenerationEnabled:\n                  context.config.languageUsedForPrompt === \"jp\",\n                negativePrompt: context.config.negativePromptText,\n                seed: seeds[i],\n                steps:\n                  context.config.steps >\n                    config.generationFeature.imageGenerationMaxSteps ||\n                  context.config.steps < 9\n                    ? config.generationFeature.imageGenerationMaxSteps\n                    : context.config.steps,\n                scale: context.config.scale,\n                sizeType: context.config\n                  .sizeType as IntrospectionEnum<\"ImageGenerationSizeType\">,\n                modelName: modelName,\n              },\n            },\n          })\n        } else if (\n          modelName === \"Gemini 2.5\" ||\n          context.config.modelType === \"SD5\" ||\n          context.config.modelType === \"GEMINI\"\n        ) {\n          // Gemini 2.5ãƒ¢ãƒ‡ãƒ«ã€SD5ã‚¿ã‚¤ãƒ—ã€ã¾ãŸã¯GEMINIã‚¿ã‚¤ãƒ—ã®å ´åˆã¯Geminiã‚¿ã‚¹ã‚¯ã¨ã—ã¦ä½œæˆ\n          logInfo({\n            source: \"GenerationSubmit\",\n            message: \"Create Gemini task\",\n            details: {\n              index: i,\n              promptLength: promptsTexts[i]?.length ?? 0,\n              hasImageUrl: Boolean(i2iFileUrl),\n              size: convertToGeminiImageSize(context.config.sizeType),\n            },\n          })\n          createGeminiTask({\n            variables: {\n              input: {\n                prompt: promptsTexts[i],\n                size: convertToGeminiImageSize(context.config.sizeType),\n                imageUrl: i2iFileUrl || null,\n              },\n            },\n          })\n        } else {\n          logInfo({\n            source: \"GenerationSubmit\",\n            message: \"Create SD task\",\n            details: {\n              index: i,\n              promptLength: promptsTexts[i]?.length ?? 0,\n              generationType,\n              hasI2i: i2iFileUrl !== \"\",\n            },\n          })\n          createTask({\n            variables: {\n              input: {\n                count: 1,\n                model: modelName,\n                vae: context.config.vae ?? \"\",\n                prompt: promptsTexts[i],\n                isPromptGenerationEnabled:\n                  context.config.languageUsedForPrompt === \"jp\",\n                negativePrompt: context.config.negativePromptText,\n                seed: seeds[i],\n                steps:\n                  context.config.steps >\n                    config.generationFeature.imageGenerationMaxSteps ||\n                  context.config.steps < 9\n                    ? config.generationFeature.imageGenerationMaxSteps\n                    : context.config.steps,\n                scale: context.config.scale,\n                sampler: context.config.sampler,\n                clipSkip: context.config.clipSkip,\n                sizeType: context.config\n                  .sizeType as IntrospectionEnum<\"ImageGenerationSizeType\">,\n                type: generationType as IntrospectionEnum<\"ImageGenerationType\">,\n                t2tImageUrl: i2iFileUrl,\n                t2tDenoisingStrengthSize:\n                  context.config.i2iDenoisingStrengthSize.toString(),\n                controlNetImageUrl: controlNetImageUrl,\n                controlNetWeight: context.config.controlNetWeight\n                  ? Number(context.config.controlNetWeight)\n                  : null,\n                controlNetModel: context.config.controlNetModel,\n                controlNetModule: context.config.controlNetModule,\n                upscaleSize: context.config.upscaleSize,\n              },\n            },\n          })\n        }\n      }\n    })\n    // ã‚¿ã‚¹ã‚¯ã®ä½œæˆå¾Œã‚‚å‘¼ã³å‡ºã™å¿…è¦ãŒã‚ã‚‹\n    toast(\"ã‚¿ã‚¹ã‚¯ä½œæˆã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ã¾ã—ãŸ\", { position: \"top-center\" })\n    if (typeof window !== \"undefined\") {\n      try {\n        window.dispatchEvent(new CustomEvent(\"generation:task-requested\"))\n      } catch {\n        // noop\n      }\n    }\n    logInfo({ source: \"GenerationSubmit\", message: \"Requested task creations\" })\n    await Promise.all(promises)\n    if (typeof context.user?.nanoid !== \"string\") {\n      logWarn({\n        source: \"GenerationSubmit\",\n        message: \"Missing user nanoid after tasks\",\n      })\n      toast(\"ç”»é¢æ›´æ–°ã—ã¦å†åº¦ãŠè©¦ã—ä¸‹ã•ã„ã€‚\")\n      return\n    }\n  }\n\n  return (\n    <>\n      <AppFixedContent position=\"bottom\">\n        <div className=\"space-y-2\">\n          <GenerationSubmitOperationParts\n            isCreatingTask={isCreatingTask || isSigningTerms}\n            inProgressImageGenerationTasksCount={\n              inProgressImageGenerationTasksCount\n            }\n            inProgressImageGenerationReservedTasksCount={\n              inProgressImageGenerationReservedTasksCount\n            }\n            maxTasksCount={maxTasksCount}\n            tasksCount={\n              inProgressImageGenerationTasksCost +\n              remainingImageGenerationTasksCount\n            }\n            termsText={props.termsText}\n            availableImageGenerationMaxTasksCount={\n              availableImageGenerationMaxTasksCount\n            }\n            onCreateTask={onCreateTask}\n            onSignTerms={onSignTerms}\n          />\n        </div>\n      </AppFixedContent>\n      {subscription === undefined && !isExistedPreviousPass && (\n        <VerificationDialog\n          verificationResult={verificationResult}\n          isOpen={isOpenVerificationModal}\n          onClose={closeVerificationModal}\n        />\n      )}\n    </>\n  )\n}\n\nconst viewerCurrentPassQuery = graphql(\n  `query ViewerCurrentPass {\n    viewer {\n      id\n      currentPass {\n        id\n        type\n      }\n      isExistedPreviousPass\n    }\n  }`,\n)\n\nconst viewerLineUserIdQuery = graphql(\n  `query viewerLineUserId {\n    viewer {\n      id\n      lineUserId\n    }\n  }`,\n)\n\nconst viewerUserQuery = graphql(\n  `query ViewerUser {\n    viewer {\n      id\n      user {\n        id\n        generatedCount\n      }\n    }\n  }`,\n)\n\nconst createImageGenerationTaskReservedMutation = graphql(\n  `mutation CreateReservedImageGenerationTask($input: CreateReservedImageGenerationTaskInput!) {\n    createReservedImageGenerationTask(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst createImageGenerationTaskMutation = graphql(\n  `mutation CreateImageGenerationTask($input: CreateImageGenerationTaskInput!) {\n    createImageGenerationTask(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst createFluxImageGenerationTaskMutation = graphql(\n  `mutation CreateFluxImageGenerationTask($input: CreateFluxImageGenerationTaskInput!) {\n    createFluxImageGenerationTask(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst createGeminiImageGenerationTaskMutation = graphql(\n  `mutation CreateGeminiImageGenerationTask($input: CreateGeminiImageGenerationTaskInput!) {\n    createGeminiImageGenerationTask(input: $input) {\n      id\n      nanoid\n      status\n    }\n  }`,\n)\n\nconst signImageGenerationTermsMutation = graphql(\n  `mutation SignImageGenerationTerms($input: SignImageGenerationTermsInput!) {\n    signImageGenerationTerms(input: $input) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/submission-view/in-painting-setting.tsx"},"span":[1240,1253],"sourceCode":"import { Label } from \"~/components/ui/label\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { Slider } from \"~/components/ui/slider\"\n\ntype Props = {\n  onChangeMaskType(value: string): void\n  onChangeDenoisingStrengthSize(value: string): void\n}\n\nexport function InPaintingSetting (props: Props) {\n  const handleRadioChange = (value: string) => {\n    props.onChangeMaskType(value)\n  }\n  const handleStrengthSizeChange = (\n    event: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    props.onChangeDenoisingStrengthSize(event.target.value)\n  }\n\n  return (\n    <div className=\"flex\">\n      <div className=\"space-y-4\">\n        <div className=\"flex\">\n          <p>{\"ãƒã‚¤ã‚ºé™¤å»å¼·åº¦ï¼š\"}</p>\n          <p>{\"å¼±\"}</p>\n          <Slider\n            onChange={handleStrengthSizeChange}\n            className=\"color-pink w-32\"\n            aria-label=\"slider-ex-2\"\n            max={1}\n            min={0.1}\n            step={0.1}\n            defaultValue={[0.5]}\n          />\n          <p>{\"å¼·\"}</p>\n        </div>\n        <div>\n          <p>{\"ãƒã‚¹ã‚¯æ–¹å¼ï¼š\"}</p>\n          <RadioGroup defaultValue=\"0\">\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"0\")\n                }}\n              >\n                <RadioGroupItem value=\"0\" id=\"r1\" />\n                <Label className=\"color-blue\" htmlFor=\"r1\">\n                  {\"å¡—ã‚Šã¤ã¶ã—\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"1\")\n                }}\n              >\n                <RadioGroupItem value=\"1\" id=\"r2\" />\n                <Label className=\"color-blue\" htmlFor=\"r2\">\n                  {\"ã‚‚ã¨ã«è¿‘ã„\"}\n                </Label>\n              </div>\n            </div>\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"2\")\n                }}\n              >\n                <RadioGroupItem value=\"2\" id=\"r3\" />\n                <Label className=\"color-blue\" htmlFor=\"r3\">\n                  {\"ã‚‚ã¨ã‹ã‚‰å¤§ããå¤‰æ›´\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"3\")\n                }}\n              >\n                <RadioGroupItem value=\"3\" id=\"r4\" />\n                <Label className=\"color-blue\" htmlFor=\"r4\">\n                  {\"ã»ã¼å¤‰ãˆãªã„\"}\n                </Label>\n              </div>\n            </div>\n          </RadioGroup>\n        </div>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/submission-view/in-painting-setting.tsx"},"span":[1699,1712],"sourceCode":"import { Label } from \"~/components/ui/label\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { Slider } from \"~/components/ui/slider\"\n\ntype Props = {\n  onChangeMaskType(value: string): void\n  onChangeDenoisingStrengthSize(value: string): void\n}\n\nexport function InPaintingSetting (props: Props) {\n  const handleRadioChange = (value: string) => {\n    props.onChangeMaskType(value)\n  }\n  const handleStrengthSizeChange = (\n    event: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    props.onChangeDenoisingStrengthSize(event.target.value)\n  }\n\n  return (\n    <div className=\"flex\">\n      <div className=\"space-y-4\">\n        <div className=\"flex\">\n          <p>{\"ãƒã‚¤ã‚ºé™¤å»å¼·åº¦ï¼š\"}</p>\n          <p>{\"å¼±\"}</p>\n          <Slider\n            onChange={handleStrengthSizeChange}\n            className=\"color-pink w-32\"\n            aria-label=\"slider-ex-2\"\n            max={1}\n            min={0.1}\n            step={0.1}\n            defaultValue={[0.5]}\n          />\n          <p>{\"å¼·\"}</p>\n        </div>\n        <div>\n          <p>{\"ãƒã‚¹ã‚¯æ–¹å¼ï¼š\"}</p>\n          <RadioGroup defaultValue=\"0\">\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"0\")\n                }}\n              >\n                <RadioGroupItem value=\"0\" id=\"r1\" />\n                <Label className=\"color-blue\" htmlFor=\"r1\">\n                  {\"å¡—ã‚Šã¤ã¶ã—\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"1\")\n                }}\n              >\n                <RadioGroupItem value=\"1\" id=\"r2\" />\n                <Label className=\"color-blue\" htmlFor=\"r2\">\n                  {\"ã‚‚ã¨ã«è¿‘ã„\"}\n                </Label>\n              </div>\n            </div>\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"2\")\n                }}\n              >\n                <RadioGroupItem value=\"2\" id=\"r3\" />\n                <Label className=\"color-blue\" htmlFor=\"r3\">\n                  {\"ã‚‚ã¨ã‹ã‚‰å¤§ããå¤‰æ›´\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"3\")\n                }}\n              >\n                <RadioGroupItem value=\"3\" id=\"r4\" />\n                <Label className=\"color-blue\" htmlFor=\"r4\">\n                  {\"ã»ã¼å¤‰ãˆãªã„\"}\n                </Label>\n              </div>\n            </div>\n          </RadioGroup>\n        </div>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/submission-view/in-painting-setting.tsx"},"span":[2212,2225],"sourceCode":"import { Label } from \"~/components/ui/label\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { Slider } from \"~/components/ui/slider\"\n\ntype Props = {\n  onChangeMaskType(value: string): void\n  onChangeDenoisingStrengthSize(value: string): void\n}\n\nexport function InPaintingSetting (props: Props) {\n  const handleRadioChange = (value: string) => {\n    props.onChangeMaskType(value)\n  }\n  const handleStrengthSizeChange = (\n    event: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    props.onChangeDenoisingStrengthSize(event.target.value)\n  }\n\n  return (\n    <div className=\"flex\">\n      <div className=\"space-y-4\">\n        <div className=\"flex\">\n          <p>{\"ãƒã‚¤ã‚ºé™¤å»å¼·åº¦ï¼š\"}</p>\n          <p>{\"å¼±\"}</p>\n          <Slider\n            onChange={handleStrengthSizeChange}\n            className=\"color-pink w-32\"\n            aria-label=\"slider-ex-2\"\n            max={1}\n            min={0.1}\n            step={0.1}\n            defaultValue={[0.5]}\n          />\n          <p>{\"å¼·\"}</p>\n        </div>\n        <div>\n          <p>{\"ãƒã‚¹ã‚¯æ–¹å¼ï¼š\"}</p>\n          <RadioGroup defaultValue=\"0\">\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"0\")\n                }}\n              >\n                <RadioGroupItem value=\"0\" id=\"r1\" />\n                <Label className=\"color-blue\" htmlFor=\"r1\">\n                  {\"å¡—ã‚Šã¤ã¶ã—\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"1\")\n                }}\n              >\n                <RadioGroupItem value=\"1\" id=\"r2\" />\n                <Label className=\"color-blue\" htmlFor=\"r2\">\n                  {\"ã‚‚ã¨ã«è¿‘ã„\"}\n                </Label>\n              </div>\n            </div>\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"2\")\n                }}\n              >\n                <RadioGroupItem value=\"2\" id=\"r3\" />\n                <Label className=\"color-blue\" htmlFor=\"r3\">\n                  {\"ã‚‚ã¨ã‹ã‚‰å¤§ããå¤‰æ›´\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"3\")\n                }}\n              >\n                <RadioGroupItem value=\"3\" id=\"r4\" />\n                <Label className=\"color-blue\" htmlFor=\"r4\">\n                  {\"ã»ã¼å¤‰ãˆãªã„\"}\n                </Label>\n              </div>\n            </div>\n          </RadioGroup>\n        </div>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/submission-view/in-painting-setting.tsx"},"span":[2683,2696],"sourceCode":"import { Label } from \"~/components/ui/label\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { Slider } from \"~/components/ui/slider\"\n\ntype Props = {\n  onChangeMaskType(value: string): void\n  onChangeDenoisingStrengthSize(value: string): void\n}\n\nexport function InPaintingSetting (props: Props) {\n  const handleRadioChange = (value: string) => {\n    props.onChangeMaskType(value)\n  }\n  const handleStrengthSizeChange = (\n    event: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    props.onChangeDenoisingStrengthSize(event.target.value)\n  }\n\n  return (\n    <div className=\"flex\">\n      <div className=\"space-y-4\">\n        <div className=\"flex\">\n          <p>{\"ãƒã‚¤ã‚ºé™¤å»å¼·åº¦ï¼š\"}</p>\n          <p>{\"å¼±\"}</p>\n          <Slider\n            onChange={handleStrengthSizeChange}\n            className=\"color-pink w-32\"\n            aria-label=\"slider-ex-2\"\n            max={1}\n            min={0.1}\n            step={0.1}\n            defaultValue={[0.5]}\n          />\n          <p>{\"å¼·\"}</p>\n        </div>\n        <div>\n          <p>{\"ãƒã‚¹ã‚¯æ–¹å¼ï¼š\"}</p>\n          <RadioGroup defaultValue=\"0\">\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"0\")\n                }}\n              >\n                <RadioGroupItem value=\"0\" id=\"r1\" />\n                <Label className=\"color-blue\" htmlFor=\"r1\">\n                  {\"å¡—ã‚Šã¤ã¶ã—\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"1\")\n                }}\n              >\n                <RadioGroupItem value=\"1\" id=\"r2\" />\n                <Label className=\"color-blue\" htmlFor=\"r2\">\n                  {\"ã‚‚ã¨ã«è¿‘ã„\"}\n                </Label>\n              </div>\n            </div>\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"2\")\n                }}\n              >\n                <RadioGroupItem value=\"2\" id=\"r3\" />\n                <Label className=\"color-blue\" htmlFor=\"r3\">\n                  {\"ã‚‚ã¨ã‹ã‚‰å¤§ããå¤‰æ›´\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"3\")\n                }}\n              >\n                <RadioGroupItem value=\"3\" id=\"r4\" />\n                <Label className=\"color-blue\" htmlFor=\"r4\">\n                  {\"ã»ã¼å¤‰ãˆãªã„\"}\n                </Label>\n              </div>\n            </div>\n          </RadioGroup>\n        </div>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/submission-view/in-painting-setting.tsx"},"span":[1451,1487],"sourceCode":"import { Label } from \"~/components/ui/label\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { Slider } from \"~/components/ui/slider\"\n\ntype Props = {\n  onChangeMaskType(value: string): void\n  onChangeDenoisingStrengthSize(value: string): void\n}\n\nexport function InPaintingSetting (props: Props) {\n  const handleRadioChange = (value: string) => {\n    props.onChangeMaskType(value)\n  }\n  const handleStrengthSizeChange = (\n    event: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    props.onChangeDenoisingStrengthSize(event.target.value)\n  }\n\n  return (\n    <div className=\"flex\">\n      <div className=\"space-y-4\">\n        <div className=\"flex\">\n          <p>{\"ãƒã‚¤ã‚ºé™¤å»å¼·åº¦ï¼š\"}</p>\n          <p>{\"å¼±\"}</p>\n          <Slider\n            onChange={handleStrengthSizeChange}\n            className=\"color-pink w-32\"\n            aria-label=\"slider-ex-2\"\n            max={1}\n            min={0.1}\n            step={0.1}\n            defaultValue={[0.5]}\n          />\n          <p>{\"å¼·\"}</p>\n        </div>\n        <div>\n          <p>{\"ãƒã‚¹ã‚¯æ–¹å¼ï¼š\"}</p>\n          <RadioGroup defaultValue=\"0\">\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"0\")\n                }}\n              >\n                <RadioGroupItem value=\"0\" id=\"r1\" />\n                <Label className=\"color-blue\" htmlFor=\"r1\">\n                  {\"å¡—ã‚Šã¤ã¶ã—\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"1\")\n                }}\n              >\n                <RadioGroupItem value=\"1\" id=\"r2\" />\n                <Label className=\"color-blue\" htmlFor=\"r2\">\n                  {\"ã‚‚ã¨ã«è¿‘ã„\"}\n                </Label>\n              </div>\n            </div>\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"2\")\n                }}\n              >\n                <RadioGroupItem value=\"2\" id=\"r3\" />\n                <Label className=\"color-blue\" htmlFor=\"r3\">\n                  {\"ã‚‚ã¨ã‹ã‚‰å¤§ããå¤‰æ›´\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"3\")\n                }}\n              >\n                <RadioGroupItem value=\"3\" id=\"r4\" />\n                <Label className=\"color-blue\" htmlFor=\"r4\">\n                  {\"ã»ã¼å¤‰ãˆãªã„\"}\n                </Label>\n              </div>\n            </div>\n          </RadioGroup>\n        </div>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/submission-view/in-painting-setting.tsx"},"span":[1910,1946],"sourceCode":"import { Label } from \"~/components/ui/label\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { Slider } from \"~/components/ui/slider\"\n\ntype Props = {\n  onChangeMaskType(value: string): void\n  onChangeDenoisingStrengthSize(value: string): void\n}\n\nexport function InPaintingSetting (props: Props) {\n  const handleRadioChange = (value: string) => {\n    props.onChangeMaskType(value)\n  }\n  const handleStrengthSizeChange = (\n    event: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    props.onChangeDenoisingStrengthSize(event.target.value)\n  }\n\n  return (\n    <div className=\"flex\">\n      <div className=\"space-y-4\">\n        <div className=\"flex\">\n          <p>{\"ãƒã‚¤ã‚ºé™¤å»å¼·åº¦ï¼š\"}</p>\n          <p>{\"å¼±\"}</p>\n          <Slider\n            onChange={handleStrengthSizeChange}\n            className=\"color-pink w-32\"\n            aria-label=\"slider-ex-2\"\n            max={1}\n            min={0.1}\n            step={0.1}\n            defaultValue={[0.5]}\n          />\n          <p>{\"å¼·\"}</p>\n        </div>\n        <div>\n          <p>{\"ãƒã‚¹ã‚¯æ–¹å¼ï¼š\"}</p>\n          <RadioGroup defaultValue=\"0\">\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"0\")\n                }}\n              >\n                <RadioGroupItem value=\"0\" id=\"r1\" />\n                <Label className=\"color-blue\" htmlFor=\"r1\">\n                  {\"å¡—ã‚Šã¤ã¶ã—\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"1\")\n                }}\n              >\n                <RadioGroupItem value=\"1\" id=\"r2\" />\n                <Label className=\"color-blue\" htmlFor=\"r2\">\n                  {\"ã‚‚ã¨ã«è¿‘ã„\"}\n                </Label>\n              </div>\n            </div>\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"2\")\n                }}\n              >\n                <RadioGroupItem value=\"2\" id=\"r3\" />\n                <Label className=\"color-blue\" htmlFor=\"r3\">\n                  {\"ã‚‚ã¨ã‹ã‚‰å¤§ããå¤‰æ›´\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"3\")\n                }}\n              >\n                <RadioGroupItem value=\"3\" id=\"r4\" />\n                <Label className=\"color-blue\" htmlFor=\"r4\">\n                  {\"ã»ã¼å¤‰ãˆãªã„\"}\n                </Label>\n              </div>\n            </div>\n          </RadioGroup>\n        </div>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/submission-view/in-painting-setting.tsx"},"span":[2423,2459],"sourceCode":"import { Label } from \"~/components/ui/label\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { Slider } from \"~/components/ui/slider\"\n\ntype Props = {\n  onChangeMaskType(value: string): void\n  onChangeDenoisingStrengthSize(value: string): void\n}\n\nexport function InPaintingSetting (props: Props) {\n  const handleRadioChange = (value: string) => {\n    props.onChangeMaskType(value)\n  }\n  const handleStrengthSizeChange = (\n    event: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    props.onChangeDenoisingStrengthSize(event.target.value)\n  }\n\n  return (\n    <div className=\"flex\">\n      <div className=\"space-y-4\">\n        <div className=\"flex\">\n          <p>{\"ãƒã‚¤ã‚ºé™¤å»å¼·åº¦ï¼š\"}</p>\n          <p>{\"å¼±\"}</p>\n          <Slider\n            onChange={handleStrengthSizeChange}\n            className=\"color-pink w-32\"\n            aria-label=\"slider-ex-2\"\n            max={1}\n            min={0.1}\n            step={0.1}\n            defaultValue={[0.5]}\n          />\n          <p>{\"å¼·\"}</p>\n        </div>\n        <div>\n          <p>{\"ãƒã‚¹ã‚¯æ–¹å¼ï¼š\"}</p>\n          <RadioGroup defaultValue=\"0\">\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"0\")\n                }}\n              >\n                <RadioGroupItem value=\"0\" id=\"r1\" />\n                <Label className=\"color-blue\" htmlFor=\"r1\">\n                  {\"å¡—ã‚Šã¤ã¶ã—\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"1\")\n                }}\n              >\n                <RadioGroupItem value=\"1\" id=\"r2\" />\n                <Label className=\"color-blue\" htmlFor=\"r2\">\n                  {\"ã‚‚ã¨ã«è¿‘ã„\"}\n                </Label>\n              </div>\n            </div>\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"2\")\n                }}\n              >\n                <RadioGroupItem value=\"2\" id=\"r3\" />\n                <Label className=\"color-blue\" htmlFor=\"r3\">\n                  {\"ã‚‚ã¨ã‹ã‚‰å¤§ããå¤‰æ›´\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"3\")\n                }}\n              >\n                <RadioGroupItem value=\"3\" id=\"r4\" />\n                <Label className=\"color-blue\" htmlFor=\"r4\">\n                  {\"ã»ã¼å¤‰ãˆãªã„\"}\n                </Label>\n              </div>\n            </div>\n          </RadioGroup>\n        </div>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/submission-view/in-painting-setting.tsx"},"span":[2894,2930],"sourceCode":"import { Label } from \"~/components/ui/label\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { Slider } from \"~/components/ui/slider\"\n\ntype Props = {\n  onChangeMaskType(value: string): void\n  onChangeDenoisingStrengthSize(value: string): void\n}\n\nexport function InPaintingSetting (props: Props) {\n  const handleRadioChange = (value: string) => {\n    props.onChangeMaskType(value)\n  }\n  const handleStrengthSizeChange = (\n    event: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    props.onChangeDenoisingStrengthSize(event.target.value)\n  }\n\n  return (\n    <div className=\"flex\">\n      <div className=\"space-y-4\">\n        <div className=\"flex\">\n          <p>{\"ãƒã‚¤ã‚ºé™¤å»å¼·åº¦ï¼š\"}</p>\n          <p>{\"å¼±\"}</p>\n          <Slider\n            onChange={handleStrengthSizeChange}\n            className=\"color-pink w-32\"\n            aria-label=\"slider-ex-2\"\n            max={1}\n            min={0.1}\n            step={0.1}\n            defaultValue={[0.5]}\n          />\n          <p>{\"å¼·\"}</p>\n        </div>\n        <div>\n          <p>{\"ãƒã‚¹ã‚¯æ–¹å¼ï¼š\"}</p>\n          <RadioGroup defaultValue=\"0\">\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"0\")\n                }}\n              >\n                <RadioGroupItem value=\"0\" id=\"r1\" />\n                <Label className=\"color-blue\" htmlFor=\"r1\">\n                  {\"å¡—ã‚Šã¤ã¶ã—\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"1\")\n                }}\n              >\n                <RadioGroupItem value=\"1\" id=\"r2\" />\n                <Label className=\"color-blue\" htmlFor=\"r2\">\n                  {\"ã‚‚ã¨ã«è¿‘ã„\"}\n                </Label>\n              </div>\n            </div>\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"2\")\n                }}\n              >\n                <RadioGroupItem value=\"2\" id=\"r3\" />\n                <Label className=\"color-blue\" htmlFor=\"r3\">\n                  {\"ã‚‚ã¨ã‹ã‚‰å¤§ããå¤‰æ›´\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"3\")\n                }}\n              >\n                <RadioGroupItem value=\"3\" id=\"r4\" />\n                <Label className=\"color-blue\" htmlFor=\"r4\">\n                  {\"ã»ã¼å¤‰ãˆãªã„\"}\n                </Label>\n              </div>\n            </div>\n          </RadioGroup>\n        </div>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/task-view/generation-message-input.tsx"},"span":[1115,1128],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Textarea } from \"~/components/ui/textarea\"\nimport { RiCloseCircleLine } from \"@remixicon/react\"\nimport { Send } from \"lucide-react\"\nimport { useState } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  isLoading: boolean\n  onSubmit(message: string): void\n}\n\nexport function GenerationMessageInput (props: Props) {\n  const [message, setMessage] = useState(\"\")\n  const [selectedImages, setSelectedImages] = useState<string[]>([])\n  const t = useTranslation()\n\n  const handleSubmit = () => {\n    props.onSubmit(message)\n    setSelectedImages([])\n    setMessage(\"\")\n  }\n\n  const isSendButtonEnabled = message.trim() !== \"\" || selectedImages.length > 0\n\n  const handleDeleteImage = (index: number) => {\n    const updatedImages = [...selectedImages]\n    updatedImages.splice(index, 1)\n    setSelectedImages(updatedImages)\n  }\n\n  return (\n    <div className=\"sticky bottom-16 flex w-full items-end gap-x-4 p-4 md:bottom-0\">\n      {selectedImages.map((image, index) => (\n        // biome-ignore lint/suspicious/noArrayIndexKey: <explanation>\n        <div key={index} className=\"relative\">\n          <img src={image} alt={`Selected ${index}`} />\n          <RiCloseCircleLine\n            className=\"absolute top-2 right-2 flex size-8 cursor-pointer items-center justify-center\"\n            onClick={() => handleDeleteImage(index)}\n          />\n        </div>\n      ))}\n      <Textarea\n        className=\"h-auto resize-none rounded-md border p-2\"\n        placeholder={t(\n          \"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\",\n          \"Please enter a message\",\n        )}\n        value={message}\n        onChange={(event) => setMessage(event.target.value)}\n      />\n      {/* ã¾ã ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å‡¦ç†ãŒçµ‚ãˆã¦ã„ãªã„ã®ã§ã€disabled */}\n      {/* <Button disabled onClick={handleButtonClick} size={\"icon\"}>\n        <div className=\"flex justify-center items-center\">\n          <ArrowUpFromLine />\n          <Input\n            ref={fileInputRef}\n            className=\"hidden\"\n            id=\"imageUpload\"\n            type=\"file\"\n            multiple={true}\n            accept=\"image/*\"\n            onChange={handleFileChange}\n          />\n        </div>\n      </Button> */}\n      {/* é€ä¿¡ãƒœã‚¿ãƒ³ */}\n      <div>\n        <Button\n          disabled={!isSendButtonEnabled || props.isLoading}\n          onClick={handleSubmit}\n          size={\"icon\"}\n        >\n          <Send className=\"w-4\" />\n        </Button>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/task-view/star-rating.tsx"},"span":[1895,1908],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport { Loader2Icon, StarIcon } from \"lucide-react\"\nimport { useCallback, useEffect, useRef } from \"react\"\n\ntype Props = {\n  value: number\n  className?: string\n  disabled?: boolean\n  isLoading?: boolean\n  onChange(value: number): void\n}\n\n/**\n * ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°\n */\nexport function StarRating (props: Props) {\n  const starOneRef = useRef<HTMLButtonElement>(null)\n  const starTwoRef = useRef<HTMLButtonElement>(null)\n  const starThreeRef = useRef<HTMLButtonElement>(null)\n  const starFourRef = useRef<HTMLButtonElement>(null)\n  const starFiveRef = useRef<HTMLButtonElement>(null)\n\n  /**\n   * ã‚­ãƒ¼å…¥åŠ›ã§ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å¤‰æ›´ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹\n   */\n  const handleNumberKeyDown = useCallback((event: KeyboardEvent) => {\n    const tagName = document.activeElement?.tagName.toLowerCase()\n    if (tagName === \"input\" || tagName === \"textarea\") {\n      return\n    }\n\n    switch (event.keyCode) {\n      case 49: // Key '1'\n        starOneRef.current?.click()\n        break\n      case 50: // Key '2'\n        starTwoRef.current?.click()\n        break\n      case 51: // Key '3'\n        starThreeRef.current?.click()\n        break\n      case 52: // Key '4'\n        starFourRef.current?.click()\n        break\n      case 53: // Key '5'\n        starFiveRef.current?.click()\n        break\n      default:\n        break\n    }\n  }, [])\n\n  useEffect(() => {\n    if (typeof document !== \"undefined\") {\n      document.addEventListener(\"keydown\", handleNumberKeyDown, false)\n      return () => {\n        document.removeEventListener(\"keydown\", handleNumberKeyDown)\n      }\n    }\n  }, [])\n\n  return (\n    <div className={props.className}>\n      {[starOneRef, starTwoRef, starThreeRef, starFourRef, starFiveRef].map(\n        (ref, index) => (\n          <Button\n            // biome-ignore lint/suspicious/noArrayIndexKey: <explanation>\n            key={index}\n            ref={ref}\n            disabled={props.disabled}\n            aria-label={`ãŠæ°—ã«å…¥ã‚Š ${index + 1}`}\n            size=\"icon\"\n            variant=\"ghost\"\n            onClick={() => {\n              const newRating = index + 1\n              props.onChange(props.value === newRating ? 0 : newRating)\n            }}\n          >\n            {props.isLoading ? (\n              <Loader2Icon className=\"size-6 animate-spin\" />\n            ) : (\n              <StarIcon\n                className={cn(props.value > index && \"fill-yellow-500\")}\n              />\n            )}\n          </Button>\n        ),\n      )}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable send is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"send"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation.demonstration/components/config-view/generation-demo-config-view.tsx"},"span":[1308,1312],"sourceCode":"import { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { GenerationConfigSize } from \"~/routes/($lang).generation._index/components/config-view/generation-config-size\"\nimport { GenerationViewCard } from \"~/routes/($lang).generation._index/components/generation-view-card\"\nimport { GenerationConfigContext } from \"~/routes/($lang).generation._index/contexts/generation-config-context\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { useGenerationQuery } from \"~/routes/($lang).generation._index/hooks/use-generation-query\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { useEffect, useState } from \"react\"\nimport { useContext } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * ã‚¨ãƒ‡ã‚£ã‚¿ã®è¨­å®š\n * ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã‚ˆã‚Šè¨­å®šå†…å®¹ãŒä¿å­˜ã•ã‚Œã¦ã€å¾©å…ƒã•ã‚Œã‚‹ã®ã§ã‚µãƒ¼ãƒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã¨\n * ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®ä¸ä¸€è‡´ã‚’è§£æ±ºã™ã‚‹ãŸã‚é…å»¶ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§æœ¬ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’èª­ã¿è¾¼ã‚€ã“ã¨\n */\nexport function GenerationDemoConfigView () {\n  const context = useGenerationContext()\n\n  const queryData = useGenerationQuery()\n\n  const { send } = GenerationConfigContext.useActorRef()\n\n  const authContext = useContext(AuthContext)\n\n  const [_showMemoSetting, _setShowMemoSetting] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ãƒ¢ãƒ‡ãƒ«\n   */\n  const currentModel = context.imageModels.find((model) => {\n    return model.id === context.config.modelId\n  })\n\n  /**\n   * ãŠæ°—ã«å…¥ã‚Šã®ãƒ¢ãƒ‡ãƒ«\n   */\n  const { data: userSetting, refetch: refetchSetting } = useQuery(\n    userSettingQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * ãƒ¢ãƒ‡ãƒ«ã®ç¨®é¡\n   * SD1ãªã©\n   */\n  const configModelType = currentModel?.type ?? \"SD1\"\n\n  /**\n   * ãƒ¡ãƒ¢ä¸€è¦§\n   */\n  const { data: memos, refetch } = useQuery(\n    viewerCurrentImageGenerationMemosQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * ãŠæ°—ã«å…¥ã‚Šã®ãƒ¢ãƒ‡ãƒ«ä¸€è¦§\n   */\n  const { data: favoritedModels } = useQuery(\n    viewerFavoritedImageGenerationModelsQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * æœ€å¤§ç”Ÿæˆæšæ•°\n   */\n  const _availableImageGenerationMaxTasksCount =\n    queryData.userStatus?.availableImageGenerationMaxTasksCount ?? 10\n\n  const _inProgressImageGenerationTasksCost =\n    queryData.userStatus?.inProgressImageGenerationTasksCost ?? 0\n\n  const _remainingImageGenerationTasksCount =\n    queryData.userStatus?.remainingImageGenerationTasksCount ?? 0\n\n  useEffect(() => {\n    if (authContext.isLoading) return\n    if (authContext.isNotLoggedIn) return\n    if (favoritedModels === undefined) return\n    const favoritedModelIds =\n      favoritedModels.viewer?.favoritedImageGenerationModels.map((model) =>\n        Number(model.id),\n      ) ?? []\n    context.updateFavoriteModelIds(favoritedModelIds)\n  }, [favoritedModels])\n\n  useEffect(() => {\n    // åˆæœŸåŒ–\n    context.resetForInit()\n  }, [])\n\n  const _t = useTranslation()\n\n  // modelsã«ã¤ã„ã¦fluxã¨ã„ã†åå‰ã®ãƒ¢ãƒ‡ãƒ«ã§çµã‚‹\n  const _fluxModels = context.imageModels.filter((model) => {\n    // model.nameãŒfluxã‚’å«ã‚€ã‹ã©ã†ã‹\n    return model.name.includes(\"flux.1 schnell\")\n  })\n\n  return (\n    <GenerationViewCard>\n      <ScrollArea type=\"always\">\n        <div className={\"flex flex-col gap-y-4 px-0 md:px-4\"}>\n          {/* <GenerationConfigModels\n            models={fluxModels}\n            favoritedModelIds={context.config.favoriteModelIds}\n            currentModelId={\"706\"}\n            currentModelIds={[\"706\"]}\n            onSelectModelId={(id: string, type: string, prompt: string) => {\n              if (context.config.isUseRecommendedPrompt) {\n                if (prompt === \"\") {\n                  context.updateModelIdAndPrompt(\n                    id,\n                    type,\n                    config.generationFeature.defaultPromptValue,\n                  )\n                } else {\n                  context.updateModelIdAndPrompt(id, type, prompt)\n                }\n              } else {\n                context.updateModelId(id, type)\n              }\n            }}\n            onClickSearchModelWorks={(id: string, name: string) => {\n              context.updateSearchWorksModelIdAndName(id, name)\n              send({ type: \"OPEN_WORKS_FROM_MODEL\" })\n            }}\n          /> */}\n          {/* <Separator /> */}\n          {/* <GenerationConfigCount\n            availableImageGenerationMaxTasksCount={\n              availableImageGenerationMaxTasksCount\n            }\n            tasksCount={\n              inProgressImageGenerationTasksCost +\n              remainingImageGenerationTasksCount\n            }\n            setGenerationCount={context.changeGenerationCount}\n            generationCount={context.config.generationCount}\n          /> */}\n          <GenerationConfigSize\n            modelType={configModelType}\n            value={context.config.sizeType}\n            onChange={context.updateSizeType}\n          />\n          {/* <GenerationConfigUpscale /> */}\n          {/* <Separator />\n          <GenerationConfigI2i />\n          <Separator />\n          <GenerationConfigControlNet />\n          <Separator /> */}\n          {/* <GenerationConfigSeed\n            value={context.config.seed}\n            onChange={context.updateSeed}\n          />\n          <Separator />\n          <Accordion type=\"single\" collapsible>\n            <AccordionItem value=\"setting\">\n              <AccordionTrigger>\n                <div className=\"text-left\">\n                  <p>{t(\"è©³ç´°è¨­å®š\", \"Detailed settings\")}</p>\n                  <p className=\"text-sm opacity-40\">\n                    Scale:{context.config.scale}, Steps:{context.config.steps},\n                    Sampler:{context.config.sampler}, Vae:{context.config.vae}\n                  </p>\n                </div>\n              </AccordionTrigger>\n              <AccordionContent className=\"space-y-2\">\n                <GenerationConfigScale\n                  value={context.config.scale}\n                  onChange={context.updateScale}\n                />\n                <GenerationConfigStep\n                  value={context.config.steps}\n                  onChange={context.updateSteps}\n                />\n                <GenerationConfigSampler\n                  value={context.config.sampler}\n                  onChange={context.updateSampler}\n                />\n                <GenerationConfigClipSkip\n                  value={context.config.clipSkip}\n                  onChange={context.updateClipSkip}\n                />\n                <GenerationConfigVae\n                  value={context.config.vae ?? \"\"}\n                  onChange={context.updateVae}\n                />\n              </AccordionContent>\n            </AccordionItem>\n          </Accordion> */}\n        </div>\n      </ScrollArea>\n      {/* <div className=\"bottom-0 bg-card p-4 lg:sticky\">\n        <div className=\"flex gap-x-2\">\n          <GenerationConfigMemoButton\n            onClick={() => {\n              setShowMemoSetting(true)\n            }}\n          />\n          <GenerationConfigMemoSettingDialog\n            memos={\n              memos?.viewer?.currentImageGenerationMemos.map((memo) => ({\n                ...memo,\n                model: {\n                  ...memo.model,\n                  recommendedPrompt: \"\",\n                },\n              })) ?? []\n            }\n            refetch={refetch}\n            onClose={() => {\n              setShowMemoSetting(false)\n            }}\n            isOpen={showMemoSetting}\n          />\n          <GenerationConfigResetConfirmDialog onReset={context.reset} />\n        </div>\n      </div> */}\n    </GenerationViewCard>\n  )\n}\n\nconst userSettingQuery = graphql(\n  `query UserSetting {\n    userSetting {\n      userId\n      favoritedImageGenerationModelIds\n      preferenceRating\n      featurePromptonRequest\n      isNotifyComment\n    }\n  }`,\n)\n\nconst viewerCurrentImageGenerationMemosQuery = graphql(\n  `query ViewerCurrentImageGenerationMemos {\n    viewer {\n      id\n      currentImageGenerationMemos {\n        id\n        nanoid\n        userId\n        title\n        explanation\n        prompts\n        negativePrompts\n        sampler\n        model {\n          id\n          name\n          type\n        }\n        vae\n        seed\n        steps\n        scale\n        clipSkip\n        width\n        height\n        isDeleted\n        createdAt\n      }\n    }\n  }`,\n)\n\nconst viewerFavoritedImageGenerationModelsQuery = graphql(\n  `query ViewerFavoritedImageGenerationModels {\n    viewer {\n      id\n      favoritedImageGenerationModels {\n        id\n        name\n        type\n      }\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable userSetting is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"userSetting"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation.demonstration/components/config-view/generation-demo-config-view.tsx"},"span":[1684,1695],"sourceCode":"import { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { GenerationConfigSize } from \"~/routes/($lang).generation._index/components/config-view/generation-config-size\"\nimport { GenerationViewCard } from \"~/routes/($lang).generation._index/components/generation-view-card\"\nimport { GenerationConfigContext } from \"~/routes/($lang).generation._index/contexts/generation-config-context\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { useGenerationQuery } from \"~/routes/($lang).generation._index/hooks/use-generation-query\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { useEffect, useState } from \"react\"\nimport { useContext } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * ã‚¨ãƒ‡ã‚£ã‚¿ã®è¨­å®š\n * ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã‚ˆã‚Šè¨­å®šå†…å®¹ãŒä¿å­˜ã•ã‚Œã¦ã€å¾©å…ƒã•ã‚Œã‚‹ã®ã§ã‚µãƒ¼ãƒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã¨\n * ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®ä¸ä¸€è‡´ã‚’è§£æ±ºã™ã‚‹ãŸã‚é…å»¶ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§æœ¬ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’èª­ã¿è¾¼ã‚€ã“ã¨\n */\nexport function GenerationDemoConfigView () {\n  const context = useGenerationContext()\n\n  const queryData = useGenerationQuery()\n\n  const { send } = GenerationConfigContext.useActorRef()\n\n  const authContext = useContext(AuthContext)\n\n  const [_showMemoSetting, _setShowMemoSetting] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ãƒ¢ãƒ‡ãƒ«\n   */\n  const currentModel = context.imageModels.find((model) => {\n    return model.id === context.config.modelId\n  })\n\n  /**\n   * ãŠæ°—ã«å…¥ã‚Šã®ãƒ¢ãƒ‡ãƒ«\n   */\n  const { data: userSetting, refetch: refetchSetting } = useQuery(\n    userSettingQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * ãƒ¢ãƒ‡ãƒ«ã®ç¨®é¡\n   * SD1ãªã©\n   */\n  const configModelType = currentModel?.type ?? \"SD1\"\n\n  /**\n   * ãƒ¡ãƒ¢ä¸€è¦§\n   */\n  const { data: memos, refetch } = useQuery(\n    viewerCurrentImageGenerationMemosQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * ãŠæ°—ã«å…¥ã‚Šã®ãƒ¢ãƒ‡ãƒ«ä¸€è¦§\n   */\n  const { data: favoritedModels } = useQuery(\n    viewerFavoritedImageGenerationModelsQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * æœ€å¤§ç”Ÿæˆæšæ•°\n   */\n  const _availableImageGenerationMaxTasksCount =\n    queryData.userStatus?.availableImageGenerationMaxTasksCount ?? 10\n\n  const _inProgressImageGenerationTasksCost =\n    queryData.userStatus?.inProgressImageGenerationTasksCost ?? 0\n\n  const _remainingImageGenerationTasksCount =\n    queryData.userStatus?.remainingImageGenerationTasksCount ?? 0\n\n  useEffect(() => {\n    if (authContext.isLoading) return\n    if (authContext.isNotLoggedIn) return\n    if (favoritedModels === undefined) return\n    const favoritedModelIds =\n      favoritedModels.viewer?.favoritedImageGenerationModels.map((model) =>\n        Number(model.id),\n      ) ?? []\n    context.updateFavoriteModelIds(favoritedModelIds)\n  }, [favoritedModels])\n\n  useEffect(() => {\n    // åˆæœŸåŒ–\n    context.resetForInit()\n  }, [])\n\n  const _t = useTranslation()\n\n  // modelsã«ã¤ã„ã¦fluxã¨ã„ã†åå‰ã®ãƒ¢ãƒ‡ãƒ«ã§çµã‚‹\n  const _fluxModels = context.imageModels.filter((model) => {\n    // model.nameãŒfluxã‚’å«ã‚€ã‹ã©ã†ã‹\n    return model.name.includes(\"flux.1 schnell\")\n  })\n\n  return (\n    <GenerationViewCard>\n      <ScrollArea type=\"always\">\n        <div className={\"flex flex-col gap-y-4 px-0 md:px-4\"}>\n          {/* <GenerationConfigModels\n            models={fluxModels}\n            favoritedModelIds={context.config.favoriteModelIds}\n            currentModelId={\"706\"}\n            currentModelIds={[\"706\"]}\n            onSelectModelId={(id: string, type: string, prompt: string) => {\n              if (context.config.isUseRecommendedPrompt) {\n                if (prompt === \"\") {\n                  context.updateModelIdAndPrompt(\n                    id,\n                    type,\n                    config.generationFeature.defaultPromptValue,\n                  )\n                } else {\n                  context.updateModelIdAndPrompt(id, type, prompt)\n                }\n              } else {\n                context.updateModelId(id, type)\n              }\n            }}\n            onClickSearchModelWorks={(id: string, name: string) => {\n              context.updateSearchWorksModelIdAndName(id, name)\n              send({ type: \"OPEN_WORKS_FROM_MODEL\" })\n            }}\n          /> */}\n          {/* <Separator /> */}\n          {/* <GenerationConfigCount\n            availableImageGenerationMaxTasksCount={\n              availableImageGenerationMaxTasksCount\n            }\n            tasksCount={\n              inProgressImageGenerationTasksCost +\n              remainingImageGenerationTasksCount\n            }\n            setGenerationCount={context.changeGenerationCount}\n            generationCount={context.config.generationCount}\n          /> */}\n          <GenerationConfigSize\n            modelType={configModelType}\n            value={context.config.sizeType}\n            onChange={context.updateSizeType}\n          />\n          {/* <GenerationConfigUpscale /> */}\n          {/* <Separator />\n          <GenerationConfigI2i />\n          <Separator />\n          <GenerationConfigControlNet />\n          <Separator /> */}\n          {/* <GenerationConfigSeed\n            value={context.config.seed}\n            onChange={context.updateSeed}\n          />\n          <Separator />\n          <Accordion type=\"single\" collapsible>\n            <AccordionItem value=\"setting\">\n              <AccordionTrigger>\n                <div className=\"text-left\">\n                  <p>{t(\"è©³ç´°è¨­å®š\", \"Detailed settings\")}</p>\n                  <p className=\"text-sm opacity-40\">\n                    Scale:{context.config.scale}, Steps:{context.config.steps},\n                    Sampler:{context.config.sampler}, Vae:{context.config.vae}\n                  </p>\n                </div>\n              </AccordionTrigger>\n              <AccordionContent className=\"space-y-2\">\n                <GenerationConfigScale\n                  value={context.config.scale}\n                  onChange={context.updateScale}\n                />\n                <GenerationConfigStep\n                  value={context.config.steps}\n                  onChange={context.updateSteps}\n                />\n                <GenerationConfigSampler\n                  value={context.config.sampler}\n                  onChange={context.updateSampler}\n                />\n                <GenerationConfigClipSkip\n                  value={context.config.clipSkip}\n                  onChange={context.updateClipSkip}\n                />\n                <GenerationConfigVae\n                  value={context.config.vae ?? \"\"}\n                  onChange={context.updateVae}\n                />\n              </AccordionContent>\n            </AccordionItem>\n          </Accordion> */}\n        </div>\n      </ScrollArea>\n      {/* <div className=\"bottom-0 bg-card p-4 lg:sticky\">\n        <div className=\"flex gap-x-2\">\n          <GenerationConfigMemoButton\n            onClick={() => {\n              setShowMemoSetting(true)\n            }}\n          />\n          <GenerationConfigMemoSettingDialog\n            memos={\n              memos?.viewer?.currentImageGenerationMemos.map((memo) => ({\n                ...memo,\n                model: {\n                  ...memo.model,\n                  recommendedPrompt: \"\",\n                },\n              })) ?? []\n            }\n            refetch={refetch}\n            onClose={() => {\n              setShowMemoSetting(false)\n            }}\n            isOpen={showMemoSetting}\n          />\n          <GenerationConfigResetConfirmDialog onReset={context.reset} />\n        </div>\n      </div> */}\n    </GenerationViewCard>\n  )\n}\n\nconst userSettingQuery = graphql(\n  `query UserSetting {\n    userSetting {\n      userId\n      favoritedImageGenerationModelIds\n      preferenceRating\n      featurePromptonRequest\n      isNotifyComment\n    }\n  }`,\n)\n\nconst viewerCurrentImageGenerationMemosQuery = graphql(\n  `query ViewerCurrentImageGenerationMemos {\n    viewer {\n      id\n      currentImageGenerationMemos {\n        id\n        nanoid\n        userId\n        title\n        explanation\n        prompts\n        negativePrompts\n        sampler\n        model {\n          id\n          name\n          type\n        }\n        vae\n        seed\n        steps\n        scale\n        clipSkip\n        width\n        height\n        isDeleted\n        createdAt\n      }\n    }\n  }`,\n)\n\nconst viewerFavoritedImageGenerationModelsQuery = graphql(\n  `query ViewerFavoritedImageGenerationModels {\n    viewer {\n      id\n      favoritedImageGenerationModels {\n        id\n        name\n        type\n      }\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable refetchSetting is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"refetchSetting"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation.demonstration/components/config-view/generation-demo-config-view.tsx"},"span":[1706,1720],"sourceCode":"import { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { GenerationConfigSize } from \"~/routes/($lang).generation._index/components/config-view/generation-config-size\"\nimport { GenerationViewCard } from \"~/routes/($lang).generation._index/components/generation-view-card\"\nimport { GenerationConfigContext } from \"~/routes/($lang).generation._index/contexts/generation-config-context\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { useGenerationQuery } from \"~/routes/($lang).generation._index/hooks/use-generation-query\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { useEffect, useState } from \"react\"\nimport { useContext } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * ã‚¨ãƒ‡ã‚£ã‚¿ã®è¨­å®š\n * ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã‚ˆã‚Šè¨­å®šå†…å®¹ãŒä¿å­˜ã•ã‚Œã¦ã€å¾©å…ƒã•ã‚Œã‚‹ã®ã§ã‚µãƒ¼ãƒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã¨\n * ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®ä¸ä¸€è‡´ã‚’è§£æ±ºã™ã‚‹ãŸã‚é…å»¶ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§æœ¬ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’èª­ã¿è¾¼ã‚€ã“ã¨\n */\nexport function GenerationDemoConfigView () {\n  const context = useGenerationContext()\n\n  const queryData = useGenerationQuery()\n\n  const { send } = GenerationConfigContext.useActorRef()\n\n  const authContext = useContext(AuthContext)\n\n  const [_showMemoSetting, _setShowMemoSetting] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ãƒ¢ãƒ‡ãƒ«\n   */\n  const currentModel = context.imageModels.find((model) => {\n    return model.id === context.config.modelId\n  })\n\n  /**\n   * ãŠæ°—ã«å…¥ã‚Šã®ãƒ¢ãƒ‡ãƒ«\n   */\n  const { data: userSetting, refetch: refetchSetting } = useQuery(\n    userSettingQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * ãƒ¢ãƒ‡ãƒ«ã®ç¨®é¡\n   * SD1ãªã©\n   */\n  const configModelType = currentModel?.type ?? \"SD1\"\n\n  /**\n   * ãƒ¡ãƒ¢ä¸€è¦§\n   */\n  const { data: memos, refetch } = useQuery(\n    viewerCurrentImageGenerationMemosQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * ãŠæ°—ã«å…¥ã‚Šã®ãƒ¢ãƒ‡ãƒ«ä¸€è¦§\n   */\n  const { data: favoritedModels } = useQuery(\n    viewerFavoritedImageGenerationModelsQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * æœ€å¤§ç”Ÿæˆæšæ•°\n   */\n  const _availableImageGenerationMaxTasksCount =\n    queryData.userStatus?.availableImageGenerationMaxTasksCount ?? 10\n\n  const _inProgressImageGenerationTasksCost =\n    queryData.userStatus?.inProgressImageGenerationTasksCost ?? 0\n\n  const _remainingImageGenerationTasksCount =\n    queryData.userStatus?.remainingImageGenerationTasksCount ?? 0\n\n  useEffect(() => {\n    if (authContext.isLoading) return\n    if (authContext.isNotLoggedIn) return\n    if (favoritedModels === undefined) return\n    const favoritedModelIds =\n      favoritedModels.viewer?.favoritedImageGenerationModels.map((model) =>\n        Number(model.id),\n      ) ?? []\n    context.updateFavoriteModelIds(favoritedModelIds)\n  }, [favoritedModels])\n\n  useEffect(() => {\n    // åˆæœŸåŒ–\n    context.resetForInit()\n  }, [])\n\n  const _t = useTranslation()\n\n  // modelsã«ã¤ã„ã¦fluxã¨ã„ã†åå‰ã®ãƒ¢ãƒ‡ãƒ«ã§çµã‚‹\n  const _fluxModels = context.imageModels.filter((model) => {\n    // model.nameãŒfluxã‚’å«ã‚€ã‹ã©ã†ã‹\n    return model.name.includes(\"flux.1 schnell\")\n  })\n\n  return (\n    <GenerationViewCard>\n      <ScrollArea type=\"always\">\n        <div className={\"flex flex-col gap-y-4 px-0 md:px-4\"}>\n          {/* <GenerationConfigModels\n            models={fluxModels}\n            favoritedModelIds={context.config.favoriteModelIds}\n            currentModelId={\"706\"}\n            currentModelIds={[\"706\"]}\n            onSelectModelId={(id: string, type: string, prompt: string) => {\n              if (context.config.isUseRecommendedPrompt) {\n                if (prompt === \"\") {\n                  context.updateModelIdAndPrompt(\n                    id,\n                    type,\n                    config.generationFeature.defaultPromptValue,\n                  )\n                } else {\n                  context.updateModelIdAndPrompt(id, type, prompt)\n                }\n              } else {\n                context.updateModelId(id, type)\n              }\n            }}\n            onClickSearchModelWorks={(id: string, name: string) => {\n              context.updateSearchWorksModelIdAndName(id, name)\n              send({ type: \"OPEN_WORKS_FROM_MODEL\" })\n            }}\n          /> */}\n          {/* <Separator /> */}\n          {/* <GenerationConfigCount\n            availableImageGenerationMaxTasksCount={\n              availableImageGenerationMaxTasksCount\n            }\n            tasksCount={\n              inProgressImageGenerationTasksCost +\n              remainingImageGenerationTasksCount\n            }\n            setGenerationCount={context.changeGenerationCount}\n            generationCount={context.config.generationCount}\n          /> */}\n          <GenerationConfigSize\n            modelType={configModelType}\n            value={context.config.sizeType}\n            onChange={context.updateSizeType}\n          />\n          {/* <GenerationConfigUpscale /> */}\n          {/* <Separator />\n          <GenerationConfigI2i />\n          <Separator />\n          <GenerationConfigControlNet />\n          <Separator /> */}\n          {/* <GenerationConfigSeed\n            value={context.config.seed}\n            onChange={context.updateSeed}\n          />\n          <Separator />\n          <Accordion type=\"single\" collapsible>\n            <AccordionItem value=\"setting\">\n              <AccordionTrigger>\n                <div className=\"text-left\">\n                  <p>{t(\"è©³ç´°è¨­å®š\", \"Detailed settings\")}</p>\n                  <p className=\"text-sm opacity-40\">\n                    Scale:{context.config.scale}, Steps:{context.config.steps},\n                    Sampler:{context.config.sampler}, Vae:{context.config.vae}\n                  </p>\n                </div>\n              </AccordionTrigger>\n              <AccordionContent className=\"space-y-2\">\n                <GenerationConfigScale\n                  value={context.config.scale}\n                  onChange={context.updateScale}\n                />\n                <GenerationConfigStep\n                  value={context.config.steps}\n                  onChange={context.updateSteps}\n                />\n                <GenerationConfigSampler\n                  value={context.config.sampler}\n                  onChange={context.updateSampler}\n                />\n                <GenerationConfigClipSkip\n                  value={context.config.clipSkip}\n                  onChange={context.updateClipSkip}\n                />\n                <GenerationConfigVae\n                  value={context.config.vae ?? \"\"}\n                  onChange={context.updateVae}\n                />\n              </AccordionContent>\n            </AccordionItem>\n          </Accordion> */}\n        </div>\n      </ScrollArea>\n      {/* <div className=\"bottom-0 bg-card p-4 lg:sticky\">\n        <div className=\"flex gap-x-2\">\n          <GenerationConfigMemoButton\n            onClick={() => {\n              setShowMemoSetting(true)\n            }}\n          />\n          <GenerationConfigMemoSettingDialog\n            memos={\n              memos?.viewer?.currentImageGenerationMemos.map((memo) => ({\n                ...memo,\n                model: {\n                  ...memo.model,\n                  recommendedPrompt: \"\",\n                },\n              })) ?? []\n            }\n            refetch={refetch}\n            onClose={() => {\n              setShowMemoSetting(false)\n            }}\n            isOpen={showMemoSetting}\n          />\n          <GenerationConfigResetConfirmDialog onReset={context.reset} />\n        </div>\n      </div> */}\n    </GenerationViewCard>\n  )\n}\n\nconst userSettingQuery = graphql(\n  `query UserSetting {\n    userSetting {\n      userId\n      favoritedImageGenerationModelIds\n      preferenceRating\n      featurePromptonRequest\n      isNotifyComment\n    }\n  }`,\n)\n\nconst viewerCurrentImageGenerationMemosQuery = graphql(\n  `query ViewerCurrentImageGenerationMemos {\n    viewer {\n      id\n      currentImageGenerationMemos {\n        id\n        nanoid\n        userId\n        title\n        explanation\n        prompts\n        negativePrompts\n        sampler\n        model {\n          id\n          name\n          type\n        }\n        vae\n        seed\n        steps\n        scale\n        clipSkip\n        width\n        height\n        isDeleted\n        createdAt\n      }\n    }\n  }`,\n)\n\nconst viewerFavoritedImageGenerationModelsQuery = graphql(\n  `query ViewerFavoritedImageGenerationModels {\n    viewer {\n      id\n      favoritedImageGenerationModels {\n        id\n        name\n        type\n      }\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable memos is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"memos"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation.demonstration/components/config-view/generation-demo-config-view.tsx"},"span":[1991,1996],"sourceCode":"import { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { GenerationConfigSize } from \"~/routes/($lang).generation._index/components/config-view/generation-config-size\"\nimport { GenerationViewCard } from \"~/routes/($lang).generation._index/components/generation-view-card\"\nimport { GenerationConfigContext } from \"~/routes/($lang).generation._index/contexts/generation-config-context\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { useGenerationQuery } from \"~/routes/($lang).generation._index/hooks/use-generation-query\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { useEffect, useState } from \"react\"\nimport { useContext } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * ã‚¨ãƒ‡ã‚£ã‚¿ã®è¨­å®š\n * ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã‚ˆã‚Šè¨­å®šå†…å®¹ãŒä¿å­˜ã•ã‚Œã¦ã€å¾©å…ƒã•ã‚Œã‚‹ã®ã§ã‚µãƒ¼ãƒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã¨\n * ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®ä¸ä¸€è‡´ã‚’è§£æ±ºã™ã‚‹ãŸã‚é…å»¶ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§æœ¬ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’èª­ã¿è¾¼ã‚€ã“ã¨\n */\nexport function GenerationDemoConfigView () {\n  const context = useGenerationContext()\n\n  const queryData = useGenerationQuery()\n\n  const { send } = GenerationConfigContext.useActorRef()\n\n  const authContext = useContext(AuthContext)\n\n  const [_showMemoSetting, _setShowMemoSetting] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ãƒ¢ãƒ‡ãƒ«\n   */\n  const currentModel = context.imageModels.find((model) => {\n    return model.id === context.config.modelId\n  })\n\n  /**\n   * ãŠæ°—ã«å…¥ã‚Šã®ãƒ¢ãƒ‡ãƒ«\n   */\n  const { data: userSetting, refetch: refetchSetting } = useQuery(\n    userSettingQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * ãƒ¢ãƒ‡ãƒ«ã®ç¨®é¡\n   * SD1ãªã©\n   */\n  const configModelType = currentModel?.type ?? \"SD1\"\n\n  /**\n   * ãƒ¡ãƒ¢ä¸€è¦§\n   */\n  const { data: memos, refetch } = useQuery(\n    viewerCurrentImageGenerationMemosQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * ãŠæ°—ã«å…¥ã‚Šã®ãƒ¢ãƒ‡ãƒ«ä¸€è¦§\n   */\n  const { data: favoritedModels } = useQuery(\n    viewerFavoritedImageGenerationModelsQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * æœ€å¤§ç”Ÿæˆæšæ•°\n   */\n  const _availableImageGenerationMaxTasksCount =\n    queryData.userStatus?.availableImageGenerationMaxTasksCount ?? 10\n\n  const _inProgressImageGenerationTasksCost =\n    queryData.userStatus?.inProgressImageGenerationTasksCost ?? 0\n\n  const _remainingImageGenerationTasksCount =\n    queryData.userStatus?.remainingImageGenerationTasksCount ?? 0\n\n  useEffect(() => {\n    if (authContext.isLoading) return\n    if (authContext.isNotLoggedIn) return\n    if (favoritedModels === undefined) return\n    const favoritedModelIds =\n      favoritedModels.viewer?.favoritedImageGenerationModels.map((model) =>\n        Number(model.id),\n      ) ?? []\n    context.updateFavoriteModelIds(favoritedModelIds)\n  }, [favoritedModels])\n\n  useEffect(() => {\n    // åˆæœŸåŒ–\n    context.resetForInit()\n  }, [])\n\n  const _t = useTranslation()\n\n  // modelsã«ã¤ã„ã¦fluxã¨ã„ã†åå‰ã®ãƒ¢ãƒ‡ãƒ«ã§çµã‚‹\n  const _fluxModels = context.imageModels.filter((model) => {\n    // model.nameãŒfluxã‚’å«ã‚€ã‹ã©ã†ã‹\n    return model.name.includes(\"flux.1 schnell\")\n  })\n\n  return (\n    <GenerationViewCard>\n      <ScrollArea type=\"always\">\n        <div className={\"flex flex-col gap-y-4 px-0 md:px-4\"}>\n          {/* <GenerationConfigModels\n            models={fluxModels}\n            favoritedModelIds={context.config.favoriteModelIds}\n            currentModelId={\"706\"}\n            currentModelIds={[\"706\"]}\n            onSelectModelId={(id: string, type: string, prompt: string) => {\n              if (context.config.isUseRecommendedPrompt) {\n                if (prompt === \"\") {\n                  context.updateModelIdAndPrompt(\n                    id,\n                    type,\n                    config.generationFeature.defaultPromptValue,\n                  )\n                } else {\n                  context.updateModelIdAndPrompt(id, type, prompt)\n                }\n              } else {\n                context.updateModelId(id, type)\n              }\n            }}\n            onClickSearchModelWorks={(id: string, name: string) => {\n              context.updateSearchWorksModelIdAndName(id, name)\n              send({ type: \"OPEN_WORKS_FROM_MODEL\" })\n            }}\n          /> */}\n          {/* <Separator /> */}\n          {/* <GenerationConfigCount\n            availableImageGenerationMaxTasksCount={\n              availableImageGenerationMaxTasksCount\n            }\n            tasksCount={\n              inProgressImageGenerationTasksCost +\n              remainingImageGenerationTasksCount\n            }\n            setGenerationCount={context.changeGenerationCount}\n            generationCount={context.config.generationCount}\n          /> */}\n          <GenerationConfigSize\n            modelType={configModelType}\n            value={context.config.sizeType}\n            onChange={context.updateSizeType}\n          />\n          {/* <GenerationConfigUpscale /> */}\n          {/* <Separator />\n          <GenerationConfigI2i />\n          <Separator />\n          <GenerationConfigControlNet />\n          <Separator /> */}\n          {/* <GenerationConfigSeed\n            value={context.config.seed}\n            onChange={context.updateSeed}\n          />\n          <Separator />\n          <Accordion type=\"single\" collapsible>\n            <AccordionItem value=\"setting\">\n              <AccordionTrigger>\n                <div className=\"text-left\">\n                  <p>{t(\"è©³ç´°è¨­å®š\", \"Detailed settings\")}</p>\n                  <p className=\"text-sm opacity-40\">\n                    Scale:{context.config.scale}, Steps:{context.config.steps},\n                    Sampler:{context.config.sampler}, Vae:{context.config.vae}\n                  </p>\n                </div>\n              </AccordionTrigger>\n              <AccordionContent className=\"space-y-2\">\n                <GenerationConfigScale\n                  value={context.config.scale}\n                  onChange={context.updateScale}\n                />\n                <GenerationConfigStep\n                  value={context.config.steps}\n                  onChange={context.updateSteps}\n                />\n                <GenerationConfigSampler\n                  value={context.config.sampler}\n                  onChange={context.updateSampler}\n                />\n                <GenerationConfigClipSkip\n                  value={context.config.clipSkip}\n                  onChange={context.updateClipSkip}\n                />\n                <GenerationConfigVae\n                  value={context.config.vae ?? \"\"}\n                  onChange={context.updateVae}\n                />\n              </AccordionContent>\n            </AccordionItem>\n          </Accordion> */}\n        </div>\n      </ScrollArea>\n      {/* <div className=\"bottom-0 bg-card p-4 lg:sticky\">\n        <div className=\"flex gap-x-2\">\n          <GenerationConfigMemoButton\n            onClick={() => {\n              setShowMemoSetting(true)\n            }}\n          />\n          <GenerationConfigMemoSettingDialog\n            memos={\n              memos?.viewer?.currentImageGenerationMemos.map((memo) => ({\n                ...memo,\n                model: {\n                  ...memo.model,\n                  recommendedPrompt: \"\",\n                },\n              })) ?? []\n            }\n            refetch={refetch}\n            onClose={() => {\n              setShowMemoSetting(false)\n            }}\n            isOpen={showMemoSetting}\n          />\n          <GenerationConfigResetConfirmDialog onReset={context.reset} />\n        </div>\n      </div> */}\n    </GenerationViewCard>\n  )\n}\n\nconst userSettingQuery = graphql(\n  `query UserSetting {\n    userSetting {\n      userId\n      favoritedImageGenerationModelIds\n      preferenceRating\n      featurePromptonRequest\n      isNotifyComment\n    }\n  }`,\n)\n\nconst viewerCurrentImageGenerationMemosQuery = graphql(\n  `query ViewerCurrentImageGenerationMemos {\n    viewer {\n      id\n      currentImageGenerationMemos {\n        id\n        nanoid\n        userId\n        title\n        explanation\n        prompts\n        negativePrompts\n        sampler\n        model {\n          id\n          name\n          type\n        }\n        vae\n        seed\n        steps\n        scale\n        clipSkip\n        width\n        height\n        isDeleted\n        createdAt\n      }\n    }\n  }`,\n)\n\nconst viewerFavoritedImageGenerationModelsQuery = graphql(\n  `query ViewerFavoritedImageGenerationModels {\n    viewer {\n      id\n      favoritedImageGenerationModels {\n        id\n        name\n        type\n      }\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable refetch is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"refetch"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation.demonstration/components/config-view/generation-demo-config-view.tsx"},"span":[1998,2005],"sourceCode":"import { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { GenerationConfigSize } from \"~/routes/($lang).generation._index/components/config-view/generation-config-size\"\nimport { GenerationViewCard } from \"~/routes/($lang).generation._index/components/generation-view-card\"\nimport { GenerationConfigContext } from \"~/routes/($lang).generation._index/contexts/generation-config-context\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { useGenerationQuery } from \"~/routes/($lang).generation._index/hooks/use-generation-query\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { useEffect, useState } from \"react\"\nimport { useContext } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * ã‚¨ãƒ‡ã‚£ã‚¿ã®è¨­å®š\n * ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã‚ˆã‚Šè¨­å®šå†…å®¹ãŒä¿å­˜ã•ã‚Œã¦ã€å¾©å…ƒã•ã‚Œã‚‹ã®ã§ã‚µãƒ¼ãƒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã¨\n * ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®ä¸ä¸€è‡´ã‚’è§£æ±ºã™ã‚‹ãŸã‚é…å»¶ã‚¤ãƒ³ãƒãƒ¼ãƒˆã§æœ¬ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’èª­ã¿è¾¼ã‚€ã“ã¨\n */\nexport function GenerationDemoConfigView () {\n  const context = useGenerationContext()\n\n  const queryData = useGenerationQuery()\n\n  const { send } = GenerationConfigContext.useActorRef()\n\n  const authContext = useContext(AuthContext)\n\n  const [_showMemoSetting, _setShowMemoSetting] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ãƒ¢ãƒ‡ãƒ«\n   */\n  const currentModel = context.imageModels.find((model) => {\n    return model.id === context.config.modelId\n  })\n\n  /**\n   * ãŠæ°—ã«å…¥ã‚Šã®ãƒ¢ãƒ‡ãƒ«\n   */\n  const { data: userSetting, refetch: refetchSetting } = useQuery(\n    userSettingQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * ãƒ¢ãƒ‡ãƒ«ã®ç¨®é¡\n   * SD1ãªã©\n   */\n  const configModelType = currentModel?.type ?? \"SD1\"\n\n  /**\n   * ãƒ¡ãƒ¢ä¸€è¦§\n   */\n  const { data: memos, refetch } = useQuery(\n    viewerCurrentImageGenerationMemosQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * ãŠæ°—ã«å…¥ã‚Šã®ãƒ¢ãƒ‡ãƒ«ä¸€è¦§\n   */\n  const { data: favoritedModels } = useQuery(\n    viewerFavoritedImageGenerationModelsQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  /**\n   * æœ€å¤§ç”Ÿæˆæšæ•°\n   */\n  const _availableImageGenerationMaxTasksCount =\n    queryData.userStatus?.availableImageGenerationMaxTasksCount ?? 10\n\n  const _inProgressImageGenerationTasksCost =\n    queryData.userStatus?.inProgressImageGenerationTasksCost ?? 0\n\n  const _remainingImageGenerationTasksCount =\n    queryData.userStatus?.remainingImageGenerationTasksCount ?? 0\n\n  useEffect(() => {\n    if (authContext.isLoading) return\n    if (authContext.isNotLoggedIn) return\n    if (favoritedModels === undefined) return\n    const favoritedModelIds =\n      favoritedModels.viewer?.favoritedImageGenerationModels.map((model) =>\n        Number(model.id),\n      ) ?? []\n    context.updateFavoriteModelIds(favoritedModelIds)\n  }, [favoritedModels])\n\n  useEffect(() => {\n    // åˆæœŸåŒ–\n    context.resetForInit()\n  }, [])\n\n  const _t = useTranslation()\n\n  // modelsã«ã¤ã„ã¦fluxã¨ã„ã†åå‰ã®ãƒ¢ãƒ‡ãƒ«ã§çµã‚‹\n  const _fluxModels = context.imageModels.filter((model) => {\n    // model.nameãŒfluxã‚’å«ã‚€ã‹ã©ã†ã‹\n    return model.name.includes(\"flux.1 schnell\")\n  })\n\n  return (\n    <GenerationViewCard>\n      <ScrollArea type=\"always\">\n        <div className={\"flex flex-col gap-y-4 px-0 md:px-4\"}>\n          {/* <GenerationConfigModels\n            models={fluxModels}\n            favoritedModelIds={context.config.favoriteModelIds}\n            currentModelId={\"706\"}\n            currentModelIds={[\"706\"]}\n            onSelectModelId={(id: string, type: string, prompt: string) => {\n              if (context.config.isUseRecommendedPrompt) {\n                if (prompt === \"\") {\n                  context.updateModelIdAndPrompt(\n                    id,\n                    type,\n                    config.generationFeature.defaultPromptValue,\n                  )\n                } else {\n                  context.updateModelIdAndPrompt(id, type, prompt)\n                }\n              } else {\n                context.updateModelId(id, type)\n              }\n            }}\n            onClickSearchModelWorks={(id: string, name: string) => {\n              context.updateSearchWorksModelIdAndName(id, name)\n              send({ type: \"OPEN_WORKS_FROM_MODEL\" })\n            }}\n          /> */}\n          {/* <Separator /> */}\n          {/* <GenerationConfigCount\n            availableImageGenerationMaxTasksCount={\n              availableImageGenerationMaxTasksCount\n            }\n            tasksCount={\n              inProgressImageGenerationTasksCost +\n              remainingImageGenerationTasksCount\n            }\n            setGenerationCount={context.changeGenerationCount}\n            generationCount={context.config.generationCount}\n          /> */}\n          <GenerationConfigSize\n            modelType={configModelType}\n            value={context.config.sizeType}\n            onChange={context.updateSizeType}\n          />\n          {/* <GenerationConfigUpscale /> */}\n          {/* <Separator />\n          <GenerationConfigI2i />\n          <Separator />\n          <GenerationConfigControlNet />\n          <Separator /> */}\n          {/* <GenerationConfigSeed\n            value={context.config.seed}\n            onChange={context.updateSeed}\n          />\n          <Separator />\n          <Accordion type=\"single\" collapsible>\n            <AccordionItem value=\"setting\">\n              <AccordionTrigger>\n                <div className=\"text-left\">\n                  <p>{t(\"è©³ç´°è¨­å®š\", \"Detailed settings\")}</p>\n                  <p className=\"text-sm opacity-40\">\n                    Scale:{context.config.scale}, Steps:{context.config.steps},\n                    Sampler:{context.config.sampler}, Vae:{context.config.vae}\n                  </p>\n                </div>\n              </AccordionTrigger>\n              <AccordionContent className=\"space-y-2\">\n                <GenerationConfigScale\n                  value={context.config.scale}\n                  onChange={context.updateScale}\n                />\n                <GenerationConfigStep\n                  value={context.config.steps}\n                  onChange={context.updateSteps}\n                />\n                <GenerationConfigSampler\n                  value={context.config.sampler}\n                  onChange={context.updateSampler}\n                />\n                <GenerationConfigClipSkip\n                  value={context.config.clipSkip}\n                  onChange={context.updateClipSkip}\n                />\n                <GenerationConfigVae\n                  value={context.config.vae ?? \"\"}\n                  onChange={context.updateVae}\n                />\n              </AccordionContent>\n            </AccordionItem>\n          </Accordion> */}\n        </div>\n      </ScrollArea>\n      {/* <div className=\"bottom-0 bg-card p-4 lg:sticky\">\n        <div className=\"flex gap-x-2\">\n          <GenerationConfigMemoButton\n            onClick={() => {\n              setShowMemoSetting(true)\n            }}\n          />\n          <GenerationConfigMemoSettingDialog\n            memos={\n              memos?.viewer?.currentImageGenerationMemos.map((memo) => ({\n                ...memo,\n                model: {\n                  ...memo.model,\n                  recommendedPrompt: \"\",\n                },\n              })) ?? []\n            }\n            refetch={refetch}\n            onClose={() => {\n              setShowMemoSetting(false)\n            }}\n            isOpen={showMemoSetting}\n          />\n          <GenerationConfigResetConfirmDialog onReset={context.reset} />\n        </div>\n      </div> */}\n    </GenerationViewCard>\n  )\n}\n\nconst userSettingQuery = graphql(\n  `query UserSetting {\n    userSetting {\n      userId\n      favoritedImageGenerationModelIds\n      preferenceRating\n      featurePromptonRequest\n      isNotifyComment\n    }\n  }`,\n)\n\nconst viewerCurrentImageGenerationMemosQuery = graphql(\n  `query ViewerCurrentImageGenerationMemos {\n    viewer {\n      id\n      currentImageGenerationMemos {\n        id\n        nanoid\n        userId\n        title\n        explanation\n        prompts\n        negativePrompts\n        sampler\n        model {\n          id\n          name\n          type\n        }\n        vae\n        seed\n        steps\n        scale\n        clipSkip\n        width\n        height\n        isDeleted\n        createdAt\n      }\n    }\n  }`,\n)\n\nconst viewerFavoritedImageGenerationModelsQuery = graphql(\n  `query ViewerFavoritedImageGenerationModels {\n    viewer {\n      id\n      favoritedImageGenerationModels {\n        id\n        name\n        type\n      }\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable send is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"send"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation.demonstration/components/generation-side-tabs-view/generation-demo-side-tabs-view.tsx"},"span":[422,426],"sourceCode":"import { useTranslation } from \"~/hooks/use-translation\"\nimport { GenerationConfigContext } from \"~/routes/($lang).generation._index/contexts/generation-config-context\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\n\n/**\n * ã‚µã‚¤ãƒ‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„åˆ‡æ›¿ã‚¿ãƒ–\n */\nexport function GenerationDemoSideTabsView () {\n  const _context = useGenerationContext()\n\n  const { send } = GenerationConfigContext.useActorRef()\n\n  const _state = GenerationConfigContext.useSelector((snap) => {\n    return snap.value\n  })\n\n  const _t = useTranslation()\n\n  return <>{null}</>\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation.demonstration/components/generation-view/generation-demo-view.tsx"},"span":[2767,2921],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { ResizablePanelWithMemory } from \"~/components/resizable-panel-with-memory\"\nimport {\n  ResizableHandle,\n  ResizablePanel,\n  ResizablePanelGroup,\n} from \"~/components/ui/resizable\"\nimport { GenerationConfigContext } from \"~/routes/($lang).generation._index/contexts/generation-config-context\"\nimport { Suspense } from \"react\"\nimport { useMediaQuery } from \"usehooks-ts\"\n\ntype Props = {\n  header: React.ReactNode\n  main: React.ReactNode\n  aside: React.ReactNode\n  asideHeader: React.ReactNode\n  menu: React.ReactNode\n  footer: React.ReactNode\n}\n\n/**\n * ç”»åƒç”Ÿæˆç”»é¢\n */\nexport function GenerationDemoView (props: Props) {\n  const state = GenerationConfigContext.useSelector((snap) => {\n    return snap.value\n  })\n\n  /**\n   * ã‚¹ãƒãƒ›ã®å ´åˆãƒªã‚µã‚¤ã‚¶ãƒ¼ãªã—\n   */\n  if (!useMediaQuery(\"(min-width: 768px)\")) {\n    return (\n      <div className=\"flex flex-col space-y-2 pb-16\">\n        <main className=\"flex flex-col gap-2 overflow-hidden pb-4 md:flex-row\">\n          <div className=\"flex flex-col gap-y-2\">\n            {props.header}\n            {props.main}\n          </div>\n          <div className=\"flex-1 overflow-hidden\">\n            <div className=\"mx-2\">{props.asideHeader}</div>\n            {props.aside}\n          </div>\n        </main>\n        {props.footer}\n      </div>\n    )\n  }\n\n  if (state === \"HISTORY_LIST_FULL\" || state === \"WORK_LIST_FULL\") {\n    return (\n      <div className=\"flex h-main flex-col space-y-2\">\n        <main className=\"flex flex-col gap-4 overflow-hidden md:flex-row\">\n          <ResizablePanelGroup direction=\"horizontal\">\n            <ResizablePanel className=\"flex flex-col gap-y-2 lg:min-w-80 xl:min-w-80\">\n              {props.asideHeader}\n              {props.aside}\n            </ResizablePanel>\n          </ResizablePanelGroup>\n        </main>\n        {props.footer}\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex h-main flex-col space-y-2\">\n      <main className=\"flex h-full flex-col gap-4 overflow-hidden md:flex-row\">\n        <ResizablePanelGroup defaultValue={1} direction=\"horizontal\">\n          {/* <ResizablePanelWithMemory\n            id=\"generation-header-menu\"\n            className=\"flex flex-col\"\n          >\n            <Suspense fallback={<AppLoadingPage />}>{props.menu}</Suspense>\n          </ResizablePanelWithMemory> */}\n          {/* <ResizableHandle withHandle className=\"mr-4 ml-4\" /> */}\n          <ResizablePanelWithMemory\n            id=\"generation-header-main\"\n            className=\"flex flex-col\"\n          >\n            <Suspense fallback={<AppLoadingPage />}>{props.main}</Suspense>\n          </ResizablePanelWithMemory>\n          <ResizableHandle withHandle className=\"mr-4 ml-4\" />\n          <ResizablePanelWithMemory\n            id=\"generation-aside-header-aside\"\n            className=\"flex flex-col gap-y-2 lg:min-w-80 xl:min-w-80\"\n          >\n            <Suspense fallback={<AppLoadingPage />}>\n              {props.asideHeader}\n              {props.aside}\n            </Suspense>\n          </ResizablePanelWithMemory>\n        </ResizablePanelGroup>\n      </main>\n      {props.footer}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation.demonstration/components/generation-view/generation-demo-view.tsx"},"span":[2464,2579],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { ResizablePanelWithMemory } from \"~/components/resizable-panel-with-memory\"\nimport {\n  ResizableHandle,\n  ResizablePanel,\n  ResizablePanelGroup,\n} from \"~/components/ui/resizable\"\nimport { GenerationConfigContext } from \"~/routes/($lang).generation._index/contexts/generation-config-context\"\nimport { Suspense } from \"react\"\nimport { useMediaQuery } from \"usehooks-ts\"\n\ntype Props = {\n  header: React.ReactNode\n  main: React.ReactNode\n  aside: React.ReactNode\n  asideHeader: React.ReactNode\n  menu: React.ReactNode\n  footer: React.ReactNode\n}\n\n/**\n * ç”»åƒç”Ÿæˆç”»é¢\n */\nexport function GenerationDemoView (props: Props) {\n  const state = GenerationConfigContext.useSelector((snap) => {\n    return snap.value\n  })\n\n  /**\n   * ã‚¹ãƒãƒ›ã®å ´åˆãƒªã‚µã‚¤ã‚¶ãƒ¼ãªã—\n   */\n  if (!useMediaQuery(\"(min-width: 768px)\")) {\n    return (\n      <div className=\"flex flex-col space-y-2 pb-16\">\n        <main className=\"flex flex-col gap-2 overflow-hidden pb-4 md:flex-row\">\n          <div className=\"flex flex-col gap-y-2\">\n            {props.header}\n            {props.main}\n          </div>\n          <div className=\"flex-1 overflow-hidden\">\n            <div className=\"mx-2\">{props.asideHeader}</div>\n            {props.aside}\n          </div>\n        </main>\n        {props.footer}\n      </div>\n    )\n  }\n\n  if (state === \"HISTORY_LIST_FULL\" || state === \"WORK_LIST_FULL\") {\n    return (\n      <div className=\"flex h-main flex-col space-y-2\">\n        <main className=\"flex flex-col gap-4 overflow-hidden md:flex-row\">\n          <ResizablePanelGroup direction=\"horizontal\">\n            <ResizablePanel className=\"flex flex-col gap-y-2 lg:min-w-80 xl:min-w-80\">\n              {props.asideHeader}\n              {props.aside}\n            </ResizablePanel>\n          </ResizablePanelGroup>\n        </main>\n        {props.footer}\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex h-main flex-col space-y-2\">\n      <main className=\"flex h-full flex-col gap-4 overflow-hidden md:flex-row\">\n        <ResizablePanelGroup defaultValue={1} direction=\"horizontal\">\n          {/* <ResizablePanelWithMemory\n            id=\"generation-header-menu\"\n            className=\"flex flex-col\"\n          >\n            <Suspense fallback={<AppLoadingPage />}>{props.menu}</Suspense>\n          </ResizablePanelWithMemory> */}\n          {/* <ResizableHandle withHandle className=\"mr-4 ml-4\" /> */}\n          <ResizablePanelWithMemory\n            id=\"generation-header-main\"\n            className=\"flex flex-col\"\n          >\n            <Suspense fallback={<AppLoadingPage />}>{props.main}</Suspense>\n          </ResizablePanelWithMemory>\n          <ResizableHandle withHandle className=\"mr-4 ml-4\" />\n          <ResizablePanelWithMemory\n            id=\"generation-aside-header-aside\"\n            className=\"flex flex-col gap-y-2 lg:min-w-80 xl:min-w-80\"\n          >\n            <Suspense fallback={<AppLoadingPage />}>\n              {props.asideHeader}\n              {props.aside}\n            </Suspense>\n          </ResizablePanelWithMemory>\n        </ResizablePanelGroup>\n      </main>\n      {props.footer}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation.demonstration/components/submission-view/generation-demo-submit-operation-parts.tsx"},"span":[5810,6105],"sourceCode":"import { GradientBlueButton } from \"~/components/button/gradient-blue-button\"\nimport { GradientBorderButton } from \"~/components/button/gradient-border-button\"\nimport { LoginDialogButton } from \"~/components/login-dialog-button\"\nimport { Button } from \"~/components/ui/button\"\nimport { Dialog, DialogTrigger } from \"~/components/ui/dialog\"\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuTrigger,\n} from \"~/components/ui/dropdown-menu\"\nimport { Label } from \"~/components/ui/label\"\nimport { Switch } from \"~/components/ui/switch\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { GenerationReserveCountInput } from \"~/routes/($lang).generation._index/components/submission-view/generation-reserve-count-input\"\nimport { GenerationTermsButton } from \"~/routes/($lang).generation._index/components/submission-view/generation-terms-button\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { Loader2Icon, Minus, Plus, SettingsIcon } from \"lucide-react\"\nimport { useContext } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { GenerationDemoSubmitButton } from \"~/routes/($lang).generation.demonstration/components/submission-view/generation-demo-submit-button\"\nimport { getSubmitButtonLabel } from \"~/routes/($lang).generation._index/components/submission-view/generation-submit-operation-parts\"\n\ntype Props = {\n  isCreatingTask: boolean\n  inProgressImageGenerationTasksCount: number\n  inProgressImageGenerationReservedTasksCount: number\n  maxTasksCount: number\n  tasksCount: number\n  termsText: string\n  availableImageGenerationMaxTasksCount: number\n  onCreateTask: () => void\n  onSignTerms: () => void\n}\n\n/**\n * ç”Ÿæˆãƒœã‚¿ãƒ³ã®ãƒ©ãƒ™ãƒ«\n * @param isSetI2iImage\n * @param prompts\n * @param seed\n */\nexport function getDemoSubmitButtonLabel (\n  isSetI2iImage: boolean,\n  prompts: string,\n  seed: number,\n  inProgressImageGenerationTasksCount: number,\n) {\n  const t = useTranslation()\n\n  const seedLabel = seed === -1 ? \"\" : t(\"(Seedå›ºå®š)\", \"(Seed fixed)\")\n\n  if (!prompts) {\n    if (isSetI2iImage) {\n      return t(\n        `ç”»åƒã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆ${seedLabel}`,\n        `Random generation from image ${seedLabel}`,\n      )\n    }\n    return t(`ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆ${seedLabel}`, `Random generation ${seedLabel}`)\n  }\n  if (isSetI2iImage) {\n    return t(`ç”»åƒã‹ã‚‰ç”Ÿæˆ${seedLabel}`, `Generate from image ${seedLabel}`)\n  }\n  if (inProgressImageGenerationTasksCount > 0) {\n    return t(`è¿½åŠ ç”Ÿæˆ${seedLabel}`, `Add generation ${seedLabel}`)\n  }\n  return t(`ç”Ÿæˆ${seedLabel}`, `Generate ${seedLabel}`)\n}\n\n/**\n * ç”Ÿæˆå®Ÿè¡Œã«é–¢ã‚ã‚‹æ“ä½œUI\n */\nexport function GenerationDemoSubmitOperationParts (props: Props) {\n  const context = useGenerationContext()\n\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const isCurrentPremiumPlan = () => {\n    if (context.currentPass?.type === \"PREMIUM\") {\n      return true\n    }\n    return false\n  }\n\n  const onMinusButtonClick = () => {\n    if (context.config.generationCount <= 1) {\n      return\n    }\n    context.changeGenerationCount(context.config.generationCount - 1)\n  }\n\n  const onPlusButtonClick = () => {\n    if (\n      context.config.generationCount >=\n      props.availableImageGenerationMaxTasksCount\n    ) {\n      return\n    }\n    context.changeGenerationCount(context.config.generationCount + 1)\n  }\n\n  const generatingCount =\n    props.inProgressImageGenerationTasksCount +\n    props.inProgressImageGenerationReservedTasksCount\n\n  return (\n    <>\n      <div className=\"flex items-center\">\n        <div className=\"flex items-center md:hidden\">\n          <DropdownMenu>\n            <DropdownMenuTrigger className=\"block md:hidden\">\n              <Button\n                className=\"mr-2\"\n                size={\"icon\"}\n                variant={\"ghost\"}\n                onClick={onMinusButtonClick}\n              >\n                <SettingsIcon className=\"m-auto\" />\n              </Button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent>\n              <div className=\"flex items-center p-2\">\n                <Button\n                  className=\"mr-2\"\n                  size={\"icon\"}\n                  variant={\"ghost\"}\n                  onClick={onMinusButtonClick}\n                >\n                  <Minus className=\"m-auto\" />\n                </Button>\n                <GenerationReserveCountInput\n                  maxCount={\n                    props.availableImageGenerationMaxTasksCount -\n                    props.tasksCount\n                  }\n                  onChange={context.changeGenerationCount}\n                  count={context.config.generationCount}\n                />\n                {t(\"æš\", \"pieces\")}\n                <Button\n                  className=\"mr-2\"\n                  size={\"icon\"}\n                  variant={\"ghost\"}\n                  onClick={onPlusButtonClick}\n                >\n                  <Plus className=\"m-auto\" />\n                </Button>\n              </div>\n            </DropdownMenuContent>\n          </DropdownMenu>\n          <div className=\"hidden items-center md:flex\">\n            <GenerationReserveCountInput\n              maxCount={\n                props.availableImageGenerationMaxTasksCount - props.tasksCount\n              }\n              onChange={context.changeGenerationCount}\n              count={context.config.generationCount}\n            />\n            <div className=\"mr-2\">{t(\"æš\", \"pieces\")}</div>\n          </div>\n        </div>\n        {/* æœªãƒ­ã‚°ã‚¤ãƒ³ãªã‚‰ãƒ­ã‚°ã‚¤ãƒ³ã€ãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾—ä¸­ã‚‚disabledãªçŠ¶æ…‹ã§è¡¨ç¤º */}\n        {(!authContext.isLoggedIn || context.user === null) && (\n          <>\n            <div className=\"mr-2 flex w-56 items-center space-x-2 md:w-48\">\n              <Switch\n                onClick={() => {\n                  context.changeUpscaleSize(\n                    context.config.upscaleSize === 2 ? 1 : 2,\n                  )\n                }}\n                checked={context.config.upscaleSize === 2}\n                id=\"extras-mode\"\n              />\n              <div className=\"text-center leading-3\">\n                <Label htmlFor=\"extras-mode\" className=\"block text-center\">\n                  {t(\"é«˜è§£åƒåº¦\", \"High Resolution\")}\n                </Label>\n                <Label\n                  htmlFor=\"extras-mode\"\n                  className=\"block text-center text-xs\"\n                >\n                  {t(\"2æšæ¶ˆè²»\", \"Consumes 2 pieces\")}\n                </Label>\n              </div>\n            </div>\n            <LoginDialogButton\n              label={t(\"ç”Ÿæˆ\", \"Generate\")}\n              isLoading={\n                authContext.isLoading ||\n                (authContext.isLoggedIn && context.user === null)\n              }\n              isWidthFull={true}\n              triggerChildren={\n                <GradientBlueButton\n                  onClick={() => {}}\n                  className=\"w-full text-balance\"\n                  isNoBackground={true}\n                >\n                  <div className=\"flex items-center\">\n                    {t(\"ç”Ÿæˆ\", \"Generate\")}\n                    {(authContext.isLoading ||\n                      (authContext.isLoggedIn && context.user === null)) && (\n                      <span className=\"ml-2 animate-spin\">\n                        <Loader2Icon />\n                      </span>\n                    )}\n                  </div>\n                </GradientBlueButton>\n              }\n            />\n          </>\n        )}\n        {/* è¦ç´„ç¢ºèªé–‹å§‹ãƒœã‚¿ãƒ³ */}\n        {authContext.isLoggedIn &&\n          context.user !== null &&\n          context.user?.hasSignedImageGenerationTerms !== true && (\n            <GenerationTermsButton\n              termsMarkdownText={props.termsText}\n              isLoading={props.isCreatingTask}\n              onSubmit={props.onSignTerms}\n              triggerChildren={\n                <GradientBorderButton\n                  disabled={props.isCreatingTask}\n                  onClick={() => {}}\n                  className=\"w-full text-balance\"\n                  isNoBackground={true}\n                >\n                  {props.isCreatingTask\n                    ? t(\"å‡¦ç†ä¸­..\", \"Processing..\")\n                    : t(\"ç”Ÿæˆ\", \"Generate\")}\n                </GradientBorderButton>\n              }\n            />\n          )}\n        {/* ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã®å ´åˆã¯ã‚µãƒ–ã‚¹ã‚¯æ¡ˆå†…ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãªã—ver */}\n        {isCurrentPremiumPlan() &&\n          context.user?.hasSignedImageGenerationTerms === true && (\n            <GenerationDemoSubmitButton\n              onClick={async () => {\n                await props.onCreateTask()\n              }}\n              isLoading={props.isCreatingTask}\n              isDisabled={context.config.isDisabled}\n              generatingCount={generatingCount}\n              maxGeneratingCount={\n                props.availableImageGenerationMaxTasksCount - props.tasksCount\n              }\n              buttonActionCaption={getSubmitButtonLabel(\n                !!context.config.i2iImageBase64,\n                context.config.promptText,\n                context.config.seed,\n                generatingCount,\n              )}\n            />\n          )}\n        {/* ã‚µãƒ–ã‚¹ã‚¯æ¡ˆå†…ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚ã‚Šverï¼ˆæœ€å¾Œã®1æšã®ç”Ÿæˆæ™‚ã«æ¡ˆå†…ã™ã‚‹ï¼‰ */}\n        {!isCurrentPremiumPlan() &&\n          props.tasksCount <\n            props.availableImageGenerationMaxTasksCount -\n              (context.config.upscaleSize === 2 ? 2 : 1) &&\n          context.user?.hasSignedImageGenerationTerms === true && (\n            <GenerationDemoSubmitButton\n              onClick={async () => {\n                await props.onCreateTask()\n              }}\n              isLoading={props.isCreatingTask}\n              isDisabled={context.config.isDisabled}\n              generatingCount={generatingCount}\n              maxGeneratingCount={\n                props.availableImageGenerationMaxTasksCount - props.tasksCount\n              }\n              buttonActionCaption={getSubmitButtonLabel(\n                !!context.config.i2iImageBase64,\n                context.config.promptText,\n                context.config.seed,\n                generatingCount,\n              )}\n            />\n          )}\n        {/* é€šå¸¸ã®ç”Ÿæˆãƒœã‚¿ãƒ³ */}\n        {!isCurrentPremiumPlan() &&\n          props.tasksCount >=\n            props.availableImageGenerationMaxTasksCount -\n              (context.config.upscaleSize === 2 ? 2 : 1) &&\n          context.user?.hasSignedImageGenerationTerms === true && (\n            <Dialog>\n              <DialogTrigger asChild>\n                <div className=\"flex w-full items-center space-x-4\">\n                  <div className=\"flex w-48 items-center md:w-40\">\n                    <Switch\n                      onClick={() => {\n                        context.changeUpscaleSize(\n                          context.config.upscaleSize === 2 ? 1 : 2,\n                        )\n                      }}\n                      checked={context.config.upscaleSize === 2}\n                      id=\"extras-mode\"\n                    />\n                    <div className=\"text-center leading-3\">\n                      <Label\n                        htmlFor=\"extras-mode\"\n                        className=\"block text-center\"\n                      >\n                        {t(\"é«˜è§£åƒåº¦\", \"High Resolution\")}\n                      </Label>\n                      <Label\n                        htmlFor=\"extras-mode\"\n                        className=\"block text-center text-xs\"\n                      >\n                        {t(\"2æšæ¶ˆè²»\", \"Consumes 2 pieces\")}\n                      </Label>\n                    </div>\n                  </div>\n                  <GenerationDemoSubmitButton\n                    onClick={async () => {\n                      await props.onCreateTask()\n                    }}\n                    isLoading={props.isCreatingTask}\n                    isDisabled={context.config.isDisabled}\n                    generatingCount={generatingCount}\n                    maxGeneratingCount={\n                      props.availableImageGenerationMaxTasksCount -\n                      props.tasksCount\n                    }\n                    buttonActionCaption={getSubmitButtonLabel(\n                      !!context.config.i2iImageBase64,\n                      context.config.promptText,\n                      context.config.seed,\n                      generatingCount,\n                    )}\n                  />\n                </div>\n              </DialogTrigger>\n            </Dialog>\n          )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation.demonstration/components/submission-view/generation-demo-submit-operation-parts.tsx"},"span":[10804,11147],"sourceCode":"import { GradientBlueButton } from \"~/components/button/gradient-blue-button\"\nimport { GradientBorderButton } from \"~/components/button/gradient-border-button\"\nimport { LoginDialogButton } from \"~/components/login-dialog-button\"\nimport { Button } from \"~/components/ui/button\"\nimport { Dialog, DialogTrigger } from \"~/components/ui/dialog\"\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuTrigger,\n} from \"~/components/ui/dropdown-menu\"\nimport { Label } from \"~/components/ui/label\"\nimport { Switch } from \"~/components/ui/switch\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { GenerationReserveCountInput } from \"~/routes/($lang).generation._index/components/submission-view/generation-reserve-count-input\"\nimport { GenerationTermsButton } from \"~/routes/($lang).generation._index/components/submission-view/generation-terms-button\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { Loader2Icon, Minus, Plus, SettingsIcon } from \"lucide-react\"\nimport { useContext } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { GenerationDemoSubmitButton } from \"~/routes/($lang).generation.demonstration/components/submission-view/generation-demo-submit-button\"\nimport { getSubmitButtonLabel } from \"~/routes/($lang).generation._index/components/submission-view/generation-submit-operation-parts\"\n\ntype Props = {\n  isCreatingTask: boolean\n  inProgressImageGenerationTasksCount: number\n  inProgressImageGenerationReservedTasksCount: number\n  maxTasksCount: number\n  tasksCount: number\n  termsText: string\n  availableImageGenerationMaxTasksCount: number\n  onCreateTask: () => void\n  onSignTerms: () => void\n}\n\n/**\n * ç”Ÿæˆãƒœã‚¿ãƒ³ã®ãƒ©ãƒ™ãƒ«\n * @param isSetI2iImage\n * @param prompts\n * @param seed\n */\nexport function getDemoSubmitButtonLabel (\n  isSetI2iImage: boolean,\n  prompts: string,\n  seed: number,\n  inProgressImageGenerationTasksCount: number,\n) {\n  const t = useTranslation()\n\n  const seedLabel = seed === -1 ? \"\" : t(\"(Seedå›ºå®š)\", \"(Seed fixed)\")\n\n  if (!prompts) {\n    if (isSetI2iImage) {\n      return t(\n        `ç”»åƒã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆ${seedLabel}`,\n        `Random generation from image ${seedLabel}`,\n      )\n    }\n    return t(`ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆ${seedLabel}`, `Random generation ${seedLabel}`)\n  }\n  if (isSetI2iImage) {\n    return t(`ç”»åƒã‹ã‚‰ç”Ÿæˆ${seedLabel}`, `Generate from image ${seedLabel}`)\n  }\n  if (inProgressImageGenerationTasksCount > 0) {\n    return t(`è¿½åŠ ç”Ÿæˆ${seedLabel}`, `Add generation ${seedLabel}`)\n  }\n  return t(`ç”Ÿæˆ${seedLabel}`, `Generate ${seedLabel}`)\n}\n\n/**\n * ç”Ÿæˆå®Ÿè¡Œã«é–¢ã‚ã‚‹æ“ä½œUI\n */\nexport function GenerationDemoSubmitOperationParts (props: Props) {\n  const context = useGenerationContext()\n\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const isCurrentPremiumPlan = () => {\n    if (context.currentPass?.type === \"PREMIUM\") {\n      return true\n    }\n    return false\n  }\n\n  const onMinusButtonClick = () => {\n    if (context.config.generationCount <= 1) {\n      return\n    }\n    context.changeGenerationCount(context.config.generationCount - 1)\n  }\n\n  const onPlusButtonClick = () => {\n    if (\n      context.config.generationCount >=\n      props.availableImageGenerationMaxTasksCount\n    ) {\n      return\n    }\n    context.changeGenerationCount(context.config.generationCount + 1)\n  }\n\n  const generatingCount =\n    props.inProgressImageGenerationTasksCount +\n    props.inProgressImageGenerationReservedTasksCount\n\n  return (\n    <>\n      <div className=\"flex items-center\">\n        <div className=\"flex items-center md:hidden\">\n          <DropdownMenu>\n            <DropdownMenuTrigger className=\"block md:hidden\">\n              <Button\n                className=\"mr-2\"\n                size={\"icon\"}\n                variant={\"ghost\"}\n                onClick={onMinusButtonClick}\n              >\n                <SettingsIcon className=\"m-auto\" />\n              </Button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent>\n              <div className=\"flex items-center p-2\">\n                <Button\n                  className=\"mr-2\"\n                  size={\"icon\"}\n                  variant={\"ghost\"}\n                  onClick={onMinusButtonClick}\n                >\n                  <Minus className=\"m-auto\" />\n                </Button>\n                <GenerationReserveCountInput\n                  maxCount={\n                    props.availableImageGenerationMaxTasksCount -\n                    props.tasksCount\n                  }\n                  onChange={context.changeGenerationCount}\n                  count={context.config.generationCount}\n                />\n                {t(\"æš\", \"pieces\")}\n                <Button\n                  className=\"mr-2\"\n                  size={\"icon\"}\n                  variant={\"ghost\"}\n                  onClick={onPlusButtonClick}\n                >\n                  <Plus className=\"m-auto\" />\n                </Button>\n              </div>\n            </DropdownMenuContent>\n          </DropdownMenu>\n          <div className=\"hidden items-center md:flex\">\n            <GenerationReserveCountInput\n              maxCount={\n                props.availableImageGenerationMaxTasksCount - props.tasksCount\n              }\n              onChange={context.changeGenerationCount}\n              count={context.config.generationCount}\n            />\n            <div className=\"mr-2\">{t(\"æš\", \"pieces\")}</div>\n          </div>\n        </div>\n        {/* æœªãƒ­ã‚°ã‚¤ãƒ³ãªã‚‰ãƒ­ã‚°ã‚¤ãƒ³ã€ãƒ¦ãƒ¼ã‚¶æƒ…å ±å–å¾—ä¸­ã‚‚disabledãªçŠ¶æ…‹ã§è¡¨ç¤º */}\n        {(!authContext.isLoggedIn || context.user === null) && (\n          <>\n            <div className=\"mr-2 flex w-56 items-center space-x-2 md:w-48\">\n              <Switch\n                onClick={() => {\n                  context.changeUpscaleSize(\n                    context.config.upscaleSize === 2 ? 1 : 2,\n                  )\n                }}\n                checked={context.config.upscaleSize === 2}\n                id=\"extras-mode\"\n              />\n              <div className=\"text-center leading-3\">\n                <Label htmlFor=\"extras-mode\" className=\"block text-center\">\n                  {t(\"é«˜è§£åƒåº¦\", \"High Resolution\")}\n                </Label>\n                <Label\n                  htmlFor=\"extras-mode\"\n                  className=\"block text-center text-xs\"\n                >\n                  {t(\"2æšæ¶ˆè²»\", \"Consumes 2 pieces\")}\n                </Label>\n              </div>\n            </div>\n            <LoginDialogButton\n              label={t(\"ç”Ÿæˆ\", \"Generate\")}\n              isLoading={\n                authContext.isLoading ||\n                (authContext.isLoggedIn && context.user === null)\n              }\n              isWidthFull={true}\n              triggerChildren={\n                <GradientBlueButton\n                  onClick={() => {}}\n                  className=\"w-full text-balance\"\n                  isNoBackground={true}\n                >\n                  <div className=\"flex items-center\">\n                    {t(\"ç”Ÿæˆ\", \"Generate\")}\n                    {(authContext.isLoading ||\n                      (authContext.isLoggedIn && context.user === null)) && (\n                      <span className=\"ml-2 animate-spin\">\n                        <Loader2Icon />\n                      </span>\n                    )}\n                  </div>\n                </GradientBlueButton>\n              }\n            />\n          </>\n        )}\n        {/* è¦ç´„ç¢ºèªé–‹å§‹ãƒœã‚¿ãƒ³ */}\n        {authContext.isLoggedIn &&\n          context.user !== null &&\n          context.user?.hasSignedImageGenerationTerms !== true && (\n            <GenerationTermsButton\n              termsMarkdownText={props.termsText}\n              isLoading={props.isCreatingTask}\n              onSubmit={props.onSignTerms}\n              triggerChildren={\n                <GradientBorderButton\n                  disabled={props.isCreatingTask}\n                  onClick={() => {}}\n                  className=\"w-full text-balance\"\n                  isNoBackground={true}\n                >\n                  {props.isCreatingTask\n                    ? t(\"å‡¦ç†ä¸­..\", \"Processing..\")\n                    : t(\"ç”Ÿæˆ\", \"Generate\")}\n                </GradientBorderButton>\n              }\n            />\n          )}\n        {/* ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã®å ´åˆã¯ã‚µãƒ–ã‚¹ã‚¯æ¡ˆå†…ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãªã—ver */}\n        {isCurrentPremiumPlan() &&\n          context.user?.hasSignedImageGenerationTerms === true && (\n            <GenerationDemoSubmitButton\n              onClick={async () => {\n                await props.onCreateTask()\n              }}\n              isLoading={props.isCreatingTask}\n              isDisabled={context.config.isDisabled}\n              generatingCount={generatingCount}\n              maxGeneratingCount={\n                props.availableImageGenerationMaxTasksCount - props.tasksCount\n              }\n              buttonActionCaption={getSubmitButtonLabel(\n                !!context.config.i2iImageBase64,\n                context.config.promptText,\n                context.config.seed,\n                generatingCount,\n              )}\n            />\n          )}\n        {/* ã‚µãƒ–ã‚¹ã‚¯æ¡ˆå†…ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚ã‚Šverï¼ˆæœ€å¾Œã®1æšã®ç”Ÿæˆæ™‚ã«æ¡ˆå†…ã™ã‚‹ï¼‰ */}\n        {!isCurrentPremiumPlan() &&\n          props.tasksCount <\n            props.availableImageGenerationMaxTasksCount -\n              (context.config.upscaleSize === 2 ? 2 : 1) &&\n          context.user?.hasSignedImageGenerationTerms === true && (\n            <GenerationDemoSubmitButton\n              onClick={async () => {\n                await props.onCreateTask()\n              }}\n              isLoading={props.isCreatingTask}\n              isDisabled={context.config.isDisabled}\n              generatingCount={generatingCount}\n              maxGeneratingCount={\n                props.availableImageGenerationMaxTasksCount - props.tasksCount\n              }\n              buttonActionCaption={getSubmitButtonLabel(\n                !!context.config.i2iImageBase64,\n                context.config.promptText,\n                context.config.seed,\n                generatingCount,\n              )}\n            />\n          )}\n        {/* é€šå¸¸ã®ç”Ÿæˆãƒœã‚¿ãƒ³ */}\n        {!isCurrentPremiumPlan() &&\n          props.tasksCount >=\n            props.availableImageGenerationMaxTasksCount -\n              (context.config.upscaleSize === 2 ? 2 : 1) &&\n          context.user?.hasSignedImageGenerationTerms === true && (\n            <Dialog>\n              <DialogTrigger asChild>\n                <div className=\"flex w-full items-center space-x-4\">\n                  <div className=\"flex w-48 items-center md:w-40\">\n                    <Switch\n                      onClick={() => {\n                        context.changeUpscaleSize(\n                          context.config.upscaleSize === 2 ? 1 : 2,\n                        )\n                      }}\n                      checked={context.config.upscaleSize === 2}\n                      id=\"extras-mode\"\n                    />\n                    <div className=\"text-center leading-3\">\n                      <Label\n                        htmlFor=\"extras-mode\"\n                        className=\"block text-center\"\n                      >\n                        {t(\"é«˜è§£åƒåº¦\", \"High Resolution\")}\n                      </Label>\n                      <Label\n                        htmlFor=\"extras-mode\"\n                        className=\"block text-center text-xs\"\n                      >\n                        {t(\"2æšæ¶ˆè²»\", \"Consumes 2 pieces\")}\n                      </Label>\n                    </div>\n                  </div>\n                  <GenerationDemoSubmitButton\n                    onClick={async () => {\n                      await props.onCreateTask()\n                    }}\n                    isLoading={props.isCreatingTask}\n                    isDisabled={context.config.isDisabled}\n                    generatingCount={generatingCount}\n                    maxGeneratingCount={\n                      props.availableImageGenerationMaxTasksCount -\n                      props.tasksCount\n                    }\n                    buttonActionCaption={getSubmitButtonLabel(\n                      !!context.config.i2iImageBase64,\n                      context.config.promptText,\n                      context.config.seed,\n                      generatingCount,\n                    )}\n                  />\n                </div>\n              </DialogTrigger>\n            </Dialog>\n          )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/albums-list-column.tsx"},"span":[518,531],"sourceCode":"import type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport type { SortType } from \"~/types/sort-type\"\nimport { ChevronDown, ChevronUp } from \"lucide-react\"\n\ntype Props = {\n  label: string\n  orderBy: IntrospectionEnum<\"AlbumOrderBy\">\n  nowOrderBy: IntrospectionEnum<\"AlbumOrderBy\">\n  sort: SortType\n  onClick: () => void\n}\n\n/**\n * ã‚·ãƒªãƒ¼ã‚ºä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ \n */\nexport function AlbumsListColumn (props: Props) {\n  return (\n    <>\n      {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n      <div onClick={props.onClick} className=\"cursor-pointer\">\n        <div className=\"flex items-center\">\n          {props.label}\n          {props.orderBy === props.nowOrderBy &&\n            (props.sort === \"ASC\" ? <ChevronUp /> : <ChevronDown />)}\n        </div>\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/albums-list-table.tsx"},"span":[1875,1888],"sourceCode":"import {\n  Table,\n  TableHeader,\n  TableRow,\n  TableHead,\n  TableBody,\n} from \"~/components/ui/table\"\nimport type { SortType } from \"~/types/sort-type\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport {\n  AlbumsListTableRow,\n  AlbumTableRowFragment,\n} from \"~/routes/($lang).my._index/components/albums-list-table-row\"\nimport { AlbumsListColumn } from \"~/routes/($lang).my._index/components/albums-list-column\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\n\ntype Props = {\n  albums: FragmentOf<typeof AlbumTableItemFragment>[]\n  sort: SortType\n  orderBy: IntrospectionEnum<\"AlbumOrderBy\">\n  onClickTitleSortButton: () => void\n  onClickDateSortButton: () => void\n}\n\n/**\n * ã‚·ãƒªãƒ¼ã‚ºä¸€è¦§\n */\nexport function AlbumsListTable (props: Props) {\n  return (\n    <>\n      <ScrollArea className=\"overflow-x-auto\">\n        <Table className=\"w-full\">\n          <TableHeader>\n            <TableRow>\n              <TableHead>\n                <AlbumsListColumn\n                  label=\"ã‚¿ã‚¤ãƒˆãƒ«\"\n                  orderBy=\"NAME\"\n                  nowOrderBy={props.orderBy}\n                  sort={props.sort}\n                  onClick={props.onClickTitleSortButton}\n                />\n              </TableHead>\n              <TableHead>{}</TableHead>\n              <TableHead>{}</TableHead>\n              <TableHead>\n                <AlbumsListColumn\n                  label=\"æ—¥ä»˜\"\n                  orderBy=\"DATE_CREATED\"\n                  nowOrderBy={props.orderBy}\n                  sort={props.sort}\n                  onClick={props.onClickDateSortButton}\n                />\n              </TableHead>\n            </TableRow>\n          </TableHeader>\n          <TableBody>\n            {props.albums.map((album, index) => (\n              // biome-ignore lint/suspicious/noArrayIndexKey: <explanation>\n              <AlbumsListTableRow album={album} key={index} />\n            ))}\n          </TableBody>\n        </Table>\n      </ScrollArea>\n    </>\n  )\n}\n\nexport const AlbumTableItemFragment = graphql(\n  `fragment AlbumTableItem on AlbumNode @_unmask {\n    ...AlbumTableRow\n  }`,\n  [AlbumTableRowFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable refetch is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"refetch"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/bookmark-list-container.tsx"},"span":[875,882],"sourceCode":"import { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext } from \"react\"\nimport { BookmarkWorksList } from \"~/routes/($lang).my._index/components/bookmark-works-list\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { BookmarkWorksTableItemFragment } from \"~/routes/($lang).my._index/components/bookmark-works-list-table\"\n\ntype Props = {\n  page: number\n  maxCount: number\n  setPage: (page: number) => void\n}\n\n/**\n * ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ä¸€è¦§ã‚³ãƒ³ãƒ†ãƒŠ\n */\nexport function BookmarkListContainer (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  if (\n    authContext.isLoading ||\n    authContext.isNotLoggedIn ||\n    authContext.userId === undefined ||\n    !authContext.userId\n  ) {\n    return null\n  }\n  const { data: userResp, refetch } = useQuery(userQuery, {\n    skip:\n      authContext.isLoading || authContext.isNotLoggedIn || !authContext.userId,\n    variables: {\n      bookmarksOffset: 16 * props.page,\n      bookmarksLimit: 16,\n      userId: decodeURIComponent(authContext.userId),\n    },\n  })\n\n  const works = userResp?.user?.bookmarkWorks ?? []\n\n  return (\n    <>\n      <BookmarkWorksList works={works} />\n      <div className=\"h-8\" />\n      <div className=\"-translate-x-1/2 fixed bottom-0 left-1/2 z-10 w-full border-border/40 bg-background/95 p-2 backdrop-blur-sm supports-backdrop-filter:bg-background/80\">\n        <ResponsivePagination\n          perPage={16}\n          maxCount={props.maxCount}\n          currentPage={props.page}\n          onPageChange={(page: number) => {\n            props.setPage(page)\n          }}\n        />\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n    $bookmarksOffset: Int!,\n    $bookmarksLimit: Int!,\n    $bookmarksWhere: UserWorksWhereInput,\n  ) {\n    user(id: $userId) {\n      id\n      bookmarkWorks(offset: $bookmarksOffset, limit: $bookmarksLimit, where: $bookmarksWhere) {\n        ...BookmarkWorksTableItem\n      }\n    }\n  }`,\n  [BookmarkWorksTableItemFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/bookmark-works-sp-list.tsx"},"span":[853,866],"sourceCode":"import { Badge } from \"~/components/ui/badge\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { toAccessTypeText } from \"~/utils/work/to-access-type-text\"\nimport { Link } from \"@remix-run/react\"\nimport { EyeIcon, FolderIcon, HeartIcon, MessageCircle } from \"lucide-react\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\nimport { toDateTimeText } from \"~/utils/to-date-time-text\"\n\ntype Props = {\n  works: FragmentOf<typeof BookmarkWorksSpListItemFragment>[]\n}\n\n/**\n * ã‚¹ãƒãƒ›å‘ã‘ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ä½œå“ä¸€è¦§\n */\nexport function BookmarkWorksSpList (props: Props) {\n  const truncateTitle = (title: string, maxLength: number) => {\n    return title.length > maxLength ? `${title.slice(0, maxLength)}...` : title\n  }\n\n  return (\n    <>\n      {props.works.map((work, index) => (\n        // biome-ignore lint/suspicious/noArrayIndexKey: <explanation>\n        <div key={index}>\n          <div className=\"mt-2 mb-2 flex\">\n            <Link to={`/posts/${work.id}`} className=\"mr-2\">\n              <img\n                src={work.smallThumbnailImageURL}\n                alt=\"\"\n                className=\"mr-4 h-[72px] w-[72px] min-w-[72px] rounded-md object-cover\"\n              />\n            </Link>\n            <div className=\"w-full space-y-2\">\n              <div className=\"w-full space-y-2\">\n                <Link to={`/posts/${work.id}`}>\n                  <div className=\"w-full font-bold\">\n                    {truncateTitle(work.title, 32)}\n                  </div>\n                </Link>\n                <Badge variant={\"secondary\"}>\n                  {toAccessTypeText(work.accessType)}\n                </Badge>\n                <div className=\"text-sm opacity-80\">\n                  {toDateTimeText(work.createdAt)}\n                </div>\n              </div>\n              <div className=\"flex w-full items-center justify-between\">\n                <div className=\"flex items-center\">\n                  <FolderIcon className=\"mr-1 size-4\" />\n                  {work.bookmarksCount}\n                </div>\n                <div className=\"flex items-center\">\n                  <HeartIcon className=\"mr-1 size-4\" />\n                  {work.likesCount}\n                </div>\n                <div className=\"flex items-center\">\n                  <EyeIcon className=\"mr-1 size-4\" />\n                  {work.viewsCount}\n                </div>\n              </div>\n              <div className=\"flex items-center\">\n                <MessageCircle className=\"mr-1 size-4\" />\n                {work.commentsCount}\n              </div>\n            </div>\n          </div>\n          <Separator />\n        </div>\n      ))}\n    </>\n  )\n}\n\nexport const BookmarkWorksSpListItemFragment = graphql(\n  `fragment BookmarkWorksSpListItem on WorkNode @_unmask {\n    id\n    title\n    smallThumbnailImageURL\n    likesCount\n    bookmarksCount\n    commentsCount\n    viewsCount\n    accessType\n    createdAt\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable tokenRefetch is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"tokenRefetch"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/create-album-dialog.tsx"},"span":[1911,1923],"sourceCode":"import { PlusIcon } from \"lucide-react\"\nimport { Suspense, useContext, useState } from \"react\"\nimport {\n  Dialog,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { getBase64FromImageUrl } from \"~/utils/get-base64-from-image-url\"\nimport { CropImageField } from \"~/components/crop-image-field\"\nimport { Input } from \"~/components/ui/input\"\nimport { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { Button } from \"~/components/ui/button\"\nimport {\n  type DialogWorkFragment,\n  SelectCreatedWorksDialog,\n} from \"~/routes/($lang).my._index/components/select-created-works-dialog\"\nimport { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport { createRandomString } from \"~/routes/($lang).generation._index/utils/create-random-string\"\nimport { toast } from \"sonner\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\n\ntype Props = {\n  children: React.ReactNode\n  refetch: () => void\n}\n\n/**\n * ã‚·ãƒªãƒ¼ã‚ºä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ«ã®é …ç›®\n */\nexport function CreateAlbumDialog (props: Props) {\n  const appContext = useContext(AuthContext)\n\n  const [isOpen, setIsOpen] = useState<boolean>(false)\n\n  const [thumbnailImageBase64, setThumbnailImageBase64] = useState<string>(\"\")\n\n  const [title, setTitle] = useState<string>(\"\")\n\n  const [slug, setSlug] = useState<string>(\"\")\n\n  const [description, setDescription] = useState<string>(\"\")\n\n  const [selectedWorks, setSelectedWorks] = useState<\n    FragmentOf<typeof DialogWorkFragment>[]\n  >([])\n\n  const [isCreating, setIsCreating] = useState<boolean>(false)\n\n  const [createAlbum] = useMutation(createAlbumMutation)\n\n  const { data: token, refetch: tokenRefetch } = useQuery(viewerTokenQuery)\n\n  const handleSlugChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const value = event.target.value\n    const alphanumericValue = value.replace(/[^a-zA-Z0-9]/g, \"\") // Remove non-alphanumeric characters\n    setSlug(alphanumericValue)\n  }\n\n  /**\n   * ã‚¯ãƒ­ãƒƒãƒ—å®Œäº†\n   * @param croppedImage ã‚¯ãƒ­ãƒƒãƒ—ã—ãŸç”»åƒ\n   */\n  const onCrop = async (croppedImage: string) => {\n    const base64 = await getBase64FromImageUrl(croppedImage)\n    setThumbnailImageBase64(base64)\n  }\n\n  /**\n   * ç”»åƒãƒªã‚»ãƒƒãƒˆ\n   */\n  const onReset = () => {\n    setThumbnailImageBase64(\"\")\n  }\n\n  /**\n   * ã‚·ãƒªãƒ¼ã‚ºä½œæˆ\n   */\n  const onCreateAlbum = async () => {\n    if (appContext.userId === null) {\n      toast(\"ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    const trimmedTitle = title.trim()\n\n    const trimmedSlug = slug.trim()\n\n    // ã‚¿ã‚¤ãƒˆãƒ«ãŒæœªå…¥åŠ›ã®å ´åˆ\n    if (trimmedTitle === \"\") {\n      toast(\"ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    // ãƒªãƒ³ã‚¯åãŒæœªå…¥åŠ›ã®å ´åˆ\n    if (trimmedSlug === \"\") {\n      toast(\"ãƒªãƒ³ã‚¯åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    // ä½œå“ãŒæœªé¸æŠã®å ´åˆ\n    if (selectedWorks.length === 0) {\n      toast(\"ä½œå“ã‚’é¸æŠã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    setIsCreating(true)\n\n    try {\n      if (thumbnailImageBase64) {\n        // ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒãŒå­˜åœ¨ã™ã‚‹ãªã‚‰ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹\n        const _imageFileName = `${createRandomString(32)}.webp`\n\n        const thumbnailUrl = await uploadPublicImage(\n          thumbnailImageBase64,\n          token?.viewer?.token,\n        )\n\n        await createAlbum({\n          variables: {\n            input: {\n              title: trimmedTitle,\n              slug: trimmedSlug,\n              description: description,\n              thumbnailUrl: thumbnailUrl,\n              workIds: selectedWorks.map((work) => work.id),\n            },\n          },\n        })\n        setIsCreating(false)\n        setIsOpen(false)\n        toast(\"ã‚·ãƒªãƒ¼ã‚ºã‚’è¿½åŠ ã—ã¾ã—ãŸ\")\n        props.refetch()\n        return\n      }\n\n      await createAlbum({\n        variables: {\n          input: {\n            title: trimmedTitle,\n            slug: trimmedSlug,\n            description: description,\n            workIds: selectedWorks.map((work) => work.id),\n          },\n        },\n      })\n      setIsCreating(false)\n      setIsOpen(false)\n      toast(\"ã‚·ãƒªãƒ¼ã‚ºã‚’è¿½åŠ ã—ã¾ã—ãŸ\")\n      props.refetch()\n    } catch (_error) {\n      setIsCreating(false)\n      setIsOpen(false)\n      toast(\"ã‚·ãƒªãƒ¼ã‚ºè¿½åŠ ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n    }\n  }\n\n  return (\n    <>\n      <Dialog\n        open={isOpen}\n        onOpenChange={(isOpen) => {\n          setIsOpen((prev) => (prev !== isOpen ? isOpen : prev))\n        }}\n      >\n        <DialogTrigger asChild>{props.children}</DialogTrigger>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>ã‚·ãƒªãƒ¼ã‚ºä½œæˆ</DialogTitle>\n          </DialogHeader>\n          <ScrollArea className=\"overflow-y-auto\">\n            <div className=\"max-h-[80vh] space-y-4 md:max-h-[100%]\">\n              <div className=\"space-y-1\">\n                <div className=\"flex space-x-2\">\n                  <p className=\"font-bold text-sm\">ã‚«ãƒãƒ¼</p>\n                </div>\n                <CropImageField\n                  isHidePreviewImage={false}\n                  cropWidth={1200}\n                  cropHeight={627}\n                  onDeleteImage={onReset}\n                  onCrop={onCrop}\n                  fileExtension={\"webp\"}\n                />\n                <p className=\"text-sm\">\n                  ã‚«ãƒãƒ¼ã«ã¯R18éƒ¨åˆ†ã‚’å«ã¾ãªã„ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚\n                </p>\n              </div>\n              <div className=\"space-y-1\">\n                <div className=\"flex space-x-2\">\n                  <p className=\"font-bold text-sm\">ã‚¿ã‚¤ãƒˆãƒ«</p>\n                  <p className=\"text-sm opacity-50\">*å¿…é ˆ</p>\n                </div>\n                <Input\n                  placeholder=\"ã‚·ãƒªãƒ¼ã‚ºã®åå‰\"\n                  value={title}\n                  type={\"text\"}\n                  onChange={(event) => {\n                    setTitle(event.target.value)\n                  }}\n                  maxLength={32}\n                />\n              </div>\n              <div className=\"space-y-1\">\n                <div className=\"flex space-x-2\">\n                  <p className=\"font-bold text-sm\">ãƒªãƒ³ã‚¯å(è‹±æ•°å­—ã®ã¿)</p>\n                  <p className=\"text-sm opacity-50\">*å¿…é ˆ</p>\n                </div>\n                <Input\n                  placeholder=\"URLã«ä½¿ç”¨ã•ã‚Œã‚‹ãƒªãƒ³ã‚¯å(/series/â—â—)\"\n                  value={slug}\n                  type=\"text\"\n                  onChange={handleSlugChange}\n                  maxLength={32}\n                />\n                <p className=\"text-sm opacity-80\">\n                  {`https://beta.aipictors.com/${appContext.userId}/series/${slug}`}\n                </p>\n              </div>\n\n              <div className=\"space-y-1\">\n                <div className=\"flex space-x-2\">\n                  <p className=\"font-bold text-sm\">èª¬æ˜</p>\n                  <p className=\"text-sm opacity-50\">*å¿…é ˆ</p>\n                </div>\n                <AutoResizeTextarea\n                  placeholder=\"ã‚·ãƒªãƒ¼ã‚ºã®èª¬æ˜\"\n                  value={description}\n                  onChange={(event) => {\n                    setDescription(event.target.value)\n                  }}\n                  maxLength={160}\n                />\n              </div>\n              <div className=\"space-y-1\">\n                <div className=\"flex space-x-2\">\n                  <p className=\"font-bold text-sm\">ä½œå“</p>\n                  <p className=\"text-sm opacity-50\">*å¿…é ˆ</p>\n                </div>\n                <Suspense fallback={<AppLoadingPage />}>\n                  <SelectCreatedWorksDialog\n                    selectedWorks={selectedWorks}\n                    setSelectedWorks={setSelectedWorks}\n                  >\n                    <div className=\"border-2 border-transparent p-1\">\n                      <Button\n                        className=\"size-16\"\n                        size={\"icon\"}\n                        variant={\"secondary\"}\n                      >\n                        <PlusIcon />\n                      </Button>\n                    </div>\n                  </SelectCreatedWorksDialog>\n                </Suspense>\n              </div>\n            </div>\n          </ScrollArea>\n          <Button disabled={isCreating} onClick={onCreateAlbum}>\n            ä¿å­˜ã—ã¦è¿½åŠ \n          </Button>\n          <Button\n            variant={\"secondary\"}\n            onClick={() => {\n              setIsOpen(false)\n            }}\n          >\n            ã‚­ãƒ£ãƒ³ã‚»ãƒ«\n          </Button>\n        </DialogContent>\n      </Dialog>\n    </>\n  )\n}\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst createAlbumMutation = graphql(\n  `mutation CreateAlbum($input: CreateAlbumInput!) {\n    createAlbum(input: $input) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/folders-list-column.tsx"},"span":[521,534],"sourceCode":"import type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport type { SortType } from \"~/types/sort-type\"\nimport { ChevronDown, ChevronUp } from \"lucide-react\"\n\ntype Props = {\n  label: string\n  orderBy: IntrospectionEnum<\"FolderOrderBy\">\n  nowOrderBy: IntrospectionEnum<\"FolderOrderBy\">\n  sort: SortType\n  onClick: () => void\n}\n\n/**\n * ã‚·ãƒªãƒ¼ã‚ºä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ \n */\nexport function FoldersListColumn (props: Props) {\n  return (\n    <>\n      {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n      <div onClick={props.onClick} className=\"cursor-pointer\">\n        <div className=\"flex items-center\">\n          {props.label}\n          {props.orderBy === props.nowOrderBy &&\n            (props.sort === \"ASC\" ? <ChevronUp /> : <ChevronDown />)}\n        </div>\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/folders-list-table.tsx"},"span":[1888,1901],"sourceCode":"import {\n  Table,\n  TableHeader,\n  TableRow,\n  TableHead,\n  TableBody,\n} from \"~/components/ui/table\"\nimport type { SortType } from \"~/types/sort-type\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport {\n  FoldersListTableRow,\n  FolderTableRowFragment,\n} from \"~/routes/($lang).my._index/components/folders-list-table-row\"\nimport { FoldersListColumn } from \"~/routes/($lang).my._index/components/folders-list-column\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\n\ntype Props = {\n  folders: FragmentOf<typeof FolderTableItemFragment>[]\n  sort: SortType\n  orderBy: IntrospectionEnum<\"FolderOrderBy\">\n  onClickTitleSortButton: () => void\n  onClickDateSortButton: () => void\n}\n\n/**\n * ã‚·ãƒªãƒ¼ã‚ºä¸€è¦§\n */\nexport function FoldersListTable (props: Props) {\n  return (\n    <>\n      <ScrollArea className=\"overflow-x-auto\">\n        <Table className=\"w-full\">\n          <TableHeader>\n            <TableRow>\n              <TableHead>\n                <FoldersListColumn\n                  label=\"ã‚¿ã‚¤ãƒˆãƒ«\"\n                  orderBy=\"NAME\"\n                  nowOrderBy={props.orderBy}\n                  sort={props.sort}\n                  onClick={props.onClickTitleSortButton}\n                />\n              </TableHead>\n              <TableHead>{}</TableHead>\n              <TableHead>{}</TableHead>\n              <TableHead>\n                <FoldersListColumn\n                  label=\"æ—¥ä»˜\"\n                  orderBy=\"DATE_CREATED\"\n                  nowOrderBy={props.orderBy}\n                  sort={props.sort}\n                  onClick={props.onClickDateSortButton}\n                />\n              </TableHead>\n            </TableRow>\n          </TableHeader>\n          <TableBody>\n            {props.folders.map((folder, index) => (\n              // biome-ignore lint/suspicious/noArrayIndexKey: <explanation>\n              <FoldersListTableRow folder={folder} key={index} />\n            ))}\n          </TableBody>\n        </Table>\n      </ScrollArea>\n    </>\n  )\n}\n\nexport const FolderTableItemFragment = graphql(\n  `fragment FolderTableItem on FolderNode @_unmask {\n    ...FolderTableRow\n  }`,\n  [FolderTableRowFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable refetch is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"refetch"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/like-list-container.tsx"},"span":[785,792],"sourceCode":"import { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext } from \"react\"\nimport {\n  BookmarkWorksList,\n  BookmarkWorksListItemFragment,\n} from \"~/routes/($lang).my._index/components/bookmark-works-list\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\n\ntype Props = {\n  page: number\n  maxCount: number\n  setPage: (page: number) => void\n}\n\n/**\n * ã„ã„ã­ä¸€è¦§ã‚³ãƒ³ãƒ†ãƒŠ\n */\nexport function LikeListContainer (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  if (\n    authContext.isLoading ||\n    authContext.isNotLoggedIn ||\n    authContext.userId === undefined ||\n    !authContext.userId\n  ) {\n    return null\n  }\n  const { data: userResp, refetch } = useQuery(userQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      likesOffset: 16 * props.page,\n      likesLimit: 16,\n      userId: decodeURIComponent(authContext.userId),\n    },\n  })\n\n  const works = userResp?.user?.likedWorks ?? []\n\n  return (\n    <>\n      <BookmarkWorksList works={works} />\n      <div className=\"h-8\" />\n      <div className=\"-translate-x-1/2 fixed bottom-0 left-1/2 z-10 w-full border-border/40 bg-background/95 p-2 backdrop-blur-sm supports-backdrop-filter:bg-background/80\">\n        <ResponsivePagination\n          perPage={16}\n          maxCount={props.maxCount}\n          currentPage={props.page}\n          onPageChange={(page: number) => {\n            props.setPage(page)\n          }}\n        />\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n    $likesOffset: Int!,\n    $likesLimit: Int!,\n    $likesWhere: UserWorksWhereInput,\n  ) {\n    user(id: $userId) {\n      id\n      likedWorks(offset: $likesOffset, limit: $likesLimit, where: $likesWhere) {\n        ...BookmarkWorksListItem\n      }\n    }\n  }`,\n  [BookmarkWorksListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable refetch is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"refetch"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/recommended-list-container.tsx"},"span":[634,641],"sourceCode":"import { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext } from \"react\"\nimport { useSuspenseQuery } from \"@apollo/client/index\"\nimport {\n  RecommendedWorkListItemFragment,\n  RecommendedWorksList,\n} from \"~/routes/($lang).my._index/components/recommended-works-list\"\nimport { graphql } from \"gql.tada\"\n\n/**\n * æ¨è–¦ä¸€è¦§ã‚³ãƒ³ãƒ†ãƒŠ\n */\nexport function RecommendedListContainer () {\n  const authContext = useContext(AuthContext)\n\n  if (\n    authContext.isLoading ||\n    authContext.isNotLoggedIn ||\n    authContext.userId === undefined ||\n    !authContext.userId\n  ) {\n    return null\n  }\n  const { data: worksResp, refetch } = useSuspenseQuery(worksQuery, {\n    skip:\n      authContext.isLoading || authContext.isNotLoggedIn || !authContext.userId,\n    variables: {\n      offset: 0,\n      limit: 16,\n      where: {\n        isRecommended: true,\n        recommendedWorksUserId: authContext.userId,\n        isNowCreatedAt: true,\n        ratings: [\"G\", \"R18G\", \"R15\", \"R18\"],\n      },\n    },\n  })\n\n  const works = worksResp?.works ?? []\n\n  return (\n    <>\n      <RecommendedWorksList works={works} />\n    </>\n  )\n}\n\nconst worksQuery = graphql(\n  `query Works($offset: Int!, $limit: Int!, $where: WorksWhereInput) {\n    works(offset: $offset, limit: $limit, where: $where) {\n      ...RecommendedWorkListItem\n    }\n  }`,\n  [RecommendedWorkListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/recommended-works-sp-list.tsx"},"span":[638,651],"sourceCode":"import { Badge } from \"~/components/ui/badge\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { toAccessTypeText } from \"~/utils/work/to-access-type-text\"\nimport { Link } from \"@remix-run/react\"\nimport { EyeIcon, FolderIcon, HeartIcon, MessageCircle } from \"lucide-react\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\n\ntype Props = {\n  works: FragmentOf<typeof MobileRecommendedWorkItemFragment>[]\n}\n\n/**\n * ã‚¹ãƒãƒ›å‘ã‘æ¨è–¦ä½œå“ä¸€è¦§\n */\nexport function RecommendedWorksSpList (props: Props) {\n  return (\n    <>\n      {props.works.map((work, index) => (\n        // biome-ignore lint/suspicious/noArrayIndexKey: <explanation>\n        <div key={index}>\n          <div className=\"mt-2 mb-2 flex\">\n            <Link to={`/posts/${work.id}`} className=\"mr-2\">\n              <img\n                src={work.smallThumbnailImageURL}\n                alt=\"\"\n                className=\"mr-4 h-[72px] w-[72px] min-w-[72px] rounded-md object-cover\"\n              />\n            </Link>\n            <div className=\"w-full space-y-2\">\n              <div className=\"w-full space-y-2\">\n                <Link to={`/posts/${work.id}`}>\n                  <div className=\"w-full font-bold\">{work.title}</div>\n                </Link>\n                <Badge variant={\"secondary\"}>\n                  {toAccessTypeText(work.accessType)}\n                </Badge>\n                <div className=\"text-sm opacity-80\">{work.createdAt}</div>\n              </div>\n              <div className=\"flex w-full items-center justify-between\">\n                <div className=\"flex items-center\">\n                  <FolderIcon className=\"mr-1 size-4\" />\n                  {work.bookmarksCount}\n                </div>\n                <div className=\"flex items-center\">\n                  <HeartIcon className=\"mr-1 size-4\" />\n                  {work.likesCount}\n                </div>\n                <div className=\"flex items-center\">\n                  <EyeIcon className=\"mr-1 size-4\" />\n                  {work.viewsCount}\n                </div>\n              </div>\n              <div className=\"flex items-center\">\n                <MessageCircle className=\"mr-1 size-4\" />\n                {work.commentsCount}\n              </div>\n            </div>\n          </div>\n          <Separator />\n        </div>\n      ))}\n    </>\n  )\n}\n\nexport const MobileRecommendedWorkItemFragment = graphql(\n  `fragment MobileRecommendedWorkItem on WorkNode @_unmask {\n    id\n    title\n    smallThumbnailImageURL\n    accessType\n    createdAt\n    bookmarksCount\n    likesCount\n    viewsCount\n    commentsCount\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable loading is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"loading"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/reported-list-container.tsx"},"span":[1092,1099],"sourceCode":"import { useContext, useState } from \"react\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { graphql } from \"gql.tada\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { CroppedWorkSquare } from \"~/components/cropped-work-square\"\nimport { Link } from \"@remix-run/react\"\nimport { Button } from \"~/components/ui/button\"\nimport { PencilIcon } from \"lucide-react\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { cn } from \"~/lib/utils\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  page: number\n  maxCount: number\n  setPage: (page: number) => void\n}\n\nexport function ModerationReportsContainer (_props: Props) {\n  const t = useTranslation()\n  const [page, setPage] = useState(0)\n  const [statusFilter, setStatusFilter] = useState<\n    \"ALL\" | \"DONE\" | \"NO_NEED_ACTION\" | \"UNHANDLED\"\n  >(\"ALL\")\n\n  const authContext = useContext(AuthContext)\n\n  const itemsPerPage = 120\n\n  const {\n    data: reports,\n    refetch,\n    loading,\n  } = useQuery(moderationReportsQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      offset: itemsPerPage * page,\n      limit: itemsPerPage,\n      where: {\n        userId: authContext.userId,\n      },\n    },\n  })\n\n  const reportList = reports?.moderationReports ?? []\n\n  const _handlePageChange = (newPage: number) => {\n    setPage(newPage)\n    refetch()\n  }\n\n  const statusLabel = (\n    status: \"DONE\" | \"NO_NEED_ACTION\" | \"UNHANDLED\" | null,\n  ) => {\n    switch (status) {\n      case \"DONE\":\n        return t(\"å¯¾å¿œå®Œäº†\", \"Resolved\")\n      case \"NO_NEED_ACTION\":\n        return t(\"å¯¾å¿œä¸è¦\", \"No Action Needed\")\n      case \"UNHANDLED\":\n        return t(\"æœªå¯¾å¿œ\", \"Unresolved\")\n      default:\n        return t(\"æœªå¯¾å¿œ\", \"Unresolved\")\n    }\n  }\n\n  const editUrl = (id: string, workType: IntrospectionEnum<\"WorkType\">) => {\n    if (workType === \"WORK\") {\n      return `/posts/${id}/image/edit`\n    }\n    if (workType === \"VIDEO\") {\n      return `/posts/${id}/animation/edit`\n    }\n    if (workType === \"COLUMN\" || workType === \"NOVEL\") {\n      return `/posts/${id}/text/edit`\n    }\n\n    return \"/\"\n  }\n\n  const filteredReportList = reportList.filter((report) => {\n    if (statusFilter === \"ALL\") return true\n    return report.status === statusFilter\n  })\n\n  return (\n    <div className=\"container mx-auto p-4\">\n      <div className=\"mb-4 flex flex-col gap-x-4 gap-y-4 md:flex-row md:gap-y-9\">\n        <div className=\"flex space-x-4\">\n          <Button\n            onClick={() => setStatusFilter(\"ALL\")}\n            variant={\"secondary\"}\n            className={cn(\n              \"w-full px-4 py-2 transition-colors duration-200 md:w-auto\",\n              statusFilter === \"ALL\" ? \"opacity-50\" : \"\",\n            )}\n          >\n            {t(\"ã™ã¹ã¦\", \"All\")}\n          </Button>\n          <Button\n            onClick={() => setStatusFilter(\"DONE\")}\n            variant={\"secondary\"}\n            className={cn(\n              \"w-full px-4 py-2 transition-colors duration-200 md:w-auto\",\n              statusFilter === \"DONE\" ? \"opacity-50\" : \"\",\n            )}\n          >\n            {t(\"å¯¾å¿œå®Œäº†\", \"Resolved\")}\n          </Button>\n        </div>\n        <div className=\"flex space-x-4\">\n          <Button\n            onClick={() => setStatusFilter(\"NO_NEED_ACTION\")}\n            variant={\"secondary\"}\n            className={cn(\n              \"w-full px-4 py-2 transition-colors duration-200 md:w-auto\",\n              statusFilter === \"NO_NEED_ACTION\" ? \"opacity-50\" : \"\",\n            )}\n          >\n            {t(\"å¯¾å¿œä¸è¦\", \"No Action Needed\")}\n          </Button>\n          <Button\n            onClick={() => setStatusFilter(\"UNHANDLED\")}\n            variant={\"secondary\"}\n            className={cn(\n              \"w-full px-4 py-2 transition-colors duration-200 md:w-auto\",\n              statusFilter === \"UNHANDLED\" ? \"opacity-50\" : \"\",\n            )}\n          >\n            {t(\"æœªå¯¾å¿œ\", \"Unresolved\")}\n          </Button>\n        </div>\n      </div>\n      {filteredReportList.map(\n        (report) =>\n          report && (\n            <Card key={report.id.toString()} className=\"rounded-none\">\n              <CardContent className=\"flex flex-col items-center space-x-2 space-y-2 p-4 md:flex-row\">\n                {report.work && (\n                  <div className=\"size-32\">\n                    <CroppedWorkSquare\n                      workId={report.work?.id}\n                      subWorksCount={report.work.subWorksCount}\n                      imageUrl={report.work.smallThumbnailImageURL}\n                      thumbnailImagePosition={\n                        report.work.thumbnailImagePosition ?? 0\n                      }\n                      size=\"md\"\n                      imageWidth={report.work.smallThumbnailImageWidth}\n                      imageHeight={report.work.smallThumbnailImageHeight}\n                    />\n                  </div>\n                )}\n                <div className=\"flex w-full flex-col space-y-2\">\n                  <span className=\"font-bold\">\n                    {t(\n                      `ã€Œ${report.work?.title}ã€`,\n                      `ã€Œ${report.work?.title}ã€`,\n                    )}\n                  </span>\n                  <p className=\"mb-2\">{report.reportMessage}</p>\n                  {report.customMessage && (\n                    <p className=\"text-sm italic\">\n                      {t(\n                        \"è¿½åŠ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: {message}\",\n                        `è¿½åŠ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: ${report.customMessage}`,\n                      )}\n                    </p>\n                  )}\n                  <div className=\"flex space-x-2\">\n                    <Badge\n                      variant={report.isRead ? \"secondary\" : \"destructive\"}\n                    >\n                      {report.isRead ? t(\"æ—¢èª­\", \"Read\") : t(\"æœªèª­\", \"Unread\")}\n                    </Badge>\n                    <Badge\n                      variant={\n                        report.status === \"NO_NEED_ACTION\" ||\n                        report.status === \"DONE\"\n                          ? \"secondary\"\n                          : \"default\"\n                      }\n                    >\n                      {statusLabel(report.status)}\n                    </Badge>\n                  </div>\n                  {report.responseMessage && (\n                    <p className=\"text-muted-foreground text-sm\">\n                      {t(\"ã‚ãªãŸã®è¿”ä¿¡\", \"Your Response\")}:\n                      {`ã€Œ${report.responseMessage}ã€`}\n                    </p>\n                  )}\n                </div>\n                {report.work && (\n                  <Link\n                    className=\"w-full md:w-auto\"\n                    to={editUrl(\n                      report.work?.id,\n                      report.work?.type as\n                        | \"COLUMN\"\n                        | \"NOVEL\"\n                        | \"VIDEO\"\n                        | \"WORK\",\n                    )}\n                  >\n                    <Button\n                      className=\"w-full space-x-2\"\n                      aria-label={t(\"ç·¨é›†\", \"Edit\")}\n                      variant=\"secondary\"\n                    >\n                      <PencilIcon width={16} />\n                      <p>{t(\"ç·¨é›†\", \"Edit\")}</p>\n                    </Button>\n                  </Link>\n                )}\n              </CardContent>\n            </Card>\n          ),\n      )}\n    </div>\n  )\n}\n\nconst ModerationReportFragment = graphql(`\n  fragment ModerationReportItem on ModerationReportNode @_unmask {\n    id\n    createdAt\n    work {\n      id\n      title\n      user {\n        id\n        name\n      }\n      smallThumbnailImageURL\n      subWorksCount\n      thumbnailImagePosition\n      smallThumbnailImageWidth\n      smallThumbnailImageHeight\n      type\n    }\n    customMessage\n    isRead\n    responseMessage\n    status\n    reportMessage\n  }\n`)\n\nconst moderationReportsQuery = graphql(\n  `\n  query ModerationReports($offset: Int!, $limit: Int!, $where: ModerationReportsWhereInput!) {\n    moderationReports(offset: $offset, limit: $limit, where: $where) {\n      ...ModerationReportItem\n    }\n  }\n`,\n  [ModerationReportFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/select-created-works-dialog-with-ids.tsx"},"span":[5008,5021],"sourceCode":"import { useContext, useState } from \"react\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Button } from \"~/components/ui/button\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { ImageIcon, CheckIcon, PlusIcon } from \"lucide-react\"\nimport { Tabs, TabsList, TabsTrigger } from \"~/components/ui/tabs\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n// ----- dnd-kit -----\nimport {\n  DndContext,\n  DragOverlay,\n  PointerSensor,\n  TouchSensor,\n  useSensor,\n  useSensors,\n  closestCenter,\n  type DragStartEvent,\n  type DragEndEvent,\n} from \"@dnd-kit/core\"\nimport {\n  SortableContext,\n  useSortable,\n  arrayMove,\n  rectSortingStrategy,\n} from \"@dnd-kit/sortable\"\nimport { CSS } from \"@dnd-kit/utilities\"\n\ntype Props = {\n  selectedWorkIds: string[]\n  setSelectedWorkIds: (workIds: string[]) => void\n  limit?: number\n}\n\n/**\n * ä½œæˆæ¸ˆã¿ã®ä½œå“é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function SelectCreatedWorksDialogWithIds (props: Props) {\n  const t = useTranslation()\n  const appContext = useContext(AuthContext)\n\n  const [isOpen, setIsOpen] = useState<boolean>(false)\n  const [page, setPage] = useState(0) // \"æœªé¸æŠ\"ã‚¿ãƒ–ç”¨ãƒšãƒ¼ã‚¸\n  const [selectedPage, setSelectedPage] = useState(0) // \"é¸æŠä¸­\"ã‚¿ãƒ–ç”¨ãƒšãƒ¼ã‚¸\n  const [tab, setTab] = useState<\"NO_SELECTED\" | \"SELECTED\">(\"NO_SELECTED\")\n\n  // ä¸¦ã³æ›¿ãˆãƒˆã‚°ãƒ« (true ã§ãƒ‰ãƒ©ãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰)\n  const [isDragMode, setIsDragMode] = useState(false)\n\n  // ======== æœªé¸æŠã‚¿ãƒ–ç”¨ã‚¯ã‚¨ãƒª (å…¨ä½œå“ + ãƒšãƒ¼ã‚¸ãƒ³ã‚°) ========\n  const worksResult = useQuery(worksQuery, {\n    skip: appContext.isLoading,\n    variables: {\n      offset: page * 32,\n      limit: 32,\n      where: {\n        userId: appContext.userId,\n        orderBy: \"DATE_CREATED\",\n        sort: \"DESC\",\n      },\n    },\n  })\n  const works = worksResult.data?.works ?? []\n\n  // ======== å…¨ä½œå“æ•° (æœªé¸æŠã‚¿ãƒ–ã®ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³) ========\n  const worksCountResp = useQuery(worksCountQuery, {\n    skip: appContext.isLoading,\n    variables: {\n      where: {\n        userId: appContext.userId,\n      },\n    },\n  })\n  const worksMaxCount = worksCountResp.data?.worksCount ?? 0\n\n  // ======== é¸æŠä¸­ã‚¿ãƒ–ç”¨ã‚¯ã‚¨ãƒª (selectedWorkIds ã«åˆè‡´ã™ã‚‹ä½œå“) ========\n  const selectedWorksResult = useQuery(worksQuery, {\n    skip: appContext.isLoading || props.selectedWorkIds.length === 0,\n    variables: {\n      offset: selectedPage * 32,\n      limit: 32,\n      where: {\n        ids: props.selectedWorkIds,\n        orderBy: \"DATE_CREATED\",\n        sort: \"DESC\",\n      },\n    },\n  })\n\n  const selectedWorksQueryData = selectedWorksResult.data?.works ?? []\n\n  // ======== é¸æŠä¸­ã‚¿ãƒ–ã®ä½œå“ç·æ•° (ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³) ========\n  const selectedWorksCountResp = useQuery(worksCountQuery, {\n    skip: appContext.isLoading || props.selectedWorkIds.length === 0,\n    variables: {\n      where: {\n        ids: props.selectedWorkIds,\n      },\n    },\n  })\n  const selectedWorksMaxCount = selectedWorksCountResp.data?.worksCount ?? 0\n\n  // ======== ã‚¿ã‚¤ãƒˆãƒ«ã‚’çœç•¥ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼ ========\n  const truncateTitle = (title: string, maxLength: number) =>\n    title.length > maxLength ? `${title.slice(0, maxLength)}...` : title\n\n  // ======== (æœªé¸æŠã‚¿ãƒ–) ä½œå“ã‚¯ãƒªãƒƒã‚¯ ========\n  const handleWorkClick = (work: FragmentOf<typeof DialogWorkFragment>) => {\n    const isAlreadySelected = props.selectedWorkIds.includes(work.id)\n    if (isAlreadySelected) {\n      // é¸æŠè§£é™¤\n      const newIds = props.selectedWorkIds.filter((id) => id !== work.id)\n      props.setSelectedWorkIds(newIds)\n    } else {\n      // æ–°è¦é¸æŠ\n      if (!props.limit || props.selectedWorkIds.length < props.limit) {\n        const newIds = [...props.selectedWorkIds, work.id]\n        props.setSelectedWorkIds(newIds)\n      } else {\n        toast(\n          t(\n            `é¸æŠã§ãã‚‹ä½œå“æ•°ã¯${props.limit}ã¤ã¾ã§ã§ã™ã€‚`,\n            `You can select up to ${props.limit} works.`,\n          ),\n        )\n      }\n    }\n  }\n\n  // ======== ã€Œé¸æŠä¸­ã€ã‚¿ãƒ–ã§è¡¨ç¤ºã™ã‚‹ä½œå“ã‚’ ID ã®é †ç•ªã«ä¸¦ã³æ›¿ãˆãŸé…åˆ—ã‚’ç”Ÿæˆ ========\n  // DnD ãªã©ã§ä¸¦ã³é †ã‚’å¤‰æ›´ã™ã‚‹ã¨ãã¯ã€props.selectedWorkIds ã“ããŒé †åºã®ã‚½ãƒ¼ã‚¹ã«ãªã‚‹æƒ³å®šã€‚\n  const sortedSelectedWorks = props.selectedWorkIds\n    .map((id) => selectedWorksQueryData.find((w) => w.id === id))\n    .filter(Boolean) as FragmentOf<typeof DialogWorkFragment>[]\n\n  // ======== æœªé¸æŠã‚¿ãƒ–ã®æç”» ========\n  const renderWorks = (\n    worksToRender: FragmentOf<typeof DialogWorkFragment>[],\n  ) => {\n    return worksToRender.map((work) => (\n      <div key={work.id}>\n        {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n        <div\n          className=\"relative m-2 size-24 cursor-pointer\"\n          onClick={() => handleWorkClick(work)}\n        >\n          <img\n            className=\"size-24 rounded-md object-cover\"\n            src={work.smallThumbnailImageURL}\n            alt=\"\"\n          />\n          <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n            {truncateTitle(work.title, 8)}\n          </div>\n          {/* é¸æŠæ¸ˆã¿ã ã£ãŸã‚‰ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¤ã‚³ãƒ³ */}\n          {props.selectedWorkIds.includes(work.id) && (\n            <div className=\"absolute top-1 left-1 rounded-full border-2 bg-black dark:bg-white\">\n              <CheckIcon className=\"p-1 text-white dark:text-black\" />\n            </div>\n          )}\n        </div>\n      </div>\n    ))\n  }\n\n  // ========== ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—é–¢é€£ (SELECTED ã‚¿ãƒ–) ==========\n  const [activeDragItem, setActiveDragItem] = useState<FragmentOf<\n    typeof DialogWorkFragment\n  > | null>(null)\n\n  const sensors = useSensors(useSensor(PointerSensor), useSensor(TouchSensor))\n\n  // ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹\n  const handleDragStart = (event: DragStartEvent) => {\n    const { active } = event\n    const found = sortedSelectedWorks.find((w) => w.id === active.id)\n    if (found) {\n      setActiveDragItem(found)\n    }\n  }\n\n  // ãƒ‰ãƒ©ãƒƒã‚°çµ‚äº†\n  const handleDragEnd = (event: DragEndEvent) => {\n    const { active, over } = event\n    if (!over) {\n      setActiveDragItem(null)\n      return\n    }\n    if (active.id !== over.id) {\n      const oldIndex = props.selectedWorkIds.indexOf(active.id.toString())\n      const newIndex = props.selectedWorkIds.indexOf(over.id.toString())\n      // ä¸¦ã³æ›¿ãˆ\n      if (oldIndex !== -1 && newIndex !== -1) {\n        const newIds = arrayMove(props.selectedWorkIds, oldIndex, newIndex)\n        props.setSelectedWorkIds(newIds)\n      }\n    }\n    setActiveDragItem(null)\n  }\n\n  // ã‚½ãƒ¼ãƒˆå¯èƒ½ã‚¢ã‚¤ãƒ†ãƒ \n  function SortableItem({\n    work,\n  }: {\n    work: FragmentOf<typeof DialogWorkFragment>\n  }) {\n    // drag/drop ã®å‹•ä½œç®¡ç†\n    const { attributes, listeners, setNodeRef, transform, transition } =\n      useSortable({ id: work.id })\n\n    const style = {\n      transform: CSS.Transform.toString(transform),\n      transition,\n    }\n\n    return (\n      <div\n        ref={setNodeRef}\n        style={style}\n        {...attributes}\n        {...listeners}\n        // ã€Œä¸¦ã³æ›¿ãˆãƒ¢ãƒ¼ãƒ‰ã€ã§ãªã„ã¨ãã¯ã‚¯ãƒªãƒƒã‚¯ã§\"é¸æŠè§£é™¤\"\n        onClick={\n          !isDragMode\n            ? () => {\n                const newIds = props.selectedWorkIds.filter(\n                  (id) => id !== work.id,\n                )\n                props.setSelectedWorkIds(newIds)\n              }\n            : undefined\n        }\n        className={\n          isDragMode\n            ? \"relative m-2 cursor-grab\" // ä¸¦ã³æ›¿ãˆON: grabã‚«ãƒ¼ã‚½ãƒ«\n            : \"relative m-2 cursor-pointer\" // ä¸¦ã³æ›¿ãˆOFF: ã‚¯ãƒªãƒƒã‚¯è§£é™¤ç”¨\n        }\n      >\n        <img\n          className=\"size-24 rounded-md object-cover\"\n          src={work.smallThumbnailImageURL}\n          alt=\"\"\n        />\n        <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n          {truncateTitle(work.title, 8)}\n        </div>\n      </div>\n    )\n  }\n\n  // é¸æŠä¸­ã‚¿ãƒ–ã®æç”»\n  const renderSelectedWorksDnD = () => {\n    return (\n      <DndContext\n        sensors={sensors}\n        collisionDetection={closestCenter}\n        onDragStart={handleDragStart}\n        onDragEnd={handleDragEnd}\n      >\n        <SortableContext\n          items={props.selectedWorkIds} // é †ç•ªã©ãŠã‚Šã«\n          strategy={rectSortingStrategy}\n        >\n          <div className=\"flex flex-wrap\">\n            {sortedSelectedWorks.map((work) => (\n              <SortableItem key={work.id} work={work} />\n            ))}\n          </div>\n        </SortableContext>\n\n        <DragOverlay adjustScale={false} style={{ transformOrigin: \"0 0 \" }}>\n          {activeDragItem && (\n            <div className=\"size-24 border border-gray-300\">\n              <img\n                className=\"h-full w-full object-cover\"\n                src={activeDragItem.smallThumbnailImageURL}\n                alt=\"\"\n              />\n            </div>\n          )}\n        </DragOverlay>\n      </DndContext>\n    )\n  }\n\n  // ã‚‚ã—æœªé¸æŠã‚¿ãƒ–ã§ä½œå“ãŒå…¨ããªã„å ´åˆ (ã‹ã¤ã€ã‚¿ãƒ–ã‚‚NO_SELECTED) ã®ä¾‹\n  if (!works?.length && tab === \"NO_SELECTED\") {\n    return (\n      <div className=\"p-4\">\n        <ImageIcon className=\"m-auto size-8 opacity-70\" />\n        <p className=\"p-4 text-center text-sm\">\n          {t(\"ä½œå“ãŒã‚ã‚Šã¾ã›ã‚“ã€‚\", \"No works available.\")}\n        </p>\n      </div>\n    )\n  }\n\n  return (\n    <>\n      {/* ã€Œã™ã¹ã¦è¦‹ã‚‹ã€ãƒªãƒ³ã‚¯ï¼šé¸æŠä¸­ãŒ7ä»¶ã‚’è¶…ãˆãŸã‚‰è¡¨ç¤ºä¾‹ */}\n      {props.selectedWorkIds.length > 7 && (\n        // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n        <p\n          onClick={() => setIsOpen(true)}\n          className=\"m-2 cursor-pointer text-right text-sm opacity-80\"\n        >\n          {t(\n            `ã™ã¹ã¦è¦‹ã‚‹(${props.selectedWorkIds.length})`,\n            `View All (${props.selectedWorkIds.length})`,\n          )}\n        </p>\n      )}\n\n      {/* ãƒ€ã‚¤ã‚¢ãƒ­ã‚°å¤–ã§ã¯å…ˆé ­3ä»¶ã ã‘ã‚µãƒ ãƒè¡¨ç¤º */}\n      <div className=\"flex flex-wrap items-center\">\n        {sortedSelectedWorks.slice(0, 3).map((work) => (\n          <div key={work.id} className=\"relative m-2 size-16 md:h-24 md:w-24\">\n            <img\n              className=\"size-16 rounded-md object-cover md:h-24 md:w-24\"\n              src={work.smallThumbnailImageURL}\n              alt=\"\"\n            />\n            <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n              {truncateTitle(work.title, 8)}\n            </div>\n            <div className=\"absolute top-1 left-1 rounded-full border-2 bg-black dark:bg-white\">\n              <CheckIcon className=\"p-1 text-white dark:text-black\" />\n            </div>\n          </div>\n        ))}\n\n        {/* ã€Œï¼‹ã€ãƒœã‚¿ãƒ³ */}\n        <div className=\"border-2 border-transparent p-1\">\n          <Button\n            onClick={() => setIsOpen(true)}\n            className=\"size-16 md:h-24 md:w-24\"\n            size=\"icon\"\n            variant=\"secondary\"\n          >\n            <PlusIcon />\n          </Button>\n        </div>\n      </div>\n\n      {/* ãƒ€ã‚¤ã‚¢ãƒ­ã‚° */}\n      <Dialog open={isOpen} onOpenChange={(opened) => setIsOpen(opened)}>\n        <DialogContent className=\"min-h-[40vw] min-w-[88vw] pl-2\">\n          <DialogHeader>\n            <DialogTitle>{t(\"ä½œå“é¸æŠ\", \"Select Works\")}</DialogTitle>\n          </DialogHeader>\n\n          <Tabs className=\"mt-2 mb-8\" value={tab} defaultValue=\"NO_SELECTED\">\n            <TabsList>\n              <TabsTrigger\n                onClick={() => setTab(\"NO_SELECTED\")}\n                className=\"w-full\"\n                value=\"NO_SELECTED\"\n              >\n                {t(\"æœªé¸æŠ\", \"Not Selected\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => setTab(\"SELECTED\")}\n                className=\"w-full\"\n                value=\"SELECTED\"\n              >\n                {t(\"é¸æŠä¸­\", \"Selected\")}\n              </TabsTrigger>\n            </TabsList>\n          </Tabs>\n\n          <ScrollArea className=\"max-h-80 overflow-y-auto md:max-h-[100%]\">\n            {tab === \"NO_SELECTED\" && (\n              <div className=\"flex flex-wrap\">{renderWorks(works)}</div>\n            )}\n            {tab === \"SELECTED\" && (\n              <>\n                {/* ä¸¦ã³æ›¿ãˆãƒˆã‚°ãƒ« */}\n                <div className=\"mb-4 flex items-center gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => setIsDragMode(!isDragMode)}\n                  >\n                    {isDragMode\n                      ? t(\"ä¸¦ã³æ›¿ãˆçµ‚äº†\", \"Stop Sorting\")\n                      : t(\"ä¸¦ã³æ›¿ãˆ\", \"Sort\")}\n                  </Button>\n                </div>\n                {/* DnDè¡¨ç¤º or ã‚¯ãƒªãƒƒã‚¯è§£é™¤è¡¨ç¤º */}\n                {isDragMode ? (\n                  renderSelectedWorksDnD()\n                ) : (\n                  <div className=\"flex flex-wrap\">\n                    {renderWorks(sortedSelectedWorks)}\n                  </div>\n                )}\n              </>\n            )}\n          </ScrollArea>\n\n          {/* ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ */}\n          {tab === \"NO_SELECTED\" && (\n            <ResponsivePagination\n              perPage={32}\n              maxCount={worksMaxCount}\n              currentPage={page}\n              onPageChange={(p: number) => setPage(p)}\n            />\n          )}\n          {tab === \"SELECTED\" && (\n            <ResponsivePagination\n              perPage={32}\n              maxCount={selectedWorksMaxCount}\n              currentPage={selectedPage}\n              onPageChange={(p: number) => setSelectedPage(p)}\n            />\n          )}\n\n          <div className=\"mt-4 flex gap-2\">\n            <Button onClick={() => setIsOpen(false)}>\n              {t(\"æ±ºå®š\", \"Confirm\")}\n            </Button>\n            <Button variant=\"secondary\" onClick={() => setIsOpen(false)}>\n              {t(\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\", \"Cancel\")}\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </>\n  )\n}\n\n// ==== GraphQL Fragment ====\n// ä½œå“ã‚µãƒ ãƒãƒ»ã‚¿ã‚¤ãƒˆãƒ«ç”¨ã®ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆ\nexport const DialogWorkFragment = graphql(`\n  fragment DialogWork on WorkNode @_unmask {\n    id\n    title\n    smallThumbnailImageURL\n  }\n`)\n\n// ==== GraphQL Queries ====\n// ç·æ•°å–å¾— (ä»»æ„ã® where æ¡ä»¶ã«å¯¾å¿œ)\nconst worksCountQuery = graphql(`\n  query WorksCount($where: WorksWhereInput) {\n    worksCount(where: $where)\n  }\n`)\n\n// ãƒšãƒ¼ã‚¸ãƒ³ã‚°ä»˜ãä½œå“ä¸€è¦§å–å¾— (ä»»æ„ã® where æ¡ä»¶ã«å¯¾å¿œ)\nconst worksQuery = graphql(\n  `\n    query Works($offset: Int!, $limit: Int!, $where: WorksWhereInput) {\n      works(offset: $offset, limit: $limit, where: $where) {\n        ...DialogWork\n      }\n    }\n  `,\n  [DialogWorkFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/select-created-works-dialog-with-ids.tsx"},"span":[9939,9952],"sourceCode":"import { useContext, useState } from \"react\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Button } from \"~/components/ui/button\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { ImageIcon, CheckIcon, PlusIcon } from \"lucide-react\"\nimport { Tabs, TabsList, TabsTrigger } from \"~/components/ui/tabs\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n// ----- dnd-kit -----\nimport {\n  DndContext,\n  DragOverlay,\n  PointerSensor,\n  TouchSensor,\n  useSensor,\n  useSensors,\n  closestCenter,\n  type DragStartEvent,\n  type DragEndEvent,\n} from \"@dnd-kit/core\"\nimport {\n  SortableContext,\n  useSortable,\n  arrayMove,\n  rectSortingStrategy,\n} from \"@dnd-kit/sortable\"\nimport { CSS } from \"@dnd-kit/utilities\"\n\ntype Props = {\n  selectedWorkIds: string[]\n  setSelectedWorkIds: (workIds: string[]) => void\n  limit?: number\n}\n\n/**\n * ä½œæˆæ¸ˆã¿ã®ä½œå“é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function SelectCreatedWorksDialogWithIds (props: Props) {\n  const t = useTranslation()\n  const appContext = useContext(AuthContext)\n\n  const [isOpen, setIsOpen] = useState<boolean>(false)\n  const [page, setPage] = useState(0) // \"æœªé¸æŠ\"ã‚¿ãƒ–ç”¨ãƒšãƒ¼ã‚¸\n  const [selectedPage, setSelectedPage] = useState(0) // \"é¸æŠä¸­\"ã‚¿ãƒ–ç”¨ãƒšãƒ¼ã‚¸\n  const [tab, setTab] = useState<\"NO_SELECTED\" | \"SELECTED\">(\"NO_SELECTED\")\n\n  // ä¸¦ã³æ›¿ãˆãƒˆã‚°ãƒ« (true ã§ãƒ‰ãƒ©ãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰)\n  const [isDragMode, setIsDragMode] = useState(false)\n\n  // ======== æœªé¸æŠã‚¿ãƒ–ç”¨ã‚¯ã‚¨ãƒª (å…¨ä½œå“ + ãƒšãƒ¼ã‚¸ãƒ³ã‚°) ========\n  const worksResult = useQuery(worksQuery, {\n    skip: appContext.isLoading,\n    variables: {\n      offset: page * 32,\n      limit: 32,\n      where: {\n        userId: appContext.userId,\n        orderBy: \"DATE_CREATED\",\n        sort: \"DESC\",\n      },\n    },\n  })\n  const works = worksResult.data?.works ?? []\n\n  // ======== å…¨ä½œå“æ•° (æœªé¸æŠã‚¿ãƒ–ã®ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³) ========\n  const worksCountResp = useQuery(worksCountQuery, {\n    skip: appContext.isLoading,\n    variables: {\n      where: {\n        userId: appContext.userId,\n      },\n    },\n  })\n  const worksMaxCount = worksCountResp.data?.worksCount ?? 0\n\n  // ======== é¸æŠä¸­ã‚¿ãƒ–ç”¨ã‚¯ã‚¨ãƒª (selectedWorkIds ã«åˆè‡´ã™ã‚‹ä½œå“) ========\n  const selectedWorksResult = useQuery(worksQuery, {\n    skip: appContext.isLoading || props.selectedWorkIds.length === 0,\n    variables: {\n      offset: selectedPage * 32,\n      limit: 32,\n      where: {\n        ids: props.selectedWorkIds,\n        orderBy: \"DATE_CREATED\",\n        sort: \"DESC\",\n      },\n    },\n  })\n\n  const selectedWorksQueryData = selectedWorksResult.data?.works ?? []\n\n  // ======== é¸æŠä¸­ã‚¿ãƒ–ã®ä½œå“ç·æ•° (ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³) ========\n  const selectedWorksCountResp = useQuery(worksCountQuery, {\n    skip: appContext.isLoading || props.selectedWorkIds.length === 0,\n    variables: {\n      where: {\n        ids: props.selectedWorkIds,\n      },\n    },\n  })\n  const selectedWorksMaxCount = selectedWorksCountResp.data?.worksCount ?? 0\n\n  // ======== ã‚¿ã‚¤ãƒˆãƒ«ã‚’çœç•¥ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼ ========\n  const truncateTitle = (title: string, maxLength: number) =>\n    title.length > maxLength ? `${title.slice(0, maxLength)}...` : title\n\n  // ======== (æœªé¸æŠã‚¿ãƒ–) ä½œå“ã‚¯ãƒªãƒƒã‚¯ ========\n  const handleWorkClick = (work: FragmentOf<typeof DialogWorkFragment>) => {\n    const isAlreadySelected = props.selectedWorkIds.includes(work.id)\n    if (isAlreadySelected) {\n      // é¸æŠè§£é™¤\n      const newIds = props.selectedWorkIds.filter((id) => id !== work.id)\n      props.setSelectedWorkIds(newIds)\n    } else {\n      // æ–°è¦é¸æŠ\n      if (!props.limit || props.selectedWorkIds.length < props.limit) {\n        const newIds = [...props.selectedWorkIds, work.id]\n        props.setSelectedWorkIds(newIds)\n      } else {\n        toast(\n          t(\n            `é¸æŠã§ãã‚‹ä½œå“æ•°ã¯${props.limit}ã¤ã¾ã§ã§ã™ã€‚`,\n            `You can select up to ${props.limit} works.`,\n          ),\n        )\n      }\n    }\n  }\n\n  // ======== ã€Œé¸æŠä¸­ã€ã‚¿ãƒ–ã§è¡¨ç¤ºã™ã‚‹ä½œå“ã‚’ ID ã®é †ç•ªã«ä¸¦ã³æ›¿ãˆãŸé…åˆ—ã‚’ç”Ÿæˆ ========\n  // DnD ãªã©ã§ä¸¦ã³é †ã‚’å¤‰æ›´ã™ã‚‹ã¨ãã¯ã€props.selectedWorkIds ã“ããŒé †åºã®ã‚½ãƒ¼ã‚¹ã«ãªã‚‹æƒ³å®šã€‚\n  const sortedSelectedWorks = props.selectedWorkIds\n    .map((id) => selectedWorksQueryData.find((w) => w.id === id))\n    .filter(Boolean) as FragmentOf<typeof DialogWorkFragment>[]\n\n  // ======== æœªé¸æŠã‚¿ãƒ–ã®æç”» ========\n  const renderWorks = (\n    worksToRender: FragmentOf<typeof DialogWorkFragment>[],\n  ) => {\n    return worksToRender.map((work) => (\n      <div key={work.id}>\n        {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n        <div\n          className=\"relative m-2 size-24 cursor-pointer\"\n          onClick={() => handleWorkClick(work)}\n        >\n          <img\n            className=\"size-24 rounded-md object-cover\"\n            src={work.smallThumbnailImageURL}\n            alt=\"\"\n          />\n          <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n            {truncateTitle(work.title, 8)}\n          </div>\n          {/* é¸æŠæ¸ˆã¿ã ã£ãŸã‚‰ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¤ã‚³ãƒ³ */}\n          {props.selectedWorkIds.includes(work.id) && (\n            <div className=\"absolute top-1 left-1 rounded-full border-2 bg-black dark:bg-white\">\n              <CheckIcon className=\"p-1 text-white dark:text-black\" />\n            </div>\n          )}\n        </div>\n      </div>\n    ))\n  }\n\n  // ========== ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—é–¢é€£ (SELECTED ã‚¿ãƒ–) ==========\n  const [activeDragItem, setActiveDragItem] = useState<FragmentOf<\n    typeof DialogWorkFragment\n  > | null>(null)\n\n  const sensors = useSensors(useSensor(PointerSensor), useSensor(TouchSensor))\n\n  // ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹\n  const handleDragStart = (event: DragStartEvent) => {\n    const { active } = event\n    const found = sortedSelectedWorks.find((w) => w.id === active.id)\n    if (found) {\n      setActiveDragItem(found)\n    }\n  }\n\n  // ãƒ‰ãƒ©ãƒƒã‚°çµ‚äº†\n  const handleDragEnd = (event: DragEndEvent) => {\n    const { active, over } = event\n    if (!over) {\n      setActiveDragItem(null)\n      return\n    }\n    if (active.id !== over.id) {\n      const oldIndex = props.selectedWorkIds.indexOf(active.id.toString())\n      const newIndex = props.selectedWorkIds.indexOf(over.id.toString())\n      // ä¸¦ã³æ›¿ãˆ\n      if (oldIndex !== -1 && newIndex !== -1) {\n        const newIds = arrayMove(props.selectedWorkIds, oldIndex, newIndex)\n        props.setSelectedWorkIds(newIds)\n      }\n    }\n    setActiveDragItem(null)\n  }\n\n  // ã‚½ãƒ¼ãƒˆå¯èƒ½ã‚¢ã‚¤ãƒ†ãƒ \n  function SortableItem({\n    work,\n  }: {\n    work: FragmentOf<typeof DialogWorkFragment>\n  }) {\n    // drag/drop ã®å‹•ä½œç®¡ç†\n    const { attributes, listeners, setNodeRef, transform, transition } =\n      useSortable({ id: work.id })\n\n    const style = {\n      transform: CSS.Transform.toString(transform),\n      transition,\n    }\n\n    return (\n      <div\n        ref={setNodeRef}\n        style={style}\n        {...attributes}\n        {...listeners}\n        // ã€Œä¸¦ã³æ›¿ãˆãƒ¢ãƒ¼ãƒ‰ã€ã§ãªã„ã¨ãã¯ã‚¯ãƒªãƒƒã‚¯ã§\"é¸æŠè§£é™¤\"\n        onClick={\n          !isDragMode\n            ? () => {\n                const newIds = props.selectedWorkIds.filter(\n                  (id) => id !== work.id,\n                )\n                props.setSelectedWorkIds(newIds)\n              }\n            : undefined\n        }\n        className={\n          isDragMode\n            ? \"relative m-2 cursor-grab\" // ä¸¦ã³æ›¿ãˆON: grabã‚«ãƒ¼ã‚½ãƒ«\n            : \"relative m-2 cursor-pointer\" // ä¸¦ã³æ›¿ãˆOFF: ã‚¯ãƒªãƒƒã‚¯è§£é™¤ç”¨\n        }\n      >\n        <img\n          className=\"size-24 rounded-md object-cover\"\n          src={work.smallThumbnailImageURL}\n          alt=\"\"\n        />\n        <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n          {truncateTitle(work.title, 8)}\n        </div>\n      </div>\n    )\n  }\n\n  // é¸æŠä¸­ã‚¿ãƒ–ã®æç”»\n  const renderSelectedWorksDnD = () => {\n    return (\n      <DndContext\n        sensors={sensors}\n        collisionDetection={closestCenter}\n        onDragStart={handleDragStart}\n        onDragEnd={handleDragEnd}\n      >\n        <SortableContext\n          items={props.selectedWorkIds} // é †ç•ªã©ãŠã‚Šã«\n          strategy={rectSortingStrategy}\n        >\n          <div className=\"flex flex-wrap\">\n            {sortedSelectedWorks.map((work) => (\n              <SortableItem key={work.id} work={work} />\n            ))}\n          </div>\n        </SortableContext>\n\n        <DragOverlay adjustScale={false} style={{ transformOrigin: \"0 0 \" }}>\n          {activeDragItem && (\n            <div className=\"size-24 border border-gray-300\">\n              <img\n                className=\"h-full w-full object-cover\"\n                src={activeDragItem.smallThumbnailImageURL}\n                alt=\"\"\n              />\n            </div>\n          )}\n        </DragOverlay>\n      </DndContext>\n    )\n  }\n\n  // ã‚‚ã—æœªé¸æŠã‚¿ãƒ–ã§ä½œå“ãŒå…¨ããªã„å ´åˆ (ã‹ã¤ã€ã‚¿ãƒ–ã‚‚NO_SELECTED) ã®ä¾‹\n  if (!works?.length && tab === \"NO_SELECTED\") {\n    return (\n      <div className=\"p-4\">\n        <ImageIcon className=\"m-auto size-8 opacity-70\" />\n        <p className=\"p-4 text-center text-sm\">\n          {t(\"ä½œå“ãŒã‚ã‚Šã¾ã›ã‚“ã€‚\", \"No works available.\")}\n        </p>\n      </div>\n    )\n  }\n\n  return (\n    <>\n      {/* ã€Œã™ã¹ã¦è¦‹ã‚‹ã€ãƒªãƒ³ã‚¯ï¼šé¸æŠä¸­ãŒ7ä»¶ã‚’è¶…ãˆãŸã‚‰è¡¨ç¤ºä¾‹ */}\n      {props.selectedWorkIds.length > 7 && (\n        // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n        <p\n          onClick={() => setIsOpen(true)}\n          className=\"m-2 cursor-pointer text-right text-sm opacity-80\"\n        >\n          {t(\n            `ã™ã¹ã¦è¦‹ã‚‹(${props.selectedWorkIds.length})`,\n            `View All (${props.selectedWorkIds.length})`,\n          )}\n        </p>\n      )}\n\n      {/* ãƒ€ã‚¤ã‚¢ãƒ­ã‚°å¤–ã§ã¯å…ˆé ­3ä»¶ã ã‘ã‚µãƒ ãƒè¡¨ç¤º */}\n      <div className=\"flex flex-wrap items-center\">\n        {sortedSelectedWorks.slice(0, 3).map((work) => (\n          <div key={work.id} className=\"relative m-2 size-16 md:h-24 md:w-24\">\n            <img\n              className=\"size-16 rounded-md object-cover md:h-24 md:w-24\"\n              src={work.smallThumbnailImageURL}\n              alt=\"\"\n            />\n            <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n              {truncateTitle(work.title, 8)}\n            </div>\n            <div className=\"absolute top-1 left-1 rounded-full border-2 bg-black dark:bg-white\">\n              <CheckIcon className=\"p-1 text-white dark:text-black\" />\n            </div>\n          </div>\n        ))}\n\n        {/* ã€Œï¼‹ã€ãƒœã‚¿ãƒ³ */}\n        <div className=\"border-2 border-transparent p-1\">\n          <Button\n            onClick={() => setIsOpen(true)}\n            className=\"size-16 md:h-24 md:w-24\"\n            size=\"icon\"\n            variant=\"secondary\"\n          >\n            <PlusIcon />\n          </Button>\n        </div>\n      </div>\n\n      {/* ãƒ€ã‚¤ã‚¢ãƒ­ã‚° */}\n      <Dialog open={isOpen} onOpenChange={(opened) => setIsOpen(opened)}>\n        <DialogContent className=\"min-h-[40vw] min-w-[88vw] pl-2\">\n          <DialogHeader>\n            <DialogTitle>{t(\"ä½œå“é¸æŠ\", \"Select Works\")}</DialogTitle>\n          </DialogHeader>\n\n          <Tabs className=\"mt-2 mb-8\" value={tab} defaultValue=\"NO_SELECTED\">\n            <TabsList>\n              <TabsTrigger\n                onClick={() => setTab(\"NO_SELECTED\")}\n                className=\"w-full\"\n                value=\"NO_SELECTED\"\n              >\n                {t(\"æœªé¸æŠ\", \"Not Selected\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => setTab(\"SELECTED\")}\n                className=\"w-full\"\n                value=\"SELECTED\"\n              >\n                {t(\"é¸æŠä¸­\", \"Selected\")}\n              </TabsTrigger>\n            </TabsList>\n          </Tabs>\n\n          <ScrollArea className=\"max-h-80 overflow-y-auto md:max-h-[100%]\">\n            {tab === \"NO_SELECTED\" && (\n              <div className=\"flex flex-wrap\">{renderWorks(works)}</div>\n            )}\n            {tab === \"SELECTED\" && (\n              <>\n                {/* ä¸¦ã³æ›¿ãˆãƒˆã‚°ãƒ« */}\n                <div className=\"mb-4 flex items-center gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => setIsDragMode(!isDragMode)}\n                  >\n                    {isDragMode\n                      ? t(\"ä¸¦ã³æ›¿ãˆçµ‚äº†\", \"Stop Sorting\")\n                      : t(\"ä¸¦ã³æ›¿ãˆ\", \"Sort\")}\n                  </Button>\n                </div>\n                {/* DnDè¡¨ç¤º or ã‚¯ãƒªãƒƒã‚¯è§£é™¤è¡¨ç¤º */}\n                {isDragMode ? (\n                  renderSelectedWorksDnD()\n                ) : (\n                  <div className=\"flex flex-wrap\">\n                    {renderWorks(sortedSelectedWorks)}\n                  </div>\n                )}\n              </>\n            )}\n          </ScrollArea>\n\n          {/* ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ */}\n          {tab === \"NO_SELECTED\" && (\n            <ResponsivePagination\n              perPage={32}\n              maxCount={worksMaxCount}\n              currentPage={page}\n              onPageChange={(p: number) => setPage(p)}\n            />\n          )}\n          {tab === \"SELECTED\" && (\n            <ResponsivePagination\n              perPage={32}\n              maxCount={selectedWorksMaxCount}\n              currentPage={selectedPage}\n              onPageChange={(p: number) => setSelectedPage(p)}\n            />\n          )}\n\n          <div className=\"mt-4 flex gap-2\">\n            <Button onClick={() => setIsOpen(false)}>\n              {t(\"æ±ºå®š\", \"Confirm\")}\n            </Button>\n            <Button variant=\"secondary\" onClick={() => setIsOpen(false)}>\n              {t(\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\", \"Cancel\")}\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </>\n  )\n}\n\n// ==== GraphQL Fragment ====\n// ä½œå“ã‚µãƒ ãƒãƒ»ã‚¿ã‚¤ãƒˆãƒ«ç”¨ã®ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆ\nexport const DialogWorkFragment = graphql(`\n  fragment DialogWork on WorkNode @_unmask {\n    id\n    title\n    smallThumbnailImageURL\n  }\n`)\n\n// ==== GraphQL Queries ====\n// ç·æ•°å–å¾— (ä»»æ„ã® where æ¡ä»¶ã«å¯¾å¿œ)\nconst worksCountQuery = graphql(`\n  query WorksCount($where: WorksWhereInput) {\n    worksCount(where: $where)\n  }\n`)\n\n// ãƒšãƒ¼ã‚¸ãƒ³ã‚°ä»˜ãä½œå“ä¸€è¦§å–å¾— (ä»»æ„ã® where æ¡ä»¶ã«å¯¾å¿œ)\nconst worksQuery = graphql(\n  `\n    query Works($offset: Int!, $limit: Int!, $where: WorksWhereInput) {\n      works(offset: $offset, limit: $limit, where: $where) {\n        ...DialogWork\n      }\n    }\n  `,\n  [DialogWorkFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable refetch is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"refetch"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/viewed-list-container.tsx"},"span":[790,797],"sourceCode":"import { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext } from \"react\"\nimport {\n  BookmarkWorksList,\n  BookmarkWorksListItemFragment,\n} from \"~/routes/($lang).my._index/components/bookmark-works-list\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\n\ntype Props = {\n  page: number\n  maxCount: number\n  setPage: (page: number) => void\n}\n\n/**\n * é–²è¦§å±¥æ­´ä¸€è¦§ã‚³ãƒ³ãƒ†ãƒŠ\n */\nexport function ViewedListContainer (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  if (\n    authContext.isLoading ||\n    authContext.isNotLoggedIn ||\n    authContext.userId === undefined ||\n    !authContext.userId\n  ) {\n    return null\n  }\n  const { data: workResp, refetch } = useQuery(viewedWorksQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      offset: 16 * props.page,\n      limit: 16,\n    },\n  })\n\n  const works = workResp?.viewer?.viewedWorks ?? []\n\n  return (\n    <>\n      <BookmarkWorksList works={works} />\n      <div className=\"h-8\" />\n      <div className=\"-translate-x-1/2 fixed bottom-0 left-1/2 z-10 w-full border-border/40 bg-background/95 p-2 backdrop-blur-sm supports-backdrop-filter:bg-background/80\">\n        <ResponsivePagination\n          perPage={16}\n          maxCount={props.maxCount}\n          currentPage={props.page}\n          onPageChange={(page: number) => {\n            props.setPage(page)\n          }}\n        />\n      </div>\n    </>\n  )\n}\n\nconst viewedWorksQuery = graphql(\n  `query ViewerViewedWorks($offset: Int!, $limit: Int!) {\n    viewer {\n      viewedWorks(offset: $offset, limit: $limit) {\n        ...BookmarkWorksListItem\n      }\n    }\n  }`,\n  [BookmarkWorksListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/works-list-column.tsx"},"span":[509,522],"sourceCode":"import type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport type { SortType } from \"~/types/sort-type\"\nimport { ChevronDown, ChevronUp } from \"lucide-react\"\n\ntype Props = {\n  label: string\n  orderBy: IntrospectionEnum<\"WorkOrderBy\">\n  nowOrderBy: IntrospectionEnum<\"WorkOrderBy\">\n  sort: SortType\n  onClick: () => void\n}\n\n/**\n * ä½œå“ä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ \n */\nexport function WorksListColumn (props: Props) {\n  return (\n    <>\n      {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n      <div onClick={props.onClick} className=\"cursor-pointer\">\n        <div className=\"flex items-center\">\n          {props.label}\n          {props.orderBy === props.nowOrderBy &&\n            (props.sort === \"ASC\" ? <ChevronUp /> : <ChevronDown />)}\n        </div>\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/works-sp-list.tsx"},"span":[2835,2848],"sourceCode":"import { Badge } from \"~/components/ui/badge\"\nimport { toAccessTypeText } from \"~/utils/work/to-access-type-text\"\nimport type { SortType } from \"~/types/sort-type\"\nimport {\n  EllipsisIcon,\n  EyeIcon,\n  FolderIcon,\n  HeartIcon,\n  MessageCircle,\n  PencilIcon,\n} from \"lucide-react\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { toWorkTypeText } from \"~/utils/work/to-work-type-text\"\nimport { Link } from \"@remix-run/react\"\nimport { toDateTimeText } from \"~/utils/to-date-time-text\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { toast } from \"sonner\"\nimport { useState } from \"react\"\nimport {\n  Popover,\n  PopoverTrigger,\n  PopoverContent,\n} from \"~/components/ui/popover\"\nimport { Button } from \"~/components/ui/button\"\nimport { useLocale } from \"~/hooks/use-locale\"\nimport { DeleteConfirmTrashDialog } from \"~/routes/($lang).my._index/components/delete-confirm-trash-dialog\"\nimport { CroppedMyWorkSquare } from \"~/routes/($lang).my._index/components/cropped-my-work-square\"\n\ntype Props = {\n  works: FragmentOf<typeof MobileWorkListItemFragment>[]\n  sort: SortType\n  orderBy: IntrospectionEnum<\"WorkOrderBy\">\n}\n\nconst editUrl = (id: string, workType: string) => {\n  if (workType === \"WORK\") {\n    return `/posts/${id}/image/edit`\n  }\n  if (workType === \"VIDEO\") {\n    return `/posts/${id}/animation/edit`\n  }\n  if (workType === \"COLUMN\" || workType === \"NOVEL\") {\n    return `/posts/${id}/text/edit`\n  }\n\n  return \"/\"\n}\n\nconst postUrl = (work: {\n  id: string\n  createdAt: number\n  accessType: string\n  uuid: string | null\n}) => {\n  if (\n    new Date(work.createdAt * 1000).getTime() > Date.now() ||\n    work.accessType === \"PRIVATE\" ||\n    work.accessType === \"DRAFT\"\n  ) {\n    return `/posts/${work.id}/draft`\n  }\n  if (work.accessType === \"LIMITED\") {\n    return `/posts/${work.uuid}`\n  }\n  return `/posts/${work.id}`\n}\n\n/**\n * ã‚¹ãƒãƒ›å‘ã‘ä½œå“ä¸€è¦§\n */\nexport function WorksSpList (props: Props) {\n  const truncateTitle = (title: string, maxLength: number) => {\n    return title.length > maxLength ? `${title.slice(0, maxLength)}...` : title\n  }\n\n  const [deleteWork, { loading: isLoadingDeleteWork }] =\n    useMutation(deleteWorkMutation)\n\n  const [deletedIds, setDeletedIds] = useState<string[]>([])\n\n  const onDeleteWork = async (workId: string) => {\n    await deleteWork({\n      variables: {\n        input: {\n          workId: workId,\n        },\n      },\n    })\n    toast(\"ä½œå“ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€ã—ã°ã‚‰ãã—ãŸã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ããªããªã‚Šã¾ã™\")\n\n    setDeletedIds([...deletedIds, workId])\n  }\n\n  const location = useLocale()\n\n  return (\n    <>\n      {props.works\n        .filter((work) => !deletedIds.includes(work.id))\n        .map((work, index) => (\n          // biome-ignore lint/suspicious/noArrayIndexKey: <explanation>\n          <div key={index} className=\"flex flex-col\">\n            <div className=\"flex space-x-4 border-b pt-2 pb-2\">\n              <Link to={postUrl(work)}>\n                <CroppedMyWorkSquare\n                  workId={work.id}\n                  imageUrl={work.smallThumbnailImageURL}\n                  size=\"sm\"\n                  thumbnailImagePosition={work.thumbnailImagePosition ?? 0}\n                  imageWidth={work.smallThumbnailImageWidth}\n                  imageHeight={work.smallThumbnailImageHeight}\n                />\n              </Link>\n              <div className=\"flex w-full flex-col space-y-2\">\n                <div className=\"w-full max-w-64 space-y-2 overflow-hidden text-ellipsis\">\n                  <Link to={postUrl(work)}>\n                    <div className=\"w-full font-bold\">\n                      {truncateTitle(work.title, 32)}\n                    </div>\n                  </Link>\n                  <div className=\"space-x-2\">\n                    <Badge variant={\"secondary\"}>\n                      {toAccessTypeText(work.accessType)}\n                    </Badge>\n                    <Badge variant={\"secondary\"}>\n                      {toWorkTypeText({\n                        type: work.type,\n                        lang: location,\n                      })}\n                    </Badge>\n                  </div>\n                </div>\n                <div className=\"flex w-full items-center justify-between\">\n                  <div className=\"flex items-center\">\n                    <FolderIcon className=\"mr-1 size-4\" />\n                    {work.bookmarksCount}\n                  </div>\n                  <div className=\"flex items-center\">\n                    <HeartIcon className=\"mr-1 size-4\" />\n                    {work.likesCount}\n                  </div>\n                  <div className=\"flex items-center\">\n                    <EyeIcon className=\"mr-1 size-4\" />\n                    {work.viewsCount}\n                  </div>\n                </div>\n                <div className=\"flex items-center\">\n                  <MessageCircle className=\"mr-1 size-4\" />\n                  {work.commentsCount}\n                </div>\n                <div className=\"text-sm opacity-80\">\n                  {toDateTimeText(work.createdAt)}\n                </div>\n              </div>\n              <div className=\"flex h-8 items-center\">\n                <div className=\"flex w-16 justify-center\">\n                  <Link to={editUrl(work.id, work.type)}>\n                    <PencilIcon />\n                  </Link>\n                </div>\n                <Popover>\n                  <PopoverTrigger asChild>\n                    <Button size={\"icon\"} variant=\"secondary\">\n                      <EllipsisIcon className=\"w-16\" />\n                    </Button>\n                  </PopoverTrigger>\n                  <PopoverContent className=\"w-80\">\n                    <div className=\"flex justify-center\">\n                      <DeleteConfirmTrashDialog\n                        onDelete={async () => {\n                          await onDeleteWork(work.id)\n                        }}\n                        workTitle={work.title}\n                        isLoadingDeleteWork={isLoadingDeleteWork}\n                      />\n                    </div>\n                  </PopoverContent>\n                </Popover>\n              </div>\n            </div>\n          </div>\n        ))}\n    </>\n  )\n}\n\nexport const MobileWorkListItemFragment = graphql(\n  `fragment MobileWorkListItem on WorkNode @_unmask {\n    id\n    uuid\n    title\n    type\n    commentsCount\n    viewsCount\n    smallThumbnailImageURL\n    likesCount\n    rating\n    bookmarksCount\n    createdAt\n    accessType\n    uuid\n    isPromotion\n    smallThumbnailImageHeight\n    smallThumbnailImageWidth\n    thumbnailImagePosition\n  }`,\n)\n\nconst deleteWorkMutation = graphql(\n  `mutation DeleteWork($input: DeleteWorkInput!) {\n    deleteWork(input: $input) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable albumsCountRefetch is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"albumsCountRefetch"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my.albums/route.tsx"},"span":[1710,1728],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport type { SortType } from \"~/types/sort-type\"\nimport { AlbumsListContainer } from \"~/routes/($lang).my._index/components/albums-list-container\"\nimport { AlbumsSetting } from \"~/routes/($lang).my._index/components/albums-settings\"\nimport { useQuery } from \"@apollo/client/index\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { graphql } from \"gql.tada\"\nimport React, { useContext } from \"react\"\nimport { Suspense } from \"react\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { META } from \"~/config\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.MY_ALBUMS, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  return {}\n}\n\nexport const headers: HeadersFunction = () => ({\n  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function MyAlbums () {\n  const authContext = useContext(AuthContext)\n\n  const [albumPage, setAlbumPage] = React.useState(0)\n\n  const [albumOrderDeskAsc, setAlbumOrderDeskAsc] =\n    React.useState<SortType>(\"DESC\")\n\n  const [AlbumOrderby, setAlbumOrderby] =\n    React.useState<IntrospectionEnum<\"AlbumOrderBy\">>(\"DATE_CREATED\")\n\n  const [albumRating, setAlbumRating] =\n    React.useState<IntrospectionEnum<\"AlbumRating\"> | null>(null)\n\n  const { data: albumsCountResp, refetch: albumsCountRefetch } = useQuery(\n    albumsCountQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n      variables: {\n        where: {\n          ownerUserId: authContext.userId,\n          isSensitive: albumRating !== \"G\",\n          needInspected: false,\n          needsThumbnailImage: false,\n        },\n      },\n    },\n  )\n\n  const albumsMaxCount = albumsCountResp?.albumsCount ?? 0\n\n  // ã‚¢ãƒ«ãƒãƒ ä¸€è¦§ã®ã‚½ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†\n  const onClickAlbumTitleSortButton = () => {\n    setAlbumOrderby(\"NAME\")\n    setAlbumOrderDeskAsc(albumOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickAlbumDateSortButton = () => {\n    setAlbumOrderby(\"DATE_CREATED\")\n    setAlbumOrderDeskAsc(albumOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  return (\n    <>\n      <AlbumsSetting\n        sort={albumOrderDeskAsc}\n        orderBy={AlbumOrderby}\n        sumAlbumsCount={albumsMaxCount}\n        rating={albumRating}\n        onClickAlbumTitleSortButton={onClickAlbumTitleSortButton}\n        onClickAlbumDateSortButton={onClickAlbumDateSortButton}\n        setRating={setAlbumRating}\n        setSort={setAlbumOrderDeskAsc}\n      />\n      <Suspense fallback={<AppLoadingPage />}>\n        <AlbumsListContainer\n          page={albumPage}\n          sort={albumOrderDeskAsc}\n          orderBy={AlbumOrderby}\n          rating={albumRating}\n          albumsMaxCount={albumsMaxCount}\n          setAlbumPage={setAlbumPage}\n          onClickAlbumTitleSortButton={onClickAlbumTitleSortButton}\n          onClickAlbumDateSortButton={onClickAlbumDateSortButton}\n        />\n      </Suspense>\n    </>\n  )\n}\n\nconst albumsCountQuery = graphql(\n  `query AlbumsCount($where: AlbumsWhereInput) {\n    albumsCount(where: $where)\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable refetch is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"refetch"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my.bookmarks/route.tsx"},"span":[1262,1269],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { BookmarkListContainer } from \"~/routes/($lang).my._index/components/bookmark-list-container\"\nimport { useQuery } from \"@apollo/client/index\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { graphql } from \"gql.tada\"\nimport React from \"react\"\nimport { Suspense, useContext } from \"react\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { META } from \"~/config\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.MY_BOOKMARKS, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  return {}\n}\n\nexport const headers: HeadersFunction = () => ({\n  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function MyBookmarks () {\n  const [bookmarkPage, setBookmarkPage] = React.useState(0)\n\n  const authContext = useContext(AuthContext)\n\n  if (!authContext.isLoggedIn) {\n    return <AppLoadingPage />\n  }\n\n  const { data: userResp, refetch } = useQuery(userQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      userId: decodeURIComponent(authContext.userId),\n    },\n  })\n\n  const bookmarkMaxCount = userResp?.user?.createdBookmarksCount\n    ? userResp.user.createdBookmarksCount > 400\n      ? 400\n      : userResp.user.createdBookmarksCount\n    : 0\n\n  return (\n    <>\n      <Suspense fallback={<AppLoadingPage />}>\n        <BookmarkListContainer\n          page={bookmarkPage}\n          maxCount={bookmarkMaxCount}\n          setPage={setBookmarkPage}\n        />\n      </Suspense>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      createdBookmarksCount\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable refetch is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"refetch"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my.likes/route.tsx"},"span":[1240,1247],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useQuery } from \"@apollo/client/index\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { graphql } from \"gql.tada\"\nimport React from \"react\"\nimport { Suspense, useContext } from \"react\"\nimport { LikeListContainer } from \"~/routes/($lang).my._index/components/like-list-container\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.MY_LIKES, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  return {}\n}\n\nexport const headers: HeadersFunction = () => ({\n  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function MyLikes () {\n  const [likedPage, setLikedPage] = React.useState(0)\n\n  const authContext = useContext(AuthContext)\n\n  if (!authContext.isLoggedIn) {\n    return <AppLoadingPage />\n  }\n\n  const { data: userResp, refetch } = useQuery(userQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      userId: decodeURIComponent(authContext.userId),\n    },\n  })\n\n  const likedMaxCount = userResp?.user?.createdLikesCount\n    ? userResp.user.createdLikesCount > 400\n      ? 400\n      : userResp.user.createdLikesCount\n    : 0\n\n  return (\n    <>\n      <Suspense fallback={<AppLoadingPage />}>\n        <LikeListContainer\n          page={likedPage}\n          maxCount={likedMaxCount}\n          setPage={setLikedPage}\n        />\n      </Suspense>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      createdLikesCount\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable refetch is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"refetch"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my.reports/route.tsx"},"span":[1257,1264],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useQuery } from \"@apollo/client/index\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { graphql } from \"gql.tada\"\nimport React from \"react\"\nimport { Suspense, useContext } from \"react\"\nimport { ModerationReportsContainer } from \"~/routes/($lang).my._index/components/reported-list-container\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.MY_REPORTS, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  return {}\n}\n\nexport const headers: HeadersFunction = () => ({\n  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function MyViews () {\n  const [ViewedPage, setViewedPage] = React.useState(0)\n\n  const authContext = useContext(AuthContext)\n\n  if (!authContext.isLoggedIn) {\n    return <AppLoadingPage />\n  }\n\n  const { data: userResp, refetch } = useQuery(userQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      userId: decodeURIComponent(authContext.userId),\n    },\n  })\n\n  const ViewedMaxCount = userResp?.user?.createdViewsCount\n    ? userResp.user.createdViewsCount > 400\n      ? 400\n      : userResp.user.createdViewsCount\n    : 0\n\n  return (\n    <>\n      <Suspense fallback={<AppLoadingPage />}>\n        <ModerationReportsContainer\n          page={ViewedPage}\n          maxCount={ViewedMaxCount}\n          setPage={setViewedPage}\n        />\n      </Suspense>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      createdViewsCount\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable refetch is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"refetch"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my.views/route.tsx"},"span":[1246,1253],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useQuery } from \"@apollo/client/index\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { graphql } from \"gql.tada\"\nimport React from \"react\"\nimport { Suspense, useContext } from \"react\"\nimport { ViewedListContainer } from \"~/routes/($lang).my._index/components/viewed-list-container\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.MY_VIEWS, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  return {}\n}\n\nexport const headers: HeadersFunction = () => ({\n  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function MyViews () {\n  const [ViewedPage, setViewedPage] = React.useState(0)\n\n  const authContext = useContext(AuthContext)\n\n  if (!authContext.isLoggedIn) {\n    return <AppLoadingPage />\n  }\n\n  const { data: userResp, refetch } = useQuery(userQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      userId: decodeURIComponent(authContext.userId),\n    },\n  })\n\n  const ViewedMaxCount = userResp?.user?.createdViewsCount\n    ? userResp.user.createdViewsCount > 400\n      ? 400\n      : userResp.user.createdViewsCount\n    : 0\n\n  return (\n    <>\n      <Suspense fallback={<AppLoadingPage />}>\n        <ViewedListContainer\n          page={ViewedPage}\n          maxCount={ViewedMaxCount}\n          setPage={setViewedPage}\n        />\n      </Suspense>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      createdViewsCount\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/suspicious/noExplicitAny","severity":"warning","description":"Unexpected any. Specify a different type.","message":[{"elements":[],"content":"Unexpected "},{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":". Specify a different type."}],"advices":{"advices":[{"log":["info",[{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":" disables many type checking rules. Its use should be avoided."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).r._index/route.tsx"},"span":[17590,17593],"sourceCode":"import { loaderClient } from \"~/lib/loader-client\"\nimport { HomeWorkAwardFragment } from \"~/routes/($lang)._main._index/components/home-award-work-section\"\nimport { HomeBannerWorkFragment } from \"~/routes/($lang)._main._index/components/home-banners\"\nimport { HomeTagListItemFragment } from \"~/routes/($lang)._main._index/components/home-tag-list\"\nimport { HomeTagFragment } from \"~/routes/($lang)._main._index/components/home-tags-section\"\nimport { HomePromotionWorkFragment } from \"~/routes/($lang)._main._index/components/home-works-users-recommended-section\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport {\n  Link,\n  useLoaderData,\n  useNavigate,\n  useSearchParams,\n} from \"@remix-run/react\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\nimport { config, META } from \"~/config\"\nimport { HomeTagWorkFragment } from \"~/routes/($lang)._main._index/components/home-works-tag-section\"\nimport { getJstDate } from \"~/utils/jst-date\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { HomeNewUsersWorksFragment } from \"~/routes/($lang)._main._index/components/home-new-users-works-section\"\nimport { HomeNewCommentsFragment } from \"~/routes/($lang)._main._index/components/home-new-comments\"\nimport { HomeNewPostedUsersFragment } from \"~/routes/($lang)._main._index/components/home-new-users-section\"\nimport {\n  ArrowDownWideNarrow,\n  ExternalLink,\n  List,\n  Navigation,\n  PlaySquare,\n} from \"lucide-react\"\nimport { useState, Suspense, useMemo, useEffect } from \"react\"\nimport { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { CrossPlatformTooltip } from \"~/components/cross-platform-tooltip\"\nimport { Button } from \"~/components/ui/button\"\nimport {\n  Select,\n  SelectTrigger,\n  SelectValue,\n  SelectContent,\n  SelectItem,\n} from \"~/components/ui/select\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { Tabs, TabsContent } from \"~/components/ui/tabs\"\nimport { useLocale } from \"~/hooks/use-locale\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { toWorkTypeText } from \"~/utils/work/to-work-type-text\"\nimport { HomeSensitiveHotWorksSection } from \"~/routes/($lang)._main._index/components/home-sensitive-hot-works-section\"\nimport { HomeSensitiveWorksSection } from \"~/routes/($lang)._main._index/components/home-sensitive-works-section\"\nimport { HomeSensitiveWorksTagSection } from \"~/routes/($lang)._main._index/components/home-sensitive-works-tag-section\"\nimport { HomeSensitiveNewUsersWorksSection } from \"~/routes/($lang)._main._index/components/home-sensitive-new-users-works-section\"\nimport { HomeSensitiveAwardWorkSection } from \"~/routes/($lang)._main._index/components/home-sensitive-award-work-section\"\nimport { HomeSensitiveTagsSection } from \"~/routes/($lang)._main._index/components/home-sensitive-tags-section\"\nimport { useQuery, useMutation } from \"@apollo/client/index\"\nimport { HomeAwardWorksSection } from \"~/routes/($lang)._main._index/components/home-award-works\"\nimport { HomeSensitiveTagList } from \"~/routes/($lang).r._index/components/home-sensitive-tag-list\"\nimport { HomeNewUsersSensitiveWorkListSection } from \"~/routes/($lang).r._index/components/home-new-user-sensitive-work-list-section\"\nimport { FollowSensitiveTagsFeedContents } from \"~/routes/($lang)._main._index/components/follow-sensitive-tags-feed-contents\"\nimport { FollowSensitiveUserFeedContents } from \"~/routes/($lang)._main._index/components/follow-sensitive-user-feed-contents\"\nimport { HomeSensitiveNewCommentsSection } from \"~/routes/($lang)._main._index/components/home-sensitive-new-comments\"\nimport { HomeNewSensitiveUsersSection } from \"~/routes/($lang)._main._index/components/home-new-sensitive-users-section\"\nimport { HomeSensitiveWorksUsersRecommendedSection } from \"~/routes/($lang)._main._index/components/home-sensitive-works-users-recommended-section\"\nimport { AppAnimatedTabs } from \"~/components/app/app-animated-tabs\"\nimport type { PhotoAlbumWorkFragment } from \"~/components/responsive-photo-works-album\"\nimport { WorkViewerDialog } from \"~/components/work/work-viewer-dialog\"\nimport { HomePaginationSensitiveWorksSection } from \"~/routes/($lang).r._index/components/home-pagination-sensitive-works-section\"\nimport { useWorkDialogUrl } from \"~/hooks/use-work-dialog-url\"\n\n// ---------- meta ----------\nexport const meta: MetaFunction = (props) =>\n  createMeta(META.HOME_SENSITIVE, undefined, props.params.lang)\n\n// ---------- utils ----------\nconst getUtcDateString = (d: Date) =>\n  `${d.getUTCFullYear()}/${`0${d.getUTCMonth() + 1}`.slice(-2)}/${`0${d.getUTCDate()}`.slice(-2)}`\n\n// ---------- loader ----------\nexport async function loader(_props: LoaderFunctionArgs) {\n  const categories = [\"ç¸„\", \"ä¸­ã ã—\"]\n  const pick2 = (arr: string[]) =>\n    arr.sort(() => Math.random() - 0.5).slice(0, 2)\n\n  const [firstTag, secondTag] = pick2(categories)\n  const now = getJstDate()\n  const yesterday = new Date(now.getTime() - 86_400_000)\n\n  const { data } = await loaderClient.query({\n    query,\n    variables: {\n      awardDay: yesterday.getDate(),\n      awardMonth: yesterday.getMonth() + 1,\n      awardYear: yesterday.getFullYear(),\n      day: now.getDate(),\n      month: now.getMonth() + 1,\n      year: now.getFullYear(),\n      adWorksLimit: config.query.homeWorkCount.ad,\n      promotionWorksLimit: config.query.homeWorkCount.promotion,\n      awardWorksLimit: config.query.homeWorkCount.award,\n      categoryFirst: firstTag,\n      categorySecond: secondTag,\n      tagWorksLimit: config.query.homeWorkCount.tag,\n      newUsersWorksLimit: config.query.homeWorkCount.newUser,\n    },\n  })\n\n  return {\n    ...data,\n    awardDateText: getUtcDateString(yesterday),\n    firstTag,\n    secondTag,\n  }\n}\n\n// ---------- headers ----------\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.home,\n})\n\n// ---------- helper ----------\nconst useUpdateQueryParams = () => (p: URLSearchParams) =>\n  window.history.replaceState(null, \"\", `${location.pathname}?${p}`)\n\n// ---------- component ----------\nexport default function Index () {\n  const data = useLoaderData<typeof loader>()\n  const t = useTranslation()\n  const locale = useLocale()\n  const navigate = useNavigate()\n  const [searchParams] = useSearchParams()\n  const updateQueryParams = useUpdateQueryParams()\n\n  // ------ local state ------\n  const [currentTab, setCurrentTab] = useState(\n    searchParams.get(\"tab\") ?? \"home\",\n  )\n  const [workView, setWorkView] = useState(searchParams.get(\"view\") ?? \"new\")\n  const [newWorksPage, setNewWorksPage] = useState(\n    Number(searchParams.get(\"newPage\") ?? 0),\n  )\n  const [followUserFeedPage, setFollowUserFeedPage] = useState(\n    Number(searchParams.get(\"followUserPage\") ?? 0),\n  )\n  const [followTagFeedPage, setFollowTagFeedPage] = useState(\n    Number(searchParams.get(\"followTagPage\") ?? 0),\n  )\n  const [workType, setWorkType] =\n    useState<IntrospectionEnum<\"WorkType\"> | null>(\n      (searchParams.get(\"workType\") as IntrospectionEnum<\"WorkType\">) ?? null,\n    )\n  const [isPromptPublic, setIsPromptPublic] = useState<boolean | null>(\n    searchParams.get(\"isPromptPublic\") === null\n      ? null\n      : searchParams.get(\"isPromptPublic\") === \"true\",\n  )\n  const [sortType, setSortType] =\n    useState<IntrospectionEnum<\"WorkOrderBy\"> | null>(\n      (searchParams.get(\"sortType\") as IntrospectionEnum<\"WorkOrderBy\">) ??\n        null,\n    )\n  const [timeRange, setTimeRange] = useState(\n    searchParams.get(\"timeRange\") ?? \"ALL\",\n  )\n  const [isOneWorkPerUser, _setIsOneWorkPerUser] = useState<boolean>(\n    searchParams.get(\"isOneWorkPerUser\") === \"true\",\n  )\n\n  const [internalIsPagination, setInternalIsPagination] = useState(true)\n\n  // ä½œå“é·ç§»ãƒ¢ãƒ¼ãƒ‰ï¼ˆãƒ€ã‚¤ã‚¢ãƒ­ã‚° / ç›´æ¥ãƒªãƒ³ã‚¯ï¼‰\n  const [isDialogMode, setIsDialogMode] = useState(false)\n\n  // Work dialog URL state management\n  const workDialog = useWorkDialogUrl()\n\n  // ä½œå“ãƒ‡ãƒ¼ã‚¿ã®ç®¡ç†ç”¨state\n  const [currentWorks, setCurrentWorks] = useState<\n    FragmentOf<typeof PhotoAlbumWorkFragment>[]\n  >([])\n\n  const [isLoadingMore, _setIsLoadingMore] = useState(false)\n\n  // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§è¡¨ç¤ºã™ã‚‹ä½œå“ãƒ‡ãƒ¼ã‚¿ã‚’æ±ºå®š\n  const displayedWorks = useMemo(() => {\n    switch (currentTab) {\n      case \"new\":\n      case \"follow-user\":\n      case \"follow-tag\":\n        return currentWorks\n      default:\n        return []\n    }\n  }, [currentTab, currentWorks])\n\n  const [hasNextPage, _setHasNextPage] = useState(true)\n\n  // ä½œå“ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†\n  const openWork = (idx: string) => {\n    // displayedWorksã®workã®idä¸€è‡´ã™ã‚‹ã‚‚ã®\n    const work = displayedWorks.find((w) => w.id === idx)\n    if (!work) {\n      console.error(\"Work not found for ID:\", idx)\n      return\n    }\n    if (isDialogMode) {\n      console.log(\"Opening dialog for work ID:\", idx)\n      workDialog.openDialog(idx)\n    } else {\n      console.log(\"Navigating to:\", `/posts/${work.id}`)\n      navigate(`/posts/${work.id}`)\n    }\n  }\n\n  // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãƒ¢ãƒ¼ãƒ‰å¤‰æ›´æ™‚ã®å‡¦ç†ï¼ˆlocalStorageã«ä¿å­˜ï¼‰\n  const onChangeDialogMode = (mode: boolean) => {\n    setIsDialogMode(mode)\n    if (typeof window !== \"undefined\") {\n      try {\n        localStorage.setItem(\"aipictors-dialog-mode\", JSON.stringify(mode))\n      } catch (error) {\n        console.error(\"Failed to save dialog mode to localStorage:\", error)\n      }\n    }\n    // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‰ã˜ã‚‹\n    if (!mode) {\n      workDialog.closeDialog()\n    }\n  }\n\n  // currentWorksã‚’æ›´æ–°ã™ã‚‹ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°\n  const updateCurrentWorks = (\n    works: FragmentOf<typeof PhotoAlbumWorkFragment>[],\n  ) => {\n    setCurrentWorks(works)\n  }\n\n  // ç„¡é™ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ç”¨ã®loadMoreé–¢æ•°\n  const loadMore = async () => {\n    if (isLoadingMore || !hasNextPage || internalIsPagination) return\n  }\n\n  // ------ URL sync helpers ------\n  const syncParam = (key: string, value: string | null) => {\n    const p = new URLSearchParams(searchParams)\n    value === null ? p.delete(key) : p.set(key, value)\n    updateQueryParams(p)\n  }\n\n  const handleTabChange = (tab: string) => {\n    setCurrentTab(tab)\n    syncParam(\"tab\", tab)\n  }\n  const handleWorkViewChange = (v: string) => {\n    setWorkView(v)\n    syncParam(\"view\", v)\n  }\n\n  const setPageWithParam =\n    (setter: (n: number) => void, paramKey: string) => (n: number) => {\n      setter(n)\n      syncParam(paramKey, String(n))\n    }\n\n  // ------ GraphQL for sideâ€menu ads ------\n  const { data: pass } = useQuery(viewerCurrentPassQuery)\n  const { data: advertisements } = useQuery(randomCustomerAdvertisementQuery, {\n    variables: { where: { isSensitive: true, page: \"work\" } },\n  })\n  const [updateClicked] = useMutation(\n    updateClickedCountCustomerAdvertisementMutation,\n  )\n  const isSubscriptionUser = [\"LITE\", \"STANDARD\", \"PREMIUM\"].includes(\n    pass?.viewer?.currentPass?.type ?? \"\",\n  )\n\n  // localStorageã‹ã‚‰ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’å¾©å…ƒ\n  useEffect(() => {\n    if (typeof window !== \"undefined\") {\n      try {\n        const savedMode = localStorage.getItem(\"aipictors-dialog-mode\")\n        if (savedMode !== null) {\n          const parsedMode = JSON.parse(savedMode)\n          setIsDialogMode(parsedMode)\n        }\n      } catch (error) {\n        console.error(\"Failed to restore dialog mode from localStorage:\", error)\n      }\n    }\n  }, [])\n\n  // ---------- render ----------\n  if (!data) return null\n\n  return (\n    <>\n      <Tabs\n        value={currentTab}\n        onValueChange={handleTabChange}\n        className=\"space-y-4\"\n      >\n        {/* ---------- TAB HEADER ---------- */}\n        <div className=\"flex items-center sm:gap-x-2 md:gap-x-4\">\n          <AppAnimatedTabs\n            tabs={[\n              { label: \"ãƒ›ãƒ¼ãƒ \", value: \"home\" },\n              { label: \"æ–°ç€ãƒ»äººæ°—\", value: \"new\" },\n              { label: \"ãƒ•ã‚©ãƒ­ãƒ¼æ–°ç€\", value: \"follow-user\" },\n              { label: \"ãŠæ°—ã«å…¥ã‚Šã‚¿ã‚°æ–°ç€\", value: \"follow-tag\" },\n            ]}\n            value={currentTab}\n            onChange={setCurrentTab}\n          />\n          <Button variant=\"secondary\" size=\"sm\" onClick={() => navigate(\"/\")}>\n            å…¨å¹´é½¢\n          </Button>\n        </div>\n\n        {/* ---------- HOME ---------- */}\n        <TabsContent value=\"home\" className=\"m-0 flex flex-col space-y-4\">\n          <HomeSensitiveTagList\n            themeTitle={data.dailyTheme?.title}\n            hotTags={data.hotSensitiveTags}\n          />\n          <div className=\"block space-y-4 md:flex md:space-x-4 md:space-y-0\">\n            {/* left */}\n            <div className=\"flex w-full flex-col space-y-4 \">\n              <HomeSensitiveWorksUsersRecommendedSection\n                works={data.promotionWorks}\n              />\n              <HomeSensitiveNewUsersWorksSection works={data.newUserWorks} />\n              <HomeSensitiveAwardWorkSection\n                awardDateText={data.awardDateText}\n                title={t(\"å‰æ—¥ãƒ©ãƒ³ã‚­ãƒ³ã‚°\", \"Previous Day Ranking\")}\n                awards={data.workAwards}\n              />\n              <HomeSensitiveWorksTagSection\n                tag={data.firstTag}\n                works={data.firstTagWorks}\n                secondTag={data.secondTag}\n                secondWorks={data.secondTagWorks}\n                isCropped\n              />\n              <HomeSensitiveTagsSection\n                title={t(\"äººæ°—ã‚¿ã‚°\", \"Popular Tags\")}\n                tags={data.recommendedTags}\n              />\n            </div>\n\n            {/* right */}\n            <Separator\n              orientation=\"vertical\"\n              className=\"hidden h-[100vh] w-[1px] md:block\"\n            />\n            <div className=\"flex w-full max-w-80 flex-col space-y-4\">\n              <Button\n                onClick={() => navigate(\"/\")}\n                variant=\"secondary\"\n                className=\"w-full\"\n              >\n                {t(\"å…¨å¹´é½¢\", \"All Ages\")}\n              </Button>\n\n              {!isSubscriptionUser &&\n                advertisements?.randomCustomerAdvertisement && (\n                  <div className=\"relative border\">\n                    <Link\n                      to={advertisements.randomCustomerAdvertisement.url}\n                      target=\"_blank\"\n                      onClick={() => {\n                        const id =\n                          advertisements.randomCustomerAdvertisement?.id\n                        if (!id) return\n                        updateClicked({\n                          variables: {\n                            id,\n                          },\n                        })\n                      }}\n                    >\n                      <img\n                        src={\n                          advertisements.randomCustomerAdvertisement.imageUrl\n                        }\n                        alt=\"Advertisement\"\n                      />\n                    </Link>\n                    <div className=\"absolute top-0 right-0\">\n                      <CrossPlatformTooltip\n                        text={t(\n                          \"ææºåºƒå‘Šã§ã™ã€åºƒå‘Šä¸»æ§˜ã‚’å‹Ÿé›†ä¸­ã§ã™ã€‚ãƒ¡ãƒ¼ãƒ«ã¾ãŸã¯DMã«ã¦ã”é€£çµ¡ãã ã•ã„ã€‚\",\n                          \"This is a partnered advertisement. We are accepting new advertisers. Please contact us via email or DM.\",\n                        )}\n                      />\n                    </div>\n                  </div>\n                )}\n\n              {data.newPostedUsers && (\n                <HomeNewSensitiveUsersSection users={data.newPostedUsers} />\n              )}\n              {data.newComments?.length > 0 && (\n                <HomeSensitiveNewCommentsSection comments={data.newComments} />\n              )}\n              {data.workAwards && (\n                <HomeAwardWorksSection works={data.workAwards} />\n              )}\n            </div>\n          </div>\n        </TabsContent>\n\n        {/* ---------- NEW / POPULAR / NEW-USER ---------- */}\n        <TabsContent value=\"new\" className=\"flex flex-col space-y-4\">\n          {/* toggle buttons */}\n          <div className=\"flex space-x-4\">\n            {[\n              { v: \"new\", label: t(\"æ–°ç€\", \"New\") },\n              // { v: \"popular\", label: t(\"äººæ°—\", \"Popular\") },\n              { v: \"new-user\", label: t(\"æ–°è¦ãƒ¦ãƒ¼ã‚¶\", \"New Users\") },\n            ].map(({ v, label }) => (\n              <Button\n                key={v}\n                variant={workView === v ? \"default\" : \"secondary\"}\n                onClick={() => handleWorkViewChange(v)}\n              >\n                {label}\n                {v === \"popular\" && (\n                  <CrossPlatformTooltip\n                    text={t(\n                      \"æœ€è¿‘æŠ•ç¨¿ã•ã‚ŒãŸäººæ°—ä½œå“ãŒè¡¨ç¤ºã•ã‚Œã¾ã™\",\n                      \"Recently popular works\",\n                    )}\n                  />\n                )}\n              </Button>\n            ))}\n          </div>\n\n          {/* filters (only on â€œnewâ€) */}\n          {workView === \"new\" && (\n            <>\n              <div className=\"space-y-4\">\n                {/* çµã‚Šè¾¼ã¿ç”¨ã®ã‚»ãƒ¬ã‚¯ãƒˆç¾¤ - ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */}\n                <div className=\"space-y-3\">\n                  {/* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¡Œ1: ç¨®é¡ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã€ã‚½ãƒ¼ãƒˆ */}\n                  <div className=\"grid grid-cols-3 gap-2 md:flex md:space-x-4\">\n                    {/* type */}\n                    <Select\n                      value={workType ?? \"\"}\n                      onValueChange={(v) => {\n                        setWorkType(v === \"ALL\" ? null : (v as any))\n                        syncParam(\"workType\", v === \"ALL\" ? null : v)\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <SelectValue\n                          placeholder={\n                            workType\n                              ? toWorkTypeText({ type: workType, lang: locale })\n                              : t(\"ç¨®é¡\", \"Type\")\n                          }\n                        />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {[\"ALL\", \"WORK\", \"VIDEO\", \"NOVEL\", \"COLUMN\"].map(\n                          (v) => (\n                            <SelectItem key={v} value={v}>\n                              {t(\n                                v === \"WORK\"\n                                  ? \"ç”»åƒ\"\n                                  : v === \"VIDEO\"\n                                    ? \"å‹•ç”»\"\n                                    : v === \"NOVEL\"\n                                      ? \"å°èª¬\"\n                                      : v === \"COLUMN\"\n                                        ? \"ã‚³ãƒ©ãƒ \"\n                                        : \"ç¨®é¡\",\n                                v,\n                              )}\n                            </SelectItem>\n                          ),\n                        )}\n                      </SelectContent>\n                    </Select>\n\n                    {/* prompt */}\n                    <Select\n                      value={\n                        isPromptPublic === null\n                          ? \"ALL\"\n                          : isPromptPublic\n                            ? \"prompt\"\n                            : \"no-prompt\"\n                      }\n                      onValueChange={(v) => {\n                        setIsPromptPublic(v === \"ALL\" ? null : v === \"prompt\")\n                        syncParam(\n                          \"isPromptPublic\",\n                          v === \"ALL\"\n                            ? null\n                            : v === \"prompt\"\n                              ? \"true\"\n                              : \"false\",\n                        )\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <SelectValue\n                          placeholder={t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ‰ç„¡\", \"Prompt\")}\n                        />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"ALL\">\n                          {t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ‰ç„¡\", \"Prompt\")}\n                        </SelectItem>\n                        <SelectItem value=\"prompt\">\n                          {t(\"ã‚ã‚Š\", \"Yes\")}\n                        </SelectItem>\n                        <SelectItem value=\"no-prompt\">\n                          {t(\"ãªã—\", \"No\")}\n                        </SelectItem>\n                      </SelectContent>\n                    </Select>\n\n                    {/* sort */}\n                    <Select\n                      value={sortType ?? \"\"}\n                      onValueChange={(v) => {\n                        setSortType(v === \"ALL\" ? null : (v as any))\n                        syncParam(\"sortType\", v === \"ALL\" ? null : v)\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <ArrowDownWideNarrow />\n                        <SelectValue placeholder={t(\"æœ€æ–°\", \"Latest\")} />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"DATE_CREATED\">\n                          {t(\"æœ€æ–°\", \"Latest\")}\n                        </SelectItem>\n                        <SelectItem value=\"LIKES_COUNT\">\n                          {t(\"æœ€ã‚‚äººæ°—\", \"Most Liked\")}\n                        </SelectItem>\n                        <SelectItem value=\"COMMENTS_COUNT\">\n                          {t(\"ã‚³ãƒ¡ãƒ³ãƒˆæ•°\", \"Most Comments\")}\n                        </SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  {/* time range */}\n                  <div className=\"flex flex-col space-y-2 md:flex-row md:items-center md:justify-between md:space-y-0\">\n                    <Select\n                      value={timeRange}\n                      onValueChange={(v) => {\n                        setTimeRange(v)\n                        syncParam(\"timeRange\", v === \"ALL\" ? null : v)\n                      }}\n                    >\n                      <SelectTrigger className=\"w-full text-xs md:w-auto md:min-w-[120px] md:text-sm\">\n                        <SelectValue placeholder={t(\"å…¨æœŸé–“\", \"All time\")} />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {[\"ALL\", \"TODAY\", \"YESTERDAY\", \"WEEK\"].map((v) => (\n                          <SelectItem key={v} value={v}>\n                            {t(\n                              v === \"TODAY\"\n                                ? \"æœ¬æ—¥\"\n                                : v === \"YESTERDAY\"\n                                  ? \"æ˜¨æ—¥\"\n                                  : v === \"WEEK\"\n                                    ? \"é€±é–“\"\n                                    : \"å…¨æœŸé–“\",\n                              v === \"ALL\"\n                                ? \"All time\"\n                                : v === \"TODAY\"\n                                  ? \"Today\"\n                                  : v === \"YESTERDAY\"\n                                    ? \"Yesterday\"\n                                    : \"Week\",\n                            )}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    {/* è¡¨ç¤ºæ–¹å¼åˆ‡ã‚Šæ›¿ãˆ - ã‚ˆã‚Šã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥ãªãƒ‡ã‚¶ã‚¤ãƒ³ */}\n                    <div className=\"flex space-x-2 md:space-x-4\">\n                      <div className=\"flex rounded-lg bg-muted p-1\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => {\n                            setInternalIsPagination(false)\n                            const p = new URLSearchParams(searchParams)\n                            p.set(\"isPagination\", \"false\")\n                            updateQueryParams(p)\n                          }}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            !internalIsPagination\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <List className=\"h-3 w-3\" />\n                          <span className=\"hidden sm:inline\">\n                            {t(\"ãƒ•ã‚£ãƒ¼ãƒ‰\", \"Feed\")}\n                          </span>\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => {\n                            setInternalIsPagination(true)\n                            const p = new URLSearchParams(searchParams)\n                            p.set(\"isPagination\", \"true\")\n                            updateQueryParams(p)\n                          }}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            internalIsPagination\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <Navigation className=\"h-3 w-3\" />\n                          <span className=\"hidden sm:inline\">\n                            {t(\"ãƒšãƒ¼ã‚¸\", \"Pages\")}\n                          </span>\n                        </Button>\n                      </div>\n                      <div className=\"flex rounded-lg bg-muted p-1\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => onChangeDialogMode(false)}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            !isDialogMode\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <ExternalLink className=\"h-4 w-4\" />\n                          <span>{t(\"ãƒªãƒ³ã‚¯é·ç§»\", \"Open page\")}</span>\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => onChangeDialogMode(true)}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            isDialogMode\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <PlaySquare className=\"h-4 w-4\" />\n                          <span>{t(\"ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\", \"Dialog\")}</span>\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <Suspense fallback={<AppLoadingPage />}>\n                {internalIsPagination ? (\n                  <HomePaginationSensitiveWorksSection\n                    page={newWorksPage}\n                    setPage={setNewWorksPage}\n                    workType={workType}\n                    isPromptPublic={isPromptPublic}\n                    sortType={sortType}\n                    timeRange={timeRange}\n                    isOneWorkPerUser={isOneWorkPerUser}\n                    onSelect={isDialogMode ? openWork : undefined}\n                    updateWorks={updateCurrentWorks}\n                  />\n                ) : (\n                  <HomeSensitiveWorksSection\n                    page={newWorksPage}\n                    setPage={setPageWithParam(setNewWorksPage, \"newPage\")}\n                    workType={workType}\n                    isPromptPublic={isPromptPublic}\n                    sortType={sortType}\n                    timeRange={timeRange}\n                    isPagination={false}\n                    onSelect={isDialogMode ? openWork : undefined}\n                    updateWorks={updateCurrentWorks}\n                  />\n                )}\n              </Suspense>\n            </>\n          )}\n\n          {workView === \"popular\" && (\n            <Suspense fallback={<AppLoadingPage />}>\n              <HomeSensitiveHotWorksSection\n                page={newWorksPage}\n                setPage={setPageWithParam(setNewWorksPage, \"newPage\")}\n                workType={workType}\n                isPromptPublic={isPromptPublic}\n                sortType={sortType}\n              />\n            </Suspense>\n          )}\n\n          {workView === \"new-user\" && (\n            <>\n              <div className=\"space-y-4\">\n                {/* çµã‚Šè¾¼ã¿ç”¨ã®ã‚»ãƒ¬ã‚¯ãƒˆç¾¤ - ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */}\n                <div className=\"space-y-3\">\n                  {/* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¡Œ1: ç¨®é¡ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã€ã‚½ãƒ¼ãƒˆ */}\n                  <div className=\"grid grid-cols-3 gap-2 md:flex md:space-x-4\">\n                    {/* type */}\n                    <Select\n                      value={workType ?? \"\"}\n                      onValueChange={(v) => {\n                        setWorkType(v === \"ALL\" ? null : (v as any))\n                        syncParam(\"workType\", v === \"ALL\" ? null : v)\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <SelectValue\n                          placeholder={\n                            workType\n                              ? toWorkTypeText({ type: workType, lang: locale })\n                              : t(\"ç¨®é¡\", \"Type\")\n                          }\n                        />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {[\"ALL\", \"WORK\", \"VIDEO\", \"NOVEL\", \"COLUMN\"].map(\n                          (v) => (\n                            <SelectItem key={v} value={v}>\n                              {t(\n                                v === \"WORK\"\n                                  ? \"ç”»åƒ\"\n                                  : v === \"VIDEO\"\n                                    ? \"å‹•ç”»\"\n                                    : v === \"NOVEL\"\n                                      ? \"å°èª¬\"\n                                      : v === \"COLUMN\"\n                                        ? \"ã‚³ãƒ©ãƒ \"\n                                        : \"ç¨®é¡\",\n                                v,\n                              )}\n                            </SelectItem>\n                          ),\n                        )}\n                      </SelectContent>\n                    </Select>\n\n                    {/* prompt */}\n                    <Select\n                      value={\n                        isPromptPublic === null\n                          ? \"ALL\"\n                          : isPromptPublic\n                            ? \"prompt\"\n                            : \"no-prompt\"\n                      }\n                      onValueChange={(v) => {\n                        setIsPromptPublic(v === \"ALL\" ? null : v === \"prompt\")\n                        syncParam(\n                          \"isPromptPublic\",\n                          v === \"ALL\"\n                            ? null\n                            : v === \"prompt\"\n                              ? \"true\"\n                              : \"false\",\n                        )\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <SelectValue\n                          placeholder={t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ‰ç„¡\", \"Prompt\")}\n                        />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"ALL\">\n                          {t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ‰ç„¡\", \"Prompt\")}\n                        </SelectItem>\n                        <SelectItem value=\"prompt\">\n                          {t(\"ã‚ã‚Š\", \"Yes\")}\n                        </SelectItem>\n                        <SelectItem value=\"no-prompt\">\n                          {t(\"ãªã—\", \"No\")}\n                        </SelectItem>\n                      </SelectContent>\n                    </Select>\n\n                    {/* sort */}\n                    <Select\n                      value={sortType ?? \"\"}\n                      onValueChange={(v) => {\n                        setSortType(v === \"ALL\" ? null : (v as any))\n                        syncParam(\"sortType\", v === \"ALL\" ? null : v)\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <ArrowDownWideNarrow />\n                        <SelectValue placeholder={t(\"æœ€æ–°\", \"Latest\")} />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"DATE_CREATED\">\n                          {t(\"æœ€æ–°\", \"Latest\")}\n                        </SelectItem>\n                        <SelectItem value=\"LIKES_COUNT\">\n                          {t(\"æœ€ã‚‚äººæ°—\", \"Most Liked\")}\n                        </SelectItem>\n                        <SelectItem value=\"COMMENTS_COUNT\">\n                          {t(\"ã‚³ãƒ¡ãƒ³ãƒˆæ•°\", \"Most Comments\")}\n                        </SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  {/* time range */}\n                  <div className=\"flex flex-col justify-end space-y-2 md:flex-row md:items-center md:space-y-0\">\n                    {/* è¡¨ç¤ºæ–¹å¼åˆ‡ã‚Šæ›¿ãˆ - ã‚ˆã‚Šã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥ãªãƒ‡ã‚¶ã‚¤ãƒ³ */}\n                    <div className=\"flex justify-end space-x-2 md:space-x-4\">\n                      <div className=\"flex justify-end rounded-lg bg-muted p-1\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => onChangeDialogMode(false)}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            !isDialogMode\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <ExternalLink className=\"h-4 w-4\" />\n                          <span>{t(\"ãƒªãƒ³ã‚¯é·ç§»\", \"Open page\")}</span>\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => onChangeDialogMode(true)}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            isDialogMode\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <PlaySquare className=\"h-4 w-4\" />\n                          <span>{t(\"ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\", \"Dialog\")}</span>\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <Suspense fallback={<AppLoadingPage />}>\n                <HomeNewUsersSensitiveWorkListSection\n                  workType={workType}\n                  isPromptPublic={isPromptPublic}\n                  sortType={sortType}\n                  isOneWorkPerUser={isOneWorkPerUser}\n                  onSelect={isDialogMode ? openWork : undefined}\n                  updateWorks={updateCurrentWorks}\n                />\n              </Suspense>\n            </>\n          )}\n        </TabsContent>\n\n        {/* ---------- FOLLOW USER ---------- */}\n        <TabsContent value=\"follow-user\" className=\"space-y-4\">\n          {/* Feed / Pages åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ */}\n          <div className=\"flex justify-end space-x-2 md:space-x-4\">\n            <div className=\"flex rounded-lg bg-muted p-1\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => {\n                  setInternalIsPagination(false)\n                  const p = new URLSearchParams(searchParams)\n                  p.set(\"isPagination\", \"false\")\n                  updateQueryParams(p)\n                }}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 text-xs ${\n                  !internalIsPagination\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                }`}\n              >\n                <List className=\"h-3 w-3\" />\n                <span className=\"hidden sm:inline\">\n                  {t(\"ãƒ•ã‚£ãƒ¼ãƒ‰\", \"Feed\")}\n                </span>\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => {\n                  setInternalIsPagination(true)\n                  const p = new URLSearchParams(searchParams)\n                  p.set(\"isPagination\", \"true\")\n                  updateQueryParams(p)\n                }}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 text-xs ${\n                  internalIsPagination\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                }`}\n              >\n                <Navigation className=\"h-3 w-3\" />\n                <span className=\"hidden sm:inline\">{t(\"ãƒšãƒ¼ã‚¸\", \"Pages\")}</span>\n              </Button>\n            </div>\n            <div className=\"flex rounded-lg bg-muted p-1\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => onChangeDialogMode(false)}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                  !isDialogMode\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                } `}\n              >\n                <ExternalLink className=\"h-4 w-4\" />\n                <span>{t(\"ãƒªãƒ³ã‚¯é·ç§»\", \"Open page\")}</span>\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => onChangeDialogMode(true)}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                  isDialogMode\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                } `}\n              >\n                <PlaySquare className=\"h-4 w-4\" />\n                <span>{t(\"ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\", \"Dialog\")}</span>\n              </Button>\n            </div>\n          </div>\n\n          {/* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */}\n          <Suspense fallback={<AppLoadingPage />}>\n            <FollowSensitiveUserFeedContents\n              page={followUserFeedPage}\n              setPage={setPageWithParam(\n                setFollowUserFeedPage,\n                \"followUserPage\",\n              )}\n              isPagination={internalIsPagination}\n              onPaginationModeChange={setInternalIsPagination}\n              onSelect={isDialogMode ? openWork : undefined}\n              updateWorks={updateCurrentWorks}\n            />\n          </Suspense>\n        </TabsContent>\n\n        {/* ---------- FOLLOW TAG ---------- */}\n        <TabsContent value=\"follow-tag\" className=\"space-y-4\">\n          {/* Feed / Pages åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ */}\n          <div className=\"flex justify-end space-x-2 md:space-x-4\">\n            <div className=\"flex rounded-lg bg-muted p-1\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => {\n                  setInternalIsPagination(false)\n                  const p = new URLSearchParams(searchParams)\n                  p.set(\"isPagination\", \"false\")\n                  updateQueryParams(p)\n                }}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 text-xs ${\n                  !internalIsPagination\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                }`}\n              >\n                <List className=\"h-3 w-3\" />\n                <span className=\"hidden sm:inline\">\n                  {t(\"ãƒ•ã‚£ãƒ¼ãƒ‰\", \"Feed\")}\n                </span>\n              </Button>\n\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => {\n                  setInternalIsPagination(true)\n                  const p = new URLSearchParams(searchParams)\n                  p.set(\"isPagination\", \"true\")\n                  updateQueryParams(p)\n                }}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 text-xs ${\n                  internalIsPagination\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                }`}\n              >\n                <Navigation className=\"h-3 w-3\" />\n                <span className=\"hidden sm:inline\">{t(\"ãƒšãƒ¼ã‚¸\", \"Pages\")}</span>\n              </Button>\n            </div>\n            <div className=\"flex rounded-lg bg-muted p-1\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => onChangeDialogMode(false)}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                  !isDialogMode\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                } `}\n              >\n                <ExternalLink className=\"h-4 w-4\" />\n                <span>{t(\"ãƒªãƒ³ã‚¯é·ç§»\", \"Open page\")}</span>\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => onChangeDialogMode(true)}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                  isDialogMode\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                } `}\n              >\n                <PlaySquare className=\"h-4 w-4\" />\n                <span>{t(\"ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\", \"Dialog\")}</span>\n              </Button>\n            </div>\n          </div>\n\n          <Suspense fallback={<AppLoadingPage />}>\n            <FollowSensitiveTagsFeedContents\n              page={followTagFeedPage}\n              setPage={setPageWithParam(setFollowTagFeedPage, \"followTagPage\")}\n              isPagination={internalIsPagination}\n              onSelect={isDialogMode ? openWork : undefined}\n              updateWorks={updateCurrentWorks}\n            />\n          </Suspense>\n        </TabsContent>\n      </Tabs>\n\n      {/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ä½œå“ãƒ€ã‚¤ã‚¢ãƒ­ã‚° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */}\n      {workDialog.isOpen && workDialog.workId && (\n        <WorkViewerDialog\n          works={displayedWorks}\n          startWorkId={workDialog.workId}\n          onClose={workDialog.closeDialog}\n          loadMore={!internalIsPagination ? loadMore : undefined}\n          hasNextPage={hasNextPage}\n          isLoadingMore={isLoadingMore}\n        />\n      )}\n    </>\n  )\n}\n\nconst query = graphql(\n  `query HomeQuery(\n    # $pastGenerationBefore: String!\n    $year: Int!\n    $month: Int!\n    $day: Int!\n    $awardYear: Int!\n    $awardMonth: Int!\n    $awardDay: Int!\n    $adWorksLimit: Int!\n    # $novelWorksLimit: Int!\n    # $novelWorksBefore: String!\n    # $columnWorksLimit: Int!\n    # $columnWorksBefore: String!\n    # $generationWorksLimit: Int!\n    $promotionWorksLimit: Int!\n    $awardWorksLimit: Int!\n    $categoryFirst: String!\n    $categorySecond: String!\n    $tagWorksLimit: Int!\n    $newUsersWorksLimit: Int!\n  ) {\n    adWorks: works(\n      offset: 0,\n      limit: $adWorksLimit,\n      where: {\n        isFeatured: true,\n        ratings: [R18],\n        isNowCreatedAt: true\n      }\n    ) {\n      ...HomeBannerWork\n    }\n    dailyTheme(year: $year, month: $month, day: $day) {\n      id\n      title\n    }\n    hotSensitiveTags {\n      ...HomeTagListItem\n    }\n    workAwards(\n      offset: 0\n      limit: $awardWorksLimit\n      where: {\n        year: $awardYear\n        month: $awardMonth\n        day: $awardDay\n        isSensitive: true\n      }\n    ) {\n      ...HomeWorkAward\n    }\n    recommendedTags: recommendedTags(\n      limit: 16\n      where: {\n        isSensitive: true,\n      }\n    ) {\n      ...HomeTag\n    }\n    firstTagWorks: works(\n      offset: 0,\n      limit: $tagWorksLimit,\n      where: {\n        ratings: [R18],\n        search: $categoryFirst\n        orderBy: LIKES_COUNT\n        isSensitive: true\n        isNowCreatedAt: true\n      }\n    ) {\n      ...HomeTagWork\n    }\n    secondTagWorks: works(\n      offset: 0,\n      limit: $tagWorksLimit,\n      where: {\n        ratings: [R18]\n        search: $categorySecond\n        orderBy: LIKES_COUNT\n        isSensitive: true\n        isNowCreatedAt: true\n      }\n    ) {\n      ...HomeTagWork\n    }\n    newUserWorks: newUserWorks(\n      offset: 0,\n      limit: $newUsersWorksLimit,\n      where: {\n        ratings: [R18, R18G],\n      }\n    ) {\n      ...HomeNewUsersWorks\n    }\n    newPostedUsers: newPostedUsers(\n      offset: 0,\n      limit: 8,\n      where: {\n        isSensitive: true,\n      }\n    ) {\n      ...HomeNewPostedUsers\n    }\n    newComments: newComments(\n      offset: 0,\n      limit: 8,\n      where: {\n        isSensitive: true,\n        isTextOnly: true,\n        ratings: [R18, R18G],\n      }\n    ) {\n      ...HomeNewComments\n    }\n    promotionWorks: works(\n      offset: 0,\n      limit: $promotionWorksLimit,\n      where: {\n        isRecommended: true\n        isNowCreatedAt: true\n        ratings: [R18]\n      }\n    ) {\n      ...HomePromotionWork\n    }\n    # novelWorks: works(\n    #   offset: 0,\n    #   limit: $novelWorksLimit,\n    #   where: {\n    #     ratings: [G, R15],\n    #     workType: NOVEL,\n    #     beforeCreatedAt: $novelWorksBefore\n    #   }\n    # ) {\n    #   ...HomeNovelPost\n    # }\n    # columnWorks: works(\n    #   offset: 0,\n    #   limit: $columnWorksLimit,\n    #   where: {\n    #     ratings: [G, R15],\n    #     workType: COLUMN,\n    #     beforeCreatedAt: $columnWorksBefore\n    #   }\n    # ) {\n    #   ...HomeColumnPost\n    # }\n  }`,\n  [\n    HomeBannerWorkFragment,\n    HomePromotionWorkFragment,\n    // HomeNovelPostFragment,\n    HomeTagListItemFragment,\n    // HomeGenerationWorkFragment,\n    HomeWorkAwardFragment,\n    // HomeColumnPostFragment,\n    HomeTagFragment,\n    HomeTagWorkFragment,\n    HomeNewUsersWorksFragment,\n    HomeNewPostedUsersFragment,\n    HomeNewCommentsFragment,\n  ],\n)\n\nconst viewerCurrentPassQuery = graphql(\n  `query ViewerCurrentPass {\n    viewer {\n      id\n      currentPass {\n        id\n        type\n      }\n    }\n  }`,\n)\n\nexport const SideMenuAdvertisementsFragment = graphql(\n  `fragment SideMenuAdvertisementsFields on CustomerAdvertisementNode @_unmask {\n      id\n      imageUrl\n      url\n      displayProbability\n      clickCount\n      impressionCount\n      isSensitive\n      createdAt\n      page\n      startAt\n      endAt\n      isActive\n  }`,\n)\n\nconst randomCustomerAdvertisementQuery = graphql(\n  `query RandomCustomerAdvertisement($where: RandomCustomerAdvertisementWhereInput!) {\n    randomCustomerAdvertisement(where: $where) {\n      ...SideMenuAdvertisementsFields\n    }\n  }`,\n  [SideMenuAdvertisementsFragment],\n)\n\nconst updateClickedCountCustomerAdvertisementMutation = graphql(\n  `mutation UpdateClickedCountCustomerAdvertisement($id: ID!) {\n    updateClickedCountCustomerAdvertisement(id: $id) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/suspicious/noExplicitAny","severity":"warning","description":"Unexpected any. Specify a different type.","message":[{"elements":[],"content":"Unexpected "},{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":". Specify a different type."}],"advices":{"advices":[{"log":["info",[{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":" disables many type checking rules. Its use should be avoided."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).r._index/route.tsx"},"span":[20836,20839],"sourceCode":"import { loaderClient } from \"~/lib/loader-client\"\nimport { HomeWorkAwardFragment } from \"~/routes/($lang)._main._index/components/home-award-work-section\"\nimport { HomeBannerWorkFragment } from \"~/routes/($lang)._main._index/components/home-banners\"\nimport { HomeTagListItemFragment } from \"~/routes/($lang)._main._index/components/home-tag-list\"\nimport { HomeTagFragment } from \"~/routes/($lang)._main._index/components/home-tags-section\"\nimport { HomePromotionWorkFragment } from \"~/routes/($lang)._main._index/components/home-works-users-recommended-section\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport {\n  Link,\n  useLoaderData,\n  useNavigate,\n  useSearchParams,\n} from \"@remix-run/react\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\nimport { config, META } from \"~/config\"\nimport { HomeTagWorkFragment } from \"~/routes/($lang)._main._index/components/home-works-tag-section\"\nimport { getJstDate } from \"~/utils/jst-date\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { HomeNewUsersWorksFragment } from \"~/routes/($lang)._main._index/components/home-new-users-works-section\"\nimport { HomeNewCommentsFragment } from \"~/routes/($lang)._main._index/components/home-new-comments\"\nimport { HomeNewPostedUsersFragment } from \"~/routes/($lang)._main._index/components/home-new-users-section\"\nimport {\n  ArrowDownWideNarrow,\n  ExternalLink,\n  List,\n  Navigation,\n  PlaySquare,\n} from \"lucide-react\"\nimport { useState, Suspense, useMemo, useEffect } from \"react\"\nimport { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { CrossPlatformTooltip } from \"~/components/cross-platform-tooltip\"\nimport { Button } from \"~/components/ui/button\"\nimport {\n  Select,\n  SelectTrigger,\n  SelectValue,\n  SelectContent,\n  SelectItem,\n} from \"~/components/ui/select\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { Tabs, TabsContent } from \"~/components/ui/tabs\"\nimport { useLocale } from \"~/hooks/use-locale\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { toWorkTypeText } from \"~/utils/work/to-work-type-text\"\nimport { HomeSensitiveHotWorksSection } from \"~/routes/($lang)._main._index/components/home-sensitive-hot-works-section\"\nimport { HomeSensitiveWorksSection } from \"~/routes/($lang)._main._index/components/home-sensitive-works-section\"\nimport { HomeSensitiveWorksTagSection } from \"~/routes/($lang)._main._index/components/home-sensitive-works-tag-section\"\nimport { HomeSensitiveNewUsersWorksSection } from \"~/routes/($lang)._main._index/components/home-sensitive-new-users-works-section\"\nimport { HomeSensitiveAwardWorkSection } from \"~/routes/($lang)._main._index/components/home-sensitive-award-work-section\"\nimport { HomeSensitiveTagsSection } from \"~/routes/($lang)._main._index/components/home-sensitive-tags-section\"\nimport { useQuery, useMutation } from \"@apollo/client/index\"\nimport { HomeAwardWorksSection } from \"~/routes/($lang)._main._index/components/home-award-works\"\nimport { HomeSensitiveTagList } from \"~/routes/($lang).r._index/components/home-sensitive-tag-list\"\nimport { HomeNewUsersSensitiveWorkListSection } from \"~/routes/($lang).r._index/components/home-new-user-sensitive-work-list-section\"\nimport { FollowSensitiveTagsFeedContents } from \"~/routes/($lang)._main._index/components/follow-sensitive-tags-feed-contents\"\nimport { FollowSensitiveUserFeedContents } from \"~/routes/($lang)._main._index/components/follow-sensitive-user-feed-contents\"\nimport { HomeSensitiveNewCommentsSection } from \"~/routes/($lang)._main._index/components/home-sensitive-new-comments\"\nimport { HomeNewSensitiveUsersSection } from \"~/routes/($lang)._main._index/components/home-new-sensitive-users-section\"\nimport { HomeSensitiveWorksUsersRecommendedSection } from \"~/routes/($lang)._main._index/components/home-sensitive-works-users-recommended-section\"\nimport { AppAnimatedTabs } from \"~/components/app/app-animated-tabs\"\nimport type { PhotoAlbumWorkFragment } from \"~/components/responsive-photo-works-album\"\nimport { WorkViewerDialog } from \"~/components/work/work-viewer-dialog\"\nimport { HomePaginationSensitiveWorksSection } from \"~/routes/($lang).r._index/components/home-pagination-sensitive-works-section\"\nimport { useWorkDialogUrl } from \"~/hooks/use-work-dialog-url\"\n\n// ---------- meta ----------\nexport const meta: MetaFunction = (props) =>\n  createMeta(META.HOME_SENSITIVE, undefined, props.params.lang)\n\n// ---------- utils ----------\nconst getUtcDateString = (d: Date) =>\n  `${d.getUTCFullYear()}/${`0${d.getUTCMonth() + 1}`.slice(-2)}/${`0${d.getUTCDate()}`.slice(-2)}`\n\n// ---------- loader ----------\nexport async function loader(_props: LoaderFunctionArgs) {\n  const categories = [\"ç¸„\", \"ä¸­ã ã—\"]\n  const pick2 = (arr: string[]) =>\n    arr.sort(() => Math.random() - 0.5).slice(0, 2)\n\n  const [firstTag, secondTag] = pick2(categories)\n  const now = getJstDate()\n  const yesterday = new Date(now.getTime() - 86_400_000)\n\n  const { data } = await loaderClient.query({\n    query,\n    variables: {\n      awardDay: yesterday.getDate(),\n      awardMonth: yesterday.getMonth() + 1,\n      awardYear: yesterday.getFullYear(),\n      day: now.getDate(),\n      month: now.getMonth() + 1,\n      year: now.getFullYear(),\n      adWorksLimit: config.query.homeWorkCount.ad,\n      promotionWorksLimit: config.query.homeWorkCount.promotion,\n      awardWorksLimit: config.query.homeWorkCount.award,\n      categoryFirst: firstTag,\n      categorySecond: secondTag,\n      tagWorksLimit: config.query.homeWorkCount.tag,\n      newUsersWorksLimit: config.query.homeWorkCount.newUser,\n    },\n  })\n\n  return {\n    ...data,\n    awardDateText: getUtcDateString(yesterday),\n    firstTag,\n    secondTag,\n  }\n}\n\n// ---------- headers ----------\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.home,\n})\n\n// ---------- helper ----------\nconst useUpdateQueryParams = () => (p: URLSearchParams) =>\n  window.history.replaceState(null, \"\", `${location.pathname}?${p}`)\n\n// ---------- component ----------\nexport default function Index () {\n  const data = useLoaderData<typeof loader>()\n  const t = useTranslation()\n  const locale = useLocale()\n  const navigate = useNavigate()\n  const [searchParams] = useSearchParams()\n  const updateQueryParams = useUpdateQueryParams()\n\n  // ------ local state ------\n  const [currentTab, setCurrentTab] = useState(\n    searchParams.get(\"tab\") ?? \"home\",\n  )\n  const [workView, setWorkView] = useState(searchParams.get(\"view\") ?? \"new\")\n  const [newWorksPage, setNewWorksPage] = useState(\n    Number(searchParams.get(\"newPage\") ?? 0),\n  )\n  const [followUserFeedPage, setFollowUserFeedPage] = useState(\n    Number(searchParams.get(\"followUserPage\") ?? 0),\n  )\n  const [followTagFeedPage, setFollowTagFeedPage] = useState(\n    Number(searchParams.get(\"followTagPage\") ?? 0),\n  )\n  const [workType, setWorkType] =\n    useState<IntrospectionEnum<\"WorkType\"> | null>(\n      (searchParams.get(\"workType\") as IntrospectionEnum<\"WorkType\">) ?? null,\n    )\n  const [isPromptPublic, setIsPromptPublic] = useState<boolean | null>(\n    searchParams.get(\"isPromptPublic\") === null\n      ? null\n      : searchParams.get(\"isPromptPublic\") === \"true\",\n  )\n  const [sortType, setSortType] =\n    useState<IntrospectionEnum<\"WorkOrderBy\"> | null>(\n      (searchParams.get(\"sortType\") as IntrospectionEnum<\"WorkOrderBy\">) ??\n        null,\n    )\n  const [timeRange, setTimeRange] = useState(\n    searchParams.get(\"timeRange\") ?? \"ALL\",\n  )\n  const [isOneWorkPerUser, _setIsOneWorkPerUser] = useState<boolean>(\n    searchParams.get(\"isOneWorkPerUser\") === \"true\",\n  )\n\n  const [internalIsPagination, setInternalIsPagination] = useState(true)\n\n  // ä½œå“é·ç§»ãƒ¢ãƒ¼ãƒ‰ï¼ˆãƒ€ã‚¤ã‚¢ãƒ­ã‚° / ç›´æ¥ãƒªãƒ³ã‚¯ï¼‰\n  const [isDialogMode, setIsDialogMode] = useState(false)\n\n  // Work dialog URL state management\n  const workDialog = useWorkDialogUrl()\n\n  // ä½œå“ãƒ‡ãƒ¼ã‚¿ã®ç®¡ç†ç”¨state\n  const [currentWorks, setCurrentWorks] = useState<\n    FragmentOf<typeof PhotoAlbumWorkFragment>[]\n  >([])\n\n  const [isLoadingMore, _setIsLoadingMore] = useState(false)\n\n  // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§è¡¨ç¤ºã™ã‚‹ä½œå“ãƒ‡ãƒ¼ã‚¿ã‚’æ±ºå®š\n  const displayedWorks = useMemo(() => {\n    switch (currentTab) {\n      case \"new\":\n      case \"follow-user\":\n      case \"follow-tag\":\n        return currentWorks\n      default:\n        return []\n    }\n  }, [currentTab, currentWorks])\n\n  const [hasNextPage, _setHasNextPage] = useState(true)\n\n  // ä½œå“ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†\n  const openWork = (idx: string) => {\n    // displayedWorksã®workã®idä¸€è‡´ã™ã‚‹ã‚‚ã®\n    const work = displayedWorks.find((w) => w.id === idx)\n    if (!work) {\n      console.error(\"Work not found for ID:\", idx)\n      return\n    }\n    if (isDialogMode) {\n      console.log(\"Opening dialog for work ID:\", idx)\n      workDialog.openDialog(idx)\n    } else {\n      console.log(\"Navigating to:\", `/posts/${work.id}`)\n      navigate(`/posts/${work.id}`)\n    }\n  }\n\n  // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãƒ¢ãƒ¼ãƒ‰å¤‰æ›´æ™‚ã®å‡¦ç†ï¼ˆlocalStorageã«ä¿å­˜ï¼‰\n  const onChangeDialogMode = (mode: boolean) => {\n    setIsDialogMode(mode)\n    if (typeof window !== \"undefined\") {\n      try {\n        localStorage.setItem(\"aipictors-dialog-mode\", JSON.stringify(mode))\n      } catch (error) {\n        console.error(\"Failed to save dialog mode to localStorage:\", error)\n      }\n    }\n    // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‰ã˜ã‚‹\n    if (!mode) {\n      workDialog.closeDialog()\n    }\n  }\n\n  // currentWorksã‚’æ›´æ–°ã™ã‚‹ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°\n  const updateCurrentWorks = (\n    works: FragmentOf<typeof PhotoAlbumWorkFragment>[],\n  ) => {\n    setCurrentWorks(works)\n  }\n\n  // ç„¡é™ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ç”¨ã®loadMoreé–¢æ•°\n  const loadMore = async () => {\n    if (isLoadingMore || !hasNextPage || internalIsPagination) return\n  }\n\n  // ------ URL sync helpers ------\n  const syncParam = (key: string, value: string | null) => {\n    const p = new URLSearchParams(searchParams)\n    value === null ? p.delete(key) : p.set(key, value)\n    updateQueryParams(p)\n  }\n\n  const handleTabChange = (tab: string) => {\n    setCurrentTab(tab)\n    syncParam(\"tab\", tab)\n  }\n  const handleWorkViewChange = (v: string) => {\n    setWorkView(v)\n    syncParam(\"view\", v)\n  }\n\n  const setPageWithParam =\n    (setter: (n: number) => void, paramKey: string) => (n: number) => {\n      setter(n)\n      syncParam(paramKey, String(n))\n    }\n\n  // ------ GraphQL for sideâ€menu ads ------\n  const { data: pass } = useQuery(viewerCurrentPassQuery)\n  const { data: advertisements } = useQuery(randomCustomerAdvertisementQuery, {\n    variables: { where: { isSensitive: true, page: \"work\" } },\n  })\n  const [updateClicked] = useMutation(\n    updateClickedCountCustomerAdvertisementMutation,\n  )\n  const isSubscriptionUser = [\"LITE\", \"STANDARD\", \"PREMIUM\"].includes(\n    pass?.viewer?.currentPass?.type ?? \"\",\n  )\n\n  // localStorageã‹ã‚‰ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’å¾©å…ƒ\n  useEffect(() => {\n    if (typeof window !== \"undefined\") {\n      try {\n        const savedMode = localStorage.getItem(\"aipictors-dialog-mode\")\n        if (savedMode !== null) {\n          const parsedMode = JSON.parse(savedMode)\n          setIsDialogMode(parsedMode)\n        }\n      } catch (error) {\n        console.error(\"Failed to restore dialog mode from localStorage:\", error)\n      }\n    }\n  }, [])\n\n  // ---------- render ----------\n  if (!data) return null\n\n  return (\n    <>\n      <Tabs\n        value={currentTab}\n        onValueChange={handleTabChange}\n        className=\"space-y-4\"\n      >\n        {/* ---------- TAB HEADER ---------- */}\n        <div className=\"flex items-center sm:gap-x-2 md:gap-x-4\">\n          <AppAnimatedTabs\n            tabs={[\n              { label: \"ãƒ›ãƒ¼ãƒ \", value: \"home\" },\n              { label: \"æ–°ç€ãƒ»äººæ°—\", value: \"new\" },\n              { label: \"ãƒ•ã‚©ãƒ­ãƒ¼æ–°ç€\", value: \"follow-user\" },\n              { label: \"ãŠæ°—ã«å…¥ã‚Šã‚¿ã‚°æ–°ç€\", value: \"follow-tag\" },\n            ]}\n            value={currentTab}\n            onChange={setCurrentTab}\n          />\n          <Button variant=\"secondary\" size=\"sm\" onClick={() => navigate(\"/\")}>\n            å…¨å¹´é½¢\n          </Button>\n        </div>\n\n        {/* ---------- HOME ---------- */}\n        <TabsContent value=\"home\" className=\"m-0 flex flex-col space-y-4\">\n          <HomeSensitiveTagList\n            themeTitle={data.dailyTheme?.title}\n            hotTags={data.hotSensitiveTags}\n          />\n          <div className=\"block space-y-4 md:flex md:space-x-4 md:space-y-0\">\n            {/* left */}\n            <div className=\"flex w-full flex-col space-y-4 \">\n              <HomeSensitiveWorksUsersRecommendedSection\n                works={data.promotionWorks}\n              />\n              <HomeSensitiveNewUsersWorksSection works={data.newUserWorks} />\n              <HomeSensitiveAwardWorkSection\n                awardDateText={data.awardDateText}\n                title={t(\"å‰æ—¥ãƒ©ãƒ³ã‚­ãƒ³ã‚°\", \"Previous Day Ranking\")}\n                awards={data.workAwards}\n              />\n              <HomeSensitiveWorksTagSection\n                tag={data.firstTag}\n                works={data.firstTagWorks}\n                secondTag={data.secondTag}\n                secondWorks={data.secondTagWorks}\n                isCropped\n              />\n              <HomeSensitiveTagsSection\n                title={t(\"äººæ°—ã‚¿ã‚°\", \"Popular Tags\")}\n                tags={data.recommendedTags}\n              />\n            </div>\n\n            {/* right */}\n            <Separator\n              orientation=\"vertical\"\n              className=\"hidden h-[100vh] w-[1px] md:block\"\n            />\n            <div className=\"flex w-full max-w-80 flex-col space-y-4\">\n              <Button\n                onClick={() => navigate(\"/\")}\n                variant=\"secondary\"\n                className=\"w-full\"\n              >\n                {t(\"å…¨å¹´é½¢\", \"All Ages\")}\n              </Button>\n\n              {!isSubscriptionUser &&\n                advertisements?.randomCustomerAdvertisement && (\n                  <div className=\"relative border\">\n                    <Link\n                      to={advertisements.randomCustomerAdvertisement.url}\n                      target=\"_blank\"\n                      onClick={() => {\n                        const id =\n                          advertisements.randomCustomerAdvertisement?.id\n                        if (!id) return\n                        updateClicked({\n                          variables: {\n                            id,\n                          },\n                        })\n                      }}\n                    >\n                      <img\n                        src={\n                          advertisements.randomCustomerAdvertisement.imageUrl\n                        }\n                        alt=\"Advertisement\"\n                      />\n                    </Link>\n                    <div className=\"absolute top-0 right-0\">\n                      <CrossPlatformTooltip\n                        text={t(\n                          \"ææºåºƒå‘Šã§ã™ã€åºƒå‘Šä¸»æ§˜ã‚’å‹Ÿé›†ä¸­ã§ã™ã€‚ãƒ¡ãƒ¼ãƒ«ã¾ãŸã¯DMã«ã¦ã”é€£çµ¡ãã ã•ã„ã€‚\",\n                          \"This is a partnered advertisement. We are accepting new advertisers. Please contact us via email or DM.\",\n                        )}\n                      />\n                    </div>\n                  </div>\n                )}\n\n              {data.newPostedUsers && (\n                <HomeNewSensitiveUsersSection users={data.newPostedUsers} />\n              )}\n              {data.newComments?.length > 0 && (\n                <HomeSensitiveNewCommentsSection comments={data.newComments} />\n              )}\n              {data.workAwards && (\n                <HomeAwardWorksSection works={data.workAwards} />\n              )}\n            </div>\n          </div>\n        </TabsContent>\n\n        {/* ---------- NEW / POPULAR / NEW-USER ---------- */}\n        <TabsContent value=\"new\" className=\"flex flex-col space-y-4\">\n          {/* toggle buttons */}\n          <div className=\"flex space-x-4\">\n            {[\n              { v: \"new\", label: t(\"æ–°ç€\", \"New\") },\n              // { v: \"popular\", label: t(\"äººæ°—\", \"Popular\") },\n              { v: \"new-user\", label: t(\"æ–°è¦ãƒ¦ãƒ¼ã‚¶\", \"New Users\") },\n            ].map(({ v, label }) => (\n              <Button\n                key={v}\n                variant={workView === v ? \"default\" : \"secondary\"}\n                onClick={() => handleWorkViewChange(v)}\n              >\n                {label}\n                {v === \"popular\" && (\n                  <CrossPlatformTooltip\n                    text={t(\n                      \"æœ€è¿‘æŠ•ç¨¿ã•ã‚ŒãŸäººæ°—ä½œå“ãŒè¡¨ç¤ºã•ã‚Œã¾ã™\",\n                      \"Recently popular works\",\n                    )}\n                  />\n                )}\n              </Button>\n            ))}\n          </div>\n\n          {/* filters (only on â€œnewâ€) */}\n          {workView === \"new\" && (\n            <>\n              <div className=\"space-y-4\">\n                {/* çµã‚Šè¾¼ã¿ç”¨ã®ã‚»ãƒ¬ã‚¯ãƒˆç¾¤ - ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */}\n                <div className=\"space-y-3\">\n                  {/* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¡Œ1: ç¨®é¡ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã€ã‚½ãƒ¼ãƒˆ */}\n                  <div className=\"grid grid-cols-3 gap-2 md:flex md:space-x-4\">\n                    {/* type */}\n                    <Select\n                      value={workType ?? \"\"}\n                      onValueChange={(v) => {\n                        setWorkType(v === \"ALL\" ? null : (v as any))\n                        syncParam(\"workType\", v === \"ALL\" ? null : v)\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <SelectValue\n                          placeholder={\n                            workType\n                              ? toWorkTypeText({ type: workType, lang: locale })\n                              : t(\"ç¨®é¡\", \"Type\")\n                          }\n                        />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {[\"ALL\", \"WORK\", \"VIDEO\", \"NOVEL\", \"COLUMN\"].map(\n                          (v) => (\n                            <SelectItem key={v} value={v}>\n                              {t(\n                                v === \"WORK\"\n                                  ? \"ç”»åƒ\"\n                                  : v === \"VIDEO\"\n                                    ? \"å‹•ç”»\"\n                                    : v === \"NOVEL\"\n                                      ? \"å°èª¬\"\n                                      : v === \"COLUMN\"\n                                        ? \"ã‚³ãƒ©ãƒ \"\n                                        : \"ç¨®é¡\",\n                                v,\n                              )}\n                            </SelectItem>\n                          ),\n                        )}\n                      </SelectContent>\n                    </Select>\n\n                    {/* prompt */}\n                    <Select\n                      value={\n                        isPromptPublic === null\n                          ? \"ALL\"\n                          : isPromptPublic\n                            ? \"prompt\"\n                            : \"no-prompt\"\n                      }\n                      onValueChange={(v) => {\n                        setIsPromptPublic(v === \"ALL\" ? null : v === \"prompt\")\n                        syncParam(\n                          \"isPromptPublic\",\n                          v === \"ALL\"\n                            ? null\n                            : v === \"prompt\"\n                              ? \"true\"\n                              : \"false\",\n                        )\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <SelectValue\n                          placeholder={t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ‰ç„¡\", \"Prompt\")}\n                        />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"ALL\">\n                          {t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ‰ç„¡\", \"Prompt\")}\n                        </SelectItem>\n                        <SelectItem value=\"prompt\">\n                          {t(\"ã‚ã‚Š\", \"Yes\")}\n                        </SelectItem>\n                        <SelectItem value=\"no-prompt\">\n                          {t(\"ãªã—\", \"No\")}\n                        </SelectItem>\n                      </SelectContent>\n                    </Select>\n\n                    {/* sort */}\n                    <Select\n                      value={sortType ?? \"\"}\n                      onValueChange={(v) => {\n                        setSortType(v === \"ALL\" ? null : (v as any))\n                        syncParam(\"sortType\", v === \"ALL\" ? null : v)\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <ArrowDownWideNarrow />\n                        <SelectValue placeholder={t(\"æœ€æ–°\", \"Latest\")} />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"DATE_CREATED\">\n                          {t(\"æœ€æ–°\", \"Latest\")}\n                        </SelectItem>\n                        <SelectItem value=\"LIKES_COUNT\">\n                          {t(\"æœ€ã‚‚äººæ°—\", \"Most Liked\")}\n                        </SelectItem>\n                        <SelectItem value=\"COMMENTS_COUNT\">\n                          {t(\"ã‚³ãƒ¡ãƒ³ãƒˆæ•°\", \"Most Comments\")}\n                        </SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  {/* time range */}\n                  <div className=\"flex flex-col space-y-2 md:flex-row md:items-center md:justify-between md:space-y-0\">\n                    <Select\n                      value={timeRange}\n                      onValueChange={(v) => {\n                        setTimeRange(v)\n                        syncParam(\"timeRange\", v === \"ALL\" ? null : v)\n                      }}\n                    >\n                      <SelectTrigger className=\"w-full text-xs md:w-auto md:min-w-[120px] md:text-sm\">\n                        <SelectValue placeholder={t(\"å…¨æœŸé–“\", \"All time\")} />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {[\"ALL\", \"TODAY\", \"YESTERDAY\", \"WEEK\"].map((v) => (\n                          <SelectItem key={v} value={v}>\n                            {t(\n                              v === \"TODAY\"\n                                ? \"æœ¬æ—¥\"\n                                : v === \"YESTERDAY\"\n                                  ? \"æ˜¨æ—¥\"\n                                  : v === \"WEEK\"\n                                    ? \"é€±é–“\"\n                                    : \"å…¨æœŸé–“\",\n                              v === \"ALL\"\n                                ? \"All time\"\n                                : v === \"TODAY\"\n                                  ? \"Today\"\n                                  : v === \"YESTERDAY\"\n                                    ? \"Yesterday\"\n                                    : \"Week\",\n                            )}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    {/* è¡¨ç¤ºæ–¹å¼åˆ‡ã‚Šæ›¿ãˆ - ã‚ˆã‚Šã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥ãªãƒ‡ã‚¶ã‚¤ãƒ³ */}\n                    <div className=\"flex space-x-2 md:space-x-4\">\n                      <div className=\"flex rounded-lg bg-muted p-1\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => {\n                            setInternalIsPagination(false)\n                            const p = new URLSearchParams(searchParams)\n                            p.set(\"isPagination\", \"false\")\n                            updateQueryParams(p)\n                          }}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            !internalIsPagination\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <List className=\"h-3 w-3\" />\n                          <span className=\"hidden sm:inline\">\n                            {t(\"ãƒ•ã‚£ãƒ¼ãƒ‰\", \"Feed\")}\n                          </span>\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => {\n                            setInternalIsPagination(true)\n                            const p = new URLSearchParams(searchParams)\n                            p.set(\"isPagination\", \"true\")\n                            updateQueryParams(p)\n                          }}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            internalIsPagination\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <Navigation className=\"h-3 w-3\" />\n                          <span className=\"hidden sm:inline\">\n                            {t(\"ãƒšãƒ¼ã‚¸\", \"Pages\")}\n                          </span>\n                        </Button>\n                      </div>\n                      <div className=\"flex rounded-lg bg-muted p-1\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => onChangeDialogMode(false)}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            !isDialogMode\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <ExternalLink className=\"h-4 w-4\" />\n                          <span>{t(\"ãƒªãƒ³ã‚¯é·ç§»\", \"Open page\")}</span>\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => onChangeDialogMode(true)}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            isDialogMode\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <PlaySquare className=\"h-4 w-4\" />\n                          <span>{t(\"ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\", \"Dialog\")}</span>\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <Suspense fallback={<AppLoadingPage />}>\n                {internalIsPagination ? (\n                  <HomePaginationSensitiveWorksSection\n                    page={newWorksPage}\n                    setPage={setNewWorksPage}\n                    workType={workType}\n                    isPromptPublic={isPromptPublic}\n                    sortType={sortType}\n                    timeRange={timeRange}\n                    isOneWorkPerUser={isOneWorkPerUser}\n                    onSelect={isDialogMode ? openWork : undefined}\n                    updateWorks={updateCurrentWorks}\n                  />\n                ) : (\n                  <HomeSensitiveWorksSection\n                    page={newWorksPage}\n                    setPage={setPageWithParam(setNewWorksPage, \"newPage\")}\n                    workType={workType}\n                    isPromptPublic={isPromptPublic}\n                    sortType={sortType}\n                    timeRange={timeRange}\n                    isPagination={false}\n                    onSelect={isDialogMode ? openWork : undefined}\n                    updateWorks={updateCurrentWorks}\n                  />\n                )}\n              </Suspense>\n            </>\n          )}\n\n          {workView === \"popular\" && (\n            <Suspense fallback={<AppLoadingPage />}>\n              <HomeSensitiveHotWorksSection\n                page={newWorksPage}\n                setPage={setPageWithParam(setNewWorksPage, \"newPage\")}\n                workType={workType}\n                isPromptPublic={isPromptPublic}\n                sortType={sortType}\n              />\n            </Suspense>\n          )}\n\n          {workView === \"new-user\" && (\n            <>\n              <div className=\"space-y-4\">\n                {/* çµã‚Šè¾¼ã¿ç”¨ã®ã‚»ãƒ¬ã‚¯ãƒˆç¾¤ - ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */}\n                <div className=\"space-y-3\">\n                  {/* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¡Œ1: ç¨®é¡ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã€ã‚½ãƒ¼ãƒˆ */}\n                  <div className=\"grid grid-cols-3 gap-2 md:flex md:space-x-4\">\n                    {/* type */}\n                    <Select\n                      value={workType ?? \"\"}\n                      onValueChange={(v) => {\n                        setWorkType(v === \"ALL\" ? null : (v as any))\n                        syncParam(\"workType\", v === \"ALL\" ? null : v)\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <SelectValue\n                          placeholder={\n                            workType\n                              ? toWorkTypeText({ type: workType, lang: locale })\n                              : t(\"ç¨®é¡\", \"Type\")\n                          }\n                        />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {[\"ALL\", \"WORK\", \"VIDEO\", \"NOVEL\", \"COLUMN\"].map(\n                          (v) => (\n                            <SelectItem key={v} value={v}>\n                              {t(\n                                v === \"WORK\"\n                                  ? \"ç”»åƒ\"\n                                  : v === \"VIDEO\"\n                                    ? \"å‹•ç”»\"\n                                    : v === \"NOVEL\"\n                                      ? \"å°èª¬\"\n                                      : v === \"COLUMN\"\n                                        ? \"ã‚³ãƒ©ãƒ \"\n                                        : \"ç¨®é¡\",\n                                v,\n                              )}\n                            </SelectItem>\n                          ),\n                        )}\n                      </SelectContent>\n                    </Select>\n\n                    {/* prompt */}\n                    <Select\n                      value={\n                        isPromptPublic === null\n                          ? \"ALL\"\n                          : isPromptPublic\n                            ? \"prompt\"\n                            : \"no-prompt\"\n                      }\n                      onValueChange={(v) => {\n                        setIsPromptPublic(v === \"ALL\" ? null : v === \"prompt\")\n                        syncParam(\n                          \"isPromptPublic\",\n                          v === \"ALL\"\n                            ? null\n                            : v === \"prompt\"\n                              ? \"true\"\n                              : \"false\",\n                        )\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <SelectValue\n                          placeholder={t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ‰ç„¡\", \"Prompt\")}\n                        />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"ALL\">\n                          {t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ‰ç„¡\", \"Prompt\")}\n                        </SelectItem>\n                        <SelectItem value=\"prompt\">\n                          {t(\"ã‚ã‚Š\", \"Yes\")}\n                        </SelectItem>\n                        <SelectItem value=\"no-prompt\">\n                          {t(\"ãªã—\", \"No\")}\n                        </SelectItem>\n                      </SelectContent>\n                    </Select>\n\n                    {/* sort */}\n                    <Select\n                      value={sortType ?? \"\"}\n                      onValueChange={(v) => {\n                        setSortType(v === \"ALL\" ? null : (v as any))\n                        syncParam(\"sortType\", v === \"ALL\" ? null : v)\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <ArrowDownWideNarrow />\n                        <SelectValue placeholder={t(\"æœ€æ–°\", \"Latest\")} />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"DATE_CREATED\">\n                          {t(\"æœ€æ–°\", \"Latest\")}\n                        </SelectItem>\n                        <SelectItem value=\"LIKES_COUNT\">\n                          {t(\"æœ€ã‚‚äººæ°—\", \"Most Liked\")}\n                        </SelectItem>\n                        <SelectItem value=\"COMMENTS_COUNT\">\n                          {t(\"ã‚³ãƒ¡ãƒ³ãƒˆæ•°\", \"Most Comments\")}\n                        </SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  {/* time range */}\n                  <div className=\"flex flex-col justify-end space-y-2 md:flex-row md:items-center md:space-y-0\">\n                    {/* è¡¨ç¤ºæ–¹å¼åˆ‡ã‚Šæ›¿ãˆ - ã‚ˆã‚Šã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥ãªãƒ‡ã‚¶ã‚¤ãƒ³ */}\n                    <div className=\"flex justify-end space-x-2 md:space-x-4\">\n                      <div className=\"flex justify-end rounded-lg bg-muted p-1\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => onChangeDialogMode(false)}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            !isDialogMode\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <ExternalLink className=\"h-4 w-4\" />\n                          <span>{t(\"ãƒªãƒ³ã‚¯é·ç§»\", \"Open page\")}</span>\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => onChangeDialogMode(true)}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            isDialogMode\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <PlaySquare className=\"h-4 w-4\" />\n                          <span>{t(\"ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\", \"Dialog\")}</span>\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <Suspense fallback={<AppLoadingPage />}>\n                <HomeNewUsersSensitiveWorkListSection\n                  workType={workType}\n                  isPromptPublic={isPromptPublic}\n                  sortType={sortType}\n                  isOneWorkPerUser={isOneWorkPerUser}\n                  onSelect={isDialogMode ? openWork : undefined}\n                  updateWorks={updateCurrentWorks}\n                />\n              </Suspense>\n            </>\n          )}\n        </TabsContent>\n\n        {/* ---------- FOLLOW USER ---------- */}\n        <TabsContent value=\"follow-user\" className=\"space-y-4\">\n          {/* Feed / Pages åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ */}\n          <div className=\"flex justify-end space-x-2 md:space-x-4\">\n            <div className=\"flex rounded-lg bg-muted p-1\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => {\n                  setInternalIsPagination(false)\n                  const p = new URLSearchParams(searchParams)\n                  p.set(\"isPagination\", \"false\")\n                  updateQueryParams(p)\n                }}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 text-xs ${\n                  !internalIsPagination\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                }`}\n              >\n                <List className=\"h-3 w-3\" />\n                <span className=\"hidden sm:inline\">\n                  {t(\"ãƒ•ã‚£ãƒ¼ãƒ‰\", \"Feed\")}\n                </span>\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => {\n                  setInternalIsPagination(true)\n                  const p = new URLSearchParams(searchParams)\n                  p.set(\"isPagination\", \"true\")\n                  updateQueryParams(p)\n                }}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 text-xs ${\n                  internalIsPagination\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                }`}\n              >\n                <Navigation className=\"h-3 w-3\" />\n                <span className=\"hidden sm:inline\">{t(\"ãƒšãƒ¼ã‚¸\", \"Pages\")}</span>\n              </Button>\n            </div>\n            <div className=\"flex rounded-lg bg-muted p-1\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => onChangeDialogMode(false)}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                  !isDialogMode\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                } `}\n              >\n                <ExternalLink className=\"h-4 w-4\" />\n                <span>{t(\"ãƒªãƒ³ã‚¯é·ç§»\", \"Open page\")}</span>\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => onChangeDialogMode(true)}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                  isDialogMode\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                } `}\n              >\n                <PlaySquare className=\"h-4 w-4\" />\n                <span>{t(\"ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\", \"Dialog\")}</span>\n              </Button>\n            </div>\n          </div>\n\n          {/* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */}\n          <Suspense fallback={<AppLoadingPage />}>\n            <FollowSensitiveUserFeedContents\n              page={followUserFeedPage}\n              setPage={setPageWithParam(\n                setFollowUserFeedPage,\n                \"followUserPage\",\n              )}\n              isPagination={internalIsPagination}\n              onPaginationModeChange={setInternalIsPagination}\n              onSelect={isDialogMode ? openWork : undefined}\n              updateWorks={updateCurrentWorks}\n            />\n          </Suspense>\n        </TabsContent>\n\n        {/* ---------- FOLLOW TAG ---------- */}\n        <TabsContent value=\"follow-tag\" className=\"space-y-4\">\n          {/* Feed / Pages åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ */}\n          <div className=\"flex justify-end space-x-2 md:space-x-4\">\n            <div className=\"flex rounded-lg bg-muted p-1\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => {\n                  setInternalIsPagination(false)\n                  const p = new URLSearchParams(searchParams)\n                  p.set(\"isPagination\", \"false\")\n                  updateQueryParams(p)\n                }}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 text-xs ${\n                  !internalIsPagination\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                }`}\n              >\n                <List className=\"h-3 w-3\" />\n                <span className=\"hidden sm:inline\">\n                  {t(\"ãƒ•ã‚£ãƒ¼ãƒ‰\", \"Feed\")}\n                </span>\n              </Button>\n\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => {\n                  setInternalIsPagination(true)\n                  const p = new URLSearchParams(searchParams)\n                  p.set(\"isPagination\", \"true\")\n                  updateQueryParams(p)\n                }}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 text-xs ${\n                  internalIsPagination\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                }`}\n              >\n                <Navigation className=\"h-3 w-3\" />\n                <span className=\"hidden sm:inline\">{t(\"ãƒšãƒ¼ã‚¸\", \"Pages\")}</span>\n              </Button>\n            </div>\n            <div className=\"flex rounded-lg bg-muted p-1\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => onChangeDialogMode(false)}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                  !isDialogMode\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                } `}\n              >\n                <ExternalLink className=\"h-4 w-4\" />\n                <span>{t(\"ãƒªãƒ³ã‚¯é·ç§»\", \"Open page\")}</span>\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => onChangeDialogMode(true)}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                  isDialogMode\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                } `}\n              >\n                <PlaySquare className=\"h-4 w-4\" />\n                <span>{t(\"ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\", \"Dialog\")}</span>\n              </Button>\n            </div>\n          </div>\n\n          <Suspense fallback={<AppLoadingPage />}>\n            <FollowSensitiveTagsFeedContents\n              page={followTagFeedPage}\n              setPage={setPageWithParam(setFollowTagFeedPage, \"followTagPage\")}\n              isPagination={internalIsPagination}\n              onSelect={isDialogMode ? openWork : undefined}\n              updateWorks={updateCurrentWorks}\n            />\n          </Suspense>\n        </TabsContent>\n      </Tabs>\n\n      {/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ä½œå“ãƒ€ã‚¤ã‚¢ãƒ­ã‚° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */}\n      {workDialog.isOpen && workDialog.workId && (\n        <WorkViewerDialog\n          works={displayedWorks}\n          startWorkId={workDialog.workId}\n          onClose={workDialog.closeDialog}\n          loadMore={!internalIsPagination ? loadMore : undefined}\n          hasNextPage={hasNextPage}\n          isLoadingMore={isLoadingMore}\n        />\n      )}\n    </>\n  )\n}\n\nconst query = graphql(\n  `query HomeQuery(\n    # $pastGenerationBefore: String!\n    $year: Int!\n    $month: Int!\n    $day: Int!\n    $awardYear: Int!\n    $awardMonth: Int!\n    $awardDay: Int!\n    $adWorksLimit: Int!\n    # $novelWorksLimit: Int!\n    # $novelWorksBefore: String!\n    # $columnWorksLimit: Int!\n    # $columnWorksBefore: String!\n    # $generationWorksLimit: Int!\n    $promotionWorksLimit: Int!\n    $awardWorksLimit: Int!\n    $categoryFirst: String!\n    $categorySecond: String!\n    $tagWorksLimit: Int!\n    $newUsersWorksLimit: Int!\n  ) {\n    adWorks: works(\n      offset: 0,\n      limit: $adWorksLimit,\n      where: {\n        isFeatured: true,\n        ratings: [R18],\n        isNowCreatedAt: true\n      }\n    ) {\n      ...HomeBannerWork\n    }\n    dailyTheme(year: $year, month: $month, day: $day) {\n      id\n      title\n    }\n    hotSensitiveTags {\n      ...HomeTagListItem\n    }\n    workAwards(\n      offset: 0\n      limit: $awardWorksLimit\n      where: {\n        year: $awardYear\n        month: $awardMonth\n        day: $awardDay\n        isSensitive: true\n      }\n    ) {\n      ...HomeWorkAward\n    }\n    recommendedTags: recommendedTags(\n      limit: 16\n      where: {\n        isSensitive: true,\n      }\n    ) {\n      ...HomeTag\n    }\n    firstTagWorks: works(\n      offset: 0,\n      limit: $tagWorksLimit,\n      where: {\n        ratings: [R18],\n        search: $categoryFirst\n        orderBy: LIKES_COUNT\n        isSensitive: true\n        isNowCreatedAt: true\n      }\n    ) {\n      ...HomeTagWork\n    }\n    secondTagWorks: works(\n      offset: 0,\n      limit: $tagWorksLimit,\n      where: {\n        ratings: [R18]\n        search: $categorySecond\n        orderBy: LIKES_COUNT\n        isSensitive: true\n        isNowCreatedAt: true\n      }\n    ) {\n      ...HomeTagWork\n    }\n    newUserWorks: newUserWorks(\n      offset: 0,\n      limit: $newUsersWorksLimit,\n      where: {\n        ratings: [R18, R18G],\n      }\n    ) {\n      ...HomeNewUsersWorks\n    }\n    newPostedUsers: newPostedUsers(\n      offset: 0,\n      limit: 8,\n      where: {\n        isSensitive: true,\n      }\n    ) {\n      ...HomeNewPostedUsers\n    }\n    newComments: newComments(\n      offset: 0,\n      limit: 8,\n      where: {\n        isSensitive: true,\n        isTextOnly: true,\n        ratings: [R18, R18G],\n      }\n    ) {\n      ...HomeNewComments\n    }\n    promotionWorks: works(\n      offset: 0,\n      limit: $promotionWorksLimit,\n      where: {\n        isRecommended: true\n        isNowCreatedAt: true\n        ratings: [R18]\n      }\n    ) {\n      ...HomePromotionWork\n    }\n    # novelWorks: works(\n    #   offset: 0,\n    #   limit: $novelWorksLimit,\n    #   where: {\n    #     ratings: [G, R15],\n    #     workType: NOVEL,\n    #     beforeCreatedAt: $novelWorksBefore\n    #   }\n    # ) {\n    #   ...HomeNovelPost\n    # }\n    # columnWorks: works(\n    #   offset: 0,\n    #   limit: $columnWorksLimit,\n    #   where: {\n    #     ratings: [G, R15],\n    #     workType: COLUMN,\n    #     beforeCreatedAt: $columnWorksBefore\n    #   }\n    # ) {\n    #   ...HomeColumnPost\n    # }\n  }`,\n  [\n    HomeBannerWorkFragment,\n    HomePromotionWorkFragment,\n    // HomeNovelPostFragment,\n    HomeTagListItemFragment,\n    // HomeGenerationWorkFragment,\n    HomeWorkAwardFragment,\n    // HomeColumnPostFragment,\n    HomeTagFragment,\n    HomeTagWorkFragment,\n    HomeNewUsersWorksFragment,\n    HomeNewPostedUsersFragment,\n    HomeNewCommentsFragment,\n  ],\n)\n\nconst viewerCurrentPassQuery = graphql(\n  `query ViewerCurrentPass {\n    viewer {\n      id\n      currentPass {\n        id\n        type\n      }\n    }\n  }`,\n)\n\nexport const SideMenuAdvertisementsFragment = graphql(\n  `fragment SideMenuAdvertisementsFields on CustomerAdvertisementNode @_unmask {\n      id\n      imageUrl\n      url\n      displayProbability\n      clickCount\n      impressionCount\n      isSensitive\n      createdAt\n      page\n      startAt\n      endAt\n      isActive\n  }`,\n)\n\nconst randomCustomerAdvertisementQuery = graphql(\n  `query RandomCustomerAdvertisement($where: RandomCustomerAdvertisementWhereInput!) {\n    randomCustomerAdvertisement(where: $where) {\n      ...SideMenuAdvertisementsFields\n    }\n  }`,\n  [SideMenuAdvertisementsFragment],\n)\n\nconst updateClickedCountCustomerAdvertisementMutation = graphql(\n  `mutation UpdateClickedCountCustomerAdvertisement($id: ID!) {\n    updateClickedCountCustomerAdvertisement(id: $id) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/suspicious/noExplicitAny","severity":"warning","description":"Unexpected any. Specify a different type.","message":[{"elements":[],"content":"Unexpected "},{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":". Specify a different type."}],"advices":{"advices":[{"log":["info",[{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":" disables many type checking rules. Its use should be avoided."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).r._index/route.tsx"},"span":[29723,29726],"sourceCode":"import { loaderClient } from \"~/lib/loader-client\"\nimport { HomeWorkAwardFragment } from \"~/routes/($lang)._main._index/components/home-award-work-section\"\nimport { HomeBannerWorkFragment } from \"~/routes/($lang)._main._index/components/home-banners\"\nimport { HomeTagListItemFragment } from \"~/routes/($lang)._main._index/components/home-tag-list\"\nimport { HomeTagFragment } from \"~/routes/($lang)._main._index/components/home-tags-section\"\nimport { HomePromotionWorkFragment } from \"~/routes/($lang)._main._index/components/home-works-users-recommended-section\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport {\n  Link,\n  useLoaderData,\n  useNavigate,\n  useSearchParams,\n} from \"@remix-run/react\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\nimport { config, META } from \"~/config\"\nimport { HomeTagWorkFragment } from \"~/routes/($lang)._main._index/components/home-works-tag-section\"\nimport { getJstDate } from \"~/utils/jst-date\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { HomeNewUsersWorksFragment } from \"~/routes/($lang)._main._index/components/home-new-users-works-section\"\nimport { HomeNewCommentsFragment } from \"~/routes/($lang)._main._index/components/home-new-comments\"\nimport { HomeNewPostedUsersFragment } from \"~/routes/($lang)._main._index/components/home-new-users-section\"\nimport {\n  ArrowDownWideNarrow,\n  ExternalLink,\n  List,\n  Navigation,\n  PlaySquare,\n} from \"lucide-react\"\nimport { useState, Suspense, useMemo, useEffect } from \"react\"\nimport { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { CrossPlatformTooltip } from \"~/components/cross-platform-tooltip\"\nimport { Button } from \"~/components/ui/button\"\nimport {\n  Select,\n  SelectTrigger,\n  SelectValue,\n  SelectContent,\n  SelectItem,\n} from \"~/components/ui/select\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { Tabs, TabsContent } from \"~/components/ui/tabs\"\nimport { useLocale } from \"~/hooks/use-locale\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { toWorkTypeText } from \"~/utils/work/to-work-type-text\"\nimport { HomeSensitiveHotWorksSection } from \"~/routes/($lang)._main._index/components/home-sensitive-hot-works-section\"\nimport { HomeSensitiveWorksSection } from \"~/routes/($lang)._main._index/components/home-sensitive-works-section\"\nimport { HomeSensitiveWorksTagSection } from \"~/routes/($lang)._main._index/components/home-sensitive-works-tag-section\"\nimport { HomeSensitiveNewUsersWorksSection } from \"~/routes/($lang)._main._index/components/home-sensitive-new-users-works-section\"\nimport { HomeSensitiveAwardWorkSection } from \"~/routes/($lang)._main._index/components/home-sensitive-award-work-section\"\nimport { HomeSensitiveTagsSection } from \"~/routes/($lang)._main._index/components/home-sensitive-tags-section\"\nimport { useQuery, useMutation } from \"@apollo/client/index\"\nimport { HomeAwardWorksSection } from \"~/routes/($lang)._main._index/components/home-award-works\"\nimport { HomeSensitiveTagList } from \"~/routes/($lang).r._index/components/home-sensitive-tag-list\"\nimport { HomeNewUsersSensitiveWorkListSection } from \"~/routes/($lang).r._index/components/home-new-user-sensitive-work-list-section\"\nimport { FollowSensitiveTagsFeedContents } from \"~/routes/($lang)._main._index/components/follow-sensitive-tags-feed-contents\"\nimport { FollowSensitiveUserFeedContents } from \"~/routes/($lang)._main._index/components/follow-sensitive-user-feed-contents\"\nimport { HomeSensitiveNewCommentsSection } from \"~/routes/($lang)._main._index/components/home-sensitive-new-comments\"\nimport { HomeNewSensitiveUsersSection } from \"~/routes/($lang)._main._index/components/home-new-sensitive-users-section\"\nimport { HomeSensitiveWorksUsersRecommendedSection } from \"~/routes/($lang)._main._index/components/home-sensitive-works-users-recommended-section\"\nimport { AppAnimatedTabs } from \"~/components/app/app-animated-tabs\"\nimport type { PhotoAlbumWorkFragment } from \"~/components/responsive-photo-works-album\"\nimport { WorkViewerDialog } from \"~/components/work/work-viewer-dialog\"\nimport { HomePaginationSensitiveWorksSection } from \"~/routes/($lang).r._index/components/home-pagination-sensitive-works-section\"\nimport { useWorkDialogUrl } from \"~/hooks/use-work-dialog-url\"\n\n// ---------- meta ----------\nexport const meta: MetaFunction = (props) =>\n  createMeta(META.HOME_SENSITIVE, undefined, props.params.lang)\n\n// ---------- utils ----------\nconst getUtcDateString = (d: Date) =>\n  `${d.getUTCFullYear()}/${`0${d.getUTCMonth() + 1}`.slice(-2)}/${`0${d.getUTCDate()}`.slice(-2)}`\n\n// ---------- loader ----------\nexport async function loader(_props: LoaderFunctionArgs) {\n  const categories = [\"ç¸„\", \"ä¸­ã ã—\"]\n  const pick2 = (arr: string[]) =>\n    arr.sort(() => Math.random() - 0.5).slice(0, 2)\n\n  const [firstTag, secondTag] = pick2(categories)\n  const now = getJstDate()\n  const yesterday = new Date(now.getTime() - 86_400_000)\n\n  const { data } = await loaderClient.query({\n    query,\n    variables: {\n      awardDay: yesterday.getDate(),\n      awardMonth: yesterday.getMonth() + 1,\n      awardYear: yesterday.getFullYear(),\n      day: now.getDate(),\n      month: now.getMonth() + 1,\n      year: now.getFullYear(),\n      adWorksLimit: config.query.homeWorkCount.ad,\n      promotionWorksLimit: config.query.homeWorkCount.promotion,\n      awardWorksLimit: config.query.homeWorkCount.award,\n      categoryFirst: firstTag,\n      categorySecond: secondTag,\n      tagWorksLimit: config.query.homeWorkCount.tag,\n      newUsersWorksLimit: config.query.homeWorkCount.newUser,\n    },\n  })\n\n  return {\n    ...data,\n    awardDateText: getUtcDateString(yesterday),\n    firstTag,\n    secondTag,\n  }\n}\n\n// ---------- headers ----------\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.home,\n})\n\n// ---------- helper ----------\nconst useUpdateQueryParams = () => (p: URLSearchParams) =>\n  window.history.replaceState(null, \"\", `${location.pathname}?${p}`)\n\n// ---------- component ----------\nexport default function Index () {\n  const data = useLoaderData<typeof loader>()\n  const t = useTranslation()\n  const locale = useLocale()\n  const navigate = useNavigate()\n  const [searchParams] = useSearchParams()\n  const updateQueryParams = useUpdateQueryParams()\n\n  // ------ local state ------\n  const [currentTab, setCurrentTab] = useState(\n    searchParams.get(\"tab\") ?? \"home\",\n  )\n  const [workView, setWorkView] = useState(searchParams.get(\"view\") ?? \"new\")\n  const [newWorksPage, setNewWorksPage] = useState(\n    Number(searchParams.get(\"newPage\") ?? 0),\n  )\n  const [followUserFeedPage, setFollowUserFeedPage] = useState(\n    Number(searchParams.get(\"followUserPage\") ?? 0),\n  )\n  const [followTagFeedPage, setFollowTagFeedPage] = useState(\n    Number(searchParams.get(\"followTagPage\") ?? 0),\n  )\n  const [workType, setWorkType] =\n    useState<IntrospectionEnum<\"WorkType\"> | null>(\n      (searchParams.get(\"workType\") as IntrospectionEnum<\"WorkType\">) ?? null,\n    )\n  const [isPromptPublic, setIsPromptPublic] = useState<boolean | null>(\n    searchParams.get(\"isPromptPublic\") === null\n      ? null\n      : searchParams.get(\"isPromptPublic\") === \"true\",\n  )\n  const [sortType, setSortType] =\n    useState<IntrospectionEnum<\"WorkOrderBy\"> | null>(\n      (searchParams.get(\"sortType\") as IntrospectionEnum<\"WorkOrderBy\">) ??\n        null,\n    )\n  const [timeRange, setTimeRange] = useState(\n    searchParams.get(\"timeRange\") ?? \"ALL\",\n  )\n  const [isOneWorkPerUser, _setIsOneWorkPerUser] = useState<boolean>(\n    searchParams.get(\"isOneWorkPerUser\") === \"true\",\n  )\n\n  const [internalIsPagination, setInternalIsPagination] = useState(true)\n\n  // ä½œå“é·ç§»ãƒ¢ãƒ¼ãƒ‰ï¼ˆãƒ€ã‚¤ã‚¢ãƒ­ã‚° / ç›´æ¥ãƒªãƒ³ã‚¯ï¼‰\n  const [isDialogMode, setIsDialogMode] = useState(false)\n\n  // Work dialog URL state management\n  const workDialog = useWorkDialogUrl()\n\n  // ä½œå“ãƒ‡ãƒ¼ã‚¿ã®ç®¡ç†ç”¨state\n  const [currentWorks, setCurrentWorks] = useState<\n    FragmentOf<typeof PhotoAlbumWorkFragment>[]\n  >([])\n\n  const [isLoadingMore, _setIsLoadingMore] = useState(false)\n\n  // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§è¡¨ç¤ºã™ã‚‹ä½œå“ãƒ‡ãƒ¼ã‚¿ã‚’æ±ºå®š\n  const displayedWorks = useMemo(() => {\n    switch (currentTab) {\n      case \"new\":\n      case \"follow-user\":\n      case \"follow-tag\":\n        return currentWorks\n      default:\n        return []\n    }\n  }, [currentTab, currentWorks])\n\n  const [hasNextPage, _setHasNextPage] = useState(true)\n\n  // ä½œå“ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†\n  const openWork = (idx: string) => {\n    // displayedWorksã®workã®idä¸€è‡´ã™ã‚‹ã‚‚ã®\n    const work = displayedWorks.find((w) => w.id === idx)\n    if (!work) {\n      console.error(\"Work not found for ID:\", idx)\n      return\n    }\n    if (isDialogMode) {\n      console.log(\"Opening dialog for work ID:\", idx)\n      workDialog.openDialog(idx)\n    } else {\n      console.log(\"Navigating to:\", `/posts/${work.id}`)\n      navigate(`/posts/${work.id}`)\n    }\n  }\n\n  // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãƒ¢ãƒ¼ãƒ‰å¤‰æ›´æ™‚ã®å‡¦ç†ï¼ˆlocalStorageã«ä¿å­˜ï¼‰\n  const onChangeDialogMode = (mode: boolean) => {\n    setIsDialogMode(mode)\n    if (typeof window !== \"undefined\") {\n      try {\n        localStorage.setItem(\"aipictors-dialog-mode\", JSON.stringify(mode))\n      } catch (error) {\n        console.error(\"Failed to save dialog mode to localStorage:\", error)\n      }\n    }\n    // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‰ã˜ã‚‹\n    if (!mode) {\n      workDialog.closeDialog()\n    }\n  }\n\n  // currentWorksã‚’æ›´æ–°ã™ã‚‹ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°\n  const updateCurrentWorks = (\n    works: FragmentOf<typeof PhotoAlbumWorkFragment>[],\n  ) => {\n    setCurrentWorks(works)\n  }\n\n  // ç„¡é™ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ç”¨ã®loadMoreé–¢æ•°\n  const loadMore = async () => {\n    if (isLoadingMore || !hasNextPage || internalIsPagination) return\n  }\n\n  // ------ URL sync helpers ------\n  const syncParam = (key: string, value: string | null) => {\n    const p = new URLSearchParams(searchParams)\n    value === null ? p.delete(key) : p.set(key, value)\n    updateQueryParams(p)\n  }\n\n  const handleTabChange = (tab: string) => {\n    setCurrentTab(tab)\n    syncParam(\"tab\", tab)\n  }\n  const handleWorkViewChange = (v: string) => {\n    setWorkView(v)\n    syncParam(\"view\", v)\n  }\n\n  const setPageWithParam =\n    (setter: (n: number) => void, paramKey: string) => (n: number) => {\n      setter(n)\n      syncParam(paramKey, String(n))\n    }\n\n  // ------ GraphQL for sideâ€menu ads ------\n  const { data: pass } = useQuery(viewerCurrentPassQuery)\n  const { data: advertisements } = useQuery(randomCustomerAdvertisementQuery, {\n    variables: { where: { isSensitive: true, page: \"work\" } },\n  })\n  const [updateClicked] = useMutation(\n    updateClickedCountCustomerAdvertisementMutation,\n  )\n  const isSubscriptionUser = [\"LITE\", \"STANDARD\", \"PREMIUM\"].includes(\n    pass?.viewer?.currentPass?.type ?? \"\",\n  )\n\n  // localStorageã‹ã‚‰ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’å¾©å…ƒ\n  useEffect(() => {\n    if (typeof window !== \"undefined\") {\n      try {\n        const savedMode = localStorage.getItem(\"aipictors-dialog-mode\")\n        if (savedMode !== null) {\n          const parsedMode = JSON.parse(savedMode)\n          setIsDialogMode(parsedMode)\n        }\n      } catch (error) {\n        console.error(\"Failed to restore dialog mode from localStorage:\", error)\n      }\n    }\n  }, [])\n\n  // ---------- render ----------\n  if (!data) return null\n\n  return (\n    <>\n      <Tabs\n        value={currentTab}\n        onValueChange={handleTabChange}\n        className=\"space-y-4\"\n      >\n        {/* ---------- TAB HEADER ---------- */}\n        <div className=\"flex items-center sm:gap-x-2 md:gap-x-4\">\n          <AppAnimatedTabs\n            tabs={[\n              { label: \"ãƒ›ãƒ¼ãƒ \", value: \"home\" },\n              { label: \"æ–°ç€ãƒ»äººæ°—\", value: \"new\" },\n              { label: \"ãƒ•ã‚©ãƒ­ãƒ¼æ–°ç€\", value: \"follow-user\" },\n              { label: \"ãŠæ°—ã«å…¥ã‚Šã‚¿ã‚°æ–°ç€\", value: \"follow-tag\" },\n            ]}\n            value={currentTab}\n            onChange={setCurrentTab}\n          />\n          <Button variant=\"secondary\" size=\"sm\" onClick={() => navigate(\"/\")}>\n            å…¨å¹´é½¢\n          </Button>\n        </div>\n\n        {/* ---------- HOME ---------- */}\n        <TabsContent value=\"home\" className=\"m-0 flex flex-col space-y-4\">\n          <HomeSensitiveTagList\n            themeTitle={data.dailyTheme?.title}\n            hotTags={data.hotSensitiveTags}\n          />\n          <div className=\"block space-y-4 md:flex md:space-x-4 md:space-y-0\">\n            {/* left */}\n            <div className=\"flex w-full flex-col space-y-4 \">\n              <HomeSensitiveWorksUsersRecommendedSection\n                works={data.promotionWorks}\n              />\n              <HomeSensitiveNewUsersWorksSection works={data.newUserWorks} />\n              <HomeSensitiveAwardWorkSection\n                awardDateText={data.awardDateText}\n                title={t(\"å‰æ—¥ãƒ©ãƒ³ã‚­ãƒ³ã‚°\", \"Previous Day Ranking\")}\n                awards={data.workAwards}\n              />\n              <HomeSensitiveWorksTagSection\n                tag={data.firstTag}\n                works={data.firstTagWorks}\n                secondTag={data.secondTag}\n                secondWorks={data.secondTagWorks}\n                isCropped\n              />\n              <HomeSensitiveTagsSection\n                title={t(\"äººæ°—ã‚¿ã‚°\", \"Popular Tags\")}\n                tags={data.recommendedTags}\n              />\n            </div>\n\n            {/* right */}\n            <Separator\n              orientation=\"vertical\"\n              className=\"hidden h-[100vh] w-[1px] md:block\"\n            />\n            <div className=\"flex w-full max-w-80 flex-col space-y-4\">\n              <Button\n                onClick={() => navigate(\"/\")}\n                variant=\"secondary\"\n                className=\"w-full\"\n              >\n                {t(\"å…¨å¹´é½¢\", \"All Ages\")}\n              </Button>\n\n              {!isSubscriptionUser &&\n                advertisements?.randomCustomerAdvertisement && (\n                  <div className=\"relative border\">\n                    <Link\n                      to={advertisements.randomCustomerAdvertisement.url}\n                      target=\"_blank\"\n                      onClick={() => {\n                        const id =\n                          advertisements.randomCustomerAdvertisement?.id\n                        if (!id) return\n                        updateClicked({\n                          variables: {\n                            id,\n                          },\n                        })\n                      }}\n                    >\n                      <img\n                        src={\n                          advertisements.randomCustomerAdvertisement.imageUrl\n                        }\n                        alt=\"Advertisement\"\n                      />\n                    </Link>\n                    <div className=\"absolute top-0 right-0\">\n                      <CrossPlatformTooltip\n                        text={t(\n                          \"ææºåºƒå‘Šã§ã™ã€åºƒå‘Šä¸»æ§˜ã‚’å‹Ÿé›†ä¸­ã§ã™ã€‚ãƒ¡ãƒ¼ãƒ«ã¾ãŸã¯DMã«ã¦ã”é€£çµ¡ãã ã•ã„ã€‚\",\n                          \"This is a partnered advertisement. We are accepting new advertisers. Please contact us via email or DM.\",\n                        )}\n                      />\n                    </div>\n                  </div>\n                )}\n\n              {data.newPostedUsers && (\n                <HomeNewSensitiveUsersSection users={data.newPostedUsers} />\n              )}\n              {data.newComments?.length > 0 && (\n                <HomeSensitiveNewCommentsSection comments={data.newComments} />\n              )}\n              {data.workAwards && (\n                <HomeAwardWorksSection works={data.workAwards} />\n              )}\n            </div>\n          </div>\n        </TabsContent>\n\n        {/* ---------- NEW / POPULAR / NEW-USER ---------- */}\n        <TabsContent value=\"new\" className=\"flex flex-col space-y-4\">\n          {/* toggle buttons */}\n          <div className=\"flex space-x-4\">\n            {[\n              { v: \"new\", label: t(\"æ–°ç€\", \"New\") },\n              // { v: \"popular\", label: t(\"äººæ°—\", \"Popular\") },\n              { v: \"new-user\", label: t(\"æ–°è¦ãƒ¦ãƒ¼ã‚¶\", \"New Users\") },\n            ].map(({ v, label }) => (\n              <Button\n                key={v}\n                variant={workView === v ? \"default\" : \"secondary\"}\n                onClick={() => handleWorkViewChange(v)}\n              >\n                {label}\n                {v === \"popular\" && (\n                  <CrossPlatformTooltip\n                    text={t(\n                      \"æœ€è¿‘æŠ•ç¨¿ã•ã‚ŒãŸäººæ°—ä½œå“ãŒè¡¨ç¤ºã•ã‚Œã¾ã™\",\n                      \"Recently popular works\",\n                    )}\n                  />\n                )}\n              </Button>\n            ))}\n          </div>\n\n          {/* filters (only on â€œnewâ€) */}\n          {workView === \"new\" && (\n            <>\n              <div className=\"space-y-4\">\n                {/* çµã‚Šè¾¼ã¿ç”¨ã®ã‚»ãƒ¬ã‚¯ãƒˆç¾¤ - ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */}\n                <div className=\"space-y-3\">\n                  {/* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¡Œ1: ç¨®é¡ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã€ã‚½ãƒ¼ãƒˆ */}\n                  <div className=\"grid grid-cols-3 gap-2 md:flex md:space-x-4\">\n                    {/* type */}\n                    <Select\n                      value={workType ?? \"\"}\n                      onValueChange={(v) => {\n                        setWorkType(v === \"ALL\" ? null : (v as any))\n                        syncParam(\"workType\", v === \"ALL\" ? null : v)\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <SelectValue\n                          placeholder={\n                            workType\n                              ? toWorkTypeText({ type: workType, lang: locale })\n                              : t(\"ç¨®é¡\", \"Type\")\n                          }\n                        />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {[\"ALL\", \"WORK\", \"VIDEO\", \"NOVEL\", \"COLUMN\"].map(\n                          (v) => (\n                            <SelectItem key={v} value={v}>\n                              {t(\n                                v === \"WORK\"\n                                  ? \"ç”»åƒ\"\n                                  : v === \"VIDEO\"\n                                    ? \"å‹•ç”»\"\n                                    : v === \"NOVEL\"\n                                      ? \"å°èª¬\"\n                                      : v === \"COLUMN\"\n                                        ? \"ã‚³ãƒ©ãƒ \"\n                                        : \"ç¨®é¡\",\n                                v,\n                              )}\n                            </SelectItem>\n                          ),\n                        )}\n                      </SelectContent>\n                    </Select>\n\n                    {/* prompt */}\n                    <Select\n                      value={\n                        isPromptPublic === null\n                          ? \"ALL\"\n                          : isPromptPublic\n                            ? \"prompt\"\n                            : \"no-prompt\"\n                      }\n                      onValueChange={(v) => {\n                        setIsPromptPublic(v === \"ALL\" ? null : v === \"prompt\")\n                        syncParam(\n                          \"isPromptPublic\",\n                          v === \"ALL\"\n                            ? null\n                            : v === \"prompt\"\n                              ? \"true\"\n                              : \"false\",\n                        )\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <SelectValue\n                          placeholder={t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ‰ç„¡\", \"Prompt\")}\n                        />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"ALL\">\n                          {t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ‰ç„¡\", \"Prompt\")}\n                        </SelectItem>\n                        <SelectItem value=\"prompt\">\n                          {t(\"ã‚ã‚Š\", \"Yes\")}\n                        </SelectItem>\n                        <SelectItem value=\"no-prompt\">\n                          {t(\"ãªã—\", \"No\")}\n                        </SelectItem>\n                      </SelectContent>\n                    </Select>\n\n                    {/* sort */}\n                    <Select\n                      value={sortType ?? \"\"}\n                      onValueChange={(v) => {\n                        setSortType(v === \"ALL\" ? null : (v as any))\n                        syncParam(\"sortType\", v === \"ALL\" ? null : v)\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <ArrowDownWideNarrow />\n                        <SelectValue placeholder={t(\"æœ€æ–°\", \"Latest\")} />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"DATE_CREATED\">\n                          {t(\"æœ€æ–°\", \"Latest\")}\n                        </SelectItem>\n                        <SelectItem value=\"LIKES_COUNT\">\n                          {t(\"æœ€ã‚‚äººæ°—\", \"Most Liked\")}\n                        </SelectItem>\n                        <SelectItem value=\"COMMENTS_COUNT\">\n                          {t(\"ã‚³ãƒ¡ãƒ³ãƒˆæ•°\", \"Most Comments\")}\n                        </SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  {/* time range */}\n                  <div className=\"flex flex-col space-y-2 md:flex-row md:items-center md:justify-between md:space-y-0\">\n                    <Select\n                      value={timeRange}\n                      onValueChange={(v) => {\n                        setTimeRange(v)\n                        syncParam(\"timeRange\", v === \"ALL\" ? null : v)\n                      }}\n                    >\n                      <SelectTrigger className=\"w-full text-xs md:w-auto md:min-w-[120px] md:text-sm\">\n                        <SelectValue placeholder={t(\"å…¨æœŸé–“\", \"All time\")} />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {[\"ALL\", \"TODAY\", \"YESTERDAY\", \"WEEK\"].map((v) => (\n                          <SelectItem key={v} value={v}>\n                            {t(\n                              v === \"TODAY\"\n                                ? \"æœ¬æ—¥\"\n                                : v === \"YESTERDAY\"\n                                  ? \"æ˜¨æ—¥\"\n                                  : v === \"WEEK\"\n                                    ? \"é€±é–“\"\n                                    : \"å…¨æœŸé–“\",\n                              v === \"ALL\"\n                                ? \"All time\"\n                                : v === \"TODAY\"\n                                  ? \"Today\"\n                                  : v === \"YESTERDAY\"\n                                    ? \"Yesterday\"\n                                    : \"Week\",\n                            )}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    {/* è¡¨ç¤ºæ–¹å¼åˆ‡ã‚Šæ›¿ãˆ - ã‚ˆã‚Šã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥ãªãƒ‡ã‚¶ã‚¤ãƒ³ */}\n                    <div className=\"flex space-x-2 md:space-x-4\">\n                      <div className=\"flex rounded-lg bg-muted p-1\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => {\n                            setInternalIsPagination(false)\n                            const p = new URLSearchParams(searchParams)\n                            p.set(\"isPagination\", \"false\")\n                            updateQueryParams(p)\n                          }}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            !internalIsPagination\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <List className=\"h-3 w-3\" />\n                          <span className=\"hidden sm:inline\">\n                            {t(\"ãƒ•ã‚£ãƒ¼ãƒ‰\", \"Feed\")}\n                          </span>\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => {\n                            setInternalIsPagination(true)\n                            const p = new URLSearchParams(searchParams)\n                            p.set(\"isPagination\", \"true\")\n                            updateQueryParams(p)\n                          }}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            internalIsPagination\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <Navigation className=\"h-3 w-3\" />\n                          <span className=\"hidden sm:inline\">\n                            {t(\"ãƒšãƒ¼ã‚¸\", \"Pages\")}\n                          </span>\n                        </Button>\n                      </div>\n                      <div className=\"flex rounded-lg bg-muted p-1\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => onChangeDialogMode(false)}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            !isDialogMode\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <ExternalLink className=\"h-4 w-4\" />\n                          <span>{t(\"ãƒªãƒ³ã‚¯é·ç§»\", \"Open page\")}</span>\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => onChangeDialogMode(true)}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            isDialogMode\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <PlaySquare className=\"h-4 w-4\" />\n                          <span>{t(\"ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\", \"Dialog\")}</span>\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <Suspense fallback={<AppLoadingPage />}>\n                {internalIsPagination ? (\n                  <HomePaginationSensitiveWorksSection\n                    page={newWorksPage}\n                    setPage={setNewWorksPage}\n                    workType={workType}\n                    isPromptPublic={isPromptPublic}\n                    sortType={sortType}\n                    timeRange={timeRange}\n                    isOneWorkPerUser={isOneWorkPerUser}\n                    onSelect={isDialogMode ? openWork : undefined}\n                    updateWorks={updateCurrentWorks}\n                  />\n                ) : (\n                  <HomeSensitiveWorksSection\n                    page={newWorksPage}\n                    setPage={setPageWithParam(setNewWorksPage, \"newPage\")}\n                    workType={workType}\n                    isPromptPublic={isPromptPublic}\n                    sortType={sortType}\n                    timeRange={timeRange}\n                    isPagination={false}\n                    onSelect={isDialogMode ? openWork : undefined}\n                    updateWorks={updateCurrentWorks}\n                  />\n                )}\n              </Suspense>\n            </>\n          )}\n\n          {workView === \"popular\" && (\n            <Suspense fallback={<AppLoadingPage />}>\n              <HomeSensitiveHotWorksSection\n                page={newWorksPage}\n                setPage={setPageWithParam(setNewWorksPage, \"newPage\")}\n                workType={workType}\n                isPromptPublic={isPromptPublic}\n                sortType={sortType}\n              />\n            </Suspense>\n          )}\n\n          {workView === \"new-user\" && (\n            <>\n              <div className=\"space-y-4\">\n                {/* çµã‚Šè¾¼ã¿ç”¨ã®ã‚»ãƒ¬ã‚¯ãƒˆç¾¤ - ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */}\n                <div className=\"space-y-3\">\n                  {/* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¡Œ1: ç¨®é¡ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã€ã‚½ãƒ¼ãƒˆ */}\n                  <div className=\"grid grid-cols-3 gap-2 md:flex md:space-x-4\">\n                    {/* type */}\n                    <Select\n                      value={workType ?? \"\"}\n                      onValueChange={(v) => {\n                        setWorkType(v === \"ALL\" ? null : (v as any))\n                        syncParam(\"workType\", v === \"ALL\" ? null : v)\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <SelectValue\n                          placeholder={\n                            workType\n                              ? toWorkTypeText({ type: workType, lang: locale })\n                              : t(\"ç¨®é¡\", \"Type\")\n                          }\n                        />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {[\"ALL\", \"WORK\", \"VIDEO\", \"NOVEL\", \"COLUMN\"].map(\n                          (v) => (\n                            <SelectItem key={v} value={v}>\n                              {t(\n                                v === \"WORK\"\n                                  ? \"ç”»åƒ\"\n                                  : v === \"VIDEO\"\n                                    ? \"å‹•ç”»\"\n                                    : v === \"NOVEL\"\n                                      ? \"å°èª¬\"\n                                      : v === \"COLUMN\"\n                                        ? \"ã‚³ãƒ©ãƒ \"\n                                        : \"ç¨®é¡\",\n                                v,\n                              )}\n                            </SelectItem>\n                          ),\n                        )}\n                      </SelectContent>\n                    </Select>\n\n                    {/* prompt */}\n                    <Select\n                      value={\n                        isPromptPublic === null\n                          ? \"ALL\"\n                          : isPromptPublic\n                            ? \"prompt\"\n                            : \"no-prompt\"\n                      }\n                      onValueChange={(v) => {\n                        setIsPromptPublic(v === \"ALL\" ? null : v === \"prompt\")\n                        syncParam(\n                          \"isPromptPublic\",\n                          v === \"ALL\"\n                            ? null\n                            : v === \"prompt\"\n                              ? \"true\"\n                              : \"false\",\n                        )\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <SelectValue\n                          placeholder={t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ‰ç„¡\", \"Prompt\")}\n                        />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"ALL\">\n                          {t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ‰ç„¡\", \"Prompt\")}\n                        </SelectItem>\n                        <SelectItem value=\"prompt\">\n                          {t(\"ã‚ã‚Š\", \"Yes\")}\n                        </SelectItem>\n                        <SelectItem value=\"no-prompt\">\n                          {t(\"ãªã—\", \"No\")}\n                        </SelectItem>\n                      </SelectContent>\n                    </Select>\n\n                    {/* sort */}\n                    <Select\n                      value={sortType ?? \"\"}\n                      onValueChange={(v) => {\n                        setSortType(v === \"ALL\" ? null : (v as any))\n                        syncParam(\"sortType\", v === \"ALL\" ? null : v)\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <ArrowDownWideNarrow />\n                        <SelectValue placeholder={t(\"æœ€æ–°\", \"Latest\")} />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"DATE_CREATED\">\n                          {t(\"æœ€æ–°\", \"Latest\")}\n                        </SelectItem>\n                        <SelectItem value=\"LIKES_COUNT\">\n                          {t(\"æœ€ã‚‚äººæ°—\", \"Most Liked\")}\n                        </SelectItem>\n                        <SelectItem value=\"COMMENTS_COUNT\">\n                          {t(\"ã‚³ãƒ¡ãƒ³ãƒˆæ•°\", \"Most Comments\")}\n                        </SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  {/* time range */}\n                  <div className=\"flex flex-col justify-end space-y-2 md:flex-row md:items-center md:space-y-0\">\n                    {/* è¡¨ç¤ºæ–¹å¼åˆ‡ã‚Šæ›¿ãˆ - ã‚ˆã‚Šã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥ãªãƒ‡ã‚¶ã‚¤ãƒ³ */}\n                    <div className=\"flex justify-end space-x-2 md:space-x-4\">\n                      <div className=\"flex justify-end rounded-lg bg-muted p-1\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => onChangeDialogMode(false)}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            !isDialogMode\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <ExternalLink className=\"h-4 w-4\" />\n                          <span>{t(\"ãƒªãƒ³ã‚¯é·ç§»\", \"Open page\")}</span>\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => onChangeDialogMode(true)}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            isDialogMode\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <PlaySquare className=\"h-4 w-4\" />\n                          <span>{t(\"ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\", \"Dialog\")}</span>\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <Suspense fallback={<AppLoadingPage />}>\n                <HomeNewUsersSensitiveWorkListSection\n                  workType={workType}\n                  isPromptPublic={isPromptPublic}\n                  sortType={sortType}\n                  isOneWorkPerUser={isOneWorkPerUser}\n                  onSelect={isDialogMode ? openWork : undefined}\n                  updateWorks={updateCurrentWorks}\n                />\n              </Suspense>\n            </>\n          )}\n        </TabsContent>\n\n        {/* ---------- FOLLOW USER ---------- */}\n        <TabsContent value=\"follow-user\" className=\"space-y-4\">\n          {/* Feed / Pages åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ */}\n          <div className=\"flex justify-end space-x-2 md:space-x-4\">\n            <div className=\"flex rounded-lg bg-muted p-1\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => {\n                  setInternalIsPagination(false)\n                  const p = new URLSearchParams(searchParams)\n                  p.set(\"isPagination\", \"false\")\n                  updateQueryParams(p)\n                }}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 text-xs ${\n                  !internalIsPagination\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                }`}\n              >\n                <List className=\"h-3 w-3\" />\n                <span className=\"hidden sm:inline\">\n                  {t(\"ãƒ•ã‚£ãƒ¼ãƒ‰\", \"Feed\")}\n                </span>\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => {\n                  setInternalIsPagination(true)\n                  const p = new URLSearchParams(searchParams)\n                  p.set(\"isPagination\", \"true\")\n                  updateQueryParams(p)\n                }}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 text-xs ${\n                  internalIsPagination\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                }`}\n              >\n                <Navigation className=\"h-3 w-3\" />\n                <span className=\"hidden sm:inline\">{t(\"ãƒšãƒ¼ã‚¸\", \"Pages\")}</span>\n              </Button>\n            </div>\n            <div className=\"flex rounded-lg bg-muted p-1\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => onChangeDialogMode(false)}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                  !isDialogMode\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                } `}\n              >\n                <ExternalLink className=\"h-4 w-4\" />\n                <span>{t(\"ãƒªãƒ³ã‚¯é·ç§»\", \"Open page\")}</span>\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => onChangeDialogMode(true)}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                  isDialogMode\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                } `}\n              >\n                <PlaySquare className=\"h-4 w-4\" />\n                <span>{t(\"ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\", \"Dialog\")}</span>\n              </Button>\n            </div>\n          </div>\n\n          {/* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */}\n          <Suspense fallback={<AppLoadingPage />}>\n            <FollowSensitiveUserFeedContents\n              page={followUserFeedPage}\n              setPage={setPageWithParam(\n                setFollowUserFeedPage,\n                \"followUserPage\",\n              )}\n              isPagination={internalIsPagination}\n              onPaginationModeChange={setInternalIsPagination}\n              onSelect={isDialogMode ? openWork : undefined}\n              updateWorks={updateCurrentWorks}\n            />\n          </Suspense>\n        </TabsContent>\n\n        {/* ---------- FOLLOW TAG ---------- */}\n        <TabsContent value=\"follow-tag\" className=\"space-y-4\">\n          {/* Feed / Pages åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ */}\n          <div className=\"flex justify-end space-x-2 md:space-x-4\">\n            <div className=\"flex rounded-lg bg-muted p-1\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => {\n                  setInternalIsPagination(false)\n                  const p = new URLSearchParams(searchParams)\n                  p.set(\"isPagination\", \"false\")\n                  updateQueryParams(p)\n                }}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 text-xs ${\n                  !internalIsPagination\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                }`}\n              >\n                <List className=\"h-3 w-3\" />\n                <span className=\"hidden sm:inline\">\n                  {t(\"ãƒ•ã‚£ãƒ¼ãƒ‰\", \"Feed\")}\n                </span>\n              </Button>\n\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => {\n                  setInternalIsPagination(true)\n                  const p = new URLSearchParams(searchParams)\n                  p.set(\"isPagination\", \"true\")\n                  updateQueryParams(p)\n                }}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 text-xs ${\n                  internalIsPagination\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                }`}\n              >\n                <Navigation className=\"h-3 w-3\" />\n                <span className=\"hidden sm:inline\">{t(\"ãƒšãƒ¼ã‚¸\", \"Pages\")}</span>\n              </Button>\n            </div>\n            <div className=\"flex rounded-lg bg-muted p-1\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => onChangeDialogMode(false)}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                  !isDialogMode\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                } `}\n              >\n                <ExternalLink className=\"h-4 w-4\" />\n                <span>{t(\"ãƒªãƒ³ã‚¯é·ç§»\", \"Open page\")}</span>\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => onChangeDialogMode(true)}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                  isDialogMode\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                } `}\n              >\n                <PlaySquare className=\"h-4 w-4\" />\n                <span>{t(\"ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\", \"Dialog\")}</span>\n              </Button>\n            </div>\n          </div>\n\n          <Suspense fallback={<AppLoadingPage />}>\n            <FollowSensitiveTagsFeedContents\n              page={followTagFeedPage}\n              setPage={setPageWithParam(setFollowTagFeedPage, \"followTagPage\")}\n              isPagination={internalIsPagination}\n              onSelect={isDialogMode ? openWork : undefined}\n              updateWorks={updateCurrentWorks}\n            />\n          </Suspense>\n        </TabsContent>\n      </Tabs>\n\n      {/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ä½œå“ãƒ€ã‚¤ã‚¢ãƒ­ã‚° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */}\n      {workDialog.isOpen && workDialog.workId && (\n        <WorkViewerDialog\n          works={displayedWorks}\n          startWorkId={workDialog.workId}\n          onClose={workDialog.closeDialog}\n          loadMore={!internalIsPagination ? loadMore : undefined}\n          hasNextPage={hasNextPage}\n          isLoadingMore={isLoadingMore}\n        />\n      )}\n    </>\n  )\n}\n\nconst query = graphql(\n  `query HomeQuery(\n    # $pastGenerationBefore: String!\n    $year: Int!\n    $month: Int!\n    $day: Int!\n    $awardYear: Int!\n    $awardMonth: Int!\n    $awardDay: Int!\n    $adWorksLimit: Int!\n    # $novelWorksLimit: Int!\n    # $novelWorksBefore: String!\n    # $columnWorksLimit: Int!\n    # $columnWorksBefore: String!\n    # $generationWorksLimit: Int!\n    $promotionWorksLimit: Int!\n    $awardWorksLimit: Int!\n    $categoryFirst: String!\n    $categorySecond: String!\n    $tagWorksLimit: Int!\n    $newUsersWorksLimit: Int!\n  ) {\n    adWorks: works(\n      offset: 0,\n      limit: $adWorksLimit,\n      where: {\n        isFeatured: true,\n        ratings: [R18],\n        isNowCreatedAt: true\n      }\n    ) {\n      ...HomeBannerWork\n    }\n    dailyTheme(year: $year, month: $month, day: $day) {\n      id\n      title\n    }\n    hotSensitiveTags {\n      ...HomeTagListItem\n    }\n    workAwards(\n      offset: 0\n      limit: $awardWorksLimit\n      where: {\n        year: $awardYear\n        month: $awardMonth\n        day: $awardDay\n        isSensitive: true\n      }\n    ) {\n      ...HomeWorkAward\n    }\n    recommendedTags: recommendedTags(\n      limit: 16\n      where: {\n        isSensitive: true,\n      }\n    ) {\n      ...HomeTag\n    }\n    firstTagWorks: works(\n      offset: 0,\n      limit: $tagWorksLimit,\n      where: {\n        ratings: [R18],\n        search: $categoryFirst\n        orderBy: LIKES_COUNT\n        isSensitive: true\n        isNowCreatedAt: true\n      }\n    ) {\n      ...HomeTagWork\n    }\n    secondTagWorks: works(\n      offset: 0,\n      limit: $tagWorksLimit,\n      where: {\n        ratings: [R18]\n        search: $categorySecond\n        orderBy: LIKES_COUNT\n        isSensitive: true\n        isNowCreatedAt: true\n      }\n    ) {\n      ...HomeTagWork\n    }\n    newUserWorks: newUserWorks(\n      offset: 0,\n      limit: $newUsersWorksLimit,\n      where: {\n        ratings: [R18, R18G],\n      }\n    ) {\n      ...HomeNewUsersWorks\n    }\n    newPostedUsers: newPostedUsers(\n      offset: 0,\n      limit: 8,\n      where: {\n        isSensitive: true,\n      }\n    ) {\n      ...HomeNewPostedUsers\n    }\n    newComments: newComments(\n      offset: 0,\n      limit: 8,\n      where: {\n        isSensitive: true,\n        isTextOnly: true,\n        ratings: [R18, R18G],\n      }\n    ) {\n      ...HomeNewComments\n    }\n    promotionWorks: works(\n      offset: 0,\n      limit: $promotionWorksLimit,\n      where: {\n        isRecommended: true\n        isNowCreatedAt: true\n        ratings: [R18]\n      }\n    ) {\n      ...HomePromotionWork\n    }\n    # novelWorks: works(\n    #   offset: 0,\n    #   limit: $novelWorksLimit,\n    #   where: {\n    #     ratings: [G, R15],\n    #     workType: NOVEL,\n    #     beforeCreatedAt: $novelWorksBefore\n    #   }\n    # ) {\n    #   ...HomeNovelPost\n    # }\n    # columnWorks: works(\n    #   offset: 0,\n    #   limit: $columnWorksLimit,\n    #   where: {\n    #     ratings: [G, R15],\n    #     workType: COLUMN,\n    #     beforeCreatedAt: $columnWorksBefore\n    #   }\n    # ) {\n    #   ...HomeColumnPost\n    # }\n  }`,\n  [\n    HomeBannerWorkFragment,\n    HomePromotionWorkFragment,\n    // HomeNovelPostFragment,\n    HomeTagListItemFragment,\n    // HomeGenerationWorkFragment,\n    HomeWorkAwardFragment,\n    // HomeColumnPostFragment,\n    HomeTagFragment,\n    HomeTagWorkFragment,\n    HomeNewUsersWorksFragment,\n    HomeNewPostedUsersFragment,\n    HomeNewCommentsFragment,\n  ],\n)\n\nconst viewerCurrentPassQuery = graphql(\n  `query ViewerCurrentPass {\n    viewer {\n      id\n      currentPass {\n        id\n        type\n      }\n    }\n  }`,\n)\n\nexport const SideMenuAdvertisementsFragment = graphql(\n  `fragment SideMenuAdvertisementsFields on CustomerAdvertisementNode @_unmask {\n      id\n      imageUrl\n      url\n      displayProbability\n      clickCount\n      impressionCount\n      isSensitive\n      createdAt\n      page\n      startAt\n      endAt\n      isActive\n  }`,\n)\n\nconst randomCustomerAdvertisementQuery = graphql(\n  `query RandomCustomerAdvertisement($where: RandomCustomerAdvertisementWhereInput!) {\n    randomCustomerAdvertisement(where: $where) {\n      ...SideMenuAdvertisementsFields\n    }\n  }`,\n  [SideMenuAdvertisementsFragment],\n)\n\nconst updateClickedCountCustomerAdvertisementMutation = graphql(\n  `mutation UpdateClickedCountCustomerAdvertisement($id: ID!) {\n    updateClickedCountCustomerAdvertisement(id: $id) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/suspicious/noExplicitAny","severity":"warning","description":"Unexpected any. Specify a different type.","message":[{"elements":[],"content":"Unexpected "},{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":". Specify a different type."}],"advices":{"advices":[{"log":["info",[{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":" disables many type checking rules. Its use should be avoided."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).r._index/route.tsx"},"span":[32969,32972],"sourceCode":"import { loaderClient } from \"~/lib/loader-client\"\nimport { HomeWorkAwardFragment } from \"~/routes/($lang)._main._index/components/home-award-work-section\"\nimport { HomeBannerWorkFragment } from \"~/routes/($lang)._main._index/components/home-banners\"\nimport { HomeTagListItemFragment } from \"~/routes/($lang)._main._index/components/home-tag-list\"\nimport { HomeTagFragment } from \"~/routes/($lang)._main._index/components/home-tags-section\"\nimport { HomePromotionWorkFragment } from \"~/routes/($lang)._main._index/components/home-works-users-recommended-section\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport {\n  Link,\n  useLoaderData,\n  useNavigate,\n  useSearchParams,\n} from \"@remix-run/react\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\nimport { config, META } from \"~/config\"\nimport { HomeTagWorkFragment } from \"~/routes/($lang)._main._index/components/home-works-tag-section\"\nimport { getJstDate } from \"~/utils/jst-date\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { HomeNewUsersWorksFragment } from \"~/routes/($lang)._main._index/components/home-new-users-works-section\"\nimport { HomeNewCommentsFragment } from \"~/routes/($lang)._main._index/components/home-new-comments\"\nimport { HomeNewPostedUsersFragment } from \"~/routes/($lang)._main._index/components/home-new-users-section\"\nimport {\n  ArrowDownWideNarrow,\n  ExternalLink,\n  List,\n  Navigation,\n  PlaySquare,\n} from \"lucide-react\"\nimport { useState, Suspense, useMemo, useEffect } from \"react\"\nimport { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { CrossPlatformTooltip } from \"~/components/cross-platform-tooltip\"\nimport { Button } from \"~/components/ui/button\"\nimport {\n  Select,\n  SelectTrigger,\n  SelectValue,\n  SelectContent,\n  SelectItem,\n} from \"~/components/ui/select\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { Tabs, TabsContent } from \"~/components/ui/tabs\"\nimport { useLocale } from \"~/hooks/use-locale\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { toWorkTypeText } from \"~/utils/work/to-work-type-text\"\nimport { HomeSensitiveHotWorksSection } from \"~/routes/($lang)._main._index/components/home-sensitive-hot-works-section\"\nimport { HomeSensitiveWorksSection } from \"~/routes/($lang)._main._index/components/home-sensitive-works-section\"\nimport { HomeSensitiveWorksTagSection } from \"~/routes/($lang)._main._index/components/home-sensitive-works-tag-section\"\nimport { HomeSensitiveNewUsersWorksSection } from \"~/routes/($lang)._main._index/components/home-sensitive-new-users-works-section\"\nimport { HomeSensitiveAwardWorkSection } from \"~/routes/($lang)._main._index/components/home-sensitive-award-work-section\"\nimport { HomeSensitiveTagsSection } from \"~/routes/($lang)._main._index/components/home-sensitive-tags-section\"\nimport { useQuery, useMutation } from \"@apollo/client/index\"\nimport { HomeAwardWorksSection } from \"~/routes/($lang)._main._index/components/home-award-works\"\nimport { HomeSensitiveTagList } from \"~/routes/($lang).r._index/components/home-sensitive-tag-list\"\nimport { HomeNewUsersSensitiveWorkListSection } from \"~/routes/($lang).r._index/components/home-new-user-sensitive-work-list-section\"\nimport { FollowSensitiveTagsFeedContents } from \"~/routes/($lang)._main._index/components/follow-sensitive-tags-feed-contents\"\nimport { FollowSensitiveUserFeedContents } from \"~/routes/($lang)._main._index/components/follow-sensitive-user-feed-contents\"\nimport { HomeSensitiveNewCommentsSection } from \"~/routes/($lang)._main._index/components/home-sensitive-new-comments\"\nimport { HomeNewSensitiveUsersSection } from \"~/routes/($lang)._main._index/components/home-new-sensitive-users-section\"\nimport { HomeSensitiveWorksUsersRecommendedSection } from \"~/routes/($lang)._main._index/components/home-sensitive-works-users-recommended-section\"\nimport { AppAnimatedTabs } from \"~/components/app/app-animated-tabs\"\nimport type { PhotoAlbumWorkFragment } from \"~/components/responsive-photo-works-album\"\nimport { WorkViewerDialog } from \"~/components/work/work-viewer-dialog\"\nimport { HomePaginationSensitiveWorksSection } from \"~/routes/($lang).r._index/components/home-pagination-sensitive-works-section\"\nimport { useWorkDialogUrl } from \"~/hooks/use-work-dialog-url\"\n\n// ---------- meta ----------\nexport const meta: MetaFunction = (props) =>\n  createMeta(META.HOME_SENSITIVE, undefined, props.params.lang)\n\n// ---------- utils ----------\nconst getUtcDateString = (d: Date) =>\n  `${d.getUTCFullYear()}/${`0${d.getUTCMonth() + 1}`.slice(-2)}/${`0${d.getUTCDate()}`.slice(-2)}`\n\n// ---------- loader ----------\nexport async function loader(_props: LoaderFunctionArgs) {\n  const categories = [\"ç¸„\", \"ä¸­ã ã—\"]\n  const pick2 = (arr: string[]) =>\n    arr.sort(() => Math.random() - 0.5).slice(0, 2)\n\n  const [firstTag, secondTag] = pick2(categories)\n  const now = getJstDate()\n  const yesterday = new Date(now.getTime() - 86_400_000)\n\n  const { data } = await loaderClient.query({\n    query,\n    variables: {\n      awardDay: yesterday.getDate(),\n      awardMonth: yesterday.getMonth() + 1,\n      awardYear: yesterday.getFullYear(),\n      day: now.getDate(),\n      month: now.getMonth() + 1,\n      year: now.getFullYear(),\n      adWorksLimit: config.query.homeWorkCount.ad,\n      promotionWorksLimit: config.query.homeWorkCount.promotion,\n      awardWorksLimit: config.query.homeWorkCount.award,\n      categoryFirst: firstTag,\n      categorySecond: secondTag,\n      tagWorksLimit: config.query.homeWorkCount.tag,\n      newUsersWorksLimit: config.query.homeWorkCount.newUser,\n    },\n  })\n\n  return {\n    ...data,\n    awardDateText: getUtcDateString(yesterday),\n    firstTag,\n    secondTag,\n  }\n}\n\n// ---------- headers ----------\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.home,\n})\n\n// ---------- helper ----------\nconst useUpdateQueryParams = () => (p: URLSearchParams) =>\n  window.history.replaceState(null, \"\", `${location.pathname}?${p}`)\n\n// ---------- component ----------\nexport default function Index () {\n  const data = useLoaderData<typeof loader>()\n  const t = useTranslation()\n  const locale = useLocale()\n  const navigate = useNavigate()\n  const [searchParams] = useSearchParams()\n  const updateQueryParams = useUpdateQueryParams()\n\n  // ------ local state ------\n  const [currentTab, setCurrentTab] = useState(\n    searchParams.get(\"tab\") ?? \"home\",\n  )\n  const [workView, setWorkView] = useState(searchParams.get(\"view\") ?? \"new\")\n  const [newWorksPage, setNewWorksPage] = useState(\n    Number(searchParams.get(\"newPage\") ?? 0),\n  )\n  const [followUserFeedPage, setFollowUserFeedPage] = useState(\n    Number(searchParams.get(\"followUserPage\") ?? 0),\n  )\n  const [followTagFeedPage, setFollowTagFeedPage] = useState(\n    Number(searchParams.get(\"followTagPage\") ?? 0),\n  )\n  const [workType, setWorkType] =\n    useState<IntrospectionEnum<\"WorkType\"> | null>(\n      (searchParams.get(\"workType\") as IntrospectionEnum<\"WorkType\">) ?? null,\n    )\n  const [isPromptPublic, setIsPromptPublic] = useState<boolean | null>(\n    searchParams.get(\"isPromptPublic\") === null\n      ? null\n      : searchParams.get(\"isPromptPublic\") === \"true\",\n  )\n  const [sortType, setSortType] =\n    useState<IntrospectionEnum<\"WorkOrderBy\"> | null>(\n      (searchParams.get(\"sortType\") as IntrospectionEnum<\"WorkOrderBy\">) ??\n        null,\n    )\n  const [timeRange, setTimeRange] = useState(\n    searchParams.get(\"timeRange\") ?? \"ALL\",\n  )\n  const [isOneWorkPerUser, _setIsOneWorkPerUser] = useState<boolean>(\n    searchParams.get(\"isOneWorkPerUser\") === \"true\",\n  )\n\n  const [internalIsPagination, setInternalIsPagination] = useState(true)\n\n  // ä½œå“é·ç§»ãƒ¢ãƒ¼ãƒ‰ï¼ˆãƒ€ã‚¤ã‚¢ãƒ­ã‚° / ç›´æ¥ãƒªãƒ³ã‚¯ï¼‰\n  const [isDialogMode, setIsDialogMode] = useState(false)\n\n  // Work dialog URL state management\n  const workDialog = useWorkDialogUrl()\n\n  // ä½œå“ãƒ‡ãƒ¼ã‚¿ã®ç®¡ç†ç”¨state\n  const [currentWorks, setCurrentWorks] = useState<\n    FragmentOf<typeof PhotoAlbumWorkFragment>[]\n  >([])\n\n  const [isLoadingMore, _setIsLoadingMore] = useState(false)\n\n  // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§è¡¨ç¤ºã™ã‚‹ä½œå“ãƒ‡ãƒ¼ã‚¿ã‚’æ±ºå®š\n  const displayedWorks = useMemo(() => {\n    switch (currentTab) {\n      case \"new\":\n      case \"follow-user\":\n      case \"follow-tag\":\n        return currentWorks\n      default:\n        return []\n    }\n  }, [currentTab, currentWorks])\n\n  const [hasNextPage, _setHasNextPage] = useState(true)\n\n  // ä½œå“ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†\n  const openWork = (idx: string) => {\n    // displayedWorksã®workã®idä¸€è‡´ã™ã‚‹ã‚‚ã®\n    const work = displayedWorks.find((w) => w.id === idx)\n    if (!work) {\n      console.error(\"Work not found for ID:\", idx)\n      return\n    }\n    if (isDialogMode) {\n      console.log(\"Opening dialog for work ID:\", idx)\n      workDialog.openDialog(idx)\n    } else {\n      console.log(\"Navigating to:\", `/posts/${work.id}`)\n      navigate(`/posts/${work.id}`)\n    }\n  }\n\n  // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãƒ¢ãƒ¼ãƒ‰å¤‰æ›´æ™‚ã®å‡¦ç†ï¼ˆlocalStorageã«ä¿å­˜ï¼‰\n  const onChangeDialogMode = (mode: boolean) => {\n    setIsDialogMode(mode)\n    if (typeof window !== \"undefined\") {\n      try {\n        localStorage.setItem(\"aipictors-dialog-mode\", JSON.stringify(mode))\n      } catch (error) {\n        console.error(\"Failed to save dialog mode to localStorage:\", error)\n      }\n    }\n    // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‰ã˜ã‚‹\n    if (!mode) {\n      workDialog.closeDialog()\n    }\n  }\n\n  // currentWorksã‚’æ›´æ–°ã™ã‚‹ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°\n  const updateCurrentWorks = (\n    works: FragmentOf<typeof PhotoAlbumWorkFragment>[],\n  ) => {\n    setCurrentWorks(works)\n  }\n\n  // ç„¡é™ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ç”¨ã®loadMoreé–¢æ•°\n  const loadMore = async () => {\n    if (isLoadingMore || !hasNextPage || internalIsPagination) return\n  }\n\n  // ------ URL sync helpers ------\n  const syncParam = (key: string, value: string | null) => {\n    const p = new URLSearchParams(searchParams)\n    value === null ? p.delete(key) : p.set(key, value)\n    updateQueryParams(p)\n  }\n\n  const handleTabChange = (tab: string) => {\n    setCurrentTab(tab)\n    syncParam(\"tab\", tab)\n  }\n  const handleWorkViewChange = (v: string) => {\n    setWorkView(v)\n    syncParam(\"view\", v)\n  }\n\n  const setPageWithParam =\n    (setter: (n: number) => void, paramKey: string) => (n: number) => {\n      setter(n)\n      syncParam(paramKey, String(n))\n    }\n\n  // ------ GraphQL for sideâ€menu ads ------\n  const { data: pass } = useQuery(viewerCurrentPassQuery)\n  const { data: advertisements } = useQuery(randomCustomerAdvertisementQuery, {\n    variables: { where: { isSensitive: true, page: \"work\" } },\n  })\n  const [updateClicked] = useMutation(\n    updateClickedCountCustomerAdvertisementMutation,\n  )\n  const isSubscriptionUser = [\"LITE\", \"STANDARD\", \"PREMIUM\"].includes(\n    pass?.viewer?.currentPass?.type ?? \"\",\n  )\n\n  // localStorageã‹ã‚‰ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’å¾©å…ƒ\n  useEffect(() => {\n    if (typeof window !== \"undefined\") {\n      try {\n        const savedMode = localStorage.getItem(\"aipictors-dialog-mode\")\n        if (savedMode !== null) {\n          const parsedMode = JSON.parse(savedMode)\n          setIsDialogMode(parsedMode)\n        }\n      } catch (error) {\n        console.error(\"Failed to restore dialog mode from localStorage:\", error)\n      }\n    }\n  }, [])\n\n  // ---------- render ----------\n  if (!data) return null\n\n  return (\n    <>\n      <Tabs\n        value={currentTab}\n        onValueChange={handleTabChange}\n        className=\"space-y-4\"\n      >\n        {/* ---------- TAB HEADER ---------- */}\n        <div className=\"flex items-center sm:gap-x-2 md:gap-x-4\">\n          <AppAnimatedTabs\n            tabs={[\n              { label: \"ãƒ›ãƒ¼ãƒ \", value: \"home\" },\n              { label: \"æ–°ç€ãƒ»äººæ°—\", value: \"new\" },\n              { label: \"ãƒ•ã‚©ãƒ­ãƒ¼æ–°ç€\", value: \"follow-user\" },\n              { label: \"ãŠæ°—ã«å…¥ã‚Šã‚¿ã‚°æ–°ç€\", value: \"follow-tag\" },\n            ]}\n            value={currentTab}\n            onChange={setCurrentTab}\n          />\n          <Button variant=\"secondary\" size=\"sm\" onClick={() => navigate(\"/\")}>\n            å…¨å¹´é½¢\n          </Button>\n        </div>\n\n        {/* ---------- HOME ---------- */}\n        <TabsContent value=\"home\" className=\"m-0 flex flex-col space-y-4\">\n          <HomeSensitiveTagList\n            themeTitle={data.dailyTheme?.title}\n            hotTags={data.hotSensitiveTags}\n          />\n          <div className=\"block space-y-4 md:flex md:space-x-4 md:space-y-0\">\n            {/* left */}\n            <div className=\"flex w-full flex-col space-y-4 \">\n              <HomeSensitiveWorksUsersRecommendedSection\n                works={data.promotionWorks}\n              />\n              <HomeSensitiveNewUsersWorksSection works={data.newUserWorks} />\n              <HomeSensitiveAwardWorkSection\n                awardDateText={data.awardDateText}\n                title={t(\"å‰æ—¥ãƒ©ãƒ³ã‚­ãƒ³ã‚°\", \"Previous Day Ranking\")}\n                awards={data.workAwards}\n              />\n              <HomeSensitiveWorksTagSection\n                tag={data.firstTag}\n                works={data.firstTagWorks}\n                secondTag={data.secondTag}\n                secondWorks={data.secondTagWorks}\n                isCropped\n              />\n              <HomeSensitiveTagsSection\n                title={t(\"äººæ°—ã‚¿ã‚°\", \"Popular Tags\")}\n                tags={data.recommendedTags}\n              />\n            </div>\n\n            {/* right */}\n            <Separator\n              orientation=\"vertical\"\n              className=\"hidden h-[100vh] w-[1px] md:block\"\n            />\n            <div className=\"flex w-full max-w-80 flex-col space-y-4\">\n              <Button\n                onClick={() => navigate(\"/\")}\n                variant=\"secondary\"\n                className=\"w-full\"\n              >\n                {t(\"å…¨å¹´é½¢\", \"All Ages\")}\n              </Button>\n\n              {!isSubscriptionUser &&\n                advertisements?.randomCustomerAdvertisement && (\n                  <div className=\"relative border\">\n                    <Link\n                      to={advertisements.randomCustomerAdvertisement.url}\n                      target=\"_blank\"\n                      onClick={() => {\n                        const id =\n                          advertisements.randomCustomerAdvertisement?.id\n                        if (!id) return\n                        updateClicked({\n                          variables: {\n                            id,\n                          },\n                        })\n                      }}\n                    >\n                      <img\n                        src={\n                          advertisements.randomCustomerAdvertisement.imageUrl\n                        }\n                        alt=\"Advertisement\"\n                      />\n                    </Link>\n                    <div className=\"absolute top-0 right-0\">\n                      <CrossPlatformTooltip\n                        text={t(\n                          \"ææºåºƒå‘Šã§ã™ã€åºƒå‘Šä¸»æ§˜ã‚’å‹Ÿé›†ä¸­ã§ã™ã€‚ãƒ¡ãƒ¼ãƒ«ã¾ãŸã¯DMã«ã¦ã”é€£çµ¡ãã ã•ã„ã€‚\",\n                          \"This is a partnered advertisement. We are accepting new advertisers. Please contact us via email or DM.\",\n                        )}\n                      />\n                    </div>\n                  </div>\n                )}\n\n              {data.newPostedUsers && (\n                <HomeNewSensitiveUsersSection users={data.newPostedUsers} />\n              )}\n              {data.newComments?.length > 0 && (\n                <HomeSensitiveNewCommentsSection comments={data.newComments} />\n              )}\n              {data.workAwards && (\n                <HomeAwardWorksSection works={data.workAwards} />\n              )}\n            </div>\n          </div>\n        </TabsContent>\n\n        {/* ---------- NEW / POPULAR / NEW-USER ---------- */}\n        <TabsContent value=\"new\" className=\"flex flex-col space-y-4\">\n          {/* toggle buttons */}\n          <div className=\"flex space-x-4\">\n            {[\n              { v: \"new\", label: t(\"æ–°ç€\", \"New\") },\n              // { v: \"popular\", label: t(\"äººæ°—\", \"Popular\") },\n              { v: \"new-user\", label: t(\"æ–°è¦ãƒ¦ãƒ¼ã‚¶\", \"New Users\") },\n            ].map(({ v, label }) => (\n              <Button\n                key={v}\n                variant={workView === v ? \"default\" : \"secondary\"}\n                onClick={() => handleWorkViewChange(v)}\n              >\n                {label}\n                {v === \"popular\" && (\n                  <CrossPlatformTooltip\n                    text={t(\n                      \"æœ€è¿‘æŠ•ç¨¿ã•ã‚ŒãŸäººæ°—ä½œå“ãŒè¡¨ç¤ºã•ã‚Œã¾ã™\",\n                      \"Recently popular works\",\n                    )}\n                  />\n                )}\n              </Button>\n            ))}\n          </div>\n\n          {/* filters (only on â€œnewâ€) */}\n          {workView === \"new\" && (\n            <>\n              <div className=\"space-y-4\">\n                {/* çµã‚Šè¾¼ã¿ç”¨ã®ã‚»ãƒ¬ã‚¯ãƒˆç¾¤ - ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */}\n                <div className=\"space-y-3\">\n                  {/* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¡Œ1: ç¨®é¡ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã€ã‚½ãƒ¼ãƒˆ */}\n                  <div className=\"grid grid-cols-3 gap-2 md:flex md:space-x-4\">\n                    {/* type */}\n                    <Select\n                      value={workType ?? \"\"}\n                      onValueChange={(v) => {\n                        setWorkType(v === \"ALL\" ? null : (v as any))\n                        syncParam(\"workType\", v === \"ALL\" ? null : v)\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <SelectValue\n                          placeholder={\n                            workType\n                              ? toWorkTypeText({ type: workType, lang: locale })\n                              : t(\"ç¨®é¡\", \"Type\")\n                          }\n                        />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {[\"ALL\", \"WORK\", \"VIDEO\", \"NOVEL\", \"COLUMN\"].map(\n                          (v) => (\n                            <SelectItem key={v} value={v}>\n                              {t(\n                                v === \"WORK\"\n                                  ? \"ç”»åƒ\"\n                                  : v === \"VIDEO\"\n                                    ? \"å‹•ç”»\"\n                                    : v === \"NOVEL\"\n                                      ? \"å°èª¬\"\n                                      : v === \"COLUMN\"\n                                        ? \"ã‚³ãƒ©ãƒ \"\n                                        : \"ç¨®é¡\",\n                                v,\n                              )}\n                            </SelectItem>\n                          ),\n                        )}\n                      </SelectContent>\n                    </Select>\n\n                    {/* prompt */}\n                    <Select\n                      value={\n                        isPromptPublic === null\n                          ? \"ALL\"\n                          : isPromptPublic\n                            ? \"prompt\"\n                            : \"no-prompt\"\n                      }\n                      onValueChange={(v) => {\n                        setIsPromptPublic(v === \"ALL\" ? null : v === \"prompt\")\n                        syncParam(\n                          \"isPromptPublic\",\n                          v === \"ALL\"\n                            ? null\n                            : v === \"prompt\"\n                              ? \"true\"\n                              : \"false\",\n                        )\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <SelectValue\n                          placeholder={t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ‰ç„¡\", \"Prompt\")}\n                        />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"ALL\">\n                          {t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ‰ç„¡\", \"Prompt\")}\n                        </SelectItem>\n                        <SelectItem value=\"prompt\">\n                          {t(\"ã‚ã‚Š\", \"Yes\")}\n                        </SelectItem>\n                        <SelectItem value=\"no-prompt\">\n                          {t(\"ãªã—\", \"No\")}\n                        </SelectItem>\n                      </SelectContent>\n                    </Select>\n\n                    {/* sort */}\n                    <Select\n                      value={sortType ?? \"\"}\n                      onValueChange={(v) => {\n                        setSortType(v === \"ALL\" ? null : (v as any))\n                        syncParam(\"sortType\", v === \"ALL\" ? null : v)\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <ArrowDownWideNarrow />\n                        <SelectValue placeholder={t(\"æœ€æ–°\", \"Latest\")} />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"DATE_CREATED\">\n                          {t(\"æœ€æ–°\", \"Latest\")}\n                        </SelectItem>\n                        <SelectItem value=\"LIKES_COUNT\">\n                          {t(\"æœ€ã‚‚äººæ°—\", \"Most Liked\")}\n                        </SelectItem>\n                        <SelectItem value=\"COMMENTS_COUNT\">\n                          {t(\"ã‚³ãƒ¡ãƒ³ãƒˆæ•°\", \"Most Comments\")}\n                        </SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  {/* time range */}\n                  <div className=\"flex flex-col space-y-2 md:flex-row md:items-center md:justify-between md:space-y-0\">\n                    <Select\n                      value={timeRange}\n                      onValueChange={(v) => {\n                        setTimeRange(v)\n                        syncParam(\"timeRange\", v === \"ALL\" ? null : v)\n                      }}\n                    >\n                      <SelectTrigger className=\"w-full text-xs md:w-auto md:min-w-[120px] md:text-sm\">\n                        <SelectValue placeholder={t(\"å…¨æœŸé–“\", \"All time\")} />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {[\"ALL\", \"TODAY\", \"YESTERDAY\", \"WEEK\"].map((v) => (\n                          <SelectItem key={v} value={v}>\n                            {t(\n                              v === \"TODAY\"\n                                ? \"æœ¬æ—¥\"\n                                : v === \"YESTERDAY\"\n                                  ? \"æ˜¨æ—¥\"\n                                  : v === \"WEEK\"\n                                    ? \"é€±é–“\"\n                                    : \"å…¨æœŸé–“\",\n                              v === \"ALL\"\n                                ? \"All time\"\n                                : v === \"TODAY\"\n                                  ? \"Today\"\n                                  : v === \"YESTERDAY\"\n                                    ? \"Yesterday\"\n                                    : \"Week\",\n                            )}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    {/* è¡¨ç¤ºæ–¹å¼åˆ‡ã‚Šæ›¿ãˆ - ã‚ˆã‚Šã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥ãªãƒ‡ã‚¶ã‚¤ãƒ³ */}\n                    <div className=\"flex space-x-2 md:space-x-4\">\n                      <div className=\"flex rounded-lg bg-muted p-1\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => {\n                            setInternalIsPagination(false)\n                            const p = new URLSearchParams(searchParams)\n                            p.set(\"isPagination\", \"false\")\n                            updateQueryParams(p)\n                          }}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            !internalIsPagination\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <List className=\"h-3 w-3\" />\n                          <span className=\"hidden sm:inline\">\n                            {t(\"ãƒ•ã‚£ãƒ¼ãƒ‰\", \"Feed\")}\n                          </span>\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => {\n                            setInternalIsPagination(true)\n                            const p = new URLSearchParams(searchParams)\n                            p.set(\"isPagination\", \"true\")\n                            updateQueryParams(p)\n                          }}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            internalIsPagination\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <Navigation className=\"h-3 w-3\" />\n                          <span className=\"hidden sm:inline\">\n                            {t(\"ãƒšãƒ¼ã‚¸\", \"Pages\")}\n                          </span>\n                        </Button>\n                      </div>\n                      <div className=\"flex rounded-lg bg-muted p-1\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => onChangeDialogMode(false)}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            !isDialogMode\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <ExternalLink className=\"h-4 w-4\" />\n                          <span>{t(\"ãƒªãƒ³ã‚¯é·ç§»\", \"Open page\")}</span>\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => onChangeDialogMode(true)}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            isDialogMode\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <PlaySquare className=\"h-4 w-4\" />\n                          <span>{t(\"ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\", \"Dialog\")}</span>\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <Suspense fallback={<AppLoadingPage />}>\n                {internalIsPagination ? (\n                  <HomePaginationSensitiveWorksSection\n                    page={newWorksPage}\n                    setPage={setNewWorksPage}\n                    workType={workType}\n                    isPromptPublic={isPromptPublic}\n                    sortType={sortType}\n                    timeRange={timeRange}\n                    isOneWorkPerUser={isOneWorkPerUser}\n                    onSelect={isDialogMode ? openWork : undefined}\n                    updateWorks={updateCurrentWorks}\n                  />\n                ) : (\n                  <HomeSensitiveWorksSection\n                    page={newWorksPage}\n                    setPage={setPageWithParam(setNewWorksPage, \"newPage\")}\n                    workType={workType}\n                    isPromptPublic={isPromptPublic}\n                    sortType={sortType}\n                    timeRange={timeRange}\n                    isPagination={false}\n                    onSelect={isDialogMode ? openWork : undefined}\n                    updateWorks={updateCurrentWorks}\n                  />\n                )}\n              </Suspense>\n            </>\n          )}\n\n          {workView === \"popular\" && (\n            <Suspense fallback={<AppLoadingPage />}>\n              <HomeSensitiveHotWorksSection\n                page={newWorksPage}\n                setPage={setPageWithParam(setNewWorksPage, \"newPage\")}\n                workType={workType}\n                isPromptPublic={isPromptPublic}\n                sortType={sortType}\n              />\n            </Suspense>\n          )}\n\n          {workView === \"new-user\" && (\n            <>\n              <div className=\"space-y-4\">\n                {/* çµã‚Šè¾¼ã¿ç”¨ã®ã‚»ãƒ¬ã‚¯ãƒˆç¾¤ - ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */}\n                <div className=\"space-y-3\">\n                  {/* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¡Œ1: ç¨®é¡ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã€ã‚½ãƒ¼ãƒˆ */}\n                  <div className=\"grid grid-cols-3 gap-2 md:flex md:space-x-4\">\n                    {/* type */}\n                    <Select\n                      value={workType ?? \"\"}\n                      onValueChange={(v) => {\n                        setWorkType(v === \"ALL\" ? null : (v as any))\n                        syncParam(\"workType\", v === \"ALL\" ? null : v)\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <SelectValue\n                          placeholder={\n                            workType\n                              ? toWorkTypeText({ type: workType, lang: locale })\n                              : t(\"ç¨®é¡\", \"Type\")\n                          }\n                        />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {[\"ALL\", \"WORK\", \"VIDEO\", \"NOVEL\", \"COLUMN\"].map(\n                          (v) => (\n                            <SelectItem key={v} value={v}>\n                              {t(\n                                v === \"WORK\"\n                                  ? \"ç”»åƒ\"\n                                  : v === \"VIDEO\"\n                                    ? \"å‹•ç”»\"\n                                    : v === \"NOVEL\"\n                                      ? \"å°èª¬\"\n                                      : v === \"COLUMN\"\n                                        ? \"ã‚³ãƒ©ãƒ \"\n                                        : \"ç¨®é¡\",\n                                v,\n                              )}\n                            </SelectItem>\n                          ),\n                        )}\n                      </SelectContent>\n                    </Select>\n\n                    {/* prompt */}\n                    <Select\n                      value={\n                        isPromptPublic === null\n                          ? \"ALL\"\n                          : isPromptPublic\n                            ? \"prompt\"\n                            : \"no-prompt\"\n                      }\n                      onValueChange={(v) => {\n                        setIsPromptPublic(v === \"ALL\" ? null : v === \"prompt\")\n                        syncParam(\n                          \"isPromptPublic\",\n                          v === \"ALL\"\n                            ? null\n                            : v === \"prompt\"\n                              ? \"true\"\n                              : \"false\",\n                        )\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <SelectValue\n                          placeholder={t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ‰ç„¡\", \"Prompt\")}\n                        />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"ALL\">\n                          {t(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ‰ç„¡\", \"Prompt\")}\n                        </SelectItem>\n                        <SelectItem value=\"prompt\">\n                          {t(\"ã‚ã‚Š\", \"Yes\")}\n                        </SelectItem>\n                        <SelectItem value=\"no-prompt\">\n                          {t(\"ãªã—\", \"No\")}\n                        </SelectItem>\n                      </SelectContent>\n                    </Select>\n\n                    {/* sort */}\n                    <Select\n                      value={sortType ?? \"\"}\n                      onValueChange={(v) => {\n                        setSortType(v === \"ALL\" ? null : (v as any))\n                        syncParam(\"sortType\", v === \"ALL\" ? null : v)\n                      }}\n                    >\n                      <SelectTrigger className=\"min-w-[120px]\">\n                        <ArrowDownWideNarrow />\n                        <SelectValue placeholder={t(\"æœ€æ–°\", \"Latest\")} />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"DATE_CREATED\">\n                          {t(\"æœ€æ–°\", \"Latest\")}\n                        </SelectItem>\n                        <SelectItem value=\"LIKES_COUNT\">\n                          {t(\"æœ€ã‚‚äººæ°—\", \"Most Liked\")}\n                        </SelectItem>\n                        <SelectItem value=\"COMMENTS_COUNT\">\n                          {t(\"ã‚³ãƒ¡ãƒ³ãƒˆæ•°\", \"Most Comments\")}\n                        </SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  {/* time range */}\n                  <div className=\"flex flex-col justify-end space-y-2 md:flex-row md:items-center md:space-y-0\">\n                    {/* è¡¨ç¤ºæ–¹å¼åˆ‡ã‚Šæ›¿ãˆ - ã‚ˆã‚Šã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥ãªãƒ‡ã‚¶ã‚¤ãƒ³ */}\n                    <div className=\"flex justify-end space-x-2 md:space-x-4\">\n                      <div className=\"flex justify-end rounded-lg bg-muted p-1\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => onChangeDialogMode(false)}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            !isDialogMode\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <ExternalLink className=\"h-4 w-4\" />\n                          <span>{t(\"ãƒªãƒ³ã‚¯é·ç§»\", \"Open page\")}</span>\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => onChangeDialogMode(true)}\n                          className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                            isDialogMode\n                              ? \"bg-background text-foreground shadow-sm\"\n                              : \"text-muted-foreground hover:text-foreground\"\n                          } `}\n                        >\n                          <PlaySquare className=\"h-4 w-4\" />\n                          <span>{t(\"ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\", \"Dialog\")}</span>\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <Suspense fallback={<AppLoadingPage />}>\n                <HomeNewUsersSensitiveWorkListSection\n                  workType={workType}\n                  isPromptPublic={isPromptPublic}\n                  sortType={sortType}\n                  isOneWorkPerUser={isOneWorkPerUser}\n                  onSelect={isDialogMode ? openWork : undefined}\n                  updateWorks={updateCurrentWorks}\n                />\n              </Suspense>\n            </>\n          )}\n        </TabsContent>\n\n        {/* ---------- FOLLOW USER ---------- */}\n        <TabsContent value=\"follow-user\" className=\"space-y-4\">\n          {/* Feed / Pages åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ */}\n          <div className=\"flex justify-end space-x-2 md:space-x-4\">\n            <div className=\"flex rounded-lg bg-muted p-1\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => {\n                  setInternalIsPagination(false)\n                  const p = new URLSearchParams(searchParams)\n                  p.set(\"isPagination\", \"false\")\n                  updateQueryParams(p)\n                }}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 text-xs ${\n                  !internalIsPagination\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                }`}\n              >\n                <List className=\"h-3 w-3\" />\n                <span className=\"hidden sm:inline\">\n                  {t(\"ãƒ•ã‚£ãƒ¼ãƒ‰\", \"Feed\")}\n                </span>\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => {\n                  setInternalIsPagination(true)\n                  const p = new URLSearchParams(searchParams)\n                  p.set(\"isPagination\", \"true\")\n                  updateQueryParams(p)\n                }}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 text-xs ${\n                  internalIsPagination\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                }`}\n              >\n                <Navigation className=\"h-3 w-3\" />\n                <span className=\"hidden sm:inline\">{t(\"ãƒšãƒ¼ã‚¸\", \"Pages\")}</span>\n              </Button>\n            </div>\n            <div className=\"flex rounded-lg bg-muted p-1\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => onChangeDialogMode(false)}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                  !isDialogMode\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                } `}\n              >\n                <ExternalLink className=\"h-4 w-4\" />\n                <span>{t(\"ãƒªãƒ³ã‚¯é·ç§»\", \"Open page\")}</span>\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => onChangeDialogMode(true)}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                  isDialogMode\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                } `}\n              >\n                <PlaySquare className=\"h-4 w-4\" />\n                <span>{t(\"ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\", \"Dialog\")}</span>\n              </Button>\n            </div>\n          </div>\n\n          {/* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */}\n          <Suspense fallback={<AppLoadingPage />}>\n            <FollowSensitiveUserFeedContents\n              page={followUserFeedPage}\n              setPage={setPageWithParam(\n                setFollowUserFeedPage,\n                \"followUserPage\",\n              )}\n              isPagination={internalIsPagination}\n              onPaginationModeChange={setInternalIsPagination}\n              onSelect={isDialogMode ? openWork : undefined}\n              updateWorks={updateCurrentWorks}\n            />\n          </Suspense>\n        </TabsContent>\n\n        {/* ---------- FOLLOW TAG ---------- */}\n        <TabsContent value=\"follow-tag\" className=\"space-y-4\">\n          {/* Feed / Pages åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ */}\n          <div className=\"flex justify-end space-x-2 md:space-x-4\">\n            <div className=\"flex rounded-lg bg-muted p-1\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => {\n                  setInternalIsPagination(false)\n                  const p = new URLSearchParams(searchParams)\n                  p.set(\"isPagination\", \"false\")\n                  updateQueryParams(p)\n                }}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 text-xs ${\n                  !internalIsPagination\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                }`}\n              >\n                <List className=\"h-3 w-3\" />\n                <span className=\"hidden sm:inline\">\n                  {t(\"ãƒ•ã‚£ãƒ¼ãƒ‰\", \"Feed\")}\n                </span>\n              </Button>\n\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => {\n                  setInternalIsPagination(true)\n                  const p = new URLSearchParams(searchParams)\n                  p.set(\"isPagination\", \"true\")\n                  updateQueryParams(p)\n                }}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 text-xs ${\n                  internalIsPagination\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                }`}\n              >\n                <Navigation className=\"h-3 w-3\" />\n                <span className=\"hidden sm:inline\">{t(\"ãƒšãƒ¼ã‚¸\", \"Pages\")}</span>\n              </Button>\n            </div>\n            <div className=\"flex rounded-lg bg-muted p-1\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => onChangeDialogMode(false)}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                  !isDialogMode\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                } `}\n              >\n                <ExternalLink className=\"h-4 w-4\" />\n                <span>{t(\"ãƒªãƒ³ã‚¯é·ç§»\", \"Open page\")}</span>\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => onChangeDialogMode(true)}\n                className={`flex items-center space-x-1 rounded-md px-3 py-1.5 font-medium text-xs transition-all ${\n                  isDialogMode\n                    ? \"bg-background text-foreground shadow-sm\"\n                    : \"text-muted-foreground hover:text-foreground\"\n                } `}\n              >\n                <PlaySquare className=\"h-4 w-4\" />\n                <span>{t(\"ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\", \"Dialog\")}</span>\n              </Button>\n            </div>\n          </div>\n\n          <Suspense fallback={<AppLoadingPage />}>\n            <FollowSensitiveTagsFeedContents\n              page={followTagFeedPage}\n              setPage={setPageWithParam(setFollowTagFeedPage, \"followTagPage\")}\n              isPagination={internalIsPagination}\n              onSelect={isDialogMode ? openWork : undefined}\n              updateWorks={updateCurrentWorks}\n            />\n          </Suspense>\n        </TabsContent>\n      </Tabs>\n\n      {/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ä½œå“ãƒ€ã‚¤ã‚¢ãƒ­ã‚° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */}\n      {workDialog.isOpen && workDialog.workId && (\n        <WorkViewerDialog\n          works={displayedWorks}\n          startWorkId={workDialog.workId}\n          onClose={workDialog.closeDialog}\n          loadMore={!internalIsPagination ? loadMore : undefined}\n          hasNextPage={hasNextPage}\n          isLoadingMore={isLoadingMore}\n        />\n      )}\n    </>\n  )\n}\n\nconst query = graphql(\n  `query HomeQuery(\n    # $pastGenerationBefore: String!\n    $year: Int!\n    $month: Int!\n    $day: Int!\n    $awardYear: Int!\n    $awardMonth: Int!\n    $awardDay: Int!\n    $adWorksLimit: Int!\n    # $novelWorksLimit: Int!\n    # $novelWorksBefore: String!\n    # $columnWorksLimit: Int!\n    # $columnWorksBefore: String!\n    # $generationWorksLimit: Int!\n    $promotionWorksLimit: Int!\n    $awardWorksLimit: Int!\n    $categoryFirst: String!\n    $categorySecond: String!\n    $tagWorksLimit: Int!\n    $newUsersWorksLimit: Int!\n  ) {\n    adWorks: works(\n      offset: 0,\n      limit: $adWorksLimit,\n      where: {\n        isFeatured: true,\n        ratings: [R18],\n        isNowCreatedAt: true\n      }\n    ) {\n      ...HomeBannerWork\n    }\n    dailyTheme(year: $year, month: $month, day: $day) {\n      id\n      title\n    }\n    hotSensitiveTags {\n      ...HomeTagListItem\n    }\n    workAwards(\n      offset: 0\n      limit: $awardWorksLimit\n      where: {\n        year: $awardYear\n        month: $awardMonth\n        day: $awardDay\n        isSensitive: true\n      }\n    ) {\n      ...HomeWorkAward\n    }\n    recommendedTags: recommendedTags(\n      limit: 16\n      where: {\n        isSensitive: true,\n      }\n    ) {\n      ...HomeTag\n    }\n    firstTagWorks: works(\n      offset: 0,\n      limit: $tagWorksLimit,\n      where: {\n        ratings: [R18],\n        search: $categoryFirst\n        orderBy: LIKES_COUNT\n        isSensitive: true\n        isNowCreatedAt: true\n      }\n    ) {\n      ...HomeTagWork\n    }\n    secondTagWorks: works(\n      offset: 0,\n      limit: $tagWorksLimit,\n      where: {\n        ratings: [R18]\n        search: $categorySecond\n        orderBy: LIKES_COUNT\n        isSensitive: true\n        isNowCreatedAt: true\n      }\n    ) {\n      ...HomeTagWork\n    }\n    newUserWorks: newUserWorks(\n      offset: 0,\n      limit: $newUsersWorksLimit,\n      where: {\n        ratings: [R18, R18G],\n      }\n    ) {\n      ...HomeNewUsersWorks\n    }\n    newPostedUsers: newPostedUsers(\n      offset: 0,\n      limit: 8,\n      where: {\n        isSensitive: true,\n      }\n    ) {\n      ...HomeNewPostedUsers\n    }\n    newComments: newComments(\n      offset: 0,\n      limit: 8,\n      where: {\n        isSensitive: true,\n        isTextOnly: true,\n        ratings: [R18, R18G],\n      }\n    ) {\n      ...HomeNewComments\n    }\n    promotionWorks: works(\n      offset: 0,\n      limit: $promotionWorksLimit,\n      where: {\n        isRecommended: true\n        isNowCreatedAt: true\n        ratings: [R18]\n      }\n    ) {\n      ...HomePromotionWork\n    }\n    # novelWorks: works(\n    #   offset: 0,\n    #   limit: $novelWorksLimit,\n    #   where: {\n    #     ratings: [G, R15],\n    #     workType: NOVEL,\n    #     beforeCreatedAt: $novelWorksBefore\n    #   }\n    # ) {\n    #   ...HomeNovelPost\n    # }\n    # columnWorks: works(\n    #   offset: 0,\n    #   limit: $columnWorksLimit,\n    #   where: {\n    #     ratings: [G, R15],\n    #     workType: COLUMN,\n    #     beforeCreatedAt: $columnWorksBefore\n    #   }\n    # ) {\n    #   ...HomeColumnPost\n    # }\n  }`,\n  [\n    HomeBannerWorkFragment,\n    HomePromotionWorkFragment,\n    // HomeNovelPostFragment,\n    HomeTagListItemFragment,\n    // HomeGenerationWorkFragment,\n    HomeWorkAwardFragment,\n    // HomeColumnPostFragment,\n    HomeTagFragment,\n    HomeTagWorkFragment,\n    HomeNewUsersWorksFragment,\n    HomeNewPostedUsersFragment,\n    HomeNewCommentsFragment,\n  ],\n)\n\nconst viewerCurrentPassQuery = graphql(\n  `query ViewerCurrentPass {\n    viewer {\n      id\n      currentPass {\n        id\n        type\n      }\n    }\n  }`,\n)\n\nexport const SideMenuAdvertisementsFragment = graphql(\n  `fragment SideMenuAdvertisementsFields on CustomerAdvertisementNode @_unmask {\n      id\n      imageUrl\n      url\n      displayProbability\n      clickCount\n      impressionCount\n      isSensitive\n      createdAt\n      page\n      startAt\n      endAt\n      isActive\n  }`,\n)\n\nconst randomCustomerAdvertisementQuery = graphql(\n  `query RandomCustomerAdvertisement($where: RandomCustomerAdvertisementWhereInput!) {\n    randomCustomerAdvertisement(where: $where) {\n      ...SideMenuAdvertisementsFields\n    }\n  }`,\n  [SideMenuAdvertisementsFragment],\n)\n\nconst updateClickedCountCustomerAdvertisementMutation = graphql(\n  `mutation UpdateClickedCountCustomerAdvertisement($id: ID!) {\n    updateClickedCountCustomerAdvertisement(id: $id) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).r.events.$event._index/route.tsx"},"span":[5950,5963],"sourceCode":"import { Card, CardHeader, CardContent } from \"~/components/ui/card\"\nimport type { HeadersFunction, LoaderFunctionArgs } from \"@remix-run/cloudflare\"\nimport { useLoaderData, useNavigate, useSearchParams } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { loaderClient } from \"~/lib/loader-client\"\nimport { RefreshCcwIcon } from \"lucide-react\"\nimport {\n  EventSensitiveWorkList,\n  EventSensitiveWorkListItemFragment,\n} from \"~/routes/($lang).r.events.$event._index/components/event-sensitive-work-list\"\nimport { Button } from \"~/components/ui/button\"\nimport { format } from \"date-fns\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { config } from \"~/config\"\nimport React, { useEffect } from \"react\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport type { SortType } from \"~/types/sort-type\"\n\nconst toEventDateTimeText = (time: number) => {\n  const t = useTranslation()\n\n  // UTCæ™‚é–“ã‹ã‚‰æ—¥æœ¬æ™‚é–“ï¼ˆUTC+9ï¼‰ã«å¤‰æ›\n  const date = new Date(time * 1000)\n  const japanTime = new Date(date.getTime() - 9 * 60 * 60 * 1000)\n\n  return t(\n    format(japanTime, \"yyyyå¹´MMæœˆddæ—¥ HHæ™‚mmåˆ†\"),\n    format(japanTime, \"yyyy/MM/dd HH:mm\"),\n  )\n}\n\nexport async function loader(props: LoaderFunctionArgs) {\n  const event = props.params.event\n\n  const urlParams = new URLSearchParams(props.request.url.split(\"?\")[1])\n  const pageParam = urlParams.get(\"page\")\n  const page = pageParam ? Number(pageParam) : 0\n\n  if (event === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const orderBy = urlParams.get(\"WorkOrderby\")\n    ? (urlParams.get(\"WorkOrderby\") as IntrospectionEnum<\"WorkOrderBy\">)\n    : \"LIKES_COUNT\"\n\n  const sort = urlParams.get(\"worksOrderDeskAsc\")\n    ? (urlParams.get(\"worksOrderDeskAsc\") as SortType)\n    : \"DESC\"\n\n  const eventsResp = await loaderClient.query({\n    query: appEventQuery,\n    variables: {\n      limit: 64,\n      offset: page * 64,\n      slug: event,\n      where: {\n        ratings: [\"R18\", \"R18G\"],\n        isNowCreatedAt: true,\n        orderBy: orderBy,\n        sort: sort,\n      },\n      isSensitive: true,\n    },\n  })\n\n  if (eventsResp.data.appEvent === null) {\n    throw new Response(null, { status: 404 })\n  }\n\n  return {\n    appEvent: eventsResp.data.appEvent,\n    works: eventsResp.data.appEvent.works,\n    worksCount: eventsResp.data.appEvent.worksCount as number,\n    awardWorks: eventsResp.data.appEvent.awardWorks,\n    page,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function FollowingLayout () {\n  const data = useLoaderData<typeof loader>()\n\n  const navigate = useNavigate()\n\n  const [searchParams, setSearchParams] = useSearchParams()\n\n  const [workType, setWorkType] =\n    React.useState<IntrospectionEnum<\"WorkType\"> | null>(\n      (searchParams.get(\"workType\") as IntrospectionEnum<\"WorkType\">) || null,\n    )\n\n  const [WorkOrderby, setWorkOrderby] = React.useState<\n    IntrospectionEnum<\"WorkOrderBy\">\n  >(\n    (searchParams.get(\"WorkOrderby\") as IntrospectionEnum<\"WorkOrderBy\">) ||\n      \"DATE_CREATED\",\n  )\n\n  const [worksOrderDeskAsc, setWorksOrderDeskAsc] = React.useState<SortType>(\n    (searchParams.get(\"worksOrderDeskAsc\") as SortType) || \"DESC\",\n  )\n\n  const [rating, setRating] =\n    React.useState<IntrospectionEnum<\"Rating\"> | null>(\n      (searchParams.get(\"rating\") as IntrospectionEnum<\"Rating\">) || null,\n    )\n\n  useEffect(() => {\n    const params = new URLSearchParams()\n\n    params.set(\"page\", String(data.page))\n    if (workType) params.set(\"workType\", workType)\n    if (rating) params.set(\"rating\", rating)\n    params.set(\"WorkOrderby\", WorkOrderby)\n    params.set(\"worksOrderDeskAsc\", worksOrderDeskAsc)\n\n    setSearchParams(params)\n  }, [\n    data.page,\n    workType,\n    rating,\n    WorkOrderby,\n    worksOrderDeskAsc,\n    setSearchParams,\n  ])\n\n  const onClickTitleSortButton = () => {\n    setWorkOrderby(\"NAME\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickLikeSortButton = () => {\n    setWorkOrderby(\"LIKES_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickBookmarkSortButton = () => {\n    setWorkOrderby(\"BOOKMARKS_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickCommentSortButton = () => {\n    setWorkOrderby(\"COMMENTS_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickViewSortButton = () => {\n    setWorkOrderby(\"VIEWS_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickAccessTypeSortButton = () => {\n    setWorkOrderby(\"ACCESS_TYPE\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickDateSortButton = () => {\n    setWorkOrderby(\"DATE_CREATED\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickWorkTypeSortButton = () => {\n    setWorkOrderby(\"WORK_TYPE\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickIsPromotionSortButton = () => {\n    setWorkOrderby(\"IS_PROMOTION\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const [worksMaxCount, _setWorksMaxCount] = React.useState(0)\n\n  return (\n    <div className=\"flex flex-col space-y-4\">\n      {data.appEvent.thumbnailImageUrl && (\n        <img\n          className=\"h-auto max-h-96 w-full rounded-lg object-cover\"\n          src={data.appEvent.thumbnailImageUrl}\n          alt=\"\"\n        />\n      )}\n      <Card className=\"m-auto w-full\">\n        <CardHeader>\n          <div className=\"mt-4 text-center font-medium text-lg\">\n            {data.appEvent.title}\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"m-auto flex max-w-96 flex-col items-center text-left\">\n            {/* biome-ignore lint/style/useSelfClosingElements: <explanation> */}\n            <div\n              className=\"mb-2 text-left text-sm\"\n              // biome-ignore lint/security/noDangerouslySetInnerHtml: <explanation>\n              dangerouslySetInnerHTML={{ __html: data.appEvent.description }}\n            />\n            <div className=\"mr-auto text-sm\">\n              {toEventDateTimeText(data.appEvent.startAt)}ï½\n              {toEventDateTimeText(data.appEvent.endAt)}\n            </div>\n            <div className=\"mt-2 mr-auto text-sm\">\n              å¿œå‹Ÿä½œå“æ•°: {data.appEvent.worksCount?.toString() ?? \"0\"}\n            </div>\n            <div className=\"mt-2 mr-auto text-sm\">\n              <span>å‚åŠ ã‚¿ã‚°: {data.appEvent.tag}</span>\n            </div>\n            <Button\n              className=\"mt-4 flex w-40 cursor-pointer justify-center\"\n              variant={\"secondary\"}\n              onClick={() => {\n                navigate(`/events/${data.appEvent.slug}`)\n              }}\n            >\n              <RefreshCcwIcon className=\"mr-1 w-3\" />\n              <p className=\"text-sm\">{\"å…¨å¹´é½¢\"}</p>\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n      {data.appEvent.slug && (\n        <EventSensitiveWorkList\n          works={data.works ?? []}\n          maxCount={data.worksCount}\n          page={data.page}\n          slug={data.appEvent.slug}\n          sort={worksOrderDeskAsc}\n          orderBy={WorkOrderby}\n          sumWorksCount={worksMaxCount}\n          workType={workType}\n          rating={rating}\n          onClickTitleSortButton={onClickTitleSortButton}\n          onClickLikeSortButton={onClickLikeSortButton}\n          onClickBookmarkSortButton={onClickBookmarkSortButton}\n          onClickCommentSortButton={onClickCommentSortButton}\n          onClickViewSortButton={onClickViewSortButton}\n          onClickAccessTypeSortButton={onClickAccessTypeSortButton}\n          onClickDateSortButton={onClickDateSortButton}\n          onClickWorkTypeSortButton={onClickWorkTypeSortButton}\n          onClickIsPromotionSortButton={onClickIsPromotionSortButton}\n          setWorkType={setWorkType}\n          setRating={setRating}\n          setSort={setWorksOrderDeskAsc}\n        />\n      )}\n    </div>\n  )\n}\n\nconst appEventQuery = graphql(\n  `query AppEvent($slug: String!, $offset: Int!, $limit: Int!, $where: WorksWhereInput!, $isSensitive: Boolean!) {\n    appEvent(slug: $slug) {\n      id\n      description\n      title\n      slug\n      thumbnailImageUrl\n      headerImageUrl\n      startAt\n      endAt\n      tag\n      worksCount\n      works(offset: $offset, limit: $limit, where: $where) {\n        ...EventSensitiveWorkListItem\n      }\n      awardWorks(offset: 0, limit: 20, isSensitive: $isSensitive) {\n        ...EventSensitiveWorkListItem\n      }\n    }\n  }`,\n  [EventSensitiveWorkListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).r.events.$event._index/route.tsx"},"span":[6102,6115],"sourceCode":"import { Card, CardHeader, CardContent } from \"~/components/ui/card\"\nimport type { HeadersFunction, LoaderFunctionArgs } from \"@remix-run/cloudflare\"\nimport { useLoaderData, useNavigate, useSearchParams } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { loaderClient } from \"~/lib/loader-client\"\nimport { RefreshCcwIcon } from \"lucide-react\"\nimport {\n  EventSensitiveWorkList,\n  EventSensitiveWorkListItemFragment,\n} from \"~/routes/($lang).r.events.$event._index/components/event-sensitive-work-list\"\nimport { Button } from \"~/components/ui/button\"\nimport { format } from \"date-fns\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { config } from \"~/config\"\nimport React, { useEffect } from \"react\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport type { SortType } from \"~/types/sort-type\"\n\nconst toEventDateTimeText = (time: number) => {\n  const t = useTranslation()\n\n  // UTCæ™‚é–“ã‹ã‚‰æ—¥æœ¬æ™‚é–“ï¼ˆUTC+9ï¼‰ã«å¤‰æ›\n  const date = new Date(time * 1000)\n  const japanTime = new Date(date.getTime() - 9 * 60 * 60 * 1000)\n\n  return t(\n    format(japanTime, \"yyyyå¹´MMæœˆddæ—¥ HHæ™‚mmåˆ†\"),\n    format(japanTime, \"yyyy/MM/dd HH:mm\"),\n  )\n}\n\nexport async function loader(props: LoaderFunctionArgs) {\n  const event = props.params.event\n\n  const urlParams = new URLSearchParams(props.request.url.split(\"?\")[1])\n  const pageParam = urlParams.get(\"page\")\n  const page = pageParam ? Number(pageParam) : 0\n\n  if (event === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const orderBy = urlParams.get(\"WorkOrderby\")\n    ? (urlParams.get(\"WorkOrderby\") as IntrospectionEnum<\"WorkOrderBy\">)\n    : \"LIKES_COUNT\"\n\n  const sort = urlParams.get(\"worksOrderDeskAsc\")\n    ? (urlParams.get(\"worksOrderDeskAsc\") as SortType)\n    : \"DESC\"\n\n  const eventsResp = await loaderClient.query({\n    query: appEventQuery,\n    variables: {\n      limit: 64,\n      offset: page * 64,\n      slug: event,\n      where: {\n        ratings: [\"R18\", \"R18G\"],\n        isNowCreatedAt: true,\n        orderBy: orderBy,\n        sort: sort,\n      },\n      isSensitive: true,\n    },\n  })\n\n  if (eventsResp.data.appEvent === null) {\n    throw new Response(null, { status: 404 })\n  }\n\n  return {\n    appEvent: eventsResp.data.appEvent,\n    works: eventsResp.data.appEvent.works,\n    worksCount: eventsResp.data.appEvent.worksCount as number,\n    awardWorks: eventsResp.data.appEvent.awardWorks,\n    page,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function FollowingLayout () {\n  const data = useLoaderData<typeof loader>()\n\n  const navigate = useNavigate()\n\n  const [searchParams, setSearchParams] = useSearchParams()\n\n  const [workType, setWorkType] =\n    React.useState<IntrospectionEnum<\"WorkType\"> | null>(\n      (searchParams.get(\"workType\") as IntrospectionEnum<\"WorkType\">) || null,\n    )\n\n  const [WorkOrderby, setWorkOrderby] = React.useState<\n    IntrospectionEnum<\"WorkOrderBy\">\n  >(\n    (searchParams.get(\"WorkOrderby\") as IntrospectionEnum<\"WorkOrderBy\">) ||\n      \"DATE_CREATED\",\n  )\n\n  const [worksOrderDeskAsc, setWorksOrderDeskAsc] = React.useState<SortType>(\n    (searchParams.get(\"worksOrderDeskAsc\") as SortType) || \"DESC\",\n  )\n\n  const [rating, setRating] =\n    React.useState<IntrospectionEnum<\"Rating\"> | null>(\n      (searchParams.get(\"rating\") as IntrospectionEnum<\"Rating\">) || null,\n    )\n\n  useEffect(() => {\n    const params = new URLSearchParams()\n\n    params.set(\"page\", String(data.page))\n    if (workType) params.set(\"workType\", workType)\n    if (rating) params.set(\"rating\", rating)\n    params.set(\"WorkOrderby\", WorkOrderby)\n    params.set(\"worksOrderDeskAsc\", worksOrderDeskAsc)\n\n    setSearchParams(params)\n  }, [\n    data.page,\n    workType,\n    rating,\n    WorkOrderby,\n    worksOrderDeskAsc,\n    setSearchParams,\n  ])\n\n  const onClickTitleSortButton = () => {\n    setWorkOrderby(\"NAME\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickLikeSortButton = () => {\n    setWorkOrderby(\"LIKES_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickBookmarkSortButton = () => {\n    setWorkOrderby(\"BOOKMARKS_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickCommentSortButton = () => {\n    setWorkOrderby(\"COMMENTS_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickViewSortButton = () => {\n    setWorkOrderby(\"VIEWS_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickAccessTypeSortButton = () => {\n    setWorkOrderby(\"ACCESS_TYPE\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickDateSortButton = () => {\n    setWorkOrderby(\"DATE_CREATED\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickWorkTypeSortButton = () => {\n    setWorkOrderby(\"WORK_TYPE\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickIsPromotionSortButton = () => {\n    setWorkOrderby(\"IS_PROMOTION\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const [worksMaxCount, _setWorksMaxCount] = React.useState(0)\n\n  return (\n    <div className=\"flex flex-col space-y-4\">\n      {data.appEvent.thumbnailImageUrl && (\n        <img\n          className=\"h-auto max-h-96 w-full rounded-lg object-cover\"\n          src={data.appEvent.thumbnailImageUrl}\n          alt=\"\"\n        />\n      )}\n      <Card className=\"m-auto w-full\">\n        <CardHeader>\n          <div className=\"mt-4 text-center font-medium text-lg\">\n            {data.appEvent.title}\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"m-auto flex max-w-96 flex-col items-center text-left\">\n            {/* biome-ignore lint/style/useSelfClosingElements: <explanation> */}\n            <div\n              className=\"mb-2 text-left text-sm\"\n              // biome-ignore lint/security/noDangerouslySetInnerHtml: <explanation>\n              dangerouslySetInnerHTML={{ __html: data.appEvent.description }}\n            />\n            <div className=\"mr-auto text-sm\">\n              {toEventDateTimeText(data.appEvent.startAt)}ï½\n              {toEventDateTimeText(data.appEvent.endAt)}\n            </div>\n            <div className=\"mt-2 mr-auto text-sm\">\n              å¿œå‹Ÿä½œå“æ•°: {data.appEvent.worksCount?.toString() ?? \"0\"}\n            </div>\n            <div className=\"mt-2 mr-auto text-sm\">\n              <span>å‚åŠ ã‚¿ã‚°: {data.appEvent.tag}</span>\n            </div>\n            <Button\n              className=\"mt-4 flex w-40 cursor-pointer justify-center\"\n              variant={\"secondary\"}\n              onClick={() => {\n                navigate(`/events/${data.appEvent.slug}`)\n              }}\n            >\n              <RefreshCcwIcon className=\"mr-1 w-3\" />\n              <p className=\"text-sm\">{\"å…¨å¹´é½¢\"}</p>\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n      {data.appEvent.slug && (\n        <EventSensitiveWorkList\n          works={data.works ?? []}\n          maxCount={data.worksCount}\n          page={data.page}\n          slug={data.appEvent.slug}\n          sort={worksOrderDeskAsc}\n          orderBy={WorkOrderby}\n          sumWorksCount={worksMaxCount}\n          workType={workType}\n          rating={rating}\n          onClickTitleSortButton={onClickTitleSortButton}\n          onClickLikeSortButton={onClickLikeSortButton}\n          onClickBookmarkSortButton={onClickBookmarkSortButton}\n          onClickCommentSortButton={onClickCommentSortButton}\n          onClickViewSortButton={onClickViewSortButton}\n          onClickAccessTypeSortButton={onClickAccessTypeSortButton}\n          onClickDateSortButton={onClickDateSortButton}\n          onClickWorkTypeSortButton={onClickWorkTypeSortButton}\n          onClickIsPromotionSortButton={onClickIsPromotionSortButton}\n          setWorkType={setWorkType}\n          setRating={setRating}\n          setSort={setWorksOrderDeskAsc}\n        />\n      )}\n    </div>\n  )\n}\n\nconst appEventQuery = graphql(\n  `query AppEvent($slug: String!, $offset: Int!, $limit: Int!, $where: WorksWhereInput!, $isSensitive: Boolean!) {\n    appEvent(slug: $slug) {\n      id\n      description\n      title\n      slug\n      thumbnailImageUrl\n      headerImageUrl\n      startAt\n      endAt\n      tag\n      worksCount\n      works(offset: $offset, limit: $limit, where: $where) {\n        ...EventSensitiveWorkListItem\n      }\n      awardWorks(offset: 0, limit: 20, isSensitive: $isSensitive) {\n        ...EventSensitiveWorkListItem\n      }\n    }\n  }`,\n  [EventSensitiveWorkListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/unused","severity":"warning","description":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule.","message":[{"elements":[],"content":"Suppression comment has no effect. Remove the suppression or make sure you are suppressing the correct rule."}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).r.events.$event._index/route.tsx"},"span":[5896,5963],"sourceCode":"import { Card, CardHeader, CardContent } from \"~/components/ui/card\"\nimport type { HeadersFunction, LoaderFunctionArgs } from \"@remix-run/cloudflare\"\nimport { useLoaderData, useNavigate, useSearchParams } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { loaderClient } from \"~/lib/loader-client\"\nimport { RefreshCcwIcon } from \"lucide-react\"\nimport {\n  EventSensitiveWorkList,\n  EventSensitiveWorkListItemFragment,\n} from \"~/routes/($lang).r.events.$event._index/components/event-sensitive-work-list\"\nimport { Button } from \"~/components/ui/button\"\nimport { format } from \"date-fns\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { config } from \"~/config\"\nimport React, { useEffect } from \"react\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport type { SortType } from \"~/types/sort-type\"\n\nconst toEventDateTimeText = (time: number) => {\n  const t = useTranslation()\n\n  // UTCæ™‚é–“ã‹ã‚‰æ—¥æœ¬æ™‚é–“ï¼ˆUTC+9ï¼‰ã«å¤‰æ›\n  const date = new Date(time * 1000)\n  const japanTime = new Date(date.getTime() - 9 * 60 * 60 * 1000)\n\n  return t(\n    format(japanTime, \"yyyyå¹´MMæœˆddæ—¥ HHæ™‚mmåˆ†\"),\n    format(japanTime, \"yyyy/MM/dd HH:mm\"),\n  )\n}\n\nexport async function loader(props: LoaderFunctionArgs) {\n  const event = props.params.event\n\n  const urlParams = new URLSearchParams(props.request.url.split(\"?\")[1])\n  const pageParam = urlParams.get(\"page\")\n  const page = pageParam ? Number(pageParam) : 0\n\n  if (event === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const orderBy = urlParams.get(\"WorkOrderby\")\n    ? (urlParams.get(\"WorkOrderby\") as IntrospectionEnum<\"WorkOrderBy\">)\n    : \"LIKES_COUNT\"\n\n  const sort = urlParams.get(\"worksOrderDeskAsc\")\n    ? (urlParams.get(\"worksOrderDeskAsc\") as SortType)\n    : \"DESC\"\n\n  const eventsResp = await loaderClient.query({\n    query: appEventQuery,\n    variables: {\n      limit: 64,\n      offset: page * 64,\n      slug: event,\n      where: {\n        ratings: [\"R18\", \"R18G\"],\n        isNowCreatedAt: true,\n        orderBy: orderBy,\n        sort: sort,\n      },\n      isSensitive: true,\n    },\n  })\n\n  if (eventsResp.data.appEvent === null) {\n    throw new Response(null, { status: 404 })\n  }\n\n  return {\n    appEvent: eventsResp.data.appEvent,\n    works: eventsResp.data.appEvent.works,\n    worksCount: eventsResp.data.appEvent.worksCount as number,\n    awardWorks: eventsResp.data.appEvent.awardWorks,\n    page,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function FollowingLayout () {\n  const data = useLoaderData<typeof loader>()\n\n  const navigate = useNavigate()\n\n  const [searchParams, setSearchParams] = useSearchParams()\n\n  const [workType, setWorkType] =\n    React.useState<IntrospectionEnum<\"WorkType\"> | null>(\n      (searchParams.get(\"workType\") as IntrospectionEnum<\"WorkType\">) || null,\n    )\n\n  const [WorkOrderby, setWorkOrderby] = React.useState<\n    IntrospectionEnum<\"WorkOrderBy\">\n  >(\n    (searchParams.get(\"WorkOrderby\") as IntrospectionEnum<\"WorkOrderBy\">) ||\n      \"DATE_CREATED\",\n  )\n\n  const [worksOrderDeskAsc, setWorksOrderDeskAsc] = React.useState<SortType>(\n    (searchParams.get(\"worksOrderDeskAsc\") as SortType) || \"DESC\",\n  )\n\n  const [rating, setRating] =\n    React.useState<IntrospectionEnum<\"Rating\"> | null>(\n      (searchParams.get(\"rating\") as IntrospectionEnum<\"Rating\">) || null,\n    )\n\n  useEffect(() => {\n    const params = new URLSearchParams()\n\n    params.set(\"page\", String(data.page))\n    if (workType) params.set(\"workType\", workType)\n    if (rating) params.set(\"rating\", rating)\n    params.set(\"WorkOrderby\", WorkOrderby)\n    params.set(\"worksOrderDeskAsc\", worksOrderDeskAsc)\n\n    setSearchParams(params)\n  }, [\n    data.page,\n    workType,\n    rating,\n    WorkOrderby,\n    worksOrderDeskAsc,\n    setSearchParams,\n  ])\n\n  const onClickTitleSortButton = () => {\n    setWorkOrderby(\"NAME\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickLikeSortButton = () => {\n    setWorkOrderby(\"LIKES_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickBookmarkSortButton = () => {\n    setWorkOrderby(\"BOOKMARKS_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickCommentSortButton = () => {\n    setWorkOrderby(\"COMMENTS_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickViewSortButton = () => {\n    setWorkOrderby(\"VIEWS_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickAccessTypeSortButton = () => {\n    setWorkOrderby(\"ACCESS_TYPE\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickDateSortButton = () => {\n    setWorkOrderby(\"DATE_CREATED\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickWorkTypeSortButton = () => {\n    setWorkOrderby(\"WORK_TYPE\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickIsPromotionSortButton = () => {\n    setWorkOrderby(\"IS_PROMOTION\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const [worksMaxCount, _setWorksMaxCount] = React.useState(0)\n\n  return (\n    <div className=\"flex flex-col space-y-4\">\n      {data.appEvent.thumbnailImageUrl && (\n        <img\n          className=\"h-auto max-h-96 w-full rounded-lg object-cover\"\n          src={data.appEvent.thumbnailImageUrl}\n          alt=\"\"\n        />\n      )}\n      <Card className=\"m-auto w-full\">\n        <CardHeader>\n          <div className=\"mt-4 text-center font-medium text-lg\">\n            {data.appEvent.title}\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"m-auto flex max-w-96 flex-col items-center text-left\">\n            {/* biome-ignore lint/style/useSelfClosingElements: <explanation> */}\n            <div\n              className=\"mb-2 text-left text-sm\"\n              // biome-ignore lint/security/noDangerouslySetInnerHtml: <explanation>\n              dangerouslySetInnerHTML={{ __html: data.appEvent.description }}\n            />\n            <div className=\"mr-auto text-sm\">\n              {toEventDateTimeText(data.appEvent.startAt)}ï½\n              {toEventDateTimeText(data.appEvent.endAt)}\n            </div>\n            <div className=\"mt-2 mr-auto text-sm\">\n              å¿œå‹Ÿä½œå“æ•°: {data.appEvent.worksCount?.toString() ?? \"0\"}\n            </div>\n            <div className=\"mt-2 mr-auto text-sm\">\n              <span>å‚åŠ ã‚¿ã‚°: {data.appEvent.tag}</span>\n            </div>\n            <Button\n              className=\"mt-4 flex w-40 cursor-pointer justify-center\"\n              variant={\"secondary\"}\n              onClick={() => {\n                navigate(`/events/${data.appEvent.slug}`)\n              }}\n            >\n              <RefreshCcwIcon className=\"mr-1 w-3\" />\n              <p className=\"text-sm\">{\"å…¨å¹´é½¢\"}</p>\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n      {data.appEvent.slug && (\n        <EventSensitiveWorkList\n          works={data.works ?? []}\n          maxCount={data.worksCount}\n          page={data.page}\n          slug={data.appEvent.slug}\n          sort={worksOrderDeskAsc}\n          orderBy={WorkOrderby}\n          sumWorksCount={worksMaxCount}\n          workType={workType}\n          rating={rating}\n          onClickTitleSortButton={onClickTitleSortButton}\n          onClickLikeSortButton={onClickLikeSortButton}\n          onClickBookmarkSortButton={onClickBookmarkSortButton}\n          onClickCommentSortButton={onClickCommentSortButton}\n          onClickViewSortButton={onClickViewSortButton}\n          onClickAccessTypeSortButton={onClickAccessTypeSortButton}\n          onClickDateSortButton={onClickDateSortButton}\n          onClickWorkTypeSortButton={onClickWorkTypeSortButton}\n          onClickIsPromotionSortButton={onClickIsPromotionSortButton}\n          setWorkType={setWorkType}\n          setRating={setRating}\n          setSort={setWorksOrderDeskAsc}\n        />\n      )}\n    </div>\n  )\n}\n\nconst appEventQuery = graphql(\n  `query AppEvent($slug: String!, $offset: Int!, $limit: Int!, $where: WorksWhereInput!, $isSensitive: Boolean!) {\n    appEvent(slug: $slug) {\n      id\n      description\n      title\n      slug\n      thumbnailImageUrl\n      headerImageUrl\n      startAt\n      endAt\n      tag\n      worksCount\n      works(offset: $offset, limit: $limit, where: $where) {\n        ...EventSensitiveWorkListItem\n      }\n      awardWorks(offset: 0, limit: 20, isSensitive: $isSensitive) {\n        ...EventSensitiveWorkListItem\n      }\n    }\n  }`,\n  [EventSensitiveWorkListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).r.users.$user.notes/components/user-sensitive-note-list.tsx"},"span":[1901,1914],"sourceCode":"import { type FragmentOf, graphql } from \"gql.tada\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { useContext } from \"react\"\nimport { CarouselWithGradation } from \"~/components/carousel-with-gradation\"\nimport { LikeButton } from \"~/components/like-button\"\nimport { UserNameBadge } from \"~/routes/($lang)._main._index/components/user-name-badge\"\nimport { NovelWorkPreviewItem } from \"~/routes/($lang)._main._index/components/video-work-preview-item\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { useNavigate } from \"react-router-dom\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\n\ntype Props = {\n  works: FragmentOf<typeof UserNotesItemFragment>[]\n  page: number\n  maxCount: number\n}\n\nexport function UserSensitiveNoteList (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  const userId =\n    props.works.length > 0 && props.works[0]?.user\n      ? (props.works[0].user.id ?? \"\")\n      : \"\"\n\n  const userLogin =\n    props.works.length > 0 && props.works[0]?.user\n      ? (props.works[0].user.login ?? \"\")\n      : \"\"\n\n  const { data: novelWorks } = useQuery(UserNotesQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn || userId === \"\",\n    variables: {\n      offset: props.page * 32,\n      limit: 32,\n      where: {\n        userId: userId,\n        ratings: [\"G\", \"R15\"],\n        workType: \"COLUMN\",\n        isNowCreatedAt: true,\n      },\n    },\n  })\n\n  const works = novelWorks?.works ?? props.works\n\n  const navigate = useNavigate()\n\n  return (\n    <div className=\"flex flex-col space-y-4\">\n      <div className=\"flex min-h-96 flex-col gap-y-4\">\n        <section className=\"relative space-y-4\">\n          <CarouselWithGradation\n            items={works.map((work, _index) => (\n              // biome-ignore lint/correctness/useJsxKeyInIterable: <explanation>\n              <div className=\"h-full rounded border-2 border-gray border-solid\">\n                <div className=\"relative\">\n                  <NovelWorkPreviewItem\n                    workId={work.id}\n                    imageUrl={work.smallThumbnailImageURL}\n                    title={work.title}\n                    text={work.description ?? \"\"}\n                    tags={[]}\n                  />\n                </div>\n                {work.user && (\n                  <>\n                    <UserNameBadge\n                      userId={work.user.id}\n                      userIconImageURL={withIconUrlFallback(work.user.iconUrl)}\n                      name={work.user.name}\n                      width={\"sm\"}\n                      padding={\"md\"}\n                    />\n                    <div className=\"absolute right-0 bottom-0\">\n                      <LikeButton\n                        size={56}\n                        targetWorkId={work.id}\n                        targetWorkOwnerUserId={work.user.id}\n                        defaultLiked={work.isLiked}\n                        defaultLikedCount={0}\n                        isBackgroundNone={true}\n                        strokeWidth={2}\n                      />\n                    </div>\n                  </>\n                )}\n              </div>\n            ))}\n          />\n        </section>\n      </div>\n      <div className=\"h-8\" />\n      <div className=\"-translate-x-1/2 fixed bottom-0 left-1/2 z-10 w-full border-border/40 bg-background/95 p-2 backdrop-blur-sm supports-backdrop-filter:bg-background/80\">\n        <ResponsivePagination\n          perPage={32}\n          maxCount={props.maxCount}\n          currentPage={props.page}\n          onPageChange={(page: number) => {\n            navigate(`/users/${userLogin}/works?page=${page}`)\n          }}\n        />\n      </div>\n    </div>\n  )\n}\n\nexport const UserNotesItemFragment = graphql(\n  `fragment UserNotesItem on WorkNode @_unmask {\n    id\n    smallThumbnailImageURL\n    isLiked\n    title\n    description\n    user {\n      id\n      name\n      iconUrl\n      login\n    }\n  }`,\n)\n\nexport const UserNotesQuery = graphql(\n  `query UserNotes($offset: Int!, $limit: Int!, $where: WorksWhereInput) {\n    works(offset: $offset, limit: $limit, where: $where) {\n      ...UserNotesItem\n    }\n    worksCount(where: $where)\n  }`,\n  [UserNotesItemFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.advertisements/_components/setting-advertisements-form.tsx"},"span":[23651,24206],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { ApolloError, useMutation, useQuery } from \"@apollo/client/index\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport { type SetStateAction, useContext, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { toDateText } from \"~/utils/to-date-text\"\nimport { addHours, endOfMonth, format, startOfMonth } from \"date-fns\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { Loader2Icon } from \"lucide-react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { getBase64FromImageUrl } from \"~/utils/get-base64-from-image-url\"\nimport { Link } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { SettingsAdvertisementsDeleteConfirmDialog } from \"~/routes/($lang).settings.advertisements/_components/settings-advertisements-delete-confirm-dialog\"\n\n// æ—¥æœ¬æ™‚é–“ (JST) ã«å¤‰æ›ã™ã‚‹ãŸã‚ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°\nconst toJST = (date: Date) => {\n  return addHours(date, 9) // UTCã«å¯¾ã—ã¦+9æ™‚é–“ã§JSTã«å¤‰æ›\n}\n\nexport function SettingAdvertisementsForm () {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const { data: isAdvertiser, loading: isAdvertiserLoading } = useQuery(\n    viewerIsAdvertiserQuery,\n  )\n\n  if (isAdvertiser?.viewer?.isAdvertiser === false) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const [newAdvertisement, setNewAdvertisement] = useState({\n    imageUrl: \"\",\n    url: \"\",\n    displayProbability: 0,\n    isSensitive: false,\n    isActive: false,\n    startAt: \"\",\n    endAt: \"\",\n  })\n\n  const { data: token } = useQuery(viewerTokenQuery, {\n    skip: authContext.isLoading,\n  })\n  const [date, setDate] = useState<Date | null>(null)\n\n  const [isActive, setIsActive] = useState<boolean | undefined>(undefined)\n\n  const [isSensitiveFilter, setIsSensitiveFilter] = useState<\n    boolean | undefined\n  >(undefined)\n\n  const [isEditing, setIsEditing] = useState(false)\n\n  const [editingId, setEditingId] = useState<string | null>(null)\n\n  const [viewMode, setViewMode] = useState(\"list\") // åˆ‡ã‚Šæ›¿ãˆç”¨\n\n  const { data, loading, error, refetch } = useQuery(\n    viewerAdvertisementsQuery,\n    {\n      skip: authContext.isLoading,\n      variables: {\n        limit: 64,\n        offset: 0,\n      },\n    },\n  )\n\n  const [uploadedImageUrls, setUploadedImageUrls] = useState<string[]>([])\n\n  const [count, setCount] = useState(0)\n\n  const [imageBase64, setImageBase64] = useState<string | null>(null)\n\n  const [isUploading, setIsUploading] = useState(false)\n\n  const [createAdvertisement, { loading: isCreating }] = useMutation(\n    createCustomerAdvertisement,\n  )\n\n  const [updateAdvertisement, { loading: isUpdating }] = useMutation(\n    updateCustomerAdvertisement,\n  )\n\n  const [deleteAdvertisement, { loading: isDeleting }] = useMutation(\n    deleteCustomerAdvertisement,\n  )\n\n  // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãŸåºƒå‘Šãƒªã‚¹ãƒˆã‚’ç”Ÿæˆã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯\n  const filteredAdvertisements = data?.viewer?.customerAdvertisements.filter(\n    (advertisement) => {\n      const isActiveMatch =\n        isActive === undefined || advertisement.isActive === isActive\n      const isSensitiveMatch =\n        isSensitiveFilter === undefined ||\n        advertisement.isSensitive === isSensitiveFilter\n      return isActiveMatch && isSensitiveMatch\n    },\n  )\n\n  const handleCreate = async () => {\n    try {\n      if (!newAdvertisement.imageUrl || !newAdvertisement.url) {\n        toast(\n          t(\n            \"ç”»åƒURLã¨ãƒªãƒ³ã‚¯URLã¯å¿…é ˆã§ã™\",\n            \"Image URL and Link URL are required\",\n          ),\n        )\n        return\n      }\n\n      const selectedDate = new Date(newAdvertisement.startAt)\n\n      const startAtJST = toJST(startOfMonth(selectedDate))\n\n      const endAtJST = toJST(endOfMonth(selectedDate))\n\n      await createAdvertisement({\n        variables: {\n          input: {\n            imageUrl: newAdvertisement.imageUrl,\n            url: newAdvertisement.url,\n            displayProbability: newAdvertisement.displayProbability,\n            page: \"work\",\n            isSensitive: newAdvertisement.isSensitive,\n            isActive: newAdvertisement.isActive,\n            startAt: startAtJST.toISOString(),\n            endAt: endAtJST.toISOString(),\n          },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’ä½œæˆã—ã¾ã—ãŸ\", \"Advertisement created\"))\n      setViewMode(\"list\")\n      setIsEditing(false)\n\n      refetch({\n        limit: 64,\n        offset: 0,\n      })\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleEdit = (\n    advertisement: FragmentOf<typeof AdvertisementsFragment>,\n  ) => {\n    setNewAdvertisement({\n      imageUrl: advertisement.imageUrl,\n      url: advertisement.url,\n      displayProbability: advertisement.displayProbability,\n      isSensitive: advertisement.isSensitive,\n      isActive: advertisement.isActive,\n      startAt: startOfMonth(\n        new Date(advertisement.startAt * 1000),\n      ).toISOString(),\n      endAt: endOfMonth(new Date(advertisement.endAt * 1000)).toISOString(),\n    })\n    setIsEditing(true)\n    setEditingId(advertisement.id)\n    setViewMode(\"create\") // ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ\n  }\n\n  // å†ãƒ•ã‚§ãƒƒãƒã§æ¤œç´¢ã‚’å®Ÿè¡Œ\n  const handleSearch = () => {\n    if (date) {\n      const selectedDate = date\n      const startAtJST = toJST(startOfMonth(selectedDate))\n      const endAtJST = toJST(endOfMonth(selectedDate))\n      refetch({\n        limit: 64,\n        offset: 0,\n        where: {\n          startAtAfter: startAtJST.toISOString(),\n          endAtAfter: endAtJST.toISOString(),\n          isActive: isActive !== undefined ? isActive : undefined,\n          isSensitive:\n            isSensitiveFilter !== undefined ? isSensitiveFilter : undefined,\n        },\n      })\n    }\n  }\n\n  const handleImageUpload = async (\n    event: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    const file = event.target.files?.[0]\n    if (!file) {\n      toast(\"ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    const img = new Image()\n    const reader = new FileReader()\n\n    reader.onload = (e) => {\n      if (e.target) {\n        img.src = e.target.result as string\n        setImageBase64(img.src)\n      }\n    }\n\n    reader.onerror = () => toast(\"ç”»åƒèª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n    reader.readAsDataURL(file)\n  }\n\n  const onUpload = async () => {\n    if (!imageBase64) {\n      toast(\"ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    if (count >= 30) {\n      toast(\n        \"ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸Šé™ã§ã™ã€ä¸‹æ›¸ãã§ä¸€æ™‚æŠ•ç¨¿ã®ã®ã¡ã€æ™‚é–“ã‚’ç½®ã„ã¦ç”»é¢æ›´æ–°ã—ã¦ãã ã•ã„\",\n      )\n      return\n    }\n\n    setIsUploading(true)\n\n    const url = await uploadPublicImage(imageBase64, token?.viewer?.token)\n\n    setIsUploading(false)\n\n    if (url) {\n      setUploadedImageUrls([...uploadedImageUrls, url])\n      setImageBase64(null)\n      setCount(count + 1)\n      setNewAdvertisement({ ...newAdvertisement, imageUrl: url })\n    } else {\n      toast(\"ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n    }\n  }\n\n  const handleUpdate = async () => {\n    if (!editingId) {\n      return\n    }\n\n    try {\n      const selectedDate = new Date(newAdvertisement.startAt)\n      const startAtJST = toJST(startOfMonth(selectedDate))\n      const endAtJST = toJST(endOfMonth(selectedDate))\n\n      await updateAdvertisement({\n        variables: {\n          input: {\n            id: editingId,\n            imageUrl: newAdvertisement.imageUrl,\n            url: newAdvertisement.url,\n            displayProbability: newAdvertisement.displayProbability,\n            page: \"work\",\n            isSensitive: newAdvertisement.isSensitive,\n            isActive: newAdvertisement.isActive,\n            startAt: startAtJST.toISOString(),\n            endAt: endAtJST.toISOString(),\n          },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’æ›´æ–°ã—ã¾ã—ãŸ\", \"Advertisement updated\"))\n      setIsEditing(false)\n      setNewAdvertisement({\n        imageUrl: \"\",\n        url: \"\",\n        displayProbability: 0,\n        isSensitive: false,\n        isActive: false,\n        startAt: \"\",\n        endAt: \"\",\n      })\n      setViewMode(\"list\")\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleDelete = async (id: string) => {\n    try {\n      await deleteAdvertisement({\n        variables: {\n          input: { ids: [id] },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’å‰Šé™¤ã—ã¾ã—ãŸ\", \"Advertisement deleted\"))\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleModeSwitch = (mode: SetStateAction<string>) => {\n    setViewMode(mode)\n    setIsEditing(false)\n    setImageBase64(null)\n    setNewAdvertisement({\n      imageUrl: \"\",\n      url: \"\",\n      displayProbability: 0,\n      isSensitive: false,\n      isActive: false,\n      startAt: new Date().toISOString(),\n      endAt: new Date().toISOString(),\n    })\n  }\n\n  return (\n    <div className=\"w-full space-y-4\">\n      <div className=\"flex justify-between\">\n        <Button\n          disabled={viewMode === \"list\"}\n          onClick={() => handleModeSwitch(\"list\")}\n        >\n          {t(\"åºƒå‘Šä¸€è¦§\", \"Advertisement List\")}\n        </Button>\n        <Button onClick={() => handleModeSwitch(\"create\")}>\n          {t(\"æ–°ã—ã„åºƒå‘Šã‚’ä½œæˆ\", \"Create New Advertisement\")}\n        </Button>\n      </div>\n      {viewMode === \"list\" && (\n        <>\n          <h2>{t(\"åºƒå‘Šè¨­å®šä¸€è¦§\", \"Advertisement Settings List\")}</h2>\n          {loading && <AppLoadingPage />}\n          {error && (\n            <p>\n              {t(\"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ\", \"An error occurred\")}: {error.message}\n            </p>\n          )}\n          <div className=\"flex items-center space-x-2\">\n            <p className=\"w-24\">{t(\"é…ä¿¡æœˆ\", \"Delivery Month\")}ï¼š</p>\n            <Input\n              type=\"month\"\n              value={date ? format(date, \"yyyy-MM\") : \"\"}\n              onChange={(event) => {\n                setDate(new Date(`${event.target.value}-01`))\n              }}\n            />\n            <Button onClick={handleSearch}>{t(\"æ¤œç´¢\", \"Search\")}</Button>\n          </div>\n          <div className=\"flex flex-col space-x-2 space-y-2 md:flex-row\">\n            <div className=\"flex space-x-2\">\n              <div className=\"flex w-24 items-center space-x-2\">\n                <label htmlFor=\"activeFilter\">\n                  {t(\"æœ‰åŠ¹\", \"Active\")}\n                  <Checkbox\n                    id=\"activeFilter\"\n                    checked={isActive === true}\n                    onCheckedChange={(checked) => {\n                      setIsActive(checked === true)\n                    }}\n                  />\n                </label>\n              </div>\n              <div className=\"flex w-40 items-center space-x-2\">\n                <label htmlFor=\"sensitiveFilter\">\n                  {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")}\n                  <Checkbox\n                    id=\"sensitiveFilter\"\n                    checked={isSensitiveFilter === true}\n                    onCheckedChange={(checked) =>\n                      setIsSensitiveFilter(checked === true ? true : undefined)\n                    }\n                  />\n                </label>\n              </div>\n              <div className=\"flex w-40 items-center space-x-2\">\n                <label htmlFor=\"ageFilter\">\n                  {t(\"å…¨å¹´é½¢\", \"All Ages\")}\n                  <Checkbox\n                    id=\"ageFilter\"\n                    checked={isSensitiveFilter === false}\n                    onCheckedChange={(checked) =>\n                      setIsSensitiveFilter(checked === true ? false : undefined)\n                    }\n                  />\n                </label>\n              </div>\n            </div>\n            <Button\n              variant={\"secondary\"}\n              className=\"w-full\"\n              onClick={() => {\n                setIsActive(undefined)\n                setIsSensitiveFilter(undefined)\n              }}\n            >\n              {t(\"ã™ã¹ã¦\", \"All\")}\n            </Button>\n          </div>\n          {/* åºƒå‘Šãƒªã‚¹ãƒˆ */}\n          <Card className=\"space-y-4\">\n            <CardContent className=\"flex flex-col gap-x-2 space-y-2 p-2\">\n              {filteredAdvertisements?.map(\n                (advertisement: FragmentOf<typeof AdvertisementsFragment>) => (\n                  <Card\n                    key={advertisement.id}\n                    className=\"flex items-center justify-between border p-4\"\n                  >\n                    <CardContent className=\"flex flex-col gap-x-2 space-y-2 p-2\">\n                      <div className=\"m-auto max-w-64 space-x-4 text-wrap md:flex md:max-w-full\">\n                        <img\n                          src={advertisement.imageUrl}\n                          alt={t(\"ã‚µãƒ ãƒã‚¤ãƒ«\", \"Thumbnail\")}\n                          className=\"m-auto h-auto w-32\"\n                        />\n                        <div className=\"ml-2 flex flex-col space-y-2\">\n                          <Link\n                            target=\"_blank\"\n                            to={\n                              advertisement.url.startsWith(\"http\")\n                                ? advertisement.url\n                                : `https://${advertisement.url}`\n                            }\n                            className=\"w-64 text-wrap\"\n                          >\n                            {advertisement.url}\n                          </Link>\n                          <p>\n                            {t(\"è¡¨ç¤ºå„ªå…ˆåº¦\", \"Display Priority\")}:{\" \"}\n                            {advertisement.displayProbability}\n                          </p>\n                          <p>\n                            {t(\"è¡¨ç¤ºå›æ•°\", \"View\")}:{\" \"}\n                            {advertisement.impressionCount}\n                          </p>\n                          <p>\n                            {t(\"ã‚¯ãƒªãƒƒã‚¯å›æ•°\", \"Clicked\")}:{\" \"}\n                            {advertisement.clickCount}\n                          </p>\n                          <p>\n                            {t(\"ä½œæˆæ—¥\", \"Created At\")}:{\" \"}\n                            {toDateText(advertisement.createdAt)}\n                          </p>\n                          <p>\n                            {t(\"é…ä¿¡æ—¥\", \"Start At\")}:{\" \"}\n                            {toDateText(advertisement.startAt)}\n                          </p>\n                          <div className=\"mt-2 flex space-x-2\">\n                            <Badge\n                              variant={\n                                advertisement.isActive ? \"default\" : \"secondary\"\n                              }\n                              className=\"w-16 text-center\"\n                            >\n                              <div className=\"m-auto\">\n                                {advertisement.isActive\n                                  ? t(\"å…¬é–‹ä¸­\", \"Active\")\n                                  : t(\"éå…¬é–‹\", \"Inactive\")}\n                              </div>\n                            </Badge>\n                            <Badge\n                              variant={\"secondary\"}\n                              className=\"w-24 text-center\"\n                            >\n                              <div className=\"m-auto\">\n                                {advertisement.isSensitive\n                                  ? t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")\n                                  : t(\"å…¨å¹´é½¢\", \"All Ages\")}\n                              </div>\n                            </Badge>\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"mt-2 flex space-x-2\">\n                        <Button\n                          variant={\"secondary\"}\n                          onClick={() => handleEdit(advertisement)}\n                        >\n                          {t(\"ç·¨é›†\", \"Edit\")}\n                        </Button>\n                        <SettingsAdvertisementsDeleteConfirmDialog\n                          onDelete={async () => handleDelete(advertisement.id)}\n                        />\n                      </div>\n                    </CardContent>\n                  </Card>\n                ),\n              )}\n            </CardContent>\n          </Card>\n        </>\n      )}\n\n      {viewMode === \"create\" && (\n        <>\n          <h2>\n            {isEditing\n              ? t(\"åºƒå‘Šã‚’ç·¨é›†\", \"Edit Advertisement\")\n              : t(\"æ–°ã—ã„åºƒå‘Šã‚’ä½œæˆ\", \"Create New Advertisement\")}\n          </h2>\n          <div className=\"space-y-4\">\n            <p className=\"font-semibold text-sm\">\n              {t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n            </p>\n            {newAdvertisement.imageUrl && (\n              <div className=\"bg-zinc-100 dark:bg-zinc-800\">\n                <img\n                  className=\"m-auto max-h-32\"\n                  src={newAdvertisement.imageUrl}\n                  alt={t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n                />\n              </div>\n            )}\n            {imageBase64 && (\n              <>\n                <p className=\"font-semibold text-xs\">\n                  {t(\"ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼\", \"Preview\")}\n                </p>\n                <div className=\"bg-zinc-100 dark:bg-zinc-800\">\n                  <img\n                    className=\"m-auto max-h-32\"\n                    src={imageBase64}\n                    alt={t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n                  />\n                </div>\n              </>\n            )}\n            <Input\n              placeholder={t(\"ç”»åƒURL\", \"Image URL\")}\n              value={newAdvertisement.imageUrl}\n              onChange={(e) => {\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  imageUrl: e.target.value,\n                })\n                if (e.target.value === \"\") {\n                  setImageBase64(null)\n                }\n              }}\n              onBlur={async (e) => {\n                const imageUrl = e.target.value\n                if (imageUrl === \"\") {\n                  setImageBase64(null)\n                  return\n                }\n\n                try {\n                  const base64 = await getBase64FromImageUrl(imageUrl)\n                  setImageBase64(base64)\n                } catch (error) {\n                  console.error(\"ç”»åƒã®Base64å¤‰æ›ã«å¤±æ•—ã—ã¾ã—ãŸ\", error)\n                }\n              }}\n              disabled={isUploading || imageBase64 !== null}\n            />\n            <p className=\"text-sm opacity-80\">\n              {t(\n                \"â€» å¤–éƒ¨ã®ç”»åƒURLã‚’ç›´æ¥æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½\",\n                \"â€» You can also specify an external image URL directly\",\n              )}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <input\n                type=\"file\"\n                accept=\"image/webp,image/jpeg,image/jpg,image/png\"\n                onChange={handleImageUpload}\n                disabled={isUploading}\n                className=\"w-full\"\n              />\n              <Button\n                variant={\"secondary\"}\n                onClick={() => setImageBase64(null)}\n              >\n                {t(\"é¸æŠã—ãŸç”»åƒã‚’å‰Šé™¤\", \"Remove Selected Image\")}\n              </Button>\n            </div>\n            <Button\n              className=\"w-full items-center\"\n              onClick={onUpload}\n              disabled={!imageBase64 || isUploading}\n            >\n              {isUploading ? (\n                <Loader2Icon className=\"size-4 animate-spin\" />\n              ) : (\n                <p>{t(\"ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰\", \"Upload Image\")}</p>\n              )}\n            </Button>\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"åºƒå‘Šã®é…ä¿¡æœŸé–“ï¼ˆé…ä¿¡æœˆï¼‰\",\n                \"Advertisement Delivery Period (Delivery Month)\",\n              )}\n            </p>\n            <Input\n              type=\"month\"\n              value={format(newAdvertisement.startAt, \"yyyy-MM\")}\n              onChange={(event) => {\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  startAt: new Date(`${event.target.value}-01`).toISOString(),\n                  endAt: endOfMonth(\n                    new Date(`${event.target.value}-01`),\n                  ).toISOString(),\n                })\n              }}\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\"åºƒå‘Šã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸéš›ã®é·ç§»å…ˆ\", \"Link URL When Ad is Clicked\")}\n            </p>\n            <Input\n              placeholder={t(\"ãƒªãƒ³ã‚¯URL\", \"Link URL\")}\n              value={newAdvertisement.url}\n              onChange={(e) =>\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  url: e.target.value,\n                })\n              }\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ã‹ã©ã†ã‹\", \"Is this sensitive content?\")}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"sensitive\"\n                checked={newAdvertisement.isSensitive}\n                onCheckedChange={(checked) => {\n                  if (checked === true) {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isSensitive: true,\n                    })\n                  } else {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isSensitive: false,\n                    })\n                  }\n                }}\n              />\n              <label\n                htmlFor=\"sensitive\"\n                className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n              >\n                {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")}\n              </label>\n            </div>\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"è¡¨ç¤ºã™ã‚‹å„ªå…ˆåº¦ï¼ˆå…¨ä½“ã®æ•°å­—ã§å‡ç­‰å‰²ã‚Šã—ã¦ç¢ºç‡ã‚’ç®—å‡ºã€é«˜ã„ã»ã©ç¢ºç‡ãŒé«˜ããªã‚‹ï¼‰\",\n                \"Display priority (higher numbers increase probability)\",\n              )}\n            </p>\n            <Input\n              placeholder={t(\"è¡¨ç¤ºå„ªå…ˆåº¦\", \"Display Priority\")}\n              type=\"number\"\n              max={1000}\n              value={newAdvertisement.displayProbability}\n              onChange={(e) =>\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  displayProbability: Number.parseFloat(e.target.value),\n                })\n              }\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"æœ‰åŠ¹åŒ–ã•ã‚Œã‚‹ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™\",\n                \"Enabling this will display the ad\",\n              )}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"active\"\n                checked={newAdvertisement.isActive}\n                onCheckedChange={(checked) => {\n                  if (checked === true) {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isActive: true,\n                    })\n                  } else {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isActive: false,\n                    })\n                  }\n                }}\n              />\n              <label\n                htmlFor=\"active\"\n                className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n              >\n                {t(\"æœ‰åŠ¹åŒ–\", \"Active\")}\n              </label>\n            </div>\n            <Button\n              className=\"w-full\"\n              disabled={\n                !newAdvertisement.imageUrl ||\n                !newAdvertisement.url ||\n                isCreating ||\n                isUpdating\n              }\n              onClick={isEditing ? handleUpdate : handleCreate}\n            >\n              {isCreating || isUpdating ? (\n                <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n              ) : isEditing ? (\n                t(\"æ›´æ–°\", \"Update\")\n              ) : (\n                t(\"åºƒå‘Šã‚’ä½œæˆ\", \"Create Advertisement\")\n              )}\n            </Button>\n          </div>\n        </>\n      )}\n    </div>\n  )\n}\n\nexport const AdvertisementsFragment = graphql(\n  `fragment AdvertisementsFields on CustomerAdvertisementNode @_unmask {\n      id\n      imageUrl\n      url\n      displayProbability\n      clickCount\n      impressionCount\n      isSensitive\n      createdAt\n      page\n      startAt\n      endAt\n      isActive\n  }`,\n)\n\n// è‡ªèº«ã®åºƒå‘Šä¸€è¦§ã‚’å–å¾—ã™ã‚‹ã‚¯ã‚¨ãƒª\nconst viewerAdvertisementsQuery = graphql(\n  `query ViewerAdvertisements($limit: Int!, $offset: Int!, $where: CustomerAdvertisementsWhereInput) {\n    viewer {\n      id\n      customerAdvertisements(limit: $limit, offset: $offset, where: $where) {\n        ...AdvertisementsFields\n      }\n    }\n  }`,\n  [AdvertisementsFragment],\n)\n\n// åºƒå‘Šã‚’ä½œæˆã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst createCustomerAdvertisement = graphql(\n  `mutation CreateCustomerAdvertisement($input: CreateCustomerAdvertisement!) {\n    createCustomerAdvertisement(input: $input) {\n      id\n    }\n  }`,\n)\n\n// åºƒå‘Šã‚’æ›´æ–°ã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst updateCustomerAdvertisement = graphql(\n  `mutation UpdateCustomerAdvertisement($input: UpdateCustomerAdvertisement!) {\n    updateCustomerAdvertisement(input: $input) {\n      id\n    }\n  }`,\n)\n\n// åºƒå‘Šã‚’å‰Šé™¤ã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst deleteCustomerAdvertisement = graphql(\n  `mutation DeleteCustomerAdvertisement($input: DeleteCustomerAdvertisementInput!) {\n    deleteCustomerAdvertisement(input: $input)\n  }`,\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst viewerIsAdvertiserQuery = graphql(\n  `query ViewerIsAdvertiser {\n    viewer {\n      isAdvertiser\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable isAdvertiserLoading is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"isAdvertiserLoading"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.advertisements/_components/setting-advertisements-form.tsx"},"span":[1536,1555],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { ApolloError, useMutation, useQuery } from \"@apollo/client/index\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport { type SetStateAction, useContext, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { toDateText } from \"~/utils/to-date-text\"\nimport { addHours, endOfMonth, format, startOfMonth } from \"date-fns\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { Loader2Icon } from \"lucide-react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { getBase64FromImageUrl } from \"~/utils/get-base64-from-image-url\"\nimport { Link } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { SettingsAdvertisementsDeleteConfirmDialog } from \"~/routes/($lang).settings.advertisements/_components/settings-advertisements-delete-confirm-dialog\"\n\n// æ—¥æœ¬æ™‚é–“ (JST) ã«å¤‰æ›ã™ã‚‹ãŸã‚ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°\nconst toJST = (date: Date) => {\n  return addHours(date, 9) // UTCã«å¯¾ã—ã¦+9æ™‚é–“ã§JSTã«å¤‰æ›\n}\n\nexport function SettingAdvertisementsForm () {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const { data: isAdvertiser, loading: isAdvertiserLoading } = useQuery(\n    viewerIsAdvertiserQuery,\n  )\n\n  if (isAdvertiser?.viewer?.isAdvertiser === false) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const [newAdvertisement, setNewAdvertisement] = useState({\n    imageUrl: \"\",\n    url: \"\",\n    displayProbability: 0,\n    isSensitive: false,\n    isActive: false,\n    startAt: \"\",\n    endAt: \"\",\n  })\n\n  const { data: token } = useQuery(viewerTokenQuery, {\n    skip: authContext.isLoading,\n  })\n  const [date, setDate] = useState<Date | null>(null)\n\n  const [isActive, setIsActive] = useState<boolean | undefined>(undefined)\n\n  const [isSensitiveFilter, setIsSensitiveFilter] = useState<\n    boolean | undefined\n  >(undefined)\n\n  const [isEditing, setIsEditing] = useState(false)\n\n  const [editingId, setEditingId] = useState<string | null>(null)\n\n  const [viewMode, setViewMode] = useState(\"list\") // åˆ‡ã‚Šæ›¿ãˆç”¨\n\n  const { data, loading, error, refetch } = useQuery(\n    viewerAdvertisementsQuery,\n    {\n      skip: authContext.isLoading,\n      variables: {\n        limit: 64,\n        offset: 0,\n      },\n    },\n  )\n\n  const [uploadedImageUrls, setUploadedImageUrls] = useState<string[]>([])\n\n  const [count, setCount] = useState(0)\n\n  const [imageBase64, setImageBase64] = useState<string | null>(null)\n\n  const [isUploading, setIsUploading] = useState(false)\n\n  const [createAdvertisement, { loading: isCreating }] = useMutation(\n    createCustomerAdvertisement,\n  )\n\n  const [updateAdvertisement, { loading: isUpdating }] = useMutation(\n    updateCustomerAdvertisement,\n  )\n\n  const [deleteAdvertisement, { loading: isDeleting }] = useMutation(\n    deleteCustomerAdvertisement,\n  )\n\n  // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãŸåºƒå‘Šãƒªã‚¹ãƒˆã‚’ç”Ÿæˆã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯\n  const filteredAdvertisements = data?.viewer?.customerAdvertisements.filter(\n    (advertisement) => {\n      const isActiveMatch =\n        isActive === undefined || advertisement.isActive === isActive\n      const isSensitiveMatch =\n        isSensitiveFilter === undefined ||\n        advertisement.isSensitive === isSensitiveFilter\n      return isActiveMatch && isSensitiveMatch\n    },\n  )\n\n  const handleCreate = async () => {\n    try {\n      if (!newAdvertisement.imageUrl || !newAdvertisement.url) {\n        toast(\n          t(\n            \"ç”»åƒURLã¨ãƒªãƒ³ã‚¯URLã¯å¿…é ˆã§ã™\",\n            \"Image URL and Link URL are required\",\n          ),\n        )\n        return\n      }\n\n      const selectedDate = new Date(newAdvertisement.startAt)\n\n      const startAtJST = toJST(startOfMonth(selectedDate))\n\n      const endAtJST = toJST(endOfMonth(selectedDate))\n\n      await createAdvertisement({\n        variables: {\n          input: {\n            imageUrl: newAdvertisement.imageUrl,\n            url: newAdvertisement.url,\n            displayProbability: newAdvertisement.displayProbability,\n            page: \"work\",\n            isSensitive: newAdvertisement.isSensitive,\n            isActive: newAdvertisement.isActive,\n            startAt: startAtJST.toISOString(),\n            endAt: endAtJST.toISOString(),\n          },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’ä½œæˆã—ã¾ã—ãŸ\", \"Advertisement created\"))\n      setViewMode(\"list\")\n      setIsEditing(false)\n\n      refetch({\n        limit: 64,\n        offset: 0,\n      })\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleEdit = (\n    advertisement: FragmentOf<typeof AdvertisementsFragment>,\n  ) => {\n    setNewAdvertisement({\n      imageUrl: advertisement.imageUrl,\n      url: advertisement.url,\n      displayProbability: advertisement.displayProbability,\n      isSensitive: advertisement.isSensitive,\n      isActive: advertisement.isActive,\n      startAt: startOfMonth(\n        new Date(advertisement.startAt * 1000),\n      ).toISOString(),\n      endAt: endOfMonth(new Date(advertisement.endAt * 1000)).toISOString(),\n    })\n    setIsEditing(true)\n    setEditingId(advertisement.id)\n    setViewMode(\"create\") // ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ\n  }\n\n  // å†ãƒ•ã‚§ãƒƒãƒã§æ¤œç´¢ã‚’å®Ÿè¡Œ\n  const handleSearch = () => {\n    if (date) {\n      const selectedDate = date\n      const startAtJST = toJST(startOfMonth(selectedDate))\n      const endAtJST = toJST(endOfMonth(selectedDate))\n      refetch({\n        limit: 64,\n        offset: 0,\n        where: {\n          startAtAfter: startAtJST.toISOString(),\n          endAtAfter: endAtJST.toISOString(),\n          isActive: isActive !== undefined ? isActive : undefined,\n          isSensitive:\n            isSensitiveFilter !== undefined ? isSensitiveFilter : undefined,\n        },\n      })\n    }\n  }\n\n  const handleImageUpload = async (\n    event: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    const file = event.target.files?.[0]\n    if (!file) {\n      toast(\"ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    const img = new Image()\n    const reader = new FileReader()\n\n    reader.onload = (e) => {\n      if (e.target) {\n        img.src = e.target.result as string\n        setImageBase64(img.src)\n      }\n    }\n\n    reader.onerror = () => toast(\"ç”»åƒèª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n    reader.readAsDataURL(file)\n  }\n\n  const onUpload = async () => {\n    if (!imageBase64) {\n      toast(\"ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    if (count >= 30) {\n      toast(\n        \"ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸Šé™ã§ã™ã€ä¸‹æ›¸ãã§ä¸€æ™‚æŠ•ç¨¿ã®ã®ã¡ã€æ™‚é–“ã‚’ç½®ã„ã¦ç”»é¢æ›´æ–°ã—ã¦ãã ã•ã„\",\n      )\n      return\n    }\n\n    setIsUploading(true)\n\n    const url = await uploadPublicImage(imageBase64, token?.viewer?.token)\n\n    setIsUploading(false)\n\n    if (url) {\n      setUploadedImageUrls([...uploadedImageUrls, url])\n      setImageBase64(null)\n      setCount(count + 1)\n      setNewAdvertisement({ ...newAdvertisement, imageUrl: url })\n    } else {\n      toast(\"ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n    }\n  }\n\n  const handleUpdate = async () => {\n    if (!editingId) {\n      return\n    }\n\n    try {\n      const selectedDate = new Date(newAdvertisement.startAt)\n      const startAtJST = toJST(startOfMonth(selectedDate))\n      const endAtJST = toJST(endOfMonth(selectedDate))\n\n      await updateAdvertisement({\n        variables: {\n          input: {\n            id: editingId,\n            imageUrl: newAdvertisement.imageUrl,\n            url: newAdvertisement.url,\n            displayProbability: newAdvertisement.displayProbability,\n            page: \"work\",\n            isSensitive: newAdvertisement.isSensitive,\n            isActive: newAdvertisement.isActive,\n            startAt: startAtJST.toISOString(),\n            endAt: endAtJST.toISOString(),\n          },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’æ›´æ–°ã—ã¾ã—ãŸ\", \"Advertisement updated\"))\n      setIsEditing(false)\n      setNewAdvertisement({\n        imageUrl: \"\",\n        url: \"\",\n        displayProbability: 0,\n        isSensitive: false,\n        isActive: false,\n        startAt: \"\",\n        endAt: \"\",\n      })\n      setViewMode(\"list\")\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleDelete = async (id: string) => {\n    try {\n      await deleteAdvertisement({\n        variables: {\n          input: { ids: [id] },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’å‰Šé™¤ã—ã¾ã—ãŸ\", \"Advertisement deleted\"))\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleModeSwitch = (mode: SetStateAction<string>) => {\n    setViewMode(mode)\n    setIsEditing(false)\n    setImageBase64(null)\n    setNewAdvertisement({\n      imageUrl: \"\",\n      url: \"\",\n      displayProbability: 0,\n      isSensitive: false,\n      isActive: false,\n      startAt: new Date().toISOString(),\n      endAt: new Date().toISOString(),\n    })\n  }\n\n  return (\n    <div className=\"w-full space-y-4\">\n      <div className=\"flex justify-between\">\n        <Button\n          disabled={viewMode === \"list\"}\n          onClick={() => handleModeSwitch(\"list\")}\n        >\n          {t(\"åºƒå‘Šä¸€è¦§\", \"Advertisement List\")}\n        </Button>\n        <Button onClick={() => handleModeSwitch(\"create\")}>\n          {t(\"æ–°ã—ã„åºƒå‘Šã‚’ä½œæˆ\", \"Create New Advertisement\")}\n        </Button>\n      </div>\n      {viewMode === \"list\" && (\n        <>\n          <h2>{t(\"åºƒå‘Šè¨­å®šä¸€è¦§\", \"Advertisement Settings List\")}</h2>\n          {loading && <AppLoadingPage />}\n          {error && (\n            <p>\n              {t(\"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ\", \"An error occurred\")}: {error.message}\n            </p>\n          )}\n          <div className=\"flex items-center space-x-2\">\n            <p className=\"w-24\">{t(\"é…ä¿¡æœˆ\", \"Delivery Month\")}ï¼š</p>\n            <Input\n              type=\"month\"\n              value={date ? format(date, \"yyyy-MM\") : \"\"}\n              onChange={(event) => {\n                setDate(new Date(`${event.target.value}-01`))\n              }}\n            />\n            <Button onClick={handleSearch}>{t(\"æ¤œç´¢\", \"Search\")}</Button>\n          </div>\n          <div className=\"flex flex-col space-x-2 space-y-2 md:flex-row\">\n            <div className=\"flex space-x-2\">\n              <div className=\"flex w-24 items-center space-x-2\">\n                <label htmlFor=\"activeFilter\">\n                  {t(\"æœ‰åŠ¹\", \"Active\")}\n                  <Checkbox\n                    id=\"activeFilter\"\n                    checked={isActive === true}\n                    onCheckedChange={(checked) => {\n                      setIsActive(checked === true)\n                    }}\n                  />\n                </label>\n              </div>\n              <div className=\"flex w-40 items-center space-x-2\">\n                <label htmlFor=\"sensitiveFilter\">\n                  {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")}\n                  <Checkbox\n                    id=\"sensitiveFilter\"\n                    checked={isSensitiveFilter === true}\n                    onCheckedChange={(checked) =>\n                      setIsSensitiveFilter(checked === true ? true : undefined)\n                    }\n                  />\n                </label>\n              </div>\n              <div className=\"flex w-40 items-center space-x-2\">\n                <label htmlFor=\"ageFilter\">\n                  {t(\"å…¨å¹´é½¢\", \"All Ages\")}\n                  <Checkbox\n                    id=\"ageFilter\"\n                    checked={isSensitiveFilter === false}\n                    onCheckedChange={(checked) =>\n                      setIsSensitiveFilter(checked === true ? false : undefined)\n                    }\n                  />\n                </label>\n              </div>\n            </div>\n            <Button\n              variant={\"secondary\"}\n              className=\"w-full\"\n              onClick={() => {\n                setIsActive(undefined)\n                setIsSensitiveFilter(undefined)\n              }}\n            >\n              {t(\"ã™ã¹ã¦\", \"All\")}\n            </Button>\n          </div>\n          {/* åºƒå‘Šãƒªã‚¹ãƒˆ */}\n          <Card className=\"space-y-4\">\n            <CardContent className=\"flex flex-col gap-x-2 space-y-2 p-2\">\n              {filteredAdvertisements?.map(\n                (advertisement: FragmentOf<typeof AdvertisementsFragment>) => (\n                  <Card\n                    key={advertisement.id}\n                    className=\"flex items-center justify-between border p-4\"\n                  >\n                    <CardContent className=\"flex flex-col gap-x-2 space-y-2 p-2\">\n                      <div className=\"m-auto max-w-64 space-x-4 text-wrap md:flex md:max-w-full\">\n                        <img\n                          src={advertisement.imageUrl}\n                          alt={t(\"ã‚µãƒ ãƒã‚¤ãƒ«\", \"Thumbnail\")}\n                          className=\"m-auto h-auto w-32\"\n                        />\n                        <div className=\"ml-2 flex flex-col space-y-2\">\n                          <Link\n                            target=\"_blank\"\n                            to={\n                              advertisement.url.startsWith(\"http\")\n                                ? advertisement.url\n                                : `https://${advertisement.url}`\n                            }\n                            className=\"w-64 text-wrap\"\n                          >\n                            {advertisement.url}\n                          </Link>\n                          <p>\n                            {t(\"è¡¨ç¤ºå„ªå…ˆåº¦\", \"Display Priority\")}:{\" \"}\n                            {advertisement.displayProbability}\n                          </p>\n                          <p>\n                            {t(\"è¡¨ç¤ºå›æ•°\", \"View\")}:{\" \"}\n                            {advertisement.impressionCount}\n                          </p>\n                          <p>\n                            {t(\"ã‚¯ãƒªãƒƒã‚¯å›æ•°\", \"Clicked\")}:{\" \"}\n                            {advertisement.clickCount}\n                          </p>\n                          <p>\n                            {t(\"ä½œæˆæ—¥\", \"Created At\")}:{\" \"}\n                            {toDateText(advertisement.createdAt)}\n                          </p>\n                          <p>\n                            {t(\"é…ä¿¡æ—¥\", \"Start At\")}:{\" \"}\n                            {toDateText(advertisement.startAt)}\n                          </p>\n                          <div className=\"mt-2 flex space-x-2\">\n                            <Badge\n                              variant={\n                                advertisement.isActive ? \"default\" : \"secondary\"\n                              }\n                              className=\"w-16 text-center\"\n                            >\n                              <div className=\"m-auto\">\n                                {advertisement.isActive\n                                  ? t(\"å…¬é–‹ä¸­\", \"Active\")\n                                  : t(\"éå…¬é–‹\", \"Inactive\")}\n                              </div>\n                            </Badge>\n                            <Badge\n                              variant={\"secondary\"}\n                              className=\"w-24 text-center\"\n                            >\n                              <div className=\"m-auto\">\n                                {advertisement.isSensitive\n                                  ? t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")\n                                  : t(\"å…¨å¹´é½¢\", \"All Ages\")}\n                              </div>\n                            </Badge>\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"mt-2 flex space-x-2\">\n                        <Button\n                          variant={\"secondary\"}\n                          onClick={() => handleEdit(advertisement)}\n                        >\n                          {t(\"ç·¨é›†\", \"Edit\")}\n                        </Button>\n                        <SettingsAdvertisementsDeleteConfirmDialog\n                          onDelete={async () => handleDelete(advertisement.id)}\n                        />\n                      </div>\n                    </CardContent>\n                  </Card>\n                ),\n              )}\n            </CardContent>\n          </Card>\n        </>\n      )}\n\n      {viewMode === \"create\" && (\n        <>\n          <h2>\n            {isEditing\n              ? t(\"åºƒå‘Šã‚’ç·¨é›†\", \"Edit Advertisement\")\n              : t(\"æ–°ã—ã„åºƒå‘Šã‚’ä½œæˆ\", \"Create New Advertisement\")}\n          </h2>\n          <div className=\"space-y-4\">\n            <p className=\"font-semibold text-sm\">\n              {t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n            </p>\n            {newAdvertisement.imageUrl && (\n              <div className=\"bg-zinc-100 dark:bg-zinc-800\">\n                <img\n                  className=\"m-auto max-h-32\"\n                  src={newAdvertisement.imageUrl}\n                  alt={t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n                />\n              </div>\n            )}\n            {imageBase64 && (\n              <>\n                <p className=\"font-semibold text-xs\">\n                  {t(\"ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼\", \"Preview\")}\n                </p>\n                <div className=\"bg-zinc-100 dark:bg-zinc-800\">\n                  <img\n                    className=\"m-auto max-h-32\"\n                    src={imageBase64}\n                    alt={t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n                  />\n                </div>\n              </>\n            )}\n            <Input\n              placeholder={t(\"ç”»åƒURL\", \"Image URL\")}\n              value={newAdvertisement.imageUrl}\n              onChange={(e) => {\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  imageUrl: e.target.value,\n                })\n                if (e.target.value === \"\") {\n                  setImageBase64(null)\n                }\n              }}\n              onBlur={async (e) => {\n                const imageUrl = e.target.value\n                if (imageUrl === \"\") {\n                  setImageBase64(null)\n                  return\n                }\n\n                try {\n                  const base64 = await getBase64FromImageUrl(imageUrl)\n                  setImageBase64(base64)\n                } catch (error) {\n                  console.error(\"ç”»åƒã®Base64å¤‰æ›ã«å¤±æ•—ã—ã¾ã—ãŸ\", error)\n                }\n              }}\n              disabled={isUploading || imageBase64 !== null}\n            />\n            <p className=\"text-sm opacity-80\">\n              {t(\n                \"â€» å¤–éƒ¨ã®ç”»åƒURLã‚’ç›´æ¥æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½\",\n                \"â€» You can also specify an external image URL directly\",\n              )}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <input\n                type=\"file\"\n                accept=\"image/webp,image/jpeg,image/jpg,image/png\"\n                onChange={handleImageUpload}\n                disabled={isUploading}\n                className=\"w-full\"\n              />\n              <Button\n                variant={\"secondary\"}\n                onClick={() => setImageBase64(null)}\n              >\n                {t(\"é¸æŠã—ãŸç”»åƒã‚’å‰Šé™¤\", \"Remove Selected Image\")}\n              </Button>\n            </div>\n            <Button\n              className=\"w-full items-center\"\n              onClick={onUpload}\n              disabled={!imageBase64 || isUploading}\n            >\n              {isUploading ? (\n                <Loader2Icon className=\"size-4 animate-spin\" />\n              ) : (\n                <p>{t(\"ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰\", \"Upload Image\")}</p>\n              )}\n            </Button>\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"åºƒå‘Šã®é…ä¿¡æœŸé–“ï¼ˆé…ä¿¡æœˆï¼‰\",\n                \"Advertisement Delivery Period (Delivery Month)\",\n              )}\n            </p>\n            <Input\n              type=\"month\"\n              value={format(newAdvertisement.startAt, \"yyyy-MM\")}\n              onChange={(event) => {\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  startAt: new Date(`${event.target.value}-01`).toISOString(),\n                  endAt: endOfMonth(\n                    new Date(`${event.target.value}-01`),\n                  ).toISOString(),\n                })\n              }}\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\"åºƒå‘Šã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸéš›ã®é·ç§»å…ˆ\", \"Link URL When Ad is Clicked\")}\n            </p>\n            <Input\n              placeholder={t(\"ãƒªãƒ³ã‚¯URL\", \"Link URL\")}\n              value={newAdvertisement.url}\n              onChange={(e) =>\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  url: e.target.value,\n                })\n              }\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ã‹ã©ã†ã‹\", \"Is this sensitive content?\")}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"sensitive\"\n                checked={newAdvertisement.isSensitive}\n                onCheckedChange={(checked) => {\n                  if (checked === true) {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isSensitive: true,\n                    })\n                  } else {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isSensitive: false,\n                    })\n                  }\n                }}\n              />\n              <label\n                htmlFor=\"sensitive\"\n                className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n              >\n                {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")}\n              </label>\n            </div>\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"è¡¨ç¤ºã™ã‚‹å„ªå…ˆåº¦ï¼ˆå…¨ä½“ã®æ•°å­—ã§å‡ç­‰å‰²ã‚Šã—ã¦ç¢ºç‡ã‚’ç®—å‡ºã€é«˜ã„ã»ã©ç¢ºç‡ãŒé«˜ããªã‚‹ï¼‰\",\n                \"Display priority (higher numbers increase probability)\",\n              )}\n            </p>\n            <Input\n              placeholder={t(\"è¡¨ç¤ºå„ªå…ˆåº¦\", \"Display Priority\")}\n              type=\"number\"\n              max={1000}\n              value={newAdvertisement.displayProbability}\n              onChange={(e) =>\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  displayProbability: Number.parseFloat(e.target.value),\n                })\n              }\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"æœ‰åŠ¹åŒ–ã•ã‚Œã‚‹ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™\",\n                \"Enabling this will display the ad\",\n              )}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"active\"\n                checked={newAdvertisement.isActive}\n                onCheckedChange={(checked) => {\n                  if (checked === true) {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isActive: true,\n                    })\n                  } else {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isActive: false,\n                    })\n                  }\n                }}\n              />\n              <label\n                htmlFor=\"active\"\n                className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n              >\n                {t(\"æœ‰åŠ¹åŒ–\", \"Active\")}\n              </label>\n            </div>\n            <Button\n              className=\"w-full\"\n              disabled={\n                !newAdvertisement.imageUrl ||\n                !newAdvertisement.url ||\n                isCreating ||\n                isUpdating\n              }\n              onClick={isEditing ? handleUpdate : handleCreate}\n            >\n              {isCreating || isUpdating ? (\n                <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n              ) : isEditing ? (\n                t(\"æ›´æ–°\", \"Update\")\n              ) : (\n                t(\"åºƒå‘Šã‚’ä½œæˆ\", \"Create Advertisement\")\n              )}\n            </Button>\n          </div>\n        </>\n      )}\n    </div>\n  )\n}\n\nexport const AdvertisementsFragment = graphql(\n  `fragment AdvertisementsFields on CustomerAdvertisementNode @_unmask {\n      id\n      imageUrl\n      url\n      displayProbability\n      clickCount\n      impressionCount\n      isSensitive\n      createdAt\n      page\n      startAt\n      endAt\n      isActive\n  }`,\n)\n\n// è‡ªèº«ã®åºƒå‘Šä¸€è¦§ã‚’å–å¾—ã™ã‚‹ã‚¯ã‚¨ãƒª\nconst viewerAdvertisementsQuery = graphql(\n  `query ViewerAdvertisements($limit: Int!, $offset: Int!, $where: CustomerAdvertisementsWhereInput) {\n    viewer {\n      id\n      customerAdvertisements(limit: $limit, offset: $offset, where: $where) {\n        ...AdvertisementsFields\n      }\n    }\n  }`,\n  [AdvertisementsFragment],\n)\n\n// åºƒå‘Šã‚’ä½œæˆã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst createCustomerAdvertisement = graphql(\n  `mutation CreateCustomerAdvertisement($input: CreateCustomerAdvertisement!) {\n    createCustomerAdvertisement(input: $input) {\n      id\n    }\n  }`,\n)\n\n// åºƒå‘Šã‚’æ›´æ–°ã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst updateCustomerAdvertisement = graphql(\n  `mutation UpdateCustomerAdvertisement($input: UpdateCustomerAdvertisement!) {\n    updateCustomerAdvertisement(input: $input) {\n      id\n    }\n  }`,\n)\n\n// åºƒå‘Šã‚’å‰Šé™¤ã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst deleteCustomerAdvertisement = graphql(\n  `mutation DeleteCustomerAdvertisement($input: DeleteCustomerAdvertisementInput!) {\n    deleteCustomerAdvertisement(input: $input)\n  }`,\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst viewerIsAdvertiserQuery = graphql(\n  `query ViewerIsAdvertiser {\n    viewer {\n      isAdvertiser\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable isDeleting is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"isDeleting"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.advertisements/_components/setting-advertisements-form.tsx"},"span":[3134,3144],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { ApolloError, useMutation, useQuery } from \"@apollo/client/index\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport { type SetStateAction, useContext, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { toDateText } from \"~/utils/to-date-text\"\nimport { addHours, endOfMonth, format, startOfMonth } from \"date-fns\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { Loader2Icon } from \"lucide-react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { getBase64FromImageUrl } from \"~/utils/get-base64-from-image-url\"\nimport { Link } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { SettingsAdvertisementsDeleteConfirmDialog } from \"~/routes/($lang).settings.advertisements/_components/settings-advertisements-delete-confirm-dialog\"\n\n// æ—¥æœ¬æ™‚é–“ (JST) ã«å¤‰æ›ã™ã‚‹ãŸã‚ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°\nconst toJST = (date: Date) => {\n  return addHours(date, 9) // UTCã«å¯¾ã—ã¦+9æ™‚é–“ã§JSTã«å¤‰æ›\n}\n\nexport function SettingAdvertisementsForm () {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const { data: isAdvertiser, loading: isAdvertiserLoading } = useQuery(\n    viewerIsAdvertiserQuery,\n  )\n\n  if (isAdvertiser?.viewer?.isAdvertiser === false) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const [newAdvertisement, setNewAdvertisement] = useState({\n    imageUrl: \"\",\n    url: \"\",\n    displayProbability: 0,\n    isSensitive: false,\n    isActive: false,\n    startAt: \"\",\n    endAt: \"\",\n  })\n\n  const { data: token } = useQuery(viewerTokenQuery, {\n    skip: authContext.isLoading,\n  })\n  const [date, setDate] = useState<Date | null>(null)\n\n  const [isActive, setIsActive] = useState<boolean | undefined>(undefined)\n\n  const [isSensitiveFilter, setIsSensitiveFilter] = useState<\n    boolean | undefined\n  >(undefined)\n\n  const [isEditing, setIsEditing] = useState(false)\n\n  const [editingId, setEditingId] = useState<string | null>(null)\n\n  const [viewMode, setViewMode] = useState(\"list\") // åˆ‡ã‚Šæ›¿ãˆç”¨\n\n  const { data, loading, error, refetch } = useQuery(\n    viewerAdvertisementsQuery,\n    {\n      skip: authContext.isLoading,\n      variables: {\n        limit: 64,\n        offset: 0,\n      },\n    },\n  )\n\n  const [uploadedImageUrls, setUploadedImageUrls] = useState<string[]>([])\n\n  const [count, setCount] = useState(0)\n\n  const [imageBase64, setImageBase64] = useState<string | null>(null)\n\n  const [isUploading, setIsUploading] = useState(false)\n\n  const [createAdvertisement, { loading: isCreating }] = useMutation(\n    createCustomerAdvertisement,\n  )\n\n  const [updateAdvertisement, { loading: isUpdating }] = useMutation(\n    updateCustomerAdvertisement,\n  )\n\n  const [deleteAdvertisement, { loading: isDeleting }] = useMutation(\n    deleteCustomerAdvertisement,\n  )\n\n  // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãŸåºƒå‘Šãƒªã‚¹ãƒˆã‚’ç”Ÿæˆã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯\n  const filteredAdvertisements = data?.viewer?.customerAdvertisements.filter(\n    (advertisement) => {\n      const isActiveMatch =\n        isActive === undefined || advertisement.isActive === isActive\n      const isSensitiveMatch =\n        isSensitiveFilter === undefined ||\n        advertisement.isSensitive === isSensitiveFilter\n      return isActiveMatch && isSensitiveMatch\n    },\n  )\n\n  const handleCreate = async () => {\n    try {\n      if (!newAdvertisement.imageUrl || !newAdvertisement.url) {\n        toast(\n          t(\n            \"ç”»åƒURLã¨ãƒªãƒ³ã‚¯URLã¯å¿…é ˆã§ã™\",\n            \"Image URL and Link URL are required\",\n          ),\n        )\n        return\n      }\n\n      const selectedDate = new Date(newAdvertisement.startAt)\n\n      const startAtJST = toJST(startOfMonth(selectedDate))\n\n      const endAtJST = toJST(endOfMonth(selectedDate))\n\n      await createAdvertisement({\n        variables: {\n          input: {\n            imageUrl: newAdvertisement.imageUrl,\n            url: newAdvertisement.url,\n            displayProbability: newAdvertisement.displayProbability,\n            page: \"work\",\n            isSensitive: newAdvertisement.isSensitive,\n            isActive: newAdvertisement.isActive,\n            startAt: startAtJST.toISOString(),\n            endAt: endAtJST.toISOString(),\n          },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’ä½œæˆã—ã¾ã—ãŸ\", \"Advertisement created\"))\n      setViewMode(\"list\")\n      setIsEditing(false)\n\n      refetch({\n        limit: 64,\n        offset: 0,\n      })\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleEdit = (\n    advertisement: FragmentOf<typeof AdvertisementsFragment>,\n  ) => {\n    setNewAdvertisement({\n      imageUrl: advertisement.imageUrl,\n      url: advertisement.url,\n      displayProbability: advertisement.displayProbability,\n      isSensitive: advertisement.isSensitive,\n      isActive: advertisement.isActive,\n      startAt: startOfMonth(\n        new Date(advertisement.startAt * 1000),\n      ).toISOString(),\n      endAt: endOfMonth(new Date(advertisement.endAt * 1000)).toISOString(),\n    })\n    setIsEditing(true)\n    setEditingId(advertisement.id)\n    setViewMode(\"create\") // ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ\n  }\n\n  // å†ãƒ•ã‚§ãƒƒãƒã§æ¤œç´¢ã‚’å®Ÿè¡Œ\n  const handleSearch = () => {\n    if (date) {\n      const selectedDate = date\n      const startAtJST = toJST(startOfMonth(selectedDate))\n      const endAtJST = toJST(endOfMonth(selectedDate))\n      refetch({\n        limit: 64,\n        offset: 0,\n        where: {\n          startAtAfter: startAtJST.toISOString(),\n          endAtAfter: endAtJST.toISOString(),\n          isActive: isActive !== undefined ? isActive : undefined,\n          isSensitive:\n            isSensitiveFilter !== undefined ? isSensitiveFilter : undefined,\n        },\n      })\n    }\n  }\n\n  const handleImageUpload = async (\n    event: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    const file = event.target.files?.[0]\n    if (!file) {\n      toast(\"ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    const img = new Image()\n    const reader = new FileReader()\n\n    reader.onload = (e) => {\n      if (e.target) {\n        img.src = e.target.result as string\n        setImageBase64(img.src)\n      }\n    }\n\n    reader.onerror = () => toast(\"ç”»åƒèª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n    reader.readAsDataURL(file)\n  }\n\n  const onUpload = async () => {\n    if (!imageBase64) {\n      toast(\"ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    if (count >= 30) {\n      toast(\n        \"ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸Šé™ã§ã™ã€ä¸‹æ›¸ãã§ä¸€æ™‚æŠ•ç¨¿ã®ã®ã¡ã€æ™‚é–“ã‚’ç½®ã„ã¦ç”»é¢æ›´æ–°ã—ã¦ãã ã•ã„\",\n      )\n      return\n    }\n\n    setIsUploading(true)\n\n    const url = await uploadPublicImage(imageBase64, token?.viewer?.token)\n\n    setIsUploading(false)\n\n    if (url) {\n      setUploadedImageUrls([...uploadedImageUrls, url])\n      setImageBase64(null)\n      setCount(count + 1)\n      setNewAdvertisement({ ...newAdvertisement, imageUrl: url })\n    } else {\n      toast(\"ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n    }\n  }\n\n  const handleUpdate = async () => {\n    if (!editingId) {\n      return\n    }\n\n    try {\n      const selectedDate = new Date(newAdvertisement.startAt)\n      const startAtJST = toJST(startOfMonth(selectedDate))\n      const endAtJST = toJST(endOfMonth(selectedDate))\n\n      await updateAdvertisement({\n        variables: {\n          input: {\n            id: editingId,\n            imageUrl: newAdvertisement.imageUrl,\n            url: newAdvertisement.url,\n            displayProbability: newAdvertisement.displayProbability,\n            page: \"work\",\n            isSensitive: newAdvertisement.isSensitive,\n            isActive: newAdvertisement.isActive,\n            startAt: startAtJST.toISOString(),\n            endAt: endAtJST.toISOString(),\n          },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’æ›´æ–°ã—ã¾ã—ãŸ\", \"Advertisement updated\"))\n      setIsEditing(false)\n      setNewAdvertisement({\n        imageUrl: \"\",\n        url: \"\",\n        displayProbability: 0,\n        isSensitive: false,\n        isActive: false,\n        startAt: \"\",\n        endAt: \"\",\n      })\n      setViewMode(\"list\")\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleDelete = async (id: string) => {\n    try {\n      await deleteAdvertisement({\n        variables: {\n          input: { ids: [id] },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’å‰Šé™¤ã—ã¾ã—ãŸ\", \"Advertisement deleted\"))\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleModeSwitch = (mode: SetStateAction<string>) => {\n    setViewMode(mode)\n    setIsEditing(false)\n    setImageBase64(null)\n    setNewAdvertisement({\n      imageUrl: \"\",\n      url: \"\",\n      displayProbability: 0,\n      isSensitive: false,\n      isActive: false,\n      startAt: new Date().toISOString(),\n      endAt: new Date().toISOString(),\n    })\n  }\n\n  return (\n    <div className=\"w-full space-y-4\">\n      <div className=\"flex justify-between\">\n        <Button\n          disabled={viewMode === \"list\"}\n          onClick={() => handleModeSwitch(\"list\")}\n        >\n          {t(\"åºƒå‘Šä¸€è¦§\", \"Advertisement List\")}\n        </Button>\n        <Button onClick={() => handleModeSwitch(\"create\")}>\n          {t(\"æ–°ã—ã„åºƒå‘Šã‚’ä½œæˆ\", \"Create New Advertisement\")}\n        </Button>\n      </div>\n      {viewMode === \"list\" && (\n        <>\n          <h2>{t(\"åºƒå‘Šè¨­å®šä¸€è¦§\", \"Advertisement Settings List\")}</h2>\n          {loading && <AppLoadingPage />}\n          {error && (\n            <p>\n              {t(\"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ\", \"An error occurred\")}: {error.message}\n            </p>\n          )}\n          <div className=\"flex items-center space-x-2\">\n            <p className=\"w-24\">{t(\"é…ä¿¡æœˆ\", \"Delivery Month\")}ï¼š</p>\n            <Input\n              type=\"month\"\n              value={date ? format(date, \"yyyy-MM\") : \"\"}\n              onChange={(event) => {\n                setDate(new Date(`${event.target.value}-01`))\n              }}\n            />\n            <Button onClick={handleSearch}>{t(\"æ¤œç´¢\", \"Search\")}</Button>\n          </div>\n          <div className=\"flex flex-col space-x-2 space-y-2 md:flex-row\">\n            <div className=\"flex space-x-2\">\n              <div className=\"flex w-24 items-center space-x-2\">\n                <label htmlFor=\"activeFilter\">\n                  {t(\"æœ‰åŠ¹\", \"Active\")}\n                  <Checkbox\n                    id=\"activeFilter\"\n                    checked={isActive === true}\n                    onCheckedChange={(checked) => {\n                      setIsActive(checked === true)\n                    }}\n                  />\n                </label>\n              </div>\n              <div className=\"flex w-40 items-center space-x-2\">\n                <label htmlFor=\"sensitiveFilter\">\n                  {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")}\n                  <Checkbox\n                    id=\"sensitiveFilter\"\n                    checked={isSensitiveFilter === true}\n                    onCheckedChange={(checked) =>\n                      setIsSensitiveFilter(checked === true ? true : undefined)\n                    }\n                  />\n                </label>\n              </div>\n              <div className=\"flex w-40 items-center space-x-2\">\n                <label htmlFor=\"ageFilter\">\n                  {t(\"å…¨å¹´é½¢\", \"All Ages\")}\n                  <Checkbox\n                    id=\"ageFilter\"\n                    checked={isSensitiveFilter === false}\n                    onCheckedChange={(checked) =>\n                      setIsSensitiveFilter(checked === true ? false : undefined)\n                    }\n                  />\n                </label>\n              </div>\n            </div>\n            <Button\n              variant={\"secondary\"}\n              className=\"w-full\"\n              onClick={() => {\n                setIsActive(undefined)\n                setIsSensitiveFilter(undefined)\n              }}\n            >\n              {t(\"ã™ã¹ã¦\", \"All\")}\n            </Button>\n          </div>\n          {/* åºƒå‘Šãƒªã‚¹ãƒˆ */}\n          <Card className=\"space-y-4\">\n            <CardContent className=\"flex flex-col gap-x-2 space-y-2 p-2\">\n              {filteredAdvertisements?.map(\n                (advertisement: FragmentOf<typeof AdvertisementsFragment>) => (\n                  <Card\n                    key={advertisement.id}\n                    className=\"flex items-center justify-between border p-4\"\n                  >\n                    <CardContent className=\"flex flex-col gap-x-2 space-y-2 p-2\">\n                      <div className=\"m-auto max-w-64 space-x-4 text-wrap md:flex md:max-w-full\">\n                        <img\n                          src={advertisement.imageUrl}\n                          alt={t(\"ã‚µãƒ ãƒã‚¤ãƒ«\", \"Thumbnail\")}\n                          className=\"m-auto h-auto w-32\"\n                        />\n                        <div className=\"ml-2 flex flex-col space-y-2\">\n                          <Link\n                            target=\"_blank\"\n                            to={\n                              advertisement.url.startsWith(\"http\")\n                                ? advertisement.url\n                                : `https://${advertisement.url}`\n                            }\n                            className=\"w-64 text-wrap\"\n                          >\n                            {advertisement.url}\n                          </Link>\n                          <p>\n                            {t(\"è¡¨ç¤ºå„ªå…ˆåº¦\", \"Display Priority\")}:{\" \"}\n                            {advertisement.displayProbability}\n                          </p>\n                          <p>\n                            {t(\"è¡¨ç¤ºå›æ•°\", \"View\")}:{\" \"}\n                            {advertisement.impressionCount}\n                          </p>\n                          <p>\n                            {t(\"ã‚¯ãƒªãƒƒã‚¯å›æ•°\", \"Clicked\")}:{\" \"}\n                            {advertisement.clickCount}\n                          </p>\n                          <p>\n                            {t(\"ä½œæˆæ—¥\", \"Created At\")}:{\" \"}\n                            {toDateText(advertisement.createdAt)}\n                          </p>\n                          <p>\n                            {t(\"é…ä¿¡æ—¥\", \"Start At\")}:{\" \"}\n                            {toDateText(advertisement.startAt)}\n                          </p>\n                          <div className=\"mt-2 flex space-x-2\">\n                            <Badge\n                              variant={\n                                advertisement.isActive ? \"default\" : \"secondary\"\n                              }\n                              className=\"w-16 text-center\"\n                            >\n                              <div className=\"m-auto\">\n                                {advertisement.isActive\n                                  ? t(\"å…¬é–‹ä¸­\", \"Active\")\n                                  : t(\"éå…¬é–‹\", \"Inactive\")}\n                              </div>\n                            </Badge>\n                            <Badge\n                              variant={\"secondary\"}\n                              className=\"w-24 text-center\"\n                            >\n                              <div className=\"m-auto\">\n                                {advertisement.isSensitive\n                                  ? t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")\n                                  : t(\"å…¨å¹´é½¢\", \"All Ages\")}\n                              </div>\n                            </Badge>\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"mt-2 flex space-x-2\">\n                        <Button\n                          variant={\"secondary\"}\n                          onClick={() => handleEdit(advertisement)}\n                        >\n                          {t(\"ç·¨é›†\", \"Edit\")}\n                        </Button>\n                        <SettingsAdvertisementsDeleteConfirmDialog\n                          onDelete={async () => handleDelete(advertisement.id)}\n                        />\n                      </div>\n                    </CardContent>\n                  </Card>\n                ),\n              )}\n            </CardContent>\n          </Card>\n        </>\n      )}\n\n      {viewMode === \"create\" && (\n        <>\n          <h2>\n            {isEditing\n              ? t(\"åºƒå‘Šã‚’ç·¨é›†\", \"Edit Advertisement\")\n              : t(\"æ–°ã—ã„åºƒå‘Šã‚’ä½œæˆ\", \"Create New Advertisement\")}\n          </h2>\n          <div className=\"space-y-4\">\n            <p className=\"font-semibold text-sm\">\n              {t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n            </p>\n            {newAdvertisement.imageUrl && (\n              <div className=\"bg-zinc-100 dark:bg-zinc-800\">\n                <img\n                  className=\"m-auto max-h-32\"\n                  src={newAdvertisement.imageUrl}\n                  alt={t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n                />\n              </div>\n            )}\n            {imageBase64 && (\n              <>\n                <p className=\"font-semibold text-xs\">\n                  {t(\"ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼\", \"Preview\")}\n                </p>\n                <div className=\"bg-zinc-100 dark:bg-zinc-800\">\n                  <img\n                    className=\"m-auto max-h-32\"\n                    src={imageBase64}\n                    alt={t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n                  />\n                </div>\n              </>\n            )}\n            <Input\n              placeholder={t(\"ç”»åƒURL\", \"Image URL\")}\n              value={newAdvertisement.imageUrl}\n              onChange={(e) => {\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  imageUrl: e.target.value,\n                })\n                if (e.target.value === \"\") {\n                  setImageBase64(null)\n                }\n              }}\n              onBlur={async (e) => {\n                const imageUrl = e.target.value\n                if (imageUrl === \"\") {\n                  setImageBase64(null)\n                  return\n                }\n\n                try {\n                  const base64 = await getBase64FromImageUrl(imageUrl)\n                  setImageBase64(base64)\n                } catch (error) {\n                  console.error(\"ç”»åƒã®Base64å¤‰æ›ã«å¤±æ•—ã—ã¾ã—ãŸ\", error)\n                }\n              }}\n              disabled={isUploading || imageBase64 !== null}\n            />\n            <p className=\"text-sm opacity-80\">\n              {t(\n                \"â€» å¤–éƒ¨ã®ç”»åƒURLã‚’ç›´æ¥æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½\",\n                \"â€» You can also specify an external image URL directly\",\n              )}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <input\n                type=\"file\"\n                accept=\"image/webp,image/jpeg,image/jpg,image/png\"\n                onChange={handleImageUpload}\n                disabled={isUploading}\n                className=\"w-full\"\n              />\n              <Button\n                variant={\"secondary\"}\n                onClick={() => setImageBase64(null)}\n              >\n                {t(\"é¸æŠã—ãŸç”»åƒã‚’å‰Šé™¤\", \"Remove Selected Image\")}\n              </Button>\n            </div>\n            <Button\n              className=\"w-full items-center\"\n              onClick={onUpload}\n              disabled={!imageBase64 || isUploading}\n            >\n              {isUploading ? (\n                <Loader2Icon className=\"size-4 animate-spin\" />\n              ) : (\n                <p>{t(\"ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰\", \"Upload Image\")}</p>\n              )}\n            </Button>\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"åºƒå‘Šã®é…ä¿¡æœŸé–“ï¼ˆé…ä¿¡æœˆï¼‰\",\n                \"Advertisement Delivery Period (Delivery Month)\",\n              )}\n            </p>\n            <Input\n              type=\"month\"\n              value={format(newAdvertisement.startAt, \"yyyy-MM\")}\n              onChange={(event) => {\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  startAt: new Date(`${event.target.value}-01`).toISOString(),\n                  endAt: endOfMonth(\n                    new Date(`${event.target.value}-01`),\n                  ).toISOString(),\n                })\n              }}\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\"åºƒå‘Šã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸéš›ã®é·ç§»å…ˆ\", \"Link URL When Ad is Clicked\")}\n            </p>\n            <Input\n              placeholder={t(\"ãƒªãƒ³ã‚¯URL\", \"Link URL\")}\n              value={newAdvertisement.url}\n              onChange={(e) =>\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  url: e.target.value,\n                })\n              }\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ã‹ã©ã†ã‹\", \"Is this sensitive content?\")}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"sensitive\"\n                checked={newAdvertisement.isSensitive}\n                onCheckedChange={(checked) => {\n                  if (checked === true) {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isSensitive: true,\n                    })\n                  } else {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isSensitive: false,\n                    })\n                  }\n                }}\n              />\n              <label\n                htmlFor=\"sensitive\"\n                className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n              >\n                {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")}\n              </label>\n            </div>\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"è¡¨ç¤ºã™ã‚‹å„ªå…ˆåº¦ï¼ˆå…¨ä½“ã®æ•°å­—ã§å‡ç­‰å‰²ã‚Šã—ã¦ç¢ºç‡ã‚’ç®—å‡ºã€é«˜ã„ã»ã©ç¢ºç‡ãŒé«˜ããªã‚‹ï¼‰\",\n                \"Display priority (higher numbers increase probability)\",\n              )}\n            </p>\n            <Input\n              placeholder={t(\"è¡¨ç¤ºå„ªå…ˆåº¦\", \"Display Priority\")}\n              type=\"number\"\n              max={1000}\n              value={newAdvertisement.displayProbability}\n              onChange={(e) =>\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  displayProbability: Number.parseFloat(e.target.value),\n                })\n              }\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"æœ‰åŠ¹åŒ–ã•ã‚Œã‚‹ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™\",\n                \"Enabling this will display the ad\",\n              )}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"active\"\n                checked={newAdvertisement.isActive}\n                onCheckedChange={(checked) => {\n                  if (checked === true) {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isActive: true,\n                    })\n                  } else {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isActive: false,\n                    })\n                  }\n                }}\n              />\n              <label\n                htmlFor=\"active\"\n                className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n              >\n                {t(\"æœ‰åŠ¹åŒ–\", \"Active\")}\n              </label>\n            </div>\n            <Button\n              className=\"w-full\"\n              disabled={\n                !newAdvertisement.imageUrl ||\n                !newAdvertisement.url ||\n                isCreating ||\n                isUpdating\n              }\n              onClick={isEditing ? handleUpdate : handleCreate}\n            >\n              {isCreating || isUpdating ? (\n                <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n              ) : isEditing ? (\n                t(\"æ›´æ–°\", \"Update\")\n              ) : (\n                t(\"åºƒå‘Šã‚’ä½œæˆ\", \"Create Advertisement\")\n              )}\n            </Button>\n          </div>\n        </>\n      )}\n    </div>\n  )\n}\n\nexport const AdvertisementsFragment = graphql(\n  `fragment AdvertisementsFields on CustomerAdvertisementNode @_unmask {\n      id\n      imageUrl\n      url\n      displayProbability\n      clickCount\n      impressionCount\n      isSensitive\n      createdAt\n      page\n      startAt\n      endAt\n      isActive\n  }`,\n)\n\n// è‡ªèº«ã®åºƒå‘Šä¸€è¦§ã‚’å–å¾—ã™ã‚‹ã‚¯ã‚¨ãƒª\nconst viewerAdvertisementsQuery = graphql(\n  `query ViewerAdvertisements($limit: Int!, $offset: Int!, $where: CustomerAdvertisementsWhereInput) {\n    viewer {\n      id\n      customerAdvertisements(limit: $limit, offset: $offset, where: $where) {\n        ...AdvertisementsFields\n      }\n    }\n  }`,\n  [AdvertisementsFragment],\n)\n\n// åºƒå‘Šã‚’ä½œæˆã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst createCustomerAdvertisement = graphql(\n  `mutation CreateCustomerAdvertisement($input: CreateCustomerAdvertisement!) {\n    createCustomerAdvertisement(input: $input) {\n      id\n    }\n  }`,\n)\n\n// åºƒå‘Šã‚’æ›´æ–°ã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst updateCustomerAdvertisement = graphql(\n  `mutation UpdateCustomerAdvertisement($input: UpdateCustomerAdvertisement!) {\n    updateCustomerAdvertisement(input: $input) {\n      id\n    }\n  }`,\n)\n\n// åºƒå‘Šã‚’å‰Šé™¤ã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst deleteCustomerAdvertisement = graphql(\n  `mutation DeleteCustomerAdvertisement($input: DeleteCustomerAdvertisementInput!) {\n    deleteCustomerAdvertisement(input: $input)\n  }`,\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst viewerIsAdvertiserQuery = graphql(\n  `query ViewerIsAdvertiser {\n    viewer {\n      isAdvertiser\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.advertisements/_components/setting-advertisements-form.tsx"},"span":[10868,11111],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { ApolloError, useMutation, useQuery } from \"@apollo/client/index\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport { type SetStateAction, useContext, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { toDateText } from \"~/utils/to-date-text\"\nimport { addHours, endOfMonth, format, startOfMonth } from \"date-fns\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { Loader2Icon } from \"lucide-react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { getBase64FromImageUrl } from \"~/utils/get-base64-from-image-url\"\nimport { Link } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { SettingsAdvertisementsDeleteConfirmDialog } from \"~/routes/($lang).settings.advertisements/_components/settings-advertisements-delete-confirm-dialog\"\n\n// æ—¥æœ¬æ™‚é–“ (JST) ã«å¤‰æ›ã™ã‚‹ãŸã‚ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°\nconst toJST = (date: Date) => {\n  return addHours(date, 9) // UTCã«å¯¾ã—ã¦+9æ™‚é–“ã§JSTã«å¤‰æ›\n}\n\nexport function SettingAdvertisementsForm () {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const { data: isAdvertiser, loading: isAdvertiserLoading } = useQuery(\n    viewerIsAdvertiserQuery,\n  )\n\n  if (isAdvertiser?.viewer?.isAdvertiser === false) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const [newAdvertisement, setNewAdvertisement] = useState({\n    imageUrl: \"\",\n    url: \"\",\n    displayProbability: 0,\n    isSensitive: false,\n    isActive: false,\n    startAt: \"\",\n    endAt: \"\",\n  })\n\n  const { data: token } = useQuery(viewerTokenQuery, {\n    skip: authContext.isLoading,\n  })\n  const [date, setDate] = useState<Date | null>(null)\n\n  const [isActive, setIsActive] = useState<boolean | undefined>(undefined)\n\n  const [isSensitiveFilter, setIsSensitiveFilter] = useState<\n    boolean | undefined\n  >(undefined)\n\n  const [isEditing, setIsEditing] = useState(false)\n\n  const [editingId, setEditingId] = useState<string | null>(null)\n\n  const [viewMode, setViewMode] = useState(\"list\") // åˆ‡ã‚Šæ›¿ãˆç”¨\n\n  const { data, loading, error, refetch } = useQuery(\n    viewerAdvertisementsQuery,\n    {\n      skip: authContext.isLoading,\n      variables: {\n        limit: 64,\n        offset: 0,\n      },\n    },\n  )\n\n  const [uploadedImageUrls, setUploadedImageUrls] = useState<string[]>([])\n\n  const [count, setCount] = useState(0)\n\n  const [imageBase64, setImageBase64] = useState<string | null>(null)\n\n  const [isUploading, setIsUploading] = useState(false)\n\n  const [createAdvertisement, { loading: isCreating }] = useMutation(\n    createCustomerAdvertisement,\n  )\n\n  const [updateAdvertisement, { loading: isUpdating }] = useMutation(\n    updateCustomerAdvertisement,\n  )\n\n  const [deleteAdvertisement, { loading: isDeleting }] = useMutation(\n    deleteCustomerAdvertisement,\n  )\n\n  // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãŸåºƒå‘Šãƒªã‚¹ãƒˆã‚’ç”Ÿæˆã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯\n  const filteredAdvertisements = data?.viewer?.customerAdvertisements.filter(\n    (advertisement) => {\n      const isActiveMatch =\n        isActive === undefined || advertisement.isActive === isActive\n      const isSensitiveMatch =\n        isSensitiveFilter === undefined ||\n        advertisement.isSensitive === isSensitiveFilter\n      return isActiveMatch && isSensitiveMatch\n    },\n  )\n\n  const handleCreate = async () => {\n    try {\n      if (!newAdvertisement.imageUrl || !newAdvertisement.url) {\n        toast(\n          t(\n            \"ç”»åƒURLã¨ãƒªãƒ³ã‚¯URLã¯å¿…é ˆã§ã™\",\n            \"Image URL and Link URL are required\",\n          ),\n        )\n        return\n      }\n\n      const selectedDate = new Date(newAdvertisement.startAt)\n\n      const startAtJST = toJST(startOfMonth(selectedDate))\n\n      const endAtJST = toJST(endOfMonth(selectedDate))\n\n      await createAdvertisement({\n        variables: {\n          input: {\n            imageUrl: newAdvertisement.imageUrl,\n            url: newAdvertisement.url,\n            displayProbability: newAdvertisement.displayProbability,\n            page: \"work\",\n            isSensitive: newAdvertisement.isSensitive,\n            isActive: newAdvertisement.isActive,\n            startAt: startAtJST.toISOString(),\n            endAt: endAtJST.toISOString(),\n          },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’ä½œæˆã—ã¾ã—ãŸ\", \"Advertisement created\"))\n      setViewMode(\"list\")\n      setIsEditing(false)\n\n      refetch({\n        limit: 64,\n        offset: 0,\n      })\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleEdit = (\n    advertisement: FragmentOf<typeof AdvertisementsFragment>,\n  ) => {\n    setNewAdvertisement({\n      imageUrl: advertisement.imageUrl,\n      url: advertisement.url,\n      displayProbability: advertisement.displayProbability,\n      isSensitive: advertisement.isSensitive,\n      isActive: advertisement.isActive,\n      startAt: startOfMonth(\n        new Date(advertisement.startAt * 1000),\n      ).toISOString(),\n      endAt: endOfMonth(new Date(advertisement.endAt * 1000)).toISOString(),\n    })\n    setIsEditing(true)\n    setEditingId(advertisement.id)\n    setViewMode(\"create\") // ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ\n  }\n\n  // å†ãƒ•ã‚§ãƒƒãƒã§æ¤œç´¢ã‚’å®Ÿè¡Œ\n  const handleSearch = () => {\n    if (date) {\n      const selectedDate = date\n      const startAtJST = toJST(startOfMonth(selectedDate))\n      const endAtJST = toJST(endOfMonth(selectedDate))\n      refetch({\n        limit: 64,\n        offset: 0,\n        where: {\n          startAtAfter: startAtJST.toISOString(),\n          endAtAfter: endAtJST.toISOString(),\n          isActive: isActive !== undefined ? isActive : undefined,\n          isSensitive:\n            isSensitiveFilter !== undefined ? isSensitiveFilter : undefined,\n        },\n      })\n    }\n  }\n\n  const handleImageUpload = async (\n    event: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    const file = event.target.files?.[0]\n    if (!file) {\n      toast(\"ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    const img = new Image()\n    const reader = new FileReader()\n\n    reader.onload = (e) => {\n      if (e.target) {\n        img.src = e.target.result as string\n        setImageBase64(img.src)\n      }\n    }\n\n    reader.onerror = () => toast(\"ç”»åƒèª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n    reader.readAsDataURL(file)\n  }\n\n  const onUpload = async () => {\n    if (!imageBase64) {\n      toast(\"ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    if (count >= 30) {\n      toast(\n        \"ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸Šé™ã§ã™ã€ä¸‹æ›¸ãã§ä¸€æ™‚æŠ•ç¨¿ã®ã®ã¡ã€æ™‚é–“ã‚’ç½®ã„ã¦ç”»é¢æ›´æ–°ã—ã¦ãã ã•ã„\",\n      )\n      return\n    }\n\n    setIsUploading(true)\n\n    const url = await uploadPublicImage(imageBase64, token?.viewer?.token)\n\n    setIsUploading(false)\n\n    if (url) {\n      setUploadedImageUrls([...uploadedImageUrls, url])\n      setImageBase64(null)\n      setCount(count + 1)\n      setNewAdvertisement({ ...newAdvertisement, imageUrl: url })\n    } else {\n      toast(\"ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n    }\n  }\n\n  const handleUpdate = async () => {\n    if (!editingId) {\n      return\n    }\n\n    try {\n      const selectedDate = new Date(newAdvertisement.startAt)\n      const startAtJST = toJST(startOfMonth(selectedDate))\n      const endAtJST = toJST(endOfMonth(selectedDate))\n\n      await updateAdvertisement({\n        variables: {\n          input: {\n            id: editingId,\n            imageUrl: newAdvertisement.imageUrl,\n            url: newAdvertisement.url,\n            displayProbability: newAdvertisement.displayProbability,\n            page: \"work\",\n            isSensitive: newAdvertisement.isSensitive,\n            isActive: newAdvertisement.isActive,\n            startAt: startAtJST.toISOString(),\n            endAt: endAtJST.toISOString(),\n          },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’æ›´æ–°ã—ã¾ã—ãŸ\", \"Advertisement updated\"))\n      setIsEditing(false)\n      setNewAdvertisement({\n        imageUrl: \"\",\n        url: \"\",\n        displayProbability: 0,\n        isSensitive: false,\n        isActive: false,\n        startAt: \"\",\n        endAt: \"\",\n      })\n      setViewMode(\"list\")\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleDelete = async (id: string) => {\n    try {\n      await deleteAdvertisement({\n        variables: {\n          input: { ids: [id] },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’å‰Šé™¤ã—ã¾ã—ãŸ\", \"Advertisement deleted\"))\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleModeSwitch = (mode: SetStateAction<string>) => {\n    setViewMode(mode)\n    setIsEditing(false)\n    setImageBase64(null)\n    setNewAdvertisement({\n      imageUrl: \"\",\n      url: \"\",\n      displayProbability: 0,\n      isSensitive: false,\n      isActive: false,\n      startAt: new Date().toISOString(),\n      endAt: new Date().toISOString(),\n    })\n  }\n\n  return (\n    <div className=\"w-full space-y-4\">\n      <div className=\"flex justify-between\">\n        <Button\n          disabled={viewMode === \"list\"}\n          onClick={() => handleModeSwitch(\"list\")}\n        >\n          {t(\"åºƒå‘Šä¸€è¦§\", \"Advertisement List\")}\n        </Button>\n        <Button onClick={() => handleModeSwitch(\"create\")}>\n          {t(\"æ–°ã—ã„åºƒå‘Šã‚’ä½œæˆ\", \"Create New Advertisement\")}\n        </Button>\n      </div>\n      {viewMode === \"list\" && (\n        <>\n          <h2>{t(\"åºƒå‘Šè¨­å®šä¸€è¦§\", \"Advertisement Settings List\")}</h2>\n          {loading && <AppLoadingPage />}\n          {error && (\n            <p>\n              {t(\"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ\", \"An error occurred\")}: {error.message}\n            </p>\n          )}\n          <div className=\"flex items-center space-x-2\">\n            <p className=\"w-24\">{t(\"é…ä¿¡æœˆ\", \"Delivery Month\")}ï¼š</p>\n            <Input\n              type=\"month\"\n              value={date ? format(date, \"yyyy-MM\") : \"\"}\n              onChange={(event) => {\n                setDate(new Date(`${event.target.value}-01`))\n              }}\n            />\n            <Button onClick={handleSearch}>{t(\"æ¤œç´¢\", \"Search\")}</Button>\n          </div>\n          <div className=\"flex flex-col space-x-2 space-y-2 md:flex-row\">\n            <div className=\"flex space-x-2\">\n              <div className=\"flex w-24 items-center space-x-2\">\n                <label htmlFor=\"activeFilter\">\n                  {t(\"æœ‰åŠ¹\", \"Active\")}\n                  <Checkbox\n                    id=\"activeFilter\"\n                    checked={isActive === true}\n                    onCheckedChange={(checked) => {\n                      setIsActive(checked === true)\n                    }}\n                  />\n                </label>\n              </div>\n              <div className=\"flex w-40 items-center space-x-2\">\n                <label htmlFor=\"sensitiveFilter\">\n                  {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")}\n                  <Checkbox\n                    id=\"sensitiveFilter\"\n                    checked={isSensitiveFilter === true}\n                    onCheckedChange={(checked) =>\n                      setIsSensitiveFilter(checked === true ? true : undefined)\n                    }\n                  />\n                </label>\n              </div>\n              <div className=\"flex w-40 items-center space-x-2\">\n                <label htmlFor=\"ageFilter\">\n                  {t(\"å…¨å¹´é½¢\", \"All Ages\")}\n                  <Checkbox\n                    id=\"ageFilter\"\n                    checked={isSensitiveFilter === false}\n                    onCheckedChange={(checked) =>\n                      setIsSensitiveFilter(checked === true ? false : undefined)\n                    }\n                  />\n                </label>\n              </div>\n            </div>\n            <Button\n              variant={\"secondary\"}\n              className=\"w-full\"\n              onClick={() => {\n                setIsActive(undefined)\n                setIsSensitiveFilter(undefined)\n              }}\n            >\n              {t(\"ã™ã¹ã¦\", \"All\")}\n            </Button>\n          </div>\n          {/* åºƒå‘Šãƒªã‚¹ãƒˆ */}\n          <Card className=\"space-y-4\">\n            <CardContent className=\"flex flex-col gap-x-2 space-y-2 p-2\">\n              {filteredAdvertisements?.map(\n                (advertisement: FragmentOf<typeof AdvertisementsFragment>) => (\n                  <Card\n                    key={advertisement.id}\n                    className=\"flex items-center justify-between border p-4\"\n                  >\n                    <CardContent className=\"flex flex-col gap-x-2 space-y-2 p-2\">\n                      <div className=\"m-auto max-w-64 space-x-4 text-wrap md:flex md:max-w-full\">\n                        <img\n                          src={advertisement.imageUrl}\n                          alt={t(\"ã‚µãƒ ãƒã‚¤ãƒ«\", \"Thumbnail\")}\n                          className=\"m-auto h-auto w-32\"\n                        />\n                        <div className=\"ml-2 flex flex-col space-y-2\">\n                          <Link\n                            target=\"_blank\"\n                            to={\n                              advertisement.url.startsWith(\"http\")\n                                ? advertisement.url\n                                : `https://${advertisement.url}`\n                            }\n                            className=\"w-64 text-wrap\"\n                          >\n                            {advertisement.url}\n                          </Link>\n                          <p>\n                            {t(\"è¡¨ç¤ºå„ªå…ˆåº¦\", \"Display Priority\")}:{\" \"}\n                            {advertisement.displayProbability}\n                          </p>\n                          <p>\n                            {t(\"è¡¨ç¤ºå›æ•°\", \"View\")}:{\" \"}\n                            {advertisement.impressionCount}\n                          </p>\n                          <p>\n                            {t(\"ã‚¯ãƒªãƒƒã‚¯å›æ•°\", \"Clicked\")}:{\" \"}\n                            {advertisement.clickCount}\n                          </p>\n                          <p>\n                            {t(\"ä½œæˆæ—¥\", \"Created At\")}:{\" \"}\n                            {toDateText(advertisement.createdAt)}\n                          </p>\n                          <p>\n                            {t(\"é…ä¿¡æ—¥\", \"Start At\")}:{\" \"}\n                            {toDateText(advertisement.startAt)}\n                          </p>\n                          <div className=\"mt-2 flex space-x-2\">\n                            <Badge\n                              variant={\n                                advertisement.isActive ? \"default\" : \"secondary\"\n                              }\n                              className=\"w-16 text-center\"\n                            >\n                              <div className=\"m-auto\">\n                                {advertisement.isActive\n                                  ? t(\"å…¬é–‹ä¸­\", \"Active\")\n                                  : t(\"éå…¬é–‹\", \"Inactive\")}\n                              </div>\n                            </Badge>\n                            <Badge\n                              variant={\"secondary\"}\n                              className=\"w-24 text-center\"\n                            >\n                              <div className=\"m-auto\">\n                                {advertisement.isSensitive\n                                  ? t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")\n                                  : t(\"å…¨å¹´é½¢\", \"All Ages\")}\n                              </div>\n                            </Badge>\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"mt-2 flex space-x-2\">\n                        <Button\n                          variant={\"secondary\"}\n                          onClick={() => handleEdit(advertisement)}\n                        >\n                          {t(\"ç·¨é›†\", \"Edit\")}\n                        </Button>\n                        <SettingsAdvertisementsDeleteConfirmDialog\n                          onDelete={async () => handleDelete(advertisement.id)}\n                        />\n                      </div>\n                    </CardContent>\n                  </Card>\n                ),\n              )}\n            </CardContent>\n          </Card>\n        </>\n      )}\n\n      {viewMode === \"create\" && (\n        <>\n          <h2>\n            {isEditing\n              ? t(\"åºƒå‘Šã‚’ç·¨é›†\", \"Edit Advertisement\")\n              : t(\"æ–°ã—ã„åºƒå‘Šã‚’ä½œæˆ\", \"Create New Advertisement\")}\n          </h2>\n          <div className=\"space-y-4\">\n            <p className=\"font-semibold text-sm\">\n              {t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n            </p>\n            {newAdvertisement.imageUrl && (\n              <div className=\"bg-zinc-100 dark:bg-zinc-800\">\n                <img\n                  className=\"m-auto max-h-32\"\n                  src={newAdvertisement.imageUrl}\n                  alt={t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n                />\n              </div>\n            )}\n            {imageBase64 && (\n              <>\n                <p className=\"font-semibold text-xs\">\n                  {t(\"ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼\", \"Preview\")}\n                </p>\n                <div className=\"bg-zinc-100 dark:bg-zinc-800\">\n                  <img\n                    className=\"m-auto max-h-32\"\n                    src={imageBase64}\n                    alt={t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n                  />\n                </div>\n              </>\n            )}\n            <Input\n              placeholder={t(\"ç”»åƒURL\", \"Image URL\")}\n              value={newAdvertisement.imageUrl}\n              onChange={(e) => {\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  imageUrl: e.target.value,\n                })\n                if (e.target.value === \"\") {\n                  setImageBase64(null)\n                }\n              }}\n              onBlur={async (e) => {\n                const imageUrl = e.target.value\n                if (imageUrl === \"\") {\n                  setImageBase64(null)\n                  return\n                }\n\n                try {\n                  const base64 = await getBase64FromImageUrl(imageUrl)\n                  setImageBase64(base64)\n                } catch (error) {\n                  console.error(\"ç”»åƒã®Base64å¤‰æ›ã«å¤±æ•—ã—ã¾ã—ãŸ\", error)\n                }\n              }}\n              disabled={isUploading || imageBase64 !== null}\n            />\n            <p className=\"text-sm opacity-80\">\n              {t(\n                \"â€» å¤–éƒ¨ã®ç”»åƒURLã‚’ç›´æ¥æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½\",\n                \"â€» You can also specify an external image URL directly\",\n              )}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <input\n                type=\"file\"\n                accept=\"image/webp,image/jpeg,image/jpg,image/png\"\n                onChange={handleImageUpload}\n                disabled={isUploading}\n                className=\"w-full\"\n              />\n              <Button\n                variant={\"secondary\"}\n                onClick={() => setImageBase64(null)}\n              >\n                {t(\"é¸æŠã—ãŸç”»åƒã‚’å‰Šé™¤\", \"Remove Selected Image\")}\n              </Button>\n            </div>\n            <Button\n              className=\"w-full items-center\"\n              onClick={onUpload}\n              disabled={!imageBase64 || isUploading}\n            >\n              {isUploading ? (\n                <Loader2Icon className=\"size-4 animate-spin\" />\n              ) : (\n                <p>{t(\"ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰\", \"Upload Image\")}</p>\n              )}\n            </Button>\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"åºƒå‘Šã®é…ä¿¡æœŸé–“ï¼ˆé…ä¿¡æœˆï¼‰\",\n                \"Advertisement Delivery Period (Delivery Month)\",\n              )}\n            </p>\n            <Input\n              type=\"month\"\n              value={format(newAdvertisement.startAt, \"yyyy-MM\")}\n              onChange={(event) => {\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  startAt: new Date(`${event.target.value}-01`).toISOString(),\n                  endAt: endOfMonth(\n                    new Date(`${event.target.value}-01`),\n                  ).toISOString(),\n                })\n              }}\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\"åºƒå‘Šã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸéš›ã®é·ç§»å…ˆ\", \"Link URL When Ad is Clicked\")}\n            </p>\n            <Input\n              placeholder={t(\"ãƒªãƒ³ã‚¯URL\", \"Link URL\")}\n              value={newAdvertisement.url}\n              onChange={(e) =>\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  url: e.target.value,\n                })\n              }\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ã‹ã©ã†ã‹\", \"Is this sensitive content?\")}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"sensitive\"\n                checked={newAdvertisement.isSensitive}\n                onCheckedChange={(checked) => {\n                  if (checked === true) {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isSensitive: true,\n                    })\n                  } else {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isSensitive: false,\n                    })\n                  }\n                }}\n              />\n              <label\n                htmlFor=\"sensitive\"\n                className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n              >\n                {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")}\n              </label>\n            </div>\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"è¡¨ç¤ºã™ã‚‹å„ªå…ˆåº¦ï¼ˆå…¨ä½“ã®æ•°å­—ã§å‡ç­‰å‰²ã‚Šã—ã¦ç¢ºç‡ã‚’ç®—å‡ºã€é«˜ã„ã»ã©ç¢ºç‡ãŒé«˜ããªã‚‹ï¼‰\",\n                \"Display priority (higher numbers increase probability)\",\n              )}\n            </p>\n            <Input\n              placeholder={t(\"è¡¨ç¤ºå„ªå…ˆåº¦\", \"Display Priority\")}\n              type=\"number\"\n              max={1000}\n              value={newAdvertisement.displayProbability}\n              onChange={(e) =>\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  displayProbability: Number.parseFloat(e.target.value),\n                })\n              }\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"æœ‰åŠ¹åŒ–ã•ã‚Œã‚‹ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™\",\n                \"Enabling this will display the ad\",\n              )}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"active\"\n                checked={newAdvertisement.isActive}\n                onCheckedChange={(checked) => {\n                  if (checked === true) {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isActive: true,\n                    })\n                  } else {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isActive: false,\n                    })\n                  }\n                }}\n              />\n              <label\n                htmlFor=\"active\"\n                className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n              >\n                {t(\"æœ‰åŠ¹åŒ–\", \"Active\")}\n              </label>\n            </div>\n            <Button\n              className=\"w-full\"\n              disabled={\n                !newAdvertisement.imageUrl ||\n                !newAdvertisement.url ||\n                isCreating ||\n                isUpdating\n              }\n              onClick={isEditing ? handleUpdate : handleCreate}\n            >\n              {isCreating || isUpdating ? (\n                <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n              ) : isEditing ? (\n                t(\"æ›´æ–°\", \"Update\")\n              ) : (\n                t(\"åºƒå‘Šã‚’ä½œæˆ\", \"Create Advertisement\")\n              )}\n            </Button>\n          </div>\n        </>\n      )}\n    </div>\n  )\n}\n\nexport const AdvertisementsFragment = graphql(\n  `fragment AdvertisementsFields on CustomerAdvertisementNode @_unmask {\n      id\n      imageUrl\n      url\n      displayProbability\n      clickCount\n      impressionCount\n      isSensitive\n      createdAt\n      page\n      startAt\n      endAt\n      isActive\n  }`,\n)\n\n// è‡ªèº«ã®åºƒå‘Šä¸€è¦§ã‚’å–å¾—ã™ã‚‹ã‚¯ã‚¨ãƒª\nconst viewerAdvertisementsQuery = graphql(\n  `query ViewerAdvertisements($limit: Int!, $offset: Int!, $where: CustomerAdvertisementsWhereInput) {\n    viewer {\n      id\n      customerAdvertisements(limit: $limit, offset: $offset, where: $where) {\n        ...AdvertisementsFields\n      }\n    }\n  }`,\n  [AdvertisementsFragment],\n)\n\n// åºƒå‘Šã‚’ä½œæˆã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst createCustomerAdvertisement = graphql(\n  `mutation CreateCustomerAdvertisement($input: CreateCustomerAdvertisement!) {\n    createCustomerAdvertisement(input: $input) {\n      id\n    }\n  }`,\n)\n\n// åºƒå‘Šã‚’æ›´æ–°ã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst updateCustomerAdvertisement = graphql(\n  `mutation UpdateCustomerAdvertisement($input: UpdateCustomerAdvertisement!) {\n    updateCustomerAdvertisement(input: $input) {\n      id\n    }\n  }`,\n)\n\n// åºƒå‘Šã‚’å‰Šé™¤ã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst deleteCustomerAdvertisement = graphql(\n  `mutation DeleteCustomerAdvertisement($input: DeleteCustomerAdvertisementInput!) {\n    deleteCustomerAdvertisement(input: $input)\n  }`,\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst viewerIsAdvertiserQuery = graphql(\n  `query ViewerIsAdvertiser {\n    viewer {\n      isAdvertiser\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.advertisements/_components/setting-advertisements-form.tsx"},"span":[11348,11628],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { ApolloError, useMutation, useQuery } from \"@apollo/client/index\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport { type SetStateAction, useContext, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { toDateText } from \"~/utils/to-date-text\"\nimport { addHours, endOfMonth, format, startOfMonth } from \"date-fns\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { Loader2Icon } from \"lucide-react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { getBase64FromImageUrl } from \"~/utils/get-base64-from-image-url\"\nimport { Link } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { SettingsAdvertisementsDeleteConfirmDialog } from \"~/routes/($lang).settings.advertisements/_components/settings-advertisements-delete-confirm-dialog\"\n\n// æ—¥æœ¬æ™‚é–“ (JST) ã«å¤‰æ›ã™ã‚‹ãŸã‚ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°\nconst toJST = (date: Date) => {\n  return addHours(date, 9) // UTCã«å¯¾ã—ã¦+9æ™‚é–“ã§JSTã«å¤‰æ›\n}\n\nexport function SettingAdvertisementsForm () {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const { data: isAdvertiser, loading: isAdvertiserLoading } = useQuery(\n    viewerIsAdvertiserQuery,\n  )\n\n  if (isAdvertiser?.viewer?.isAdvertiser === false) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const [newAdvertisement, setNewAdvertisement] = useState({\n    imageUrl: \"\",\n    url: \"\",\n    displayProbability: 0,\n    isSensitive: false,\n    isActive: false,\n    startAt: \"\",\n    endAt: \"\",\n  })\n\n  const { data: token } = useQuery(viewerTokenQuery, {\n    skip: authContext.isLoading,\n  })\n  const [date, setDate] = useState<Date | null>(null)\n\n  const [isActive, setIsActive] = useState<boolean | undefined>(undefined)\n\n  const [isSensitiveFilter, setIsSensitiveFilter] = useState<\n    boolean | undefined\n  >(undefined)\n\n  const [isEditing, setIsEditing] = useState(false)\n\n  const [editingId, setEditingId] = useState<string | null>(null)\n\n  const [viewMode, setViewMode] = useState(\"list\") // åˆ‡ã‚Šæ›¿ãˆç”¨\n\n  const { data, loading, error, refetch } = useQuery(\n    viewerAdvertisementsQuery,\n    {\n      skip: authContext.isLoading,\n      variables: {\n        limit: 64,\n        offset: 0,\n      },\n    },\n  )\n\n  const [uploadedImageUrls, setUploadedImageUrls] = useState<string[]>([])\n\n  const [count, setCount] = useState(0)\n\n  const [imageBase64, setImageBase64] = useState<string | null>(null)\n\n  const [isUploading, setIsUploading] = useState(false)\n\n  const [createAdvertisement, { loading: isCreating }] = useMutation(\n    createCustomerAdvertisement,\n  )\n\n  const [updateAdvertisement, { loading: isUpdating }] = useMutation(\n    updateCustomerAdvertisement,\n  )\n\n  const [deleteAdvertisement, { loading: isDeleting }] = useMutation(\n    deleteCustomerAdvertisement,\n  )\n\n  // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãŸåºƒå‘Šãƒªã‚¹ãƒˆã‚’ç”Ÿæˆã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯\n  const filteredAdvertisements = data?.viewer?.customerAdvertisements.filter(\n    (advertisement) => {\n      const isActiveMatch =\n        isActive === undefined || advertisement.isActive === isActive\n      const isSensitiveMatch =\n        isSensitiveFilter === undefined ||\n        advertisement.isSensitive === isSensitiveFilter\n      return isActiveMatch && isSensitiveMatch\n    },\n  )\n\n  const handleCreate = async () => {\n    try {\n      if (!newAdvertisement.imageUrl || !newAdvertisement.url) {\n        toast(\n          t(\n            \"ç”»åƒURLã¨ãƒªãƒ³ã‚¯URLã¯å¿…é ˆã§ã™\",\n            \"Image URL and Link URL are required\",\n          ),\n        )\n        return\n      }\n\n      const selectedDate = new Date(newAdvertisement.startAt)\n\n      const startAtJST = toJST(startOfMonth(selectedDate))\n\n      const endAtJST = toJST(endOfMonth(selectedDate))\n\n      await createAdvertisement({\n        variables: {\n          input: {\n            imageUrl: newAdvertisement.imageUrl,\n            url: newAdvertisement.url,\n            displayProbability: newAdvertisement.displayProbability,\n            page: \"work\",\n            isSensitive: newAdvertisement.isSensitive,\n            isActive: newAdvertisement.isActive,\n            startAt: startAtJST.toISOString(),\n            endAt: endAtJST.toISOString(),\n          },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’ä½œæˆã—ã¾ã—ãŸ\", \"Advertisement created\"))\n      setViewMode(\"list\")\n      setIsEditing(false)\n\n      refetch({\n        limit: 64,\n        offset: 0,\n      })\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleEdit = (\n    advertisement: FragmentOf<typeof AdvertisementsFragment>,\n  ) => {\n    setNewAdvertisement({\n      imageUrl: advertisement.imageUrl,\n      url: advertisement.url,\n      displayProbability: advertisement.displayProbability,\n      isSensitive: advertisement.isSensitive,\n      isActive: advertisement.isActive,\n      startAt: startOfMonth(\n        new Date(advertisement.startAt * 1000),\n      ).toISOString(),\n      endAt: endOfMonth(new Date(advertisement.endAt * 1000)).toISOString(),\n    })\n    setIsEditing(true)\n    setEditingId(advertisement.id)\n    setViewMode(\"create\") // ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ\n  }\n\n  // å†ãƒ•ã‚§ãƒƒãƒã§æ¤œç´¢ã‚’å®Ÿè¡Œ\n  const handleSearch = () => {\n    if (date) {\n      const selectedDate = date\n      const startAtJST = toJST(startOfMonth(selectedDate))\n      const endAtJST = toJST(endOfMonth(selectedDate))\n      refetch({\n        limit: 64,\n        offset: 0,\n        where: {\n          startAtAfter: startAtJST.toISOString(),\n          endAtAfter: endAtJST.toISOString(),\n          isActive: isActive !== undefined ? isActive : undefined,\n          isSensitive:\n            isSensitiveFilter !== undefined ? isSensitiveFilter : undefined,\n        },\n      })\n    }\n  }\n\n  const handleImageUpload = async (\n    event: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    const file = event.target.files?.[0]\n    if (!file) {\n      toast(\"ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    const img = new Image()\n    const reader = new FileReader()\n\n    reader.onload = (e) => {\n      if (e.target) {\n        img.src = e.target.result as string\n        setImageBase64(img.src)\n      }\n    }\n\n    reader.onerror = () => toast(\"ç”»åƒèª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n    reader.readAsDataURL(file)\n  }\n\n  const onUpload = async () => {\n    if (!imageBase64) {\n      toast(\"ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    if (count >= 30) {\n      toast(\n        \"ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸Šé™ã§ã™ã€ä¸‹æ›¸ãã§ä¸€æ™‚æŠ•ç¨¿ã®ã®ã¡ã€æ™‚é–“ã‚’ç½®ã„ã¦ç”»é¢æ›´æ–°ã—ã¦ãã ã•ã„\",\n      )\n      return\n    }\n\n    setIsUploading(true)\n\n    const url = await uploadPublicImage(imageBase64, token?.viewer?.token)\n\n    setIsUploading(false)\n\n    if (url) {\n      setUploadedImageUrls([...uploadedImageUrls, url])\n      setImageBase64(null)\n      setCount(count + 1)\n      setNewAdvertisement({ ...newAdvertisement, imageUrl: url })\n    } else {\n      toast(\"ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n    }\n  }\n\n  const handleUpdate = async () => {\n    if (!editingId) {\n      return\n    }\n\n    try {\n      const selectedDate = new Date(newAdvertisement.startAt)\n      const startAtJST = toJST(startOfMonth(selectedDate))\n      const endAtJST = toJST(endOfMonth(selectedDate))\n\n      await updateAdvertisement({\n        variables: {\n          input: {\n            id: editingId,\n            imageUrl: newAdvertisement.imageUrl,\n            url: newAdvertisement.url,\n            displayProbability: newAdvertisement.displayProbability,\n            page: \"work\",\n            isSensitive: newAdvertisement.isSensitive,\n            isActive: newAdvertisement.isActive,\n            startAt: startAtJST.toISOString(),\n            endAt: endAtJST.toISOString(),\n          },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’æ›´æ–°ã—ã¾ã—ãŸ\", \"Advertisement updated\"))\n      setIsEditing(false)\n      setNewAdvertisement({\n        imageUrl: \"\",\n        url: \"\",\n        displayProbability: 0,\n        isSensitive: false,\n        isActive: false,\n        startAt: \"\",\n        endAt: \"\",\n      })\n      setViewMode(\"list\")\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleDelete = async (id: string) => {\n    try {\n      await deleteAdvertisement({\n        variables: {\n          input: { ids: [id] },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’å‰Šé™¤ã—ã¾ã—ãŸ\", \"Advertisement deleted\"))\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleModeSwitch = (mode: SetStateAction<string>) => {\n    setViewMode(mode)\n    setIsEditing(false)\n    setImageBase64(null)\n    setNewAdvertisement({\n      imageUrl: \"\",\n      url: \"\",\n      displayProbability: 0,\n      isSensitive: false,\n      isActive: false,\n      startAt: new Date().toISOString(),\n      endAt: new Date().toISOString(),\n    })\n  }\n\n  return (\n    <div className=\"w-full space-y-4\">\n      <div className=\"flex justify-between\">\n        <Button\n          disabled={viewMode === \"list\"}\n          onClick={() => handleModeSwitch(\"list\")}\n        >\n          {t(\"åºƒå‘Šä¸€è¦§\", \"Advertisement List\")}\n        </Button>\n        <Button onClick={() => handleModeSwitch(\"create\")}>\n          {t(\"æ–°ã—ã„åºƒå‘Šã‚’ä½œæˆ\", \"Create New Advertisement\")}\n        </Button>\n      </div>\n      {viewMode === \"list\" && (\n        <>\n          <h2>{t(\"åºƒå‘Šè¨­å®šä¸€è¦§\", \"Advertisement Settings List\")}</h2>\n          {loading && <AppLoadingPage />}\n          {error && (\n            <p>\n              {t(\"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ\", \"An error occurred\")}: {error.message}\n            </p>\n          )}\n          <div className=\"flex items-center space-x-2\">\n            <p className=\"w-24\">{t(\"é…ä¿¡æœˆ\", \"Delivery Month\")}ï¼š</p>\n            <Input\n              type=\"month\"\n              value={date ? format(date, \"yyyy-MM\") : \"\"}\n              onChange={(event) => {\n                setDate(new Date(`${event.target.value}-01`))\n              }}\n            />\n            <Button onClick={handleSearch}>{t(\"æ¤œç´¢\", \"Search\")}</Button>\n          </div>\n          <div className=\"flex flex-col space-x-2 space-y-2 md:flex-row\">\n            <div className=\"flex space-x-2\">\n              <div className=\"flex w-24 items-center space-x-2\">\n                <label htmlFor=\"activeFilter\">\n                  {t(\"æœ‰åŠ¹\", \"Active\")}\n                  <Checkbox\n                    id=\"activeFilter\"\n                    checked={isActive === true}\n                    onCheckedChange={(checked) => {\n                      setIsActive(checked === true)\n                    }}\n                  />\n                </label>\n              </div>\n              <div className=\"flex w-40 items-center space-x-2\">\n                <label htmlFor=\"sensitiveFilter\">\n                  {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")}\n                  <Checkbox\n                    id=\"sensitiveFilter\"\n                    checked={isSensitiveFilter === true}\n                    onCheckedChange={(checked) =>\n                      setIsSensitiveFilter(checked === true ? true : undefined)\n                    }\n                  />\n                </label>\n              </div>\n              <div className=\"flex w-40 items-center space-x-2\">\n                <label htmlFor=\"ageFilter\">\n                  {t(\"å…¨å¹´é½¢\", \"All Ages\")}\n                  <Checkbox\n                    id=\"ageFilter\"\n                    checked={isSensitiveFilter === false}\n                    onCheckedChange={(checked) =>\n                      setIsSensitiveFilter(checked === true ? false : undefined)\n                    }\n                  />\n                </label>\n              </div>\n            </div>\n            <Button\n              variant={\"secondary\"}\n              className=\"w-full\"\n              onClick={() => {\n                setIsActive(undefined)\n                setIsSensitiveFilter(undefined)\n              }}\n            >\n              {t(\"ã™ã¹ã¦\", \"All\")}\n            </Button>\n          </div>\n          {/* åºƒå‘Šãƒªã‚¹ãƒˆ */}\n          <Card className=\"space-y-4\">\n            <CardContent className=\"flex flex-col gap-x-2 space-y-2 p-2\">\n              {filteredAdvertisements?.map(\n                (advertisement: FragmentOf<typeof AdvertisementsFragment>) => (\n                  <Card\n                    key={advertisement.id}\n                    className=\"flex items-center justify-between border p-4\"\n                  >\n                    <CardContent className=\"flex flex-col gap-x-2 space-y-2 p-2\">\n                      <div className=\"m-auto max-w-64 space-x-4 text-wrap md:flex md:max-w-full\">\n                        <img\n                          src={advertisement.imageUrl}\n                          alt={t(\"ã‚µãƒ ãƒã‚¤ãƒ«\", \"Thumbnail\")}\n                          className=\"m-auto h-auto w-32\"\n                        />\n                        <div className=\"ml-2 flex flex-col space-y-2\">\n                          <Link\n                            target=\"_blank\"\n                            to={\n                              advertisement.url.startsWith(\"http\")\n                                ? advertisement.url\n                                : `https://${advertisement.url}`\n                            }\n                            className=\"w-64 text-wrap\"\n                          >\n                            {advertisement.url}\n                          </Link>\n                          <p>\n                            {t(\"è¡¨ç¤ºå„ªå…ˆåº¦\", \"Display Priority\")}:{\" \"}\n                            {advertisement.displayProbability}\n                          </p>\n                          <p>\n                            {t(\"è¡¨ç¤ºå›æ•°\", \"View\")}:{\" \"}\n                            {advertisement.impressionCount}\n                          </p>\n                          <p>\n                            {t(\"ã‚¯ãƒªãƒƒã‚¯å›æ•°\", \"Clicked\")}:{\" \"}\n                            {advertisement.clickCount}\n                          </p>\n                          <p>\n                            {t(\"ä½œæˆæ—¥\", \"Created At\")}:{\" \"}\n                            {toDateText(advertisement.createdAt)}\n                          </p>\n                          <p>\n                            {t(\"é…ä¿¡æ—¥\", \"Start At\")}:{\" \"}\n                            {toDateText(advertisement.startAt)}\n                          </p>\n                          <div className=\"mt-2 flex space-x-2\">\n                            <Badge\n                              variant={\n                                advertisement.isActive ? \"default\" : \"secondary\"\n                              }\n                              className=\"w-16 text-center\"\n                            >\n                              <div className=\"m-auto\">\n                                {advertisement.isActive\n                                  ? t(\"å…¬é–‹ä¸­\", \"Active\")\n                                  : t(\"éå…¬é–‹\", \"Inactive\")}\n                              </div>\n                            </Badge>\n                            <Badge\n                              variant={\"secondary\"}\n                              className=\"w-24 text-center\"\n                            >\n                              <div className=\"m-auto\">\n                                {advertisement.isSensitive\n                                  ? t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")\n                                  : t(\"å…¨å¹´é½¢\", \"All Ages\")}\n                              </div>\n                            </Badge>\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"mt-2 flex space-x-2\">\n                        <Button\n                          variant={\"secondary\"}\n                          onClick={() => handleEdit(advertisement)}\n                        >\n                          {t(\"ç·¨é›†\", \"Edit\")}\n                        </Button>\n                        <SettingsAdvertisementsDeleteConfirmDialog\n                          onDelete={async () => handleDelete(advertisement.id)}\n                        />\n                      </div>\n                    </CardContent>\n                  </Card>\n                ),\n              )}\n            </CardContent>\n          </Card>\n        </>\n      )}\n\n      {viewMode === \"create\" && (\n        <>\n          <h2>\n            {isEditing\n              ? t(\"åºƒå‘Šã‚’ç·¨é›†\", \"Edit Advertisement\")\n              : t(\"æ–°ã—ã„åºƒå‘Šã‚’ä½œæˆ\", \"Create New Advertisement\")}\n          </h2>\n          <div className=\"space-y-4\">\n            <p className=\"font-semibold text-sm\">\n              {t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n            </p>\n            {newAdvertisement.imageUrl && (\n              <div className=\"bg-zinc-100 dark:bg-zinc-800\">\n                <img\n                  className=\"m-auto max-h-32\"\n                  src={newAdvertisement.imageUrl}\n                  alt={t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n                />\n              </div>\n            )}\n            {imageBase64 && (\n              <>\n                <p className=\"font-semibold text-xs\">\n                  {t(\"ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼\", \"Preview\")}\n                </p>\n                <div className=\"bg-zinc-100 dark:bg-zinc-800\">\n                  <img\n                    className=\"m-auto max-h-32\"\n                    src={imageBase64}\n                    alt={t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n                  />\n                </div>\n              </>\n            )}\n            <Input\n              placeholder={t(\"ç”»åƒURL\", \"Image URL\")}\n              value={newAdvertisement.imageUrl}\n              onChange={(e) => {\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  imageUrl: e.target.value,\n                })\n                if (e.target.value === \"\") {\n                  setImageBase64(null)\n                }\n              }}\n              onBlur={async (e) => {\n                const imageUrl = e.target.value\n                if (imageUrl === \"\") {\n                  setImageBase64(null)\n                  return\n                }\n\n                try {\n                  const base64 = await getBase64FromImageUrl(imageUrl)\n                  setImageBase64(base64)\n                } catch (error) {\n                  console.error(\"ç”»åƒã®Base64å¤‰æ›ã«å¤±æ•—ã—ã¾ã—ãŸ\", error)\n                }\n              }}\n              disabled={isUploading || imageBase64 !== null}\n            />\n            <p className=\"text-sm opacity-80\">\n              {t(\n                \"â€» å¤–éƒ¨ã®ç”»åƒURLã‚’ç›´æ¥æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½\",\n                \"â€» You can also specify an external image URL directly\",\n              )}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <input\n                type=\"file\"\n                accept=\"image/webp,image/jpeg,image/jpg,image/png\"\n                onChange={handleImageUpload}\n                disabled={isUploading}\n                className=\"w-full\"\n              />\n              <Button\n                variant={\"secondary\"}\n                onClick={() => setImageBase64(null)}\n              >\n                {t(\"é¸æŠã—ãŸç”»åƒã‚’å‰Šé™¤\", \"Remove Selected Image\")}\n              </Button>\n            </div>\n            <Button\n              className=\"w-full items-center\"\n              onClick={onUpload}\n              disabled={!imageBase64 || isUploading}\n            >\n              {isUploading ? (\n                <Loader2Icon className=\"size-4 animate-spin\" />\n              ) : (\n                <p>{t(\"ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰\", \"Upload Image\")}</p>\n              )}\n            </Button>\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"åºƒå‘Šã®é…ä¿¡æœŸé–“ï¼ˆé…ä¿¡æœˆï¼‰\",\n                \"Advertisement Delivery Period (Delivery Month)\",\n              )}\n            </p>\n            <Input\n              type=\"month\"\n              value={format(newAdvertisement.startAt, \"yyyy-MM\")}\n              onChange={(event) => {\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  startAt: new Date(`${event.target.value}-01`).toISOString(),\n                  endAt: endOfMonth(\n                    new Date(`${event.target.value}-01`),\n                  ).toISOString(),\n                })\n              }}\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\"åºƒå‘Šã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸéš›ã®é·ç§»å…ˆ\", \"Link URL When Ad is Clicked\")}\n            </p>\n            <Input\n              placeholder={t(\"ãƒªãƒ³ã‚¯URL\", \"Link URL\")}\n              value={newAdvertisement.url}\n              onChange={(e) =>\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  url: e.target.value,\n                })\n              }\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ã‹ã©ã†ã‹\", \"Is this sensitive content?\")}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"sensitive\"\n                checked={newAdvertisement.isSensitive}\n                onCheckedChange={(checked) => {\n                  if (checked === true) {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isSensitive: true,\n                    })\n                  } else {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isSensitive: false,\n                    })\n                  }\n                }}\n              />\n              <label\n                htmlFor=\"sensitive\"\n                className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n              >\n                {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")}\n              </label>\n            </div>\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"è¡¨ç¤ºã™ã‚‹å„ªå…ˆåº¦ï¼ˆå…¨ä½“ã®æ•°å­—ã§å‡ç­‰å‰²ã‚Šã—ã¦ç¢ºç‡ã‚’ç®—å‡ºã€é«˜ã„ã»ã©ç¢ºç‡ãŒé«˜ããªã‚‹ï¼‰\",\n                \"Display priority (higher numbers increase probability)\",\n              )}\n            </p>\n            <Input\n              placeholder={t(\"è¡¨ç¤ºå„ªå…ˆåº¦\", \"Display Priority\")}\n              type=\"number\"\n              max={1000}\n              value={newAdvertisement.displayProbability}\n              onChange={(e) =>\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  displayProbability: Number.parseFloat(e.target.value),\n                })\n              }\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"æœ‰åŠ¹åŒ–ã•ã‚Œã‚‹ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™\",\n                \"Enabling this will display the ad\",\n              )}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"active\"\n                checked={newAdvertisement.isActive}\n                onCheckedChange={(checked) => {\n                  if (checked === true) {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isActive: true,\n                    })\n                  } else {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isActive: false,\n                    })\n                  }\n                }}\n              />\n              <label\n                htmlFor=\"active\"\n                className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n              >\n                {t(\"æœ‰åŠ¹åŒ–\", \"Active\")}\n              </label>\n            </div>\n            <Button\n              className=\"w-full\"\n              disabled={\n                !newAdvertisement.imageUrl ||\n                !newAdvertisement.url ||\n                isCreating ||\n                isUpdating\n              }\n              onClick={isEditing ? handleUpdate : handleCreate}\n            >\n              {isCreating || isUpdating ? (\n                <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n              ) : isEditing ? (\n                t(\"æ›´æ–°\", \"Update\")\n              ) : (\n                t(\"åºƒå‘Šã‚’ä½œæˆ\", \"Create Advertisement\")\n              )}\n            </Button>\n          </div>\n        </>\n      )}\n    </div>\n  )\n}\n\nexport const AdvertisementsFragment = graphql(\n  `fragment AdvertisementsFields on CustomerAdvertisementNode @_unmask {\n      id\n      imageUrl\n      url\n      displayProbability\n      clickCount\n      impressionCount\n      isSensitive\n      createdAt\n      page\n      startAt\n      endAt\n      isActive\n  }`,\n)\n\n// è‡ªèº«ã®åºƒå‘Šä¸€è¦§ã‚’å–å¾—ã™ã‚‹ã‚¯ã‚¨ãƒª\nconst viewerAdvertisementsQuery = graphql(\n  `query ViewerAdvertisements($limit: Int!, $offset: Int!, $where: CustomerAdvertisementsWhereInput) {\n    viewer {\n      id\n      customerAdvertisements(limit: $limit, offset: $offset, where: $where) {\n        ...AdvertisementsFields\n      }\n    }\n  }`,\n  [AdvertisementsFragment],\n)\n\n// åºƒå‘Šã‚’ä½œæˆã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst createCustomerAdvertisement = graphql(\n  `mutation CreateCustomerAdvertisement($input: CreateCustomerAdvertisement!) {\n    createCustomerAdvertisement(input: $input) {\n      id\n    }\n  }`,\n)\n\n// åºƒå‘Šã‚’æ›´æ–°ã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst updateCustomerAdvertisement = graphql(\n  `mutation UpdateCustomerAdvertisement($input: UpdateCustomerAdvertisement!) {\n    updateCustomerAdvertisement(input: $input) {\n      id\n    }\n  }`,\n)\n\n// åºƒå‘Šã‚’å‰Šé™¤ã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst deleteCustomerAdvertisement = graphql(\n  `mutation DeleteCustomerAdvertisement($input: DeleteCustomerAdvertisementInput!) {\n    deleteCustomerAdvertisement(input: $input)\n  }`,\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst viewerIsAdvertiserQuery = graphql(\n  `query ViewerIsAdvertiser {\n    viewer {\n      isAdvertiser\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.advertisements/_components/setting-advertisements-form.tsx"},"span":[11849,12125],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { ApolloError, useMutation, useQuery } from \"@apollo/client/index\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport { type SetStateAction, useContext, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { toDateText } from \"~/utils/to-date-text\"\nimport { addHours, endOfMonth, format, startOfMonth } from \"date-fns\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { Loader2Icon } from \"lucide-react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { getBase64FromImageUrl } from \"~/utils/get-base64-from-image-url\"\nimport { Link } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { SettingsAdvertisementsDeleteConfirmDialog } from \"~/routes/($lang).settings.advertisements/_components/settings-advertisements-delete-confirm-dialog\"\n\n// æ—¥æœ¬æ™‚é–“ (JST) ã«å¤‰æ›ã™ã‚‹ãŸã‚ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°\nconst toJST = (date: Date) => {\n  return addHours(date, 9) // UTCã«å¯¾ã—ã¦+9æ™‚é–“ã§JSTã«å¤‰æ›\n}\n\nexport function SettingAdvertisementsForm () {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const { data: isAdvertiser, loading: isAdvertiserLoading } = useQuery(\n    viewerIsAdvertiserQuery,\n  )\n\n  if (isAdvertiser?.viewer?.isAdvertiser === false) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const [newAdvertisement, setNewAdvertisement] = useState({\n    imageUrl: \"\",\n    url: \"\",\n    displayProbability: 0,\n    isSensitive: false,\n    isActive: false,\n    startAt: \"\",\n    endAt: \"\",\n  })\n\n  const { data: token } = useQuery(viewerTokenQuery, {\n    skip: authContext.isLoading,\n  })\n  const [date, setDate] = useState<Date | null>(null)\n\n  const [isActive, setIsActive] = useState<boolean | undefined>(undefined)\n\n  const [isSensitiveFilter, setIsSensitiveFilter] = useState<\n    boolean | undefined\n  >(undefined)\n\n  const [isEditing, setIsEditing] = useState(false)\n\n  const [editingId, setEditingId] = useState<string | null>(null)\n\n  const [viewMode, setViewMode] = useState(\"list\") // åˆ‡ã‚Šæ›¿ãˆç”¨\n\n  const { data, loading, error, refetch } = useQuery(\n    viewerAdvertisementsQuery,\n    {\n      skip: authContext.isLoading,\n      variables: {\n        limit: 64,\n        offset: 0,\n      },\n    },\n  )\n\n  const [uploadedImageUrls, setUploadedImageUrls] = useState<string[]>([])\n\n  const [count, setCount] = useState(0)\n\n  const [imageBase64, setImageBase64] = useState<string | null>(null)\n\n  const [isUploading, setIsUploading] = useState(false)\n\n  const [createAdvertisement, { loading: isCreating }] = useMutation(\n    createCustomerAdvertisement,\n  )\n\n  const [updateAdvertisement, { loading: isUpdating }] = useMutation(\n    updateCustomerAdvertisement,\n  )\n\n  const [deleteAdvertisement, { loading: isDeleting }] = useMutation(\n    deleteCustomerAdvertisement,\n  )\n\n  // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãŸåºƒå‘Šãƒªã‚¹ãƒˆã‚’ç”Ÿæˆã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯\n  const filteredAdvertisements = data?.viewer?.customerAdvertisements.filter(\n    (advertisement) => {\n      const isActiveMatch =\n        isActive === undefined || advertisement.isActive === isActive\n      const isSensitiveMatch =\n        isSensitiveFilter === undefined ||\n        advertisement.isSensitive === isSensitiveFilter\n      return isActiveMatch && isSensitiveMatch\n    },\n  )\n\n  const handleCreate = async () => {\n    try {\n      if (!newAdvertisement.imageUrl || !newAdvertisement.url) {\n        toast(\n          t(\n            \"ç”»åƒURLã¨ãƒªãƒ³ã‚¯URLã¯å¿…é ˆã§ã™\",\n            \"Image URL and Link URL are required\",\n          ),\n        )\n        return\n      }\n\n      const selectedDate = new Date(newAdvertisement.startAt)\n\n      const startAtJST = toJST(startOfMonth(selectedDate))\n\n      const endAtJST = toJST(endOfMonth(selectedDate))\n\n      await createAdvertisement({\n        variables: {\n          input: {\n            imageUrl: newAdvertisement.imageUrl,\n            url: newAdvertisement.url,\n            displayProbability: newAdvertisement.displayProbability,\n            page: \"work\",\n            isSensitive: newAdvertisement.isSensitive,\n            isActive: newAdvertisement.isActive,\n            startAt: startAtJST.toISOString(),\n            endAt: endAtJST.toISOString(),\n          },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’ä½œæˆã—ã¾ã—ãŸ\", \"Advertisement created\"))\n      setViewMode(\"list\")\n      setIsEditing(false)\n\n      refetch({\n        limit: 64,\n        offset: 0,\n      })\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleEdit = (\n    advertisement: FragmentOf<typeof AdvertisementsFragment>,\n  ) => {\n    setNewAdvertisement({\n      imageUrl: advertisement.imageUrl,\n      url: advertisement.url,\n      displayProbability: advertisement.displayProbability,\n      isSensitive: advertisement.isSensitive,\n      isActive: advertisement.isActive,\n      startAt: startOfMonth(\n        new Date(advertisement.startAt * 1000),\n      ).toISOString(),\n      endAt: endOfMonth(new Date(advertisement.endAt * 1000)).toISOString(),\n    })\n    setIsEditing(true)\n    setEditingId(advertisement.id)\n    setViewMode(\"create\") // ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ\n  }\n\n  // å†ãƒ•ã‚§ãƒƒãƒã§æ¤œç´¢ã‚’å®Ÿè¡Œ\n  const handleSearch = () => {\n    if (date) {\n      const selectedDate = date\n      const startAtJST = toJST(startOfMonth(selectedDate))\n      const endAtJST = toJST(endOfMonth(selectedDate))\n      refetch({\n        limit: 64,\n        offset: 0,\n        where: {\n          startAtAfter: startAtJST.toISOString(),\n          endAtAfter: endAtJST.toISOString(),\n          isActive: isActive !== undefined ? isActive : undefined,\n          isSensitive:\n            isSensitiveFilter !== undefined ? isSensitiveFilter : undefined,\n        },\n      })\n    }\n  }\n\n  const handleImageUpload = async (\n    event: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    const file = event.target.files?.[0]\n    if (!file) {\n      toast(\"ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    const img = new Image()\n    const reader = new FileReader()\n\n    reader.onload = (e) => {\n      if (e.target) {\n        img.src = e.target.result as string\n        setImageBase64(img.src)\n      }\n    }\n\n    reader.onerror = () => toast(\"ç”»åƒèª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n    reader.readAsDataURL(file)\n  }\n\n  const onUpload = async () => {\n    if (!imageBase64) {\n      toast(\"ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    if (count >= 30) {\n      toast(\n        \"ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸Šé™ã§ã™ã€ä¸‹æ›¸ãã§ä¸€æ™‚æŠ•ç¨¿ã®ã®ã¡ã€æ™‚é–“ã‚’ç½®ã„ã¦ç”»é¢æ›´æ–°ã—ã¦ãã ã•ã„\",\n      )\n      return\n    }\n\n    setIsUploading(true)\n\n    const url = await uploadPublicImage(imageBase64, token?.viewer?.token)\n\n    setIsUploading(false)\n\n    if (url) {\n      setUploadedImageUrls([...uploadedImageUrls, url])\n      setImageBase64(null)\n      setCount(count + 1)\n      setNewAdvertisement({ ...newAdvertisement, imageUrl: url })\n    } else {\n      toast(\"ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n    }\n  }\n\n  const handleUpdate = async () => {\n    if (!editingId) {\n      return\n    }\n\n    try {\n      const selectedDate = new Date(newAdvertisement.startAt)\n      const startAtJST = toJST(startOfMonth(selectedDate))\n      const endAtJST = toJST(endOfMonth(selectedDate))\n\n      await updateAdvertisement({\n        variables: {\n          input: {\n            id: editingId,\n            imageUrl: newAdvertisement.imageUrl,\n            url: newAdvertisement.url,\n            displayProbability: newAdvertisement.displayProbability,\n            page: \"work\",\n            isSensitive: newAdvertisement.isSensitive,\n            isActive: newAdvertisement.isActive,\n            startAt: startAtJST.toISOString(),\n            endAt: endAtJST.toISOString(),\n          },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’æ›´æ–°ã—ã¾ã—ãŸ\", \"Advertisement updated\"))\n      setIsEditing(false)\n      setNewAdvertisement({\n        imageUrl: \"\",\n        url: \"\",\n        displayProbability: 0,\n        isSensitive: false,\n        isActive: false,\n        startAt: \"\",\n        endAt: \"\",\n      })\n      setViewMode(\"list\")\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleDelete = async (id: string) => {\n    try {\n      await deleteAdvertisement({\n        variables: {\n          input: { ids: [id] },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’å‰Šé™¤ã—ã¾ã—ãŸ\", \"Advertisement deleted\"))\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleModeSwitch = (mode: SetStateAction<string>) => {\n    setViewMode(mode)\n    setIsEditing(false)\n    setImageBase64(null)\n    setNewAdvertisement({\n      imageUrl: \"\",\n      url: \"\",\n      displayProbability: 0,\n      isSensitive: false,\n      isActive: false,\n      startAt: new Date().toISOString(),\n      endAt: new Date().toISOString(),\n    })\n  }\n\n  return (\n    <div className=\"w-full space-y-4\">\n      <div className=\"flex justify-between\">\n        <Button\n          disabled={viewMode === \"list\"}\n          onClick={() => handleModeSwitch(\"list\")}\n        >\n          {t(\"åºƒå‘Šä¸€è¦§\", \"Advertisement List\")}\n        </Button>\n        <Button onClick={() => handleModeSwitch(\"create\")}>\n          {t(\"æ–°ã—ã„åºƒå‘Šã‚’ä½œæˆ\", \"Create New Advertisement\")}\n        </Button>\n      </div>\n      {viewMode === \"list\" && (\n        <>\n          <h2>{t(\"åºƒå‘Šè¨­å®šä¸€è¦§\", \"Advertisement Settings List\")}</h2>\n          {loading && <AppLoadingPage />}\n          {error && (\n            <p>\n              {t(\"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ\", \"An error occurred\")}: {error.message}\n            </p>\n          )}\n          <div className=\"flex items-center space-x-2\">\n            <p className=\"w-24\">{t(\"é…ä¿¡æœˆ\", \"Delivery Month\")}ï¼š</p>\n            <Input\n              type=\"month\"\n              value={date ? format(date, \"yyyy-MM\") : \"\"}\n              onChange={(event) => {\n                setDate(new Date(`${event.target.value}-01`))\n              }}\n            />\n            <Button onClick={handleSearch}>{t(\"æ¤œç´¢\", \"Search\")}</Button>\n          </div>\n          <div className=\"flex flex-col space-x-2 space-y-2 md:flex-row\">\n            <div className=\"flex space-x-2\">\n              <div className=\"flex w-24 items-center space-x-2\">\n                <label htmlFor=\"activeFilter\">\n                  {t(\"æœ‰åŠ¹\", \"Active\")}\n                  <Checkbox\n                    id=\"activeFilter\"\n                    checked={isActive === true}\n                    onCheckedChange={(checked) => {\n                      setIsActive(checked === true)\n                    }}\n                  />\n                </label>\n              </div>\n              <div className=\"flex w-40 items-center space-x-2\">\n                <label htmlFor=\"sensitiveFilter\">\n                  {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")}\n                  <Checkbox\n                    id=\"sensitiveFilter\"\n                    checked={isSensitiveFilter === true}\n                    onCheckedChange={(checked) =>\n                      setIsSensitiveFilter(checked === true ? true : undefined)\n                    }\n                  />\n                </label>\n              </div>\n              <div className=\"flex w-40 items-center space-x-2\">\n                <label htmlFor=\"ageFilter\">\n                  {t(\"å…¨å¹´é½¢\", \"All Ages\")}\n                  <Checkbox\n                    id=\"ageFilter\"\n                    checked={isSensitiveFilter === false}\n                    onCheckedChange={(checked) =>\n                      setIsSensitiveFilter(checked === true ? false : undefined)\n                    }\n                  />\n                </label>\n              </div>\n            </div>\n            <Button\n              variant={\"secondary\"}\n              className=\"w-full\"\n              onClick={() => {\n                setIsActive(undefined)\n                setIsSensitiveFilter(undefined)\n              }}\n            >\n              {t(\"ã™ã¹ã¦\", \"All\")}\n            </Button>\n          </div>\n          {/* åºƒå‘Šãƒªã‚¹ãƒˆ */}\n          <Card className=\"space-y-4\">\n            <CardContent className=\"flex flex-col gap-x-2 space-y-2 p-2\">\n              {filteredAdvertisements?.map(\n                (advertisement: FragmentOf<typeof AdvertisementsFragment>) => (\n                  <Card\n                    key={advertisement.id}\n                    className=\"flex items-center justify-between border p-4\"\n                  >\n                    <CardContent className=\"flex flex-col gap-x-2 space-y-2 p-2\">\n                      <div className=\"m-auto max-w-64 space-x-4 text-wrap md:flex md:max-w-full\">\n                        <img\n                          src={advertisement.imageUrl}\n                          alt={t(\"ã‚µãƒ ãƒã‚¤ãƒ«\", \"Thumbnail\")}\n                          className=\"m-auto h-auto w-32\"\n                        />\n                        <div className=\"ml-2 flex flex-col space-y-2\">\n                          <Link\n                            target=\"_blank\"\n                            to={\n                              advertisement.url.startsWith(\"http\")\n                                ? advertisement.url\n                                : `https://${advertisement.url}`\n                            }\n                            className=\"w-64 text-wrap\"\n                          >\n                            {advertisement.url}\n                          </Link>\n                          <p>\n                            {t(\"è¡¨ç¤ºå„ªå…ˆåº¦\", \"Display Priority\")}:{\" \"}\n                            {advertisement.displayProbability}\n                          </p>\n                          <p>\n                            {t(\"è¡¨ç¤ºå›æ•°\", \"View\")}:{\" \"}\n                            {advertisement.impressionCount}\n                          </p>\n                          <p>\n                            {t(\"ã‚¯ãƒªãƒƒã‚¯å›æ•°\", \"Clicked\")}:{\" \"}\n                            {advertisement.clickCount}\n                          </p>\n                          <p>\n                            {t(\"ä½œæˆæ—¥\", \"Created At\")}:{\" \"}\n                            {toDateText(advertisement.createdAt)}\n                          </p>\n                          <p>\n                            {t(\"é…ä¿¡æ—¥\", \"Start At\")}:{\" \"}\n                            {toDateText(advertisement.startAt)}\n                          </p>\n                          <div className=\"mt-2 flex space-x-2\">\n                            <Badge\n                              variant={\n                                advertisement.isActive ? \"default\" : \"secondary\"\n                              }\n                              className=\"w-16 text-center\"\n                            >\n                              <div className=\"m-auto\">\n                                {advertisement.isActive\n                                  ? t(\"å…¬é–‹ä¸­\", \"Active\")\n                                  : t(\"éå…¬é–‹\", \"Inactive\")}\n                              </div>\n                            </Badge>\n                            <Badge\n                              variant={\"secondary\"}\n                              className=\"w-24 text-center\"\n                            >\n                              <div className=\"m-auto\">\n                                {advertisement.isSensitive\n                                  ? t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")\n                                  : t(\"å…¨å¹´é½¢\", \"All Ages\")}\n                              </div>\n                            </Badge>\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"mt-2 flex space-x-2\">\n                        <Button\n                          variant={\"secondary\"}\n                          onClick={() => handleEdit(advertisement)}\n                        >\n                          {t(\"ç·¨é›†\", \"Edit\")}\n                        </Button>\n                        <SettingsAdvertisementsDeleteConfirmDialog\n                          onDelete={async () => handleDelete(advertisement.id)}\n                        />\n                      </div>\n                    </CardContent>\n                  </Card>\n                ),\n              )}\n            </CardContent>\n          </Card>\n        </>\n      )}\n\n      {viewMode === \"create\" && (\n        <>\n          <h2>\n            {isEditing\n              ? t(\"åºƒå‘Šã‚’ç·¨é›†\", \"Edit Advertisement\")\n              : t(\"æ–°ã—ã„åºƒå‘Šã‚’ä½œæˆ\", \"Create New Advertisement\")}\n          </h2>\n          <div className=\"space-y-4\">\n            <p className=\"font-semibold text-sm\">\n              {t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n            </p>\n            {newAdvertisement.imageUrl && (\n              <div className=\"bg-zinc-100 dark:bg-zinc-800\">\n                <img\n                  className=\"m-auto max-h-32\"\n                  src={newAdvertisement.imageUrl}\n                  alt={t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n                />\n              </div>\n            )}\n            {imageBase64 && (\n              <>\n                <p className=\"font-semibold text-xs\">\n                  {t(\"ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼\", \"Preview\")}\n                </p>\n                <div className=\"bg-zinc-100 dark:bg-zinc-800\">\n                  <img\n                    className=\"m-auto max-h-32\"\n                    src={imageBase64}\n                    alt={t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n                  />\n                </div>\n              </>\n            )}\n            <Input\n              placeholder={t(\"ç”»åƒURL\", \"Image URL\")}\n              value={newAdvertisement.imageUrl}\n              onChange={(e) => {\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  imageUrl: e.target.value,\n                })\n                if (e.target.value === \"\") {\n                  setImageBase64(null)\n                }\n              }}\n              onBlur={async (e) => {\n                const imageUrl = e.target.value\n                if (imageUrl === \"\") {\n                  setImageBase64(null)\n                  return\n                }\n\n                try {\n                  const base64 = await getBase64FromImageUrl(imageUrl)\n                  setImageBase64(base64)\n                } catch (error) {\n                  console.error(\"ç”»åƒã®Base64å¤‰æ›ã«å¤±æ•—ã—ã¾ã—ãŸ\", error)\n                }\n              }}\n              disabled={isUploading || imageBase64 !== null}\n            />\n            <p className=\"text-sm opacity-80\">\n              {t(\n                \"â€» å¤–éƒ¨ã®ç”»åƒURLã‚’ç›´æ¥æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½\",\n                \"â€» You can also specify an external image URL directly\",\n              )}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <input\n                type=\"file\"\n                accept=\"image/webp,image/jpeg,image/jpg,image/png\"\n                onChange={handleImageUpload}\n                disabled={isUploading}\n                className=\"w-full\"\n              />\n              <Button\n                variant={\"secondary\"}\n                onClick={() => setImageBase64(null)}\n              >\n                {t(\"é¸æŠã—ãŸç”»åƒã‚’å‰Šé™¤\", \"Remove Selected Image\")}\n              </Button>\n            </div>\n            <Button\n              className=\"w-full items-center\"\n              onClick={onUpload}\n              disabled={!imageBase64 || isUploading}\n            >\n              {isUploading ? (\n                <Loader2Icon className=\"size-4 animate-spin\" />\n              ) : (\n                <p>{t(\"ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰\", \"Upload Image\")}</p>\n              )}\n            </Button>\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"åºƒå‘Šã®é…ä¿¡æœŸé–“ï¼ˆé…ä¿¡æœˆï¼‰\",\n                \"Advertisement Delivery Period (Delivery Month)\",\n              )}\n            </p>\n            <Input\n              type=\"month\"\n              value={format(newAdvertisement.startAt, \"yyyy-MM\")}\n              onChange={(event) => {\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  startAt: new Date(`${event.target.value}-01`).toISOString(),\n                  endAt: endOfMonth(\n                    new Date(`${event.target.value}-01`),\n                  ).toISOString(),\n                })\n              }}\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\"åºƒå‘Šã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸéš›ã®é·ç§»å…ˆ\", \"Link URL When Ad is Clicked\")}\n            </p>\n            <Input\n              placeholder={t(\"ãƒªãƒ³ã‚¯URL\", \"Link URL\")}\n              value={newAdvertisement.url}\n              onChange={(e) =>\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  url: e.target.value,\n                })\n              }\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ã‹ã©ã†ã‹\", \"Is this sensitive content?\")}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"sensitive\"\n                checked={newAdvertisement.isSensitive}\n                onCheckedChange={(checked) => {\n                  if (checked === true) {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isSensitive: true,\n                    })\n                  } else {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isSensitive: false,\n                    })\n                  }\n                }}\n              />\n              <label\n                htmlFor=\"sensitive\"\n                className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n              >\n                {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")}\n              </label>\n            </div>\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"è¡¨ç¤ºã™ã‚‹å„ªå…ˆåº¦ï¼ˆå…¨ä½“ã®æ•°å­—ã§å‡ç­‰å‰²ã‚Šã—ã¦ç¢ºç‡ã‚’ç®—å‡ºã€é«˜ã„ã»ã©ç¢ºç‡ãŒé«˜ããªã‚‹ï¼‰\",\n                \"Display priority (higher numbers increase probability)\",\n              )}\n            </p>\n            <Input\n              placeholder={t(\"è¡¨ç¤ºå„ªå…ˆåº¦\", \"Display Priority\")}\n              type=\"number\"\n              max={1000}\n              value={newAdvertisement.displayProbability}\n              onChange={(e) =>\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  displayProbability: Number.parseFloat(e.target.value),\n                })\n              }\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"æœ‰åŠ¹åŒ–ã•ã‚Œã‚‹ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™\",\n                \"Enabling this will display the ad\",\n              )}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"active\"\n                checked={newAdvertisement.isActive}\n                onCheckedChange={(checked) => {\n                  if (checked === true) {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isActive: true,\n                    })\n                  } else {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isActive: false,\n                    })\n                  }\n                }}\n              />\n              <label\n                htmlFor=\"active\"\n                className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n              >\n                {t(\"æœ‰åŠ¹åŒ–\", \"Active\")}\n              </label>\n            </div>\n            <Button\n              className=\"w-full\"\n              disabled={\n                !newAdvertisement.imageUrl ||\n                !newAdvertisement.url ||\n                isCreating ||\n                isUpdating\n              }\n              onClick={isEditing ? handleUpdate : handleCreate}\n            >\n              {isCreating || isUpdating ? (\n                <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n              ) : isEditing ? (\n                t(\"æ›´æ–°\", \"Update\")\n              ) : (\n                t(\"åºƒå‘Šã‚’ä½œæˆ\", \"Create Advertisement\")\n              )}\n            </Button>\n          </div>\n        </>\n      )}\n    </div>\n  )\n}\n\nexport const AdvertisementsFragment = graphql(\n  `fragment AdvertisementsFields on CustomerAdvertisementNode @_unmask {\n      id\n      imageUrl\n      url\n      displayProbability\n      clickCount\n      impressionCount\n      isSensitive\n      createdAt\n      page\n      startAt\n      endAt\n      isActive\n  }`,\n)\n\n// è‡ªèº«ã®åºƒå‘Šä¸€è¦§ã‚’å–å¾—ã™ã‚‹ã‚¯ã‚¨ãƒª\nconst viewerAdvertisementsQuery = graphql(\n  `query ViewerAdvertisements($limit: Int!, $offset: Int!, $where: CustomerAdvertisementsWhereInput) {\n    viewer {\n      id\n      customerAdvertisements(limit: $limit, offset: $offset, where: $where) {\n        ...AdvertisementsFields\n      }\n    }\n  }`,\n  [AdvertisementsFragment],\n)\n\n// åºƒå‘Šã‚’ä½œæˆã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst createCustomerAdvertisement = graphql(\n  `mutation CreateCustomerAdvertisement($input: CreateCustomerAdvertisement!) {\n    createCustomerAdvertisement(input: $input) {\n      id\n    }\n  }`,\n)\n\n// åºƒå‘Šã‚’æ›´æ–°ã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst updateCustomerAdvertisement = graphql(\n  `mutation UpdateCustomerAdvertisement($input: UpdateCustomerAdvertisement!) {\n    updateCustomerAdvertisement(input: $input) {\n      id\n    }\n  }`,\n)\n\n// åºƒå‘Šã‚’å‰Šé™¤ã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst deleteCustomerAdvertisement = graphql(\n  `mutation DeleteCustomerAdvertisement($input: DeleteCustomerAdvertisementInput!) {\n    deleteCustomerAdvertisement(input: $input)\n  }`,\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst viewerIsAdvertiserQuery = graphql(\n  `query ViewerIsAdvertiser {\n    viewer {\n      isAdvertiser\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.advertisements/_components/setting-advertisements-form.tsx"},"span":[21698,22265],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { ApolloError, useMutation, useQuery } from \"@apollo/client/index\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport { type SetStateAction, useContext, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { toDateText } from \"~/utils/to-date-text\"\nimport { addHours, endOfMonth, format, startOfMonth } from \"date-fns\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { Loader2Icon } from \"lucide-react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { getBase64FromImageUrl } from \"~/utils/get-base64-from-image-url\"\nimport { Link } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { SettingsAdvertisementsDeleteConfirmDialog } from \"~/routes/($lang).settings.advertisements/_components/settings-advertisements-delete-confirm-dialog\"\n\n// æ—¥æœ¬æ™‚é–“ (JST) ã«å¤‰æ›ã™ã‚‹ãŸã‚ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°\nconst toJST = (date: Date) => {\n  return addHours(date, 9) // UTCã«å¯¾ã—ã¦+9æ™‚é–“ã§JSTã«å¤‰æ›\n}\n\nexport function SettingAdvertisementsForm () {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const { data: isAdvertiser, loading: isAdvertiserLoading } = useQuery(\n    viewerIsAdvertiserQuery,\n  )\n\n  if (isAdvertiser?.viewer?.isAdvertiser === false) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const [newAdvertisement, setNewAdvertisement] = useState({\n    imageUrl: \"\",\n    url: \"\",\n    displayProbability: 0,\n    isSensitive: false,\n    isActive: false,\n    startAt: \"\",\n    endAt: \"\",\n  })\n\n  const { data: token } = useQuery(viewerTokenQuery, {\n    skip: authContext.isLoading,\n  })\n  const [date, setDate] = useState<Date | null>(null)\n\n  const [isActive, setIsActive] = useState<boolean | undefined>(undefined)\n\n  const [isSensitiveFilter, setIsSensitiveFilter] = useState<\n    boolean | undefined\n  >(undefined)\n\n  const [isEditing, setIsEditing] = useState(false)\n\n  const [editingId, setEditingId] = useState<string | null>(null)\n\n  const [viewMode, setViewMode] = useState(\"list\") // åˆ‡ã‚Šæ›¿ãˆç”¨\n\n  const { data, loading, error, refetch } = useQuery(\n    viewerAdvertisementsQuery,\n    {\n      skip: authContext.isLoading,\n      variables: {\n        limit: 64,\n        offset: 0,\n      },\n    },\n  )\n\n  const [uploadedImageUrls, setUploadedImageUrls] = useState<string[]>([])\n\n  const [count, setCount] = useState(0)\n\n  const [imageBase64, setImageBase64] = useState<string | null>(null)\n\n  const [isUploading, setIsUploading] = useState(false)\n\n  const [createAdvertisement, { loading: isCreating }] = useMutation(\n    createCustomerAdvertisement,\n  )\n\n  const [updateAdvertisement, { loading: isUpdating }] = useMutation(\n    updateCustomerAdvertisement,\n  )\n\n  const [deleteAdvertisement, { loading: isDeleting }] = useMutation(\n    deleteCustomerAdvertisement,\n  )\n\n  // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãŸåºƒå‘Šãƒªã‚¹ãƒˆã‚’ç”Ÿæˆã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯\n  const filteredAdvertisements = data?.viewer?.customerAdvertisements.filter(\n    (advertisement) => {\n      const isActiveMatch =\n        isActive === undefined || advertisement.isActive === isActive\n      const isSensitiveMatch =\n        isSensitiveFilter === undefined ||\n        advertisement.isSensitive === isSensitiveFilter\n      return isActiveMatch && isSensitiveMatch\n    },\n  )\n\n  const handleCreate = async () => {\n    try {\n      if (!newAdvertisement.imageUrl || !newAdvertisement.url) {\n        toast(\n          t(\n            \"ç”»åƒURLã¨ãƒªãƒ³ã‚¯URLã¯å¿…é ˆã§ã™\",\n            \"Image URL and Link URL are required\",\n          ),\n        )\n        return\n      }\n\n      const selectedDate = new Date(newAdvertisement.startAt)\n\n      const startAtJST = toJST(startOfMonth(selectedDate))\n\n      const endAtJST = toJST(endOfMonth(selectedDate))\n\n      await createAdvertisement({\n        variables: {\n          input: {\n            imageUrl: newAdvertisement.imageUrl,\n            url: newAdvertisement.url,\n            displayProbability: newAdvertisement.displayProbability,\n            page: \"work\",\n            isSensitive: newAdvertisement.isSensitive,\n            isActive: newAdvertisement.isActive,\n            startAt: startAtJST.toISOString(),\n            endAt: endAtJST.toISOString(),\n          },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’ä½œæˆã—ã¾ã—ãŸ\", \"Advertisement created\"))\n      setViewMode(\"list\")\n      setIsEditing(false)\n\n      refetch({\n        limit: 64,\n        offset: 0,\n      })\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleEdit = (\n    advertisement: FragmentOf<typeof AdvertisementsFragment>,\n  ) => {\n    setNewAdvertisement({\n      imageUrl: advertisement.imageUrl,\n      url: advertisement.url,\n      displayProbability: advertisement.displayProbability,\n      isSensitive: advertisement.isSensitive,\n      isActive: advertisement.isActive,\n      startAt: startOfMonth(\n        new Date(advertisement.startAt * 1000),\n      ).toISOString(),\n      endAt: endOfMonth(new Date(advertisement.endAt * 1000)).toISOString(),\n    })\n    setIsEditing(true)\n    setEditingId(advertisement.id)\n    setViewMode(\"create\") // ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ\n  }\n\n  // å†ãƒ•ã‚§ãƒƒãƒã§æ¤œç´¢ã‚’å®Ÿè¡Œ\n  const handleSearch = () => {\n    if (date) {\n      const selectedDate = date\n      const startAtJST = toJST(startOfMonth(selectedDate))\n      const endAtJST = toJST(endOfMonth(selectedDate))\n      refetch({\n        limit: 64,\n        offset: 0,\n        where: {\n          startAtAfter: startAtJST.toISOString(),\n          endAtAfter: endAtJST.toISOString(),\n          isActive: isActive !== undefined ? isActive : undefined,\n          isSensitive:\n            isSensitiveFilter !== undefined ? isSensitiveFilter : undefined,\n        },\n      })\n    }\n  }\n\n  const handleImageUpload = async (\n    event: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    const file = event.target.files?.[0]\n    if (!file) {\n      toast(\"ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    const img = new Image()\n    const reader = new FileReader()\n\n    reader.onload = (e) => {\n      if (e.target) {\n        img.src = e.target.result as string\n        setImageBase64(img.src)\n      }\n    }\n\n    reader.onerror = () => toast(\"ç”»åƒèª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n    reader.readAsDataURL(file)\n  }\n\n  const onUpload = async () => {\n    if (!imageBase64) {\n      toast(\"ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„\")\n      return\n    }\n\n    if (count >= 30) {\n      toast(\n        \"ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸Šé™ã§ã™ã€ä¸‹æ›¸ãã§ä¸€æ™‚æŠ•ç¨¿ã®ã®ã¡ã€æ™‚é–“ã‚’ç½®ã„ã¦ç”»é¢æ›´æ–°ã—ã¦ãã ã•ã„\",\n      )\n      return\n    }\n\n    setIsUploading(true)\n\n    const url = await uploadPublicImage(imageBase64, token?.viewer?.token)\n\n    setIsUploading(false)\n\n    if (url) {\n      setUploadedImageUrls([...uploadedImageUrls, url])\n      setImageBase64(null)\n      setCount(count + 1)\n      setNewAdvertisement({ ...newAdvertisement, imageUrl: url })\n    } else {\n      toast(\"ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n    }\n  }\n\n  const handleUpdate = async () => {\n    if (!editingId) {\n      return\n    }\n\n    try {\n      const selectedDate = new Date(newAdvertisement.startAt)\n      const startAtJST = toJST(startOfMonth(selectedDate))\n      const endAtJST = toJST(endOfMonth(selectedDate))\n\n      await updateAdvertisement({\n        variables: {\n          input: {\n            id: editingId,\n            imageUrl: newAdvertisement.imageUrl,\n            url: newAdvertisement.url,\n            displayProbability: newAdvertisement.displayProbability,\n            page: \"work\",\n            isSensitive: newAdvertisement.isSensitive,\n            isActive: newAdvertisement.isActive,\n            startAt: startAtJST.toISOString(),\n            endAt: endAtJST.toISOString(),\n          },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’æ›´æ–°ã—ã¾ã—ãŸ\", \"Advertisement updated\"))\n      setIsEditing(false)\n      setNewAdvertisement({\n        imageUrl: \"\",\n        url: \"\",\n        displayProbability: 0,\n        isSensitive: false,\n        isActive: false,\n        startAt: \"\",\n        endAt: \"\",\n      })\n      setViewMode(\"list\")\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleDelete = async (id: string) => {\n    try {\n      await deleteAdvertisement({\n        variables: {\n          input: { ids: [id] },\n        },\n      })\n      toast(t(\"åºƒå‘Šã‚’å‰Šé™¤ã—ã¾ã—ãŸ\", \"Advertisement deleted\"))\n    } catch (error) {\n      if (error instanceof ApolloError) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const handleModeSwitch = (mode: SetStateAction<string>) => {\n    setViewMode(mode)\n    setIsEditing(false)\n    setImageBase64(null)\n    setNewAdvertisement({\n      imageUrl: \"\",\n      url: \"\",\n      displayProbability: 0,\n      isSensitive: false,\n      isActive: false,\n      startAt: new Date().toISOString(),\n      endAt: new Date().toISOString(),\n    })\n  }\n\n  return (\n    <div className=\"w-full space-y-4\">\n      <div className=\"flex justify-between\">\n        <Button\n          disabled={viewMode === \"list\"}\n          onClick={() => handleModeSwitch(\"list\")}\n        >\n          {t(\"åºƒå‘Šä¸€è¦§\", \"Advertisement List\")}\n        </Button>\n        <Button onClick={() => handleModeSwitch(\"create\")}>\n          {t(\"æ–°ã—ã„åºƒå‘Šã‚’ä½œæˆ\", \"Create New Advertisement\")}\n        </Button>\n      </div>\n      {viewMode === \"list\" && (\n        <>\n          <h2>{t(\"åºƒå‘Šè¨­å®šä¸€è¦§\", \"Advertisement Settings List\")}</h2>\n          {loading && <AppLoadingPage />}\n          {error && (\n            <p>\n              {t(\"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ\", \"An error occurred\")}: {error.message}\n            </p>\n          )}\n          <div className=\"flex items-center space-x-2\">\n            <p className=\"w-24\">{t(\"é…ä¿¡æœˆ\", \"Delivery Month\")}ï¼š</p>\n            <Input\n              type=\"month\"\n              value={date ? format(date, \"yyyy-MM\") : \"\"}\n              onChange={(event) => {\n                setDate(new Date(`${event.target.value}-01`))\n              }}\n            />\n            <Button onClick={handleSearch}>{t(\"æ¤œç´¢\", \"Search\")}</Button>\n          </div>\n          <div className=\"flex flex-col space-x-2 space-y-2 md:flex-row\">\n            <div className=\"flex space-x-2\">\n              <div className=\"flex w-24 items-center space-x-2\">\n                <label htmlFor=\"activeFilter\">\n                  {t(\"æœ‰åŠ¹\", \"Active\")}\n                  <Checkbox\n                    id=\"activeFilter\"\n                    checked={isActive === true}\n                    onCheckedChange={(checked) => {\n                      setIsActive(checked === true)\n                    }}\n                  />\n                </label>\n              </div>\n              <div className=\"flex w-40 items-center space-x-2\">\n                <label htmlFor=\"sensitiveFilter\">\n                  {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")}\n                  <Checkbox\n                    id=\"sensitiveFilter\"\n                    checked={isSensitiveFilter === true}\n                    onCheckedChange={(checked) =>\n                      setIsSensitiveFilter(checked === true ? true : undefined)\n                    }\n                  />\n                </label>\n              </div>\n              <div className=\"flex w-40 items-center space-x-2\">\n                <label htmlFor=\"ageFilter\">\n                  {t(\"å…¨å¹´é½¢\", \"All Ages\")}\n                  <Checkbox\n                    id=\"ageFilter\"\n                    checked={isSensitiveFilter === false}\n                    onCheckedChange={(checked) =>\n                      setIsSensitiveFilter(checked === true ? false : undefined)\n                    }\n                  />\n                </label>\n              </div>\n            </div>\n            <Button\n              variant={\"secondary\"}\n              className=\"w-full\"\n              onClick={() => {\n                setIsActive(undefined)\n                setIsSensitiveFilter(undefined)\n              }}\n            >\n              {t(\"ã™ã¹ã¦\", \"All\")}\n            </Button>\n          </div>\n          {/* åºƒå‘Šãƒªã‚¹ãƒˆ */}\n          <Card className=\"space-y-4\">\n            <CardContent className=\"flex flex-col gap-x-2 space-y-2 p-2\">\n              {filteredAdvertisements?.map(\n                (advertisement: FragmentOf<typeof AdvertisementsFragment>) => (\n                  <Card\n                    key={advertisement.id}\n                    className=\"flex items-center justify-between border p-4\"\n                  >\n                    <CardContent className=\"flex flex-col gap-x-2 space-y-2 p-2\">\n                      <div className=\"m-auto max-w-64 space-x-4 text-wrap md:flex md:max-w-full\">\n                        <img\n                          src={advertisement.imageUrl}\n                          alt={t(\"ã‚µãƒ ãƒã‚¤ãƒ«\", \"Thumbnail\")}\n                          className=\"m-auto h-auto w-32\"\n                        />\n                        <div className=\"ml-2 flex flex-col space-y-2\">\n                          <Link\n                            target=\"_blank\"\n                            to={\n                              advertisement.url.startsWith(\"http\")\n                                ? advertisement.url\n                                : `https://${advertisement.url}`\n                            }\n                            className=\"w-64 text-wrap\"\n                          >\n                            {advertisement.url}\n                          </Link>\n                          <p>\n                            {t(\"è¡¨ç¤ºå„ªå…ˆåº¦\", \"Display Priority\")}:{\" \"}\n                            {advertisement.displayProbability}\n                          </p>\n                          <p>\n                            {t(\"è¡¨ç¤ºå›æ•°\", \"View\")}:{\" \"}\n                            {advertisement.impressionCount}\n                          </p>\n                          <p>\n                            {t(\"ã‚¯ãƒªãƒƒã‚¯å›æ•°\", \"Clicked\")}:{\" \"}\n                            {advertisement.clickCount}\n                          </p>\n                          <p>\n                            {t(\"ä½œæˆæ—¥\", \"Created At\")}:{\" \"}\n                            {toDateText(advertisement.createdAt)}\n                          </p>\n                          <p>\n                            {t(\"é…ä¿¡æ—¥\", \"Start At\")}:{\" \"}\n                            {toDateText(advertisement.startAt)}\n                          </p>\n                          <div className=\"mt-2 flex space-x-2\">\n                            <Badge\n                              variant={\n                                advertisement.isActive ? \"default\" : \"secondary\"\n                              }\n                              className=\"w-16 text-center\"\n                            >\n                              <div className=\"m-auto\">\n                                {advertisement.isActive\n                                  ? t(\"å…¬é–‹ä¸­\", \"Active\")\n                                  : t(\"éå…¬é–‹\", \"Inactive\")}\n                              </div>\n                            </Badge>\n                            <Badge\n                              variant={\"secondary\"}\n                              className=\"w-24 text-center\"\n                            >\n                              <div className=\"m-auto\">\n                                {advertisement.isSensitive\n                                  ? t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")\n                                  : t(\"å…¨å¹´é½¢\", \"All Ages\")}\n                              </div>\n                            </Badge>\n                          </div>\n                        </div>\n                      </div>\n                      <div className=\"mt-2 flex space-x-2\">\n                        <Button\n                          variant={\"secondary\"}\n                          onClick={() => handleEdit(advertisement)}\n                        >\n                          {t(\"ç·¨é›†\", \"Edit\")}\n                        </Button>\n                        <SettingsAdvertisementsDeleteConfirmDialog\n                          onDelete={async () => handleDelete(advertisement.id)}\n                        />\n                      </div>\n                    </CardContent>\n                  </Card>\n                ),\n              )}\n            </CardContent>\n          </Card>\n        </>\n      )}\n\n      {viewMode === \"create\" && (\n        <>\n          <h2>\n            {isEditing\n              ? t(\"åºƒå‘Šã‚’ç·¨é›†\", \"Edit Advertisement\")\n              : t(\"æ–°ã—ã„åºƒå‘Šã‚’ä½œæˆ\", \"Create New Advertisement\")}\n          </h2>\n          <div className=\"space-y-4\">\n            <p className=\"font-semibold text-sm\">\n              {t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n            </p>\n            {newAdvertisement.imageUrl && (\n              <div className=\"bg-zinc-100 dark:bg-zinc-800\">\n                <img\n                  className=\"m-auto max-h-32\"\n                  src={newAdvertisement.imageUrl}\n                  alt={t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n                />\n              </div>\n            )}\n            {imageBase64 && (\n              <>\n                <p className=\"font-semibold text-xs\">\n                  {t(\"ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼\", \"Preview\")}\n                </p>\n                <div className=\"bg-zinc-100 dark:bg-zinc-800\">\n                  <img\n                    className=\"m-auto max-h-32\"\n                    src={imageBase64}\n                    alt={t(\"åºƒå‘Šç”»åƒ\", \"Advertisement Image\")}\n                  />\n                </div>\n              </>\n            )}\n            <Input\n              placeholder={t(\"ç”»åƒURL\", \"Image URL\")}\n              value={newAdvertisement.imageUrl}\n              onChange={(e) => {\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  imageUrl: e.target.value,\n                })\n                if (e.target.value === \"\") {\n                  setImageBase64(null)\n                }\n              }}\n              onBlur={async (e) => {\n                const imageUrl = e.target.value\n                if (imageUrl === \"\") {\n                  setImageBase64(null)\n                  return\n                }\n\n                try {\n                  const base64 = await getBase64FromImageUrl(imageUrl)\n                  setImageBase64(base64)\n                } catch (error) {\n                  console.error(\"ç”»åƒã®Base64å¤‰æ›ã«å¤±æ•—ã—ã¾ã—ãŸ\", error)\n                }\n              }}\n              disabled={isUploading || imageBase64 !== null}\n            />\n            <p className=\"text-sm opacity-80\">\n              {t(\n                \"â€» å¤–éƒ¨ã®ç”»åƒURLã‚’ç›´æ¥æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½\",\n                \"â€» You can also specify an external image URL directly\",\n              )}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <input\n                type=\"file\"\n                accept=\"image/webp,image/jpeg,image/jpg,image/png\"\n                onChange={handleImageUpload}\n                disabled={isUploading}\n                className=\"w-full\"\n              />\n              <Button\n                variant={\"secondary\"}\n                onClick={() => setImageBase64(null)}\n              >\n                {t(\"é¸æŠã—ãŸç”»åƒã‚’å‰Šé™¤\", \"Remove Selected Image\")}\n              </Button>\n            </div>\n            <Button\n              className=\"w-full items-center\"\n              onClick={onUpload}\n              disabled={!imageBase64 || isUploading}\n            >\n              {isUploading ? (\n                <Loader2Icon className=\"size-4 animate-spin\" />\n              ) : (\n                <p>{t(\"ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰\", \"Upload Image\")}</p>\n              )}\n            </Button>\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"åºƒå‘Šã®é…ä¿¡æœŸé–“ï¼ˆé…ä¿¡æœˆï¼‰\",\n                \"Advertisement Delivery Period (Delivery Month)\",\n              )}\n            </p>\n            <Input\n              type=\"month\"\n              value={format(newAdvertisement.startAt, \"yyyy-MM\")}\n              onChange={(event) => {\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  startAt: new Date(`${event.target.value}-01`).toISOString(),\n                  endAt: endOfMonth(\n                    new Date(`${event.target.value}-01`),\n                  ).toISOString(),\n                })\n              }}\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\"åºƒå‘Šã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸéš›ã®é·ç§»å…ˆ\", \"Link URL When Ad is Clicked\")}\n            </p>\n            <Input\n              placeholder={t(\"ãƒªãƒ³ã‚¯URL\", \"Link URL\")}\n              value={newAdvertisement.url}\n              onChange={(e) =>\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  url: e.target.value,\n                })\n              }\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ã‹ã©ã†ã‹\", \"Is this sensitive content?\")}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"sensitive\"\n                checked={newAdvertisement.isSensitive}\n                onCheckedChange={(checked) => {\n                  if (checked === true) {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isSensitive: true,\n                    })\n                  } else {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isSensitive: false,\n                    })\n                  }\n                }}\n              />\n              <label\n                htmlFor=\"sensitive\"\n                className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n              >\n                {t(\"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–\", \"Sensitive\")}\n              </label>\n            </div>\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"è¡¨ç¤ºã™ã‚‹å„ªå…ˆåº¦ï¼ˆå…¨ä½“ã®æ•°å­—ã§å‡ç­‰å‰²ã‚Šã—ã¦ç¢ºç‡ã‚’ç®—å‡ºã€é«˜ã„ã»ã©ç¢ºç‡ãŒé«˜ããªã‚‹ï¼‰\",\n                \"Display priority (higher numbers increase probability)\",\n              )}\n            </p>\n            <Input\n              placeholder={t(\"è¡¨ç¤ºå„ªå…ˆåº¦\", \"Display Priority\")}\n              type=\"number\"\n              max={1000}\n              value={newAdvertisement.displayProbability}\n              onChange={(e) =>\n                setNewAdvertisement({\n                  ...newAdvertisement,\n                  displayProbability: Number.parseFloat(e.target.value),\n                })\n              }\n            />\n            <Separator />\n            <p className=\"font-semibold text-sm\">\n              {t(\n                \"æœ‰åŠ¹åŒ–ã•ã‚Œã‚‹ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™\",\n                \"Enabling this will display the ad\",\n              )}\n            </p>\n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"active\"\n                checked={newAdvertisement.isActive}\n                onCheckedChange={(checked) => {\n                  if (checked === true) {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isActive: true,\n                    })\n                  } else {\n                    setNewAdvertisement({\n                      ...newAdvertisement,\n                      isActive: false,\n                    })\n                  }\n                }}\n              />\n              <label\n                htmlFor=\"active\"\n                className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n              >\n                {t(\"æœ‰åŠ¹åŒ–\", \"Active\")}\n              </label>\n            </div>\n            <Button\n              className=\"w-full\"\n              disabled={\n                !newAdvertisement.imageUrl ||\n                !newAdvertisement.url ||\n                isCreating ||\n                isUpdating\n              }\n              onClick={isEditing ? handleUpdate : handleCreate}\n            >\n              {isCreating || isUpdating ? (\n                <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n              ) : isEditing ? (\n                t(\"æ›´æ–°\", \"Update\")\n              ) : (\n                t(\"åºƒå‘Šã‚’ä½œæˆ\", \"Create Advertisement\")\n              )}\n            </Button>\n          </div>\n        </>\n      )}\n    </div>\n  )\n}\n\nexport const AdvertisementsFragment = graphql(\n  `fragment AdvertisementsFields on CustomerAdvertisementNode @_unmask {\n      id\n      imageUrl\n      url\n      displayProbability\n      clickCount\n      impressionCount\n      isSensitive\n      createdAt\n      page\n      startAt\n      endAt\n      isActive\n  }`,\n)\n\n// è‡ªèº«ã®åºƒå‘Šä¸€è¦§ã‚’å–å¾—ã™ã‚‹ã‚¯ã‚¨ãƒª\nconst viewerAdvertisementsQuery = graphql(\n  `query ViewerAdvertisements($limit: Int!, $offset: Int!, $where: CustomerAdvertisementsWhereInput) {\n    viewer {\n      id\n      customerAdvertisements(limit: $limit, offset: $offset, where: $where) {\n        ...AdvertisementsFields\n      }\n    }\n  }`,\n  [AdvertisementsFragment],\n)\n\n// åºƒå‘Šã‚’ä½œæˆã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst createCustomerAdvertisement = graphql(\n  `mutation CreateCustomerAdvertisement($input: CreateCustomerAdvertisement!) {\n    createCustomerAdvertisement(input: $input) {\n      id\n    }\n  }`,\n)\n\n// åºƒå‘Šã‚’æ›´æ–°ã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst updateCustomerAdvertisement = graphql(\n  `mutation UpdateCustomerAdvertisement($input: UpdateCustomerAdvertisement!) {\n    updateCustomerAdvertisement(input: $input) {\n      id\n    }\n  }`,\n)\n\n// åºƒå‘Šã‚’å‰Šé™¤ã™ã‚‹ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³\nconst deleteCustomerAdvertisement = graphql(\n  `mutation DeleteCustomerAdvertisement($input: DeleteCustomerAdvertisementInput!) {\n    deleteCustomerAdvertisement(input: $input)\n  }`,\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst viewerIsAdvertiserQuery = graphql(\n  `query ViewerIsAdvertiser {\n    viewer {\n      isAdvertiser\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.color/route.tsx"},"span":[3399,3412],"sourceCode":"import { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { Tabs, TabsList, TabsTrigger } from \"~/components/ui/tabs\"\nimport { useTheme } from \"next-themes\"\nimport { useState } from \"react\"\nimport { SettingsHeader } from \"~/routes/($lang).settings/components/settings-header\"\nimport { Separator } from \"~/components/ui/separator\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { config, META } from \"~/config\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { cn } from \"~/lib/utils\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.SETTINGS_COLOR, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  return {}\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function SettingColor () {\n  const t = useTranslation()\n  const [activeTab, setActiveTab] = useState<string>(\"sampleTab1\")\n  const [activePage, setActivePage] = useState<number>(1)\n  const { theme, setTheme } = useTheme()\n\n  const handleTabClick = (value: string) => setActiveTab(value)\n\n  const setColorTheme = (mode: string, color: string) => {\n    setTheme(\n      mode === \"system\"\n        ? \"system\"\n        : color === \"none\"\n          ? mode\n          : `${mode}-${color}`,\n    )\n  }\n\n  const getMode = (theme: string): string => {\n    if ([\"system\", \"light\", \"dark\"].includes(theme)) return theme\n    return theme.startsWith(\"light-\")\n      ? \"light\"\n      : theme.startsWith(\"dark-\")\n        ? \"dark\"\n        : \"system\"\n  }\n\n  const getColorSchema = (theme: string): string => {\n    if ([\"system\", \"light\", \"dark\"].includes(theme)) return \"none\"\n    return theme.replace(/(light|dark)-/, \"\") ?? \"none\"\n  }\n\n  const mode = getMode(theme ?? \"system\")\n  const colorSchema = getColorSchema(theme ?? \"system\")\n\n  const themeRadio = (value: string, label: string) => (\n    <div\n      className={cn(\n        \"flex w-full cursor-pointer items-center space-x-2 rounded-lg border p-2 transition duration-150 hover:bg-gray-100 dark:hover:bg-gray-800\",\n        { \"bg-gray-100 bg-opacity-50 dark:bg-gray-800\": mode === value },\n      )}\n      onClick={() => setColorTheme(value, colorSchema)}\n      onKeyUp={(e) => {\n        if (e.key === \"Enter\" || e.key === \" \") {\n          setColorTheme(value, colorSchema)\n        }\n      }}\n    >\n      <RadioGroupItem value={value} id={value} className=\"peer hidden\" />\n      <label\n        htmlFor={value}\n        className=\"flex cursor-pointer items-center peer-checked:text-blue-500\"\n      >\n        <span className=\"flex size-4 items-center justify-center rounded-full border border-gray-300 transition duration-150 peer-checked:border-blue-500 peer-checked:bg-blue-500\" />\n        <span className=\"ml-2\">{t(label, label)}</span>\n      </label>\n    </div>\n  )\n\n  const themeRadioColor = (\n    value: string,\n    label: string,\n    colorValue: string,\n  ) => (\n    // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n    <div\n      className={cn(\n        \"flex w-full cursor-pointer items-center space-x-2 rounded-lg border p-2 transition duration-150 hover:bg-gray-100 dark:hover:bg-gray-800\",\n        { \"bg-gray-100 bg-opacity-50 dark:bg-gray-800\": colorSchema === value },\n      )}\n      onClick={() => setColorTheme(mode, value)}\n    >\n      <RadioGroupItem value={value} id={value} className=\"peer hidden\" />\n      <label\n        htmlFor={value}\n        className=\"flex cursor-pointer items-center peer-checked:text-blue-500\"\n      >\n        <span\n          className={cn(\n            \"flex size-4 items-center justify-center rounded-full transition duration-150 peer-checked:ring-2 peer-checked:ring-blue-500\",\n            colorValue,\n          )}\n        />\n        <span className=\"ml-2\">{t(label, label)}</span>\n      </label>\n    </div>\n  )\n\n  return (\n    <div className=\"flex flex-col space-y-2\">\n      <div className=\"block md:hidden\">\n        <SettingsHeader title={t(\"ã‚«ãƒ©ãƒ¼ãƒ†ãƒ¼ãƒ\", \"Color Theme\")} />\n      </div>\n      <RadioGroup\n        value={mode}\n        name=\"mode\"\n        onValueChange={(value) => setColorTheme(value, colorSchema)}\n        className=\"space-y-2\"\n      >\n        <div className=\"space-y-2\">\n          {themeRadio(\n            \"system\",\n            t(\"ãƒ‡ãƒã‚¤ã‚¹ã®ãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹\", \"Use device mode\"),\n          )}\n          {themeRadio(\"light\", t(\"ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰\", \"Light mode\"))}\n          {themeRadio(\"dark\", t(\"ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰\", \"Dark mode\"))}\n        </div>\n        <p className=\"text-sm\">\n          {t(\n            \"ãƒ©ã‚¤ãƒˆã‹ãƒ€ãƒ¼ã‚¯ã‚’é¸æŠã™ã‚‹ã¨è‰²ã‚‚é¸ã¹ã¾ã™ã€‚\",\n            \"You can select colors if you choose Light or Dark mode.\",\n          )}\n        </p>\n        <Separator />\n      </RadioGroup>\n      <div className={cn(\"space-y-2\", { \"opacity-20\": theme === \"system\" })}>\n        <RadioGroup\n          value={colorSchema}\n          name=\"colorSchema\"\n          onValueChange={(value) => setColorTheme(mode, value)}\n          className=\"space-y-2\"\n        >\n          <div className=\"grid grid-cols-2 gap-2 md:grid-cols-3\">\n            {themeRadioColor(\"none\", t(\"ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ\", \"Default\"), \"bg-gray-100\")}\n            {themeRadioColor(\"gray\", t(\"ã‚°ãƒ¬ãƒ¼\", \"Gray\"), \"bg-gray-500\")}\n            {themeRadioColor(\"red\", t(\"ãƒ¬ãƒƒãƒ‰\", \"Red\"), \"bg-red-500\")}\n            {themeRadioColor(\"pink\", t(\"ãƒ”ãƒ³ã‚¯\", \"Pink\"), \"bg-pink-500\")}\n            {themeRadioColor(\n              \"orange\",\n              t(\"ã‚ªãƒ¬ãƒ³ã‚¸\", \"Orange\"),\n              \"bg-orange-500\",\n            )}\n            {themeRadioColor(\"green\", t(\"ã‚°ãƒªãƒ¼ãƒ³\", \"Green\"), \"bg-green-500\")}\n            {themeRadioColor(\"blue\", t(\"ãƒ–ãƒ«ãƒ¼\", \"Blue\"), \"bg-blue-500\")}\n            {themeRadioColor(\n              \"yellow\",\n              t(\"ã‚¤ã‚¨ãƒ­ãƒ¼\", \"Yellow\"),\n              \"bg-yellow-500\",\n            )}\n            {themeRadioColor(\n              \"violet\",\n              t(\"ãƒã‚¤ã‚ªãƒ¬ãƒƒãƒˆ\", \"Violet\"),\n              \"bg-violet-500\",\n            )}\n          </div>\n        </RadioGroup>\n        <div className=\"mt-4 flex flex-wrap gap-2\">\n          <Button variant=\"default\">{t(\"ãƒœã‚¿ãƒ³\", \"Button\")}</Button>\n          <Button variant=\"destructive\">\n            {t(\"destructive\", \"Destructive\")}\n          </Button>\n          <Button variant=\"outline\">{t(\"outline\", \"Outline\")}</Button>\n          <Button variant=\"secondary\">{t(\"secondary\", \"Secondary\")}</Button>\n          <Button variant=\"ghost\">{t(\"ghost\", \"Ghost\")}</Button>\n          <Button variant=\"link\">{t(\"link\", \"Link\")}</Button>\n        </div>\n        <div className=\"mt-4 space-y-2\">\n          <Input\n            className=\"mx-2 w-80\"\n            id=\"sampleText1\"\n            placeholder={t(\"ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼\", \"Placeholder\")}\n            onChange={(_e) => {}}\n          />\n          <Input\n            className=\"mx-2 w-80\"\n            id=\"sampleText2\"\n            placeholder=\"\"\n            value={t(\"å…¥åŠ›æ¸ˆã¿\", \"Filled\")}\n            onChange={(_e) => {}}\n          />\n        </div>\n        <Tabs>\n          <div className=\"border-b\">\n            <TabsList className=\"flex space-x-2\">\n              <TabsTrigger\n                value=\"sampleTab1\"\n                onClick={() => handleTabClick(\"sampleTab1\")}\n                className={activeTab === \"sampleTab1\" ? \"active-tab\" : \"\"}\n              >\n                {t(\"ã‚¿ãƒ–1\", \"Tab 1\")}\n              </TabsTrigger>\n              <TabsTrigger\n                value=\"sampleTab2\"\n                onClick={() => handleTabClick(\"sampleTab2\")}\n                className={activeTab === \"sampleTab2\" ? \"active-tab\" : \"\"}\n              >\n                {t(\"ã‚¿ãƒ–2\", \"Tab 2\")}\n              </TabsTrigger>\n              <TabsTrigger\n                value=\"sampleTab3\"\n                onClick={() => handleTabClick(\"sampleTab3\")}\n                className={activeTab === \"sampleTab3\" ? \"active-tab\" : \"\"}\n              >\n                {t(\"ã‚¿ãƒ–3\", \"Tab 3\")}\n              </TabsTrigger>\n            </TabsList>\n          </div>\n        </Tabs>\n        <ResponsivePagination\n          perPage={32}\n          maxCount={200}\n          currentPage={activePage}\n          onPageChange={(page: number) => setActivePage(page)}\n        />\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.color/route.tsx"},"span":[7034,7221],"sourceCode":"import { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { Tabs, TabsList, TabsTrigger } from \"~/components/ui/tabs\"\nimport { useTheme } from \"next-themes\"\nimport { useState } from \"react\"\nimport { SettingsHeader } from \"~/routes/($lang).settings/components/settings-header\"\nimport { Separator } from \"~/components/ui/separator\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { config, META } from \"~/config\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { cn } from \"~/lib/utils\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.SETTINGS_COLOR, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  return {}\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function SettingColor () {\n  const t = useTranslation()\n  const [activeTab, setActiveTab] = useState<string>(\"sampleTab1\")\n  const [activePage, setActivePage] = useState<number>(1)\n  const { theme, setTheme } = useTheme()\n\n  const handleTabClick = (value: string) => setActiveTab(value)\n\n  const setColorTheme = (mode: string, color: string) => {\n    setTheme(\n      mode === \"system\"\n        ? \"system\"\n        : color === \"none\"\n          ? mode\n          : `${mode}-${color}`,\n    )\n  }\n\n  const getMode = (theme: string): string => {\n    if ([\"system\", \"light\", \"dark\"].includes(theme)) return theme\n    return theme.startsWith(\"light-\")\n      ? \"light\"\n      : theme.startsWith(\"dark-\")\n        ? \"dark\"\n        : \"system\"\n  }\n\n  const getColorSchema = (theme: string): string => {\n    if ([\"system\", \"light\", \"dark\"].includes(theme)) return \"none\"\n    return theme.replace(/(light|dark)-/, \"\") ?? \"none\"\n  }\n\n  const mode = getMode(theme ?? \"system\")\n  const colorSchema = getColorSchema(theme ?? \"system\")\n\n  const themeRadio = (value: string, label: string) => (\n    <div\n      className={cn(\n        \"flex w-full cursor-pointer items-center space-x-2 rounded-lg border p-2 transition duration-150 hover:bg-gray-100 dark:hover:bg-gray-800\",\n        { \"bg-gray-100 bg-opacity-50 dark:bg-gray-800\": mode === value },\n      )}\n      onClick={() => setColorTheme(value, colorSchema)}\n      onKeyUp={(e) => {\n        if (e.key === \"Enter\" || e.key === \" \") {\n          setColorTheme(value, colorSchema)\n        }\n      }}\n    >\n      <RadioGroupItem value={value} id={value} className=\"peer hidden\" />\n      <label\n        htmlFor={value}\n        className=\"flex cursor-pointer items-center peer-checked:text-blue-500\"\n      >\n        <span className=\"flex size-4 items-center justify-center rounded-full border border-gray-300 transition duration-150 peer-checked:border-blue-500 peer-checked:bg-blue-500\" />\n        <span className=\"ml-2\">{t(label, label)}</span>\n      </label>\n    </div>\n  )\n\n  const themeRadioColor = (\n    value: string,\n    label: string,\n    colorValue: string,\n  ) => (\n    // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n    <div\n      className={cn(\n        \"flex w-full cursor-pointer items-center space-x-2 rounded-lg border p-2 transition duration-150 hover:bg-gray-100 dark:hover:bg-gray-800\",\n        { \"bg-gray-100 bg-opacity-50 dark:bg-gray-800\": colorSchema === value },\n      )}\n      onClick={() => setColorTheme(mode, value)}\n    >\n      <RadioGroupItem value={value} id={value} className=\"peer hidden\" />\n      <label\n        htmlFor={value}\n        className=\"flex cursor-pointer items-center peer-checked:text-blue-500\"\n      >\n        <span\n          className={cn(\n            \"flex size-4 items-center justify-center rounded-full transition duration-150 peer-checked:ring-2 peer-checked:ring-blue-500\",\n            colorValue,\n          )}\n        />\n        <span className=\"ml-2\">{t(label, label)}</span>\n      </label>\n    </div>\n  )\n\n  return (\n    <div className=\"flex flex-col space-y-2\">\n      <div className=\"block md:hidden\">\n        <SettingsHeader title={t(\"ã‚«ãƒ©ãƒ¼ãƒ†ãƒ¼ãƒ\", \"Color Theme\")} />\n      </div>\n      <RadioGroup\n        value={mode}\n        name=\"mode\"\n        onValueChange={(value) => setColorTheme(value, colorSchema)}\n        className=\"space-y-2\"\n      >\n        <div className=\"space-y-2\">\n          {themeRadio(\n            \"system\",\n            t(\"ãƒ‡ãƒã‚¤ã‚¹ã®ãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹\", \"Use device mode\"),\n          )}\n          {themeRadio(\"light\", t(\"ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰\", \"Light mode\"))}\n          {themeRadio(\"dark\", t(\"ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰\", \"Dark mode\"))}\n        </div>\n        <p className=\"text-sm\">\n          {t(\n            \"ãƒ©ã‚¤ãƒˆã‹ãƒ€ãƒ¼ã‚¯ã‚’é¸æŠã™ã‚‹ã¨è‰²ã‚‚é¸ã¹ã¾ã™ã€‚\",\n            \"You can select colors if you choose Light or Dark mode.\",\n          )}\n        </p>\n        <Separator />\n      </RadioGroup>\n      <div className={cn(\"space-y-2\", { \"opacity-20\": theme === \"system\" })}>\n        <RadioGroup\n          value={colorSchema}\n          name=\"colorSchema\"\n          onValueChange={(value) => setColorTheme(mode, value)}\n          className=\"space-y-2\"\n        >\n          <div className=\"grid grid-cols-2 gap-2 md:grid-cols-3\">\n            {themeRadioColor(\"none\", t(\"ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ\", \"Default\"), \"bg-gray-100\")}\n            {themeRadioColor(\"gray\", t(\"ã‚°ãƒ¬ãƒ¼\", \"Gray\"), \"bg-gray-500\")}\n            {themeRadioColor(\"red\", t(\"ãƒ¬ãƒƒãƒ‰\", \"Red\"), \"bg-red-500\")}\n            {themeRadioColor(\"pink\", t(\"ãƒ”ãƒ³ã‚¯\", \"Pink\"), \"bg-pink-500\")}\n            {themeRadioColor(\n              \"orange\",\n              t(\"ã‚ªãƒ¬ãƒ³ã‚¸\", \"Orange\"),\n              \"bg-orange-500\",\n            )}\n            {themeRadioColor(\"green\", t(\"ã‚°ãƒªãƒ¼ãƒ³\", \"Green\"), \"bg-green-500\")}\n            {themeRadioColor(\"blue\", t(\"ãƒ–ãƒ«ãƒ¼\", \"Blue\"), \"bg-blue-500\")}\n            {themeRadioColor(\n              \"yellow\",\n              t(\"ã‚¤ã‚¨ãƒ­ãƒ¼\", \"Yellow\"),\n              \"bg-yellow-500\",\n            )}\n            {themeRadioColor(\n              \"violet\",\n              t(\"ãƒã‚¤ã‚ªãƒ¬ãƒƒãƒˆ\", \"Violet\"),\n              \"bg-violet-500\",\n            )}\n          </div>\n        </RadioGroup>\n        <div className=\"mt-4 flex flex-wrap gap-2\">\n          <Button variant=\"default\">{t(\"ãƒœã‚¿ãƒ³\", \"Button\")}</Button>\n          <Button variant=\"destructive\">\n            {t(\"destructive\", \"Destructive\")}\n          </Button>\n          <Button variant=\"outline\">{t(\"outline\", \"Outline\")}</Button>\n          <Button variant=\"secondary\">{t(\"secondary\", \"Secondary\")}</Button>\n          <Button variant=\"ghost\">{t(\"ghost\", \"Ghost\")}</Button>\n          <Button variant=\"link\">{t(\"link\", \"Link\")}</Button>\n        </div>\n        <div className=\"mt-4 space-y-2\">\n          <Input\n            className=\"mx-2 w-80\"\n            id=\"sampleText1\"\n            placeholder={t(\"ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼\", \"Placeholder\")}\n            onChange={(_e) => {}}\n          />\n          <Input\n            className=\"mx-2 w-80\"\n            id=\"sampleText2\"\n            placeholder=\"\"\n            value={t(\"å…¥åŠ›æ¸ˆã¿\", \"Filled\")}\n            onChange={(_e) => {}}\n          />\n        </div>\n        <Tabs>\n          <div className=\"border-b\">\n            <TabsList className=\"flex space-x-2\">\n              <TabsTrigger\n                value=\"sampleTab1\"\n                onClick={() => handleTabClick(\"sampleTab1\")}\n                className={activeTab === \"sampleTab1\" ? \"active-tab\" : \"\"}\n              >\n                {t(\"ã‚¿ãƒ–1\", \"Tab 1\")}\n              </TabsTrigger>\n              <TabsTrigger\n                value=\"sampleTab2\"\n                onClick={() => handleTabClick(\"sampleTab2\")}\n                className={activeTab === \"sampleTab2\" ? \"active-tab\" : \"\"}\n              >\n                {t(\"ã‚¿ãƒ–2\", \"Tab 2\")}\n              </TabsTrigger>\n              <TabsTrigger\n                value=\"sampleTab3\"\n                onClick={() => handleTabClick(\"sampleTab3\")}\n                className={activeTab === \"sampleTab3\" ? \"active-tab\" : \"\"}\n              >\n                {t(\"ã‚¿ãƒ–3\", \"Tab 3\")}\n              </TabsTrigger>\n            </TabsList>\n          </div>\n        </Tabs>\n        <ResponsivePagination\n          perPage={32}\n          maxCount={200}\n          currentPage={activePage}\n          onPageChange={(page: number) => setActivePage(page)}\n        />\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.color/route.tsx"},"span":[7232,7423],"sourceCode":"import { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { Tabs, TabsList, TabsTrigger } from \"~/components/ui/tabs\"\nimport { useTheme } from \"next-themes\"\nimport { useState } from \"react\"\nimport { SettingsHeader } from \"~/routes/($lang).settings/components/settings-header\"\nimport { Separator } from \"~/components/ui/separator\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { config, META } from \"~/config\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { cn } from \"~/lib/utils\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.SETTINGS_COLOR, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  return {}\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function SettingColor () {\n  const t = useTranslation()\n  const [activeTab, setActiveTab] = useState<string>(\"sampleTab1\")\n  const [activePage, setActivePage] = useState<number>(1)\n  const { theme, setTheme } = useTheme()\n\n  const handleTabClick = (value: string) => setActiveTab(value)\n\n  const setColorTheme = (mode: string, color: string) => {\n    setTheme(\n      mode === \"system\"\n        ? \"system\"\n        : color === \"none\"\n          ? mode\n          : `${mode}-${color}`,\n    )\n  }\n\n  const getMode = (theme: string): string => {\n    if ([\"system\", \"light\", \"dark\"].includes(theme)) return theme\n    return theme.startsWith(\"light-\")\n      ? \"light\"\n      : theme.startsWith(\"dark-\")\n        ? \"dark\"\n        : \"system\"\n  }\n\n  const getColorSchema = (theme: string): string => {\n    if ([\"system\", \"light\", \"dark\"].includes(theme)) return \"none\"\n    return theme.replace(/(light|dark)-/, \"\") ?? \"none\"\n  }\n\n  const mode = getMode(theme ?? \"system\")\n  const colorSchema = getColorSchema(theme ?? \"system\")\n\n  const themeRadio = (value: string, label: string) => (\n    <div\n      className={cn(\n        \"flex w-full cursor-pointer items-center space-x-2 rounded-lg border p-2 transition duration-150 hover:bg-gray-100 dark:hover:bg-gray-800\",\n        { \"bg-gray-100 bg-opacity-50 dark:bg-gray-800\": mode === value },\n      )}\n      onClick={() => setColorTheme(value, colorSchema)}\n      onKeyUp={(e) => {\n        if (e.key === \"Enter\" || e.key === \" \") {\n          setColorTheme(value, colorSchema)\n        }\n      }}\n    >\n      <RadioGroupItem value={value} id={value} className=\"peer hidden\" />\n      <label\n        htmlFor={value}\n        className=\"flex cursor-pointer items-center peer-checked:text-blue-500\"\n      >\n        <span className=\"flex size-4 items-center justify-center rounded-full border border-gray-300 transition duration-150 peer-checked:border-blue-500 peer-checked:bg-blue-500\" />\n        <span className=\"ml-2\">{t(label, label)}</span>\n      </label>\n    </div>\n  )\n\n  const themeRadioColor = (\n    value: string,\n    label: string,\n    colorValue: string,\n  ) => (\n    // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n    <div\n      className={cn(\n        \"flex w-full cursor-pointer items-center space-x-2 rounded-lg border p-2 transition duration-150 hover:bg-gray-100 dark:hover:bg-gray-800\",\n        { \"bg-gray-100 bg-opacity-50 dark:bg-gray-800\": colorSchema === value },\n      )}\n      onClick={() => setColorTheme(mode, value)}\n    >\n      <RadioGroupItem value={value} id={value} className=\"peer hidden\" />\n      <label\n        htmlFor={value}\n        className=\"flex cursor-pointer items-center peer-checked:text-blue-500\"\n      >\n        <span\n          className={cn(\n            \"flex size-4 items-center justify-center rounded-full transition duration-150 peer-checked:ring-2 peer-checked:ring-blue-500\",\n            colorValue,\n          )}\n        />\n        <span className=\"ml-2\">{t(label, label)}</span>\n      </label>\n    </div>\n  )\n\n  return (\n    <div className=\"flex flex-col space-y-2\">\n      <div className=\"block md:hidden\">\n        <SettingsHeader title={t(\"ã‚«ãƒ©ãƒ¼ãƒ†ãƒ¼ãƒ\", \"Color Theme\")} />\n      </div>\n      <RadioGroup\n        value={mode}\n        name=\"mode\"\n        onValueChange={(value) => setColorTheme(value, colorSchema)}\n        className=\"space-y-2\"\n      >\n        <div className=\"space-y-2\">\n          {themeRadio(\n            \"system\",\n            t(\"ãƒ‡ãƒã‚¤ã‚¹ã®ãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹\", \"Use device mode\"),\n          )}\n          {themeRadio(\"light\", t(\"ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰\", \"Light mode\"))}\n          {themeRadio(\"dark\", t(\"ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰\", \"Dark mode\"))}\n        </div>\n        <p className=\"text-sm\">\n          {t(\n            \"ãƒ©ã‚¤ãƒˆã‹ãƒ€ãƒ¼ã‚¯ã‚’é¸æŠã™ã‚‹ã¨è‰²ã‚‚é¸ã¹ã¾ã™ã€‚\",\n            \"You can select colors if you choose Light or Dark mode.\",\n          )}\n        </p>\n        <Separator />\n      </RadioGroup>\n      <div className={cn(\"space-y-2\", { \"opacity-20\": theme === \"system\" })}>\n        <RadioGroup\n          value={colorSchema}\n          name=\"colorSchema\"\n          onValueChange={(value) => setColorTheme(mode, value)}\n          className=\"space-y-2\"\n        >\n          <div className=\"grid grid-cols-2 gap-2 md:grid-cols-3\">\n            {themeRadioColor(\"none\", t(\"ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ\", \"Default\"), \"bg-gray-100\")}\n            {themeRadioColor(\"gray\", t(\"ã‚°ãƒ¬ãƒ¼\", \"Gray\"), \"bg-gray-500\")}\n            {themeRadioColor(\"red\", t(\"ãƒ¬ãƒƒãƒ‰\", \"Red\"), \"bg-red-500\")}\n            {themeRadioColor(\"pink\", t(\"ãƒ”ãƒ³ã‚¯\", \"Pink\"), \"bg-pink-500\")}\n            {themeRadioColor(\n              \"orange\",\n              t(\"ã‚ªãƒ¬ãƒ³ã‚¸\", \"Orange\"),\n              \"bg-orange-500\",\n            )}\n            {themeRadioColor(\"green\", t(\"ã‚°ãƒªãƒ¼ãƒ³\", \"Green\"), \"bg-green-500\")}\n            {themeRadioColor(\"blue\", t(\"ãƒ–ãƒ«ãƒ¼\", \"Blue\"), \"bg-blue-500\")}\n            {themeRadioColor(\n              \"yellow\",\n              t(\"ã‚¤ã‚¨ãƒ­ãƒ¼\", \"Yellow\"),\n              \"bg-yellow-500\",\n            )}\n            {themeRadioColor(\n              \"violet\",\n              t(\"ãƒã‚¤ã‚ªãƒ¬ãƒƒãƒˆ\", \"Violet\"),\n              \"bg-violet-500\",\n            )}\n          </div>\n        </RadioGroup>\n        <div className=\"mt-4 flex flex-wrap gap-2\">\n          <Button variant=\"default\">{t(\"ãƒœã‚¿ãƒ³\", \"Button\")}</Button>\n          <Button variant=\"destructive\">\n            {t(\"destructive\", \"Destructive\")}\n          </Button>\n          <Button variant=\"outline\">{t(\"outline\", \"Outline\")}</Button>\n          <Button variant=\"secondary\">{t(\"secondary\", \"Secondary\")}</Button>\n          <Button variant=\"ghost\">{t(\"ghost\", \"Ghost\")}</Button>\n          <Button variant=\"link\">{t(\"link\", \"Link\")}</Button>\n        </div>\n        <div className=\"mt-4 space-y-2\">\n          <Input\n            className=\"mx-2 w-80\"\n            id=\"sampleText1\"\n            placeholder={t(\"ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼\", \"Placeholder\")}\n            onChange={(_e) => {}}\n          />\n          <Input\n            className=\"mx-2 w-80\"\n            id=\"sampleText2\"\n            placeholder=\"\"\n            value={t(\"å…¥åŠ›æ¸ˆã¿\", \"Filled\")}\n            onChange={(_e) => {}}\n          />\n        </div>\n        <Tabs>\n          <div className=\"border-b\">\n            <TabsList className=\"flex space-x-2\">\n              <TabsTrigger\n                value=\"sampleTab1\"\n                onClick={() => handleTabClick(\"sampleTab1\")}\n                className={activeTab === \"sampleTab1\" ? \"active-tab\" : \"\"}\n              >\n                {t(\"ã‚¿ãƒ–1\", \"Tab 1\")}\n              </TabsTrigger>\n              <TabsTrigger\n                value=\"sampleTab2\"\n                onClick={() => handleTabClick(\"sampleTab2\")}\n                className={activeTab === \"sampleTab2\" ? \"active-tab\" : \"\"}\n              >\n                {t(\"ã‚¿ãƒ–2\", \"Tab 2\")}\n              </TabsTrigger>\n              <TabsTrigger\n                value=\"sampleTab3\"\n                onClick={() => handleTabClick(\"sampleTab3\")}\n                className={activeTab === \"sampleTab3\" ? \"active-tab\" : \"\"}\n              >\n                {t(\"ã‚¿ãƒ–3\", \"Tab 3\")}\n              </TabsTrigger>\n            </TabsList>\n          </div>\n        </Tabs>\n        <ResponsivePagination\n          perPage={32}\n          maxCount={200}\n          currentPage={activePage}\n          onPageChange={(page: number) => setActivePage(page)}\n        />\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.followed.tags/components/followed-tag-list.tsx"},"span":[3164,3177],"sourceCode":"import type { Tag } from \"~/components/tag/tag-input\"\nimport { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useMutation, useSuspenseQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { useContext, useEffect, useState } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { FollowedTag } from \"~/routes/($lang).settings.followed.tags/components/followed-tag\"\nimport { toast } from \"sonner\"\n\nexport function FollowedTagList () {\n  const appContext = useContext(AuthContext)\n\n  const t = useTranslation()\n\n  const { data = null, refetch } = useSuspenseQuery(viewerFollowedTagsQuery, {\n    skip: appContext.isLoading,\n    variables: { offset: 0, limit: 32 },\n  })\n\n  const [text, setText] = useState(\"\")\n\n  const [_tags, setTags] = useState<Tag[]>()\n\n  useEffect(() => {\n    if (data?.viewer?.followingTags) {\n      setTags(\n        data.viewer.followingTags.map((tag) => ({\n          id: tag.id,\n          name: tag.name,\n          text: tag.name,\n        })),\n      )\n    }\n  }, [data])\n\n  const count = text.length\n\n  const [follow, { loading: isFollowing }] = useMutation(followTagMutation)\n\n  const [unFollow, { loading: isUnFollowing }] =\n    useMutation(unFollowTagMutation)\n\n  const handleUnFollow = async (tagName: string) => {\n    try {\n      await unFollow({\n        variables: {\n          input: {\n            tagName: tagName,\n          },\n        },\n      })\n      await refetch()\n      toast(t(\"ã‚¿ã‚°ã‚’å‰Šé™¤ã—ã¾ã—ãŸ\", \"Tag removed\"))\n    } catch (e) {\n      console.error(e)\n      if (e instanceof Error) {\n        toast(e.message)\n      }\n    }\n  }\n\n  const handleFollow = async () => {\n    try {\n      await follow({\n        variables: {\n          input: {\n            tagName: text,\n          },\n        },\n      })\n      setText(\"\")\n      await refetch()\n      toast(t(\"ã‚¿ã‚°ã‚’è¿½åŠ ã—ã¾ã—ãŸ\", \"Tag added\"))\n    } catch (e) {\n      console.error(e)\n      if (e instanceof Error) {\n        toast(e.message)\n      }\n    }\n  }\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        <div className=\"flex items-start space-x-4\">\n          <div className=\"flex-1\">\n            <Input\n              className=\"w-full rounded-full\"\n              type=\"text\"\n              value={text}\n              onChange={(e) => setText(e.target.value)}\n              placeholder={t(\"ã‚¿ã‚°\", \"Tag\")}\n              maxLength={40}\n            />\n            <div className=\"flex justify-end\">\n              <p className=\"text-xs\">{`${count}/40`}</p>\n            </div>\n          </div>\n          <Button className=\"rounded-full\" onClick={handleFollow}>\n            {t(\"ã‚¿ã‚°ã‚’è¿½åŠ \", \"Add Tag\")}\n          </Button>\n        </div>\n      </div>\n      {data?.viewer?.followingTags.length === 0 && (\n        <div className=\"rounded bg-info p-4\">\n          <p>{t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ã„ã‚‹ã‚¿ã‚°ã¯ã‚ã‚Šã¾ã›ã‚“\", \"No muted tags\")}</p>\n        </div>\n      )}\n      <div>\n        {data?.viewer?.followingTags.map((followingTag) => (\n          // biome-ignore lint/correctness/useJsxKeyInIterable: <explanation>\n          <div className=\"pt-1 pb-1\">\n            <FollowedTag\n              key={followingTag.id}\n              name={followingTag.name}\n              onClick={() => handleUnFollow(followingTag.name)}\n            />\n          </div>\n        ))}\n      </div>\n    </>\n  )\n}\n\nconst viewerFollowedTagsQuery = graphql(\n  `query ViewerFollowedTags($offset: Int!, $limit: Int!) {\n    viewer {\n      id\n      followingTags(offset: $offset, limit: $limit) {\n        id\n        name\n      }\n    }\n  }`,\n)\n\nconst followTagMutation = graphql(\n  `mutation FollowTag($input: FollowTagInput!) {\n    followTag(input: $input)\n  }`,\n)\n\nconst unFollowTagMutation = graphql(\n  `mutation UnFollowTag($input: UnfollowTagInput!) {\n    unfollowTag(input: $input)\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable isFollowing is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"isFollowing"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.followed.tags/components/followed-tag-list.tsx"},"span":[1198,1209],"sourceCode":"import type { Tag } from \"~/components/tag/tag-input\"\nimport { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useMutation, useSuspenseQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { useContext, useEffect, useState } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { FollowedTag } from \"~/routes/($lang).settings.followed.tags/components/followed-tag\"\nimport { toast } from \"sonner\"\n\nexport function FollowedTagList () {\n  const appContext = useContext(AuthContext)\n\n  const t = useTranslation()\n\n  const { data = null, refetch } = useSuspenseQuery(viewerFollowedTagsQuery, {\n    skip: appContext.isLoading,\n    variables: { offset: 0, limit: 32 },\n  })\n\n  const [text, setText] = useState(\"\")\n\n  const [_tags, setTags] = useState<Tag[]>()\n\n  useEffect(() => {\n    if (data?.viewer?.followingTags) {\n      setTags(\n        data.viewer.followingTags.map((tag) => ({\n          id: tag.id,\n          name: tag.name,\n          text: tag.name,\n        })),\n      )\n    }\n  }, [data])\n\n  const count = text.length\n\n  const [follow, { loading: isFollowing }] = useMutation(followTagMutation)\n\n  const [unFollow, { loading: isUnFollowing }] =\n    useMutation(unFollowTagMutation)\n\n  const handleUnFollow = async (tagName: string) => {\n    try {\n      await unFollow({\n        variables: {\n          input: {\n            tagName: tagName,\n          },\n        },\n      })\n      await refetch()\n      toast(t(\"ã‚¿ã‚°ã‚’å‰Šé™¤ã—ã¾ã—ãŸ\", \"Tag removed\"))\n    } catch (e) {\n      console.error(e)\n      if (e instanceof Error) {\n        toast(e.message)\n      }\n    }\n  }\n\n  const handleFollow = async () => {\n    try {\n      await follow({\n        variables: {\n          input: {\n            tagName: text,\n          },\n        },\n      })\n      setText(\"\")\n      await refetch()\n      toast(t(\"ã‚¿ã‚°ã‚’è¿½åŠ ã—ã¾ã—ãŸ\", \"Tag added\"))\n    } catch (e) {\n      console.error(e)\n      if (e instanceof Error) {\n        toast(e.message)\n      }\n    }\n  }\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        <div className=\"flex items-start space-x-4\">\n          <div className=\"flex-1\">\n            <Input\n              className=\"w-full rounded-full\"\n              type=\"text\"\n              value={text}\n              onChange={(e) => setText(e.target.value)}\n              placeholder={t(\"ã‚¿ã‚°\", \"Tag\")}\n              maxLength={40}\n            />\n            <div className=\"flex justify-end\">\n              <p className=\"text-xs\">{`${count}/40`}</p>\n            </div>\n          </div>\n          <Button className=\"rounded-full\" onClick={handleFollow}>\n            {t(\"ã‚¿ã‚°ã‚’è¿½åŠ \", \"Add Tag\")}\n          </Button>\n        </div>\n      </div>\n      {data?.viewer?.followingTags.length === 0 && (\n        <div className=\"rounded bg-info p-4\">\n          <p>{t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ã„ã‚‹ã‚¿ã‚°ã¯ã‚ã‚Šã¾ã›ã‚“\", \"No muted tags\")}</p>\n        </div>\n      )}\n      <div>\n        {data?.viewer?.followingTags.map((followingTag) => (\n          // biome-ignore lint/correctness/useJsxKeyInIterable: <explanation>\n          <div className=\"pt-1 pb-1\">\n            <FollowedTag\n              key={followingTag.id}\n              name={followingTag.name}\n              onClick={() => handleUnFollow(followingTag.name)}\n            />\n          </div>\n        ))}\n      </div>\n    </>\n  )\n}\n\nconst viewerFollowedTagsQuery = graphql(\n  `query ViewerFollowedTags($offset: Int!, $limit: Int!) {\n    viewer {\n      id\n      followingTags(offset: $offset, limit: $limit) {\n        id\n        name\n      }\n    }\n  }`,\n)\n\nconst followTagMutation = graphql(\n  `mutation FollowTag($input: FollowTagInput!) {\n    followTag(input: $input)\n  }`,\n)\n\nconst unFollowTagMutation = graphql(\n  `mutation UnFollowTag($input: UnfollowTagInput!) {\n    unfollowTag(input: $input)\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable isUnFollowing is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"isUnFollowing"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.followed.tags/components/followed-tag-list.tsx"},"span":[1277,1290],"sourceCode":"import type { Tag } from \"~/components/tag/tag-input\"\nimport { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useMutation, useSuspenseQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { useContext, useEffect, useState } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { FollowedTag } from \"~/routes/($lang).settings.followed.tags/components/followed-tag\"\nimport { toast } from \"sonner\"\n\nexport function FollowedTagList () {\n  const appContext = useContext(AuthContext)\n\n  const t = useTranslation()\n\n  const { data = null, refetch } = useSuspenseQuery(viewerFollowedTagsQuery, {\n    skip: appContext.isLoading,\n    variables: { offset: 0, limit: 32 },\n  })\n\n  const [text, setText] = useState(\"\")\n\n  const [_tags, setTags] = useState<Tag[]>()\n\n  useEffect(() => {\n    if (data?.viewer?.followingTags) {\n      setTags(\n        data.viewer.followingTags.map((tag) => ({\n          id: tag.id,\n          name: tag.name,\n          text: tag.name,\n        })),\n      )\n    }\n  }, [data])\n\n  const count = text.length\n\n  const [follow, { loading: isFollowing }] = useMutation(followTagMutation)\n\n  const [unFollow, { loading: isUnFollowing }] =\n    useMutation(unFollowTagMutation)\n\n  const handleUnFollow = async (tagName: string) => {\n    try {\n      await unFollow({\n        variables: {\n          input: {\n            tagName: tagName,\n          },\n        },\n      })\n      await refetch()\n      toast(t(\"ã‚¿ã‚°ã‚’å‰Šé™¤ã—ã¾ã—ãŸ\", \"Tag removed\"))\n    } catch (e) {\n      console.error(e)\n      if (e instanceof Error) {\n        toast(e.message)\n      }\n    }\n  }\n\n  const handleFollow = async () => {\n    try {\n      await follow({\n        variables: {\n          input: {\n            tagName: text,\n          },\n        },\n      })\n      setText(\"\")\n      await refetch()\n      toast(t(\"ã‚¿ã‚°ã‚’è¿½åŠ ã—ã¾ã—ãŸ\", \"Tag added\"))\n    } catch (e) {\n      console.error(e)\n      if (e instanceof Error) {\n        toast(e.message)\n      }\n    }\n  }\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        <div className=\"flex items-start space-x-4\">\n          <div className=\"flex-1\">\n            <Input\n              className=\"w-full rounded-full\"\n              type=\"text\"\n              value={text}\n              onChange={(e) => setText(e.target.value)}\n              placeholder={t(\"ã‚¿ã‚°\", \"Tag\")}\n              maxLength={40}\n            />\n            <div className=\"flex justify-end\">\n              <p className=\"text-xs\">{`${count}/40`}</p>\n            </div>\n          </div>\n          <Button className=\"rounded-full\" onClick={handleFollow}>\n            {t(\"ã‚¿ã‚°ã‚’è¿½åŠ \", \"Add Tag\")}\n          </Button>\n        </div>\n      </div>\n      {data?.viewer?.followingTags.length === 0 && (\n        <div className=\"rounded bg-info p-4\">\n          <p>{t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ã„ã‚‹ã‚¿ã‚°ã¯ã‚ã‚Šã¾ã›ã‚“\", \"No muted tags\")}</p>\n        </div>\n      )}\n      <div>\n        {data?.viewer?.followingTags.map((followingTag) => (\n          // biome-ignore lint/correctness/useJsxKeyInIterable: <explanation>\n          <div className=\"pt-1 pb-1\">\n            <FollowedTag\n              key={followingTag.id}\n              name={followingTag.name}\n              onClick={() => handleUnFollow(followingTag.name)}\n            />\n          </div>\n        ))}\n      </div>\n    </>\n  )\n}\n\nconst viewerFollowedTagsQuery = graphql(\n  `query ViewerFollowedTags($offset: Int!, $limit: Int!) {\n    viewer {\n      id\n      followingTags(offset: $offset, limit: $limit) {\n        id\n        name\n      }\n    }\n  }`,\n)\n\nconst followTagMutation = graphql(\n  `mutation FollowTag($input: FollowTagInput!) {\n    followTag(input: $input)\n  }`,\n)\n\nconst unFollowTagMutation = graphql(\n  `mutation UnFollowTag($input: UnfollowTagInput!) {\n    unfollowTag(input: $input)\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.muted.tags/components/muted-tag-list.tsx"},"span":[2584,2597],"sourceCode":"import type { Tag } from \"~/components/tag/tag-input\"\nimport { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { MutedTag } from \"~/routes/($lang).settings.muted.tags/components/muted-tag\"\nimport { useMutation, useSuspenseQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { useContext, useEffect, useState } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\nexport function MutedTagList () {\n  const appContext = useContext(AuthContext)\n\n  const t = useTranslation()\n\n  const { data = null, refetch } = useSuspenseQuery(viewerMutedTagsQuery, {\n    skip: appContext.isLoading,\n    variables: { offset: 0, limit: 128 },\n  })\n\n  const [text, setText] = useState(\"\")\n\n  const [_tags, setTags] = useState<Tag[]>()\n\n  useEffect(() => {\n    if (data?.viewer?.mutedTags) {\n      setTags(\n        data.viewer.mutedTags.map((tag) => ({\n          id: tag.id,\n          name: tag.name,\n          text: tag.name,\n        })),\n      )\n    }\n  }, [data])\n\n  const count = text.length\n\n  const [mutation] = useMutation(muteTagMutation)\n\n  const handleUnmute = async (tagName: string) => {\n    await mutation({\n      variables: {\n        input: {\n          tagName: tagName,\n        },\n      },\n    })\n    await refetch()\n  }\n\n  const handleMute = async () => {\n    await mutation({\n      variables: {\n        input: {\n          tagName: text,\n        },\n      },\n    })\n    setText(\"\")\n    await refetch()\n  }\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        <div className=\"flex items-start space-x-4\">\n          <div className=\"flex-1\">\n            <Input\n              className=\"w-full rounded-full\"\n              type=\"text\"\n              value={text}\n              onChange={(e) => setText(e.target.value)}\n              placeholder={t(\"ã‚¿ã‚°\", \"Tag\")}\n              maxLength={40}\n            />\n            <div className=\"flex justify-end\">\n              <p className=\"text-xs\">{`${count}/40`}</p>\n            </div>\n          </div>\n          <Button className=\"rounded-full\" onClick={handleMute}>\n            {t(\"ã‚¿ã‚°ã‚’è¿½åŠ \", \"Add Tag\")}\n          </Button>\n        </div>\n      </div>\n      {data?.viewer?.mutedTags.length === 0 && (\n        <div className=\"rounded bg-info p-4\">\n          <p>{t(\"ãƒŸãƒ¥ãƒ¼ãƒˆã—ã¦ã„ã‚‹ã‚¿ã‚°ã¯ã‚ã‚Šã¾ã›ã‚“\", \"No muted tags\")}</p>\n        </div>\n      )}\n      <div>\n        {data?.viewer?.mutedTags.map((mutedTag) => (\n          // biome-ignore lint/correctness/useJsxKeyInIterable: <explanation>\n          <div className=\"pt-1 pb-1\">\n            <MutedTag\n              key={mutedTag.id}\n              name={mutedTag.name}\n              onClick={() => handleUnmute(mutedTag.name)}\n            />\n          </div>\n        ))}\n      </div>\n    </>\n  )\n}\n\nconst viewerMutedTagsQuery = graphql(\n  `query ViewerMutedTags($offset: Int!, $limit: Int!) {\n    viewer {\n      id\n      mutedTags(offset: $offset, limit: $limit) {\n        id\n        name\n      }\n    }\n  }`,\n)\n\nconst muteTagMutation = graphql(\n  `mutation MuteTag($input: MuteTagInput!) {\n    muteTag(input: $input) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable refetchSetting is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"refetchSetting"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.notification/components/setting-notification-form.tsx"},"span":[842,856],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon } from \"lucide-react\"\nimport { useContext, useEffect, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\" // ç¿»è¨³ç”¨ãƒ•ãƒƒã‚¯\nimport { SettingFcmForm } from \"~/routes/($lang).settings.push-notification/components/setting-fcm-form\"\n\n/**\n * é€šçŸ¥è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function SettingNotificationForm () {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation() // ç¿»è¨³ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨\n\n  const { data: userSetting, refetch: refetchSetting } = useQuery(\n    userSettingQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  const [updateUserSetting, { loading: isUpdatingUserSetting }] = useMutation(\n    updateUserSettingMutation,\n  )\n\n  const [isNotifyComment, setIsNotifyComment] = useState<boolean>(\n    userSetting?.userSetting?.isNotifyComment ?? false,\n  )\n\n  useEffect(() => {\n    setIsNotifyComment(userSetting?.userSetting?.isNotifyComment ?? false)\n  }, [userSetting])\n\n  const onSave = async () => {\n    await updateUserSetting({\n      variables: {\n        input: {\n          isNotifyComment: isNotifyComment,\n        },\n      },\n    })\n    toast(t(\"ä¿å­˜ã—ã¾ã—ãŸ\", \"Settings saved\"))\n  }\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        <p className=\"font-bold\">{t(\"é€šçŸ¥\", \"Notifications\")}</p>\n        <div className=\"flex justify-between\">\n          <label\n            htmlFor=\"5\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\n              \"ã‚³ãƒ¡ãƒ³ãƒˆã®é€šçŸ¥ã‚’å—ã‘å–ã‚‹\",\n              \"Receive notifications for comments\",\n            )}\n          </label>\n          <Checkbox\n            onCheckedChange={(value: boolean) => {\n              setIsNotifyComment(value)\n            }}\n            checked={isNotifyComment}\n            id=\"terms\"\n          />\n        </div>\n      </div>\n      <Button\n        onClick={onSave}\n        disabled={isUpdatingUserSetting}\n        className=\"ml-auto block w-24 text-center\"\n      >\n        {isUpdatingUserSetting ? (\n          <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n        ) : (\n          t(\"æ›´æ–°ã™ã‚‹\", \"Update\")\n        )}\n      </Button>\n      <Separator />\n      <div className=\"w-full space-y-4\">\n        <p className=\"font-bold text-2xl\">\n          {t(\"Pushé€šçŸ¥è¨­å®š\", \"Push Notification Settings\")}\n        </p>\n        <p>\n          {t(\n            \"Pushé€šçŸ¥ã‚’è¨­å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\",\n            \"You can configure push notifications.\",\n          )}\n        </p>\n        <p>\n          {t(\n            \"PCãƒ–ãƒ©ã‚¦ã‚¶ã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã®å ´åˆã¯ã€ä»Šå¾Œã‚¢ãƒ—ãƒªã§é€šçŸ¥ã«å¯¾å¿œã™ã‚‹äºˆå®šã§ã™ã€‚é€šçŸ¥ã‚’å—ä¿¡ã§ãã‚‹ãƒ–ãƒ©ã‚¦ã‚¶ã¯1ã¤ã®ã¿ã¨ãªã‚Šã¾ã™ã€‚æœ€å¾Œã«è¨­å®šã—ãŸãƒ–ãƒ©ã‚¦ã‚¶å®›ã«é€šçŸ¥ã•ã‚Œã¾ã™ã€‚\",\n            \"Supported on PC browsers only. Smartphone browsers are not supported. Future app support for notifications is planned.\",\n          )}\n        </p>\n        <p>\n          {t(\n            \"Pushé€šçŸ¥å†…å®¹ã€ã‚µã‚¤ãƒˆä¸Šã®é€šçŸ¥å†…å®¹ã¨å…±é€šã§ã™ã€‚ç¾è¡Œã‚µã‚¤ãƒˆã®å³ä¸Šãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚¢ã‚¤ã‚³ãƒ³ â†’ è¨­å®š â†’ é€šçŸ¥ãƒ»ã„ã„ã­ã€ã‹ã‚‰é¸æŠã§ãã¾ã™ã€‚\",\n            \"Push notification settings are shared with site notifications, accessible via the profile icon â†’ settings â†’ notifications.\",\n          )}\n        </p>\n        <Separator />\n        <SettingFcmForm />\n        <Separator />\n        <p>\n          {t(\n            \"Pushé€šçŸ¥ã‚’å—ã‘å–ã‚‹ãŸã‚ã«ã¯ã€ä¸Šè¨˜ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯å¾Œã«ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã§é€šçŸ¥ã‚’è¨±å¯ã—ã¦ãã ã•ã„ã€‚\",\n            \"After configuring, enable notifications in your browser settings.\",\n          )}\n        </p>\n        <p>\n          {t(\n            \"è¨­å®šå¾Œã«ãƒ†ã‚¹ãƒˆé€šçŸ¥ãŒå±Šãã¾ã™ã€‚é€šçŸ¥ãŒè¡¨ç¤ºã•ã‚Œãªã„å ´åˆã¯ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚\",\n            \"A test notification will be sent after configuration. If not received, check the following.\",\n          )}\n        </p>\n        <p>{t(\"â– Windows11ã®å ´åˆ\", \"â–  For Windows 11\")}</p>\n        <p>\n          {t(\n            \"è¨­å®š â†’ é€šçŸ¥ã€ã§é€šçŸ¥ãŒONã«ãªã£ã¦ã„ã‚‹ã“ã¨ã€ã”åˆ©ç”¨ã®ãƒ–ãƒ©ã‚¦ã‚¶ã®é€šçŸ¥ãŒONã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚\",\n            \"Ensure notifications are ON in settings â†’ notifications, and in your browser.\",\n          )}\n        </p>\n        <p>\n          {t(\n            \"è¨­å®š â†’ ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã€ã§ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’ONã«ã—ã¦ã„ãªã„ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚\",\n            \"Check focus mode is not enabled in settings â†’ focus.\",\n          )}\n        </p>\n      </div>\n    </>\n  )\n}\n\nconst userSettingQuery = graphql(\n  `query UserSetting {\n    userSetting {\n      id\n      userId\n      favoritedImageGenerationModelIds\n      preferenceRating\n      featurePromptonRequest\n      isNotifyComment\n    }\n  }`,\n)\n\nconst updateUserSettingMutation = graphql(\n  `mutation UpdateUserSetting($input: UpdateUserSettingInput!) {\n    updateUserSetting(input: $input) {\n      preferenceRating\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.notification/components/setting-notification-form.tsx"},"span":[2061,2250],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon } from \"lucide-react\"\nimport { useContext, useEffect, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\" // ç¿»è¨³ç”¨ãƒ•ãƒƒã‚¯\nimport { SettingFcmForm } from \"~/routes/($lang).settings.push-notification/components/setting-fcm-form\"\n\n/**\n * é€šçŸ¥è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function SettingNotificationForm () {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation() // ç¿»è¨³ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨\n\n  const { data: userSetting, refetch: refetchSetting } = useQuery(\n    userSettingQuery,\n    {\n      skip: authContext.isLoading || authContext.isNotLoggedIn,\n    },\n  )\n\n  const [updateUserSetting, { loading: isUpdatingUserSetting }] = useMutation(\n    updateUserSettingMutation,\n  )\n\n  const [isNotifyComment, setIsNotifyComment] = useState<boolean>(\n    userSetting?.userSetting?.isNotifyComment ?? false,\n  )\n\n  useEffect(() => {\n    setIsNotifyComment(userSetting?.userSetting?.isNotifyComment ?? false)\n  }, [userSetting])\n\n  const onSave = async () => {\n    await updateUserSetting({\n      variables: {\n        input: {\n          isNotifyComment: isNotifyComment,\n        },\n      },\n    })\n    toast(t(\"ä¿å­˜ã—ã¾ã—ãŸ\", \"Settings saved\"))\n  }\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        <p className=\"font-bold\">{t(\"é€šçŸ¥\", \"Notifications\")}</p>\n        <div className=\"flex justify-between\">\n          <label\n            htmlFor=\"5\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\n              \"ã‚³ãƒ¡ãƒ³ãƒˆã®é€šçŸ¥ã‚’å—ã‘å–ã‚‹\",\n              \"Receive notifications for comments\",\n            )}\n          </label>\n          <Checkbox\n            onCheckedChange={(value: boolean) => {\n              setIsNotifyComment(value)\n            }}\n            checked={isNotifyComment}\n            id=\"terms\"\n          />\n        </div>\n      </div>\n      <Button\n        onClick={onSave}\n        disabled={isUpdatingUserSetting}\n        className=\"ml-auto block w-24 text-center\"\n      >\n        {isUpdatingUserSetting ? (\n          <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n        ) : (\n          t(\"æ›´æ–°ã™ã‚‹\", \"Update\")\n        )}\n      </Button>\n      <Separator />\n      <div className=\"w-full space-y-4\">\n        <p className=\"font-bold text-2xl\">\n          {t(\"Pushé€šçŸ¥è¨­å®š\", \"Push Notification Settings\")}\n        </p>\n        <p>\n          {t(\n            \"Pushé€šçŸ¥ã‚’è¨­å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\",\n            \"You can configure push notifications.\",\n          )}\n        </p>\n        <p>\n          {t(\n            \"PCãƒ–ãƒ©ã‚¦ã‚¶ã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã®å ´åˆã¯ã€ä»Šå¾Œã‚¢ãƒ—ãƒªã§é€šçŸ¥ã«å¯¾å¿œã™ã‚‹äºˆå®šã§ã™ã€‚é€šçŸ¥ã‚’å—ä¿¡ã§ãã‚‹ãƒ–ãƒ©ã‚¦ã‚¶ã¯1ã¤ã®ã¿ã¨ãªã‚Šã¾ã™ã€‚æœ€å¾Œã«è¨­å®šã—ãŸãƒ–ãƒ©ã‚¦ã‚¶å®›ã«é€šçŸ¥ã•ã‚Œã¾ã™ã€‚\",\n            \"Supported on PC browsers only. Smartphone browsers are not supported. Future app support for notifications is planned.\",\n          )}\n        </p>\n        <p>\n          {t(\n            \"Pushé€šçŸ¥å†…å®¹ã€ã‚µã‚¤ãƒˆä¸Šã®é€šçŸ¥å†…å®¹ã¨å…±é€šã§ã™ã€‚ç¾è¡Œã‚µã‚¤ãƒˆã®å³ä¸Šãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚¢ã‚¤ã‚³ãƒ³ â†’ è¨­å®š â†’ é€šçŸ¥ãƒ»ã„ã„ã­ã€ã‹ã‚‰é¸æŠã§ãã¾ã™ã€‚\",\n            \"Push notification settings are shared with site notifications, accessible via the profile icon â†’ settings â†’ notifications.\",\n          )}\n        </p>\n        <Separator />\n        <SettingFcmForm />\n        <Separator />\n        <p>\n          {t(\n            \"Pushé€šçŸ¥ã‚’å—ã‘å–ã‚‹ãŸã‚ã«ã¯ã€ä¸Šè¨˜ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯å¾Œã«ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã§é€šçŸ¥ã‚’è¨±å¯ã—ã¦ãã ã•ã„ã€‚\",\n            \"After configuring, enable notifications in your browser settings.\",\n          )}\n        </p>\n        <p>\n          {t(\n            \"è¨­å®šå¾Œã«ãƒ†ã‚¹ãƒˆé€šçŸ¥ãŒå±Šãã¾ã™ã€‚é€šçŸ¥ãŒè¡¨ç¤ºã•ã‚Œãªã„å ´åˆã¯ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚\",\n            \"A test notification will be sent after configuration. If not received, check the following.\",\n          )}\n        </p>\n        <p>{t(\"â– Windows11ã®å ´åˆ\", \"â–  For Windows 11\")}</p>\n        <p>\n          {t(\n            \"è¨­å®š â†’ é€šçŸ¥ã€ã§é€šçŸ¥ãŒONã«ãªã£ã¦ã„ã‚‹ã“ã¨ã€ã”åˆ©ç”¨ã®ãƒ–ãƒ©ã‚¦ã‚¶ã®é€šçŸ¥ãŒONã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚\",\n            \"Ensure notifications are ON in settings â†’ notifications, and in your browser.\",\n          )}\n        </p>\n        <p>\n          {t(\n            \"è¨­å®š â†’ ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã€ã§ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’ONã«ã—ã¦ã„ãªã„ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚\",\n            \"Check focus mode is not enabled in settings â†’ focus.\",\n          )}\n        </p>\n      </div>\n    </>\n  )\n}\n\nconst userSettingQuery = graphql(\n  `query UserSetting {\n    userSetting {\n      id\n      userId\n      favoritedImageGenerationModelIds\n      preferenceRating\n      featurePromptonRequest\n      isNotifyComment\n    }\n  }`,\n)\n\nconst updateUserSettingMutation = graphql(\n  `mutation UpdateUserSetting($input: UpdateUserSettingInput!) {\n    updateUserSetting(input: $input) {\n      preferenceRating\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.profile/components/setting-profile-form.tsx"},"span":[10235,10504],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { CropImageField } from \"~/components/crop-image-field\"\nimport { Button } from \"~/components/ui/button\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport {\n  DialogWorkFragment,\n  SelectCreatedWorksDialog,\n} from \"~/routes/($lang).my._index/components/select-created-works-dialog\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon, Pencil, PlusIcon } from \"lucide-react\"\nimport { Suspense, useContext, useState, useEffect } from \"react\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { SelectCreatedSensitiveWorksDialog } from \"~/routes/($lang).my._index/components/select-created-sensitive-works-dialog\"\n\n/**\n * ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function SettingProfileForm () {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const { data: user, loading } = useQuery(userQuery, {\n    skip:\n      authContext.isLoading || authContext.isNotLoggedIn || !authContext.userId,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const userInfo = user?.user\n\n  // ã™ã¹ã¦ã®ãƒ•ãƒƒã‚¯ã‚’æ¡ä»¶ãªã—ã§å‘¼ã³å‡ºã™\n  const [userName, setUserName] = useState(\"\")\n  const [profile, setProfile] = useState(\"\")\n  const [enProfile, setEnProfile] = useState(\"\")\n  const [website, setWebsite] = useState(\"\")\n  const [instagram, setInstagram] = useState(\"\")\n  const [twitter, setTwitter] = useState(\"\")\n  const [github, setGithub] = useState(\"\")\n  const [mail, setMail] = useState(\"\")\n  const [profileImage, setProfileImage] = useState(\"\")\n  const [headerImage, setHeaderImage] = useState(\"\")\n  const [selectedPickupWorks, setSelectedPickupWorks] = useState<\n    Array<{\n      id: string\n      title: string\n      smallThumbnailImageURL: string\n    }>\n  >([])\n  const [selectedPickupSensitiveWorks, setSelectedPickupSensitiveWorks] =\n    useState<\n      Array<{\n        id: string\n        title: string\n        smallThumbnailImageURL: string\n      }>\n    >([])\n\n  const { data: token } = useQuery(viewerTokenQuery)\n\n  const [updateProfile, { loading: isUpdating }] = useMutation(\n    updateUserProfileMutation,\n  )\n\n  // userInfoãŒå–å¾—ã•ã‚ŒãŸã‚‰stateã‚’åˆæœŸåŒ–\n  useEffect(() => {\n    if (userInfo) {\n      setUserName(userInfo.name || authContext.displayName || \"\")\n      setProfile(userInfo.biography ?? \"\")\n      setEnProfile(userInfo.enBiography ?? \"\")\n      setWebsite(userInfo.siteURL ?? \"\")\n      setInstagram(userInfo.instagramAccountId ?? \"\")\n      setTwitter(userInfo.twitterAccountId ?? \"\")\n      setGithub(userInfo.githubAccountId ?? \"\")\n      setMail(userInfo.mailAddress ?? \"\")\n      setSelectedPickupWorks(\n        userInfo.featuredWorks?.map((work) => ({\n          id: work.id,\n          title: work.title,\n          smallThumbnailImageURL: work.smallThumbnailImageURL,\n        })) ?? [],\n      )\n      setSelectedPickupSensitiveWorks(\n        userInfo.featuredSensitiveWorks?.map((work) => ({\n          id: work.id,\n          title: work.title,\n          smallThumbnailImageURL: work.smallThumbnailImageURL,\n        })) ?? [],\n      )\n    }\n  }, [userInfo, authContext.displayName])\n\n  // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã‚’ãƒ•ãƒƒã‚¯å‘¼ã³å‡ºã—å¾Œã«ç¢ºèª\n  if (loading || authContext.isLoading || authContext.isNotLoggedIn) {\n    return <AppLoadingPage />\n  }\n\n  if (!userInfo) {\n    return <AppLoadingPage />\n  }\n\n  const onSubmit = async () => {\n    if (isUpdating || authContext.userId === null) {\n      return\n    }\n\n    const iconUrl = profileImage\n      ? await uploadPublicImage(profileImage, token?.viewer?.token)\n      : null\n\n    const headerUrl = headerImage\n      ? await uploadPublicImage(headerImage, token?.viewer?.token)\n      : null\n\n    await updateProfile({\n      variables: {\n        input: {\n          displayName: userName,\n          biography: profile,\n          enBiography: enProfile,\n          homeUrl: website,\n          instagramAccountId: instagram,\n          twitterAccountId: twitter,\n          githubAccountId: github,\n          mailAddress: mail,\n          ...(iconUrl && {\n            iconUrl: iconUrl,\n          }),\n          ...(headerUrl && {\n            headerImageUrl: headerUrl,\n          }),\n          featuredWorkIds: selectedPickupWorks.map((work) => work.id),\n          featuredSensitiveWorkIds: selectedPickupSensitiveWorks.map(\n            (work) => work.id,\n          ),\n        },\n      },\n    })\n\n    toast(t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚\", \"Profile updated.\"))\n  }\n\n  const profileImageSrc =\n    profileImage.length > 0 ? profileImage : userInfo?.iconUrl\n\n  const headerImageSrc =\n    headerImage.length > 0 ? headerImage : userInfo?.headerImageUrl\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        <div className=\"justify-between\">\n          <div className=\"relative\">\n            {headerImageSrc ? (\n              <img\n                className=\"h-auto max-h-96 w-full object-cover\"\n                src={headerImageSrc}\n                alt={t(\"ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒ\", \"Header Image\")}\n              />\n            ) : (\n              <div className=\"h-40 w-full bg-gray-700\" />\n            )}\n            <div className=\"absolute bottom-[-24px] left-2 size-32\">\n              {profileImageSrc ? (\n                <img\n                  className=\"absolute size-32 rounded-full border-2\"\n                  src={profileImageSrc}\n                  alt={t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ\", \"Profile Image\")}\n                />\n              ) : (\n                <div className=\"size-32 rounded-full border-2 bg-gray-700\" />\n              )}\n\n              <CropImageField\n                isHidePreviewImage={false}\n                cropWidth={240}\n                cropHeight={240}\n                onDeleteImage={() => {\n                  setProfileImage(\"\")\n                }}\n                onCropToBase64={(base64: string) => {\n                  try {\n                    setProfileImage(base64)\n                  } catch (error) {\n                    console.error(\"Error in onCropToBase64:\", error)\n                  }\n                }}\n                fileExtension={\"webp\"}\n              >\n                <Button\n                  className=\"absolute top-0 right-0 size-8 rounded-full p-0\"\n                  variant={\"secondary\"}\n                >\n                  <Pencil className=\"size-4\" />\n                </Button>\n              </CropImageField>\n            </div>\n\n            <CropImageField\n              isHidePreviewImage={false}\n              cropWidth={1200}\n              cropHeight={627}\n              onDeleteImage={() => {\n                setHeaderImage(\"\")\n              }}\n              onCropToBase64={setHeaderImage}\n              fileExtension={\"webp\"}\n            >\n              <Button\n                className=\"absolute top-1 right-1 size-8 rounded-full p-0\"\n                variant={\"secondary\"}\n              >\n                <Pencil className=\"size-4\" />\n              </Button>\n            </CropImageField>\n          </div>\n          <p className=\"mt-8\">\n            {t(\n              \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒã«R-18ç”»åƒã¯æ²è¼‰ã§ãã¾ã›ã‚“ã€‚\",\n              \"R-18 images cannot be used for profile or header images.\",\n            )}\n          </p>\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"nickname\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ \", \"Nickname\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"nickname\"\n            maxLength={32}\n            minLength={1}\n            value={userName}\n            onChange={(e) => setUserName(e.target.value)}\n            className=\"rounded-md border px-2 py-1\"\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"profile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"profile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={320}\n            value={profile}\n            onChange={(e) => setProfile(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"enProfile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"è‹±èªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"English Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"enProfile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={640}\n            value={enProfile}\n            onChange={(e) => setEnProfile(e.target.value)}\n          />\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"website\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"Webã‚µã‚¤ãƒˆ\", \"Website\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"website\"\n            className=\"rounded-md border px-2 py-1\"\n            value={website}\n            maxLength={1000}\n            onChange={(e) => setWebsite(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"instagram\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Instagram\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"instagram\"\n            className=\"rounded-md border px-2 py-1\"\n            value={instagram}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setInstagram(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"twitter\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"X(æ—§Twitter)\", \"X (formerly Twitter)\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"twitter\"\n            className=\"rounded-md border px-2 py-1\"\n            value={twitter}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setTwitter(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"github\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Github\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"github\"\n            className=\"rounded-md border px-2 py-1\"\n            value={github}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setGithub(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"mail\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\", \"Email Address\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"mail\"\n            className=\"rounded-md border px-2 py-1\"\n            value={mail}\n            placeholder={\"\"}\n            maxLength={320}\n            onChange={(e) => setMail(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"pickup\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ— â€»æœ€å¤§3ã¤\", \"Pickups (Max 3)\")}\n          </label>\n          <Suspense fallback={<AppLoadingPage />}>\n            <SelectCreatedWorksDialog\n              selectedWorks={selectedPickupWorks}\n              setSelectedWorks={setSelectedPickupWorks}\n              limit={3}\n            >\n              <div className=\"border-2 border-transparent p-1\">\n                <Button className=\"size-16\" size={\"icon\"} variant={\"secondary\"}>\n                  <PlusIcon />\n                </Button>\n              </div>\n            </SelectCreatedWorksDialog>\n          </Suspense>\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"sensitive-pickup\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\n              \"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ— â€»æœ€å¤§3ã¤\",\n              \"Sensitive Pickups (Max 3)\",\n            )}\n          </label>\n          <Suspense fallback={<AppLoadingPage />}>\n            <SelectCreatedSensitiveWorksDialog\n              selectedWorks={selectedPickupSensitiveWorks}\n              setSelectedWorks={setSelectedPickupSensitiveWorks}\n              limit={3}\n            >\n              <div className=\"border-2 border-transparent p-1\">\n                <Button className=\"size-16\" size={\"icon\"} variant={\"secondary\"}>\n                  <PlusIcon />\n                </Button>\n              </div>\n            </SelectCreatedSensitiveWorksDialog>\n          </Suspense>\n        </div>\n        <Separator />\n        <Button\n          disabled={isUpdating}\n          onClick={onSubmit}\n          className=\"ml-auto block w-24\"\n        >\n          {isUpdating ? (\n            <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n          ) : (\n            t(\"æ›´æ–°ã™ã‚‹\", \"Update\")\n          )}\n        </Button>\n        <Separator />\n        <a className=\"m-auto block\" href=\"settings/account/login\">\n          <Button className=\"m-auto block\" variant={\"secondary\"}>\n            {t(\"ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ã‚’å¤‰æ›´ã™ã‚‹\", \"Change Login Information\")}\n          </Button>\n        </a>\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      login\n      nanoid\n      name\n      iconUrl\n      headerImageUrl\n      featuredSensitiveWorks {\n        ...DialogWork\n      }\n      featuredWorks {\n        ...DialogWork\n      }\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n    }\n  }`,\n  [DialogWorkFragment],\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserProfileMutation = graphql(\n  `mutation UpdateUserProfile($input: UpdateUserProfileInput!) {\n    updateUserProfile(input: $input) {\n      id\n      name\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.profile/components/setting-profile-form.tsx"},"span":[12016,12269],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { CropImageField } from \"~/components/crop-image-field\"\nimport { Button } from \"~/components/ui/button\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport {\n  DialogWorkFragment,\n  SelectCreatedWorksDialog,\n} from \"~/routes/($lang).my._index/components/select-created-works-dialog\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon, Pencil, PlusIcon } from \"lucide-react\"\nimport { Suspense, useContext, useState, useEffect } from \"react\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { SelectCreatedSensitiveWorksDialog } from \"~/routes/($lang).my._index/components/select-created-sensitive-works-dialog\"\n\n/**\n * ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function SettingProfileForm () {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const { data: user, loading } = useQuery(userQuery, {\n    skip:\n      authContext.isLoading || authContext.isNotLoggedIn || !authContext.userId,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const userInfo = user?.user\n\n  // ã™ã¹ã¦ã®ãƒ•ãƒƒã‚¯ã‚’æ¡ä»¶ãªã—ã§å‘¼ã³å‡ºã™\n  const [userName, setUserName] = useState(\"\")\n  const [profile, setProfile] = useState(\"\")\n  const [enProfile, setEnProfile] = useState(\"\")\n  const [website, setWebsite] = useState(\"\")\n  const [instagram, setInstagram] = useState(\"\")\n  const [twitter, setTwitter] = useState(\"\")\n  const [github, setGithub] = useState(\"\")\n  const [mail, setMail] = useState(\"\")\n  const [profileImage, setProfileImage] = useState(\"\")\n  const [headerImage, setHeaderImage] = useState(\"\")\n  const [selectedPickupWorks, setSelectedPickupWorks] = useState<\n    Array<{\n      id: string\n      title: string\n      smallThumbnailImageURL: string\n    }>\n  >([])\n  const [selectedPickupSensitiveWorks, setSelectedPickupSensitiveWorks] =\n    useState<\n      Array<{\n        id: string\n        title: string\n        smallThumbnailImageURL: string\n      }>\n    >([])\n\n  const { data: token } = useQuery(viewerTokenQuery)\n\n  const [updateProfile, { loading: isUpdating }] = useMutation(\n    updateUserProfileMutation,\n  )\n\n  // userInfoãŒå–å¾—ã•ã‚ŒãŸã‚‰stateã‚’åˆæœŸåŒ–\n  useEffect(() => {\n    if (userInfo) {\n      setUserName(userInfo.name || authContext.displayName || \"\")\n      setProfile(userInfo.biography ?? \"\")\n      setEnProfile(userInfo.enBiography ?? \"\")\n      setWebsite(userInfo.siteURL ?? \"\")\n      setInstagram(userInfo.instagramAccountId ?? \"\")\n      setTwitter(userInfo.twitterAccountId ?? \"\")\n      setGithub(userInfo.githubAccountId ?? \"\")\n      setMail(userInfo.mailAddress ?? \"\")\n      setSelectedPickupWorks(\n        userInfo.featuredWorks?.map((work) => ({\n          id: work.id,\n          title: work.title,\n          smallThumbnailImageURL: work.smallThumbnailImageURL,\n        })) ?? [],\n      )\n      setSelectedPickupSensitiveWorks(\n        userInfo.featuredSensitiveWorks?.map((work) => ({\n          id: work.id,\n          title: work.title,\n          smallThumbnailImageURL: work.smallThumbnailImageURL,\n        })) ?? [],\n      )\n    }\n  }, [userInfo, authContext.displayName])\n\n  // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã‚’ãƒ•ãƒƒã‚¯å‘¼ã³å‡ºã—å¾Œã«ç¢ºèª\n  if (loading || authContext.isLoading || authContext.isNotLoggedIn) {\n    return <AppLoadingPage />\n  }\n\n  if (!userInfo) {\n    return <AppLoadingPage />\n  }\n\n  const onSubmit = async () => {\n    if (isUpdating || authContext.userId === null) {\n      return\n    }\n\n    const iconUrl = profileImage\n      ? await uploadPublicImage(profileImage, token?.viewer?.token)\n      : null\n\n    const headerUrl = headerImage\n      ? await uploadPublicImage(headerImage, token?.viewer?.token)\n      : null\n\n    await updateProfile({\n      variables: {\n        input: {\n          displayName: userName,\n          biography: profile,\n          enBiography: enProfile,\n          homeUrl: website,\n          instagramAccountId: instagram,\n          twitterAccountId: twitter,\n          githubAccountId: github,\n          mailAddress: mail,\n          ...(iconUrl && {\n            iconUrl: iconUrl,\n          }),\n          ...(headerUrl && {\n            headerImageUrl: headerUrl,\n          }),\n          featuredWorkIds: selectedPickupWorks.map((work) => work.id),\n          featuredSensitiveWorkIds: selectedPickupSensitiveWorks.map(\n            (work) => work.id,\n          ),\n        },\n      },\n    })\n\n    toast(t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚\", \"Profile updated.\"))\n  }\n\n  const profileImageSrc =\n    profileImage.length > 0 ? profileImage : userInfo?.iconUrl\n\n  const headerImageSrc =\n    headerImage.length > 0 ? headerImage : userInfo?.headerImageUrl\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        <div className=\"justify-between\">\n          <div className=\"relative\">\n            {headerImageSrc ? (\n              <img\n                className=\"h-auto max-h-96 w-full object-cover\"\n                src={headerImageSrc}\n                alt={t(\"ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒ\", \"Header Image\")}\n              />\n            ) : (\n              <div className=\"h-40 w-full bg-gray-700\" />\n            )}\n            <div className=\"absolute bottom-[-24px] left-2 size-32\">\n              {profileImageSrc ? (\n                <img\n                  className=\"absolute size-32 rounded-full border-2\"\n                  src={profileImageSrc}\n                  alt={t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ\", \"Profile Image\")}\n                />\n              ) : (\n                <div className=\"size-32 rounded-full border-2 bg-gray-700\" />\n              )}\n\n              <CropImageField\n                isHidePreviewImage={false}\n                cropWidth={240}\n                cropHeight={240}\n                onDeleteImage={() => {\n                  setProfileImage(\"\")\n                }}\n                onCropToBase64={(base64: string) => {\n                  try {\n                    setProfileImage(base64)\n                  } catch (error) {\n                    console.error(\"Error in onCropToBase64:\", error)\n                  }\n                }}\n                fileExtension={\"webp\"}\n              >\n                <Button\n                  className=\"absolute top-0 right-0 size-8 rounded-full p-0\"\n                  variant={\"secondary\"}\n                >\n                  <Pencil className=\"size-4\" />\n                </Button>\n              </CropImageField>\n            </div>\n\n            <CropImageField\n              isHidePreviewImage={false}\n              cropWidth={1200}\n              cropHeight={627}\n              onDeleteImage={() => {\n                setHeaderImage(\"\")\n              }}\n              onCropToBase64={setHeaderImage}\n              fileExtension={\"webp\"}\n            >\n              <Button\n                className=\"absolute top-1 right-1 size-8 rounded-full p-0\"\n                variant={\"secondary\"}\n              >\n                <Pencil className=\"size-4\" />\n              </Button>\n            </CropImageField>\n          </div>\n          <p className=\"mt-8\">\n            {t(\n              \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒã«R-18ç”»åƒã¯æ²è¼‰ã§ãã¾ã›ã‚“ã€‚\",\n              \"R-18 images cannot be used for profile or header images.\",\n            )}\n          </p>\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"nickname\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ \", \"Nickname\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"nickname\"\n            maxLength={32}\n            minLength={1}\n            value={userName}\n            onChange={(e) => setUserName(e.target.value)}\n            className=\"rounded-md border px-2 py-1\"\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"profile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"profile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={320}\n            value={profile}\n            onChange={(e) => setProfile(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"enProfile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"è‹±èªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"English Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"enProfile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={640}\n            value={enProfile}\n            onChange={(e) => setEnProfile(e.target.value)}\n          />\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"website\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"Webã‚µã‚¤ãƒˆ\", \"Website\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"website\"\n            className=\"rounded-md border px-2 py-1\"\n            value={website}\n            maxLength={1000}\n            onChange={(e) => setWebsite(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"instagram\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Instagram\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"instagram\"\n            className=\"rounded-md border px-2 py-1\"\n            value={instagram}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setInstagram(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"twitter\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"X(æ—§Twitter)\", \"X (formerly Twitter)\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"twitter\"\n            className=\"rounded-md border px-2 py-1\"\n            value={twitter}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setTwitter(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"github\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Github\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"github\"\n            className=\"rounded-md border px-2 py-1\"\n            value={github}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setGithub(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"mail\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\", \"Email Address\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"mail\"\n            className=\"rounded-md border px-2 py-1\"\n            value={mail}\n            placeholder={\"\"}\n            maxLength={320}\n            onChange={(e) => setMail(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"pickup\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ— â€»æœ€å¤§3ã¤\", \"Pickups (Max 3)\")}\n          </label>\n          <Suspense fallback={<AppLoadingPage />}>\n            <SelectCreatedWorksDialog\n              selectedWorks={selectedPickupWorks}\n              setSelectedWorks={setSelectedPickupWorks}\n              limit={3}\n            >\n              <div className=\"border-2 border-transparent p-1\">\n                <Button className=\"size-16\" size={\"icon\"} variant={\"secondary\"}>\n                  <PlusIcon />\n                </Button>\n              </div>\n            </SelectCreatedWorksDialog>\n          </Suspense>\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"sensitive-pickup\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\n              \"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ— â€»æœ€å¤§3ã¤\",\n              \"Sensitive Pickups (Max 3)\",\n            )}\n          </label>\n          <Suspense fallback={<AppLoadingPage />}>\n            <SelectCreatedSensitiveWorksDialog\n              selectedWorks={selectedPickupSensitiveWorks}\n              setSelectedWorks={setSelectedPickupSensitiveWorks}\n              limit={3}\n            >\n              <div className=\"border-2 border-transparent p-1\">\n                <Button className=\"size-16\" size={\"icon\"} variant={\"secondary\"}>\n                  <PlusIcon />\n                </Button>\n              </div>\n            </SelectCreatedSensitiveWorksDialog>\n          </Suspense>\n        </div>\n        <Separator />\n        <Button\n          disabled={isUpdating}\n          onClick={onSubmit}\n          className=\"ml-auto block w-24\"\n        >\n          {isUpdating ? (\n            <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n          ) : (\n            t(\"æ›´æ–°ã™ã‚‹\", \"Update\")\n          )}\n        </Button>\n        <Separator />\n        <a className=\"m-auto block\" href=\"settings/account/login\">\n          <Button className=\"m-auto block\" variant={\"secondary\"}>\n            {t(\"ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ã‚’å¤‰æ›´ã™ã‚‹\", \"Change Login Information\")}\n          </Button>\n        </a>\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      login\n      nanoid\n      name\n      iconUrl\n      headerImageUrl\n      featuredSensitiveWorks {\n        ...DialogWork\n      }\n      featuredWorks {\n        ...DialogWork\n      }\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n    }\n  }`,\n  [DialogWorkFragment],\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserProfileMutation = graphql(\n  `mutation UpdateUserProfile($input: UpdateUserProfileInput!) {\n    updateUserProfile(input: $input) {\n      id\n      name\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.profile/components/setting-profile-form.tsx"},"span":[7964,8225],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { CropImageField } from \"~/components/crop-image-field\"\nimport { Button } from \"~/components/ui/button\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport {\n  DialogWorkFragment,\n  SelectCreatedWorksDialog,\n} from \"~/routes/($lang).my._index/components/select-created-works-dialog\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon, Pencil, PlusIcon } from \"lucide-react\"\nimport { Suspense, useContext, useState, useEffect } from \"react\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { SelectCreatedSensitiveWorksDialog } from \"~/routes/($lang).my._index/components/select-created-sensitive-works-dialog\"\n\n/**\n * ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function SettingProfileForm () {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const { data: user, loading } = useQuery(userQuery, {\n    skip:\n      authContext.isLoading || authContext.isNotLoggedIn || !authContext.userId,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const userInfo = user?.user\n\n  // ã™ã¹ã¦ã®ãƒ•ãƒƒã‚¯ã‚’æ¡ä»¶ãªã—ã§å‘¼ã³å‡ºã™\n  const [userName, setUserName] = useState(\"\")\n  const [profile, setProfile] = useState(\"\")\n  const [enProfile, setEnProfile] = useState(\"\")\n  const [website, setWebsite] = useState(\"\")\n  const [instagram, setInstagram] = useState(\"\")\n  const [twitter, setTwitter] = useState(\"\")\n  const [github, setGithub] = useState(\"\")\n  const [mail, setMail] = useState(\"\")\n  const [profileImage, setProfileImage] = useState(\"\")\n  const [headerImage, setHeaderImage] = useState(\"\")\n  const [selectedPickupWorks, setSelectedPickupWorks] = useState<\n    Array<{\n      id: string\n      title: string\n      smallThumbnailImageURL: string\n    }>\n  >([])\n  const [selectedPickupSensitiveWorks, setSelectedPickupSensitiveWorks] =\n    useState<\n      Array<{\n        id: string\n        title: string\n        smallThumbnailImageURL: string\n      }>\n    >([])\n\n  const { data: token } = useQuery(viewerTokenQuery)\n\n  const [updateProfile, { loading: isUpdating }] = useMutation(\n    updateUserProfileMutation,\n  )\n\n  // userInfoãŒå–å¾—ã•ã‚ŒãŸã‚‰stateã‚’åˆæœŸåŒ–\n  useEffect(() => {\n    if (userInfo) {\n      setUserName(userInfo.name || authContext.displayName || \"\")\n      setProfile(userInfo.biography ?? \"\")\n      setEnProfile(userInfo.enBiography ?? \"\")\n      setWebsite(userInfo.siteURL ?? \"\")\n      setInstagram(userInfo.instagramAccountId ?? \"\")\n      setTwitter(userInfo.twitterAccountId ?? \"\")\n      setGithub(userInfo.githubAccountId ?? \"\")\n      setMail(userInfo.mailAddress ?? \"\")\n      setSelectedPickupWorks(\n        userInfo.featuredWorks?.map((work) => ({\n          id: work.id,\n          title: work.title,\n          smallThumbnailImageURL: work.smallThumbnailImageURL,\n        })) ?? [],\n      )\n      setSelectedPickupSensitiveWorks(\n        userInfo.featuredSensitiveWorks?.map((work) => ({\n          id: work.id,\n          title: work.title,\n          smallThumbnailImageURL: work.smallThumbnailImageURL,\n        })) ?? [],\n      )\n    }\n  }, [userInfo, authContext.displayName])\n\n  // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã‚’ãƒ•ãƒƒã‚¯å‘¼ã³å‡ºã—å¾Œã«ç¢ºèª\n  if (loading || authContext.isLoading || authContext.isNotLoggedIn) {\n    return <AppLoadingPage />\n  }\n\n  if (!userInfo) {\n    return <AppLoadingPage />\n  }\n\n  const onSubmit = async () => {\n    if (isUpdating || authContext.userId === null) {\n      return\n    }\n\n    const iconUrl = profileImage\n      ? await uploadPublicImage(profileImage, token?.viewer?.token)\n      : null\n\n    const headerUrl = headerImage\n      ? await uploadPublicImage(headerImage, token?.viewer?.token)\n      : null\n\n    await updateProfile({\n      variables: {\n        input: {\n          displayName: userName,\n          biography: profile,\n          enBiography: enProfile,\n          homeUrl: website,\n          instagramAccountId: instagram,\n          twitterAccountId: twitter,\n          githubAccountId: github,\n          mailAddress: mail,\n          ...(iconUrl && {\n            iconUrl: iconUrl,\n          }),\n          ...(headerUrl && {\n            headerImageUrl: headerUrl,\n          }),\n          featuredWorkIds: selectedPickupWorks.map((work) => work.id),\n          featuredSensitiveWorkIds: selectedPickupSensitiveWorks.map(\n            (work) => work.id,\n          ),\n        },\n      },\n    })\n\n    toast(t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚\", \"Profile updated.\"))\n  }\n\n  const profileImageSrc =\n    profileImage.length > 0 ? profileImage : userInfo?.iconUrl\n\n  const headerImageSrc =\n    headerImage.length > 0 ? headerImage : userInfo?.headerImageUrl\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        <div className=\"justify-between\">\n          <div className=\"relative\">\n            {headerImageSrc ? (\n              <img\n                className=\"h-auto max-h-96 w-full object-cover\"\n                src={headerImageSrc}\n                alt={t(\"ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒ\", \"Header Image\")}\n              />\n            ) : (\n              <div className=\"h-40 w-full bg-gray-700\" />\n            )}\n            <div className=\"absolute bottom-[-24px] left-2 size-32\">\n              {profileImageSrc ? (\n                <img\n                  className=\"absolute size-32 rounded-full border-2\"\n                  src={profileImageSrc}\n                  alt={t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ\", \"Profile Image\")}\n                />\n              ) : (\n                <div className=\"size-32 rounded-full border-2 bg-gray-700\" />\n              )}\n\n              <CropImageField\n                isHidePreviewImage={false}\n                cropWidth={240}\n                cropHeight={240}\n                onDeleteImage={() => {\n                  setProfileImage(\"\")\n                }}\n                onCropToBase64={(base64: string) => {\n                  try {\n                    setProfileImage(base64)\n                  } catch (error) {\n                    console.error(\"Error in onCropToBase64:\", error)\n                  }\n                }}\n                fileExtension={\"webp\"}\n              >\n                <Button\n                  className=\"absolute top-0 right-0 size-8 rounded-full p-0\"\n                  variant={\"secondary\"}\n                >\n                  <Pencil className=\"size-4\" />\n                </Button>\n              </CropImageField>\n            </div>\n\n            <CropImageField\n              isHidePreviewImage={false}\n              cropWidth={1200}\n              cropHeight={627}\n              onDeleteImage={() => {\n                setHeaderImage(\"\")\n              }}\n              onCropToBase64={setHeaderImage}\n              fileExtension={\"webp\"}\n            >\n              <Button\n                className=\"absolute top-1 right-1 size-8 rounded-full p-0\"\n                variant={\"secondary\"}\n              >\n                <Pencil className=\"size-4\" />\n              </Button>\n            </CropImageField>\n          </div>\n          <p className=\"mt-8\">\n            {t(\n              \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒã«R-18ç”»åƒã¯æ²è¼‰ã§ãã¾ã›ã‚“ã€‚\",\n              \"R-18 images cannot be used for profile or header images.\",\n            )}\n          </p>\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"nickname\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ \", \"Nickname\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"nickname\"\n            maxLength={32}\n            minLength={1}\n            value={userName}\n            onChange={(e) => setUserName(e.target.value)}\n            className=\"rounded-md border px-2 py-1\"\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"profile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"profile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={320}\n            value={profile}\n            onChange={(e) => setProfile(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"enProfile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"è‹±èªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"English Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"enProfile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={640}\n            value={enProfile}\n            onChange={(e) => setEnProfile(e.target.value)}\n          />\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"website\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"Webã‚µã‚¤ãƒˆ\", \"Website\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"website\"\n            className=\"rounded-md border px-2 py-1\"\n            value={website}\n            maxLength={1000}\n            onChange={(e) => setWebsite(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"instagram\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Instagram\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"instagram\"\n            className=\"rounded-md border px-2 py-1\"\n            value={instagram}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setInstagram(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"twitter\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"X(æ—§Twitter)\", \"X (formerly Twitter)\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"twitter\"\n            className=\"rounded-md border px-2 py-1\"\n            value={twitter}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setTwitter(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"github\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Github\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"github\"\n            className=\"rounded-md border px-2 py-1\"\n            value={github}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setGithub(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"mail\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\", \"Email Address\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"mail\"\n            className=\"rounded-md border px-2 py-1\"\n            value={mail}\n            placeholder={\"\"}\n            maxLength={320}\n            onChange={(e) => setMail(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"pickup\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ— â€»æœ€å¤§3ã¤\", \"Pickups (Max 3)\")}\n          </label>\n          <Suspense fallback={<AppLoadingPage />}>\n            <SelectCreatedWorksDialog\n              selectedWorks={selectedPickupWorks}\n              setSelectedWorks={setSelectedPickupWorks}\n              limit={3}\n            >\n              <div className=\"border-2 border-transparent p-1\">\n                <Button className=\"size-16\" size={\"icon\"} variant={\"secondary\"}>\n                  <PlusIcon />\n                </Button>\n              </div>\n            </SelectCreatedWorksDialog>\n          </Suspense>\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"sensitive-pickup\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\n              \"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ— â€»æœ€å¤§3ã¤\",\n              \"Sensitive Pickups (Max 3)\",\n            )}\n          </label>\n          <Suspense fallback={<AppLoadingPage />}>\n            <SelectCreatedSensitiveWorksDialog\n              selectedWorks={selectedPickupSensitiveWorks}\n              setSelectedWorks={setSelectedPickupSensitiveWorks}\n              limit={3}\n            >\n              <div className=\"border-2 border-transparent p-1\">\n                <Button className=\"size-16\" size={\"icon\"} variant={\"secondary\"}>\n                  <PlusIcon />\n                </Button>\n              </div>\n            </SelectCreatedSensitiveWorksDialog>\n          </Suspense>\n        </div>\n        <Separator />\n        <Button\n          disabled={isUpdating}\n          onClick={onSubmit}\n          className=\"ml-auto block w-24\"\n        >\n          {isUpdating ? (\n            <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n          ) : (\n            t(\"æ›´æ–°ã™ã‚‹\", \"Update\")\n          )}\n        </Button>\n        <Separator />\n        <a className=\"m-auto block\" href=\"settings/account/login\">\n          <Button className=\"m-auto block\" variant={\"secondary\"}>\n            {t(\"ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ã‚’å¤‰æ›´ã™ã‚‹\", \"Change Login Information\")}\n          </Button>\n        </a>\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      login\n      nanoid\n      name\n      iconUrl\n      headerImageUrl\n      featuredSensitiveWorks {\n        ...DialogWork\n      }\n      featuredWorks {\n        ...DialogWork\n      }\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n    }\n  }`,\n  [DialogWorkFragment],\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserProfileMutation = graphql(\n  `mutation UpdateUserProfile($input: UpdateUserProfileInput!) {\n    updateUserProfile(input: $input) {\n      id\n      name\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.profile/components/setting-profile-form.tsx"},"span":[8559,8781],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { CropImageField } from \"~/components/crop-image-field\"\nimport { Button } from \"~/components/ui/button\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport {\n  DialogWorkFragment,\n  SelectCreatedWorksDialog,\n} from \"~/routes/($lang).my._index/components/select-created-works-dialog\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon, Pencil, PlusIcon } from \"lucide-react\"\nimport { Suspense, useContext, useState, useEffect } from \"react\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { SelectCreatedSensitiveWorksDialog } from \"~/routes/($lang).my._index/components/select-created-sensitive-works-dialog\"\n\n/**\n * ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function SettingProfileForm () {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const { data: user, loading } = useQuery(userQuery, {\n    skip:\n      authContext.isLoading || authContext.isNotLoggedIn || !authContext.userId,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const userInfo = user?.user\n\n  // ã™ã¹ã¦ã®ãƒ•ãƒƒã‚¯ã‚’æ¡ä»¶ãªã—ã§å‘¼ã³å‡ºã™\n  const [userName, setUserName] = useState(\"\")\n  const [profile, setProfile] = useState(\"\")\n  const [enProfile, setEnProfile] = useState(\"\")\n  const [website, setWebsite] = useState(\"\")\n  const [instagram, setInstagram] = useState(\"\")\n  const [twitter, setTwitter] = useState(\"\")\n  const [github, setGithub] = useState(\"\")\n  const [mail, setMail] = useState(\"\")\n  const [profileImage, setProfileImage] = useState(\"\")\n  const [headerImage, setHeaderImage] = useState(\"\")\n  const [selectedPickupWorks, setSelectedPickupWorks] = useState<\n    Array<{\n      id: string\n      title: string\n      smallThumbnailImageURL: string\n    }>\n  >([])\n  const [selectedPickupSensitiveWorks, setSelectedPickupSensitiveWorks] =\n    useState<\n      Array<{\n        id: string\n        title: string\n        smallThumbnailImageURL: string\n      }>\n    >([])\n\n  const { data: token } = useQuery(viewerTokenQuery)\n\n  const [updateProfile, { loading: isUpdating }] = useMutation(\n    updateUserProfileMutation,\n  )\n\n  // userInfoãŒå–å¾—ã•ã‚ŒãŸã‚‰stateã‚’åˆæœŸåŒ–\n  useEffect(() => {\n    if (userInfo) {\n      setUserName(userInfo.name || authContext.displayName || \"\")\n      setProfile(userInfo.biography ?? \"\")\n      setEnProfile(userInfo.enBiography ?? \"\")\n      setWebsite(userInfo.siteURL ?? \"\")\n      setInstagram(userInfo.instagramAccountId ?? \"\")\n      setTwitter(userInfo.twitterAccountId ?? \"\")\n      setGithub(userInfo.githubAccountId ?? \"\")\n      setMail(userInfo.mailAddress ?? \"\")\n      setSelectedPickupWorks(\n        userInfo.featuredWorks?.map((work) => ({\n          id: work.id,\n          title: work.title,\n          smallThumbnailImageURL: work.smallThumbnailImageURL,\n        })) ?? [],\n      )\n      setSelectedPickupSensitiveWorks(\n        userInfo.featuredSensitiveWorks?.map((work) => ({\n          id: work.id,\n          title: work.title,\n          smallThumbnailImageURL: work.smallThumbnailImageURL,\n        })) ?? [],\n      )\n    }\n  }, [userInfo, authContext.displayName])\n\n  // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã‚’ãƒ•ãƒƒã‚¯å‘¼ã³å‡ºã—å¾Œã«ç¢ºèª\n  if (loading || authContext.isLoading || authContext.isNotLoggedIn) {\n    return <AppLoadingPage />\n  }\n\n  if (!userInfo) {\n    return <AppLoadingPage />\n  }\n\n  const onSubmit = async () => {\n    if (isUpdating || authContext.userId === null) {\n      return\n    }\n\n    const iconUrl = profileImage\n      ? await uploadPublicImage(profileImage, token?.viewer?.token)\n      : null\n\n    const headerUrl = headerImage\n      ? await uploadPublicImage(headerImage, token?.viewer?.token)\n      : null\n\n    await updateProfile({\n      variables: {\n        input: {\n          displayName: userName,\n          biography: profile,\n          enBiography: enProfile,\n          homeUrl: website,\n          instagramAccountId: instagram,\n          twitterAccountId: twitter,\n          githubAccountId: github,\n          mailAddress: mail,\n          ...(iconUrl && {\n            iconUrl: iconUrl,\n          }),\n          ...(headerUrl && {\n            headerImageUrl: headerUrl,\n          }),\n          featuredWorkIds: selectedPickupWorks.map((work) => work.id),\n          featuredSensitiveWorkIds: selectedPickupSensitiveWorks.map(\n            (work) => work.id,\n          ),\n        },\n      },\n    })\n\n    toast(t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚\", \"Profile updated.\"))\n  }\n\n  const profileImageSrc =\n    profileImage.length > 0 ? profileImage : userInfo?.iconUrl\n\n  const headerImageSrc =\n    headerImage.length > 0 ? headerImage : userInfo?.headerImageUrl\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        <div className=\"justify-between\">\n          <div className=\"relative\">\n            {headerImageSrc ? (\n              <img\n                className=\"h-auto max-h-96 w-full object-cover\"\n                src={headerImageSrc}\n                alt={t(\"ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒ\", \"Header Image\")}\n              />\n            ) : (\n              <div className=\"h-40 w-full bg-gray-700\" />\n            )}\n            <div className=\"absolute bottom-[-24px] left-2 size-32\">\n              {profileImageSrc ? (\n                <img\n                  className=\"absolute size-32 rounded-full border-2\"\n                  src={profileImageSrc}\n                  alt={t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ\", \"Profile Image\")}\n                />\n              ) : (\n                <div className=\"size-32 rounded-full border-2 bg-gray-700\" />\n              )}\n\n              <CropImageField\n                isHidePreviewImage={false}\n                cropWidth={240}\n                cropHeight={240}\n                onDeleteImage={() => {\n                  setProfileImage(\"\")\n                }}\n                onCropToBase64={(base64: string) => {\n                  try {\n                    setProfileImage(base64)\n                  } catch (error) {\n                    console.error(\"Error in onCropToBase64:\", error)\n                  }\n                }}\n                fileExtension={\"webp\"}\n              >\n                <Button\n                  className=\"absolute top-0 right-0 size-8 rounded-full p-0\"\n                  variant={\"secondary\"}\n                >\n                  <Pencil className=\"size-4\" />\n                </Button>\n              </CropImageField>\n            </div>\n\n            <CropImageField\n              isHidePreviewImage={false}\n              cropWidth={1200}\n              cropHeight={627}\n              onDeleteImage={() => {\n                setHeaderImage(\"\")\n              }}\n              onCropToBase64={setHeaderImage}\n              fileExtension={\"webp\"}\n            >\n              <Button\n                className=\"absolute top-1 right-1 size-8 rounded-full p-0\"\n                variant={\"secondary\"}\n              >\n                <Pencil className=\"size-4\" />\n              </Button>\n            </CropImageField>\n          </div>\n          <p className=\"mt-8\">\n            {t(\n              \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒã«R-18ç”»åƒã¯æ²è¼‰ã§ãã¾ã›ã‚“ã€‚\",\n              \"R-18 images cannot be used for profile or header images.\",\n            )}\n          </p>\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"nickname\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ \", \"Nickname\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"nickname\"\n            maxLength={32}\n            minLength={1}\n            value={userName}\n            onChange={(e) => setUserName(e.target.value)}\n            className=\"rounded-md border px-2 py-1\"\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"profile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"profile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={320}\n            value={profile}\n            onChange={(e) => setProfile(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"enProfile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"è‹±èªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"English Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"enProfile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={640}\n            value={enProfile}\n            onChange={(e) => setEnProfile(e.target.value)}\n          />\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"website\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"Webã‚µã‚¤ãƒˆ\", \"Website\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"website\"\n            className=\"rounded-md border px-2 py-1\"\n            value={website}\n            maxLength={1000}\n            onChange={(e) => setWebsite(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"instagram\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Instagram\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"instagram\"\n            className=\"rounded-md border px-2 py-1\"\n            value={instagram}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setInstagram(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"twitter\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"X(æ—§Twitter)\", \"X (formerly Twitter)\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"twitter\"\n            className=\"rounded-md border px-2 py-1\"\n            value={twitter}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setTwitter(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"github\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Github\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"github\"\n            className=\"rounded-md border px-2 py-1\"\n            value={github}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setGithub(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"mail\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\", \"Email Address\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"mail\"\n            className=\"rounded-md border px-2 py-1\"\n            value={mail}\n            placeholder={\"\"}\n            maxLength={320}\n            onChange={(e) => setMail(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"pickup\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ— â€»æœ€å¤§3ã¤\", \"Pickups (Max 3)\")}\n          </label>\n          <Suspense fallback={<AppLoadingPage />}>\n            <SelectCreatedWorksDialog\n              selectedWorks={selectedPickupWorks}\n              setSelectedWorks={setSelectedPickupWorks}\n              limit={3}\n            >\n              <div className=\"border-2 border-transparent p-1\">\n                <Button className=\"size-16\" size={\"icon\"} variant={\"secondary\"}>\n                  <PlusIcon />\n                </Button>\n              </div>\n            </SelectCreatedWorksDialog>\n          </Suspense>\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"sensitive-pickup\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\n              \"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ— â€»æœ€å¤§3ã¤\",\n              \"Sensitive Pickups (Max 3)\",\n            )}\n          </label>\n          <Suspense fallback={<AppLoadingPage />}>\n            <SelectCreatedSensitiveWorksDialog\n              selectedWorks={selectedPickupSensitiveWorks}\n              setSelectedWorks={setSelectedPickupSensitiveWorks}\n              limit={3}\n            >\n              <div className=\"border-2 border-transparent p-1\">\n                <Button className=\"size-16\" size={\"icon\"} variant={\"secondary\"}>\n                  <PlusIcon />\n                </Button>\n              </div>\n            </SelectCreatedSensitiveWorksDialog>\n          </Suspense>\n        </div>\n        <Separator />\n        <Button\n          disabled={isUpdating}\n          onClick={onSubmit}\n          className=\"ml-auto block w-24\"\n        >\n          {isUpdating ? (\n            <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n          ) : (\n            t(\"æ›´æ–°ã™ã‚‹\", \"Update\")\n          )}\n        </Button>\n        <Separator />\n        <a className=\"m-auto block\" href=\"settings/account/login\">\n          <Button className=\"m-auto block\" variant={\"secondary\"}>\n            {t(\"ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ã‚’å¤‰æ›´ã™ã‚‹\", \"Change Login Information\")}\n          </Button>\n        </a>\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      login\n      nanoid\n      name\n      iconUrl\n      headerImageUrl\n      featuredSensitiveWorks {\n        ...DialogWork\n      }\n      featuredWorks {\n        ...DialogWork\n      }\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n    }\n  }`,\n  [DialogWorkFragment],\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserProfileMutation = graphql(\n  `mutation UpdateUserProfile($input: UpdateUserProfileInput!) {\n    updateUserProfile(input: $input) {\n      id\n      name\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.profile/components/setting-profile-form.tsx"},"span":[9131,9359],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { CropImageField } from \"~/components/crop-image-field\"\nimport { Button } from \"~/components/ui/button\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport {\n  DialogWorkFragment,\n  SelectCreatedWorksDialog,\n} from \"~/routes/($lang).my._index/components/select-created-works-dialog\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon, Pencil, PlusIcon } from \"lucide-react\"\nimport { Suspense, useContext, useState, useEffect } from \"react\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { SelectCreatedSensitiveWorksDialog } from \"~/routes/($lang).my._index/components/select-created-sensitive-works-dialog\"\n\n/**\n * ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function SettingProfileForm () {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const { data: user, loading } = useQuery(userQuery, {\n    skip:\n      authContext.isLoading || authContext.isNotLoggedIn || !authContext.userId,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const userInfo = user?.user\n\n  // ã™ã¹ã¦ã®ãƒ•ãƒƒã‚¯ã‚’æ¡ä»¶ãªã—ã§å‘¼ã³å‡ºã™\n  const [userName, setUserName] = useState(\"\")\n  const [profile, setProfile] = useState(\"\")\n  const [enProfile, setEnProfile] = useState(\"\")\n  const [website, setWebsite] = useState(\"\")\n  const [instagram, setInstagram] = useState(\"\")\n  const [twitter, setTwitter] = useState(\"\")\n  const [github, setGithub] = useState(\"\")\n  const [mail, setMail] = useState(\"\")\n  const [profileImage, setProfileImage] = useState(\"\")\n  const [headerImage, setHeaderImage] = useState(\"\")\n  const [selectedPickupWorks, setSelectedPickupWorks] = useState<\n    Array<{\n      id: string\n      title: string\n      smallThumbnailImageURL: string\n    }>\n  >([])\n  const [selectedPickupSensitiveWorks, setSelectedPickupSensitiveWorks] =\n    useState<\n      Array<{\n        id: string\n        title: string\n        smallThumbnailImageURL: string\n      }>\n    >([])\n\n  const { data: token } = useQuery(viewerTokenQuery)\n\n  const [updateProfile, { loading: isUpdating }] = useMutation(\n    updateUserProfileMutation,\n  )\n\n  // userInfoãŒå–å¾—ã•ã‚ŒãŸã‚‰stateã‚’åˆæœŸåŒ–\n  useEffect(() => {\n    if (userInfo) {\n      setUserName(userInfo.name || authContext.displayName || \"\")\n      setProfile(userInfo.biography ?? \"\")\n      setEnProfile(userInfo.enBiography ?? \"\")\n      setWebsite(userInfo.siteURL ?? \"\")\n      setInstagram(userInfo.instagramAccountId ?? \"\")\n      setTwitter(userInfo.twitterAccountId ?? \"\")\n      setGithub(userInfo.githubAccountId ?? \"\")\n      setMail(userInfo.mailAddress ?? \"\")\n      setSelectedPickupWorks(\n        userInfo.featuredWorks?.map((work) => ({\n          id: work.id,\n          title: work.title,\n          smallThumbnailImageURL: work.smallThumbnailImageURL,\n        })) ?? [],\n      )\n      setSelectedPickupSensitiveWorks(\n        userInfo.featuredSensitiveWorks?.map((work) => ({\n          id: work.id,\n          title: work.title,\n          smallThumbnailImageURL: work.smallThumbnailImageURL,\n        })) ?? [],\n      )\n    }\n  }, [userInfo, authContext.displayName])\n\n  // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã‚’ãƒ•ãƒƒã‚¯å‘¼ã³å‡ºã—å¾Œã«ç¢ºèª\n  if (loading || authContext.isLoading || authContext.isNotLoggedIn) {\n    return <AppLoadingPage />\n  }\n\n  if (!userInfo) {\n    return <AppLoadingPage />\n  }\n\n  const onSubmit = async () => {\n    if (isUpdating || authContext.userId === null) {\n      return\n    }\n\n    const iconUrl = profileImage\n      ? await uploadPublicImage(profileImage, token?.viewer?.token)\n      : null\n\n    const headerUrl = headerImage\n      ? await uploadPublicImage(headerImage, token?.viewer?.token)\n      : null\n\n    await updateProfile({\n      variables: {\n        input: {\n          displayName: userName,\n          biography: profile,\n          enBiography: enProfile,\n          homeUrl: website,\n          instagramAccountId: instagram,\n          twitterAccountId: twitter,\n          githubAccountId: github,\n          mailAddress: mail,\n          ...(iconUrl && {\n            iconUrl: iconUrl,\n          }),\n          ...(headerUrl && {\n            headerImageUrl: headerUrl,\n          }),\n          featuredWorkIds: selectedPickupWorks.map((work) => work.id),\n          featuredSensitiveWorkIds: selectedPickupSensitiveWorks.map(\n            (work) => work.id,\n          ),\n        },\n      },\n    })\n\n    toast(t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚\", \"Profile updated.\"))\n  }\n\n  const profileImageSrc =\n    profileImage.length > 0 ? profileImage : userInfo?.iconUrl\n\n  const headerImageSrc =\n    headerImage.length > 0 ? headerImage : userInfo?.headerImageUrl\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        <div className=\"justify-between\">\n          <div className=\"relative\">\n            {headerImageSrc ? (\n              <img\n                className=\"h-auto max-h-96 w-full object-cover\"\n                src={headerImageSrc}\n                alt={t(\"ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒ\", \"Header Image\")}\n              />\n            ) : (\n              <div className=\"h-40 w-full bg-gray-700\" />\n            )}\n            <div className=\"absolute bottom-[-24px] left-2 size-32\">\n              {profileImageSrc ? (\n                <img\n                  className=\"absolute size-32 rounded-full border-2\"\n                  src={profileImageSrc}\n                  alt={t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ\", \"Profile Image\")}\n                />\n              ) : (\n                <div className=\"size-32 rounded-full border-2 bg-gray-700\" />\n              )}\n\n              <CropImageField\n                isHidePreviewImage={false}\n                cropWidth={240}\n                cropHeight={240}\n                onDeleteImage={() => {\n                  setProfileImage(\"\")\n                }}\n                onCropToBase64={(base64: string) => {\n                  try {\n                    setProfileImage(base64)\n                  } catch (error) {\n                    console.error(\"Error in onCropToBase64:\", error)\n                  }\n                }}\n                fileExtension={\"webp\"}\n              >\n                <Button\n                  className=\"absolute top-0 right-0 size-8 rounded-full p-0\"\n                  variant={\"secondary\"}\n                >\n                  <Pencil className=\"size-4\" />\n                </Button>\n              </CropImageField>\n            </div>\n\n            <CropImageField\n              isHidePreviewImage={false}\n              cropWidth={1200}\n              cropHeight={627}\n              onDeleteImage={() => {\n                setHeaderImage(\"\")\n              }}\n              onCropToBase64={setHeaderImage}\n              fileExtension={\"webp\"}\n            >\n              <Button\n                className=\"absolute top-1 right-1 size-8 rounded-full p-0\"\n                variant={\"secondary\"}\n              >\n                <Pencil className=\"size-4\" />\n              </Button>\n            </CropImageField>\n          </div>\n          <p className=\"mt-8\">\n            {t(\n              \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒã«R-18ç”»åƒã¯æ²è¼‰ã§ãã¾ã›ã‚“ã€‚\",\n              \"R-18 images cannot be used for profile or header images.\",\n            )}\n          </p>\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"nickname\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ \", \"Nickname\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"nickname\"\n            maxLength={32}\n            minLength={1}\n            value={userName}\n            onChange={(e) => setUserName(e.target.value)}\n            className=\"rounded-md border px-2 py-1\"\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"profile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"profile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={320}\n            value={profile}\n            onChange={(e) => setProfile(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"enProfile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"è‹±èªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"English Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"enProfile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={640}\n            value={enProfile}\n            onChange={(e) => setEnProfile(e.target.value)}\n          />\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"website\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"Webã‚µã‚¤ãƒˆ\", \"Website\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"website\"\n            className=\"rounded-md border px-2 py-1\"\n            value={website}\n            maxLength={1000}\n            onChange={(e) => setWebsite(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"instagram\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Instagram\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"instagram\"\n            className=\"rounded-md border px-2 py-1\"\n            value={instagram}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setInstagram(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"twitter\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"X(æ—§Twitter)\", \"X (formerly Twitter)\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"twitter\"\n            className=\"rounded-md border px-2 py-1\"\n            value={twitter}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setTwitter(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"github\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Github\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"github\"\n            className=\"rounded-md border px-2 py-1\"\n            value={github}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setGithub(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"mail\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\", \"Email Address\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"mail\"\n            className=\"rounded-md border px-2 py-1\"\n            value={mail}\n            placeholder={\"\"}\n            maxLength={320}\n            onChange={(e) => setMail(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"pickup\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ— â€»æœ€å¤§3ã¤\", \"Pickups (Max 3)\")}\n          </label>\n          <Suspense fallback={<AppLoadingPage />}>\n            <SelectCreatedWorksDialog\n              selectedWorks={selectedPickupWorks}\n              setSelectedWorks={setSelectedPickupWorks}\n              limit={3}\n            >\n              <div className=\"border-2 border-transparent p-1\">\n                <Button className=\"size-16\" size={\"icon\"} variant={\"secondary\"}>\n                  <PlusIcon />\n                </Button>\n              </div>\n            </SelectCreatedWorksDialog>\n          </Suspense>\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"sensitive-pickup\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\n              \"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ— â€»æœ€å¤§3ã¤\",\n              \"Sensitive Pickups (Max 3)\",\n            )}\n          </label>\n          <Suspense fallback={<AppLoadingPage />}>\n            <SelectCreatedSensitiveWorksDialog\n              selectedWorks={selectedPickupSensitiveWorks}\n              setSelectedWorks={setSelectedPickupSensitiveWorks}\n              limit={3}\n            >\n              <div className=\"border-2 border-transparent p-1\">\n                <Button className=\"size-16\" size={\"icon\"} variant={\"secondary\"}>\n                  <PlusIcon />\n                </Button>\n              </div>\n            </SelectCreatedSensitiveWorksDialog>\n          </Suspense>\n        </div>\n        <Separator />\n        <Button\n          disabled={isUpdating}\n          onClick={onSubmit}\n          className=\"ml-auto block w-24\"\n        >\n          {isUpdating ? (\n            <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n          ) : (\n            t(\"æ›´æ–°ã™ã‚‹\", \"Update\")\n          )}\n        </Button>\n        <Separator />\n        <a className=\"m-auto block\" href=\"settings/account/login\">\n          <Button className=\"m-auto block\" variant={\"secondary\"}>\n            {t(\"ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ã‚’å¤‰æ›´ã™ã‚‹\", \"Change Login Information\")}\n          </Button>\n        </a>\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      login\n      nanoid\n      name\n      iconUrl\n      headerImageUrl\n      featuredSensitiveWorks {\n        ...DialogWork\n      }\n      featuredWorks {\n        ...DialogWork\n      }\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n    }\n  }`,\n  [DialogWorkFragment],\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserProfileMutation = graphql(\n  `mutation UpdateUserProfile($input: UpdateUserProfileInput!) {\n    updateUserProfile(input: $input) {\n      id\n      name\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.profile/components/setting-profile-form.tsx"},"span":[9688,9922],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { CropImageField } from \"~/components/crop-image-field\"\nimport { Button } from \"~/components/ui/button\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport {\n  DialogWorkFragment,\n  SelectCreatedWorksDialog,\n} from \"~/routes/($lang).my._index/components/select-created-works-dialog\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon, Pencil, PlusIcon } from \"lucide-react\"\nimport { Suspense, useContext, useState, useEffect } from \"react\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { SelectCreatedSensitiveWorksDialog } from \"~/routes/($lang).my._index/components/select-created-sensitive-works-dialog\"\n\n/**\n * ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function SettingProfileForm () {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const { data: user, loading } = useQuery(userQuery, {\n    skip:\n      authContext.isLoading || authContext.isNotLoggedIn || !authContext.userId,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const userInfo = user?.user\n\n  // ã™ã¹ã¦ã®ãƒ•ãƒƒã‚¯ã‚’æ¡ä»¶ãªã—ã§å‘¼ã³å‡ºã™\n  const [userName, setUserName] = useState(\"\")\n  const [profile, setProfile] = useState(\"\")\n  const [enProfile, setEnProfile] = useState(\"\")\n  const [website, setWebsite] = useState(\"\")\n  const [instagram, setInstagram] = useState(\"\")\n  const [twitter, setTwitter] = useState(\"\")\n  const [github, setGithub] = useState(\"\")\n  const [mail, setMail] = useState(\"\")\n  const [profileImage, setProfileImage] = useState(\"\")\n  const [headerImage, setHeaderImage] = useState(\"\")\n  const [selectedPickupWorks, setSelectedPickupWorks] = useState<\n    Array<{\n      id: string\n      title: string\n      smallThumbnailImageURL: string\n    }>\n  >([])\n  const [selectedPickupSensitiveWorks, setSelectedPickupSensitiveWorks] =\n    useState<\n      Array<{\n        id: string\n        title: string\n        smallThumbnailImageURL: string\n      }>\n    >([])\n\n  const { data: token } = useQuery(viewerTokenQuery)\n\n  const [updateProfile, { loading: isUpdating }] = useMutation(\n    updateUserProfileMutation,\n  )\n\n  // userInfoãŒå–å¾—ã•ã‚ŒãŸã‚‰stateã‚’åˆæœŸåŒ–\n  useEffect(() => {\n    if (userInfo) {\n      setUserName(userInfo.name || authContext.displayName || \"\")\n      setProfile(userInfo.biography ?? \"\")\n      setEnProfile(userInfo.enBiography ?? \"\")\n      setWebsite(userInfo.siteURL ?? \"\")\n      setInstagram(userInfo.instagramAccountId ?? \"\")\n      setTwitter(userInfo.twitterAccountId ?? \"\")\n      setGithub(userInfo.githubAccountId ?? \"\")\n      setMail(userInfo.mailAddress ?? \"\")\n      setSelectedPickupWorks(\n        userInfo.featuredWorks?.map((work) => ({\n          id: work.id,\n          title: work.title,\n          smallThumbnailImageURL: work.smallThumbnailImageURL,\n        })) ?? [],\n      )\n      setSelectedPickupSensitiveWorks(\n        userInfo.featuredSensitiveWorks?.map((work) => ({\n          id: work.id,\n          title: work.title,\n          smallThumbnailImageURL: work.smallThumbnailImageURL,\n        })) ?? [],\n      )\n    }\n  }, [userInfo, authContext.displayName])\n\n  // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã‚’ãƒ•ãƒƒã‚¯å‘¼ã³å‡ºã—å¾Œã«ç¢ºèª\n  if (loading || authContext.isLoading || authContext.isNotLoggedIn) {\n    return <AppLoadingPage />\n  }\n\n  if (!userInfo) {\n    return <AppLoadingPage />\n  }\n\n  const onSubmit = async () => {\n    if (isUpdating || authContext.userId === null) {\n      return\n    }\n\n    const iconUrl = profileImage\n      ? await uploadPublicImage(profileImage, token?.viewer?.token)\n      : null\n\n    const headerUrl = headerImage\n      ? await uploadPublicImage(headerImage, token?.viewer?.token)\n      : null\n\n    await updateProfile({\n      variables: {\n        input: {\n          displayName: userName,\n          biography: profile,\n          enBiography: enProfile,\n          homeUrl: website,\n          instagramAccountId: instagram,\n          twitterAccountId: twitter,\n          githubAccountId: github,\n          mailAddress: mail,\n          ...(iconUrl && {\n            iconUrl: iconUrl,\n          }),\n          ...(headerUrl && {\n            headerImageUrl: headerUrl,\n          }),\n          featuredWorkIds: selectedPickupWorks.map((work) => work.id),\n          featuredSensitiveWorkIds: selectedPickupSensitiveWorks.map(\n            (work) => work.id,\n          ),\n        },\n      },\n    })\n\n    toast(t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚\", \"Profile updated.\"))\n  }\n\n  const profileImageSrc =\n    profileImage.length > 0 ? profileImage : userInfo?.iconUrl\n\n  const headerImageSrc =\n    headerImage.length > 0 ? headerImage : userInfo?.headerImageUrl\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        <div className=\"justify-between\">\n          <div className=\"relative\">\n            {headerImageSrc ? (\n              <img\n                className=\"h-auto max-h-96 w-full object-cover\"\n                src={headerImageSrc}\n                alt={t(\"ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒ\", \"Header Image\")}\n              />\n            ) : (\n              <div className=\"h-40 w-full bg-gray-700\" />\n            )}\n            <div className=\"absolute bottom-[-24px] left-2 size-32\">\n              {profileImageSrc ? (\n                <img\n                  className=\"absolute size-32 rounded-full border-2\"\n                  src={profileImageSrc}\n                  alt={t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ\", \"Profile Image\")}\n                />\n              ) : (\n                <div className=\"size-32 rounded-full border-2 bg-gray-700\" />\n              )}\n\n              <CropImageField\n                isHidePreviewImage={false}\n                cropWidth={240}\n                cropHeight={240}\n                onDeleteImage={() => {\n                  setProfileImage(\"\")\n                }}\n                onCropToBase64={(base64: string) => {\n                  try {\n                    setProfileImage(base64)\n                  } catch (error) {\n                    console.error(\"Error in onCropToBase64:\", error)\n                  }\n                }}\n                fileExtension={\"webp\"}\n              >\n                <Button\n                  className=\"absolute top-0 right-0 size-8 rounded-full p-0\"\n                  variant={\"secondary\"}\n                >\n                  <Pencil className=\"size-4\" />\n                </Button>\n              </CropImageField>\n            </div>\n\n            <CropImageField\n              isHidePreviewImage={false}\n              cropWidth={1200}\n              cropHeight={627}\n              onDeleteImage={() => {\n                setHeaderImage(\"\")\n              }}\n              onCropToBase64={setHeaderImage}\n              fileExtension={\"webp\"}\n            >\n              <Button\n                className=\"absolute top-1 right-1 size-8 rounded-full p-0\"\n                variant={\"secondary\"}\n              >\n                <Pencil className=\"size-4\" />\n              </Button>\n            </CropImageField>\n          </div>\n          <p className=\"mt-8\">\n            {t(\n              \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒã«R-18ç”»åƒã¯æ²è¼‰ã§ãã¾ã›ã‚“ã€‚\",\n              \"R-18 images cannot be used for profile or header images.\",\n            )}\n          </p>\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"nickname\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ \", \"Nickname\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"nickname\"\n            maxLength={32}\n            minLength={1}\n            value={userName}\n            onChange={(e) => setUserName(e.target.value)}\n            className=\"rounded-md border px-2 py-1\"\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"profile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"profile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={320}\n            value={profile}\n            onChange={(e) => setProfile(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"enProfile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"è‹±èªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"English Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"enProfile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={640}\n            value={enProfile}\n            onChange={(e) => setEnProfile(e.target.value)}\n          />\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"website\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"Webã‚µã‚¤ãƒˆ\", \"Website\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"website\"\n            className=\"rounded-md border px-2 py-1\"\n            value={website}\n            maxLength={1000}\n            onChange={(e) => setWebsite(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"instagram\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Instagram\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"instagram\"\n            className=\"rounded-md border px-2 py-1\"\n            value={instagram}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setInstagram(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"twitter\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"X(æ—§Twitter)\", \"X (formerly Twitter)\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"twitter\"\n            className=\"rounded-md border px-2 py-1\"\n            value={twitter}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setTwitter(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"github\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Github\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"github\"\n            className=\"rounded-md border px-2 py-1\"\n            value={github}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setGithub(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"mail\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\", \"Email Address\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"mail\"\n            className=\"rounded-md border px-2 py-1\"\n            value={mail}\n            placeholder={\"\"}\n            maxLength={320}\n            onChange={(e) => setMail(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"pickup\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ— â€»æœ€å¤§3ã¤\", \"Pickups (Max 3)\")}\n          </label>\n          <Suspense fallback={<AppLoadingPage />}>\n            <SelectCreatedWorksDialog\n              selectedWorks={selectedPickupWorks}\n              setSelectedWorks={setSelectedPickupWorks}\n              limit={3}\n            >\n              <div className=\"border-2 border-transparent p-1\">\n                <Button className=\"size-16\" size={\"icon\"} variant={\"secondary\"}>\n                  <PlusIcon />\n                </Button>\n              </div>\n            </SelectCreatedWorksDialog>\n          </Suspense>\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"sensitive-pickup\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\n              \"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ— â€»æœ€å¤§3ã¤\",\n              \"Sensitive Pickups (Max 3)\",\n            )}\n          </label>\n          <Suspense fallback={<AppLoadingPage />}>\n            <SelectCreatedSensitiveWorksDialog\n              selectedWorks={selectedPickupSensitiveWorks}\n              setSelectedWorks={setSelectedPickupSensitiveWorks}\n              limit={3}\n            >\n              <div className=\"border-2 border-transparent p-1\">\n                <Button className=\"size-16\" size={\"icon\"} variant={\"secondary\"}>\n                  <PlusIcon />\n                </Button>\n              </div>\n            </SelectCreatedSensitiveWorksDialog>\n          </Suspense>\n        </div>\n        <Separator />\n        <Button\n          disabled={isUpdating}\n          onClick={onSubmit}\n          className=\"ml-auto block w-24\"\n        >\n          {isUpdating ? (\n            <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n          ) : (\n            t(\"æ›´æ–°ã™ã‚‹\", \"Update\")\n          )}\n        </Button>\n        <Separator />\n        <a className=\"m-auto block\" href=\"settings/account/login\">\n          <Button className=\"m-auto block\" variant={\"secondary\"}>\n            {t(\"ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ã‚’å¤‰æ›´ã™ã‚‹\", \"Change Login Information\")}\n          </Button>\n        </a>\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      login\n      nanoid\n      name\n      iconUrl\n      headerImageUrl\n      featuredSensitiveWorks {\n        ...DialogWork\n      }\n      featuredWorks {\n        ...DialogWork\n      }\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n    }\n  }`,\n  [DialogWorkFragment],\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserProfileMutation = graphql(\n  `mutation UpdateUserProfile($input: UpdateUserProfileInput!) {\n    updateUserProfile(input: $input) {\n      id\n      name\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.profile/components/setting-profile-form.tsx"},"span":[10846,11109],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { CropImageField } from \"~/components/crop-image-field\"\nimport { Button } from \"~/components/ui/button\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport {\n  DialogWorkFragment,\n  SelectCreatedWorksDialog,\n} from \"~/routes/($lang).my._index/components/select-created-works-dialog\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon, Pencil, PlusIcon } from \"lucide-react\"\nimport { Suspense, useContext, useState, useEffect } from \"react\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { SelectCreatedSensitiveWorksDialog } from \"~/routes/($lang).my._index/components/select-created-sensitive-works-dialog\"\n\n/**\n * ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function SettingProfileForm () {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const { data: user, loading } = useQuery(userQuery, {\n    skip:\n      authContext.isLoading || authContext.isNotLoggedIn || !authContext.userId,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const userInfo = user?.user\n\n  // ã™ã¹ã¦ã®ãƒ•ãƒƒã‚¯ã‚’æ¡ä»¶ãªã—ã§å‘¼ã³å‡ºã™\n  const [userName, setUserName] = useState(\"\")\n  const [profile, setProfile] = useState(\"\")\n  const [enProfile, setEnProfile] = useState(\"\")\n  const [website, setWebsite] = useState(\"\")\n  const [instagram, setInstagram] = useState(\"\")\n  const [twitter, setTwitter] = useState(\"\")\n  const [github, setGithub] = useState(\"\")\n  const [mail, setMail] = useState(\"\")\n  const [profileImage, setProfileImage] = useState(\"\")\n  const [headerImage, setHeaderImage] = useState(\"\")\n  const [selectedPickupWorks, setSelectedPickupWorks] = useState<\n    Array<{\n      id: string\n      title: string\n      smallThumbnailImageURL: string\n    }>\n  >([])\n  const [selectedPickupSensitiveWorks, setSelectedPickupSensitiveWorks] =\n    useState<\n      Array<{\n        id: string\n        title: string\n        smallThumbnailImageURL: string\n      }>\n    >([])\n\n  const { data: token } = useQuery(viewerTokenQuery)\n\n  const [updateProfile, { loading: isUpdating }] = useMutation(\n    updateUserProfileMutation,\n  )\n\n  // userInfoãŒå–å¾—ã•ã‚ŒãŸã‚‰stateã‚’åˆæœŸåŒ–\n  useEffect(() => {\n    if (userInfo) {\n      setUserName(userInfo.name || authContext.displayName || \"\")\n      setProfile(userInfo.biography ?? \"\")\n      setEnProfile(userInfo.enBiography ?? \"\")\n      setWebsite(userInfo.siteURL ?? \"\")\n      setInstagram(userInfo.instagramAccountId ?? \"\")\n      setTwitter(userInfo.twitterAccountId ?? \"\")\n      setGithub(userInfo.githubAccountId ?? \"\")\n      setMail(userInfo.mailAddress ?? \"\")\n      setSelectedPickupWorks(\n        userInfo.featuredWorks?.map((work) => ({\n          id: work.id,\n          title: work.title,\n          smallThumbnailImageURL: work.smallThumbnailImageURL,\n        })) ?? [],\n      )\n      setSelectedPickupSensitiveWorks(\n        userInfo.featuredSensitiveWorks?.map((work) => ({\n          id: work.id,\n          title: work.title,\n          smallThumbnailImageURL: work.smallThumbnailImageURL,\n        })) ?? [],\n      )\n    }\n  }, [userInfo, authContext.displayName])\n\n  // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã‚’ãƒ•ãƒƒã‚¯å‘¼ã³å‡ºã—å¾Œã«ç¢ºèª\n  if (loading || authContext.isLoading || authContext.isNotLoggedIn) {\n    return <AppLoadingPage />\n  }\n\n  if (!userInfo) {\n    return <AppLoadingPage />\n  }\n\n  const onSubmit = async () => {\n    if (isUpdating || authContext.userId === null) {\n      return\n    }\n\n    const iconUrl = profileImage\n      ? await uploadPublicImage(profileImage, token?.viewer?.token)\n      : null\n\n    const headerUrl = headerImage\n      ? await uploadPublicImage(headerImage, token?.viewer?.token)\n      : null\n\n    await updateProfile({\n      variables: {\n        input: {\n          displayName: userName,\n          biography: profile,\n          enBiography: enProfile,\n          homeUrl: website,\n          instagramAccountId: instagram,\n          twitterAccountId: twitter,\n          githubAccountId: github,\n          mailAddress: mail,\n          ...(iconUrl && {\n            iconUrl: iconUrl,\n          }),\n          ...(headerUrl && {\n            headerImageUrl: headerUrl,\n          }),\n          featuredWorkIds: selectedPickupWorks.map((work) => work.id),\n          featuredSensitiveWorkIds: selectedPickupSensitiveWorks.map(\n            (work) => work.id,\n          ),\n        },\n      },\n    })\n\n    toast(t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚\", \"Profile updated.\"))\n  }\n\n  const profileImageSrc =\n    profileImage.length > 0 ? profileImage : userInfo?.iconUrl\n\n  const headerImageSrc =\n    headerImage.length > 0 ? headerImage : userInfo?.headerImageUrl\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        <div className=\"justify-between\">\n          <div className=\"relative\">\n            {headerImageSrc ? (\n              <img\n                className=\"h-auto max-h-96 w-full object-cover\"\n                src={headerImageSrc}\n                alt={t(\"ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒ\", \"Header Image\")}\n              />\n            ) : (\n              <div className=\"h-40 w-full bg-gray-700\" />\n            )}\n            <div className=\"absolute bottom-[-24px] left-2 size-32\">\n              {profileImageSrc ? (\n                <img\n                  className=\"absolute size-32 rounded-full border-2\"\n                  src={profileImageSrc}\n                  alt={t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ\", \"Profile Image\")}\n                />\n              ) : (\n                <div className=\"size-32 rounded-full border-2 bg-gray-700\" />\n              )}\n\n              <CropImageField\n                isHidePreviewImage={false}\n                cropWidth={240}\n                cropHeight={240}\n                onDeleteImage={() => {\n                  setProfileImage(\"\")\n                }}\n                onCropToBase64={(base64: string) => {\n                  try {\n                    setProfileImage(base64)\n                  } catch (error) {\n                    console.error(\"Error in onCropToBase64:\", error)\n                  }\n                }}\n                fileExtension={\"webp\"}\n              >\n                <Button\n                  className=\"absolute top-0 right-0 size-8 rounded-full p-0\"\n                  variant={\"secondary\"}\n                >\n                  <Pencil className=\"size-4\" />\n                </Button>\n              </CropImageField>\n            </div>\n\n            <CropImageField\n              isHidePreviewImage={false}\n              cropWidth={1200}\n              cropHeight={627}\n              onDeleteImage={() => {\n                setHeaderImage(\"\")\n              }}\n              onCropToBase64={setHeaderImage}\n              fileExtension={\"webp\"}\n            >\n              <Button\n                className=\"absolute top-1 right-1 size-8 rounded-full p-0\"\n                variant={\"secondary\"}\n              >\n                <Pencil className=\"size-4\" />\n              </Button>\n            </CropImageField>\n          </div>\n          <p className=\"mt-8\">\n            {t(\n              \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒã«R-18ç”»åƒã¯æ²è¼‰ã§ãã¾ã›ã‚“ã€‚\",\n              \"R-18 images cannot be used for profile or header images.\",\n            )}\n          </p>\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"nickname\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ \", \"Nickname\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"nickname\"\n            maxLength={32}\n            minLength={1}\n            value={userName}\n            onChange={(e) => setUserName(e.target.value)}\n            className=\"rounded-md border px-2 py-1\"\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"profile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"profile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={320}\n            value={profile}\n            onChange={(e) => setProfile(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"enProfile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"è‹±èªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"English Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"enProfile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={640}\n            value={enProfile}\n            onChange={(e) => setEnProfile(e.target.value)}\n          />\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"website\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"Webã‚µã‚¤ãƒˆ\", \"Website\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"website\"\n            className=\"rounded-md border px-2 py-1\"\n            value={website}\n            maxLength={1000}\n            onChange={(e) => setWebsite(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"instagram\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Instagram\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"instagram\"\n            className=\"rounded-md border px-2 py-1\"\n            value={instagram}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setInstagram(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"twitter\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"X(æ—§Twitter)\", \"X (formerly Twitter)\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"twitter\"\n            className=\"rounded-md border px-2 py-1\"\n            value={twitter}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setTwitter(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"github\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Github\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"github\"\n            className=\"rounded-md border px-2 py-1\"\n            value={github}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setGithub(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"mail\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\", \"Email Address\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"mail\"\n            className=\"rounded-md border px-2 py-1\"\n            value={mail}\n            placeholder={\"\"}\n            maxLength={320}\n            onChange={(e) => setMail(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"pickup\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ— â€»æœ€å¤§3ã¤\", \"Pickups (Max 3)\")}\n          </label>\n          <Suspense fallback={<AppLoadingPage />}>\n            <SelectCreatedWorksDialog\n              selectedWorks={selectedPickupWorks}\n              setSelectedWorks={setSelectedPickupWorks}\n              limit={3}\n            >\n              <div className=\"border-2 border-transparent p-1\">\n                <Button className=\"size-16\" size={\"icon\"} variant={\"secondary\"}>\n                  <PlusIcon />\n                </Button>\n              </div>\n            </SelectCreatedWorksDialog>\n          </Suspense>\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"sensitive-pickup\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\n              \"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ— â€»æœ€å¤§3ã¤\",\n              \"Sensitive Pickups (Max 3)\",\n            )}\n          </label>\n          <Suspense fallback={<AppLoadingPage />}>\n            <SelectCreatedSensitiveWorksDialog\n              selectedWorks={selectedPickupSensitiveWorks}\n              setSelectedWorks={setSelectedPickupSensitiveWorks}\n              limit={3}\n            >\n              <div className=\"border-2 border-transparent p-1\">\n                <Button className=\"size-16\" size={\"icon\"} variant={\"secondary\"}>\n                  <PlusIcon />\n                </Button>\n              </div>\n            </SelectCreatedSensitiveWorksDialog>\n          </Suspense>\n        </div>\n        <Separator />\n        <Button\n          disabled={isUpdating}\n          onClick={onSubmit}\n          className=\"ml-auto block w-24\"\n        >\n          {isUpdating ? (\n            <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n          ) : (\n            t(\"æ›´æ–°ã™ã‚‹\", \"Update\")\n          )}\n        </Button>\n        <Separator />\n        <a className=\"m-auto block\" href=\"settings/account/login\">\n          <Button className=\"m-auto block\" variant={\"secondary\"}>\n            {t(\"ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ã‚’å¤‰æ›´ã™ã‚‹\", \"Change Login Information\")}\n          </Button>\n        </a>\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      login\n      nanoid\n      name\n      iconUrl\n      headerImageUrl\n      featuredSensitiveWorks {\n        ...DialogWork\n      }\n      featuredWorks {\n        ...DialogWork\n      }\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n    }\n  }`,\n  [DialogWorkFragment],\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserProfileMutation = graphql(\n  `mutation UpdateUserProfile($input: UpdateUserProfileInput!) {\n    updateUserProfile(input: $input) {\n      id\n      name\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.profile/components/setting-profile-form.tsx"},"span":[11416,11676],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AutoResizeTextarea } from \"~/components/auto-resize-textarea\"\nimport { CropImageField } from \"~/components/crop-image-field\"\nimport { Button } from \"~/components/ui/button\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport {\n  DialogWorkFragment,\n  SelectCreatedWorksDialog,\n} from \"~/routes/($lang).my._index/components/select-created-works-dialog\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon, Pencil, PlusIcon } from \"lucide-react\"\nimport { Suspense, useContext, useState, useEffect } from \"react\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { uploadPublicImage } from \"~/utils/upload-public-image\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { SelectCreatedSensitiveWorksDialog } from \"~/routes/($lang).my._index/components/select-created-sensitive-works-dialog\"\n\n/**\n * ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function SettingProfileForm () {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const { data: user, loading } = useQuery(userQuery, {\n    skip:\n      authContext.isLoading || authContext.isNotLoggedIn || !authContext.userId,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const userInfo = user?.user\n\n  // ã™ã¹ã¦ã®ãƒ•ãƒƒã‚¯ã‚’æ¡ä»¶ãªã—ã§å‘¼ã³å‡ºã™\n  const [userName, setUserName] = useState(\"\")\n  const [profile, setProfile] = useState(\"\")\n  const [enProfile, setEnProfile] = useState(\"\")\n  const [website, setWebsite] = useState(\"\")\n  const [instagram, setInstagram] = useState(\"\")\n  const [twitter, setTwitter] = useState(\"\")\n  const [github, setGithub] = useState(\"\")\n  const [mail, setMail] = useState(\"\")\n  const [profileImage, setProfileImage] = useState(\"\")\n  const [headerImage, setHeaderImage] = useState(\"\")\n  const [selectedPickupWorks, setSelectedPickupWorks] = useState<\n    Array<{\n      id: string\n      title: string\n      smallThumbnailImageURL: string\n    }>\n  >([])\n  const [selectedPickupSensitiveWorks, setSelectedPickupSensitiveWorks] =\n    useState<\n      Array<{\n        id: string\n        title: string\n        smallThumbnailImageURL: string\n      }>\n    >([])\n\n  const { data: token } = useQuery(viewerTokenQuery)\n\n  const [updateProfile, { loading: isUpdating }] = useMutation(\n    updateUserProfileMutation,\n  )\n\n  // userInfoãŒå–å¾—ã•ã‚ŒãŸã‚‰stateã‚’åˆæœŸåŒ–\n  useEffect(() => {\n    if (userInfo) {\n      setUserName(userInfo.name || authContext.displayName || \"\")\n      setProfile(userInfo.biography ?? \"\")\n      setEnProfile(userInfo.enBiography ?? \"\")\n      setWebsite(userInfo.siteURL ?? \"\")\n      setInstagram(userInfo.instagramAccountId ?? \"\")\n      setTwitter(userInfo.twitterAccountId ?? \"\")\n      setGithub(userInfo.githubAccountId ?? \"\")\n      setMail(userInfo.mailAddress ?? \"\")\n      setSelectedPickupWorks(\n        userInfo.featuredWorks?.map((work) => ({\n          id: work.id,\n          title: work.title,\n          smallThumbnailImageURL: work.smallThumbnailImageURL,\n        })) ?? [],\n      )\n      setSelectedPickupSensitiveWorks(\n        userInfo.featuredSensitiveWorks?.map((work) => ({\n          id: work.id,\n          title: work.title,\n          smallThumbnailImageURL: work.smallThumbnailImageURL,\n        })) ?? [],\n      )\n    }\n  }, [userInfo, authContext.displayName])\n\n  // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã‚’ãƒ•ãƒƒã‚¯å‘¼ã³å‡ºã—å¾Œã«ç¢ºèª\n  if (loading || authContext.isLoading || authContext.isNotLoggedIn) {\n    return <AppLoadingPage />\n  }\n\n  if (!userInfo) {\n    return <AppLoadingPage />\n  }\n\n  const onSubmit = async () => {\n    if (isUpdating || authContext.userId === null) {\n      return\n    }\n\n    const iconUrl = profileImage\n      ? await uploadPublicImage(profileImage, token?.viewer?.token)\n      : null\n\n    const headerUrl = headerImage\n      ? await uploadPublicImage(headerImage, token?.viewer?.token)\n      : null\n\n    await updateProfile({\n      variables: {\n        input: {\n          displayName: userName,\n          biography: profile,\n          enBiography: enProfile,\n          homeUrl: website,\n          instagramAccountId: instagram,\n          twitterAccountId: twitter,\n          githubAccountId: github,\n          mailAddress: mail,\n          ...(iconUrl && {\n            iconUrl: iconUrl,\n          }),\n          ...(headerUrl && {\n            headerImageUrl: headerUrl,\n          }),\n          featuredWorkIds: selectedPickupWorks.map((work) => work.id),\n          featuredSensitiveWorkIds: selectedPickupSensitiveWorks.map(\n            (work) => work.id,\n          ),\n        },\n      },\n    })\n\n    toast(t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚\", \"Profile updated.\"))\n  }\n\n  const profileImageSrc =\n    profileImage.length > 0 ? profileImage : userInfo?.iconUrl\n\n  const headerImageSrc =\n    headerImage.length > 0 ? headerImage : userInfo?.headerImageUrl\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        <div className=\"justify-between\">\n          <div className=\"relative\">\n            {headerImageSrc ? (\n              <img\n                className=\"h-auto max-h-96 w-full object-cover\"\n                src={headerImageSrc}\n                alt={t(\"ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒ\", \"Header Image\")}\n              />\n            ) : (\n              <div className=\"h-40 w-full bg-gray-700\" />\n            )}\n            <div className=\"absolute bottom-[-24px] left-2 size-32\">\n              {profileImageSrc ? (\n                <img\n                  className=\"absolute size-32 rounded-full border-2\"\n                  src={profileImageSrc}\n                  alt={t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ\", \"Profile Image\")}\n                />\n              ) : (\n                <div className=\"size-32 rounded-full border-2 bg-gray-700\" />\n              )}\n\n              <CropImageField\n                isHidePreviewImage={false}\n                cropWidth={240}\n                cropHeight={240}\n                onDeleteImage={() => {\n                  setProfileImage(\"\")\n                }}\n                onCropToBase64={(base64: string) => {\n                  try {\n                    setProfileImage(base64)\n                  } catch (error) {\n                    console.error(\"Error in onCropToBase64:\", error)\n                  }\n                }}\n                fileExtension={\"webp\"}\n              >\n                <Button\n                  className=\"absolute top-0 right-0 size-8 rounded-full p-0\"\n                  variant={\"secondary\"}\n                >\n                  <Pencil className=\"size-4\" />\n                </Button>\n              </CropImageField>\n            </div>\n\n            <CropImageField\n              isHidePreviewImage={false}\n              cropWidth={1200}\n              cropHeight={627}\n              onDeleteImage={() => {\n                setHeaderImage(\"\")\n              }}\n              onCropToBase64={setHeaderImage}\n              fileExtension={\"webp\"}\n            >\n              <Button\n                className=\"absolute top-1 right-1 size-8 rounded-full p-0\"\n                variant={\"secondary\"}\n              >\n                <Pencil className=\"size-4\" />\n              </Button>\n            </CropImageField>\n          </div>\n          <p className=\"mt-8\">\n            {t(\n              \"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ç”»åƒã«R-18ç”»åƒã¯æ²è¼‰ã§ãã¾ã›ã‚“ã€‚\",\n              \"R-18 images cannot be used for profile or header images.\",\n            )}\n          </p>\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"nickname\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ \", \"Nickname\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"nickname\"\n            maxLength={32}\n            minLength={1}\n            value={userName}\n            onChange={(e) => setUserName(e.target.value)}\n            className=\"rounded-md border px-2 py-1\"\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"profile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"profile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={320}\n            value={profile}\n            onChange={(e) => setProfile(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"enProfile\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"è‹±èªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«\", \"English Profile\")}\n          </label>\n          <AutoResizeTextarea\n            id=\"enProfile\"\n            className=\"rounded-md border px-2 py-1\"\n            maxLength={640}\n            value={enProfile}\n            onChange={(e) => setEnProfile(e.target.value)}\n          />\n        </div>\n\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"website\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"Webã‚µã‚¤ãƒˆ\", \"Website\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"website\"\n            className=\"rounded-md border px-2 py-1\"\n            value={website}\n            maxLength={1000}\n            onChange={(e) => setWebsite(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"instagram\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Instagram\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"instagram\"\n            className=\"rounded-md border px-2 py-1\"\n            value={instagram}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setInstagram(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"twitter\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"X(æ—§Twitter)\", \"X (formerly Twitter)\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"twitter\"\n            className=\"rounded-md border px-2 py-1\"\n            value={twitter}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setTwitter(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"github\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {\"Github\"}\n          </label>\n          <input\n            type=\"text\"\n            id=\"github\"\n            className=\"rounded-md border px-2 py-1\"\n            value={github}\n            placeholder={\"@\"}\n            maxLength={255}\n            onChange={(e) => setGithub(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"mail\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹\", \"Email Address\")}\n          </label>\n          <input\n            type=\"text\"\n            id=\"mail\"\n            className=\"rounded-md border px-2 py-1\"\n            value={mail}\n            placeholder={\"\"}\n            maxLength={320}\n            onChange={(e) => setMail(e.target.value)}\n          />\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"pickup\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\"ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ— â€»æœ€å¤§3ã¤\", \"Pickups (Max 3)\")}\n          </label>\n          <Suspense fallback={<AppLoadingPage />}>\n            <SelectCreatedWorksDialog\n              selectedWorks={selectedPickupWorks}\n              setSelectedWorks={setSelectedPickupWorks}\n              limit={3}\n            >\n              <div className=\"border-2 border-transparent p-1\">\n                <Button className=\"size-16\" size={\"icon\"} variant={\"secondary\"}>\n                  <PlusIcon />\n                </Button>\n              </div>\n            </SelectCreatedWorksDialog>\n          </Suspense>\n        </div>\n        <div className=\"flex flex-col justify-between space-y-2\">\n          <label\n            htmlFor=\"sensitive-pickup\"\n            className=\"font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n          >\n            {t(\n              \"ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ— â€»æœ€å¤§3ã¤\",\n              \"Sensitive Pickups (Max 3)\",\n            )}\n          </label>\n          <Suspense fallback={<AppLoadingPage />}>\n            <SelectCreatedSensitiveWorksDialog\n              selectedWorks={selectedPickupSensitiveWorks}\n              setSelectedWorks={setSelectedPickupSensitiveWorks}\n              limit={3}\n            >\n              <div className=\"border-2 border-transparent p-1\">\n                <Button className=\"size-16\" size={\"icon\"} variant={\"secondary\"}>\n                  <PlusIcon />\n                </Button>\n              </div>\n            </SelectCreatedSensitiveWorksDialog>\n          </Suspense>\n        </div>\n        <Separator />\n        <Button\n          disabled={isUpdating}\n          onClick={onSubmit}\n          className=\"ml-auto block w-24\"\n        >\n          {isUpdating ? (\n            <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n          ) : (\n            t(\"æ›´æ–°ã™ã‚‹\", \"Update\")\n          )}\n        </Button>\n        <Separator />\n        <a className=\"m-auto block\" href=\"settings/account/login\">\n          <Button className=\"m-auto block\" variant={\"secondary\"}>\n            {t(\"ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ã‚’å¤‰æ›´ã™ã‚‹\", \"Change Login Information\")}\n          </Button>\n        </a>\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      login\n      nanoid\n      name\n      iconUrl\n      headerImageUrl\n      featuredSensitiveWorks {\n        ...DialogWork\n      }\n      featuredWorks {\n        ...DialogWork\n      }\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n    }\n  }`,\n  [DialogWorkFragment],\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserProfileMutation = graphql(\n  `mutation UpdateUserProfile($input: UpdateUserProfileInput!) {\n    updateUserProfile(input: $input) {\n      id\n      name\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.request/components/setting-request-form.tsx"},"span":[3631,3644],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Label } from \"~/components/ui/label\"\nimport { Switch } from \"~/components/ui/switch\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { toOmissionNumberText } from \"~/utils/to-omission-number-text\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport { Loader2Icon } from \"lucide-react\"\nimport React, { useEffect, useContext } from \"react\"\nimport { toast } from \"sonner\"\nimport { Link } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\nexport function SettingRequestForm () {\n  const t = useTranslation()\n  const authContext = useContext(AuthContext)\n\n  const { data: token, refetch: tokenRefetch } = useQuery(viewerTokenQuery)\n\n  const viewerUserToken = token?.viewer?.token\n\n  const { data: user } = useQuery(userQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const {\n    data: userSetting,\n    loading,\n    refetch: refetchSetting,\n  } = useQuery(userSettingQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n  })\n\n  const [updateUserSetting, { loading: isUpdatingUserSetting }] = useMutation(\n    updateUserSettingMutation,\n  )\n\n  const receivedLikesCount = user?.user?.receivedLikesCount ?? 0\n\n  const promptonUserId = user?.user?.promptonUser?.id ?? \"\"\n\n  const featurePromptonRequest =\n    userSetting?.userSetting?.featurePromptonRequest ?? false\n\n  const onSave = async () => {\n    await updateUserSetting({\n      variables: {\n        input: {\n          featurePromptonRequest: featureCheck,\n        },\n      },\n    })\n    toast(t(\"ä¿å­˜ã—ã¾ã—ãŸ\", \"Saved\"))\n  }\n\n  const [featureCheck, setFeatureCheck] = React.useState(featurePromptonRequest)\n\n  useEffect(() => {\n    setFeatureCheck(featurePromptonRequest)\n  }, [featurePromptonRequest])\n\n  return (\n    <div className=\"space-y-4\">\n      <p>\n        {t(\n          `ã‚µãƒãƒ¼ãƒˆã‚’å—ã‘ã‚‹ã«ã¯ç´¯è¨ˆã„ã„ã­æ•°ãŒ20å¿…è¦ã§ã™ï¼ˆç¾åœ¨ï¼šç¾åœ¨ ${toOmissionNumberText(\n            receivedLikesCount,\n          )}ï¼‰`,\n          `To receive support, you need a total of 20 likes (Currently: ${toOmissionNumberText(\n            receivedLikesCount,\n          )})`,\n        )}\n      </p>\n      {receivedLikesCount >= 20 ? (\n        <>\n          {!promptonUserId ? (\n            <div className=\"flex\">\n              <div className=\"flex w-full items-center justify-between\">\n                <Label>{t(\"å£åº§é€£æºã™ã‚‹\", \"Link Account\")}</Label>\n                <Link\n                  to={`https://prompton.io/integration?token=${viewerUserToken}`}\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                >\n                  <Button>{t(\"é€£æº\", \"Link\")}</Button>\n                </Link>\n              </div>\n            </div>\n          ) : (\n            <div className=\"flex\">\n              <div className=\"flex w-full items-center justify-between\">\n                <Label>{t(\"å£åº§é€£æºã™ã‚‹\", \"Link Account\")}</Label>\n                <Button disabled>{t(\"é€£æºæ¸ˆã¿\", \"Linked\")}</Button>\n              </div>\n            </div>\n          )}\n          {promptonUserId && (\n            <div className=\"flex\">\n              <div className=\"flex w-full items-center justify-between\">\n                <Label htmlFor=\"airplane-mode\">\n                  {t(\"ã‚µãƒãƒ¼ãƒˆã®é€ä¿¡ã‚’è¨±å¯ã™ã‚‹\", \"Allow Support Requests\")}\n                </Label>\n                {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n                <Switch\n                  onCheckedChange={setFeatureCheck}\n                  checked={featureCheck}\n                  id=\"airplane-mode\"\n                />\n              </div>\n            </div>\n          )}\n          <Button\n            disabled={isUpdatingUserSetting}\n            onClick={onSave}\n            className=\"ml-auto block w-24\"\n          >\n            {isUpdatingUserSetting ? (\n              <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n            ) : (\n              <p>{t(\"å¤‰æ›´ã‚’ä¿å­˜ã™ã‚‹\", \"Save Changes\")}</p>\n            )}\n          </Button>\n        </>\n      ) : (\n        <div className=\"flex\">\n          <div className=\"flex w-full justify-between\">\n            <Label>\n              {t(\"ã‚µãƒãƒ¼ãƒˆã®é€ä¿¡ã‚’è¨±å¯ã™ã‚‹\", \"Allow Support Requests\")}\n            </Label>\n            {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n            <Switch disabled id=\"airplane-mode\" />\n          </div>\n        </div>\n      )}\n      {promptonUserId && (\n        <Link to=\"https://prompton.io/viewer/requests\">\n          <Button variant={\"secondary\"} className=\"mt-8 w-full\">\n            {t(\"ãƒªã‚¯ã‚¨ã‚¹ãƒˆç®¡ç†ç”»é¢\", \"Request Management\")}\n          </Button>\n        </Link>\n      )}\n    </div>\n  )\n}\n\nconst userSettingQuery = graphql(\n  `query UserSetting {\n    userSetting {\n      id\n      userId\n      favoritedImageGenerationModelIds\n      preferenceRating\n      featurePromptonRequest\n      isNotifyComment\n    }\n  }`,\n)\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      createdBookmarksCount\n      login\n      nanoid\n      name\n      receivedLikesCount\n      receivedViewsCount\n      awardsCount\n      followCount\n      followersCount\n      worksCount\n      iconUrl\n      headerImageUrl\n      webFcmToken\n      isFollower\n      isFollowee\n      headerImageUrl\n      biography\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n      promptonUser {\n        id\n      }\n    }\n  }`,\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserSettingMutation = graphql(\n  `mutation UpdateUserSetting($input: UpdateUserSettingInput!) {\n    updateUserSetting(input: $input) {\n      preferenceRating\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.request/components/setting-request-form.tsx"},"span":[4549,4562],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Label } from \"~/components/ui/label\"\nimport { Switch } from \"~/components/ui/switch\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { toOmissionNumberText } from \"~/utils/to-omission-number-text\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport { Loader2Icon } from \"lucide-react\"\nimport React, { useEffect, useContext } from \"react\"\nimport { toast } from \"sonner\"\nimport { Link } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\nexport function SettingRequestForm () {\n  const t = useTranslation()\n  const authContext = useContext(AuthContext)\n\n  const { data: token, refetch: tokenRefetch } = useQuery(viewerTokenQuery)\n\n  const viewerUserToken = token?.viewer?.token\n\n  const { data: user } = useQuery(userQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const {\n    data: userSetting,\n    loading,\n    refetch: refetchSetting,\n  } = useQuery(userSettingQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n  })\n\n  const [updateUserSetting, { loading: isUpdatingUserSetting }] = useMutation(\n    updateUserSettingMutation,\n  )\n\n  const receivedLikesCount = user?.user?.receivedLikesCount ?? 0\n\n  const promptonUserId = user?.user?.promptonUser?.id ?? \"\"\n\n  const featurePromptonRequest =\n    userSetting?.userSetting?.featurePromptonRequest ?? false\n\n  const onSave = async () => {\n    await updateUserSetting({\n      variables: {\n        input: {\n          featurePromptonRequest: featureCheck,\n        },\n      },\n    })\n    toast(t(\"ä¿å­˜ã—ã¾ã—ãŸ\", \"Saved\"))\n  }\n\n  const [featureCheck, setFeatureCheck] = React.useState(featurePromptonRequest)\n\n  useEffect(() => {\n    setFeatureCheck(featurePromptonRequest)\n  }, [featurePromptonRequest])\n\n  return (\n    <div className=\"space-y-4\">\n      <p>\n        {t(\n          `ã‚µãƒãƒ¼ãƒˆã‚’å—ã‘ã‚‹ã«ã¯ç´¯è¨ˆã„ã„ã­æ•°ãŒ20å¿…è¦ã§ã™ï¼ˆç¾åœ¨ï¼šç¾åœ¨ ${toOmissionNumberText(\n            receivedLikesCount,\n          )}ï¼‰`,\n          `To receive support, you need a total of 20 likes (Currently: ${toOmissionNumberText(\n            receivedLikesCount,\n          )})`,\n        )}\n      </p>\n      {receivedLikesCount >= 20 ? (\n        <>\n          {!promptonUserId ? (\n            <div className=\"flex\">\n              <div className=\"flex w-full items-center justify-between\">\n                <Label>{t(\"å£åº§é€£æºã™ã‚‹\", \"Link Account\")}</Label>\n                <Link\n                  to={`https://prompton.io/integration?token=${viewerUserToken}`}\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                >\n                  <Button>{t(\"é€£æº\", \"Link\")}</Button>\n                </Link>\n              </div>\n            </div>\n          ) : (\n            <div className=\"flex\">\n              <div className=\"flex w-full items-center justify-between\">\n                <Label>{t(\"å£åº§é€£æºã™ã‚‹\", \"Link Account\")}</Label>\n                <Button disabled>{t(\"é€£æºæ¸ˆã¿\", \"Linked\")}</Button>\n              </div>\n            </div>\n          )}\n          {promptonUserId && (\n            <div className=\"flex\">\n              <div className=\"flex w-full items-center justify-between\">\n                <Label htmlFor=\"airplane-mode\">\n                  {t(\"ã‚µãƒãƒ¼ãƒˆã®é€ä¿¡ã‚’è¨±å¯ã™ã‚‹\", \"Allow Support Requests\")}\n                </Label>\n                {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n                <Switch\n                  onCheckedChange={setFeatureCheck}\n                  checked={featureCheck}\n                  id=\"airplane-mode\"\n                />\n              </div>\n            </div>\n          )}\n          <Button\n            disabled={isUpdatingUserSetting}\n            onClick={onSave}\n            className=\"ml-auto block w-24\"\n          >\n            {isUpdatingUserSetting ? (\n              <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n            ) : (\n              <p>{t(\"å¤‰æ›´ã‚’ä¿å­˜ã™ã‚‹\", \"Save Changes\")}</p>\n            )}\n          </Button>\n        </>\n      ) : (\n        <div className=\"flex\">\n          <div className=\"flex w-full justify-between\">\n            <Label>\n              {t(\"ã‚µãƒãƒ¼ãƒˆã®é€ä¿¡ã‚’è¨±å¯ã™ã‚‹\", \"Allow Support Requests\")}\n            </Label>\n            {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n            <Switch disabled id=\"airplane-mode\" />\n          </div>\n        </div>\n      )}\n      {promptonUserId && (\n        <Link to=\"https://prompton.io/viewer/requests\">\n          <Button variant={\"secondary\"} className=\"mt-8 w-full\">\n            {t(\"ãƒªã‚¯ã‚¨ã‚¹ãƒˆç®¡ç†ç”»é¢\", \"Request Management\")}\n          </Button>\n        </Link>\n      )}\n    </div>\n  )\n}\n\nconst userSettingQuery = graphql(\n  `query UserSetting {\n    userSetting {\n      id\n      userId\n      favoritedImageGenerationModelIds\n      preferenceRating\n      featurePromptonRequest\n      isNotifyComment\n    }\n  }`,\n)\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      createdBookmarksCount\n      login\n      nanoid\n      name\n      receivedLikesCount\n      receivedViewsCount\n      awardsCount\n      followCount\n      followersCount\n      worksCount\n      iconUrl\n      headerImageUrl\n      webFcmToken\n      isFollower\n      isFollowee\n      headerImageUrl\n      biography\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n      promptonUser {\n        id\n      }\n    }\n  }`,\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserSettingMutation = graphql(\n  `mutation UpdateUserSetting($input: UpdateUserSettingInput!) {\n    updateUserSetting(input: $input) {\n      preferenceRating\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable tokenRefetch is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"tokenRefetch"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.request/components/setting-request-form.tsx"},"span":[736,748],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Label } from \"~/components/ui/label\"\nimport { Switch } from \"~/components/ui/switch\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { toOmissionNumberText } from \"~/utils/to-omission-number-text\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport { Loader2Icon } from \"lucide-react\"\nimport React, { useEffect, useContext } from \"react\"\nimport { toast } from \"sonner\"\nimport { Link } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\nexport function SettingRequestForm () {\n  const t = useTranslation()\n  const authContext = useContext(AuthContext)\n\n  const { data: token, refetch: tokenRefetch } = useQuery(viewerTokenQuery)\n\n  const viewerUserToken = token?.viewer?.token\n\n  const { data: user } = useQuery(userQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const {\n    data: userSetting,\n    loading,\n    refetch: refetchSetting,\n  } = useQuery(userSettingQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n  })\n\n  const [updateUserSetting, { loading: isUpdatingUserSetting }] = useMutation(\n    updateUserSettingMutation,\n  )\n\n  const receivedLikesCount = user?.user?.receivedLikesCount ?? 0\n\n  const promptonUserId = user?.user?.promptonUser?.id ?? \"\"\n\n  const featurePromptonRequest =\n    userSetting?.userSetting?.featurePromptonRequest ?? false\n\n  const onSave = async () => {\n    await updateUserSetting({\n      variables: {\n        input: {\n          featurePromptonRequest: featureCheck,\n        },\n      },\n    })\n    toast(t(\"ä¿å­˜ã—ã¾ã—ãŸ\", \"Saved\"))\n  }\n\n  const [featureCheck, setFeatureCheck] = React.useState(featurePromptonRequest)\n\n  useEffect(() => {\n    setFeatureCheck(featurePromptonRequest)\n  }, [featurePromptonRequest])\n\n  return (\n    <div className=\"space-y-4\">\n      <p>\n        {t(\n          `ã‚µãƒãƒ¼ãƒˆã‚’å—ã‘ã‚‹ã«ã¯ç´¯è¨ˆã„ã„ã­æ•°ãŒ20å¿…è¦ã§ã™ï¼ˆç¾åœ¨ï¼šç¾åœ¨ ${toOmissionNumberText(\n            receivedLikesCount,\n          )}ï¼‰`,\n          `To receive support, you need a total of 20 likes (Currently: ${toOmissionNumberText(\n            receivedLikesCount,\n          )})`,\n        )}\n      </p>\n      {receivedLikesCount >= 20 ? (\n        <>\n          {!promptonUserId ? (\n            <div className=\"flex\">\n              <div className=\"flex w-full items-center justify-between\">\n                <Label>{t(\"å£åº§é€£æºã™ã‚‹\", \"Link Account\")}</Label>\n                <Link\n                  to={`https://prompton.io/integration?token=${viewerUserToken}`}\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                >\n                  <Button>{t(\"é€£æº\", \"Link\")}</Button>\n                </Link>\n              </div>\n            </div>\n          ) : (\n            <div className=\"flex\">\n              <div className=\"flex w-full items-center justify-between\">\n                <Label>{t(\"å£åº§é€£æºã™ã‚‹\", \"Link Account\")}</Label>\n                <Button disabled>{t(\"é€£æºæ¸ˆã¿\", \"Linked\")}</Button>\n              </div>\n            </div>\n          )}\n          {promptonUserId && (\n            <div className=\"flex\">\n              <div className=\"flex w-full items-center justify-between\">\n                <Label htmlFor=\"airplane-mode\">\n                  {t(\"ã‚µãƒãƒ¼ãƒˆã®é€ä¿¡ã‚’è¨±å¯ã™ã‚‹\", \"Allow Support Requests\")}\n                </Label>\n                {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n                <Switch\n                  onCheckedChange={setFeatureCheck}\n                  checked={featureCheck}\n                  id=\"airplane-mode\"\n                />\n              </div>\n            </div>\n          )}\n          <Button\n            disabled={isUpdatingUserSetting}\n            onClick={onSave}\n            className=\"ml-auto block w-24\"\n          >\n            {isUpdatingUserSetting ? (\n              <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n            ) : (\n              <p>{t(\"å¤‰æ›´ã‚’ä¿å­˜ã™ã‚‹\", \"Save Changes\")}</p>\n            )}\n          </Button>\n        </>\n      ) : (\n        <div className=\"flex\">\n          <div className=\"flex w-full justify-between\">\n            <Label>\n              {t(\"ã‚µãƒãƒ¼ãƒˆã®é€ä¿¡ã‚’è¨±å¯ã™ã‚‹\", \"Allow Support Requests\")}\n            </Label>\n            {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n            <Switch disabled id=\"airplane-mode\" />\n          </div>\n        </div>\n      )}\n      {promptonUserId && (\n        <Link to=\"https://prompton.io/viewer/requests\">\n          <Button variant={\"secondary\"} className=\"mt-8 w-full\">\n            {t(\"ãƒªã‚¯ã‚¨ã‚¹ãƒˆç®¡ç†ç”»é¢\", \"Request Management\")}\n          </Button>\n        </Link>\n      )}\n    </div>\n  )\n}\n\nconst userSettingQuery = graphql(\n  `query UserSetting {\n    userSetting {\n      id\n      userId\n      favoritedImageGenerationModelIds\n      preferenceRating\n      featurePromptonRequest\n      isNotifyComment\n    }\n  }`,\n)\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      createdBookmarksCount\n      login\n      nanoid\n      name\n      receivedLikesCount\n      receivedViewsCount\n      awardsCount\n      followCount\n      followersCount\n      worksCount\n      iconUrl\n      headerImageUrl\n      webFcmToken\n      isFollower\n      isFollowee\n      headerImageUrl\n      biography\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n      promptonUser {\n        id\n      }\n    }\n  }`,\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserSettingMutation = graphql(\n  `mutation UpdateUserSetting($input: UpdateUserSettingInput!) {\n    updateUserSetting(input: $input) {\n      preferenceRating\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable loading is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"loading"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.request/components/setting-request-form.tsx"},"span":[1089,1096],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Label } from \"~/components/ui/label\"\nimport { Switch } from \"~/components/ui/switch\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { toOmissionNumberText } from \"~/utils/to-omission-number-text\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport { Loader2Icon } from \"lucide-react\"\nimport React, { useEffect, useContext } from \"react\"\nimport { toast } from \"sonner\"\nimport { Link } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\nexport function SettingRequestForm () {\n  const t = useTranslation()\n  const authContext = useContext(AuthContext)\n\n  const { data: token, refetch: tokenRefetch } = useQuery(viewerTokenQuery)\n\n  const viewerUserToken = token?.viewer?.token\n\n  const { data: user } = useQuery(userQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const {\n    data: userSetting,\n    loading,\n    refetch: refetchSetting,\n  } = useQuery(userSettingQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n  })\n\n  const [updateUserSetting, { loading: isUpdatingUserSetting }] = useMutation(\n    updateUserSettingMutation,\n  )\n\n  const receivedLikesCount = user?.user?.receivedLikesCount ?? 0\n\n  const promptonUserId = user?.user?.promptonUser?.id ?? \"\"\n\n  const featurePromptonRequest =\n    userSetting?.userSetting?.featurePromptonRequest ?? false\n\n  const onSave = async () => {\n    await updateUserSetting({\n      variables: {\n        input: {\n          featurePromptonRequest: featureCheck,\n        },\n      },\n    })\n    toast(t(\"ä¿å­˜ã—ã¾ã—ãŸ\", \"Saved\"))\n  }\n\n  const [featureCheck, setFeatureCheck] = React.useState(featurePromptonRequest)\n\n  useEffect(() => {\n    setFeatureCheck(featurePromptonRequest)\n  }, [featurePromptonRequest])\n\n  return (\n    <div className=\"space-y-4\">\n      <p>\n        {t(\n          `ã‚µãƒãƒ¼ãƒˆã‚’å—ã‘ã‚‹ã«ã¯ç´¯è¨ˆã„ã„ã­æ•°ãŒ20å¿…è¦ã§ã™ï¼ˆç¾åœ¨ï¼šç¾åœ¨ ${toOmissionNumberText(\n            receivedLikesCount,\n          )}ï¼‰`,\n          `To receive support, you need a total of 20 likes (Currently: ${toOmissionNumberText(\n            receivedLikesCount,\n          )})`,\n        )}\n      </p>\n      {receivedLikesCount >= 20 ? (\n        <>\n          {!promptonUserId ? (\n            <div className=\"flex\">\n              <div className=\"flex w-full items-center justify-between\">\n                <Label>{t(\"å£åº§é€£æºã™ã‚‹\", \"Link Account\")}</Label>\n                <Link\n                  to={`https://prompton.io/integration?token=${viewerUserToken}`}\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                >\n                  <Button>{t(\"é€£æº\", \"Link\")}</Button>\n                </Link>\n              </div>\n            </div>\n          ) : (\n            <div className=\"flex\">\n              <div className=\"flex w-full items-center justify-between\">\n                <Label>{t(\"å£åº§é€£æºã™ã‚‹\", \"Link Account\")}</Label>\n                <Button disabled>{t(\"é€£æºæ¸ˆã¿\", \"Linked\")}</Button>\n              </div>\n            </div>\n          )}\n          {promptonUserId && (\n            <div className=\"flex\">\n              <div className=\"flex w-full items-center justify-between\">\n                <Label htmlFor=\"airplane-mode\">\n                  {t(\"ã‚µãƒãƒ¼ãƒˆã®é€ä¿¡ã‚’è¨±å¯ã™ã‚‹\", \"Allow Support Requests\")}\n                </Label>\n                {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n                <Switch\n                  onCheckedChange={setFeatureCheck}\n                  checked={featureCheck}\n                  id=\"airplane-mode\"\n                />\n              </div>\n            </div>\n          )}\n          <Button\n            disabled={isUpdatingUserSetting}\n            onClick={onSave}\n            className=\"ml-auto block w-24\"\n          >\n            {isUpdatingUserSetting ? (\n              <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n            ) : (\n              <p>{t(\"å¤‰æ›´ã‚’ä¿å­˜ã™ã‚‹\", \"Save Changes\")}</p>\n            )}\n          </Button>\n        </>\n      ) : (\n        <div className=\"flex\">\n          <div className=\"flex w-full justify-between\">\n            <Label>\n              {t(\"ã‚µãƒãƒ¼ãƒˆã®é€ä¿¡ã‚’è¨±å¯ã™ã‚‹\", \"Allow Support Requests\")}\n            </Label>\n            {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n            <Switch disabled id=\"airplane-mode\" />\n          </div>\n        </div>\n      )}\n      {promptonUserId && (\n        <Link to=\"https://prompton.io/viewer/requests\">\n          <Button variant={\"secondary\"} className=\"mt-8 w-full\">\n            {t(\"ãƒªã‚¯ã‚¨ã‚¹ãƒˆç®¡ç†ç”»é¢\", \"Request Management\")}\n          </Button>\n        </Link>\n      )}\n    </div>\n  )\n}\n\nconst userSettingQuery = graphql(\n  `query UserSetting {\n    userSetting {\n      id\n      userId\n      favoritedImageGenerationModelIds\n      preferenceRating\n      featurePromptonRequest\n      isNotifyComment\n    }\n  }`,\n)\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      createdBookmarksCount\n      login\n      nanoid\n      name\n      receivedLikesCount\n      receivedViewsCount\n      awardsCount\n      followCount\n      followersCount\n      worksCount\n      iconUrl\n      headerImageUrl\n      webFcmToken\n      isFollower\n      isFollowee\n      headerImageUrl\n      biography\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n      promptonUser {\n        id\n      }\n    }\n  }`,\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserSettingMutation = graphql(\n  `mutation UpdateUserSetting($input: UpdateUserSettingInput!) {\n    updateUserSetting(input: $input) {\n      preferenceRating\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable refetchSetting is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"refetchSetting"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.request/components/setting-request-form.tsx"},"span":[1111,1125],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { Label } from \"~/components/ui/label\"\nimport { Switch } from \"~/components/ui/switch\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { toOmissionNumberText } from \"~/utils/to-omission-number-text\"\nimport { useMutation, useQuery } from \"@apollo/client/index\"\nimport { Loader2Icon } from \"lucide-react\"\nimport React, { useEffect, useContext } from \"react\"\nimport { toast } from \"sonner\"\nimport { Link } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\nexport function SettingRequestForm () {\n  const t = useTranslation()\n  const authContext = useContext(AuthContext)\n\n  const { data: token, refetch: tokenRefetch } = useQuery(viewerTokenQuery)\n\n  const viewerUserToken = token?.viewer?.token\n\n  const { data: user } = useQuery(userQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n    variables: {\n      userId: authContext.userId?.toString() ?? \"\",\n    },\n    fetchPolicy: \"cache-first\",\n  })\n\n  const {\n    data: userSetting,\n    loading,\n    refetch: refetchSetting,\n  } = useQuery(userSettingQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n  })\n\n  const [updateUserSetting, { loading: isUpdatingUserSetting }] = useMutation(\n    updateUserSettingMutation,\n  )\n\n  const receivedLikesCount = user?.user?.receivedLikesCount ?? 0\n\n  const promptonUserId = user?.user?.promptonUser?.id ?? \"\"\n\n  const featurePromptonRequest =\n    userSetting?.userSetting?.featurePromptonRequest ?? false\n\n  const onSave = async () => {\n    await updateUserSetting({\n      variables: {\n        input: {\n          featurePromptonRequest: featureCheck,\n        },\n      },\n    })\n    toast(t(\"ä¿å­˜ã—ã¾ã—ãŸ\", \"Saved\"))\n  }\n\n  const [featureCheck, setFeatureCheck] = React.useState(featurePromptonRequest)\n\n  useEffect(() => {\n    setFeatureCheck(featurePromptonRequest)\n  }, [featurePromptonRequest])\n\n  return (\n    <div className=\"space-y-4\">\n      <p>\n        {t(\n          `ã‚µãƒãƒ¼ãƒˆã‚’å—ã‘ã‚‹ã«ã¯ç´¯è¨ˆã„ã„ã­æ•°ãŒ20å¿…è¦ã§ã™ï¼ˆç¾åœ¨ï¼šç¾åœ¨ ${toOmissionNumberText(\n            receivedLikesCount,\n          )}ï¼‰`,\n          `To receive support, you need a total of 20 likes (Currently: ${toOmissionNumberText(\n            receivedLikesCount,\n          )})`,\n        )}\n      </p>\n      {receivedLikesCount >= 20 ? (\n        <>\n          {!promptonUserId ? (\n            <div className=\"flex\">\n              <div className=\"flex w-full items-center justify-between\">\n                <Label>{t(\"å£åº§é€£æºã™ã‚‹\", \"Link Account\")}</Label>\n                <Link\n                  to={`https://prompton.io/integration?token=${viewerUserToken}`}\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                >\n                  <Button>{t(\"é€£æº\", \"Link\")}</Button>\n                </Link>\n              </div>\n            </div>\n          ) : (\n            <div className=\"flex\">\n              <div className=\"flex w-full items-center justify-between\">\n                <Label>{t(\"å£åº§é€£æºã™ã‚‹\", \"Link Account\")}</Label>\n                <Button disabled>{t(\"é€£æºæ¸ˆã¿\", \"Linked\")}</Button>\n              </div>\n            </div>\n          )}\n          {promptonUserId && (\n            <div className=\"flex\">\n              <div className=\"flex w-full items-center justify-between\">\n                <Label htmlFor=\"airplane-mode\">\n                  {t(\"ã‚µãƒãƒ¼ãƒˆã®é€ä¿¡ã‚’è¨±å¯ã™ã‚‹\", \"Allow Support Requests\")}\n                </Label>\n                {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n                <Switch\n                  onCheckedChange={setFeatureCheck}\n                  checked={featureCheck}\n                  id=\"airplane-mode\"\n                />\n              </div>\n            </div>\n          )}\n          <Button\n            disabled={isUpdatingUserSetting}\n            onClick={onSave}\n            className=\"ml-auto block w-24\"\n          >\n            {isUpdatingUserSetting ? (\n              <Loader2Icon className=\"m-auto size-4 animate-spin\" />\n            ) : (\n              <p>{t(\"å¤‰æ›´ã‚’ä¿å­˜ã™ã‚‹\", \"Save Changes\")}</p>\n            )}\n          </Button>\n        </>\n      ) : (\n        <div className=\"flex\">\n          <div className=\"flex w-full justify-between\">\n            <Label>\n              {t(\"ã‚µãƒãƒ¼ãƒˆã®é€ä¿¡ã‚’è¨±å¯ã™ã‚‹\", \"Allow Support Requests\")}\n            </Label>\n            {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n            <Switch disabled id=\"airplane-mode\" />\n          </div>\n        </div>\n      )}\n      {promptonUserId && (\n        <Link to=\"https://prompton.io/viewer/requests\">\n          <Button variant={\"secondary\"} className=\"mt-8 w-full\">\n            {t(\"ãƒªã‚¯ã‚¨ã‚¹ãƒˆç®¡ç†ç”»é¢\", \"Request Management\")}\n          </Button>\n        </Link>\n      )}\n    </div>\n  )\n}\n\nconst userSettingQuery = graphql(\n  `query UserSetting {\n    userSetting {\n      id\n      userId\n      favoritedImageGenerationModelIds\n      preferenceRating\n      featurePromptonRequest\n      isNotifyComment\n    }\n  }`,\n)\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      biography\n      createdBookmarksCount\n      login\n      nanoid\n      name\n      receivedLikesCount\n      receivedViewsCount\n      awardsCount\n      followCount\n      followersCount\n      worksCount\n      iconUrl\n      headerImageUrl\n      webFcmToken\n      isFollower\n      isFollowee\n      headerImageUrl\n      biography\n      enBiography\n      instagramAccountId\n      twitterAccountId\n      githubAccountId\n      siteURL\n      mailAddress\n      promptonUser {\n        id\n      }\n    }\n  }`,\n)\n\nconst viewerTokenQuery = graphql(\n  `query ViewerToken {\n    viewer {\n      id\n      token\n    }\n  }`,\n)\n\nconst updateUserSettingMutation = graphql(\n  `mutation UpdateUserSetting($input: UpdateUserSettingInput!) {\n    updateUserSetting(input: $input) {\n      preferenceRating\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/noUnusedVariables","severity":"warning","description":"This variable loading is unused.","message":[{"elements":[],"content":"This variable "},{"elements":["Emphasis"],"content":"loading"},{"elements":[],"content":" is unused."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Unused variables are often the result of an incomplete refactoring, typos, or other sources of bugs."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.restriction/components/setting-restriction-form.tsx"},"span":[1114,1121],"sourceCode":"import { AuthContext } from \"~/contexts/auth-context\"\nimport { useMutation, useQuery, useSuspenseQuery } from \"@apollo/client/index\"\nimport { useContext, useEffect } from \"react\"\nimport { Button } from \"~/components/ui/button\"\nimport React from \"react\"\nimport { Loader2Icon } from \"lucide-react\"\nimport { toast } from \"sonner\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { graphql } from \"gql.tada\"\nimport { Switch } from \"~/components/ui/switch\"\nimport { Label } from \"~/components/ui/label\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * è¡¨ç¤ºã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å¹´é½¢è¨­å®šåˆ¶é™ãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function SettingRestrictionForm () {\n  const [showR15InNormalMode, setShowR15InNormalMode] = React.useState(false)\n  const [showSensitiveModeToggle, setShowSensitiveModeToggle] =\n    React.useState(false)\n  const [showR18GInSensitiveMode, setShowR18GInSensitiveMode] =\n    React.useState(false)\n\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const { data: userSetting, loading } = useQuery(userSettingQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n  })\n\n  const [updateUserSetting, { loading: isUpdatingUserSetting }] = useMutation(\n    updateUserSettingMutation,\n  )\n\n  const { data: isBlurResp } = useSuspenseQuery(viewerIsBlurSensitiveImageQuery)\n\n  const isBlurDefault = isBlurResp?.viewer?.isBlurSensitiveImage\n\n  const [isBlur, setIsBlur] = React.useState(isBlurDefault)\n\n  const onSave = async () => {\n    // è¨­å®šã«åŸºã¥ã„ã¦preferenceRatingã‚’æ±ºå®š\n    let preferenceRating: IntrospectionEnum<\"PreferenceRating\"> = \"G\"\n\n    if (showSensitiveModeToggle) {\n      if (showR18GInSensitiveMode) {\n        preferenceRating = \"R18G\"\n      } else {\n        preferenceRating = \"R18\"\n      }\n    } else {\n      if (showR15InNormalMode) {\n        preferenceRating = \"R15\"\n      } else {\n        preferenceRating = \"G\"\n      }\n    }\n\n    await updateUserSetting({\n      variables: {\n        input: {\n          preferenceRating: preferenceRating,\n          isBlurSensitiveImage: isBlur,\n        },\n      },\n    })\n    toast(t(\"ä¿å­˜ã—ã¾ã—ãŸ\", \"Settings saved\"))\n  }\n\n  useEffect(() => {\n    const preferenceRating = userSetting?.userSetting?.preferenceRating\n\n    // preferenceRatingã«å¿œã˜ã¦åˆæœŸå€¤ã‚’è¨­å®š\n    if (preferenceRating) {\n      if (preferenceRating === \"G\") {\n        setShowR15InNormalMode(false)\n        setShowSensitiveModeToggle(false)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R15\") {\n        setShowR15InNormalMode(true)\n        setShowSensitiveModeToggle(false)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R18\") {\n        setShowR15InNormalMode(true) // R15ã¯å«ã¾ã‚Œã‚‹ã¨ä»®å®š\n        setShowSensitiveModeToggle(true)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R18G\") {\n        setShowR15InNormalMode(true) // R15ã¯å«ã¾ã‚Œã‚‹ã¨ä»®å®š\n        setShowSensitiveModeToggle(true)\n        setShowR18GInSensitiveMode(true)\n      }\n    } else {\n      setShowR15InNormalMode(false)\n      setShowSensitiveModeToggle(false)\n      setShowR18GInSensitiveMode(false)\n    }\n\n    setIsBlur(isBlurDefault)\n  }, [userSetting])\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex flex-col space-y-4\">\n        <div className=\"flex w-full items-center justify-between\">\n          <Label htmlFor=\"show-r15\">\n            {t(\n              \"(é€šå¸¸ãƒ¢ãƒ¼ãƒ‰æ™‚)R15ä½œå“ã‚’è¡¨ç¤ºã™ã‚‹\",\n              \"Display R15 content in normal mode\",\n            )}\n          </Label>\n          <Switch\n            onCheckedChange={setShowR15InNormalMode}\n            checked={showR15InNormalMode}\n            id=\"show-r15\"\n            disabled={showSensitiveModeToggle} // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰æ™‚ã¯ç„¡åŠ¹åŒ–\n          />\n        </div>\n        <div className=\"flex w-full items-center justify-between\">\n          <Label htmlFor=\"show-sensitive-toggle\">\n            {t(\n              \"R18åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ï¼ˆå¯¾è±¡å¹´é½¢å¤‰æ›´ãƒœã‚¿ãƒ³ï¼‰ã‚’è¡¨ç¤ºã™ã‚‹\",\n              \"Display sensitive mode toggle in the menu\",\n            )}\n          </Label>\n          <Switch\n            onCheckedChange={(checked) => {\n              setShowSensitiveModeToggle(checked)\n              if (checked) {\n                // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹ã«ã—ãŸã‚‰ã€R15ã®è¡¨ç¤ºè¨­å®šã‚’æœ‰åŠ¹åŒ–\n                setShowR15InNormalMode(true)\n              } else {\n                // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ã‚’ç„¡åŠ¹ã«ã—ãŸã‚‰ã€R18Gã®è¡¨ç¤ºè¨­å®šã‚’ç„¡åŠ¹åŒ–\n                setShowR18GInSensitiveMode(false)\n              }\n            }}\n            checked={showSensitiveModeToggle}\n            id=\"show-sensitive-toggle\"\n          />\n        </div>\n        <div className=\"flex w-full items-center justify-between\">\n          <Label htmlFor=\"show-r18g\">\n            {t(\n              \"(ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰æ™‚)R18Gä½œå“ã‚’è¡¨ç¤ºã™ã‚‹\",\n              \"Display R18G content in sensitive mode\",\n            )}\n          </Label>\n          <Switch\n            onCheckedChange={setShowR18GInSensitiveMode}\n            checked={showR18GInSensitiveMode}\n            id=\"show-r18g\"\n            disabled={!showSensitiveModeToggle} // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ãŒæœ‰åŠ¹ã§ãªã„ã¨ç„¡åŠ¹åŒ–\n          />\n        </div>\n      </div>\n      <Separator />\n      <Button\n        disabled={isUpdatingUserSetting}\n        onClick={onSave}\n        variant={\"secondary\"}\n      >\n        {isUpdatingUserSetting ? (\n          <Loader2Icon className=\"size-4 animate-spin\" />\n        ) : (\n          <span>{t(\"ä¿å­˜\", \"Save\")}</span>\n        )}\n      </Button>\n    </div>\n  )\n}\n\nconst userSettingQuery = graphql(`\n  query UserSetting {\n    userSetting {\n      id\n      userId\n      preferenceRating\n    }\n  }\n`)\n\nconst viewerIsBlurSensitiveImageQuery = graphql(`\n  query ViewerIsBlurSensitiveImage {\n    viewer {\n      id\n      isBlurSensitiveImage\n    }\n  }\n`)\n\nconst updateUserSettingMutation = graphql(`\n  mutation UpdateUserSetting($input: UpdateUserSettingInput!) {\n    updateUserSetting(input: $input) {\n      preferenceRating\n    }\n  }\n`)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.restriction/components/setting-restriction-form.tsx"},"span":[3704,3938],"sourceCode":"import { AuthContext } from \"~/contexts/auth-context\"\nimport { useMutation, useQuery, useSuspenseQuery } from \"@apollo/client/index\"\nimport { useContext, useEffect } from \"react\"\nimport { Button } from \"~/components/ui/button\"\nimport React from \"react\"\nimport { Loader2Icon } from \"lucide-react\"\nimport { toast } from \"sonner\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { graphql } from \"gql.tada\"\nimport { Switch } from \"~/components/ui/switch\"\nimport { Label } from \"~/components/ui/label\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * è¡¨ç¤ºã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å¹´é½¢è¨­å®šåˆ¶é™ãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function SettingRestrictionForm () {\n  const [showR15InNormalMode, setShowR15InNormalMode] = React.useState(false)\n  const [showSensitiveModeToggle, setShowSensitiveModeToggle] =\n    React.useState(false)\n  const [showR18GInSensitiveMode, setShowR18GInSensitiveMode] =\n    React.useState(false)\n\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const { data: userSetting, loading } = useQuery(userSettingQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n  })\n\n  const [updateUserSetting, { loading: isUpdatingUserSetting }] = useMutation(\n    updateUserSettingMutation,\n  )\n\n  const { data: isBlurResp } = useSuspenseQuery(viewerIsBlurSensitiveImageQuery)\n\n  const isBlurDefault = isBlurResp?.viewer?.isBlurSensitiveImage\n\n  const [isBlur, setIsBlur] = React.useState(isBlurDefault)\n\n  const onSave = async () => {\n    // è¨­å®šã«åŸºã¥ã„ã¦preferenceRatingã‚’æ±ºå®š\n    let preferenceRating: IntrospectionEnum<\"PreferenceRating\"> = \"G\"\n\n    if (showSensitiveModeToggle) {\n      if (showR18GInSensitiveMode) {\n        preferenceRating = \"R18G\"\n      } else {\n        preferenceRating = \"R18\"\n      }\n    } else {\n      if (showR15InNormalMode) {\n        preferenceRating = \"R15\"\n      } else {\n        preferenceRating = \"G\"\n      }\n    }\n\n    await updateUserSetting({\n      variables: {\n        input: {\n          preferenceRating: preferenceRating,\n          isBlurSensitiveImage: isBlur,\n        },\n      },\n    })\n    toast(t(\"ä¿å­˜ã—ã¾ã—ãŸ\", \"Settings saved\"))\n  }\n\n  useEffect(() => {\n    const preferenceRating = userSetting?.userSetting?.preferenceRating\n\n    // preferenceRatingã«å¿œã˜ã¦åˆæœŸå€¤ã‚’è¨­å®š\n    if (preferenceRating) {\n      if (preferenceRating === \"G\") {\n        setShowR15InNormalMode(false)\n        setShowSensitiveModeToggle(false)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R15\") {\n        setShowR15InNormalMode(true)\n        setShowSensitiveModeToggle(false)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R18\") {\n        setShowR15InNormalMode(true) // R15ã¯å«ã¾ã‚Œã‚‹ã¨ä»®å®š\n        setShowSensitiveModeToggle(true)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R18G\") {\n        setShowR15InNormalMode(true) // R15ã¯å«ã¾ã‚Œã‚‹ã¨ä»®å®š\n        setShowSensitiveModeToggle(true)\n        setShowR18GInSensitiveMode(true)\n      }\n    } else {\n      setShowR15InNormalMode(false)\n      setShowSensitiveModeToggle(false)\n      setShowR18GInSensitiveMode(false)\n    }\n\n    setIsBlur(isBlurDefault)\n  }, [userSetting])\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex flex-col space-y-4\">\n        <div className=\"flex w-full items-center justify-between\">\n          <Label htmlFor=\"show-r15\">\n            {t(\n              \"(é€šå¸¸ãƒ¢ãƒ¼ãƒ‰æ™‚)R15ä½œå“ã‚’è¡¨ç¤ºã™ã‚‹\",\n              \"Display R15 content in normal mode\",\n            )}\n          </Label>\n          <Switch\n            onCheckedChange={setShowR15InNormalMode}\n            checked={showR15InNormalMode}\n            id=\"show-r15\"\n            disabled={showSensitiveModeToggle} // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰æ™‚ã¯ç„¡åŠ¹åŒ–\n          />\n        </div>\n        <div className=\"flex w-full items-center justify-between\">\n          <Label htmlFor=\"show-sensitive-toggle\">\n            {t(\n              \"R18åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ï¼ˆå¯¾è±¡å¹´é½¢å¤‰æ›´ãƒœã‚¿ãƒ³ï¼‰ã‚’è¡¨ç¤ºã™ã‚‹\",\n              \"Display sensitive mode toggle in the menu\",\n            )}\n          </Label>\n          <Switch\n            onCheckedChange={(checked) => {\n              setShowSensitiveModeToggle(checked)\n              if (checked) {\n                // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹ã«ã—ãŸã‚‰ã€R15ã®è¡¨ç¤ºè¨­å®šã‚’æœ‰åŠ¹åŒ–\n                setShowR15InNormalMode(true)\n              } else {\n                // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ã‚’ç„¡åŠ¹ã«ã—ãŸã‚‰ã€R18Gã®è¡¨ç¤ºè¨­å®šã‚’ç„¡åŠ¹åŒ–\n                setShowR18GInSensitiveMode(false)\n              }\n            }}\n            checked={showSensitiveModeToggle}\n            id=\"show-sensitive-toggle\"\n          />\n        </div>\n        <div className=\"flex w-full items-center justify-between\">\n          <Label htmlFor=\"show-r18g\">\n            {t(\n              \"(ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰æ™‚)R18Gä½œå“ã‚’è¡¨ç¤ºã™ã‚‹\",\n              \"Display R18G content in sensitive mode\",\n            )}\n          </Label>\n          <Switch\n            onCheckedChange={setShowR18GInSensitiveMode}\n            checked={showR18GInSensitiveMode}\n            id=\"show-r18g\"\n            disabled={!showSensitiveModeToggle} // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ãŒæœ‰åŠ¹ã§ãªã„ã¨ç„¡åŠ¹åŒ–\n          />\n        </div>\n      </div>\n      <Separator />\n      <Button\n        disabled={isUpdatingUserSetting}\n        onClick={onSave}\n        variant={\"secondary\"}\n      >\n        {isUpdatingUserSetting ? (\n          <Loader2Icon className=\"size-4 animate-spin\" />\n        ) : (\n          <span>{t(\"ä¿å­˜\", \"Save\")}</span>\n        )}\n      </Button>\n    </div>\n  )\n}\n\nconst userSettingQuery = graphql(`\n  query UserSetting {\n    userSetting {\n      id\n      userId\n      preferenceRating\n    }\n  }\n`)\n\nconst viewerIsBlurSensitiveImageQuery = graphql(`\n  query ViewerIsBlurSensitiveImage {\n    viewer {\n      id\n      isBlurSensitiveImage\n    }\n  }\n`)\n\nconst updateUserSettingMutation = graphql(`\n  mutation UpdateUserSetting($input: UpdateUserSettingInput!) {\n    updateUserSetting(input: $input) {\n      preferenceRating\n    }\n  }\n`)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.restriction/components/setting-restriction-form.tsx"},"span":[4280,4860],"sourceCode":"import { AuthContext } from \"~/contexts/auth-context\"\nimport { useMutation, useQuery, useSuspenseQuery } from \"@apollo/client/index\"\nimport { useContext, useEffect } from \"react\"\nimport { Button } from \"~/components/ui/button\"\nimport React from \"react\"\nimport { Loader2Icon } from \"lucide-react\"\nimport { toast } from \"sonner\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { graphql } from \"gql.tada\"\nimport { Switch } from \"~/components/ui/switch\"\nimport { Label } from \"~/components/ui/label\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * è¡¨ç¤ºã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å¹´é½¢è¨­å®šåˆ¶é™ãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function SettingRestrictionForm () {\n  const [showR15InNormalMode, setShowR15InNormalMode] = React.useState(false)\n  const [showSensitiveModeToggle, setShowSensitiveModeToggle] =\n    React.useState(false)\n  const [showR18GInSensitiveMode, setShowR18GInSensitiveMode] =\n    React.useState(false)\n\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const { data: userSetting, loading } = useQuery(userSettingQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n  })\n\n  const [updateUserSetting, { loading: isUpdatingUserSetting }] = useMutation(\n    updateUserSettingMutation,\n  )\n\n  const { data: isBlurResp } = useSuspenseQuery(viewerIsBlurSensitiveImageQuery)\n\n  const isBlurDefault = isBlurResp?.viewer?.isBlurSensitiveImage\n\n  const [isBlur, setIsBlur] = React.useState(isBlurDefault)\n\n  const onSave = async () => {\n    // è¨­å®šã«åŸºã¥ã„ã¦preferenceRatingã‚’æ±ºå®š\n    let preferenceRating: IntrospectionEnum<\"PreferenceRating\"> = \"G\"\n\n    if (showSensitiveModeToggle) {\n      if (showR18GInSensitiveMode) {\n        preferenceRating = \"R18G\"\n      } else {\n        preferenceRating = \"R18\"\n      }\n    } else {\n      if (showR15InNormalMode) {\n        preferenceRating = \"R15\"\n      } else {\n        preferenceRating = \"G\"\n      }\n    }\n\n    await updateUserSetting({\n      variables: {\n        input: {\n          preferenceRating: preferenceRating,\n          isBlurSensitiveImage: isBlur,\n        },\n      },\n    })\n    toast(t(\"ä¿å­˜ã—ã¾ã—ãŸ\", \"Settings saved\"))\n  }\n\n  useEffect(() => {\n    const preferenceRating = userSetting?.userSetting?.preferenceRating\n\n    // preferenceRatingã«å¿œã˜ã¦åˆæœŸå€¤ã‚’è¨­å®š\n    if (preferenceRating) {\n      if (preferenceRating === \"G\") {\n        setShowR15InNormalMode(false)\n        setShowSensitiveModeToggle(false)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R15\") {\n        setShowR15InNormalMode(true)\n        setShowSensitiveModeToggle(false)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R18\") {\n        setShowR15InNormalMode(true) // R15ã¯å«ã¾ã‚Œã‚‹ã¨ä»®å®š\n        setShowSensitiveModeToggle(true)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R18G\") {\n        setShowR15InNormalMode(true) // R15ã¯å«ã¾ã‚Œã‚‹ã¨ä»®å®š\n        setShowSensitiveModeToggle(true)\n        setShowR18GInSensitiveMode(true)\n      }\n    } else {\n      setShowR15InNormalMode(false)\n      setShowSensitiveModeToggle(false)\n      setShowR18GInSensitiveMode(false)\n    }\n\n    setIsBlur(isBlurDefault)\n  }, [userSetting])\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex flex-col space-y-4\">\n        <div className=\"flex w-full items-center justify-between\">\n          <Label htmlFor=\"show-r15\">\n            {t(\n              \"(é€šå¸¸ãƒ¢ãƒ¼ãƒ‰æ™‚)R15ä½œå“ã‚’è¡¨ç¤ºã™ã‚‹\",\n              \"Display R15 content in normal mode\",\n            )}\n          </Label>\n          <Switch\n            onCheckedChange={setShowR15InNormalMode}\n            checked={showR15InNormalMode}\n            id=\"show-r15\"\n            disabled={showSensitiveModeToggle} // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰æ™‚ã¯ç„¡åŠ¹åŒ–\n          />\n        </div>\n        <div className=\"flex w-full items-center justify-between\">\n          <Label htmlFor=\"show-sensitive-toggle\">\n            {t(\n              \"R18åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ï¼ˆå¯¾è±¡å¹´é½¢å¤‰æ›´ãƒœã‚¿ãƒ³ï¼‰ã‚’è¡¨ç¤ºã™ã‚‹\",\n              \"Display sensitive mode toggle in the menu\",\n            )}\n          </Label>\n          <Switch\n            onCheckedChange={(checked) => {\n              setShowSensitiveModeToggle(checked)\n              if (checked) {\n                // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹ã«ã—ãŸã‚‰ã€R15ã®è¡¨ç¤ºè¨­å®šã‚’æœ‰åŠ¹åŒ–\n                setShowR15InNormalMode(true)\n              } else {\n                // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ã‚’ç„¡åŠ¹ã«ã—ãŸã‚‰ã€R18Gã®è¡¨ç¤ºè¨­å®šã‚’ç„¡åŠ¹åŒ–\n                setShowR18GInSensitiveMode(false)\n              }\n            }}\n            checked={showSensitiveModeToggle}\n            id=\"show-sensitive-toggle\"\n          />\n        </div>\n        <div className=\"flex w-full items-center justify-between\">\n          <Label htmlFor=\"show-r18g\">\n            {t(\n              \"(ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰æ™‚)R18Gä½œå“ã‚’è¡¨ç¤ºã™ã‚‹\",\n              \"Display R18G content in sensitive mode\",\n            )}\n          </Label>\n          <Switch\n            onCheckedChange={setShowR18GInSensitiveMode}\n            checked={showR18GInSensitiveMode}\n            id=\"show-r18g\"\n            disabled={!showSensitiveModeToggle} // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ãŒæœ‰åŠ¹ã§ãªã„ã¨ç„¡åŠ¹åŒ–\n          />\n        </div>\n      </div>\n      <Separator />\n      <Button\n        disabled={isUpdatingUserSetting}\n        onClick={onSave}\n        variant={\"secondary\"}\n      >\n        {isUpdatingUserSetting ? (\n          <Loader2Icon className=\"size-4 animate-spin\" />\n        ) : (\n          <span>{t(\"ä¿å­˜\", \"Save\")}</span>\n        )}\n      </Button>\n    </div>\n  )\n}\n\nconst userSettingQuery = graphql(`\n  query UserSetting {\n    userSetting {\n      id\n      userId\n      preferenceRating\n    }\n  }\n`)\n\nconst viewerIsBlurSensitiveImageQuery = graphql(`\n  query ViewerIsBlurSensitiveImage {\n    viewer {\n      id\n      isBlurSensitiveImage\n    }\n  }\n`)\n\nconst updateUserSettingMutation = graphql(`\n  mutation UpdateUserSetting($input: UpdateUserSettingInput!) {\n    updateUserSetting(input: $input) {\n      preferenceRating\n    }\n  }\n`)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.restriction/components/setting-restriction-form.tsx"},"span":[5172,5431],"sourceCode":"import { AuthContext } from \"~/contexts/auth-context\"\nimport { useMutation, useQuery, useSuspenseQuery } from \"@apollo/client/index\"\nimport { useContext, useEffect } from \"react\"\nimport { Button } from \"~/components/ui/button\"\nimport React from \"react\"\nimport { Loader2Icon } from \"lucide-react\"\nimport { toast } from \"sonner\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { graphql } from \"gql.tada\"\nimport { Switch } from \"~/components/ui/switch\"\nimport { Label } from \"~/components/ui/label\"\nimport { Separator } from \"~/components/ui/separator\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n/**\n * è¡¨ç¤ºã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å¹´é½¢è¨­å®šåˆ¶é™ãƒ•ã‚©ãƒ¼ãƒ \n */\nexport function SettingRestrictionForm () {\n  const [showR15InNormalMode, setShowR15InNormalMode] = React.useState(false)\n  const [showSensitiveModeToggle, setShowSensitiveModeToggle] =\n    React.useState(false)\n  const [showR18GInSensitiveMode, setShowR18GInSensitiveMode] =\n    React.useState(false)\n\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const { data: userSetting, loading } = useQuery(userSettingQuery, {\n    skip: authContext.isLoading || authContext.isNotLoggedIn,\n  })\n\n  const [updateUserSetting, { loading: isUpdatingUserSetting }] = useMutation(\n    updateUserSettingMutation,\n  )\n\n  const { data: isBlurResp } = useSuspenseQuery(viewerIsBlurSensitiveImageQuery)\n\n  const isBlurDefault = isBlurResp?.viewer?.isBlurSensitiveImage\n\n  const [isBlur, setIsBlur] = React.useState(isBlurDefault)\n\n  const onSave = async () => {\n    // è¨­å®šã«åŸºã¥ã„ã¦preferenceRatingã‚’æ±ºå®š\n    let preferenceRating: IntrospectionEnum<\"PreferenceRating\"> = \"G\"\n\n    if (showSensitiveModeToggle) {\n      if (showR18GInSensitiveMode) {\n        preferenceRating = \"R18G\"\n      } else {\n        preferenceRating = \"R18\"\n      }\n    } else {\n      if (showR15InNormalMode) {\n        preferenceRating = \"R15\"\n      } else {\n        preferenceRating = \"G\"\n      }\n    }\n\n    await updateUserSetting({\n      variables: {\n        input: {\n          preferenceRating: preferenceRating,\n          isBlurSensitiveImage: isBlur,\n        },\n      },\n    })\n    toast(t(\"ä¿å­˜ã—ã¾ã—ãŸ\", \"Settings saved\"))\n  }\n\n  useEffect(() => {\n    const preferenceRating = userSetting?.userSetting?.preferenceRating\n\n    // preferenceRatingã«å¿œã˜ã¦åˆæœŸå€¤ã‚’è¨­å®š\n    if (preferenceRating) {\n      if (preferenceRating === \"G\") {\n        setShowR15InNormalMode(false)\n        setShowSensitiveModeToggle(false)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R15\") {\n        setShowR15InNormalMode(true)\n        setShowSensitiveModeToggle(false)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R18\") {\n        setShowR15InNormalMode(true) // R15ã¯å«ã¾ã‚Œã‚‹ã¨ä»®å®š\n        setShowSensitiveModeToggle(true)\n        setShowR18GInSensitiveMode(false)\n      } else if (preferenceRating === \"R18G\") {\n        setShowR15InNormalMode(true) // R15ã¯å«ã¾ã‚Œã‚‹ã¨ä»®å®š\n        setShowSensitiveModeToggle(true)\n        setShowR18GInSensitiveMode(true)\n      }\n    } else {\n      setShowR15InNormalMode(false)\n      setShowSensitiveModeToggle(false)\n      setShowR18GInSensitiveMode(false)\n    }\n\n    setIsBlur(isBlurDefault)\n  }, [userSetting])\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex flex-col space-y-4\">\n        <div className=\"flex w-full items-center justify-between\">\n          <Label htmlFor=\"show-r15\">\n            {t(\n              \"(é€šå¸¸ãƒ¢ãƒ¼ãƒ‰æ™‚)R15ä½œå“ã‚’è¡¨ç¤ºã™ã‚‹\",\n              \"Display R15 content in normal mode\",\n            )}\n          </Label>\n          <Switch\n            onCheckedChange={setShowR15InNormalMode}\n            checked={showR15InNormalMode}\n            id=\"show-r15\"\n            disabled={showSensitiveModeToggle} // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰æ™‚ã¯ç„¡åŠ¹åŒ–\n          />\n        </div>\n        <div className=\"flex w-full items-center justify-between\">\n          <Label htmlFor=\"show-sensitive-toggle\">\n            {t(\n              \"R18åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ï¼ˆå¯¾è±¡å¹´é½¢å¤‰æ›´ãƒœã‚¿ãƒ³ï¼‰ã‚’è¡¨ç¤ºã™ã‚‹\",\n              \"Display sensitive mode toggle in the menu\",\n            )}\n          </Label>\n          <Switch\n            onCheckedChange={(checked) => {\n              setShowSensitiveModeToggle(checked)\n              if (checked) {\n                // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹ã«ã—ãŸã‚‰ã€R15ã®è¡¨ç¤ºè¨­å®šã‚’æœ‰åŠ¹åŒ–\n                setShowR15InNormalMode(true)\n              } else {\n                // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ã‚’ç„¡åŠ¹ã«ã—ãŸã‚‰ã€R18Gã®è¡¨ç¤ºè¨­å®šã‚’ç„¡åŠ¹åŒ–\n                setShowR18GInSensitiveMode(false)\n              }\n            }}\n            checked={showSensitiveModeToggle}\n            id=\"show-sensitive-toggle\"\n          />\n        </div>\n        <div className=\"flex w-full items-center justify-between\">\n          <Label htmlFor=\"show-r18g\">\n            {t(\n              \"(ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰æ™‚)R18Gä½œå“ã‚’è¡¨ç¤ºã™ã‚‹\",\n              \"Display R18G content in sensitive mode\",\n            )}\n          </Label>\n          <Switch\n            onCheckedChange={setShowR18GInSensitiveMode}\n            checked={showR18GInSensitiveMode}\n            id=\"show-r18g\"\n            disabled={!showSensitiveModeToggle} // ã‚»ãƒ³ã‚·ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ãŒæœ‰åŠ¹ã§ãªã„ã¨ç„¡åŠ¹åŒ–\n          />\n        </div>\n      </div>\n      <Separator />\n      <Button\n        disabled={isUpdatingUserSetting}\n        onClick={onSave}\n        variant={\"secondary\"}\n      >\n        {isUpdatingUserSetting ? (\n          <Loader2Icon className=\"size-4 animate-spin\" />\n        ) : (\n          <span>{t(\"ä¿å­˜\", \"Save\")}</span>\n        )}\n      </Button>\n    </div>\n  )\n}\n\nconst userSettingQuery = graphql(`\n  query UserSetting {\n    userSetting {\n      id\n      userId\n      preferenceRating\n    }\n  }\n`)\n\nconst viewerIsBlurSensitiveImageQuery = graphql(`\n  query ViewerIsBlurSensitiveImage {\n    viewer {\n      id\n      isBlurSensitiveImage\n    }\n  }\n`)\n\nconst updateUserSettingMutation = graphql(`\n  mutation UpdateUserSetting($input: UpdateUserSettingInput!) {\n    updateUserSetting(input: $input) {\n      preferenceRating\n    }\n  }\n`)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.sticker/components/sticker-change-access-type-action-dialog.tsx"},"span":[5993,6046],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { Link } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon } from \"lucide-react\"\nimport React, { useContext, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  title: string\n  stickerId: string\n  imageUrl: string\n  children: React.ReactNode\n  accessType: \"PUBLIC\" | \"PRIVATE\"\n  onAccessTypeChange(): void\n}\n\n/**\n * ã‚¹ã‚¿ãƒ³ãƒ—å…¬é–‹çŠ¶æ…‹å¤‰æ›´ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function StickerChangeAccessTypeActionDialog (props: Props) {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const [updateSticker, { loading: isChangeStickerAccessType }] = useMutation(\n    updateStickerMutation,\n  )\n\n  const [accessType, setAccessType] = React.useState(props.accessType)\n\n  const [title, setTitle] = useState(\"\")\n\n  const [genre, setGenre] = useState(\"CHARACTER\")\n\n  const [tag, setTag] = useState(\"\")\n\n  const onChangePublic = async () => {\n    if (authContext.isLoading || authContext.isNotLoggedIn) {\n      toast(t(\"ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„\", \"Please log in\"))\n      return\n    }\n\n    if (title === \"\") {\n      toast(t(\"ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a title\"))\n      return\n    }\n\n    if (tag === \"\") {\n      toast(t(\"ã‚¿ã‚°ã‚’é¸æŠã—ã¦ãã ã•ã„\", \"Please select a tag\"))\n      return\n    }\n\n    await updateSticker({\n      variables: {\n        input: {\n          stickerId: props.stickerId,\n          accessType: \"PUBLIC\",\n          title: title,\n          genre: genre as IntrospectionEnum<\"StickerGenre\">,\n          categories: [tag],\n        },\n      },\n    })\n    toast(t(\"å…¬é–‹ã—ã¾ã—ãŸ\", \"Successfully made public\"))\n    setAccessType(\"PUBLIC\")\n  }\n\n  return (\n    <Dialog>\n      <DialogTrigger asChild>{props.children}</DialogTrigger>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>\n            {t(\"ã‚¹ã‚¿ãƒ³ãƒ—ã‚’å…¬é–‹ã™ã‚‹\", \"Make Sticker Public\")}\n          </DialogTitle>\n        </DialogHeader>\n        <Link className=\"m-auto w-24\" to={`/stickers/${props.stickerId}`}>\n          <img\n            className=\"m-auto mb-2 w-24 cursor-pointer duration-500 hover:scale-105\"\n            src={props.imageUrl}\n            alt={props.title}\n          />\n        </Link>\n        <div className=\"space-y-2\">\n          <p className=\"mt-2\">{t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}</p>\n          <Input\n            onChange={(event) => {\n              setTitle(event.target.value)\n            }}\n            value={title}\n            placeholder={t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n          />\n          <p>{t(\"ã‚¸ãƒ£ãƒ³ãƒ«\", \"Genre\")}</p>\n          <RadioGroup\n            value={genre}\n            onValueChange={(value) => {\n              setGenre(value)\n            }}\n            className=\"flex items-center space-x-2\"\n          >\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"person-check\">\n                {t(\"äººç‰©\", \"Character\")}\n                <RadioGroupItem value=\"CHARACTER\" id=\"person-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"animal-check\">\n                {t(\"å‹•ç‰©\", \"Animal\")}\n                <RadioGroupItem value=\"ANIMAL\" id=\"animal-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"machine-check\">\n                {t(\"æ©Ÿæ¢°\", \"Machine\")}\n                <RadioGroupItem value=\"MACHINE\" id=\"machine-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"background-check\">\n                {t(\"èƒŒæ™¯\", \"Background\")}\n                <RadioGroupItem value=\"BACKGROUND\" id=\"background-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"object-check\">\n                {t(\"ç‰©\", \"Object\")}\n                <RadioGroupItem value=\"OBJECT\" id=\"object-check\" />\n              </label>\n            </div>\n          </RadioGroup>\n          <p>{t(\"ã‚¿ã‚°\", \"Tag\")}</p>\n          <RadioGroup\n            value={tag.toString()}\n            onValueChange={(value) => {\n              setTag(value)\n            }}\n            className=\"flex items-center space-x-2\"\n          >\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"happy-check\">\n                {t(\"æ¥½ã—ã„\", \"Happy\")}\n                <RadioGroupItem value=\"æ¥½ã—ã„\" id=\"happy-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"enjoy-check\">\n                {t(\"å¬‰ã—ã„\", \"Glad\")}\n                <RadioGroupItem value=\"å¬‰ã—ã„\" id=\"enjoy-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"celebration-check\">\n                {t(\"ãŠç¥ã„\", \"Celebration\")}\n                <RadioGroupItem value=\"ãŠç¥ã„\" id=\"celebration-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"sad-check\">\n                {t(\"æ‚²ã—ã„\", \"Sad\")}\n                <RadioGroupItem value=\"æ‚²ã—ã„\" id=\"sad-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"other-check\">\n                {t(\"ãã®ä»–\", \"Other\")}\n                <RadioGroupItem value=\"ãã®ä»–\" id=\"other-check\" />\n              </label>\n            </div>\n          </RadioGroup>\n          <DialogFooter>\n            {accessType === \"PRIVATE\" ? (\n              <Button className=\"w-full\" onClick={onChangePublic}>\n                {isChangeStickerAccessType ? (\n                  <Loader2Icon className=\"mr-2 size-4 animate-spin\" />\n                ) : (\n                  <span>{t(\"å…¬é–‹ã™ã‚‹\", \"Make Public\")}</span>\n                )}\n              </Button>\n            ) : (\n              <Button disabled={true} className=\"w-full\">\n                {t(\"å…¬é–‹æ¸ˆã¿\", \"Already Public\")}\n              </Button>\n            )}\n          </DialogFooter>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst updateStickerMutation = graphql(\n  `mutation updateSticker($input: UpdateStickerInput!) {\n    updateSticker(input: $input) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.sticker/components/sticker-change-access-type-action-dialog.tsx"},"span":[3451,3505],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { Link } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon } from \"lucide-react\"\nimport React, { useContext, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  title: string\n  stickerId: string\n  imageUrl: string\n  children: React.ReactNode\n  accessType: \"PUBLIC\" | \"PRIVATE\"\n  onAccessTypeChange(): void\n}\n\n/**\n * ã‚¹ã‚¿ãƒ³ãƒ—å…¬é–‹çŠ¶æ…‹å¤‰æ›´ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function StickerChangeAccessTypeActionDialog (props: Props) {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const [updateSticker, { loading: isChangeStickerAccessType }] = useMutation(\n    updateStickerMutation,\n  )\n\n  const [accessType, setAccessType] = React.useState(props.accessType)\n\n  const [title, setTitle] = useState(\"\")\n\n  const [genre, setGenre] = useState(\"CHARACTER\")\n\n  const [tag, setTag] = useState(\"\")\n\n  const onChangePublic = async () => {\n    if (authContext.isLoading || authContext.isNotLoggedIn) {\n      toast(t(\"ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„\", \"Please log in\"))\n      return\n    }\n\n    if (title === \"\") {\n      toast(t(\"ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a title\"))\n      return\n    }\n\n    if (tag === \"\") {\n      toast(t(\"ã‚¿ã‚°ã‚’é¸æŠã—ã¦ãã ã•ã„\", \"Please select a tag\"))\n      return\n    }\n\n    await updateSticker({\n      variables: {\n        input: {\n          stickerId: props.stickerId,\n          accessType: \"PUBLIC\",\n          title: title,\n          genre: genre as IntrospectionEnum<\"StickerGenre\">,\n          categories: [tag],\n        },\n      },\n    })\n    toast(t(\"å…¬é–‹ã—ã¾ã—ãŸ\", \"Successfully made public\"))\n    setAccessType(\"PUBLIC\")\n  }\n\n  return (\n    <Dialog>\n      <DialogTrigger asChild>{props.children}</DialogTrigger>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>\n            {t(\"ã‚¹ã‚¿ãƒ³ãƒ—ã‚’å…¬é–‹ã™ã‚‹\", \"Make Sticker Public\")}\n          </DialogTitle>\n        </DialogHeader>\n        <Link className=\"m-auto w-24\" to={`/stickers/${props.stickerId}`}>\n          <img\n            className=\"m-auto mb-2 w-24 cursor-pointer duration-500 hover:scale-105\"\n            src={props.imageUrl}\n            alt={props.title}\n          />\n        </Link>\n        <div className=\"space-y-2\">\n          <p className=\"mt-2\">{t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}</p>\n          <Input\n            onChange={(event) => {\n              setTitle(event.target.value)\n            }}\n            value={title}\n            placeholder={t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n          />\n          <p>{t(\"ã‚¸ãƒ£ãƒ³ãƒ«\", \"Genre\")}</p>\n          <RadioGroup\n            value={genre}\n            onValueChange={(value) => {\n              setGenre(value)\n            }}\n            className=\"flex items-center space-x-2\"\n          >\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"person-check\">\n                {t(\"äººç‰©\", \"Character\")}\n                <RadioGroupItem value=\"CHARACTER\" id=\"person-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"animal-check\">\n                {t(\"å‹•ç‰©\", \"Animal\")}\n                <RadioGroupItem value=\"ANIMAL\" id=\"animal-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"machine-check\">\n                {t(\"æ©Ÿæ¢°\", \"Machine\")}\n                <RadioGroupItem value=\"MACHINE\" id=\"machine-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"background-check\">\n                {t(\"èƒŒæ™¯\", \"Background\")}\n                <RadioGroupItem value=\"BACKGROUND\" id=\"background-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"object-check\">\n                {t(\"ç‰©\", \"Object\")}\n                <RadioGroupItem value=\"OBJECT\" id=\"object-check\" />\n              </label>\n            </div>\n          </RadioGroup>\n          <p>{t(\"ã‚¿ã‚°\", \"Tag\")}</p>\n          <RadioGroup\n            value={tag.toString()}\n            onValueChange={(value) => {\n              setTag(value)\n            }}\n            className=\"flex items-center space-x-2\"\n          >\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"happy-check\">\n                {t(\"æ¥½ã—ã„\", \"Happy\")}\n                <RadioGroupItem value=\"æ¥½ã—ã„\" id=\"happy-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"enjoy-check\">\n                {t(\"å¬‰ã—ã„\", \"Glad\")}\n                <RadioGroupItem value=\"å¬‰ã—ã„\" id=\"enjoy-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"celebration-check\">\n                {t(\"ãŠç¥ã„\", \"Celebration\")}\n                <RadioGroupItem value=\"ãŠç¥ã„\" id=\"celebration-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"sad-check\">\n                {t(\"æ‚²ã—ã„\", \"Sad\")}\n                <RadioGroupItem value=\"æ‚²ã—ã„\" id=\"sad-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"other-check\">\n                {t(\"ãã®ä»–\", \"Other\")}\n                <RadioGroupItem value=\"ãã®ä»–\" id=\"other-check\" />\n              </label>\n            </div>\n          </RadioGroup>\n          <DialogFooter>\n            {accessType === \"PRIVATE\" ? (\n              <Button className=\"w-full\" onClick={onChangePublic}>\n                {isChangeStickerAccessType ? (\n                  <Loader2Icon className=\"mr-2 size-4 animate-spin\" />\n                ) : (\n                  <span>{t(\"å…¬é–‹ã™ã‚‹\", \"Make Public\")}</span>\n                )}\n              </Button>\n            ) : (\n              <Button disabled={true} className=\"w-full\">\n                {t(\"å…¬é–‹æ¸ˆã¿\", \"Already Public\")}\n              </Button>\n            )}\n          </DialogFooter>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst updateStickerMutation = graphql(\n  `mutation updateSticker($input: UpdateStickerInput!) {\n    updateSticker(input: $input) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.sticker/components/sticker-change-access-type-action-dialog.tsx"},"span":[3702,3753],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { Link } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon } from \"lucide-react\"\nimport React, { useContext, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  title: string\n  stickerId: string\n  imageUrl: string\n  children: React.ReactNode\n  accessType: \"PUBLIC\" | \"PRIVATE\"\n  onAccessTypeChange(): void\n}\n\n/**\n * ã‚¹ã‚¿ãƒ³ãƒ—å…¬é–‹çŠ¶æ…‹å¤‰æ›´ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function StickerChangeAccessTypeActionDialog (props: Props) {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const [updateSticker, { loading: isChangeStickerAccessType }] = useMutation(\n    updateStickerMutation,\n  )\n\n  const [accessType, setAccessType] = React.useState(props.accessType)\n\n  const [title, setTitle] = useState(\"\")\n\n  const [genre, setGenre] = useState(\"CHARACTER\")\n\n  const [tag, setTag] = useState(\"\")\n\n  const onChangePublic = async () => {\n    if (authContext.isLoading || authContext.isNotLoggedIn) {\n      toast(t(\"ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„\", \"Please log in\"))\n      return\n    }\n\n    if (title === \"\") {\n      toast(t(\"ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a title\"))\n      return\n    }\n\n    if (tag === \"\") {\n      toast(t(\"ã‚¿ã‚°ã‚’é¸æŠã—ã¦ãã ã•ã„\", \"Please select a tag\"))\n      return\n    }\n\n    await updateSticker({\n      variables: {\n        input: {\n          stickerId: props.stickerId,\n          accessType: \"PUBLIC\",\n          title: title,\n          genre: genre as IntrospectionEnum<\"StickerGenre\">,\n          categories: [tag],\n        },\n      },\n    })\n    toast(t(\"å…¬é–‹ã—ã¾ã—ãŸ\", \"Successfully made public\"))\n    setAccessType(\"PUBLIC\")\n  }\n\n  return (\n    <Dialog>\n      <DialogTrigger asChild>{props.children}</DialogTrigger>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>\n            {t(\"ã‚¹ã‚¿ãƒ³ãƒ—ã‚’å…¬é–‹ã™ã‚‹\", \"Make Sticker Public\")}\n          </DialogTitle>\n        </DialogHeader>\n        <Link className=\"m-auto w-24\" to={`/stickers/${props.stickerId}`}>\n          <img\n            className=\"m-auto mb-2 w-24 cursor-pointer duration-500 hover:scale-105\"\n            src={props.imageUrl}\n            alt={props.title}\n          />\n        </Link>\n        <div className=\"space-y-2\">\n          <p className=\"mt-2\">{t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}</p>\n          <Input\n            onChange={(event) => {\n              setTitle(event.target.value)\n            }}\n            value={title}\n            placeholder={t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n          />\n          <p>{t(\"ã‚¸ãƒ£ãƒ³ãƒ«\", \"Genre\")}</p>\n          <RadioGroup\n            value={genre}\n            onValueChange={(value) => {\n              setGenre(value)\n            }}\n            className=\"flex items-center space-x-2\"\n          >\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"person-check\">\n                {t(\"äººç‰©\", \"Character\")}\n                <RadioGroupItem value=\"CHARACTER\" id=\"person-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"animal-check\">\n                {t(\"å‹•ç‰©\", \"Animal\")}\n                <RadioGroupItem value=\"ANIMAL\" id=\"animal-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"machine-check\">\n                {t(\"æ©Ÿæ¢°\", \"Machine\")}\n                <RadioGroupItem value=\"MACHINE\" id=\"machine-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"background-check\">\n                {t(\"èƒŒæ™¯\", \"Background\")}\n                <RadioGroupItem value=\"BACKGROUND\" id=\"background-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"object-check\">\n                {t(\"ç‰©\", \"Object\")}\n                <RadioGroupItem value=\"OBJECT\" id=\"object-check\" />\n              </label>\n            </div>\n          </RadioGroup>\n          <p>{t(\"ã‚¿ã‚°\", \"Tag\")}</p>\n          <RadioGroup\n            value={tag.toString()}\n            onValueChange={(value) => {\n              setTag(value)\n            }}\n            className=\"flex items-center space-x-2\"\n          >\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"happy-check\">\n                {t(\"æ¥½ã—ã„\", \"Happy\")}\n                <RadioGroupItem value=\"æ¥½ã—ã„\" id=\"happy-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"enjoy-check\">\n                {t(\"å¬‰ã—ã„\", \"Glad\")}\n                <RadioGroupItem value=\"å¬‰ã—ã„\" id=\"enjoy-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"celebration-check\">\n                {t(\"ãŠç¥ã„\", \"Celebration\")}\n                <RadioGroupItem value=\"ãŠç¥ã„\" id=\"celebration-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"sad-check\">\n                {t(\"æ‚²ã—ã„\", \"Sad\")}\n                <RadioGroupItem value=\"æ‚²ã—ã„\" id=\"sad-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"other-check\">\n                {t(\"ãã®ä»–\", \"Other\")}\n                <RadioGroupItem value=\"ãã®ä»–\" id=\"other-check\" />\n              </label>\n            </div>\n          </RadioGroup>\n          <DialogFooter>\n            {accessType === \"PRIVATE\" ? (\n              <Button className=\"w-full\" onClick={onChangePublic}>\n                {isChangeStickerAccessType ? (\n                  <Loader2Icon className=\"mr-2 size-4 animate-spin\" />\n                ) : (\n                  <span>{t(\"å…¬é–‹ã™ã‚‹\", \"Make Public\")}</span>\n                )}\n              </Button>\n            ) : (\n              <Button disabled={true} className=\"w-full\">\n                {t(\"å…¬é–‹æ¸ˆã¿\", \"Already Public\")}\n              </Button>\n            )}\n          </DialogFooter>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst updateStickerMutation = graphql(\n  `mutation updateSticker($input: UpdateStickerInput!) {\n    updateSticker(input: $input) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.sticker/components/sticker-change-access-type-action-dialog.tsx"},"span":[3952,4005],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { Link } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon } from \"lucide-react\"\nimport React, { useContext, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  title: string\n  stickerId: string\n  imageUrl: string\n  children: React.ReactNode\n  accessType: \"PUBLIC\" | \"PRIVATE\"\n  onAccessTypeChange(): void\n}\n\n/**\n * ã‚¹ã‚¿ãƒ³ãƒ—å…¬é–‹çŠ¶æ…‹å¤‰æ›´ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function StickerChangeAccessTypeActionDialog (props: Props) {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const [updateSticker, { loading: isChangeStickerAccessType }] = useMutation(\n    updateStickerMutation,\n  )\n\n  const [accessType, setAccessType] = React.useState(props.accessType)\n\n  const [title, setTitle] = useState(\"\")\n\n  const [genre, setGenre] = useState(\"CHARACTER\")\n\n  const [tag, setTag] = useState(\"\")\n\n  const onChangePublic = async () => {\n    if (authContext.isLoading || authContext.isNotLoggedIn) {\n      toast(t(\"ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„\", \"Please log in\"))\n      return\n    }\n\n    if (title === \"\") {\n      toast(t(\"ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a title\"))\n      return\n    }\n\n    if (tag === \"\") {\n      toast(t(\"ã‚¿ã‚°ã‚’é¸æŠã—ã¦ãã ã•ã„\", \"Please select a tag\"))\n      return\n    }\n\n    await updateSticker({\n      variables: {\n        input: {\n          stickerId: props.stickerId,\n          accessType: \"PUBLIC\",\n          title: title,\n          genre: genre as IntrospectionEnum<\"StickerGenre\">,\n          categories: [tag],\n        },\n      },\n    })\n    toast(t(\"å…¬é–‹ã—ã¾ã—ãŸ\", \"Successfully made public\"))\n    setAccessType(\"PUBLIC\")\n  }\n\n  return (\n    <Dialog>\n      <DialogTrigger asChild>{props.children}</DialogTrigger>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>\n            {t(\"ã‚¹ã‚¿ãƒ³ãƒ—ã‚’å…¬é–‹ã™ã‚‹\", \"Make Sticker Public\")}\n          </DialogTitle>\n        </DialogHeader>\n        <Link className=\"m-auto w-24\" to={`/stickers/${props.stickerId}`}>\n          <img\n            className=\"m-auto mb-2 w-24 cursor-pointer duration-500 hover:scale-105\"\n            src={props.imageUrl}\n            alt={props.title}\n          />\n        </Link>\n        <div className=\"space-y-2\">\n          <p className=\"mt-2\">{t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}</p>\n          <Input\n            onChange={(event) => {\n              setTitle(event.target.value)\n            }}\n            value={title}\n            placeholder={t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n          />\n          <p>{t(\"ã‚¸ãƒ£ãƒ³ãƒ«\", \"Genre\")}</p>\n          <RadioGroup\n            value={genre}\n            onValueChange={(value) => {\n              setGenre(value)\n            }}\n            className=\"flex items-center space-x-2\"\n          >\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"person-check\">\n                {t(\"äººç‰©\", \"Character\")}\n                <RadioGroupItem value=\"CHARACTER\" id=\"person-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"animal-check\">\n                {t(\"å‹•ç‰©\", \"Animal\")}\n                <RadioGroupItem value=\"ANIMAL\" id=\"animal-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"machine-check\">\n                {t(\"æ©Ÿæ¢°\", \"Machine\")}\n                <RadioGroupItem value=\"MACHINE\" id=\"machine-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"background-check\">\n                {t(\"èƒŒæ™¯\", \"Background\")}\n                <RadioGroupItem value=\"BACKGROUND\" id=\"background-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"object-check\">\n                {t(\"ç‰©\", \"Object\")}\n                <RadioGroupItem value=\"OBJECT\" id=\"object-check\" />\n              </label>\n            </div>\n          </RadioGroup>\n          <p>{t(\"ã‚¿ã‚°\", \"Tag\")}</p>\n          <RadioGroup\n            value={tag.toString()}\n            onValueChange={(value) => {\n              setTag(value)\n            }}\n            className=\"flex items-center space-x-2\"\n          >\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"happy-check\">\n                {t(\"æ¥½ã—ã„\", \"Happy\")}\n                <RadioGroupItem value=\"æ¥½ã—ã„\" id=\"happy-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"enjoy-check\">\n                {t(\"å¬‰ã—ã„\", \"Glad\")}\n                <RadioGroupItem value=\"å¬‰ã—ã„\" id=\"enjoy-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"celebration-check\">\n                {t(\"ãŠç¥ã„\", \"Celebration\")}\n                <RadioGroupItem value=\"ãŠç¥ã„\" id=\"celebration-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"sad-check\">\n                {t(\"æ‚²ã—ã„\", \"Sad\")}\n                <RadioGroupItem value=\"æ‚²ã—ã„\" id=\"sad-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"other-check\">\n                {t(\"ãã®ä»–\", \"Other\")}\n                <RadioGroupItem value=\"ãã®ä»–\" id=\"other-check\" />\n              </label>\n            </div>\n          </RadioGroup>\n          <DialogFooter>\n            {accessType === \"PRIVATE\" ? (\n              <Button className=\"w-full\" onClick={onChangePublic}>\n                {isChangeStickerAccessType ? (\n                  <Loader2Icon className=\"mr-2 size-4 animate-spin\" />\n                ) : (\n                  <span>{t(\"å…¬é–‹ã™ã‚‹\", \"Make Public\")}</span>\n                )}\n              </Button>\n            ) : (\n              <Button disabled={true} className=\"w-full\">\n                {t(\"å…¬é–‹æ¸ˆã¿\", \"Already Public\")}\n              </Button>\n            )}\n          </DialogFooter>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst updateStickerMutation = graphql(\n  `mutation updateSticker($input: UpdateStickerInput!) {\n    updateSticker(input: $input) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.sticker/components/sticker-change-access-type-action-dialog.tsx"},"span":[4210,4269],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { Link } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon } from \"lucide-react\"\nimport React, { useContext, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  title: string\n  stickerId: string\n  imageUrl: string\n  children: React.ReactNode\n  accessType: \"PUBLIC\" | \"PRIVATE\"\n  onAccessTypeChange(): void\n}\n\n/**\n * ã‚¹ã‚¿ãƒ³ãƒ—å…¬é–‹çŠ¶æ…‹å¤‰æ›´ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function StickerChangeAccessTypeActionDialog (props: Props) {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const [updateSticker, { loading: isChangeStickerAccessType }] = useMutation(\n    updateStickerMutation,\n  )\n\n  const [accessType, setAccessType] = React.useState(props.accessType)\n\n  const [title, setTitle] = useState(\"\")\n\n  const [genre, setGenre] = useState(\"CHARACTER\")\n\n  const [tag, setTag] = useState(\"\")\n\n  const onChangePublic = async () => {\n    if (authContext.isLoading || authContext.isNotLoggedIn) {\n      toast(t(\"ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„\", \"Please log in\"))\n      return\n    }\n\n    if (title === \"\") {\n      toast(t(\"ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a title\"))\n      return\n    }\n\n    if (tag === \"\") {\n      toast(t(\"ã‚¿ã‚°ã‚’é¸æŠã—ã¦ãã ã•ã„\", \"Please select a tag\"))\n      return\n    }\n\n    await updateSticker({\n      variables: {\n        input: {\n          stickerId: props.stickerId,\n          accessType: \"PUBLIC\",\n          title: title,\n          genre: genre as IntrospectionEnum<\"StickerGenre\">,\n          categories: [tag],\n        },\n      },\n    })\n    toast(t(\"å…¬é–‹ã—ã¾ã—ãŸ\", \"Successfully made public\"))\n    setAccessType(\"PUBLIC\")\n  }\n\n  return (\n    <Dialog>\n      <DialogTrigger asChild>{props.children}</DialogTrigger>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>\n            {t(\"ã‚¹ã‚¿ãƒ³ãƒ—ã‚’å…¬é–‹ã™ã‚‹\", \"Make Sticker Public\")}\n          </DialogTitle>\n        </DialogHeader>\n        <Link className=\"m-auto w-24\" to={`/stickers/${props.stickerId}`}>\n          <img\n            className=\"m-auto mb-2 w-24 cursor-pointer duration-500 hover:scale-105\"\n            src={props.imageUrl}\n            alt={props.title}\n          />\n        </Link>\n        <div className=\"space-y-2\">\n          <p className=\"mt-2\">{t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}</p>\n          <Input\n            onChange={(event) => {\n              setTitle(event.target.value)\n            }}\n            value={title}\n            placeholder={t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n          />\n          <p>{t(\"ã‚¸ãƒ£ãƒ³ãƒ«\", \"Genre\")}</p>\n          <RadioGroup\n            value={genre}\n            onValueChange={(value) => {\n              setGenre(value)\n            }}\n            className=\"flex items-center space-x-2\"\n          >\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"person-check\">\n                {t(\"äººç‰©\", \"Character\")}\n                <RadioGroupItem value=\"CHARACTER\" id=\"person-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"animal-check\">\n                {t(\"å‹•ç‰©\", \"Animal\")}\n                <RadioGroupItem value=\"ANIMAL\" id=\"animal-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"machine-check\">\n                {t(\"æ©Ÿæ¢°\", \"Machine\")}\n                <RadioGroupItem value=\"MACHINE\" id=\"machine-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"background-check\">\n                {t(\"èƒŒæ™¯\", \"Background\")}\n                <RadioGroupItem value=\"BACKGROUND\" id=\"background-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"object-check\">\n                {t(\"ç‰©\", \"Object\")}\n                <RadioGroupItem value=\"OBJECT\" id=\"object-check\" />\n              </label>\n            </div>\n          </RadioGroup>\n          <p>{t(\"ã‚¿ã‚°\", \"Tag\")}</p>\n          <RadioGroup\n            value={tag.toString()}\n            onValueChange={(value) => {\n              setTag(value)\n            }}\n            className=\"flex items-center space-x-2\"\n          >\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"happy-check\">\n                {t(\"æ¥½ã—ã„\", \"Happy\")}\n                <RadioGroupItem value=\"æ¥½ã—ã„\" id=\"happy-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"enjoy-check\">\n                {t(\"å¬‰ã—ã„\", \"Glad\")}\n                <RadioGroupItem value=\"å¬‰ã—ã„\" id=\"enjoy-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"celebration-check\">\n                {t(\"ãŠç¥ã„\", \"Celebration\")}\n                <RadioGroupItem value=\"ãŠç¥ã„\" id=\"celebration-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"sad-check\">\n                {t(\"æ‚²ã—ã„\", \"Sad\")}\n                <RadioGroupItem value=\"æ‚²ã—ã„\" id=\"sad-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"other-check\">\n                {t(\"ãã®ä»–\", \"Other\")}\n                <RadioGroupItem value=\"ãã®ä»–\" id=\"other-check\" />\n              </label>\n            </div>\n          </RadioGroup>\n          <DialogFooter>\n            {accessType === \"PRIVATE\" ? (\n              <Button className=\"w-full\" onClick={onChangePublic}>\n                {isChangeStickerAccessType ? (\n                  <Loader2Icon className=\"mr-2 size-4 animate-spin\" />\n                ) : (\n                  <span>{t(\"å…¬é–‹ã™ã‚‹\", \"Make Public\")}</span>\n                )}\n              </Button>\n            ) : (\n              <Button disabled={true} className=\"w-full\">\n                {t(\"å…¬é–‹æ¸ˆã¿\", \"Already Public\")}\n              </Button>\n            )}\n          </DialogFooter>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst updateStickerMutation = graphql(\n  `mutation updateSticker($input: UpdateStickerInput!) {\n    updateSticker(input: $input) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.sticker/components/sticker-change-access-type-action-dialog.tsx"},"span":[4463,4514],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { Link } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon } from \"lucide-react\"\nimport React, { useContext, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  title: string\n  stickerId: string\n  imageUrl: string\n  children: React.ReactNode\n  accessType: \"PUBLIC\" | \"PRIVATE\"\n  onAccessTypeChange(): void\n}\n\n/**\n * ã‚¹ã‚¿ãƒ³ãƒ—å…¬é–‹çŠ¶æ…‹å¤‰æ›´ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function StickerChangeAccessTypeActionDialog (props: Props) {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const [updateSticker, { loading: isChangeStickerAccessType }] = useMutation(\n    updateStickerMutation,\n  )\n\n  const [accessType, setAccessType] = React.useState(props.accessType)\n\n  const [title, setTitle] = useState(\"\")\n\n  const [genre, setGenre] = useState(\"CHARACTER\")\n\n  const [tag, setTag] = useState(\"\")\n\n  const onChangePublic = async () => {\n    if (authContext.isLoading || authContext.isNotLoggedIn) {\n      toast(t(\"ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„\", \"Please log in\"))\n      return\n    }\n\n    if (title === \"\") {\n      toast(t(\"ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a title\"))\n      return\n    }\n\n    if (tag === \"\") {\n      toast(t(\"ã‚¿ã‚°ã‚’é¸æŠã—ã¦ãã ã•ã„\", \"Please select a tag\"))\n      return\n    }\n\n    await updateSticker({\n      variables: {\n        input: {\n          stickerId: props.stickerId,\n          accessType: \"PUBLIC\",\n          title: title,\n          genre: genre as IntrospectionEnum<\"StickerGenre\">,\n          categories: [tag],\n        },\n      },\n    })\n    toast(t(\"å…¬é–‹ã—ã¾ã—ãŸ\", \"Successfully made public\"))\n    setAccessType(\"PUBLIC\")\n  }\n\n  return (\n    <Dialog>\n      <DialogTrigger asChild>{props.children}</DialogTrigger>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>\n            {t(\"ã‚¹ã‚¿ãƒ³ãƒ—ã‚’å…¬é–‹ã™ã‚‹\", \"Make Sticker Public\")}\n          </DialogTitle>\n        </DialogHeader>\n        <Link className=\"m-auto w-24\" to={`/stickers/${props.stickerId}`}>\n          <img\n            className=\"m-auto mb-2 w-24 cursor-pointer duration-500 hover:scale-105\"\n            src={props.imageUrl}\n            alt={props.title}\n          />\n        </Link>\n        <div className=\"space-y-2\">\n          <p className=\"mt-2\">{t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}</p>\n          <Input\n            onChange={(event) => {\n              setTitle(event.target.value)\n            }}\n            value={title}\n            placeholder={t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n          />\n          <p>{t(\"ã‚¸ãƒ£ãƒ³ãƒ«\", \"Genre\")}</p>\n          <RadioGroup\n            value={genre}\n            onValueChange={(value) => {\n              setGenre(value)\n            }}\n            className=\"flex items-center space-x-2\"\n          >\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"person-check\">\n                {t(\"äººç‰©\", \"Character\")}\n                <RadioGroupItem value=\"CHARACTER\" id=\"person-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"animal-check\">\n                {t(\"å‹•ç‰©\", \"Animal\")}\n                <RadioGroupItem value=\"ANIMAL\" id=\"animal-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"machine-check\">\n                {t(\"æ©Ÿæ¢°\", \"Machine\")}\n                <RadioGroupItem value=\"MACHINE\" id=\"machine-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"background-check\">\n                {t(\"èƒŒæ™¯\", \"Background\")}\n                <RadioGroupItem value=\"BACKGROUND\" id=\"background-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"object-check\">\n                {t(\"ç‰©\", \"Object\")}\n                <RadioGroupItem value=\"OBJECT\" id=\"object-check\" />\n              </label>\n            </div>\n          </RadioGroup>\n          <p>{t(\"ã‚¿ã‚°\", \"Tag\")}</p>\n          <RadioGroup\n            value={tag.toString()}\n            onValueChange={(value) => {\n              setTag(value)\n            }}\n            className=\"flex items-center space-x-2\"\n          >\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"happy-check\">\n                {t(\"æ¥½ã—ã„\", \"Happy\")}\n                <RadioGroupItem value=\"æ¥½ã—ã„\" id=\"happy-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"enjoy-check\">\n                {t(\"å¬‰ã—ã„\", \"Glad\")}\n                <RadioGroupItem value=\"å¬‰ã—ã„\" id=\"enjoy-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"celebration-check\">\n                {t(\"ãŠç¥ã„\", \"Celebration\")}\n                <RadioGroupItem value=\"ãŠç¥ã„\" id=\"celebration-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"sad-check\">\n                {t(\"æ‚²ã—ã„\", \"Sad\")}\n                <RadioGroupItem value=\"æ‚²ã—ã„\" id=\"sad-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"other-check\">\n                {t(\"ãã®ä»–\", \"Other\")}\n                <RadioGroupItem value=\"ãã®ä»–\" id=\"other-check\" />\n              </label>\n            </div>\n          </RadioGroup>\n          <DialogFooter>\n            {accessType === \"PRIVATE\" ? (\n              <Button className=\"w-full\" onClick={onChangePublic}>\n                {isChangeStickerAccessType ? (\n                  <Loader2Icon className=\"mr-2 size-4 animate-spin\" />\n                ) : (\n                  <span>{t(\"å…¬é–‹ã™ã‚‹\", \"Make Public\")}</span>\n                )}\n              </Button>\n            ) : (\n              <Button disabled={true} className=\"w-full\">\n                {t(\"å…¬é–‹æ¸ˆã¿\", \"Already Public\")}\n              </Button>\n            )}\n          </DialogFooter>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst updateStickerMutation = graphql(\n  `mutation updateSticker($input: UpdateStickerInput!) {\n    updateSticker(input: $input) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.sticker/components/sticker-change-access-type-action-dialog.tsx"},"span":[4978,5031],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { Link } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon } from \"lucide-react\"\nimport React, { useContext, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  title: string\n  stickerId: string\n  imageUrl: string\n  children: React.ReactNode\n  accessType: \"PUBLIC\" | \"PRIVATE\"\n  onAccessTypeChange(): void\n}\n\n/**\n * ã‚¹ã‚¿ãƒ³ãƒ—å…¬é–‹çŠ¶æ…‹å¤‰æ›´ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function StickerChangeAccessTypeActionDialog (props: Props) {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const [updateSticker, { loading: isChangeStickerAccessType }] = useMutation(\n    updateStickerMutation,\n  )\n\n  const [accessType, setAccessType] = React.useState(props.accessType)\n\n  const [title, setTitle] = useState(\"\")\n\n  const [genre, setGenre] = useState(\"CHARACTER\")\n\n  const [tag, setTag] = useState(\"\")\n\n  const onChangePublic = async () => {\n    if (authContext.isLoading || authContext.isNotLoggedIn) {\n      toast(t(\"ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„\", \"Please log in\"))\n      return\n    }\n\n    if (title === \"\") {\n      toast(t(\"ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a title\"))\n      return\n    }\n\n    if (tag === \"\") {\n      toast(t(\"ã‚¿ã‚°ã‚’é¸æŠã—ã¦ãã ã•ã„\", \"Please select a tag\"))\n      return\n    }\n\n    await updateSticker({\n      variables: {\n        input: {\n          stickerId: props.stickerId,\n          accessType: \"PUBLIC\",\n          title: title,\n          genre: genre as IntrospectionEnum<\"StickerGenre\">,\n          categories: [tag],\n        },\n      },\n    })\n    toast(t(\"å…¬é–‹ã—ã¾ã—ãŸ\", \"Successfully made public\"))\n    setAccessType(\"PUBLIC\")\n  }\n\n  return (\n    <Dialog>\n      <DialogTrigger asChild>{props.children}</DialogTrigger>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>\n            {t(\"ã‚¹ã‚¿ãƒ³ãƒ—ã‚’å…¬é–‹ã™ã‚‹\", \"Make Sticker Public\")}\n          </DialogTitle>\n        </DialogHeader>\n        <Link className=\"m-auto w-24\" to={`/stickers/${props.stickerId}`}>\n          <img\n            className=\"m-auto mb-2 w-24 cursor-pointer duration-500 hover:scale-105\"\n            src={props.imageUrl}\n            alt={props.title}\n          />\n        </Link>\n        <div className=\"space-y-2\">\n          <p className=\"mt-2\">{t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}</p>\n          <Input\n            onChange={(event) => {\n              setTitle(event.target.value)\n            }}\n            value={title}\n            placeholder={t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n          />\n          <p>{t(\"ã‚¸ãƒ£ãƒ³ãƒ«\", \"Genre\")}</p>\n          <RadioGroup\n            value={genre}\n            onValueChange={(value) => {\n              setGenre(value)\n            }}\n            className=\"flex items-center space-x-2\"\n          >\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"person-check\">\n                {t(\"äººç‰©\", \"Character\")}\n                <RadioGroupItem value=\"CHARACTER\" id=\"person-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"animal-check\">\n                {t(\"å‹•ç‰©\", \"Animal\")}\n                <RadioGroupItem value=\"ANIMAL\" id=\"animal-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"machine-check\">\n                {t(\"æ©Ÿæ¢°\", \"Machine\")}\n                <RadioGroupItem value=\"MACHINE\" id=\"machine-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"background-check\">\n                {t(\"èƒŒæ™¯\", \"Background\")}\n                <RadioGroupItem value=\"BACKGROUND\" id=\"background-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"object-check\">\n                {t(\"ç‰©\", \"Object\")}\n                <RadioGroupItem value=\"OBJECT\" id=\"object-check\" />\n              </label>\n            </div>\n          </RadioGroup>\n          <p>{t(\"ã‚¿ã‚°\", \"Tag\")}</p>\n          <RadioGroup\n            value={tag.toString()}\n            onValueChange={(value) => {\n              setTag(value)\n            }}\n            className=\"flex items-center space-x-2\"\n          >\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"happy-check\">\n                {t(\"æ¥½ã—ã„\", \"Happy\")}\n                <RadioGroupItem value=\"æ¥½ã—ã„\" id=\"happy-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"enjoy-check\">\n                {t(\"å¬‰ã—ã„\", \"Glad\")}\n                <RadioGroupItem value=\"å¬‰ã—ã„\" id=\"enjoy-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"celebration-check\">\n                {t(\"ãŠç¥ã„\", \"Celebration\")}\n                <RadioGroupItem value=\"ãŠç¥ã„\" id=\"celebration-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"sad-check\">\n                {t(\"æ‚²ã—ã„\", \"Sad\")}\n                <RadioGroupItem value=\"æ‚²ã—ã„\" id=\"sad-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"other-check\">\n                {t(\"ãã®ä»–\", \"Other\")}\n                <RadioGroupItem value=\"ãã®ä»–\" id=\"other-check\" />\n              </label>\n            </div>\n          </RadioGroup>\n          <DialogFooter>\n            {accessType === \"PRIVATE\" ? (\n              <Button className=\"w-full\" onClick={onChangePublic}>\n                {isChangeStickerAccessType ? (\n                  <Loader2Icon className=\"mr-2 size-4 animate-spin\" />\n                ) : (\n                  <span>{t(\"å…¬é–‹ã™ã‚‹\", \"Make Public\")}</span>\n                )}\n              </Button>\n            ) : (\n              <Button disabled={true} className=\"w-full\">\n                {t(\"å…¬é–‹æ¸ˆã¿\", \"Already Public\")}\n              </Button>\n            )}\n          </DialogFooter>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst updateStickerMutation = graphql(\n  `mutation updateSticker($input: UpdateStickerInput!) {\n    updateSticker(input: $input) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.sticker/components/sticker-change-access-type-action-dialog.tsx"},"span":[5228,5281],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { Link } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon } from \"lucide-react\"\nimport React, { useContext, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  title: string\n  stickerId: string\n  imageUrl: string\n  children: React.ReactNode\n  accessType: \"PUBLIC\" | \"PRIVATE\"\n  onAccessTypeChange(): void\n}\n\n/**\n * ã‚¹ã‚¿ãƒ³ãƒ—å…¬é–‹çŠ¶æ…‹å¤‰æ›´ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function StickerChangeAccessTypeActionDialog (props: Props) {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const [updateSticker, { loading: isChangeStickerAccessType }] = useMutation(\n    updateStickerMutation,\n  )\n\n  const [accessType, setAccessType] = React.useState(props.accessType)\n\n  const [title, setTitle] = useState(\"\")\n\n  const [genre, setGenre] = useState(\"CHARACTER\")\n\n  const [tag, setTag] = useState(\"\")\n\n  const onChangePublic = async () => {\n    if (authContext.isLoading || authContext.isNotLoggedIn) {\n      toast(t(\"ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„\", \"Please log in\"))\n      return\n    }\n\n    if (title === \"\") {\n      toast(t(\"ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a title\"))\n      return\n    }\n\n    if (tag === \"\") {\n      toast(t(\"ã‚¿ã‚°ã‚’é¸æŠã—ã¦ãã ã•ã„\", \"Please select a tag\"))\n      return\n    }\n\n    await updateSticker({\n      variables: {\n        input: {\n          stickerId: props.stickerId,\n          accessType: \"PUBLIC\",\n          title: title,\n          genre: genre as IntrospectionEnum<\"StickerGenre\">,\n          categories: [tag],\n        },\n      },\n    })\n    toast(t(\"å…¬é–‹ã—ã¾ã—ãŸ\", \"Successfully made public\"))\n    setAccessType(\"PUBLIC\")\n  }\n\n  return (\n    <Dialog>\n      <DialogTrigger asChild>{props.children}</DialogTrigger>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>\n            {t(\"ã‚¹ã‚¿ãƒ³ãƒ—ã‚’å…¬é–‹ã™ã‚‹\", \"Make Sticker Public\")}\n          </DialogTitle>\n        </DialogHeader>\n        <Link className=\"m-auto w-24\" to={`/stickers/${props.stickerId}`}>\n          <img\n            className=\"m-auto mb-2 w-24 cursor-pointer duration-500 hover:scale-105\"\n            src={props.imageUrl}\n            alt={props.title}\n          />\n        </Link>\n        <div className=\"space-y-2\">\n          <p className=\"mt-2\">{t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}</p>\n          <Input\n            onChange={(event) => {\n              setTitle(event.target.value)\n            }}\n            value={title}\n            placeholder={t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n          />\n          <p>{t(\"ã‚¸ãƒ£ãƒ³ãƒ«\", \"Genre\")}</p>\n          <RadioGroup\n            value={genre}\n            onValueChange={(value) => {\n              setGenre(value)\n            }}\n            className=\"flex items-center space-x-2\"\n          >\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"person-check\">\n                {t(\"äººç‰©\", \"Character\")}\n                <RadioGroupItem value=\"CHARACTER\" id=\"person-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"animal-check\">\n                {t(\"å‹•ç‰©\", \"Animal\")}\n                <RadioGroupItem value=\"ANIMAL\" id=\"animal-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"machine-check\">\n                {t(\"æ©Ÿæ¢°\", \"Machine\")}\n                <RadioGroupItem value=\"MACHINE\" id=\"machine-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"background-check\">\n                {t(\"èƒŒæ™¯\", \"Background\")}\n                <RadioGroupItem value=\"BACKGROUND\" id=\"background-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"object-check\">\n                {t(\"ç‰©\", \"Object\")}\n                <RadioGroupItem value=\"OBJECT\" id=\"object-check\" />\n              </label>\n            </div>\n          </RadioGroup>\n          <p>{t(\"ã‚¿ã‚°\", \"Tag\")}</p>\n          <RadioGroup\n            value={tag.toString()}\n            onValueChange={(value) => {\n              setTag(value)\n            }}\n            className=\"flex items-center space-x-2\"\n          >\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"happy-check\">\n                {t(\"æ¥½ã—ã„\", \"Happy\")}\n                <RadioGroupItem value=\"æ¥½ã—ã„\" id=\"happy-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"enjoy-check\">\n                {t(\"å¬‰ã—ã„\", \"Glad\")}\n                <RadioGroupItem value=\"å¬‰ã—ã„\" id=\"enjoy-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"celebration-check\">\n                {t(\"ãŠç¥ã„\", \"Celebration\")}\n                <RadioGroupItem value=\"ãŠç¥ã„\" id=\"celebration-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"sad-check\">\n                {t(\"æ‚²ã—ã„\", \"Sad\")}\n                <RadioGroupItem value=\"æ‚²ã—ã„\" id=\"sad-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"other-check\">\n                {t(\"ãã®ä»–\", \"Other\")}\n                <RadioGroupItem value=\"ãã®ä»–\" id=\"other-check\" />\n              </label>\n            </div>\n          </RadioGroup>\n          <DialogFooter>\n            {accessType === \"PRIVATE\" ? (\n              <Button className=\"w-full\" onClick={onChangePublic}>\n                {isChangeStickerAccessType ? (\n                  <Loader2Icon className=\"mr-2 size-4 animate-spin\" />\n                ) : (\n                  <span>{t(\"å…¬é–‹ã™ã‚‹\", \"Make Public\")}</span>\n                )}\n              </Button>\n            ) : (\n              <Button disabled={true} className=\"w-full\">\n                {t(\"å…¬é–‹æ¸ˆã¿\", \"Already Public\")}\n              </Button>\n            )}\n          </DialogFooter>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst updateStickerMutation = graphql(\n  `mutation updateSticker($input: UpdateStickerInput!) {\n    updateSticker(input: $input) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.sticker/components/sticker-change-access-type-action-dialog.tsx"},"span":[5491,5550],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { Link } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon } from \"lucide-react\"\nimport React, { useContext, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  title: string\n  stickerId: string\n  imageUrl: string\n  children: React.ReactNode\n  accessType: \"PUBLIC\" | \"PRIVATE\"\n  onAccessTypeChange(): void\n}\n\n/**\n * ã‚¹ã‚¿ãƒ³ãƒ—å…¬é–‹çŠ¶æ…‹å¤‰æ›´ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function StickerChangeAccessTypeActionDialog (props: Props) {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const [updateSticker, { loading: isChangeStickerAccessType }] = useMutation(\n    updateStickerMutation,\n  )\n\n  const [accessType, setAccessType] = React.useState(props.accessType)\n\n  const [title, setTitle] = useState(\"\")\n\n  const [genre, setGenre] = useState(\"CHARACTER\")\n\n  const [tag, setTag] = useState(\"\")\n\n  const onChangePublic = async () => {\n    if (authContext.isLoading || authContext.isNotLoggedIn) {\n      toast(t(\"ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„\", \"Please log in\"))\n      return\n    }\n\n    if (title === \"\") {\n      toast(t(\"ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a title\"))\n      return\n    }\n\n    if (tag === \"\") {\n      toast(t(\"ã‚¿ã‚°ã‚’é¸æŠã—ã¦ãã ã•ã„\", \"Please select a tag\"))\n      return\n    }\n\n    await updateSticker({\n      variables: {\n        input: {\n          stickerId: props.stickerId,\n          accessType: \"PUBLIC\",\n          title: title,\n          genre: genre as IntrospectionEnum<\"StickerGenre\">,\n          categories: [tag],\n        },\n      },\n    })\n    toast(t(\"å…¬é–‹ã—ã¾ã—ãŸ\", \"Successfully made public\"))\n    setAccessType(\"PUBLIC\")\n  }\n\n  return (\n    <Dialog>\n      <DialogTrigger asChild>{props.children}</DialogTrigger>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>\n            {t(\"ã‚¹ã‚¿ãƒ³ãƒ—ã‚’å…¬é–‹ã™ã‚‹\", \"Make Sticker Public\")}\n          </DialogTitle>\n        </DialogHeader>\n        <Link className=\"m-auto w-24\" to={`/stickers/${props.stickerId}`}>\n          <img\n            className=\"m-auto mb-2 w-24 cursor-pointer duration-500 hover:scale-105\"\n            src={props.imageUrl}\n            alt={props.title}\n          />\n        </Link>\n        <div className=\"space-y-2\">\n          <p className=\"mt-2\">{t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}</p>\n          <Input\n            onChange={(event) => {\n              setTitle(event.target.value)\n            }}\n            value={title}\n            placeholder={t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n          />\n          <p>{t(\"ã‚¸ãƒ£ãƒ³ãƒ«\", \"Genre\")}</p>\n          <RadioGroup\n            value={genre}\n            onValueChange={(value) => {\n              setGenre(value)\n            }}\n            className=\"flex items-center space-x-2\"\n          >\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"person-check\">\n                {t(\"äººç‰©\", \"Character\")}\n                <RadioGroupItem value=\"CHARACTER\" id=\"person-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"animal-check\">\n                {t(\"å‹•ç‰©\", \"Animal\")}\n                <RadioGroupItem value=\"ANIMAL\" id=\"animal-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"machine-check\">\n                {t(\"æ©Ÿæ¢°\", \"Machine\")}\n                <RadioGroupItem value=\"MACHINE\" id=\"machine-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"background-check\">\n                {t(\"èƒŒæ™¯\", \"Background\")}\n                <RadioGroupItem value=\"BACKGROUND\" id=\"background-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"object-check\">\n                {t(\"ç‰©\", \"Object\")}\n                <RadioGroupItem value=\"OBJECT\" id=\"object-check\" />\n              </label>\n            </div>\n          </RadioGroup>\n          <p>{t(\"ã‚¿ã‚°\", \"Tag\")}</p>\n          <RadioGroup\n            value={tag.toString()}\n            onValueChange={(value) => {\n              setTag(value)\n            }}\n            className=\"flex items-center space-x-2\"\n          >\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"happy-check\">\n                {t(\"æ¥½ã—ã„\", \"Happy\")}\n                <RadioGroupItem value=\"æ¥½ã—ã„\" id=\"happy-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"enjoy-check\">\n                {t(\"å¬‰ã—ã„\", \"Glad\")}\n                <RadioGroupItem value=\"å¬‰ã—ã„\" id=\"enjoy-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"celebration-check\">\n                {t(\"ãŠç¥ã„\", \"Celebration\")}\n                <RadioGroupItem value=\"ãŠç¥ã„\" id=\"celebration-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"sad-check\">\n                {t(\"æ‚²ã—ã„\", \"Sad\")}\n                <RadioGroupItem value=\"æ‚²ã—ã„\" id=\"sad-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"other-check\">\n                {t(\"ãã®ä»–\", \"Other\")}\n                <RadioGroupItem value=\"ãã®ä»–\" id=\"other-check\" />\n              </label>\n            </div>\n          </RadioGroup>\n          <DialogFooter>\n            {accessType === \"PRIVATE\" ? (\n              <Button className=\"w-full\" onClick={onChangePublic}>\n                {isChangeStickerAccessType ? (\n                  <Loader2Icon className=\"mr-2 size-4 animate-spin\" />\n                ) : (\n                  <span>{t(\"å…¬é–‹ã™ã‚‹\", \"Make Public\")}</span>\n                )}\n              </Button>\n            ) : (\n              <Button disabled={true} className=\"w-full\">\n                {t(\"å…¬é–‹æ¸ˆã¿\", \"Already Public\")}\n              </Button>\n            )}\n          </DialogFooter>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst updateStickerMutation = graphql(\n  `mutation updateSticker($input: UpdateStickerInput!) {\n    updateSticker(input: $input) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/useUniqueElementIds","severity":"warning","description":"id attribute should not be a static string literal. Generate unique IDs using useId().","message":[{"elements":["Emphasis"],"content":"id"},{"elements":[],"content":" attribute should not be a static string literal. Generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"In React, if you hardcode IDs and use the component multiple times, it can lead to duplicate IDs in the DOM. Instead, generate unique IDs using "},{"elements":["Emphasis"],"content":"useId()"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.sticker/components/sticker-change-access-type-action-dialog.tsx"},"span":[5744,5795],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"~/components/ui/dialog\"\nimport { Input } from \"~/components/ui/input\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { Link } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { Loader2Icon } from \"lucide-react\"\nimport React, { useContext, useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  title: string\n  stickerId: string\n  imageUrl: string\n  children: React.ReactNode\n  accessType: \"PUBLIC\" | \"PRIVATE\"\n  onAccessTypeChange(): void\n}\n\n/**\n * ã‚¹ã‚¿ãƒ³ãƒ—å…¬é–‹çŠ¶æ…‹å¤‰æ›´ãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function StickerChangeAccessTypeActionDialog (props: Props) {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const [updateSticker, { loading: isChangeStickerAccessType }] = useMutation(\n    updateStickerMutation,\n  )\n\n  const [accessType, setAccessType] = React.useState(props.accessType)\n\n  const [title, setTitle] = useState(\"\")\n\n  const [genre, setGenre] = useState(\"CHARACTER\")\n\n  const [tag, setTag] = useState(\"\")\n\n  const onChangePublic = async () => {\n    if (authContext.isLoading || authContext.isNotLoggedIn) {\n      toast(t(\"ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„\", \"Please log in\"))\n      return\n    }\n\n    if (title === \"\") {\n      toast(t(\"ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\", \"Please enter a title\"))\n      return\n    }\n\n    if (tag === \"\") {\n      toast(t(\"ã‚¿ã‚°ã‚’é¸æŠã—ã¦ãã ã•ã„\", \"Please select a tag\"))\n      return\n    }\n\n    await updateSticker({\n      variables: {\n        input: {\n          stickerId: props.stickerId,\n          accessType: \"PUBLIC\",\n          title: title,\n          genre: genre as IntrospectionEnum<\"StickerGenre\">,\n          categories: [tag],\n        },\n      },\n    })\n    toast(t(\"å…¬é–‹ã—ã¾ã—ãŸ\", \"Successfully made public\"))\n    setAccessType(\"PUBLIC\")\n  }\n\n  return (\n    <Dialog>\n      <DialogTrigger asChild>{props.children}</DialogTrigger>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>\n            {t(\"ã‚¹ã‚¿ãƒ³ãƒ—ã‚’å…¬é–‹ã™ã‚‹\", \"Make Sticker Public\")}\n          </DialogTitle>\n        </DialogHeader>\n        <Link className=\"m-auto w-24\" to={`/stickers/${props.stickerId}`}>\n          <img\n            className=\"m-auto mb-2 w-24 cursor-pointer duration-500 hover:scale-105\"\n            src={props.imageUrl}\n            alt={props.title}\n          />\n        </Link>\n        <div className=\"space-y-2\">\n          <p className=\"mt-2\">{t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}</p>\n          <Input\n            onChange={(event) => {\n              setTitle(event.target.value)\n            }}\n            value={title}\n            placeholder={t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n          />\n          <p>{t(\"ã‚¸ãƒ£ãƒ³ãƒ«\", \"Genre\")}</p>\n          <RadioGroup\n            value={genre}\n            onValueChange={(value) => {\n              setGenre(value)\n            }}\n            className=\"flex items-center space-x-2\"\n          >\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"person-check\">\n                {t(\"äººç‰©\", \"Character\")}\n                <RadioGroupItem value=\"CHARACTER\" id=\"person-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"animal-check\">\n                {t(\"å‹•ç‰©\", \"Animal\")}\n                <RadioGroupItem value=\"ANIMAL\" id=\"animal-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"machine-check\">\n                {t(\"æ©Ÿæ¢°\", \"Machine\")}\n                <RadioGroupItem value=\"MACHINE\" id=\"machine-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"background-check\">\n                {t(\"èƒŒæ™¯\", \"Background\")}\n                <RadioGroupItem value=\"BACKGROUND\" id=\"background-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"object-check\">\n                {t(\"ç‰©\", \"Object\")}\n                <RadioGroupItem value=\"OBJECT\" id=\"object-check\" />\n              </label>\n            </div>\n          </RadioGroup>\n          <p>{t(\"ã‚¿ã‚°\", \"Tag\")}</p>\n          <RadioGroup\n            value={tag.toString()}\n            onValueChange={(value) => {\n              setTag(value)\n            }}\n            className=\"flex items-center space-x-2\"\n          >\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"happy-check\">\n                {t(\"æ¥½ã—ã„\", \"Happy\")}\n                <RadioGroupItem value=\"æ¥½ã—ã„\" id=\"happy-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"enjoy-check\">\n                {t(\"å¬‰ã—ã„\", \"Glad\")}\n                <RadioGroupItem value=\"å¬‰ã—ã„\" id=\"enjoy-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"celebration-check\">\n                {t(\"ãŠç¥ã„\", \"Celebration\")}\n                <RadioGroupItem value=\"ãŠç¥ã„\" id=\"celebration-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"sad-check\">\n                {t(\"æ‚²ã—ã„\", \"Sad\")}\n                <RadioGroupItem value=\"æ‚²ã—ã„\" id=\"sad-check\" />\n              </label>\n            </div>\n            <div className=\"items-center space-x-2\">\n              <label htmlFor=\"other-check\">\n                {t(\"ãã®ä»–\", \"Other\")}\n                <RadioGroupItem value=\"ãã®ä»–\" id=\"other-check\" />\n              </label>\n            </div>\n          </RadioGroup>\n          <DialogFooter>\n            {accessType === \"PRIVATE\" ? (\n              <Button className=\"w-full\" onClick={onChangePublic}>\n                {isChangeStickerAccessType ? (\n                  <Loader2Icon className=\"mr-2 size-4 animate-spin\" />\n                ) : (\n                  <span>{t(\"å…¬é–‹ã™ã‚‹\", \"Make Public\")}</span>\n                )}\n              </Button>\n            ) : (\n              <Button disabled={true} className=\"w-full\">\n                {t(\"å…¬é–‹æ¸ˆã¿\", \"Already Public\")}\n              </Button>\n            )}\n          </DialogFooter>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst updateStickerMutation = graphql(\n  `mutation updateSticker($input: UpdateStickerInput!) {\n    updateSticker(input: $input) {\n      id\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"suppressions/incorrect","severity":"warning","description":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive","message":[{"elements":[],"content":"A suppression shouldn't have an <explanation> placeholder. Example of suppression: // biome-ignore lint: false positive"}],"advices":{"advices":[]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/utils/get-base64-from-aipicors-url.ts"},"span":[431,444],"sourceCode":"export const getBase64FromAipictorsUrl = async (\n  url: string,\n): Promise<string> => {\n  const formData = new FormData()\n\n  formData.append(\"url\", url)\n\n  try {\n    const endpoint =\n      \"https://www.aipictors.com/wp-content/themes/AISite/get-base-64.php\"\n\n    const response = await fetch(endpoint, {\n      method: \"POST\",\n      body: formData,\n    })\n    if (response.ok) {\n      // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n      const responseData = (await response.json()) as any\n      if (responseData.base64) {\n        return responseData.base64\n      }\n      return \"\"\n    }\n    throw new Error()\n  } catch (_error) {\n    // captureException(error)\n    throw new Error()\n  }\n}\n"},"tags":[],"source":null},{"category":"lint/suspicious/noExplicitAny","severity":"warning","description":"Unexpected any. Specify a different type.","message":[{"elements":[],"content":"Unexpected "},{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":". Specify a different type."}],"advices":{"advices":[{"log":["info",[{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":" disables many type checking rules. Its use should be avoided."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/utils/mobile-performance.ts"},"span":[250,253],"sourceCode":"/**\n * ãƒ¢ãƒã‚¤ãƒ«ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®ãŸã‚ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£\n * ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºã¨ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æ”¹å–„ã™ã‚‹\n */\n\n// ãƒ‡ãƒã‚¦ãƒ³ã‚¹é–¢æ•°\nexport function debounce<T extends (...args: any[]) => any>(\n  func: T,\n  wait: number,\n): (...args: Parameters<T>) => void {\n  let timeout: NodeJS.Timeout\n  return (...args: Parameters<T>) => {\n    clearTimeout(timeout)\n    timeout = setTimeout(() => func(...args), wait)\n  }\n}\n\n// ã‚¹ãƒ­ãƒƒãƒˆãƒ«é–¢æ•°\nexport function throttle<T extends (...args: any[]) => any>(\n  func: T,\n  limit: number,\n): (...args: Parameters<T>) => void {\n  let inThrottle: boolean\n  return (...args: Parameters<T>) => {\n    if (!inThrottle) {\n      func(...args)\n      inThrottle = true\n      setTimeout(() => (inThrottle = false), limit)\n    }\n  }\n}\n\n// ç”»åƒã®äº‹å‰èª­ã¿è¾¼ã¿\nexport function preloadImage(src: string): Promise<void> {\n  return new Promise((resolve, reject) => {\n    const img = new Image()\n    img.onload = () => resolve()\n    img.onerror = () => reject(new Error(`Failed to load image: ${src}`))\n    img.src = src\n  })\n}\n\n// WebP ã‚µãƒãƒ¼ãƒˆã®æ¤œå‡º\nexport function detectWebPSupport(): Promise<boolean> {\n  if (typeof window === \"undefined\") return Promise.resolve(false)\n\n  return new Promise((resolve) => {\n    const webP = new Image()\n    webP.onload = webP.onerror = () => {\n      resolve(webP.height === 2)\n    }\n    webP.src =\n      \"data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA\"\n  })\n}\n\n// ãƒªã‚½ãƒ¼ã‚¹ãƒ’ãƒ³ãƒˆã®è¿½åŠ \nexport function addResourceHint(\n  href: string,\n  rel: \"preload\" | \"prefetch\" | \"dns-prefetch\" | \"preconnect\",\n  as?: string,\n): void {\n  if (typeof document === \"undefined\") return\n\n  const existingLink = document.querySelector(`link[href=\"${href}\"]`)\n  if (existingLink) return\n\n  const link = document.createElement(\"link\")\n  link.rel = rel\n  link.href = href\n  if (as) link.as = as\n\n  document.head.appendChild(link)\n}\n\n// ãƒ¢ãƒã‚¤ãƒ«ãƒ‡ãƒã‚¤ã‚¹ã®æ¤œå‡º\nexport function isMobileDevice(): boolean {\n  if (typeof window === \"undefined\") return false\n\n  return (\n    /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n      navigator.userAgent,\n    ) || window.innerWidth < 768\n  )\n}\n\n// ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºè­¦å‘Šï¼ˆé–‹ç™ºç’°å¢ƒã®ã¿ï¼‰\nexport function warnLargeBundle(componentName: string, sizeKB: number): void {\n  if (process.env.NODE_ENV === \"development\" && sizeKB > 100) {\n    console.warn(\n      `! Large bundle detected: ${componentName} (${sizeKB}KB). Consider code splitting.`,\n    )\n  }\n}\n\n// ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–\nexport function measurePerformance(name: string, fn: () => void): void {\n  if (typeof window === \"undefined\" || process.env.NODE_ENV !== \"development\") {\n    fn()\n    return\n  }\n\n  const start = performance.now()\n  fn()\n  const end = performance.now()\n\n  const duration = end - start\n  if (duration > 16) {\n    // 60fps threshold\n    console.warn(`ğŸŒ Slow operation: ${name} took ${duration.toFixed(2)}ms`)\n  }\n}\n"},"tags":[],"source":null},{"category":"lint/suspicious/noExplicitAny","severity":"warning","description":"Unexpected any. Specify a different type.","message":[{"elements":[],"content":"Unexpected "},{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":". Specify a different type."}],"advices":{"advices":[{"log":["info",[{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":" disables many type checking rules. Its use should be avoided."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/utils/mobile-performance.ts"},"span":[545,548],"sourceCode":"/**\n * ãƒ¢ãƒã‚¤ãƒ«ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®ãŸã‚ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£\n * ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºã¨ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æ”¹å–„ã™ã‚‹\n */\n\n// ãƒ‡ãƒã‚¦ãƒ³ã‚¹é–¢æ•°\nexport function debounce<T extends (...args: any[]) => any>(\n  func: T,\n  wait: number,\n): (...args: Parameters<T>) => void {\n  let timeout: NodeJS.Timeout\n  return (...args: Parameters<T>) => {\n    clearTimeout(timeout)\n    timeout = setTimeout(() => func(...args), wait)\n  }\n}\n\n// ã‚¹ãƒ­ãƒƒãƒˆãƒ«é–¢æ•°\nexport function throttle<T extends (...args: any[]) => any>(\n  func: T,\n  limit: number,\n): (...args: Parameters<T>) => void {\n  let inThrottle: boolean\n  return (...args: Parameters<T>) => {\n    if (!inThrottle) {\n      func(...args)\n      inThrottle = true\n      setTimeout(() => (inThrottle = false), limit)\n    }\n  }\n}\n\n// ç”»åƒã®äº‹å‰èª­ã¿è¾¼ã¿\nexport function preloadImage(src: string): Promise<void> {\n  return new Promise((resolve, reject) => {\n    const img = new Image()\n    img.onload = () => resolve()\n    img.onerror = () => reject(new Error(`Failed to load image: ${src}`))\n    img.src = src\n  })\n}\n\n// WebP ã‚µãƒãƒ¼ãƒˆã®æ¤œå‡º\nexport function detectWebPSupport(): Promise<boolean> {\n  if (typeof window === \"undefined\") return Promise.resolve(false)\n\n  return new Promise((resolve) => {\n    const webP = new Image()\n    webP.onload = webP.onerror = () => {\n      resolve(webP.height === 2)\n    }\n    webP.src =\n      \"data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA\"\n  })\n}\n\n// ãƒªã‚½ãƒ¼ã‚¹ãƒ’ãƒ³ãƒˆã®è¿½åŠ \nexport function addResourceHint(\n  href: string,\n  rel: \"preload\" | \"prefetch\" | \"dns-prefetch\" | \"preconnect\",\n  as?: string,\n): void {\n  if (typeof document === \"undefined\") return\n\n  const existingLink = document.querySelector(`link[href=\"${href}\"]`)\n  if (existingLink) return\n\n  const link = document.createElement(\"link\")\n  link.rel = rel\n  link.href = href\n  if (as) link.as = as\n\n  document.head.appendChild(link)\n}\n\n// ãƒ¢ãƒã‚¤ãƒ«ãƒ‡ãƒã‚¤ã‚¹ã®æ¤œå‡º\nexport function isMobileDevice(): boolean {\n  if (typeof window === \"undefined\") return false\n\n  return (\n    /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n      navigator.userAgent,\n    ) || window.innerWidth < 768\n  )\n}\n\n// ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºè­¦å‘Šï¼ˆé–‹ç™ºç’°å¢ƒã®ã¿ï¼‰\nexport function warnLargeBundle(componentName: string, sizeKB: number): void {\n  if (process.env.NODE_ENV === \"development\" && sizeKB > 100) {\n    console.warn(\n      `! Large bundle detected: ${componentName} (${sizeKB}KB). Consider code splitting.`,\n    )\n  }\n}\n\n// ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–\nexport function measurePerformance(name: string, fn: () => void): void {\n  if (typeof window === \"undefined\" || process.env.NODE_ENV !== \"development\") {\n    fn()\n    return\n  }\n\n  const start = performance.now()\n  fn()\n  const end = performance.now()\n\n  const duration = end - start\n  if (duration > 16) {\n    // 60fps threshold\n    console.warn(`ğŸŒ Slow operation: ${name} took ${duration.toFixed(2)}ms`)\n  }\n}\n"},"tags":[],"source":null},{"category":"lint/suspicious/noExplicitAny","severity":"warning","description":"Unexpected any. Specify a different type.","message":[{"elements":[],"content":"Unexpected "},{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":". Specify a different type."}],"advices":{"advices":[{"log":["info",[{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":" disables many type checking rules. Its use should be avoided."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/utils/mobile-performance.ts"},"span":[555,558],"sourceCode":"/**\n * ãƒ¢ãƒã‚¤ãƒ«ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®ãŸã‚ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£\n * ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºã¨ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æ”¹å–„ã™ã‚‹\n */\n\n// ãƒ‡ãƒã‚¦ãƒ³ã‚¹é–¢æ•°\nexport function debounce<T extends (...args: any[]) => any>(\n  func: T,\n  wait: number,\n): (...args: Parameters<T>) => void {\n  let timeout: NodeJS.Timeout\n  return (...args: Parameters<T>) => {\n    clearTimeout(timeout)\n    timeout = setTimeout(() => func(...args), wait)\n  }\n}\n\n// ã‚¹ãƒ­ãƒƒãƒˆãƒ«é–¢æ•°\nexport function throttle<T extends (...args: any[]) => any>(\n  func: T,\n  limit: number,\n): (...args: Parameters<T>) => void {\n  let inThrottle: boolean\n  return (...args: Parameters<T>) => {\n    if (!inThrottle) {\n      func(...args)\n      inThrottle = true\n      setTimeout(() => (inThrottle = false), limit)\n    }\n  }\n}\n\n// ç”»åƒã®äº‹å‰èª­ã¿è¾¼ã¿\nexport function preloadImage(src: string): Promise<void> {\n  return new Promise((resolve, reject) => {\n    const img = new Image()\n    img.onload = () => resolve()\n    img.onerror = () => reject(new Error(`Failed to load image: ${src}`))\n    img.src = src\n  })\n}\n\n// WebP ã‚µãƒãƒ¼ãƒˆã®æ¤œå‡º\nexport function detectWebPSupport(): Promise<boolean> {\n  if (typeof window === \"undefined\") return Promise.resolve(false)\n\n  return new Promise((resolve) => {\n    const webP = new Image()\n    webP.onload = webP.onerror = () => {\n      resolve(webP.height === 2)\n    }\n    webP.src =\n      \"data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA\"\n  })\n}\n\n// ãƒªã‚½ãƒ¼ã‚¹ãƒ’ãƒ³ãƒˆã®è¿½åŠ \nexport function addResourceHint(\n  href: string,\n  rel: \"preload\" | \"prefetch\" | \"dns-prefetch\" | \"preconnect\",\n  as?: string,\n): void {\n  if (typeof document === \"undefined\") return\n\n  const existingLink = document.querySelector(`link[href=\"${href}\"]`)\n  if (existingLink) return\n\n  const link = document.createElement(\"link\")\n  link.rel = rel\n  link.href = href\n  if (as) link.as = as\n\n  document.head.appendChild(link)\n}\n\n// ãƒ¢ãƒã‚¤ãƒ«ãƒ‡ãƒã‚¤ã‚¹ã®æ¤œå‡º\nexport function isMobileDevice(): boolean {\n  if (typeof window === \"undefined\") return false\n\n  return (\n    /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n      navigator.userAgent,\n    ) || window.innerWidth < 768\n  )\n}\n\n// ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºè­¦å‘Šï¼ˆé–‹ç™ºç’°å¢ƒã®ã¿ï¼‰\nexport function warnLargeBundle(componentName: string, sizeKB: number): void {\n  if (process.env.NODE_ENV === \"development\" && sizeKB > 100) {\n    console.warn(\n      `! Large bundle detected: ${componentName} (${sizeKB}KB). Consider code splitting.`,\n    )\n  }\n}\n\n// ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–\nexport function measurePerformance(name: string, fn: () => void): void {\n  if (typeof window === \"undefined\" || process.env.NODE_ENV !== \"development\") {\n    fn()\n    return\n  }\n\n  const start = performance.now()\n  fn()\n  const end = performance.now()\n\n  const duration = end - start\n  if (duration > 16) {\n    // 60fps threshold\n    console.warn(`ğŸŒ Slow operation: ${name} took ${duration.toFixed(2)}ms`)\n  }\n}\n"},"tags":[],"source":null},{"category":"lint/suspicious/noExplicitAny","severity":"warning","description":"Unexpected any. Specify a different type.","message":[{"elements":[],"content":"Unexpected "},{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":". Specify a different type."}],"advices":{"advices":[{"log":["info",[{"elements":["Emphasis"],"content":"any"},{"elements":[],"content":" disables many type checking rules. Its use should be avoided."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/utils/mobile-performance.ts"},"span":[240,243],"sourceCode":"/**\n * ãƒ¢ãƒã‚¤ãƒ«ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®ãŸã‚ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£\n * ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºã¨ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æ”¹å–„ã™ã‚‹\n */\n\n// ãƒ‡ãƒã‚¦ãƒ³ã‚¹é–¢æ•°\nexport function debounce<T extends (...args: any[]) => any>(\n  func: T,\n  wait: number,\n): (...args: Parameters<T>) => void {\n  let timeout: NodeJS.Timeout\n  return (...args: Parameters<T>) => {\n    clearTimeout(timeout)\n    timeout = setTimeout(() => func(...args), wait)\n  }\n}\n\n// ã‚¹ãƒ­ãƒƒãƒˆãƒ«é–¢æ•°\nexport function throttle<T extends (...args: any[]) => any>(\n  func: T,\n  limit: number,\n): (...args: Parameters<T>) => void {\n  let inThrottle: boolean\n  return (...args: Parameters<T>) => {\n    if (!inThrottle) {\n      func(...args)\n      inThrottle = true\n      setTimeout(() => (inThrottle = false), limit)\n    }\n  }\n}\n\n// ç”»åƒã®äº‹å‰èª­ã¿è¾¼ã¿\nexport function preloadImage(src: string): Promise<void> {\n  return new Promise((resolve, reject) => {\n    const img = new Image()\n    img.onload = () => resolve()\n    img.onerror = () => reject(new Error(`Failed to load image: ${src}`))\n    img.src = src\n  })\n}\n\n// WebP ã‚µãƒãƒ¼ãƒˆã®æ¤œå‡º\nexport function detectWebPSupport(): Promise<boolean> {\n  if (typeof window === \"undefined\") return Promise.resolve(false)\n\n  return new Promise((resolve) => {\n    const webP = new Image()\n    webP.onload = webP.onerror = () => {\n      resolve(webP.height === 2)\n    }\n    webP.src =\n      \"data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA\"\n  })\n}\n\n// ãƒªã‚½ãƒ¼ã‚¹ãƒ’ãƒ³ãƒˆã®è¿½åŠ \nexport function addResourceHint(\n  href: string,\n  rel: \"preload\" | \"prefetch\" | \"dns-prefetch\" | \"preconnect\",\n  as?: string,\n): void {\n  if (typeof document === \"undefined\") return\n\n  const existingLink = document.querySelector(`link[href=\"${href}\"]`)\n  if (existingLink) return\n\n  const link = document.createElement(\"link\")\n  link.rel = rel\n  link.href = href\n  if (as) link.as = as\n\n  document.head.appendChild(link)\n}\n\n// ãƒ¢ãƒã‚¤ãƒ«ãƒ‡ãƒã‚¤ã‚¹ã®æ¤œå‡º\nexport function isMobileDevice(): boolean {\n  if (typeof window === \"undefined\") return false\n\n  return (\n    /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n      navigator.userAgent,\n    ) || window.innerWidth < 768\n  )\n}\n\n// ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºè­¦å‘Šï¼ˆé–‹ç™ºç’°å¢ƒã®ã¿ï¼‰\nexport function warnLargeBundle(componentName: string, sizeKB: number): void {\n  if (process.env.NODE_ENV === \"development\" && sizeKB > 100) {\n    console.warn(\n      `! Large bundle detected: ${componentName} (${sizeKB}KB). Consider code splitting.`,\n    )\n  }\n}\n\n// ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–\nexport function measurePerformance(name: string, fn: () => void): void {\n  if (typeof window === \"undefined\" || process.env.NODE_ENV !== \"development\") {\n    fn()\n    return\n  }\n\n  const start = performance.now()\n  fn()\n  const end = performance.now()\n\n  const duration = end - start\n  if (duration > 16) {\n    // 60fps threshold\n    console.warn(`ğŸŒ Slow operation: ${name} took ${duration.toFixed(2)}ms`)\n  }\n}\n"},"tags":[],"source":null},{"category":"lint/suspicious/noDocumentCookie","severity":"warning","description":"Direct assigning to document.cookie is not recommended.","message":[{"elements":[],"content":"Direct assigning to "},{"elements":["Emphasis"],"content":"document.cookie"},{"elements":[],"content":" is not recommended."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Consider using the "},{"elements":[{"Hyperlink":{"href":"https://developer.mozilla.org/en-US/docs/Web/API/CookieStore"}}],"content":"Cookie Store API"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/utils/reset-cookie-login-token.ts"},"span":[191,268],"sourceCode":"/**\n * Cookieã®ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ã‚’å‰Šé™¤ã™ã‚‹\n */\nexport function resetCookieLoginToken(): void {\n  // Cookieã®expireså±æ€§ã‚’1970-01-01T00:00:00Zã«è¨­å®šã™ã‚‹ã“ã¨ã§å‰Šé™¤ã™ã‚‹\n  document.cookie = \"wordpress.login_token=; max-age=0; domain=.aipictors.com;\"\n}\n"},"tags":[],"source":null},{"category":"lint/suspicious/noDocumentCookie","severity":"warning","description":"Direct assigning to document.cookie is not recommended.","message":[{"elements":[],"content":"Direct assigning to "},{"elements":["Emphasis"],"content":"document.cookie"},{"elements":[],"content":" is not recommended."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Consider using the "},{"elements":[{"Hyperlink":{"href":"https://developer.mozilla.org/en-US/docs/Web/API/CookieStore"}}],"content":"Cookie Store API"},{"elements":[],"content":"."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/utils/set-cookie.ts"},"span":[144,188],"sourceCode":"/**\n * Cookieæƒ…å ±å–å¾—\n */\nexport const setCookie: (name: string, value: number) => void = (\n  name: string,\n  value: number,\n): void => {\n  document.cookie = `${name}=${value}; path=/`\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/useSemanticElements","severity":"error","description":"The elements with this role can be changed to the following elements:\n<button>","message":[{"elements":[],"content":"The elements with this role can be changed to the following elements:\n<button>"}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"For examples and more information, see "},{"elements":[{"Hyperlink":{"href":"https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles"}}],"content":"WAI-ARIA Roles"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/button/follow-button.tsx"},"span":[3926,3939],"sourceCode":"\"use client\"\n\nimport { useMutation } from \"@apollo/client/index\"\nimport { useContext, useEffect, useState } from \"react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { LoginDialogButton } from \"~/components/login-dialog-button\"\nimport { cn } from \"~/lib/utils\"\nimport { graphql } from \"gql.tada\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"~/components/ui/alert-dialog\"\nimport { toast } from \"sonner\"\n\ntype Props = {\n  targetUserId: string\n  isFollow: boolean\n  className?: string\n  triggerChildren?: React.ReactNode\n  unFollowTriggerChildren?: React.ReactNode\n}\n\n/**\n * ãƒ•ã‚©ãƒ­ãƒ¼\n */\nexport function FollowButton (props: Props): React.ReactNode {\n  const authContext = useContext(AuthContext)\n\n  const [isFollow, setIsFollow] = useState(props.isFollow)\n  const [isOpen, setIsOpen] = useState(false)\n  const [_isDeleted, _setIsDeleted] = useState(false)\n\n  const t = useTranslation()\n\n  useEffect(() => {\n    setIsFollow(props.isFollow)\n  }, [props.isFollow])\n\n  const [follow, { loading: isFollowing }] = useMutation(followUserMutation)\n\n  const [unFollow, { loading: isUnFollowing }] =\n    useMutation(unfollowUserMutation)\n\n  const onFollow = async () => {\n    try {\n      const res = await follow({\n        variables: {\n          input: {\n            userId: props.targetUserId,\n          },\n        },\n      })\n      setIsFollow(res.data?.followUser?.isFollowee ?? false)\n      toast.success(t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¾ã—ãŸ\", \"You have followed the user\"))\n    } catch (e) {\n      console.error(e)\n      toast.error(t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to follow the user\"))\n    }\n  }\n\n  const onUnFollow = async () => {\n    try {\n      const res = await unFollow({\n        variables: {\n          input: {\n            userId: props.targetUserId,\n          },\n        },\n      })\n      setIsFollow(res.data?.unfollowUser?.isFollowee ?? false)\n      toast.success(\n        t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã‚’è§£é™¤ã—ã¾ã—ãŸ\", \"You have un followed the user\"),\n      )\n      setIsOpen(false)\n    } catch (e) {\n      console.error(e)\n      toast.error(\n        t(\"ãƒ•ã‚©ãƒ­ãƒ¼è§£é™¤ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to un follow the user\"),\n      )\n    }\n  }\n\n  const triggerNode = props.triggerChildren ?? (\n    <button\n      type=\"button\"\n      onClick={() => {}}\n      className={`h-8 w-full rounded-full bg-clear-bright-blue p-1 font-bold text-white transition duration-500 hover:opacity-80 ${props.className}`}\n    >\n      {t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹\", \"Follow\")}\n    </button>\n  )\n\n  const unFollowTriggerNode = props.unFollowTriggerChildren ?? (\n    <button\n      type=\"button\"\n      onClick={() => {}}\n      className={`h-8 w-full rounded-full bg-gray-500 p-1 font-bold text-white opacity-50 transition duration-500 hover:opacity-30 ${props.className}`}\n    >\n      {t(\"ãƒ•ã‚©ãƒ­ãƒ¼ä¸­\", \"Following\")}\n    </button>\n  )\n\n  /* æœªãƒ­ã‚°ã‚¤ãƒ³ */\n  if (authContext.isLoading || authContext.isNotLoggedIn) {\n    return (\n      <LoginDialogButton\n        label={t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹\", \"Follow\")}\n        isLoading={authContext.isLoading || authContext.isLoggedIn}\n        isWidthFull={true}\n        description={t(\n          \"ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã€ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼\",\n          \"Log in and try following!\",\n        )}\n        triggerChildren={triggerNode}\n      />\n    )\n  }\n\n  /* è‡ªåˆ†è‡ªèº«ã®å ´åˆã¯ãƒ•ã‚©ãƒ­ãƒ¼ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤ºã—ãªã„ */\n  if (authContext.userId === props.targetUserId) {\n    return null\n  }\n\n  return isFollow ? (\n    <AlertDialog open={isOpen} onOpenChange={setIsOpen}>\n      <AlertDialogTrigger asChild>\n        {/* biome-ignore lint/a11y/useSemanticElements: wrapper div avoids nested buttons; keyboard handlers provided */}\n        <div\n          role=\"button\"\n          tabIndex={0}\n          onClick={() => {\n            if (isFollowing || isUnFollowing) return\n            setIsOpen(true)\n          }}\n          onKeyDown={(event) => {\n            if (event.key !== \"Enter\" && event.key !== \" \") return\n            event.preventDefault()\n            if (isFollowing || isUnFollowing) return\n            setIsOpen(true)\n          }}\n          className={cn(isFollowing || isUnFollowing ? \"opacity-80\" : \"\")}\n        >\n          {unFollowTriggerNode}\n        </div>\n      </AlertDialogTrigger>\n      <AlertDialogContent>\n        <AlertDialogHeader>\n          <AlertDialogTitle>{t(\"ç¢ºèª\", \"Confirm\")}</AlertDialogTitle>\n          <AlertDialogDescription>\n            {t(\n              \"æœ¬å½“ã«ãƒ•ã‚©ãƒ­ãƒ¼ã‚’è§£é™¤ã—ã¾ã™ã‹ï¼Ÿ\",\n              \"Are you sure you want to unfollow?\",\n            )}\n          </AlertDialogDescription>\n        </AlertDialogHeader>\n        <AlertDialogFooter>\n          <AlertDialogCancel onClick={() => setIsOpen(false)}>\n            {t(\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\", \"Cancel\")}\n          </AlertDialogCancel>\n          <AlertDialogAction onClick={onUnFollow}>\n            {t(\"è§£é™¤ã™ã‚‹\", \"Unfollow\")}\n          </AlertDialogAction>\n        </AlertDialogFooter>\n      </AlertDialogContent>\n    </AlertDialog>\n  ) : (\n    // biome-ignore lint/a11y/useSemanticElements: wrapper div avoids nested buttons; keyboard handlers provided\n    <div\n      role=\"button\"\n      tabIndex={0}\n      onClick={() => {\n        if (isFollowing || isUnFollowing) return\n        onFollow()\n      }}\n      onKeyDown={(event) => {\n        if (event.key !== \"Enter\" && event.key !== \" \") return\n        event.preventDefault()\n        if (isFollowing || isUnFollowing) return\n        onFollow()\n      }}\n      className={cn(isFollowing || isUnFollowing ? \"opacity-80\" : \"\")}\n    >\n      {triggerNode}\n    </div>\n  )\n}\n\nconst followUserMutation = graphql(\n  `mutation FollowUser($input: FollowUserInput!) {\n    followUser(input: $input) {\n      id\n      isFollowee\n    }\n  }`,\n)\n\nconst unfollowUserMutation = graphql(\n  `mutation UnfollowUser($input: UnfollowUserInput!) {\n    unfollowUser(input: $input) {\n      id\n      isFollowee\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/useSemanticElements","severity":"error","description":"The elements with this role can be changed to the following elements:\n<button>","message":[{"elements":[],"content":"The elements with this role can be changed to the following elements:\n<button>"}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"For examples and more information, see "},{"elements":[{"Hyperlink":{"href":"https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles"}}],"content":"WAI-ARIA Roles"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/button/follow-button.tsx"},"span":[5352,5365],"sourceCode":"\"use client\"\n\nimport { useMutation } from \"@apollo/client/index\"\nimport { useContext, useEffect, useState } from \"react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { LoginDialogButton } from \"~/components/login-dialog-button\"\nimport { cn } from \"~/lib/utils\"\nimport { graphql } from \"gql.tada\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"~/components/ui/alert-dialog\"\nimport { toast } from \"sonner\"\n\ntype Props = {\n  targetUserId: string\n  isFollow: boolean\n  className?: string\n  triggerChildren?: React.ReactNode\n  unFollowTriggerChildren?: React.ReactNode\n}\n\n/**\n * ãƒ•ã‚©ãƒ­ãƒ¼\n */\nexport function FollowButton (props: Props): React.ReactNode {\n  const authContext = useContext(AuthContext)\n\n  const [isFollow, setIsFollow] = useState(props.isFollow)\n  const [isOpen, setIsOpen] = useState(false)\n  const [_isDeleted, _setIsDeleted] = useState(false)\n\n  const t = useTranslation()\n\n  useEffect(() => {\n    setIsFollow(props.isFollow)\n  }, [props.isFollow])\n\n  const [follow, { loading: isFollowing }] = useMutation(followUserMutation)\n\n  const [unFollow, { loading: isUnFollowing }] =\n    useMutation(unfollowUserMutation)\n\n  const onFollow = async () => {\n    try {\n      const res = await follow({\n        variables: {\n          input: {\n            userId: props.targetUserId,\n          },\n        },\n      })\n      setIsFollow(res.data?.followUser?.isFollowee ?? false)\n      toast.success(t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¾ã—ãŸ\", \"You have followed the user\"))\n    } catch (e) {\n      console.error(e)\n      toast.error(t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to follow the user\"))\n    }\n  }\n\n  const onUnFollow = async () => {\n    try {\n      const res = await unFollow({\n        variables: {\n          input: {\n            userId: props.targetUserId,\n          },\n        },\n      })\n      setIsFollow(res.data?.unfollowUser?.isFollowee ?? false)\n      toast.success(\n        t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã‚’è§£é™¤ã—ã¾ã—ãŸ\", \"You have un followed the user\"),\n      )\n      setIsOpen(false)\n    } catch (e) {\n      console.error(e)\n      toast.error(\n        t(\"ãƒ•ã‚©ãƒ­ãƒ¼è§£é™¤ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to un follow the user\"),\n      )\n    }\n  }\n\n  const triggerNode = props.triggerChildren ?? (\n    <button\n      type=\"button\"\n      onClick={() => {}}\n      className={`h-8 w-full rounded-full bg-clear-bright-blue p-1 font-bold text-white transition duration-500 hover:opacity-80 ${props.className}`}\n    >\n      {t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹\", \"Follow\")}\n    </button>\n  )\n\n  const unFollowTriggerNode = props.unFollowTriggerChildren ?? (\n    <button\n      type=\"button\"\n      onClick={() => {}}\n      className={`h-8 w-full rounded-full bg-gray-500 p-1 font-bold text-white opacity-50 transition duration-500 hover:opacity-30 ${props.className}`}\n    >\n      {t(\"ãƒ•ã‚©ãƒ­ãƒ¼ä¸­\", \"Following\")}\n    </button>\n  )\n\n  /* æœªãƒ­ã‚°ã‚¤ãƒ³ */\n  if (authContext.isLoading || authContext.isNotLoggedIn) {\n    return (\n      <LoginDialogButton\n        label={t(\"ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹\", \"Follow\")}\n        isLoading={authContext.isLoading || authContext.isLoggedIn}\n        isWidthFull={true}\n        description={t(\n          \"ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã€ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼\",\n          \"Log in and try following!\",\n        )}\n        triggerChildren={triggerNode}\n      />\n    )\n  }\n\n  /* è‡ªåˆ†è‡ªèº«ã®å ´åˆã¯ãƒ•ã‚©ãƒ­ãƒ¼ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤ºã—ãªã„ */\n  if (authContext.userId === props.targetUserId) {\n    return null\n  }\n\n  return isFollow ? (\n    <AlertDialog open={isOpen} onOpenChange={setIsOpen}>\n      <AlertDialogTrigger asChild>\n        {/* biome-ignore lint/a11y/useSemanticElements: wrapper div avoids nested buttons; keyboard handlers provided */}\n        <div\n          role=\"button\"\n          tabIndex={0}\n          onClick={() => {\n            if (isFollowing || isUnFollowing) return\n            setIsOpen(true)\n          }}\n          onKeyDown={(event) => {\n            if (event.key !== \"Enter\" && event.key !== \" \") return\n            event.preventDefault()\n            if (isFollowing || isUnFollowing) return\n            setIsOpen(true)\n          }}\n          className={cn(isFollowing || isUnFollowing ? \"opacity-80\" : \"\")}\n        >\n          {unFollowTriggerNode}\n        </div>\n      </AlertDialogTrigger>\n      <AlertDialogContent>\n        <AlertDialogHeader>\n          <AlertDialogTitle>{t(\"ç¢ºèª\", \"Confirm\")}</AlertDialogTitle>\n          <AlertDialogDescription>\n            {t(\n              \"æœ¬å½“ã«ãƒ•ã‚©ãƒ­ãƒ¼ã‚’è§£é™¤ã—ã¾ã™ã‹ï¼Ÿ\",\n              \"Are you sure you want to unfollow?\",\n            )}\n          </AlertDialogDescription>\n        </AlertDialogHeader>\n        <AlertDialogFooter>\n          <AlertDialogCancel onClick={() => setIsOpen(false)}>\n            {t(\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\", \"Cancel\")}\n          </AlertDialogCancel>\n          <AlertDialogAction onClick={onUnFollow}>\n            {t(\"è§£é™¤ã™ã‚‹\", \"Unfollow\")}\n          </AlertDialogAction>\n        </AlertDialogFooter>\n      </AlertDialogContent>\n    </AlertDialog>\n  ) : (\n    // biome-ignore lint/a11y/useSemanticElements: wrapper div avoids nested buttons; keyboard handlers provided\n    <div\n      role=\"button\"\n      tabIndex={0}\n      onClick={() => {\n        if (isFollowing || isUnFollowing) return\n        onFollow()\n      }}\n      onKeyDown={(event) => {\n        if (event.key !== \"Enter\" && event.key !== \" \") return\n        event.preventDefault()\n        if (isFollowing || isUnFollowing) return\n        onFollow()\n      }}\n      className={cn(isFollowing || isUnFollowing ? \"opacity-80\" : \"\")}\n    >\n      {triggerNode}\n    </div>\n  )\n}\n\nconst followUserMutation = graphql(\n  `mutation FollowUser($input: FollowUserInput!) {\n    followUser(input: $input) {\n      id\n      isFollowee\n    }\n  }`,\n)\n\nconst unfollowUserMutation = graphql(\n  `mutation UnfollowUser($input: UnfollowUserInput!) {\n    unfollowUser(input: $input) {\n      id\n      isFollowee\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/useSemanticElements","severity":"error","description":"The elements with this role can be changed to the following elements:\n<button>","message":[{"elements":[],"content":"The elements with this role can be changed to the following elements:\n<button>"}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"For examples and more information, see "},{"elements":[{"Hyperlink":{"href":"https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles"}}],"content":"WAI-ARIA Roles"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/button/tag-follow-button.tsx"},"span":[3576,3589],"sourceCode":"import { useMutation } from \"@apollo/client/index\"\nimport { useContext, useEffect, useState } from \"react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { LoginDialogButton } from \"~/components/login-dialog-button\"\nimport { cn } from \"~/lib/utils\"\nimport { graphql } from \"gql.tada\"\nimport { toast } from \"sonner\"\nimport { CrossPlatformTooltip } from \"~/components/cross-platform-tooltip\"\nimport { useTranslation } from \"~/hooks/use-translation\" // ç¿»è¨³å¯¾å¿œ\n\ntype Props = {\n  tag: string\n  isFollow: boolean\n  className?: string\n  triggerChildren?: React.ReactNode\n  unFollowTriggerChildren?: React.ReactNode\n}\n\n/**\n * ã‚¿ã‚°ãŠæ°—ã«å…¥ã‚Šç™»éŒ²\n */\nexport function TagFollowButton (props: Props): React.ReactNode {\n  const t = useTranslation() // ç¿»è¨³ãƒ•ãƒƒã‚¯\n  const authContext = useContext(AuthContext)\n\n  const [isFollow, setIsFollow] = useState(props.isFollow)\n\n  useEffect(() => {\n    setIsFollow(props.isFollow)\n  }, [props.isFollow])\n\n  const [follow, { loading: isFollowing }] = useMutation(followTagMutation)\n  const [unFollow, { loading: isUnFollowing }] =\n    useMutation(unfollowTagMutation)\n\n  const onFollow = async () => {\n    try {\n      const _res = await follow({\n        variables: {\n          input: {\n            tagName: props.tag,\n          },\n        },\n      })\n      setIsFollow(true)\n    } catch (e) {\n      console.error(e)\n      toast.error(t(\"ãŠæ°—ã«å…¥ã‚Šç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to follow tag\"))\n    }\n  }\n\n  const onUnFollow = async () => {\n    try {\n      const _res = await unFollow({\n        variables: {\n          input: {\n            tagName: props.tag,\n          },\n        },\n      })\n      setIsFollow(false)\n    } catch (e) {\n      console.error(e)\n      toast.error(t(\"ãŠæ°—ã«å…¥ã‚Šè§£é™¤ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to unfollow tag\"))\n    }\n  }\n\n  const triggerNode = props.triggerChildren ?? (\n    <button\n      type=\"button\"\n      onClick={onFollow}\n      className={cn(\n        \"h-10 w-full rounded-full bg-clear-bright-blue p-1 font-bold text-white transition duration-500 hover:opacity-80\",\n        props.className,\n      )}\n    >\n      {t(\"ãŠæ°—ã«å…¥ã‚Šç™»éŒ²\", \"Follow\")}\n    </button>\n  )\n\n  const unFollowTriggerNode = props.unFollowTriggerChildren ?? (\n    <button\n      type=\"button\"\n      onClick={onUnFollow}\n      className={cn(\n        \"h-10 w-full rounded-full bg-gray-500 p-1 font-bold text-white opacity-50 transition duration-500 hover:opacity-30\",\n        props.className,\n      )}\n    >\n      {t(\"ãŠæ°—ã«å…¥ã‚Šè§£é™¤\", \"Unfollow\")}\n    </button>\n  )\n\n  /* æœªãƒ­ã‚°ã‚¤ãƒ³ */\n  if (authContext.isLoading || authContext.isNotLoggedIn) {\n    return (\n      <LoginDialogButton\n        label={t(\"ãŠæ°—ã«å…¥ã‚Šç™»éŒ²\", \"Follow\")}\n        isLoading={authContext.isLoading || authContext.isLoggedIn}\n        isWidthFull={true}\n        description={t(\n          \"ã‚¿ã‚°ã‚’ãŠæ°—ã«å…¥ã‚Šç™»éŒ²ã—ã¦æŠ•ç¨¿ã‚’ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼\",\n          \"Follow tags to see related posts!\",\n        )}\n        triggerChildren={triggerNode}\n      />\n    )\n  }\n\n  if (!props.tag) {\n    return null\n  }\n\n  return (\n    <div className=\"flex w-full items-center space-x-2\">\n      <CrossPlatformTooltip\n        text={t(\n          \"ã‚¿ã‚°ã®ã¤ã„ãŸæ–°ç€ä½œå“ã‚’ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã§ãƒã‚§ãƒƒã‚¯ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™\",\n          \"You can check new works with this tag in your timeline\",\n        )}\n      />\n      {isFollow ? (\n        // biome-ignore lint/a11y/useSemanticElements: wrapper div avoids nested buttons; keyboard handlers provided\n        <div\n          role=\"button\"\n          tabIndex={0}\n          onClick={() => {\n            if (isFollowing || isUnFollowing) return\n            onUnFollow()\n          }}\n          onKeyDown={(event) => {\n            if (event.key !== \"Enter\" && event.key !== \" \") return\n            event.preventDefault()\n            if (isFollowing || isUnFollowing) return\n            onUnFollow()\n          }}\n          className={cn(\n            isFollowing || isUnFollowing ? \"w-full opacity-80\" : \" w-full\",\n          )}\n        >\n          {unFollowTriggerNode}\n        </div>\n      ) : (\n        // biome-ignore lint/a11y/useSemanticElements: wrapper div avoids nested buttons; keyboard handlers provided\n        <div\n          role=\"button\"\n          tabIndex={0}\n          onClick={() => {\n            if (isFollowing || isUnFollowing) return\n            onFollow()\n          }}\n          onKeyDown={(event) => {\n            if (event.key !== \"Enter\" && event.key !== \" \") return\n            event.preventDefault()\n            if (isFollowing || isUnFollowing) return\n            onFollow()\n          }}\n          className={cn(\n            isFollowing || isUnFollowing ? \"w-full opacity-80\" : \" w-full\",\n          )}\n        >\n          {triggerNode}\n        </div>\n      )}\n    </div>\n  )\n}\n\nconst followTagMutation = graphql(\n  `mutation FollowTag($input: FollowTagInput!) {\n    followTag(input: $input)\n  }`,\n)\n\nconst unfollowTagMutation = graphql(\n  `mutation UnFollowTag($input: UnfollowTagInput!) {\n    unfollowTag(input: $input)\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/useSemanticElements","severity":"error","description":"The elements with this role can be changed to the following elements:\n<button>","message":[{"elements":[],"content":"The elements with this role can be changed to the following elements:\n<button>"}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"For examples and more information, see "},{"elements":[{"Hyperlink":{"href":"https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles"}}],"content":"WAI-ARIA Roles"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/button/tag-follow-button.tsx"},"span":[4281,4294],"sourceCode":"import { useMutation } from \"@apollo/client/index\"\nimport { useContext, useEffect, useState } from \"react\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { LoginDialogButton } from \"~/components/login-dialog-button\"\nimport { cn } from \"~/lib/utils\"\nimport { graphql } from \"gql.tada\"\nimport { toast } from \"sonner\"\nimport { CrossPlatformTooltip } from \"~/components/cross-platform-tooltip\"\nimport { useTranslation } from \"~/hooks/use-translation\" // ç¿»è¨³å¯¾å¿œ\n\ntype Props = {\n  tag: string\n  isFollow: boolean\n  className?: string\n  triggerChildren?: React.ReactNode\n  unFollowTriggerChildren?: React.ReactNode\n}\n\n/**\n * ã‚¿ã‚°ãŠæ°—ã«å…¥ã‚Šç™»éŒ²\n */\nexport function TagFollowButton (props: Props): React.ReactNode {\n  const t = useTranslation() // ç¿»è¨³ãƒ•ãƒƒã‚¯\n  const authContext = useContext(AuthContext)\n\n  const [isFollow, setIsFollow] = useState(props.isFollow)\n\n  useEffect(() => {\n    setIsFollow(props.isFollow)\n  }, [props.isFollow])\n\n  const [follow, { loading: isFollowing }] = useMutation(followTagMutation)\n  const [unFollow, { loading: isUnFollowing }] =\n    useMutation(unfollowTagMutation)\n\n  const onFollow = async () => {\n    try {\n      const _res = await follow({\n        variables: {\n          input: {\n            tagName: props.tag,\n          },\n        },\n      })\n      setIsFollow(true)\n    } catch (e) {\n      console.error(e)\n      toast.error(t(\"ãŠæ°—ã«å…¥ã‚Šç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to follow tag\"))\n    }\n  }\n\n  const onUnFollow = async () => {\n    try {\n      const _res = await unFollow({\n        variables: {\n          input: {\n            tagName: props.tag,\n          },\n        },\n      })\n      setIsFollow(false)\n    } catch (e) {\n      console.error(e)\n      toast.error(t(\"ãŠæ°—ã«å…¥ã‚Šè§£é™¤ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Failed to unfollow tag\"))\n    }\n  }\n\n  const triggerNode = props.triggerChildren ?? (\n    <button\n      type=\"button\"\n      onClick={onFollow}\n      className={cn(\n        \"h-10 w-full rounded-full bg-clear-bright-blue p-1 font-bold text-white transition duration-500 hover:opacity-80\",\n        props.className,\n      )}\n    >\n      {t(\"ãŠæ°—ã«å…¥ã‚Šç™»éŒ²\", \"Follow\")}\n    </button>\n  )\n\n  const unFollowTriggerNode = props.unFollowTriggerChildren ?? (\n    <button\n      type=\"button\"\n      onClick={onUnFollow}\n      className={cn(\n        \"h-10 w-full rounded-full bg-gray-500 p-1 font-bold text-white opacity-50 transition duration-500 hover:opacity-30\",\n        props.className,\n      )}\n    >\n      {t(\"ãŠæ°—ã«å…¥ã‚Šè§£é™¤\", \"Unfollow\")}\n    </button>\n  )\n\n  /* æœªãƒ­ã‚°ã‚¤ãƒ³ */\n  if (authContext.isLoading || authContext.isNotLoggedIn) {\n    return (\n      <LoginDialogButton\n        label={t(\"ãŠæ°—ã«å…¥ã‚Šç™»éŒ²\", \"Follow\")}\n        isLoading={authContext.isLoading || authContext.isLoggedIn}\n        isWidthFull={true}\n        description={t(\n          \"ã‚¿ã‚°ã‚’ãŠæ°—ã«å…¥ã‚Šç™»éŒ²ã—ã¦æŠ•ç¨¿ã‚’ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼\",\n          \"Follow tags to see related posts!\",\n        )}\n        triggerChildren={triggerNode}\n      />\n    )\n  }\n\n  if (!props.tag) {\n    return null\n  }\n\n  return (\n    <div className=\"flex w-full items-center space-x-2\">\n      <CrossPlatformTooltip\n        text={t(\n          \"ã‚¿ã‚°ã®ã¤ã„ãŸæ–°ç€ä½œå“ã‚’ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã§ãƒã‚§ãƒƒã‚¯ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™\",\n          \"You can check new works with this tag in your timeline\",\n        )}\n      />\n      {isFollow ? (\n        // biome-ignore lint/a11y/useSemanticElements: wrapper div avoids nested buttons; keyboard handlers provided\n        <div\n          role=\"button\"\n          tabIndex={0}\n          onClick={() => {\n            if (isFollowing || isUnFollowing) return\n            onUnFollow()\n          }}\n          onKeyDown={(event) => {\n            if (event.key !== \"Enter\" && event.key !== \" \") return\n            event.preventDefault()\n            if (isFollowing || isUnFollowing) return\n            onUnFollow()\n          }}\n          className={cn(\n            isFollowing || isUnFollowing ? \"w-full opacity-80\" : \" w-full\",\n          )}\n        >\n          {unFollowTriggerNode}\n        </div>\n      ) : (\n        // biome-ignore lint/a11y/useSemanticElements: wrapper div avoids nested buttons; keyboard handlers provided\n        <div\n          role=\"button\"\n          tabIndex={0}\n          onClick={() => {\n            if (isFollowing || isUnFollowing) return\n            onFollow()\n          }}\n          onKeyDown={(event) => {\n            if (event.key !== \"Enter\" && event.key !== \" \") return\n            event.preventDefault()\n            if (isFollowing || isUnFollowing) return\n            onFollow()\n          }}\n          className={cn(\n            isFollowing || isUnFollowing ? \"w-full opacity-80\" : \" w-full\",\n          )}\n        >\n          {triggerNode}\n        </div>\n      )}\n    </div>\n  )\n}\n\nconst followTagMutation = graphql(\n  `mutation FollowTag($input: FollowTagInput!) {\n    followTag(input: $input)\n  }`,\n)\n\nconst unfollowTagMutation = graphql(\n  `mutation UnFollowTag($input: UnfollowTagInput!) {\n    unfollowTag(input: $input)\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/expansion-transition.tsx"},"span":[1340,1376],"sourceCode":"import type React from \"react\"\nimport { useState, useRef, useEffect } from \"react\"\n\ntype Props = {\n  triggerChildren: React.ReactNode\n  children: React.ReactNode\n  oneTimeExpand?: boolean // ä¸€åº¦åˆ‡ã‚Šã®å±•é–‹ãƒ•ãƒ©ã‚°\n  onExpandChange?: (isOpen: boolean) => void\n  className?: string\n  hidden?: boolean\n}\n\nexport function ExpansionTransition (props: Props): React.ReactNode {\n  const [isFilterOpen, setIsFilterOpen] = useState(false)\n  const [hasExpanded, setHasExpanded] = useState(false) // è¿½åŠ : å±•é–‹æ¸ˆã¿ãƒ•ãƒ©ã‚°\n  const [maxHeight, setMaxHeight] = useState(\"0px\")\n  const [opacity, setOpacity] = useState(0)\n  const contentRef = useRef<HTMLDivElement>(null)\n\n  useEffect(() => {\n    if (isFilterOpen && contentRef.current) {\n      setMaxHeight(`${contentRef.current.scrollHeight}px`)\n      setOpacity(1)\n      if (props.oneTimeExpand) {\n        setHasExpanded(true)\n      }\n    } else {\n      setMaxHeight(\"0px\")\n      setOpacity(0)\n    }\n  }, [isFilterOpen, props.oneTimeExpand])\n\n  const onToggleFilterButton = () => {\n    if (!hasExpanded || !props.oneTimeExpand) {\n      setIsFilterOpen(!isFilterOpen)\n      if (props.onExpandChange) {\n        props.onExpandChange(!isFilterOpen)\n      }\n    }\n  }\n\n  return (\n    <>\n      {!hasExpanded && (\n        // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n        <div onClick={onToggleFilterButton}>{props.triggerChildren}</div>\n      )}\n      {isFilterOpen && (\n        <div\n          ref={contentRef}\n          style={{\n            maxHeight: maxHeight,\n            opacity: opacity,\n            overflow: props.hidden ? \"hidden\" : \"visible\",\n            transition: \"max-height 0.5s ease, opacity 0.5s ease\",\n          }}\n          className={props.className}\n        >\n          {props.children}\n        </div>\n      )}\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/suspicious/noArrayIndexKey","severity":"error","description":"Avoid using the index of an array as key property in an element.","message":[{"elements":[],"content":"Avoid using the index of an array as key property in an element."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"This is the source of the key value."}]]},{"frame":{"path":null,"span":[1955,1965],"sourceCode":"import { memo, useMemo } from \"react\"\nimport { LazyLoadComponent } from \"~/components/lazy-load-component\"\nimport { OptimizedImage } from \"~/components/optimized-image\"\nimport { cn } from \"~/lib/utils\"\nimport { debounce } from \"~/utils/mobile-performance\"\n\ntype Work = {\n  id: string\n  title: string\n  imageUrl: string\n  width: number\n  height: number\n  userId?: string\n  userName?: string\n  userIcon?: string\n}\n\ntype Props = {\n  works: Work[]\n  loading?: boolean\n  onWorkClick?: (workId: string) => void\n  gridCols?: 2 | 3 | 4 | 5\n  itemHeight?: number\n}\n\n/**\n * ãƒ¢ãƒã‚¤ãƒ«ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã•ã‚ŒãŸä½œå“ã‚°ãƒªãƒƒãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ\n * - Intersection Observer ã«ã‚ˆã‚‹æ®µéšçš„èª­ã¿è¾¼ã¿\n * - debounced ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆ\n * - optimized image loading\n */\nexport const OptimizedWorkGrid = memo((props: Props) => {\n  const {\n    works,\n    loading = false,\n    gridCols = 3,\n    itemHeight = 200,\n    onWorkClick,\n  } = props\n\n  // ã‚°ãƒªãƒƒãƒ‰ã‚’ãƒãƒ£ãƒ³ã‚¯ã«åˆ†å‰²ã—ã¦æ®µéšçš„ã«èª­ã¿è¾¼ã¿\n  const chunkedWorks = useMemo(() => {\n    const chunkSize = 6 // ä¸€åº¦ã«èª­ã¿è¾¼ã‚€ä½œå“æ•°\n    const chunks: Work[][] = []\n    for (let i = 0; i < works.length; i += chunkSize) {\n      chunks.push(works.slice(i, i + chunkSize))\n    }\n    return chunks\n  }, [works])\n\n  // debounced click handler\n  const debouncedClick = useMemo(\n    () =>\n      debounce((workId: string) => {\n        onWorkClick?.(workId)\n      }, 300),\n    [onWorkClick],\n  )\n\n  const gridClass = cn(\"grid gap-2 md:gap-3\", {\n    \"grid-cols-2\": gridCols === 2,\n    \"grid-cols-3\": gridCols === 3,\n    \"grid-cols-4\": gridCols === 4,\n    \"grid-cols-5\": gridCols === 5,\n  })\n\n  if (loading) {\n    return (\n      <div className=\"flex justify-center py-8\">\n        <div className=\"size-8 animate-spin rounded-full border-4 border-muted border-t-primary\" />\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {chunkedWorks.map((chunk, chunkIndex) => (\n        <LazyLoadComponent\n          key={chunkIndex}\n          threshold={0.1}\n          rootMargin=\"200px\"\n          disableOnServer={true} // SSRå¯¾å¿œã§ãƒã‚«ãƒã‚«é˜²æ­¢\n          fallback={null} // fallbackã¯è¡¨ç¤ºã›ãšãƒã‚«ãƒã‚«ã‚’é˜²ã\n        >\n          <div className={gridClass}>\n            {chunk.map((work) => (\n              <WorkItem\n                key={work.id}\n                work={work}\n                itemHeight={itemHeight}\n                onClick={() => debouncedClick(work.id)}\n              />\n            ))}\n          </div>\n        </LazyLoadComponent>\n      ))}\n    </div>\n  )\n})\n\nconst WorkItem = memo(\n  ({\n    work,\n    itemHeight,\n    onClick,\n  }: {\n    work: Work\n    itemHeight: number\n    onClick: () => void\n  }) => {\n    return (\n      <button\n        type=\"button\"\n        className=\"group relative overflow-hidden rounded-lg transition-transform duration-200 hover:scale-105\"\n        onClick={onClick}\n        style={{ height: itemHeight }}\n      >\n        <OptimizedImage\n          src={work.imageUrl}\n          alt={work.title}\n          width={work.width}\n          height={work.height}\n          loading=\"lazy\"\n          className=\"h-full w-full object-cover\"\n        />\n\n        {/* ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */}\n        <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 transition-opacity duration-200 group-hover:opacity-100\" />\n\n        {/* ã‚¿ã‚¤ãƒˆãƒ« */}\n        <div className=\"absolute right-2 bottom-2 left-2 translate-y-full transform transition-transform duration-200 group-hover:translate-y-0\">\n          <p className=\"truncate font-medium text-sm text-white\">\n            {work.title}\n          </p>\n          {work.userName && (\n            <p className=\"truncate text-white/80 text-xs\">{work.userName}</p>\n          )}\n        </div>\n      </button>\n    )\n  },\n)\n\nOptimizedWorkGrid.displayName = \"OptimizedWorkGrid\"\nWorkItem.displayName = \"WorkItem\"\n"}},{"log":["info",[{"elements":[],"content":"The order of the items may change, and this also affects performances and component state."}]]},{"log":["info",[{"elements":[],"content":"Check the "},{"elements":[{"Hyperlink":{"href":"https://reactjs.org/docs/lists-and-keys.html#keys"}}],"content":"React documentation"},{"elements":[],"content":". "}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/optimized-work-grid.tsx"},"span":[2014,2024],"sourceCode":"import { memo, useMemo } from \"react\"\nimport { LazyLoadComponent } from \"~/components/lazy-load-component\"\nimport { OptimizedImage } from \"~/components/optimized-image\"\nimport { cn } from \"~/lib/utils\"\nimport { debounce } from \"~/utils/mobile-performance\"\n\ntype Work = {\n  id: string\n  title: string\n  imageUrl: string\n  width: number\n  height: number\n  userId?: string\n  userName?: string\n  userIcon?: string\n}\n\ntype Props = {\n  works: Work[]\n  loading?: boolean\n  onWorkClick?: (workId: string) => void\n  gridCols?: 2 | 3 | 4 | 5\n  itemHeight?: number\n}\n\n/**\n * ãƒ¢ãƒã‚¤ãƒ«ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã•ã‚ŒãŸä½œå“ã‚°ãƒªãƒƒãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ\n * - Intersection Observer ã«ã‚ˆã‚‹æ®µéšçš„èª­ã¿è¾¼ã¿\n * - debounced ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆ\n * - optimized image loading\n */\nexport const OptimizedWorkGrid = memo((props: Props) => {\n  const {\n    works,\n    loading = false,\n    gridCols = 3,\n    itemHeight = 200,\n    onWorkClick,\n  } = props\n\n  // ã‚°ãƒªãƒƒãƒ‰ã‚’ãƒãƒ£ãƒ³ã‚¯ã«åˆ†å‰²ã—ã¦æ®µéšçš„ã«èª­ã¿è¾¼ã¿\n  const chunkedWorks = useMemo(() => {\n    const chunkSize = 6 // ä¸€åº¦ã«èª­ã¿è¾¼ã‚€ä½œå“æ•°\n    const chunks: Work[][] = []\n    for (let i = 0; i < works.length; i += chunkSize) {\n      chunks.push(works.slice(i, i + chunkSize))\n    }\n    return chunks\n  }, [works])\n\n  // debounced click handler\n  const debouncedClick = useMemo(\n    () =>\n      debounce((workId: string) => {\n        onWorkClick?.(workId)\n      }, 300),\n    [onWorkClick],\n  )\n\n  const gridClass = cn(\"grid gap-2 md:gap-3\", {\n    \"grid-cols-2\": gridCols === 2,\n    \"grid-cols-3\": gridCols === 3,\n    \"grid-cols-4\": gridCols === 4,\n    \"grid-cols-5\": gridCols === 5,\n  })\n\n  if (loading) {\n    return (\n      <div className=\"flex justify-center py-8\">\n        <div className=\"size-8 animate-spin rounded-full border-4 border-muted border-t-primary\" />\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {chunkedWorks.map((chunk, chunkIndex) => (\n        <LazyLoadComponent\n          key={chunkIndex}\n          threshold={0.1}\n          rootMargin=\"200px\"\n          disableOnServer={true} // SSRå¯¾å¿œã§ãƒã‚«ãƒã‚«é˜²æ­¢\n          fallback={null} // fallbackã¯è¡¨ç¤ºã›ãšãƒã‚«ãƒã‚«ã‚’é˜²ã\n        >\n          <div className={gridClass}>\n            {chunk.map((work) => (\n              <WorkItem\n                key={work.id}\n                work={work}\n                itemHeight={itemHeight}\n                onClick={() => debouncedClick(work.id)}\n              />\n            ))}\n          </div>\n        </LazyLoadComponent>\n      ))}\n    </div>\n  )\n})\n\nconst WorkItem = memo(\n  ({\n    work,\n    itemHeight,\n    onClick,\n  }: {\n    work: Work\n    itemHeight: number\n    onClick: () => void\n  }) => {\n    return (\n      <button\n        type=\"button\"\n        className=\"group relative overflow-hidden rounded-lg transition-transform duration-200 hover:scale-105\"\n        onClick={onClick}\n        style={{ height: itemHeight }}\n      >\n        <OptimizedImage\n          src={work.imageUrl}\n          alt={work.title}\n          width={work.width}\n          height={work.height}\n          loading=\"lazy\"\n          className=\"h-full w-full object-cover\"\n        />\n\n        {/* ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */}\n        <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 transition-opacity duration-200 group-hover:opacity-100\" />\n\n        {/* ã‚¿ã‚¤ãƒˆãƒ« */}\n        <div className=\"absolute right-2 bottom-2 left-2 translate-y-full transform transition-transform duration-200 group-hover:translate-y-0\">\n          <p className=\"truncate font-medium text-sm text-white\">\n            {work.title}\n          </p>\n          {work.userName && (\n            <p className=\"truncate text-white/80 text-xs\">{work.userName}</p>\n          )}\n        </div>\n      </button>\n    )\n  },\n)\n\nOptimizedWorkGrid.displayName = \"OptimizedWorkGrid\"\nWorkItem.displayName = \"WorkItem\"\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/paint-canvas.tsx"},"span":[40454,42373],"sourceCode":"import type React from \"react\"\nimport { useEffect, useRef, useState } from \"react\"\nimport { Button } from \"~/components/ui/button\"\nimport {\n  BrushIcon,\n  EraserIcon,\n  LassoIcon,\n  MoveIcon,\n  RotateCwIcon,\n  RotateCcwIcon,\n  ZoomInIcon,\n  ZoomOutIcon,\n  FilterIcon,\n  XIcon,\n} from \"lucide-react\"\nimport { Slider } from \"~/components/ui/slider\"\nimport { cn } from \"~/lib/utils\"\nimport MosaicCanvas from \"~/components/mosaic-canvas\"\nimport { ImageFilterPanel } from \"~/components/image-filter-panel\"\nimport { applyImageFilter, type FilterType } from \"~/utils/image-filter-utils\"\n\ntype Props = {\n  width?: number // ã‚­ãƒ£ãƒ³ãƒã‚¹ã®æ¨ªå¹…\n  height?: number // ã‚­ãƒ£ãƒ³ãƒã‚¹ã®ç«‹å¹…\n  imageUrl?: string // ç”»åƒã®URL\n  isMosaicMode?: boolean\n  isColorPicker?: boolean\n  isBackground?: boolean\n  isBackgroundColorPicker?: boolean\n  isShowSubmitButton?: boolean\n  isPadding?: boolean\n  imageBase64?: string\n  backImageBase64?: string\n  onChangeBrushImageBase64?(value: string): void\n  onChangeSetDrawing?(value: boolean): void // æç”»ä¸­ã‹ã©ã†ã‹ã®çŠ¶æ…‹ã‚’å¤‰æ›´ã™ã‚‹é–¢æ•°\n  onChangeCompositionCanvasBase64?(value: string): void // åˆæˆç”»åƒã®base64ã‚’å¤‰æ›´ã™ã‚‹é–¢æ•°\n  onSubmit?(value: string): void\n  onClose?(): void\n  setBackImageBase64?(value: string): void\n  extension?: string // ä¿å­˜ã™ã‚‹æ‹¡å¼µå­\n  onChangeMosaicMode?(isMosaicMode: boolean): void // ãƒ¢ã‚¶ã‚¤ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®åˆ‡ã‚Šæ›¿ãˆ\n}\n\n// Canvas æç”»çŠ¶æ…‹ã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹\ninterface CanvasState {\n  dataUrl: string // Canvas ã®ãƒ‡ãƒ¼ã‚¿ URL\n  width: number // Canvas ã®å¹…\n  height: number // Canvas ã®é«˜ã•\n}\n\n/**\n * ãƒšã‚¤ãƒ³ãƒˆæ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹ã€ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã‚‚æä¾›ã™ã‚‹\n */\nexport function PaintCanvas (props: Props): React.ReactNode {\n  const imageCanvasRef = useRef<HTMLCanvasElement | null>(null)\n  const brushCanvasRef = useRef<HTMLCanvasElement | null>(null)\n  const assistedCanvasRef = useRef<HTMLCanvasElement | null>(null)\n  const backgroundCanvasRef = useRef<HTMLCanvasElement | null>(null)\n  const previewCanvasRef = useRef<HTMLCanvasElement | null>(null)\n\n  // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰å‰å›ã®ãƒ„ãƒ¼ãƒ«çŠ¶æ…‹ã‚’å¾©å…ƒ\n  const getStoredTool = () => {\n    if (typeof window === \"undefined\")\n      return props.isMosaicMode ? \"eraser\" : \"brush\"\n    const stored = localStorage.getItem(\"paint-canvas-tool\")\n    if (\n      stored &&\n      (stored === \"brush\" ||\n        stored === \"eraser\" ||\n        stored === \"lasso\" ||\n        stored === \"select\" ||\n        stored === \"lasso-mosaic\")\n    ) {\n      // ãƒ¢ã‚¶ã‚¤ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®å ´åˆã¯é©åˆ‡ãªãƒ„ãƒ¼ãƒ«ã«å¤‰æ›\n      if (props.isMosaicMode) {\n        if (stored === \"brush\") return \"eraser\"\n        if (stored === \"lasso\") return \"lasso-mosaic\"\n        return stored\n      }\n      // é€šå¸¸ãƒ¢ãƒ¼ãƒ‰ã®å ´åˆã¯ãƒ¢ã‚¶ã‚¤ã‚¯å°‚ç”¨ãƒ„ãƒ¼ãƒ«ã‚’å¤‰æ›\n      if (!props.isMosaicMode && stored === \"lasso-mosaic\") return \"lasso\"\n      return stored\n    }\n    return props.isMosaicMode ? \"eraser\" : \"brush\"\n  }\n\n  const getStoredColor = () => {\n    if (typeof window === \"undefined\") return \"#000000\"\n    return localStorage.getItem(\"paint-canvas-color\") || \"#000000\"\n  }\n\n  const getStoredBrushSize = () => {\n    if (typeof window === \"undefined\") return 20\n    const stored = localStorage.getItem(\"paint-canvas-brush-size\")\n    return stored ? Number(stored) : 20\n  }\n\n  const [tool, setTool] = useState(getStoredTool())\n  const [color, setColor] = useState(getStoredColor()) // ãƒ–ãƒ©ã‚·ã®åˆæœŸè‰²\n  const [brushSize, setBrushSize] = useState<number>(getStoredBrushSize())\n  const [scale, setScale] = useState<number>(1)\n  const [translateX, setTranslateX] = useState<number>(0)\n  const [translateY, setTranslateY] = useState<number>(0)\n\n  // ãƒ‘ãƒ³æ“ä½œç”¨ã®çŠ¶æ…‹\n  const [isPanning, setIsPanning] = useState<boolean>(false)\n  const [panStart, setPanStart] = useState<{ x: number; y: number }>({\n    x: 0,\n    y: 0,\n  })\n  const [panStartTranslate, setPanStartTranslate] = useState<{\n    x: number\n    y: number\n  }>({ x: 0, y: 0 })\n  // æç”»çŠ¶æ…‹ã®ç®¡ç†ï¼ˆãƒ‘ãƒ³æ“ä½œã¨ã®ç«¶åˆã‚’é˜²ããŸã‚ï¼‰\n  const [isDrawing, setIsDrawing] = useState<boolean>(false)\n\n  const [points, setPoints] = useState<{ x: number; y: number }[]>([]) // çŠ¶æ…‹ã¨ã—ã¦ãƒã‚¤ãƒ³ãƒˆã‚’ä¿å­˜\n  const [canvasWidth, setCanvasWidth] = useState<number>(props.width || 240)\n  const [canvasHeight, setCanvasHeight] = useState<number>(props.height || 360)\n  const [backgroundColor] = useState(\"#fff\")\n  const [mosaicCanvasRef, setMosaicCanvasRef] =\n    useState<HTMLCanvasElement | null>(null)\n\n  // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ©Ÿèƒ½ã®çŠ¶æ…‹\n  const [brightness, setBrightness] = useState<number>(100)\n  const [contrast, setContrast] = useState<number>(100)\n  const [saturation, setSaturation] = useState<number>(100)\n  const [hue, setHue] = useState<number>(0)\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState<boolean>(false)\n  const [isAdvancedFilterPanelOpen, setIsAdvancedFilterPanelOpen] =\n    useState<boolean>(false)\n  const [appliedFilters, setAppliedFilters] = useState<\n    { type: FilterType; intensity: number }[]\n  >([])\n\n  // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨å‰ã®å…ƒç”»åƒã‚’ä¿å­˜\n  const [originalImageData, setOriginalImageData] = useState<ImageData | null>(\n    null,\n  )\n\n  // ãƒ¢ã‚¶ã‚¤ã‚¯ãŒé©ç”¨ã•ã‚ŒãŸã‹ã‚’è¿½è·¡\n  const [isMosaicApplied, setIsMosaicApplied] = useState<boolean>(false)\n\n  // Canvas æç”»çŠ¶æ…‹ã®é…åˆ—\n  const [canvasStates, setCanvasStates] = useState<CanvasState[]>([])\n  // ç¾åœ¨ã® Canvas ã®çŠ¶æ…‹ã‚’ç¤ºã™ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹\n  const [stateIndex, setStateIndex] = useState<number>(0)\n\n  // ãƒ„ãƒ¼ãƒ«ãŒå¤‰æ›´ã•ã‚ŒãŸæ™‚ã«ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜\n  useEffect(() => {\n    if (typeof window !== \"undefined\") {\n      localStorage.setItem(\"paint-canvas-tool\", tool)\n    }\n  }, [tool])\n\n  // è‰²ãŒå¤‰æ›´ã•ã‚ŒãŸæ™‚ã«ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜\n  useEffect(() => {\n    if (typeof window !== \"undefined\") {\n      localStorage.setItem(\"paint-canvas-color\", color)\n    }\n  }, [color])\n\n  // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ‘ãƒãƒ«ãŒé–‹ã„ã¦ã„ã‚‹æ™‚ã«ãƒ¢ã‚¶ã‚¤ã‚¯ãƒ„ãƒ¼ãƒ«ã‹ã‚‰åˆ‡ã‚Šæ›¿ãˆ\n  useEffect(() => {\n    if (\n      props.isMosaicMode &&\n      isFilterPanelOpen &&\n      (tool === \"eraser\" || tool === \"lasso-mosaic\")\n    ) {\n      setTool(\"select\")\n    }\n  }, [isFilterPanelOpen, props.isMosaicMode, tool])\n\n  // ãƒ¢ã‚¶ã‚¤ã‚¯ãƒ¢ãƒ¼ãƒ‰ãŒå¤‰æ›´ã•ã‚ŒãŸæ™‚ã®å‡¦ç†\n  useEffect(() => {\n    if (!props.isMosaicMode) {\n      // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ã‚ã£ãŸæ™‚ã¯ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ‘ãƒãƒ«ã‚’é–‹ã\n      setIsFilterPanelOpen(true)\n      // ãƒ¢ã‚¶ã‚¤ã‚¯é©ç”¨çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ\n      setIsMosaicApplied(false)\n    }\n    // ãƒ¢ã‚¶ã‚¤ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«æˆ»ã£ãŸæ™‚ã¯ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ‘ãƒãƒ«ã®çŠ¶æ…‹ã‚’ç¶­æŒ\n    // (ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ã¨ã—ã¦å‹•ä½œã•ã›ã‚‹ãŸã‚)\n  }, [props.isMosaicMode])\n\n  // ãƒ–ãƒ©ã‚·ã‚µã‚¤ã‚ºãŒå¤‰æ›´ã•ã‚ŒãŸæ™‚ã«ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜\n  useEffect(() => {\n    if (typeof window !== \"undefined\") {\n      localStorage.setItem(\"paint-canvas-brush-size\", brushSize.toString())\n    }\n  }, [brushSize])\n\n  const onChangeMosaicCanvasRef = (canvas: HTMLCanvasElement) => {\n    setMosaicCanvasRef(canvas)\n  }\n\n  // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å€¤ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¨æœ¬ä½“ã‚’æ›´æ–°\n  useEffect(() => {\n    updatePreview()\n    applyFilterToCanvas()\n  }, [brightness, contrast, saturation, hue, props.imageUrl])\n\n  // ç”»åƒèª­ã¿è¾¼ã¿æ™‚ã«å…ƒç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜\n  useEffect(() => {\n    if (props.imageUrl && imageCanvasRef.current) {\n      const canvas = imageCanvasRef.current\n      const ctx = canvas.getContext(\"2d\")\n      if (!ctx) return\n\n      const img = new Image()\n      img.crossOrigin = \"Anonymous\"\n      img.onload = () => {\n        ctx.clearRect(0, 0, canvas.width, canvas.height)\n        ctx.drawImage(img, 0, 0, canvas.width, canvas.height)\n\n        // å…ƒç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜\n        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height)\n        setOriginalImageData(imageData)\n      }\n      img.src = props.imageUrl\n    }\n  }, [props.imageUrl])\n\n  // åˆå›èª­ã¿è¾¼ã¿æ™‚ã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æ›´æ–°\n  useEffect(() => {\n    if (props.imageUrl) {\n      updatePreview()\n    }\n  }, [props.imageUrl])\n\n  // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚­ãƒ£ãƒ³ãƒã‚¹ã®å‚ç…§ã‚’è¨­å®š\n  useEffect(() => {\n    const canvas = previewCanvasRef.current\n    if (canvas) {\n      canvas.width = 200\n      canvas.height = 200\n    }\n  }, [])\n\n  // Canvas ã®æç”»çŠ¶æ…‹ã‚’ä¿å­˜ã™ã‚‹é–¢æ•°\n  const saveCanvasState = (canvas: HTMLCanvasElement) => {\n    const waitForImageLoad = new Promise<void>((resolve, reject) => {\n      const img = new Image()\n      img.onload = () => {\n        resolve()\n      }\n      img.onerror = (error) => {\n        reject(error)\n      }\n      img.src = canvas.toDataURL()\n    })\n\n    waitForImageLoad\n      .then(() => {\n        const dataUrl = canvas.toDataURL()\n        const newState: CanvasState = {\n          dataUrl,\n          width: canvas.width,\n          height: canvas.height,\n        }\n        if (canvasStates.length > 0) {\n          setCanvasStates((prevStates) => [\n            ...prevStates.slice(0, stateIndex + 1),\n            newState,\n          ])\n        } else {\n          canvasStates.push(newState)\n        }\n        setStateIndex((prevIndex) => prevIndex + 1)\n      })\n      .catch((error) => {\n        console.error(\"Failed to load image:\", error)\n      })\n  }\n\n  // Canvas ã®æç”»çŠ¶æ…‹ã‚’å¾©å…ƒã™ã‚‹é–¢æ•°\n  const restoreCanvasState = (\n    canvas: HTMLCanvasElement,\n    state: CanvasState,\n  ) => {\n    const ctx = canvas.getContext(\"2d\")\n    if (!ctx) return\n    ctx.globalCompositeOperation = \"copy\"\n    const img = new Image()\n    img.onload = () => {\n      ctx.clearRect(0, 0, canvas.width, canvas.height)\n      ctx.drawImage(img, 0, 0)\n    }\n    img.src = state.dataUrl\n  }\n\n  // Safariå¯¾å¿œ: åŸºæœ¬ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ImageDataã«é©ç”¨ã™ã‚‹é–¢æ•°\n  const applyBasicFilters = (\n    data: Uint8ClampedArray,\n    brightness: number,\n    contrast: number,\n    saturation: number,\n    hue: number,\n  ) => {\n    const brightnessAdjust = brightness / 100\n    const contrastAdjust = contrast / 100\n    const saturationAdjust = saturation / 100\n    const hueAdjust = (hue * Math.PI) / 180\n\n    for (let i = 0; i < data.length; i += 4) {\n      let r = data[i]\n      let g = data[i + 1]\n      let b = data[i + 2]\n\n      // æ˜åº¦èª¿æ•´\n      r = r * brightnessAdjust\n      g = g * brightnessAdjust\n      b = b * brightnessAdjust\n\n      // ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆèª¿æ•´\n      r = ((r / 255 - 0.5) * contrastAdjust + 0.5) * 255\n      g = ((g / 255 - 0.5) * contrastAdjust + 0.5) * 255\n      b = ((b / 255 - 0.5) * contrastAdjust + 0.5) * 255\n\n      // å½©åº¦èª¿æ•´\n      const gray = 0.299 * r + 0.587 * g + 0.114 * b\n      r = gray + (r - gray) * saturationAdjust\n      g = gray + (g - gray) * saturationAdjust\n      b = gray + (b - gray) * saturationAdjust\n\n      // è‰²ç›¸èª¿æ•´ï¼ˆç°¡æ˜“ç‰ˆï¼‰\n      if (hue !== 0) {\n        const cosA = Math.cos(hueAdjust)\n        const sinA = Math.sin(hueAdjust)\n\n        const newR =\n          r * (cosA + (1 - cosA) * 0.299) +\n          g * ((1 - cosA) * 0.587 - sinA * 0.114) +\n          b * ((1 - cosA) * 0.114 + sinA * 0.587)\n        const newG =\n          r * ((1 - cosA) * 0.299 + sinA * 0.114) +\n          g * (cosA + (1 - cosA) * 0.587) +\n          b * ((1 - cosA) * 0.114 - sinA * 0.299)\n        const newB =\n          r * ((1 - cosA) * 0.299 - sinA * 0.587) +\n          g * ((1 - cosA) * 0.587 + sinA * 0.299) +\n          b * (cosA + (1 - cosA) * 0.114)\n\n        r = newR\n        g = newG\n        b = newB\n      }\n\n      // å€¤ã‚’0-255ã®ç¯„å›²ã«ã‚¯ãƒ©ãƒ³ãƒ—\n      data[i] = Math.max(0, Math.min(255, r))\n      data[i + 1] = Math.max(0, Math.min(255, g))\n      data[i + 2] = Math.max(0, Math.min(255, b))\n    }\n  }\n\n  // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’æ›´æ–°ã™ã‚‹é–¢æ•°ï¼ˆSafariå¯¾å¿œï¼‰\n  const updatePreview = () => {\n    const previewCanvas = previewCanvasRef.current\n    if (!previewCanvas || !props.imageUrl) return\n\n    const ctx = previewCanvas.getContext(\"2d\")\n    if (!ctx) return\n\n    const img = new Image()\n    img.crossOrigin = \"Anonymous\"\n    img.onload = () => {\n      // ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã‚’ç¶­æŒã—ã¦ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚µã‚¤ã‚ºã‚’è¨ˆç®—\n      const aspectRatio = img.width / img.height\n      const maxSize = 200\n\n      let drawWidth = maxSize\n      let drawHeight = maxSize\n      let offsetX = 0\n      let offsetY = 0\n\n      if (aspectRatio > 1) {\n        // æ¨ªé•·ã®ç”»åƒ\n        drawHeight = maxSize / aspectRatio\n        offsetY = (maxSize - drawHeight) / 2\n      } else {\n        // ç¸¦é•·ã®ç”»åƒ\n        drawWidth = maxSize * aspectRatio\n        offsetX = (maxSize - drawWidth) / 2\n      }\n\n      // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚­ãƒ£ãƒ³ãƒã‚¹ã®ã‚µã‚¤ã‚ºã‚’æ­£ã—ãè¨­å®š\n      previewCanvas.width = maxSize\n      previewCanvas.height = maxSize\n\n      // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ã‚¯ãƒªã‚¢\n      ctx.clearRect(0, 0, maxSize, maxSize)\n\n      // ä¸€æ™‚ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ä½œæˆã—ã¦ç”»åƒã‚’æç”»\n      const tempCanvas = document.createElement(\"canvas\")\n      const tempCtx = tempCanvas.getContext(\"2d\")\n      if (!tempCtx) return\n\n      tempCanvas.width = drawWidth\n      tempCanvas.height = drawHeight\n\n      // ç”»åƒã‚’ä¸€æ™‚ã‚­ãƒ£ãƒ³ãƒã‚¹ã«æç”»\n      tempCtx.drawImage(img, 0, 0, drawWidth, drawHeight)\n\n      // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãŒé©ç”¨ã•ã‚Œã¦ã„ã‚‹å ´åˆã€ImageDataã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’é©ç”¨\n      if (\n        brightness !== 100 ||\n        contrast !== 100 ||\n        saturation !== 100 ||\n        hue !== 0\n      ) {\n        const imageData = tempCtx.getImageData(0, 0, drawWidth, drawHeight)\n        applyBasicFilters(imageData.data, brightness, contrast, saturation, hue)\n        tempCtx.putImageData(imageData, 0, 0)\n      }\n\n      // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨æ¸ˆã¿ã®ç”»åƒã‚’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚­ãƒ£ãƒ³ãƒã‚¹ã«æç”»\n      ctx.drawImage(tempCanvas, offsetX, offsetY)\n    }\n    img.src = props.imageUrl\n  }\n\n  // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ã‚­ãƒ£ãƒ³ãƒã‚¹ã«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’é©ç”¨ã™ã‚‹é–¢æ•°ï¼ˆSafariå¯¾å¿œï¼‰\n  const applyFilterToCanvas = () => {\n    if (!originalImageData) return\n\n    const canvas = imageCanvasRef.current\n    if (!canvas) return\n\n    const ctx = canvas.getContext(\"2d\")\n    if (!ctx) return\n\n    // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãŒåˆæœŸå€¤ã¨ç•°ãªã‚‹å ´åˆã®ã¿é©ç”¨\n    if (\n      brightness !== 100 ||\n      contrast !== 100 ||\n      saturation !== 100 ||\n      hue !== 0\n    ) {\n      // ä¸€æ™‚ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ä½œæˆã—ã¦å…ƒç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒ\n      const tempCanvas = document.createElement(\"canvas\")\n      const tempCtx = tempCanvas.getContext(\"2d\")\n      if (!tempCtx) return\n\n      tempCanvas.width = originalImageData.width\n      tempCanvas.height = originalImageData.height\n\n      // å…ƒç”»åƒãƒ‡ãƒ¼ã‚¿ã®ã‚³ãƒ”ãƒ¼ã‚’ä½œæˆ\n      const tempImageData = new ImageData(\n        new Uint8ClampedArray(originalImageData.data),\n        originalImageData.width,\n        originalImageData.height,\n      )\n\n      // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’é©ç”¨\n      applyBasicFilters(\n        tempImageData.data,\n        brightness,\n        contrast,\n        saturation,\n        hue,\n      )\n\n      // ä¸€æ™‚ã‚­ãƒ£ãƒ³ãƒã‚¹ã«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨æ¸ˆã¿ç”»åƒã‚’æç”»\n      tempCtx.putImageData(tempImageData, 0, 0)\n\n      // ãƒ¡ã‚¤ãƒ³ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ã‚¯ãƒªã‚¢ã—ã¦ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨æ¸ˆã¿ç”»åƒã‚’ã‚­ãƒ£ãƒ³ãƒã‚¹å…¨ä½“ã«æç”»\n      ctx.clearRect(0, 0, canvas.width, canvas.height)\n      ctx.drawImage(tempCanvas, 0, 0, canvas.width, canvas.height)\n    } else {\n      // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãŒåˆæœŸå€¤ã®å ´åˆã¯å…ƒç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒ\n      // ä¸€æ™‚ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ä½œæˆã—ã¦å…ƒç”»åƒãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æç”»\n      const tempCanvas = document.createElement(\"canvas\")\n      const tempCtx = tempCanvas.getContext(\"2d\")\n      if (!tempCtx) return\n\n      tempCanvas.width = originalImageData.width\n      tempCanvas.height = originalImageData.height\n      tempCtx.putImageData(originalImageData, 0, 0)\n\n      // ãƒ¡ã‚¤ãƒ³ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ã‚¯ãƒªã‚¢ã—ã¦ã€å…ƒç”»åƒã‚’ã‚­ãƒ£ãƒ³ãƒã‚¹å…¨ä½“ã«æç”»\n      ctx.clearRect(0, 0, canvas.width, canvas.height)\n      ctx.drawImage(tempCanvas, 0, 0, canvas.width, canvas.height)\n    }\n  }\n\n  // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆã™ã‚‹é–¢æ•°\n  const resetFilters = () => {\n    setBrightness(100)\n    setContrast(100)\n    setSaturation(100)\n    setHue(0)\n\n    // ãƒªã‚»ãƒƒãƒˆå¾Œã™ãã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æ›´æ–°\n    setTimeout(() => {\n      updatePreview()\n    }, 0)\n  }\n\n  // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’é©ç”¨ã™ã‚‹é–¢æ•°ï¼ˆSafariå¯¾å¿œï¼‰\n  const applyFilter = () => {\n    if (!originalImageData || !imageCanvasRef.current) {\n      console.error(\"Original image data or canvas not found\")\n      return\n    }\n\n    const canvas = imageCanvasRef.current\n    const ctx = canvas.getContext(\"2d\")\n    if (!ctx) {\n      console.error(\"Canvas context not found\")\n      return\n    }\n\n    // ä¸€æ™‚ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ä½œæˆã—ã¦å…ƒç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒ\n    const tempCanvas = document.createElement(\"canvas\")\n    const tempCtx = tempCanvas.getContext(\"2d\")\n    if (!tempCtx) return\n\n    tempCanvas.width = originalImageData.width\n    tempCanvas.height = originalImageData.height\n\n    // å…ƒç”»åƒãƒ‡ãƒ¼ã‚¿ã®ã‚³ãƒ”ãƒ¼ã‚’ä½œæˆ\n    const tempImageData = new ImageData(\n      new Uint8ClampedArray(originalImageData.data),\n      originalImageData.width,\n      originalImageData.height,\n    )\n\n    // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’é©ç”¨\n    applyBasicFilters(tempImageData.data, brightness, contrast, saturation, hue)\n\n    // ä¸€æ™‚ã‚­ãƒ£ãƒ³ãƒã‚¹ã«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨æ¸ˆã¿ç”»åƒã‚’æç”»\n    tempCtx.putImageData(tempImageData, 0, 0)\n\n    // ãƒ¡ã‚¤ãƒ³ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ã‚¯ãƒªã‚¢ã—ã¦ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨æ¸ˆã¿ç”»åƒã‚’ã‚­ãƒ£ãƒ³ãƒã‚¹å…¨ä½“ã«æç”»\n    ctx.clearRect(0, 0, canvas.width, canvas.height)\n    ctx.drawImage(tempCanvas, 0, 0, canvas.width, canvas.height)\n\n    // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨å¾Œã®æ–°ã—ã„å…ƒç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ï¼ˆã‚­ãƒ£ãƒ³ãƒã‚¹ã‚µã‚¤ã‚ºï¼‰\n    const newImageData = ctx.getImageData(0, 0, canvas.width, canvas.height)\n    setOriginalImageData(newImageData)\n\n    // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å€¤ã‚’ãƒªã‚»ãƒƒãƒˆï¼ˆè¦‹ãŸç›®ã¯å¤‰ã‚ã‚‰ãªã„ï¼‰\n    setBrightness(100)\n    setContrast(100)\n    setSaturation(100)\n    setHue(0)\n\n    // çŠ¶æ…‹ã‚’ä¿å­˜\n    saveCanvasState(canvas)\n\n    // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æ›´æ–°ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒªã‚»ãƒƒãƒˆå¾Œã®çŠ¶æ…‹ã§ï¼‰\n    setTimeout(() => {\n      updatePreview()\n    }, 0)\n\n    console.log(\"Filter applied and made permanent\")\n  }\n\n  // é«˜åº¦ãªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’é©ç”¨ã™ã‚‹é–¢æ•°\n  const handleAdvancedFilterApply = (\n    filterType: FilterType,\n    intensity: number,\n  ) => {\n    if (!imageCanvasRef.current) return\n\n    const canvas = imageCanvasRef.current\n    applyImageFilter(canvas, filterType, intensity)\n\n    // é©ç”¨ã•ã‚ŒãŸãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ãƒªã‚¹ãƒˆã«è¿½åŠ \n    setAppliedFilters((prev) => [...prev, { type: filterType, intensity }])\n\n    // æ–°ã—ã„å…ƒç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜\n    const ctx = canvas.getContext(\"2d\")\n    if (ctx) {\n      setOriginalImageData(ctx.getImageData(0, 0, canvas.width, canvas.height))\n    }\n\n    // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æ›´æ–°\n    setTimeout(() => {\n      updatePreview()\n    }, 0)\n  }\n\n  // å…¨ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆã™ã‚‹é–¢æ•°\n  const handleResetAllFilters = () => {\n    if (!originalImageData || !imageCanvasRef.current) return\n\n    const canvas = imageCanvasRef.current\n    const ctx = canvas.getContext(\"2d\")\n    if (!ctx) return\n\n    // ä¸€æ™‚ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ä½œæˆã—ã¦å…ƒç”»åƒãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒ\n    const tempCanvas = document.createElement(\"canvas\")\n    const tempCtx = tempCanvas.getContext(\"2d\")\n    if (!tempCtx) return\n\n    tempCanvas.width = originalImageData.width\n    tempCanvas.height = originalImageData.height\n    tempCtx.putImageData(originalImageData, 0, 0)\n\n    // ãƒ¡ã‚¤ãƒ³ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ã‚¯ãƒªã‚¢ã—ã¦ã€å…ƒç”»åƒã‚’ã‚­ãƒ£ãƒ³ãƒã‚¹å…¨ä½“ã«æç”»\n    ctx.clearRect(0, 0, canvas.width, canvas.height)\n    ctx.drawImage(tempCanvas, 0, 0, canvas.width, canvas.height)\n\n    // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ\n    setBrightness(100)\n    setContrast(100)\n    setSaturation(100)\n    setHue(0)\n    setAppliedFilters([])\n\n    // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æ›´æ–°\n    setTimeout(() => {\n      updatePreview()\n    }, 0)\n  }\n\n  // æˆ»ã‚‹ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†\n  const handleUndo = () => {\n    if (stateIndex > 0) {\n      const newIndex = stateIndex - 1\n      setStateIndex(newIndex)\n      const ref = props.isMosaicMode ? imageCanvasRef : brushCanvasRef\n      if (ref.current) {\n        restoreCanvasState(ref.current, canvasStates[newIndex])\n      }\n    }\n  }\n\n  // é€²ã‚€ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†\n  const handleRedo = () => {\n    if (stateIndex < canvasStates.length - 1) {\n      const newIndex = stateIndex + 1\n      setStateIndex(newIndex)\n      const ref = props.isMosaicMode ? imageCanvasRef : brushCanvasRef\n      if (ref.current) {\n        restoreCanvasState(ref.current, canvasStates[newIndex])\n      }\n    }\n  }\n\n  // ãƒ‘ãƒ³æ“ä½œã®ãƒãƒ³ãƒ‰ãƒ©ãƒ¼é–¢æ•°\n  const handlePanStart = (clientX: number, clientY: number) => {\n    setIsPanning(true)\n    setPanStart({ x: clientX, y: clientY })\n    setPanStartTranslate({ x: translateX, y: translateY })\n  }\n\n  const handlePanMove = (clientX: number, clientY: number) => {\n    if (!isPanning) return\n    const deltaX = clientX - panStart.x\n    const deltaY = clientY - panStart.y\n    setTranslateX(panStartTranslate.x + deltaX)\n    setTranslateY(panStartTranslate.y + deltaY)\n  }\n\n  const handlePanEnd = () => {\n    setIsPanning(false)\n  }\n\n  const handleWheel: React.WheelEventHandler<HTMLDivElement> = (e) => {\n    e.preventDefault()\n\n    if (tool === \"select\" || props.isMosaicMode) {\n      const rect = e.currentTarget.getBoundingClientRect()\n      const mouseX = e.clientX - rect.left - rect.width / 2\n      const mouseY = e.clientY - rect.top - rect.height / 2\n\n      const scaleFactor = 1.1\n      const newScale = e.deltaY < 0 ? scale * scaleFactor : scale / scaleFactor\n      const clampedScale = Math.max(0.1, Math.min(newScale, 5))\n\n      const scaleChange = clampedScale / scale\n      const newTranslateX = translateX - mouseX * (scaleChange - 1)\n      const newTranslateY = translateY - mouseY * (scaleChange - 1)\n\n      setScale(clampedScale)\n      setTranslateX(newTranslateX)\n      setTranslateY(newTranslateY)\n    } else {\n      const scaleFactor = 1.1\n      const newScale = e.deltaY < 0 ? scale * scaleFactor : scale / scaleFactor\n      setScale(Math.max(0.1, Math.min(newScale, 10)))\n    }\n  }\n\n  const resetAssistedCanvas = () => {\n    const assistedCanvas = assistedCanvasRef.current\n    if (!assistedCanvas) return\n    const ctx = assistedCanvas.getContext(\"2d\")\n    if (ctx) ctx.clearRect(0, 0, assistedCanvas.width, assistedCanvas.height)\n  }\n\n  // useEffectç¾¤ã¯çœç•¥ï¼ˆæ—¢å­˜ã®ã‚‚ã®ã¨åŒã˜ï¼‰\n  useEffect(() => {\n    if (props.imageBase64) {\n      const imageCanvas = imageCanvasRef.current\n      if (!imageCanvas) return\n      const ctx = imageCanvas.getContext(\"2d\")\n      if (!ctx) return\n      const image = new Image()\n      image.crossOrigin = \"Anonymous\"\n      image.src = props.imageBase64\n      image.onload = () => {\n        imageCanvas.width = image.width\n        imageCanvas.height = image.height\n        ctx.drawImage(image, 0, 0, image.width, image.height)\n        saveCanvasState(imageCanvas)\n      }\n    }\n  }, [props.imageBase64])\n\n  useEffect(() => {\n    if (props.backImageBase64) {\n      const brushCanvas = brushCanvasRef.current\n      if (!brushCanvas) return\n      const ctx = brushCanvas.getContext(\"2d\")\n      if (!ctx) return\n      const image = new Image()\n      image.crossOrigin = \"Anonymous\"\n      image.src = `data:image/png;base64,${props.backImageBase64}`\n      image.onload = () => {\n        brushCanvas.width = image.width\n        brushCanvas.height = image.height\n        ctx.drawImage(image, 0, 0, image.width, image.height)\n        saveCanvasState(brushCanvas)\n      }\n      if (props.setBackImageBase64) {\n        props.setBackImageBase64(\"\")\n      }\n    }\n  }, [props.backImageBase64])\n\n  useEffect(() => {\n    const brushCanvas = brushCanvasRef.current\n    if (!brushCanvas) return\n    const imageCanvas = imageCanvasRef.current\n    if (props.isMosaicMode && !imageCanvas) return\n    const backgroundCanvas = backgroundCanvasRef.current\n    const assistedCanvas = assistedCanvasRef.current\n    if (!assistedCanvas) return\n\n    const ctx = props.isMosaicMode\n      ? imageCanvas?.getContext(\"2d\")\n      : brushCanvas.getContext(\"2d\")\n    if (!ctx) return\n\n    const assistedCtx = assistedCanvas.getContext(\"2d\")\n    if (!assistedCtx) return\n\n    const handleMouseDown = (e: MouseEvent | TouchEvent) => {\n      if (tool === \"select\") {\n        return\n      }\n\n      // æç”»é–‹å§‹ã‚’è¨˜éŒ²\n      setIsDrawing(true)\n\n      if (props.onChangeSetDrawing) props.onChangeSetDrawing(true)\n\n      const rect = brushCanvas.getBoundingClientRect()\n      const clientX = \"touches\" in e ? e.touches[0].clientX : e.clientX\n      const clientY = \"touches\" in e ? e.touches[0].clientY : e.clientY\n      const x = (clientX - rect.left) / scale\n      const y = (clientY - rect.top) / scale\n\n      setPoints([])\n      points.push({ x, y })\n\n      ctx.beginPath()\n      ctx.moveTo(x, y)\n\n      assistedCtx.beginPath()\n      assistedCtx.moveTo(x, y)\n\n      if (props.isMosaicMode && tool === \"eraser\") {\n        ctx.globalCompositeOperation = \"destination-out\"\n        ctx.strokeStyle = \"rgba(0, 0, 0, 1)\"\n        ctx.lineWidth = brushSize\n        // ãƒ¢ã‚¶ã‚¤ã‚¯ãŒé©ç”¨ã•ã‚ŒãŸã“ã¨ã‚’è¨˜éŒ²\n        setIsMosaicApplied(true)\n      } else if (tool === \"eraser\") {\n        ctx.globalCompositeOperation = \"destination-out\"\n        ctx.lineWidth = brushSize\n      } else if (tool === \"lasso\") {\n        ctx.globalCompositeOperation = \"source-over\"\n        ctx.strokeStyle = color\n        ctx.lineWidth = 1\n      } else if (tool === \"lasso-mosaic\") {\n        ctx.globalCompositeOperation = \"destination-out\"\n        ctx.strokeStyle = color\n        ctx.lineWidth = 1\n        // ãƒ¢ã‚¶ã‚¤ã‚¯ãŒé©ç”¨ã•ã‚ŒãŸã“ã¨ã‚’è¨˜éŒ²\n        setIsMosaicApplied(true)\n      } else {\n        ctx.globalCompositeOperation = \"source-over\"\n        ctx.strokeStyle = color\n        ctx.lineWidth = brushSize\n      }\n\n      const handleMouseMove = (e: MouseEvent | TouchEvent) => {\n        const clientX = \"touches\" in e ? e.touches[0].clientX : e.clientX\n        const clientY = \"touches\" in e ? e.touches[0].clientY : e.clientY\n        const x = (clientX - rect.left) / scale\n        const y = (clientY - rect.top) / scale\n\n        if (tool !== \"lasso\" && tool !== \"lasso-mosaic\") {\n          points.push({ x, y })\n          ctx.lineTo(x, y)\n          ctx.stroke()\n        } else {\n          ctx.lineTo(x, y)\n          ctx.stroke()\n\n          assistedCtx.lineTo(x, y)\n          assistedCtx.stroke()\n\n          if (tool === \"lasso\" || tool === \"lasso-mosaic\") {\n            assistedCtx.fillStyle = \"rgba(120, 0, 0, 0.5)\"\n            assistedCtx.fill()\n          } else {\n            ctx.stroke()\n          }\n        }\n      }\n\n      const handleMouseUp = () => {\n        // æç”»çµ‚äº†ã‚’è¨˜éŒ²\n        setIsDrawing(false)\n\n        if (canvasStates.length === 0) {\n          if (props.isMosaicMode) {\n            if (imageCanvas) {\n              canvasStates.splice(stateIndex + 1)\n              saveCanvasState(imageCanvas)\n            }\n          } else {\n            if (brushCanvas) {\n              canvasStates.splice(stateIndex + 1)\n              saveCanvasState(brushCanvas)\n            }\n          }\n        }\n        if (tool === \"lasso\" || tool === \"lasso-mosaic\") {\n          ctx.lineTo(points[0].x, points[0].y)\n          ctx.closePath()\n          ctx.fillStyle = color\n          ctx.fill()\n          setPoints([])\n          resetAssistedCanvas()\n        }\n\n        document.removeEventListener(\"mousemove\", handleMouseMove)\n        document.removeEventListener(\"mouseup\", handleMouseUp)\n        document.removeEventListener(\"touchmove\", handleMouseMove)\n        document.removeEventListener(\"touchend\", handleMouseUp)\n\n        if (props.isMosaicMode) {\n          if (imageCanvas) {\n            canvasStates.splice(stateIndex + 1)\n            saveCanvasState(imageCanvas)\n          }\n        } else {\n          if (brushCanvas) {\n            canvasStates.splice(stateIndex + 1)\n            saveCanvasState(brushCanvas)\n          }\n        }\n\n        if (props.onChangeSetDrawing) props.onChangeSetDrawing(false)\n\n        if (props.onChangeCompositionCanvasBase64) {\n          const compositionCanvas = document.createElement(\"canvas\")\n          compositionCanvas.width = canvasWidth\n          compositionCanvas.height = canvasHeight\n          const compositionCtx = compositionCanvas.getContext(\"2d\")\n          if (compositionCtx) {\n            if (backgroundCanvas) {\n              compositionCtx.drawImage(backgroundCanvas, 0, 0)\n            }\n            if (imageCanvas) {\n              compositionCtx.drawImage(imageCanvas, 0, 0)\n            }\n            compositionCtx.drawImage(brushCanvas, 0, 0)\n            props.onChangeCompositionCanvasBase64(compositionCanvas.toDataURL())\n          }\n        }\n\n        if (!props.isMosaicMode && props.onChangeBrushImageBase64) {\n          props.onChangeBrushImageBase64(brushCanvas.toDataURL())\n        }\n      }\n\n      document.addEventListener(\"mousemove\", handleMouseMove)\n      document.addEventListener(\"mouseup\", handleMouseUp)\n      document.addEventListener(\"touchmove\", handleMouseMove)\n      document.addEventListener(\"touchend\", handleMouseUp)\n    }\n\n    assistedCanvas.addEventListener(\"mousedown\", handleMouseDown)\n    assistedCanvas.addEventListener(\"touchstart\", handleMouseDown)\n\n    return () => {\n      assistedCanvas.removeEventListener(\"mousedown\", handleMouseDown)\n      assistedCanvas.removeEventListener(\"touchstart\", handleMouseDown)\n    }\n  }, [\n    brushSize,\n    color,\n    props.isMosaicMode,\n    scale,\n    tool,\n    points,\n    translateX,\n    translateY,\n    isDrawing,\n  ])\n\n  useEffect(() => {\n    const imageCanvas = imageCanvasRef.current\n    if (!imageCanvas) return\n    const brushCanvas = brushCanvasRef.current\n    if (!brushCanvas) return\n    const assistedCanvas = assistedCanvasRef.current\n    if (!assistedCanvas) return\n\n    const ctx = imageCanvas.getContext(\"2d\")\n    if (!ctx) return\n\n    ctx.globalCompositeOperation = \"copy\"\n\n    if (!props.imageUrl) return\n\n    const image = new Image()\n    image.crossOrigin = \"Anonymous\"\n    image.src = props.imageUrl\n    image.onload = () => {\n      imageCanvas.width = image.width\n      imageCanvas.height = image.height\n      brushCanvas.width = image.width\n      brushCanvas.height = image.height\n      assistedCanvas.width = image.width\n      assistedCanvas.height = image.height\n\n      setCanvasWidth(image.width)\n      setCanvasHeight(image.height)\n\n      ctx.drawImage(image, 0, 0, image.width, image.height)\n      saveCanvasState(imageCanvas)\n    }\n  }, [props.imageUrl])\n\n  return (\n    <section className=\"relative h-[100%] w-[100%] bg-gray-900\">\n      <div className=\"flex h-[100%] w-[100%]\">\n        {/* å·¦å´ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ - Photoshopé¢¨ */}\n        <div className=\"flex w-16 flex-col bg-gray-800 p-2 md:w-20\">\n          {/* é¸æŠãƒ»ç§»å‹•ãƒ„ãƒ¼ãƒ« */}\n          <Button\n            className={cn(\n              \"mb-2 h-12 w-12 md:h-16 md:w-16\",\n              tool === \"select\"\n                ? \"bg-blue-600 text-white\"\n                : \"bg-gray-700 text-gray-300 hover:bg-gray-600\",\n            )}\n            size=\"icon\"\n            variant=\"ghost\"\n            onClick={() => setTool(\"select\")}\n          >\n            <MoveIcon className=\"h-6 w-6\" />\n          </Button>\n          {/* åŒºåˆ‡ã‚Šç·š */}\n          <div className=\"my-4 h-px bg-gray-600\" />\n\n          {/* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ„ãƒ¼ãƒ« */}\n          <Button\n            className={cn(\n              \"mb-2 h-12 w-12 md:h-16 md:w-16\",\n              // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ‘ãƒãƒ«ãŒé–‹ã„ã¦ã„ã‚‹ã‹ã€ãƒ¢ã‚¶ã‚¤ã‚¯ãƒ¢ãƒ¼ãƒ‰ã§æœªé©ç”¨ã®å ´åˆã¯é¸æŠçŠ¶æ…‹\n              isFilterPanelOpen || (props.isMosaicMode && !isMosaicApplied)\n                ? \"bg-blue-600 text-white\"\n                : \"bg-gray-700 text-gray-300 hover:bg-gray-600\",\n              // ãƒ¢ã‚¶ã‚¤ã‚¯ãŒé©ç”¨ã•ã‚ŒãŸå ´åˆã¯ç„¡åŠ¹åŒ–\n              props.isMosaicMode &&\n                isMosaicApplied &&\n                \"cursor-not-allowed opacity-50\",\n            )}\n            size=\"icon\"\n            variant=\"ghost\"\n            disabled={props.isMosaicMode && isMosaicApplied}\n            onClick={() => {\n              console.log(\"ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯:\", {\n                isMosaicMode: props.isMosaicMode,\n                isMosaicApplied,\n                isFilterPanelOpen,\n                hasOnChangeMosaicMode: !!props.onChangeMosaicMode,\n              })\n\n              if (props.isMosaicMode && !isMosaicApplied) {\n                // ãƒ¢ã‚¶ã‚¤ã‚¯ãƒ¢ãƒ¼ãƒ‰ã‹ã‚‰ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆï¼ˆãƒ¢ã‚¶ã‚¤ã‚¯æœªé©ç”¨ã®å ´åˆã®ã¿ï¼‰\n                if (props.onChangeMosaicMode) {\n                  console.log(\"ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆå®Ÿè¡Œ\")\n                  props.onChangeMosaicMode(false)\n                } else {\n                  // onChangeMosaicModeãŒæä¾›ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã€ç›´æ¥ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ‘ãƒãƒ«ã‚’é–‹ã\n                  console.log(\"ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ‘ãƒãƒ«ç›´æ¥ãƒˆã‚°ãƒ«ï¼ˆãƒ¢ã‚¶ã‚¤ã‚¯ãƒ¢ãƒ¼ãƒ‰ï¼‰\")\n                  setIsFilterPanelOpen(!isFilterPanelOpen)\n                }\n              } else if (!props.isMosaicMode) {\n                // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã§ã®ãƒˆã‚°ãƒ«å‹•ä½œ\n                console.log(\"ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ‘ãƒãƒ«ãƒˆã‚°ãƒ«ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ¢ãƒ¼ãƒ‰ï¼‰\")\n                setIsFilterPanelOpen(!isFilterPanelOpen)\n              }\n            }}\n            title={\n              props.isMosaicMode && isMosaicApplied\n                ? \"ãƒ¢ã‚¶ã‚¤ã‚¯é©ç”¨å¾Œã¯ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ä½¿ç”¨ã§ãã¾ã›ã‚“\"\n                : props.isMosaicMode\n                  ? \"ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ\"\n                  : \"åŸºæœ¬ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼\"\n            }\n          >\n            <FilterIcon className=\"h-6 w-6\" />\n          </Button>\n\n          {/* é«˜åº¦ãªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ„ãƒ¼ãƒ« */}\n          {/* <Button\n            className={cn(\n              \"mb-2 h-12 w-12 md:h-16 md:w-16\",\n              isAdvancedFilterPanelOpen\n                ? \"bg-purple-600 text-white\"\n                : \"bg-gray-700 text-gray-300 hover:bg-gray-600\",\n              // ãƒ¢ã‚¶ã‚¤ã‚¯ãŒé©ç”¨ã•ã‚ŒãŸå ´åˆã¯ç„¡åŠ¹åŒ–\n              props.isMosaicMode &&\n                isMosaicApplied &&\n                \"cursor-not-allowed opacity-50\",\n            )}\n            size=\"icon\"\n            variant=\"ghost\"\n            disabled={props.isMosaicMode && isMosaicApplied}\n            onClick={() => setIsAdvancedFilterPanelOpen(true)}\n            title=\"é«˜åº¦ãªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼\"\n          >\n            <FilterIcon className=\"h-6 w-6\" />\n            <div className=\"absolute -top-1 -right-1 h-2 w-2 bg-purple-500 rounded-full\" />\n          </Button> */}\n\n          {!props.isMosaicMode && (\n            <Button\n              className={cn(\n                \"mb-2 h-12 w-12 md:h-16 md:w-16\",\n                tool === \"brush\"\n                  ? \"bg-blue-600 text-white\"\n                  : \"bg-gray-700 text-gray-300 hover:bg-gray-600\",\n              )}\n              size=\"icon\"\n              variant=\"ghost\"\n              onClick={() => setTool(\"brush\")}\n            >\n              <BrushIcon className=\"h-6 w-6\" />\n            </Button>\n          )}\n\n          {!props.isMosaicMode && (\n            <Button\n              className={cn(\n                \"mb-2 h-12 w-12 md:h-16 md:w-16\",\n                tool === \"lasso\"\n                  ? \"bg-blue-600 text-white\"\n                  : \"bg-gray-700 text-gray-300 hover:bg-gray-600\",\n              )}\n              size=\"icon\"\n              variant=\"ghost\"\n              onClick={() => setTool(\"lasso\")}\n            >\n              <LassoIcon className=\"h-6 w-6\" />\n            </Button>\n          )}\n\n          <Button\n            className={cn(\n              \"mb-2 h-12 w-12 md:h-16 md:w-16\",\n              tool === \"eraser\"\n                ? \"bg-blue-600 text-white\"\n                : \"bg-gray-700 text-gray-300 hover:bg-gray-600\",\n              // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ‘ãƒãƒ«é–‹ã„ã¦ã„ã‚‹å ´åˆã¯ç„¡åŠ¹åŒ–ï¼ˆãƒ¢ã‚¶ã‚¤ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®ã¿ï¼‰\n              props.isMosaicMode &&\n                isFilterPanelOpen &&\n                \"cursor-not-allowed opacity-50\",\n            )}\n            size=\"icon\"\n            variant=\"ghost\"\n            disabled={props.isMosaicMode && isFilterPanelOpen}\n            onClick={() => setTool(\"eraser\")}\n            title={\n              props.isMosaicMode && isFilterPanelOpen\n                ? \"ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨ä¸­ã¯ãƒ¢ã‚¶ã‚¤ã‚¯ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã§ãã¾ã›ã‚“\"\n                : \"æ¶ˆã—ã‚´ãƒ \"\n            }\n          >\n            <EraserIcon className=\"h-6 w-6\" />\n          </Button>\n\n          {props.isMosaicMode && (\n            <Button\n              className={cn(\n                \"mb-2 h-12 w-12 md:h-16 md:w-16\",\n                tool === \"lasso-mosaic\"\n                  ? \"bg-blue-600 text-white\"\n                  : \"bg-gray-700 text-gray-300 hover:bg-gray-600\",\n                // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ‘ãƒãƒ«é–‹ã„ã¦ã„ã‚‹å ´åˆã¯ç„¡åŠ¹åŒ–\n                isFilterPanelOpen && \"cursor-not-allowed opacity-50\",\n              )}\n              size=\"icon\"\n              variant=\"ghost\"\n              disabled={isFilterPanelOpen}\n              onClick={() => setTool(\"lasso-mosaic\")}\n              title={\n                isFilterPanelOpen\n                  ? \"ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨ä¸­ã¯ãƒ¢ã‚¶ã‚¤ã‚¯ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã§ãã¾ã›ã‚“\"\n                  : \"æŠ•ã’ç¸„ï¼ˆãƒ¢ã‚¶ã‚¤ã‚¯ï¼‰\"\n              }\n            >\n              <LassoIcon className=\"h-6 w-6\" />\n            </Button>\n          )}\n\n          {/* æ‹¡å¤§ç¸®å°ãƒœã‚¿ãƒ³ */}\n          <Button\n            className=\"mb-2 h-12 w-12 bg-gray-700 text-gray-300 hover:bg-gray-600 md:h-16 md:w-16\"\n            size=\"icon\"\n            variant=\"ghost\"\n            onClick={() => setScale((prev) => Math.min(prev * 1.2, 5))}\n          >\n            <ZoomInIcon className=\"h-6 w-6\" />\n          </Button>\n\n          <Button\n            className=\"mb-2 h-12 w-12 bg-gray-700 text-gray-300 hover:bg-gray-600 md:h-16 md:w-16\"\n            size=\"icon\"\n            variant=\"ghost\"\n            onClick={() => setScale((prev) => Math.max(prev / 1.2, 0.1))}\n          >\n            <ZoomOutIcon className=\"h-6 w-6\" />\n          </Button>\n\n          <div className=\"my-4 h-px bg-gray-600\" />\n\n          {/* ã‚¢ãƒ³ãƒ‰ã‚¥ãƒ»ãƒªãƒ‰ã‚¥ */}\n          <Button\n            className=\"mb-2 h-12 w-12 bg-gray-700 text-gray-300 hover:bg-gray-600 md:h-16 md:w-16\"\n            size=\"icon\"\n            variant=\"ghost\"\n            onClick={handleUndo}\n          >\n            <RotateCcwIcon className=\"h-6 w-6\" />\n          </Button>\n\n          <Button\n            className=\"mb-2 h-12 w-12 bg-gray-700 text-gray-300 hover:bg-gray-600 disabled:opacity-50 md:h-16 md:w-16\"\n            size=\"icon\"\n            variant=\"ghost\"\n            onClick={handleRedo}\n            disabled={stateIndex >= canvasStates.length - 1}\n          >\n            <RotateCwIcon className=\"h-6 w-6\" />\n          </Button>\n\n          {/* ã‚«ãƒ©ãƒ¼ãƒ”ãƒƒã‚«ãƒ¼ */}\n          {!props.isMosaicMode && props.isColorPicker && (\n            <div className=\"mt-4\">\n              <input\n                type=\"color\"\n                value={color}\n                onChange={(e) => setColor(e.target.value)}\n                className=\"h-12 w-12 cursor-pointer rounded border-2 border-gray-600 md:h-16 md:w-16\"\n                title=\"ãƒ–ãƒ©ã‚·ã®è‰²ã‚’é¸æŠ\"\n              />\n            </div>\n          )}\n\n          {/* é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³ */}\n          {props.onClose && (\n            <>\n              <div className=\"my-4 h-px bg-gray-600\" />\n              <Button\n                className=\"h-12 w-12 bg-red-600 text-white hover:bg-red-700 md:h-16 md:w-16\"\n                size=\"icon\"\n                variant=\"ghost\"\n                onClick={props.onClose}\n                title=\"é–‰ã˜ã‚‹\"\n              >\n                <XIcon className=\"h-6 w-6\" />\n              </Button>\n            </>\n          )}\n        </div>\n\n        {/* ãƒ¡ã‚¤ãƒ³ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚¨ãƒªã‚¢ */}\n        <div className=\"flex flex-1 flex-col md:flex-row\">\n          <div\n            className={cn(\n              \"flex h-[100%] flex-1 items-center justify-center overflow-hidden bg-gray-700\",\n              tool === \"select\" && \"cursor-grab\",\n              (tool === \"select\" || props.isMosaicMode) &&\n                isPanning &&\n                \"cursor-grabbing\",\n            )}\n            onMouseDown={(e) => {\n              if (tool === \"select\" && e.button === 0) {\n                e.preventDefault()\n                handlePanStart(e.clientX, e.clientY)\n              } else if (props.isMosaicMode && (e.button === 2 || e.ctrlKey)) {\n                e.preventDefault()\n                handlePanStart(e.clientX, e.clientY)\n              }\n            }}\n            onMouseMove={(e) => {\n              if (isPanning) {\n                handlePanMove(e.clientX, e.clientY)\n              }\n            }}\n            onMouseUp={handlePanEnd}\n            onMouseLeave={handlePanEnd}\n            onTouchStart={(e) => {\n              // ãƒ¢ã‚¶ã‚¤ã‚¯ãƒ¢ãƒ¼ãƒ‰ã§ã¯æç”»æ“ä½œã‚’å„ªå…ˆã—ã€selectãƒ„ãƒ¼ãƒ«ã¾ãŸã¯æç”»ä¸­ã§ãªã„å ´åˆã®ã¿ãƒ‘ãƒ³ã‚’è¨±å¯\n              if (\n                tool === \"select\" ||\n                (props.isMosaicMode &&\n                  tool !== \"eraser\" &&\n                  tool !== \"lasso-mosaic\")\n              ) {\n                if (e.touches.length === 1 && !isDrawing) {\n                  e.preventDefault()\n                  const touch = e.touches[0]\n                  handlePanStart(touch.clientX, touch.clientY)\n                }\n              }\n            }}\n            onTouchMove={(e) => {\n              if (isPanning && e.touches.length === 1 && !isDrawing) {\n                e.preventDefault()\n                const touch = e.touches[0]\n                handlePanMove(touch.clientX, touch.clientY)\n              }\n            }}\n            onTouchEnd={handlePanEnd}\n            onContextMenu={(e) => e.preventDefault()}\n          >\n            <div\n              className=\"relative\"\n              style={{\n                width: `${props.width}px`,\n                height: `${props.height}px`,\n                transform: `translate(${translateX}px, ${translateY}px) scale(${scale})`,\n                transformOrigin: \"center center\",\n              }}\n              onWheel={handleWheel}\n            >\n              {/* ã‚­ãƒ£ãƒ³ãƒã‚¹ç¾¤ */}\n              {props.isMosaicMode && props.imageUrl && (\n                <MosaicCanvas\n                  className=\"absolute top-0 left-0\"\n                  imageUrl={props.imageUrl}\n                  mosaicSize={10}\n                  width={props.width}\n                  height={props.height}\n                  onChangeCanvasRef={onChangeMosaicCanvasRef}\n                  style={{\n                    top: `${props.imageUrl ? (-1 * canvasHeight) / 2 : 0}px`,\n                    left: `${props.imageUrl ? (-1 * canvasWidth) / 2 : 0}px`,\n                  }}\n                />\n              )}\n\n              {props.isBackground && (\n                <canvas\n                  ref={backgroundCanvasRef}\n                  width={props.width}\n                  height={props.height}\n                  className=\"absolute top-0 left-0\"\n                  style={{\n                    backgroundColor: backgroundColor,\n                    top: `${props.imageUrl ? (-1 * canvasHeight) / 2 : 0}px`,\n                    left: `${props.imageUrl ? (-1 * canvasWidth) / 2 : 0}px`,\n                  }}\n                />\n              )}\n\n              {props.imageUrl && (\n                <canvas\n                  ref={imageCanvasRef}\n                  width={props.width}\n                  height={props.height}\n                  className=\"absolute top-0 left-0\"\n                  style={{\n                    top: `${props.imageUrl ? (-1 * canvasHeight) / 2 : 0}px`,\n                    left: `${props.imageUrl ? (-1 * canvasWidth) / 2 : 0}px`,\n                  }}\n                />\n              )}\n\n              <canvas\n                ref={brushCanvasRef}\n                width={props.width}\n                height={props.height}\n                className=\"absolute top-0 left-0\"\n                style={{\n                  top: `${props.imageUrl ? (-1 * canvasHeight) / 2 : 0}px`,\n                  left: `${props.imageUrl ? (-1 * canvasWidth) / 2 : 0}px`,\n                }}\n              />\n\n              <canvas\n                ref={assistedCanvasRef}\n                width={props.width}\n                height={props.height}\n                className=\"absolute top-0 left-0 opacity-50\"\n                style={{\n                  top: `${props.imageUrl ? (-1 * canvasHeight) / 2 : 0}px`,\n                  left: `${props.imageUrl ? (-1 * canvasWidth) / 2 : 0}px`,\n                }}\n              />\n            </div>\n          </div>\n\n          {/* å³å´ãƒ‘ãƒãƒ« - ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¨ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ (PCã®ã¿) */}\n          <div className=\"hidden w-80 flex-col bg-gray-800 p-4 md:flex\">\n            {/* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ */}\n            <div className=\"mb-6\">\n              <h3 className=\"mb-3 font-bold text-gray-300 text-sm\">\n                ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼\n              </h3>\n              <div className=\"aspect-square w-full overflow-hidden rounded-lg border border-gray-600 bg-gray-700\">\n                <canvas\n                  ref={previewCanvasRef}\n                  width={200}\n                  height={200}\n                  className=\"h-full w-full object-contain\"\n                />\n              </div>\n            </div>\n\n            {/* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ‘ãƒãƒ« */}\n            {isFilterPanelOpen && (\n              <div className=\"space-y-4\">\n                <div>\n                  <div className=\"mb-2 text-gray-400 text-xs\">\n                    æ˜åº¦: {brightness}%\n                  </div>\n                  <Slider\n                    value={[brightness]}\n                    onValueChange={(value) => setBrightness(value[0])}\n                    min={0}\n                    max={200}\n                    step={1}\n                    className=\"w-full\"\n                  />\n                </div>\n\n                <div>\n                  <div className=\"mb-2 text-gray-400 text-xs\">\n                    ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆ: {contrast}%\n                  </div>\n                  <Slider\n                    value={[contrast]}\n                    onValueChange={(value) => setContrast(value[0])}\n                    min={0}\n                    max={200}\n                    step={1}\n                    className=\"w-full\"\n                  />\n                </div>\n\n                <div>\n                  <div className=\"mb-2 text-gray-400 text-xs\">\n                    å½©åº¦: {saturation}%\n                  </div>\n                  <Slider\n                    value={[saturation]}\n                    onValueChange={(value) => setSaturation(value[0])}\n                    min={0}\n                    max={200}\n                    step={1}\n                    className=\"w-full\"\n                  />\n                </div>\n\n                <div>\n                  <div className=\"mb-2 text-gray-400 text-xs\">è‰²ç›¸: {hue}Â°</div>\n                  <Slider\n                    value={[hue]}\n                    onValueChange={(value) => setHue(value[0])}\n                    min={-180}\n                    max={180}\n                    step={1}\n                    className=\"w-full\"\n                  />\n                </div>\n\n                <div className=\"flex gap-2\">\n                  <Button\n                    onClick={applyFilter}\n                    className=\"flex-1 bg-blue-600 text-white hover:bg-blue-700\"\n                  >\n                    é©ç”¨\n                  </Button>\n                  <Button\n                    onClick={resetFilters}\n                    variant=\"outline\"\n                    className=\"flex-1 border-gray-600 \"\n                  >\n                    ãƒªã‚»ãƒƒãƒˆ\n                  </Button>\n                </div>\n\n                <Button\n                  onClick={() => {\n                    resetFilters()\n                    // å…ƒç”»åƒã«æˆ»ã™\n                    if (originalImageData && imageCanvasRef.current) {\n                      const ctx = imageCanvasRef.current.getContext(\"2d\")\n                      if (ctx) {\n                        ctx.putImageData(originalImageData, 0, 0)\n                      }\n                    }\n                    setIsFilterPanelOpen(false)\n                  }}\n                  variant=\"outline\"\n                  className=\"w-full border-gray-600 \"\n                >\n                  ã‚­ãƒ£ãƒ³ã‚»ãƒ«\n                </Button>\n              </div>\n            )}\n\n            {/* ãƒ–ãƒ©ã‚·ã‚µã‚¤ã‚ºèª¿æ•´ */}\n            {(tool === \"brush\" || tool === \"eraser\") && (\n              <div className=\"mt-6\">\n                <div className=\"mb-2 text-gray-400 text-xs\">\n                  ãƒ–ãƒ©ã‚·ã‚µã‚¤ã‚º: {brushSize}px\n                </div>\n                <Slider\n                  value={[brushSize]}\n                  onValueChange={(value) => setBrushSize(value[0])}\n                  min={1}\n                  max={100}\n                  step={1}\n                  className=\"w-full\"\n                />\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* æ±ºå®šãƒ»ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒœã‚¿ãƒ³ */}\n        {props.isShowSubmitButton && (\n          <div className=\"fixed bottom-0 left-0 z-50 flex w-full gap-1 bg-gray-900 p-2\">\n            {/* ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒœã‚¿ãƒ³ */}\n            <Button\n              className=\"h-14 flex-1 rounded-lg bg-gray-600 font-bold text-lg text-white shadow-lg hover:bg-gray-700\"\n              onClick={() => {\n                // ã¾ãšonCloseã‚’å‘¼ã³å‡ºã™\n                if (props.onClose) {\n                  props.onClose()\n                }\n\n                // ç¢ºå®Ÿã«ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹ãŸã‚ã€Escapeã‚­ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºè¡Œ\n                const escEvent = new KeyboardEvent(\"keydown\", {\n                  key: \"Escape\",\n                  keyCode: 27,\n                  bubbles: true,\n                  cancelable: true,\n                })\n                document.dispatchEvent(escEvent)\n              }}\n            >\n              <XIcon className=\"mr-2 h-6 w-6\" />\n              ã‚­ãƒ£ãƒ³ã‚»ãƒ«\n            </Button>\n\n            {/* æ±ºå®šãƒœã‚¿ãƒ³ */}\n            <Button\n              className=\"h-14 flex-1 rounded-lg bg-blue-600 font-bold text-lg text-white shadow-lg hover:bg-blue-700\"\n              onClick={() => {\n                if (props.onSubmit) {\n                  const compositeCanvas = document.createElement(\"canvas\")\n                  const ctx = compositeCanvas.getContext(\"2d\")\n                  if (!ctx) return\n                  compositeCanvas.width = brushCanvasRef?.current?.width || 0\n                  compositeCanvas.height = brushCanvasRef?.current?.height || 0\n\n                  if (backgroundCanvasRef?.current) {\n                    ctx.drawImage(backgroundCanvasRef.current, 0, 0)\n                  }\n                  if (mosaicCanvasRef) {\n                    ctx.drawImage(mosaicCanvasRef, 0, 0)\n                  }\n                  if (imageCanvasRef?.current) {\n                    ctx.drawImage(imageCanvasRef.current, 0, 0)\n                  }\n                  if (brushCanvasRef?.current) {\n                    ctx.drawImage(brushCanvasRef.current, 0, 0)\n                  }\n\n                  const dataUrl = compositeCanvas.toDataURL(\n                    `image/${props.extension ?? \"webp\"}`,\n                    1.0,\n                  )\n                  props.onSubmit(dataUrl)\n                }\n                if (props.onClose) {\n                  props.onClose()\n                }\n              }}\n            >\n              æ±ºå®š\n            </Button>\n          </div>\n        )}\n      </div>\n\n      {/* é«˜åº¦ãªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ‘ãƒãƒ« */}\n      <ImageFilterPanel\n        isOpen={isAdvancedFilterPanelOpen}\n        onClose={() => setIsAdvancedFilterPanelOpen(false)}\n        onApply={handleAdvancedFilterApply}\n        onReset={handleResetAllFilters}\n        appliedFilters={appliedFilters}\n        originalImageData={originalImageData}\n        canvasSize={{ width: canvasWidth, height: canvasHeight }}\n      />\n    </section>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/responsive-photo-video-works-album.tsx"},"span":[6788,7018],"sourceCode":"import { graphql, type FragmentOf } from \"gql.tada\"\nimport { RowsPhotoAlbum } from \"react-photo-album\"\nimport SSR from \"react-photo-album/ssr\"\nimport \"react-photo-album/rows.css\"\nimport { Link } from \"@remix-run/react\"\nimport { LikeButton } from \"~/components/like-button\"\nimport { useRef, useCallback, useEffect, useState } from \"react\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { Heart } from \"lucide-react\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { Avatar, AvatarImage, AvatarFallback } from \"~/components/ui/avatar\"\n\ntype Props = {\n  works: FragmentOf<typeof PhotoAlbumVideoWorkFragment>[]\n  targetRowHeight?: number\n  isAutoPlay?: boolean\n}\n\n/**\n * ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œã®ä½œå“ä¸€è¦§\n */\nexport function ResponsivePhotoVideoWorksAlbum (props: Props): React.ReactNode {\n  const videoRefs = useRef<(HTMLVideoElement | null)[]>([])\n  const [isMobile, setIsMobile] = useState(false)\n\n  const isAutoPlay = props.isAutoPlay ?? true\n\n  // ãƒ¢ãƒã‚¤ãƒ«ãƒ‡ãƒã‚¤ã‚¹åˆ¤å®š\n  useEffect(() => {\n    const checkMobile = () => {\n      if (typeof window === \"undefined\") return false\n      return (\n        /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n          navigator.userAgent,\n        ) || window.innerWidth < 768\n      )\n    }\n    setIsMobile(checkMobile())\n  }, [])\n\n  const handleMouseEnter = useCallback((index: number) => {\n    if (isAutoPlay) {\n      return\n    }\n    const video = videoRefs.current[index]\n    if (video) {\n      video.style.zIndex = \"10\" // å‹•ç”»ã‚’å‰é¢ã«è¡¨ç¤º\n      video.play() // å‹•ç”»ã‚’å†ç”Ÿ\n    }\n  }, [])\n\n  const handleMouseLeave = useCallback((index: number) => {\n    if (isAutoPlay) {\n      return\n    }\n    const video = videoRefs.current[index]\n    if (video) {\n      video.pause() // å‹•ç”»ã‚’åœæ­¢\n      video.style.zIndex = \"-1\" // å‹•ç”»ã‚’èƒŒé¢ã«æˆ»ã™\n    }\n  }, [])\n\n  if (props.works.length === 1) {\n    return (\n      <div className=\"relative transition-all\" style={{ position: \"relative\" }}>\n        <div\n          className=\"relative inline-block h-full w-full\"\n          onMouseEnter={() => handleMouseEnter(Number(props.works[0].id))}\n          onMouseLeave={() => handleMouseLeave(Number(props.works[0].id))}\n        >\n          <Link\n            to={`/posts/${props.works[0].id}`}\n            className=\"max-h-32 overflow-hidden rounded\"\n          >\n            <video\n              src={props.works[0].url ?? \"\"}\n              // biome-ignore lint/suspicious/noAssignInExpressions: ref assignment\n              ref={(el) => (videoRefs.current[Number(props.works[0].id)] = el)}\n              className=\"absolute top-0 left-0 max-h-72 w-full overflow-hidden rounded object-contain\"\n              style={\n                isAutoPlay || isMobile ? { zIndex: \"10\" } : { zIndex: \"-1\" }\n              }\n              muted\n              autoPlay={isAutoPlay || isMobile}\n              loop\n              playsInline\n            >\n              <track\n                kind=\"captions\"\n                src={props.works[0].url ?? \"\"}\n                label=\"English\"\n              />\n            </video>\n\n            <div className=\"absolute top-1 left-1 opacity-50\">\n              <Badge variant={\"secondary\"} className=\"text-xs\">\n                {\"video\"}\n              </Badge>\n            </div>\n          </Link>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <SSR breakpoints={[300, 600, 900, 1200]}>\n      <RowsPhotoAlbum\n        photos={props.works.map((work, _index) => ({\n          key: work.id,\n          src: work.smallThumbnailImageURL,\n          url: work.url,\n          width: work.smallThumbnailImageWidth,\n          height: work.smallThumbnailImageHeight,\n          context: work,\n        }))}\n        targetRowHeight={\n          props.targetRowHeight !== undefined ? props.targetRowHeight : 240\n        }\n        sizes={{\n          size: \"calc(100vw - 240px)\",\n          sizes: [{ viewport: \"(max-width: 960px)\", size: \"100vw\" }],\n        }}\n        render={{\n          extras: (_, { photo, index }) => (\n            <div key={index}>\n              <div className=\"absolute right-1 bottom-12 z-10\">\n                <LikeButton\n                  size={56}\n                  targetWorkId={photo.context.id}\n                  targetWorkOwnerUserId={photo.context.user?.id ?? \"\"}\n                  defaultLiked={photo.context.isLiked}\n                  defaultLikedCount={0}\n                  isBackgroundNone={true}\n                  strokeWidth={2}\n                  likedCount={photo.context.likesCount}\n                />\n              </div>\n              <div className=\"mt-2 flex flex-col space-y-2 overflow-hidden text-ellipsis\">\n                <Link\n                  className=\"w-48 font-bold\"\n                  to={`/posts/${photo.context.id}`}\n                >\n                  <p className=\"overflow-hidden text-ellipsis text-nowrap text-xs\">\n                    {photo.context.title}\n                  </p>\n                </Link>\n                <Link to={`/users/${photo.context.user?.id}`}>\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center space-x-2\">\n                      <Avatar className=\"size-4\">\n                        <AvatarImage\n                          className=\"size-4 rounded-full\"\n                          src={withIconUrlFallback(photo.context.user?.iconUrl)}\n                          alt={photo.context.user?.name}\n                        />\n                        <AvatarFallback />\n                      </Avatar>\n                      <span className=\"block text-nowrap font-bold text-sm \">\n                        {photo.context.user?.name}\n                      </span>\n                    </div>\n                    <div className=\"flex items-center\">\n                      <div className=\"flex items-center space-x-1\">\n                        <Heart className=\"size-3 fill-gray-400 text-gray-400\" />\n                        <span className=\"text-xs\">\n                          {photo.context.likesCount}\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                </Link>\n              </div>\n            </div>\n          ),\n          link(props) {\n            return (\n              <div\n                style={props.style}\n                className={props.className}\n                role={props.role}\n                title={props[\"aria-label\"]}\n              >\n                {props.children}\n              </div>\n            )\n          },\n          image(props, context) {\n            return (\n              <div\n                className=\"relative transition-all\"\n                style={{ position: \"relative\" }}\n              >\n                <div\n                  className=\"relative inline-block h-full w-full\"\n                  onMouseEnter={() => handleMouseEnter(context.index)}\n                  onMouseLeave={() => handleMouseLeave(context.index)}\n                >\n                  <Link\n                    to={`/posts/${context.photo.context.id}`}\n                    className=\"overflow-hidden rounded\"\n                  >\n                    <img\n                      {...props}\n                      alt={props.alt}\n                      className=\"h-full w-full overflow-hidden rounded\"\n                    />\n                    <video\n                      src={context.photo.url ?? \"\"}\n                      // biome-ignore lint/suspicious/noAssignInExpressions: ref assignment\n                      ref={(el) => (videoRefs.current[context.index] = el)}\n                      className=\"absolute top-0 left-0 w-full overflow-hidden rounded object-contain\"\n                      style={\n                        isAutoPlay || isMobile\n                          ? { zIndex: \"10\" }\n                          : { zIndex: \"-1\" }\n                      }\n                      muted\n                      autoPlay={isAutoPlay || isMobile}\n                      loop\n                      playsInline\n                    >\n                      <track\n                        kind=\"captions\"\n                        src={context.photo.url ?? \"\"}\n                        label=\"English\"\n                      />\n                    </video>\n\n                    <div className=\"absolute top-1 left-1 opacity-50\">\n                      <Badge variant={\"secondary\"} className=\"text-xs\">\n                        {\"video\"}\n                      </Badge>\n                    </div>\n                  </Link>\n                </div>\n              </div>\n            )\n          },\n        }}\n      />\n    </SSR>\n  )\n}\n\nexport const PhotoAlbumVideoWorkFragment = graphql(\n  `fragment PhotoAlbumVideoWork on WorkNode @_unmask {\n    id\n    title\n    url\n    smallThumbnailImageHeight\n    smallThumbnailImageWidth\n    smallThumbnailImageURL\n    likesCount\n    isLiked\n    user {\n      id\n      name\n      iconUrl\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/responsive-photo-video-works-album.tsx"},"span":[2030,2252],"sourceCode":"import { graphql, type FragmentOf } from \"gql.tada\"\nimport { RowsPhotoAlbum } from \"react-photo-album\"\nimport SSR from \"react-photo-album/ssr\"\nimport \"react-photo-album/rows.css\"\nimport { Link } from \"@remix-run/react\"\nimport { LikeButton } from \"~/components/like-button\"\nimport { useRef, useCallback, useEffect, useState } from \"react\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { Heart } from \"lucide-react\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { Avatar, AvatarImage, AvatarFallback } from \"~/components/ui/avatar\"\n\ntype Props = {\n  works: FragmentOf<typeof PhotoAlbumVideoWorkFragment>[]\n  targetRowHeight?: number\n  isAutoPlay?: boolean\n}\n\n/**\n * ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œã®ä½œå“ä¸€è¦§\n */\nexport function ResponsivePhotoVideoWorksAlbum (props: Props): React.ReactNode {\n  const videoRefs = useRef<(HTMLVideoElement | null)[]>([])\n  const [isMobile, setIsMobile] = useState(false)\n\n  const isAutoPlay = props.isAutoPlay ?? true\n\n  // ãƒ¢ãƒã‚¤ãƒ«ãƒ‡ãƒã‚¤ã‚¹åˆ¤å®š\n  useEffect(() => {\n    const checkMobile = () => {\n      if (typeof window === \"undefined\") return false\n      return (\n        /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n          navigator.userAgent,\n        ) || window.innerWidth < 768\n      )\n    }\n    setIsMobile(checkMobile())\n  }, [])\n\n  const handleMouseEnter = useCallback((index: number) => {\n    if (isAutoPlay) {\n      return\n    }\n    const video = videoRefs.current[index]\n    if (video) {\n      video.style.zIndex = \"10\" // å‹•ç”»ã‚’å‰é¢ã«è¡¨ç¤º\n      video.play() // å‹•ç”»ã‚’å†ç”Ÿ\n    }\n  }, [])\n\n  const handleMouseLeave = useCallback((index: number) => {\n    if (isAutoPlay) {\n      return\n    }\n    const video = videoRefs.current[index]\n    if (video) {\n      video.pause() // å‹•ç”»ã‚’åœæ­¢\n      video.style.zIndex = \"-1\" // å‹•ç”»ã‚’èƒŒé¢ã«æˆ»ã™\n    }\n  }, [])\n\n  if (props.works.length === 1) {\n    return (\n      <div className=\"relative transition-all\" style={{ position: \"relative\" }}>\n        <div\n          className=\"relative inline-block h-full w-full\"\n          onMouseEnter={() => handleMouseEnter(Number(props.works[0].id))}\n          onMouseLeave={() => handleMouseLeave(Number(props.works[0].id))}\n        >\n          <Link\n            to={`/posts/${props.works[0].id}`}\n            className=\"max-h-32 overflow-hidden rounded\"\n          >\n            <video\n              src={props.works[0].url ?? \"\"}\n              // biome-ignore lint/suspicious/noAssignInExpressions: ref assignment\n              ref={(el) => (videoRefs.current[Number(props.works[0].id)] = el)}\n              className=\"absolute top-0 left-0 max-h-72 w-full overflow-hidden rounded object-contain\"\n              style={\n                isAutoPlay || isMobile ? { zIndex: \"10\" } : { zIndex: \"-1\" }\n              }\n              muted\n              autoPlay={isAutoPlay || isMobile}\n              loop\n              playsInline\n            >\n              <track\n                kind=\"captions\"\n                src={props.works[0].url ?? \"\"}\n                label=\"English\"\n              />\n            </video>\n\n            <div className=\"absolute top-1 left-1 opacity-50\">\n              <Badge variant={\"secondary\"} className=\"text-xs\">\n                {\"video\"}\n              </Badge>\n            </div>\n          </Link>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <SSR breakpoints={[300, 600, 900, 1200]}>\n      <RowsPhotoAlbum\n        photos={props.works.map((work, _index) => ({\n          key: work.id,\n          src: work.smallThumbnailImageURL,\n          url: work.url,\n          width: work.smallThumbnailImageWidth,\n          height: work.smallThumbnailImageHeight,\n          context: work,\n        }))}\n        targetRowHeight={\n          props.targetRowHeight !== undefined ? props.targetRowHeight : 240\n        }\n        sizes={{\n          size: \"calc(100vw - 240px)\",\n          sizes: [{ viewport: \"(max-width: 960px)\", size: \"100vw\" }],\n        }}\n        render={{\n          extras: (_, { photo, index }) => (\n            <div key={index}>\n              <div className=\"absolute right-1 bottom-12 z-10\">\n                <LikeButton\n                  size={56}\n                  targetWorkId={photo.context.id}\n                  targetWorkOwnerUserId={photo.context.user?.id ?? \"\"}\n                  defaultLiked={photo.context.isLiked}\n                  defaultLikedCount={0}\n                  isBackgroundNone={true}\n                  strokeWidth={2}\n                  likedCount={photo.context.likesCount}\n                />\n              </div>\n              <div className=\"mt-2 flex flex-col space-y-2 overflow-hidden text-ellipsis\">\n                <Link\n                  className=\"w-48 font-bold\"\n                  to={`/posts/${photo.context.id}`}\n                >\n                  <p className=\"overflow-hidden text-ellipsis text-nowrap text-xs\">\n                    {photo.context.title}\n                  </p>\n                </Link>\n                <Link to={`/users/${photo.context.user?.id}`}>\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center space-x-2\">\n                      <Avatar className=\"size-4\">\n                        <AvatarImage\n                          className=\"size-4 rounded-full\"\n                          src={withIconUrlFallback(photo.context.user?.iconUrl)}\n                          alt={photo.context.user?.name}\n                        />\n                        <AvatarFallback />\n                      </Avatar>\n                      <span className=\"block text-nowrap font-bold text-sm \">\n                        {photo.context.user?.name}\n                      </span>\n                    </div>\n                    <div className=\"flex items-center\">\n                      <div className=\"flex items-center space-x-1\">\n                        <Heart className=\"size-3 fill-gray-400 text-gray-400\" />\n                        <span className=\"text-xs\">\n                          {photo.context.likesCount}\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                </Link>\n              </div>\n            </div>\n          ),\n          link(props) {\n            return (\n              <div\n                style={props.style}\n                className={props.className}\n                role={props.role}\n                title={props[\"aria-label\"]}\n              >\n                {props.children}\n              </div>\n            )\n          },\n          image(props, context) {\n            return (\n              <div\n                className=\"relative transition-all\"\n                style={{ position: \"relative\" }}\n              >\n                <div\n                  className=\"relative inline-block h-full w-full\"\n                  onMouseEnter={() => handleMouseEnter(context.index)}\n                  onMouseLeave={() => handleMouseLeave(context.index)}\n                >\n                  <Link\n                    to={`/posts/${context.photo.context.id}`}\n                    className=\"overflow-hidden rounded\"\n                  >\n                    <img\n                      {...props}\n                      alt={props.alt}\n                      className=\"h-full w-full overflow-hidden rounded\"\n                    />\n                    <video\n                      src={context.photo.url ?? \"\"}\n                      // biome-ignore lint/suspicious/noAssignInExpressions: ref assignment\n                      ref={(el) => (videoRefs.current[context.index] = el)}\n                      className=\"absolute top-0 left-0 w-full overflow-hidden rounded object-contain\"\n                      style={\n                        isAutoPlay || isMobile\n                          ? { zIndex: \"10\" }\n                          : { zIndex: \"-1\" }\n                      }\n                      muted\n                      autoPlay={isAutoPlay || isMobile}\n                      loop\n                      playsInline\n                    >\n                      <track\n                        kind=\"captions\"\n                        src={context.photo.url ?? \"\"}\n                        label=\"English\"\n                      />\n                    </video>\n\n                    <div className=\"absolute top-1 left-1 opacity-50\">\n                      <Badge variant={\"secondary\"} className=\"text-xs\">\n                        {\"video\"}\n                      </Badge>\n                    </div>\n                  </Link>\n                </div>\n              </div>\n            )\n          },\n        }}\n      />\n    </SSR>\n  )\n}\n\nexport const PhotoAlbumVideoWorkFragment = graphql(\n  `fragment PhotoAlbumVideoWork on WorkNode @_unmask {\n    id\n    title\n    url\n    smallThumbnailImageHeight\n    smallThumbnailImageWidth\n    smallThumbnailImageURL\n    likesCount\n    isLiked\n    user {\n      id\n      name\n      iconUrl\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/useSemanticElements","severity":"error","description":"The elements with this role can be changed to the following elements:\n<button>","message":[{"elements":[],"content":"The elements with this role can be changed to the following elements:\n<button>"}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"For examples and more information, see "},{"elements":[{"Hyperlink":{"href":"https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles"}}],"content":"WAI-ARIA Roles"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/responsive-photo-works-album-fixed.tsx"},"span":[7752,7765],"sourceCode":"import { graphql, type FragmentOf } from \"gql.tada\"\nimport { RowsPhotoAlbum } from \"react-photo-album\"\nimport SSR from \"react-photo-album/ssr\"\nimport \"react-photo-album/rows.css\"\nimport { Link } from \"@remix-run/react\"\nimport { LikeButton } from \"~/components/like-button\"\nimport { CroppedWorkSquare } from \"~/components/cropped-work-square\"\nimport { Heart, Images, MessageCircle } from \"lucide-react\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { cn } from \"~/lib/utils\"\nimport { HomeCroppedWorks } from \"~/routes/($lang)._main._index/components/home-cropped-works\"\nimport { Avatar, AvatarImage, AvatarFallback } from \"~/components/ui/avatar\"\nimport { WorkCommentFragment } from \"~/routes/($lang)._main.posts.$post._index/components/work-comment\"\nimport { StickerButtonFragment } from \"~/routes/($lang)._main.posts.$post._index/components/sticker-button\"\nimport { OptimizedImage } from \"~/components/optimized-image\"\n\ntype Props = {\n  works: FragmentOf<typeof PhotoAlbumWorkFragment>[]\n  targetRowHeight?: number\n  direction?: \"rows\" | \"columns\"\n  size?: \"small\" | \"medium\" | \"large\"\n  isShowProfile?: boolean\n  /** ä½œå“ã‚¯ãƒªãƒƒã‚¯æ™‚ã« index ã‚’è¿”ã™ã€‚æœªæŒ‡å®šãªã‚‰å¾“æ¥é€šã‚Šãƒªãƒ³ã‚¯é·ç§» */\n  onSelect?: (index: string) => void\n}\n\n/**\n * ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œã®ä½œå“ä¸€è¦§\n */\nexport function ResponsivePhotoWorksAlbum (props: Props): React.ReactNode {\n  if (props.works.length <= 2) {\n    return (\n      <div className=\"flex flex-wrap justify-center gap-x-8 gap-y-8\">\n        {props.works.map((workItem, _index) => {\n          return (\n            <div\n              key={workItem.id.toString()}\n              className=\"relative flex flex-col space-y-2\"\n            >\n              <div className=\"relative\">\n                <CroppedWorkSquare\n                  workId={workItem.id}\n                  subWorksCount={workItem.subWorksCount}\n                  imageUrl={workItem.smallThumbnailImageURL}\n                  thumbnailImagePosition={workItem.thumbnailImagePosition ?? 0}\n                  size=\"lg\"\n                  imageWidth={workItem.smallThumbnailImageWidth}\n                  imageHeight={workItem.smallThumbnailImageHeight}\n                />\n                {workItem.subWorksCount > 0 && (\n                  <div className=\"absolute top-1 right-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                    <Images className=\"size-3 text-white\" />\n                    <div className=\"font-bold text-white text-xs\">\n                      {workItem.subWorksCount + 1}\n                    </div>\n                  </div>\n                )}\n                {workItem.commentsCount > 0 && (\n                  <div className=\"absolute top-1 left-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                    <MessageCircle className=\"size-3 text-white\" />\n                    <div className=\"font-bold text-white text-xs\">\n                      {workItem.commentsCount}\n                    </div>\n                  </div>\n                )}\n                <div className=\"absolute right-0 bottom-0\">\n                  <LikeButton\n                    size={56}\n                    targetWorkId={workItem.id}\n                    targetWorkOwnerUserId={workItem.user?.id ?? \"\"}\n                    defaultLiked={workItem.isLiked}\n                    defaultLikedCount={0}\n                    isBackgroundNone={true}\n                    strokeWidth={2}\n                    isTargetUserBlocked={workItem.user?.isBlocked ?? false}\n                  />\n                </div>\n              </div>\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n\n  return (\n    <>\n      <div className=\"hidden md:block\">\n        <SSR breakpoints={[300, 600, 900, 1200]}>\n          <RowsPhotoAlbum\n            photos={props.works.map((work) => ({\n              key: work.id,\n              id: work.id.toString(),\n              src:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageURL\n                  : work.smallThumbnailImageURL,\n              width:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageWidth\n                  : work.smallThumbnailImageWidth,\n              height:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageHeight\n                  : work.smallThumbnailImageHeight,\n              context: work,\n            }))}\n            targetRowHeight={\n              props.targetRowHeight !== undefined\n                ? props.targetRowHeight\n                : props.direction === \"rows\"\n                  ? 160\n                  : 220\n            }\n            sizes={{\n              size: \"calc(100vw - 240px)\",\n              sizes: [{ viewport: \"(max-width: 960px)\", size: \"100vw\" }],\n            }}\n            componentsProps={{\n              image: { loading: \"lazy\" },\n            }}\n            render={{\n              image: (imageProps, { photo }) => (\n                <div className=\"relative h-full w-full overflow-hidden rounded\">\n                  {props.onSelect ? (\n                    <button\n                      type=\"button\"\n                      className=\"block h-full w-full cursor-pointer overflow-hidden rounded\"\n                      onClick={() => props.onSelect?.(photo.id)}\n                      aria-label={`Open ${photo.context.title}`}\n                    >\n                      <OptimizedImage\n                        src={imageProps.src}\n                        alt={photo.context.title}\n                        width={\n                          typeof imageProps.width === \"string\"\n                            ? Number.parseInt(imageProps.width)\n                            : imageProps.width\n                        }\n                        height={\n                          typeof imageProps.height === \"string\"\n                            ? Number.parseInt(imageProps.height)\n                            : imageProps.height\n                        }\n                        loading={imageProps.loading as \"lazy\" | \"eager\"}\n                        className=\"h-full w-full transition-transform duration-300 ease-in-out hover:scale-105\"\n                      />\n                    </button>\n                  ) : (\n                    <Link\n                      className=\"block h-full w-full overflow-hidden rounded\"\n                      to={`/posts/${photo.context.id}`}\n                    >\n                      <OptimizedImage\n                        src={imageProps.src}\n                        alt={photo.context.title}\n                        width={\n                          typeof imageProps.width === \"string\"\n                            ? Number.parseInt(imageProps.width)\n                            : imageProps.width\n                        }\n                        height={\n                          typeof imageProps.height === \"string\"\n                            ? Number.parseInt(imageProps.height)\n                            : imageProps.height\n                        }\n                        loading={imageProps.loading as \"lazy\" | \"eager\"}\n                        className=\"h-full w-full transition-transform duration-300 ease-in-out hover:scale-105\"\n                      />\n                    </Link>\n                  )}\n                  {/* biome-ignore lint/a11y/useSemanticElements: wrapper prevents card navigation when interacting with LikeButton; cannot be a button due to nested button */}\n                  <div\n                    className={cn(\n                      \"absolute right-0 z-10\",\n                      props.isShowProfile ? \"bottom-14\" : \"bottom-0\",\n                    )}\n                    role=\"button\"\n                    onClick={(e) => {\n                      e.stopPropagation()\n                      e.preventDefault()\n                    }}\n                    onKeyDown={(e) => {\n                      if (e.key !== \"Enter\" && e.key !== \" \") return\n                      e.preventDefault()\n                      e.stopPropagation()\n                    }}\n                  >\n                    <LikeButton\n                      size={56}\n                      targetWorkId={photo.context.id}\n                      targetWorkOwnerUserId={photo.context.user?.id ?? \"\"}\n                      defaultLiked={photo.context.isLiked}\n                      defaultLikedCount={0}\n                      isBackgroundNone={true}\n                      strokeWidth={2}\n                      likedCount={photo.context.likesCount}\n                    />\n                  </div>\n                  {photo.context.subWorksCount > 0 && (\n                    <div className=\"absolute top-1 right-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                      <Images className=\"size-3 text-white\" />\n                      <div className=\"font-bold text-white text-xs\">\n                        {photo.context.subWorksCount + 1}\n                      </div>\n                    </div>\n                  )}\n                  {photo.context.commentsCount > 0 && (\n                    <div className=\"absolute top-1 left-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                      <MessageCircle className=\"size-3 text-white\" />\n                      <div className=\"font-bold text-white text-xs\">\n                        {photo.context.commentsCount}\n                      </div>\n                    </div>\n                  )}\n                  {props.isShowProfile && (\n                    <div className=\"mt-2 flex flex-col space-y-2 overflow-hidden text-ellipsis\">\n                      {props.onSelect ? (\n                        <button\n                          type=\"button\"\n                          className=\"w-48 cursor-pointer border-0 bg-transparent p-0 text-left font-bold\"\n                          onClick={(e) => {\n                            e.stopPropagation()\n                            props.onSelect?.(photo.context.id.toString())\n                          }}\n                          aria-label={`Open ${photo.context.title}`}\n                        >\n                          <p className=\"overflow-hidden text-ellipsis text-nowrap text-left text-sm\">\n                            {photo.context.title}\n                          </p>\n                        </button>\n                      ) : (\n                        <Link\n                          className=\"w-48 font-bold\"\n                          to={`/posts/${photo.context.id}`}\n                        >\n                          <p className=\"overflow-hidden text-ellipsis text-nowrap text-left text-sm\">\n                            {photo.context.title}\n                          </p>\n                        </Link>\n                      )}\n\n                      <div className=\"flex items-center justify-between\">\n                        <Link to={`/users/${photo.context.user?.id}`}>\n                          <div className=\"flex items-center space-x-2\">\n                            <Avatar className=\"size-6\">\n                              <AvatarImage\n                                className=\"size-6 rounded-full\"\n                                src={withIconUrlFallback(\n                                  photo.context.user?.iconUrl,\n                                )}\n                                alt=\"\"\n                              />\n                              <AvatarFallback />\n                            </Avatar>\n                            <span className=\"truncate text-sm\">\n                              {photo.context.user?.name}\n                            </span>\n                          </div>\n                        </Link>\n                        <div className=\"absolute right-0 ml-auto flex items-center space-x-1 rounded-md bg-card p-1\">\n                          <Heart className=\"size-3 fill-gray-400 text-gray-400\" />\n                          <span className=\"text-xs\">\n                            {photo.context.likesCount}\n                          </span>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              ),\n            }}\n          />\n        </SSR>\n      </div>\n      <div className=\"block md:hidden\">\n        <HomeCroppedWorks\n          works={props.works}\n          isShowProfile={true}\n          hasReferenceButton={false}\n        />\n      </div>\n    </>\n  )\n}\n\nexport const PhotoAlbumWorkFragment = graphql(\n  `fragment PhotoAlbumWork on WorkNode @_unmask {\n    id\n    isMyRecommended\n    title\n    mdUrl\n    accessType\n    type\n    adminAccessType\n    promptAccessType\n    rating\n    description\n    isSensitive\n    enTitle\n    enDescription\n    imageURL\n    largeThumbnailImageURL\n    largeThumbnailImageWidth\n    largeThumbnailImageHeight\n    smallThumbnailImageURL\n    smallThumbnailImageWidth\n    smallThumbnailImageHeight\n    thumbnailImagePosition\n    subWorksCount\n    url\n    isDeleted\n    user {\n      id\n      biography\n      enBiography\n      login\n      nanoid\n      name\n      receivedLikesCount\n      receivedViewsCount\n      awardsCount\n      followersCount\n      worksCount\n      iconUrl\n      headerImageUrl\n      webFcmToken\n      isFollower\n      isFollowee\n      headerImageUrl\n      receivedLikesCount\n      createdLikesCount\n      createdBookmarksCount\n      isMuted\n      isBlocked\n      promptonUser {\n        id\n      }\n    }\n    likedUsers(offset: 0, limit: 64) {\n      id\n      name\n      iconUrl\n      login\n    }\n    dailyTheme {\n      id\n      title\n      dateText\n    }\n    tagNames\n    createdAt\n    likesCount\n    viewsCount\n    commentsCount\n    subWorks {\n      id\n      imageUrl\n    }\n    model\n    modelHash\n    generationModelId\n    workModelId\n    isTagEditable\n    isCommentsEditable\n    isLiked\n    isBookmarked\n    isInCollection\n    isPromotion\n    isGeneration\n    ogpThumbnailImageUrl\n    prompt\n    negativePrompt\n    noise\n    seed\n    steps\n    sampler\n    scale\n    strength\n    vae\n    clipSkip\n    otherGenerationParams\n    pngInfo\n    style\n    url\n    updatedAt\n    dailyRanking\n    weeklyRanking\n    monthlyRanking\n    relatedUrl\n    nanoid\n  }`,\n)\n\nconst _userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      iconUrl\n    }\n  }`,\n)\n\nexport const CommentListItemFragment = graphql(\n  `fragment Comment on CommentNode @_unmask {\n      ...WorkComment\n      responses(offset: 0, limit: 128) {\n        ...WorkComment\n      }\n  }`,\n  [WorkCommentFragment],\n)\n\nconst _createWorkCommentMutation = graphql(\n  `mutation CreateWorkComment($input: CreateWorkCommentInput!) {\n    createWorkComment(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst _createCommentLikeMutation = graphql(\n  `mutation CreateCommentLike($input: CreateCommentLikeInput!) {\n    createCommentLike(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst _deleteCommentLikeMutation = graphql(\n  `mutation DeleteCommentLike($input: DeleteCommentLikeInput!) {\n    deleteCommentLike(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst _viewerUserQuery = graphql(\n  `query ViewerUser {\n    viewer {\n      id\n      user {\n        id\n        iconUrl\n      }\n      userStickers(offset: 0, limit: 5, orderBy: DATE_USED) {\n        ...StickerButton\n      }\n    }\n  }`,\n  [StickerButtonFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/useFocusableInteractive","severity":"error","description":"The HTML element with the interactive role \"button\" is not focusable.","message":[{"elements":[],"content":"The HTML element with the interactive role "},{"elements":["Emphasis"],"content":"\"button\""},{"elements":[],"content":" is not focusable."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"A non-interactive HTML element that is not focusable may not be reachable for users that rely on keyboard navigation, even with an added role like "},{"elements":["Emphasis"],"content":"\"button\""},{"elements":[],"content":"."}]]},{"log":["info",[{"elements":[],"content":"Add a "},{"elements":["Emphasis"],"content":"tabIndex"},{"elements":[],"content":" attribute to make this element focusable."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/responsive-photo-works-album-fixed.tsx"},"span":[7552,8144],"sourceCode":"import { graphql, type FragmentOf } from \"gql.tada\"\nimport { RowsPhotoAlbum } from \"react-photo-album\"\nimport SSR from \"react-photo-album/ssr\"\nimport \"react-photo-album/rows.css\"\nimport { Link } from \"@remix-run/react\"\nimport { LikeButton } from \"~/components/like-button\"\nimport { CroppedWorkSquare } from \"~/components/cropped-work-square\"\nimport { Heart, Images, MessageCircle } from \"lucide-react\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { cn } from \"~/lib/utils\"\nimport { HomeCroppedWorks } from \"~/routes/($lang)._main._index/components/home-cropped-works\"\nimport { Avatar, AvatarImage, AvatarFallback } from \"~/components/ui/avatar\"\nimport { WorkCommentFragment } from \"~/routes/($lang)._main.posts.$post._index/components/work-comment\"\nimport { StickerButtonFragment } from \"~/routes/($lang)._main.posts.$post._index/components/sticker-button\"\nimport { OptimizedImage } from \"~/components/optimized-image\"\n\ntype Props = {\n  works: FragmentOf<typeof PhotoAlbumWorkFragment>[]\n  targetRowHeight?: number\n  direction?: \"rows\" | \"columns\"\n  size?: \"small\" | \"medium\" | \"large\"\n  isShowProfile?: boolean\n  /** ä½œå“ã‚¯ãƒªãƒƒã‚¯æ™‚ã« index ã‚’è¿”ã™ã€‚æœªæŒ‡å®šãªã‚‰å¾“æ¥é€šã‚Šãƒªãƒ³ã‚¯é·ç§» */\n  onSelect?: (index: string) => void\n}\n\n/**\n * ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œã®ä½œå“ä¸€è¦§\n */\nexport function ResponsivePhotoWorksAlbum (props: Props): React.ReactNode {\n  if (props.works.length <= 2) {\n    return (\n      <div className=\"flex flex-wrap justify-center gap-x-8 gap-y-8\">\n        {props.works.map((workItem, _index) => {\n          return (\n            <div\n              key={workItem.id.toString()}\n              className=\"relative flex flex-col space-y-2\"\n            >\n              <div className=\"relative\">\n                <CroppedWorkSquare\n                  workId={workItem.id}\n                  subWorksCount={workItem.subWorksCount}\n                  imageUrl={workItem.smallThumbnailImageURL}\n                  thumbnailImagePosition={workItem.thumbnailImagePosition ?? 0}\n                  size=\"lg\"\n                  imageWidth={workItem.smallThumbnailImageWidth}\n                  imageHeight={workItem.smallThumbnailImageHeight}\n                />\n                {workItem.subWorksCount > 0 && (\n                  <div className=\"absolute top-1 right-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                    <Images className=\"size-3 text-white\" />\n                    <div className=\"font-bold text-white text-xs\">\n                      {workItem.subWorksCount + 1}\n                    </div>\n                  </div>\n                )}\n                {workItem.commentsCount > 0 && (\n                  <div className=\"absolute top-1 left-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                    <MessageCircle className=\"size-3 text-white\" />\n                    <div className=\"font-bold text-white text-xs\">\n                      {workItem.commentsCount}\n                    </div>\n                  </div>\n                )}\n                <div className=\"absolute right-0 bottom-0\">\n                  <LikeButton\n                    size={56}\n                    targetWorkId={workItem.id}\n                    targetWorkOwnerUserId={workItem.user?.id ?? \"\"}\n                    defaultLiked={workItem.isLiked}\n                    defaultLikedCount={0}\n                    isBackgroundNone={true}\n                    strokeWidth={2}\n                    isTargetUserBlocked={workItem.user?.isBlocked ?? false}\n                  />\n                </div>\n              </div>\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n\n  return (\n    <>\n      <div className=\"hidden md:block\">\n        <SSR breakpoints={[300, 600, 900, 1200]}>\n          <RowsPhotoAlbum\n            photos={props.works.map((work) => ({\n              key: work.id,\n              id: work.id.toString(),\n              src:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageURL\n                  : work.smallThumbnailImageURL,\n              width:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageWidth\n                  : work.smallThumbnailImageWidth,\n              height:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageHeight\n                  : work.smallThumbnailImageHeight,\n              context: work,\n            }))}\n            targetRowHeight={\n              props.targetRowHeight !== undefined\n                ? props.targetRowHeight\n                : props.direction === \"rows\"\n                  ? 160\n                  : 220\n            }\n            sizes={{\n              size: \"calc(100vw - 240px)\",\n              sizes: [{ viewport: \"(max-width: 960px)\", size: \"100vw\" }],\n            }}\n            componentsProps={{\n              image: { loading: \"lazy\" },\n            }}\n            render={{\n              image: (imageProps, { photo }) => (\n                <div className=\"relative h-full w-full overflow-hidden rounded\">\n                  {props.onSelect ? (\n                    <button\n                      type=\"button\"\n                      className=\"block h-full w-full cursor-pointer overflow-hidden rounded\"\n                      onClick={() => props.onSelect?.(photo.id)}\n                      aria-label={`Open ${photo.context.title}`}\n                    >\n                      <OptimizedImage\n                        src={imageProps.src}\n                        alt={photo.context.title}\n                        width={\n                          typeof imageProps.width === \"string\"\n                            ? Number.parseInt(imageProps.width)\n                            : imageProps.width\n                        }\n                        height={\n                          typeof imageProps.height === \"string\"\n                            ? Number.parseInt(imageProps.height)\n                            : imageProps.height\n                        }\n                        loading={imageProps.loading as \"lazy\" | \"eager\"}\n                        className=\"h-full w-full transition-transform duration-300 ease-in-out hover:scale-105\"\n                      />\n                    </button>\n                  ) : (\n                    <Link\n                      className=\"block h-full w-full overflow-hidden rounded\"\n                      to={`/posts/${photo.context.id}`}\n                    >\n                      <OptimizedImage\n                        src={imageProps.src}\n                        alt={photo.context.title}\n                        width={\n                          typeof imageProps.width === \"string\"\n                            ? Number.parseInt(imageProps.width)\n                            : imageProps.width\n                        }\n                        height={\n                          typeof imageProps.height === \"string\"\n                            ? Number.parseInt(imageProps.height)\n                            : imageProps.height\n                        }\n                        loading={imageProps.loading as \"lazy\" | \"eager\"}\n                        className=\"h-full w-full transition-transform duration-300 ease-in-out hover:scale-105\"\n                      />\n                    </Link>\n                  )}\n                  {/* biome-ignore lint/a11y/useSemanticElements: wrapper prevents card navigation when interacting with LikeButton; cannot be a button due to nested button */}\n                  <div\n                    className={cn(\n                      \"absolute right-0 z-10\",\n                      props.isShowProfile ? \"bottom-14\" : \"bottom-0\",\n                    )}\n                    role=\"button\"\n                    onClick={(e) => {\n                      e.stopPropagation()\n                      e.preventDefault()\n                    }}\n                    onKeyDown={(e) => {\n                      if (e.key !== \"Enter\" && e.key !== \" \") return\n                      e.preventDefault()\n                      e.stopPropagation()\n                    }}\n                  >\n                    <LikeButton\n                      size={56}\n                      targetWorkId={photo.context.id}\n                      targetWorkOwnerUserId={photo.context.user?.id ?? \"\"}\n                      defaultLiked={photo.context.isLiked}\n                      defaultLikedCount={0}\n                      isBackgroundNone={true}\n                      strokeWidth={2}\n                      likedCount={photo.context.likesCount}\n                    />\n                  </div>\n                  {photo.context.subWorksCount > 0 && (\n                    <div className=\"absolute top-1 right-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                      <Images className=\"size-3 text-white\" />\n                      <div className=\"font-bold text-white text-xs\">\n                        {photo.context.subWorksCount + 1}\n                      </div>\n                    </div>\n                  )}\n                  {photo.context.commentsCount > 0 && (\n                    <div className=\"absolute top-1 left-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                      <MessageCircle className=\"size-3 text-white\" />\n                      <div className=\"font-bold text-white text-xs\">\n                        {photo.context.commentsCount}\n                      </div>\n                    </div>\n                  )}\n                  {props.isShowProfile && (\n                    <div className=\"mt-2 flex flex-col space-y-2 overflow-hidden text-ellipsis\">\n                      {props.onSelect ? (\n                        <button\n                          type=\"button\"\n                          className=\"w-48 cursor-pointer border-0 bg-transparent p-0 text-left font-bold\"\n                          onClick={(e) => {\n                            e.stopPropagation()\n                            props.onSelect?.(photo.context.id.toString())\n                          }}\n                          aria-label={`Open ${photo.context.title}`}\n                        >\n                          <p className=\"overflow-hidden text-ellipsis text-nowrap text-left text-sm\">\n                            {photo.context.title}\n                          </p>\n                        </button>\n                      ) : (\n                        <Link\n                          className=\"w-48 font-bold\"\n                          to={`/posts/${photo.context.id}`}\n                        >\n                          <p className=\"overflow-hidden text-ellipsis text-nowrap text-left text-sm\">\n                            {photo.context.title}\n                          </p>\n                        </Link>\n                      )}\n\n                      <div className=\"flex items-center justify-between\">\n                        <Link to={`/users/${photo.context.user?.id}`}>\n                          <div className=\"flex items-center space-x-2\">\n                            <Avatar className=\"size-6\">\n                              <AvatarImage\n                                className=\"size-6 rounded-full\"\n                                src={withIconUrlFallback(\n                                  photo.context.user?.iconUrl,\n                                )}\n                                alt=\"\"\n                              />\n                              <AvatarFallback />\n                            </Avatar>\n                            <span className=\"truncate text-sm\">\n                              {photo.context.user?.name}\n                            </span>\n                          </div>\n                        </Link>\n                        <div className=\"absolute right-0 ml-auto flex items-center space-x-1 rounded-md bg-card p-1\">\n                          <Heart className=\"size-3 fill-gray-400 text-gray-400\" />\n                          <span className=\"text-xs\">\n                            {photo.context.likesCount}\n                          </span>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              ),\n            }}\n          />\n        </SSR>\n      </div>\n      <div className=\"block md:hidden\">\n        <HomeCroppedWorks\n          works={props.works}\n          isShowProfile={true}\n          hasReferenceButton={false}\n        />\n      </div>\n    </>\n  )\n}\n\nexport const PhotoAlbumWorkFragment = graphql(\n  `fragment PhotoAlbumWork on WorkNode @_unmask {\n    id\n    isMyRecommended\n    title\n    mdUrl\n    accessType\n    type\n    adminAccessType\n    promptAccessType\n    rating\n    description\n    isSensitive\n    enTitle\n    enDescription\n    imageURL\n    largeThumbnailImageURL\n    largeThumbnailImageWidth\n    largeThumbnailImageHeight\n    smallThumbnailImageURL\n    smallThumbnailImageWidth\n    smallThumbnailImageHeight\n    thumbnailImagePosition\n    subWorksCount\n    url\n    isDeleted\n    user {\n      id\n      biography\n      enBiography\n      login\n      nanoid\n      name\n      receivedLikesCount\n      receivedViewsCount\n      awardsCount\n      followersCount\n      worksCount\n      iconUrl\n      headerImageUrl\n      webFcmToken\n      isFollower\n      isFollowee\n      headerImageUrl\n      receivedLikesCount\n      createdLikesCount\n      createdBookmarksCount\n      isMuted\n      isBlocked\n      promptonUser {\n        id\n      }\n    }\n    likedUsers(offset: 0, limit: 64) {\n      id\n      name\n      iconUrl\n      login\n    }\n    dailyTheme {\n      id\n      title\n      dateText\n    }\n    tagNames\n    createdAt\n    likesCount\n    viewsCount\n    commentsCount\n    subWorks {\n      id\n      imageUrl\n    }\n    model\n    modelHash\n    generationModelId\n    workModelId\n    isTagEditable\n    isCommentsEditable\n    isLiked\n    isBookmarked\n    isInCollection\n    isPromotion\n    isGeneration\n    ogpThumbnailImageUrl\n    prompt\n    negativePrompt\n    noise\n    seed\n    steps\n    sampler\n    scale\n    strength\n    vae\n    clipSkip\n    otherGenerationParams\n    pngInfo\n    style\n    url\n    updatedAt\n    dailyRanking\n    weeklyRanking\n    monthlyRanking\n    relatedUrl\n    nanoid\n  }`,\n)\n\nconst _userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      iconUrl\n    }\n  }`,\n)\n\nexport const CommentListItemFragment = graphql(\n  `fragment Comment on CommentNode @_unmask {\n      ...WorkComment\n      responses(offset: 0, limit: 128) {\n        ...WorkComment\n      }\n  }`,\n  [WorkCommentFragment],\n)\n\nconst _createWorkCommentMutation = graphql(\n  `mutation CreateWorkComment($input: CreateWorkCommentInput!) {\n    createWorkComment(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst _createCommentLikeMutation = graphql(\n  `mutation CreateCommentLike($input: CreateCommentLikeInput!) {\n    createCommentLike(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst _deleteCommentLikeMutation = graphql(\n  `mutation DeleteCommentLike($input: DeleteCommentLikeInput!) {\n    deleteCommentLike(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst _viewerUserQuery = graphql(\n  `query ViewerUser {\n    viewer {\n      id\n      user {\n        id\n        iconUrl\n      }\n      userStickers(offset: 0, limit: 5, orderBy: DATE_USED) {\n        ...StickerButton\n      }\n    }\n  }`,\n  [StickerButtonFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/responsive-photo-works-album.tsx"},"span":[7636,7979],"sourceCode":"import { graphql, type FragmentOf } from \"gql.tada\"\nimport { RowsPhotoAlbum } from \"react-photo-album\"\nimport SSR from \"react-photo-album/ssr\"\nimport \"react-photo-album/rows.css\"\nimport { Link } from \"@remix-run/react\"\nimport { LikeButton } from \"~/components/like-button\"\nimport { CroppedWorkSquare } from \"~/components/cropped-work-square\"\nimport { Heart, Images, MessageCircle } from \"lucide-react\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { cn } from \"~/lib/utils\"\nimport { HomeCroppedWorks } from \"~/routes/($lang)._main._index/components/home-cropped-works\"\nimport { Avatar, AvatarImage, AvatarFallback } from \"~/components/ui/avatar\"\nimport { WorkCommentFragment } from \"~/routes/($lang)._main.posts.$post._index/components/work-comment\"\nimport { StickerButtonFragment } from \"~/routes/($lang)._main.posts.$post._index/components/sticker-button\"\nimport { WorkMediaBadge } from \"~/components/work-media-badge\"\nimport { HoverVideoImage } from \"~/components/hover-video-image\"\n\ntype Props = {\n  works: FragmentOf<typeof PhotoAlbumWorkFragment>[]\n  targetRowHeight?: number\n  direction?: \"rows\" | \"columns\"\n  size?: \"small\" | \"medium\" | \"large\"\n  isShowProfile?: boolean\n  /** ä½œå“ã‚¯ãƒªãƒƒã‚¯æ™‚ã« index ã‚’è¿”ã™ã€‚æœªæŒ‡å®šãªã‚‰å¾“æ¥é€šã‚Šãƒªãƒ³ã‚¯é·ç§» */\n  onSelect?: (index: string) => void\n  /** ãƒ¦ãƒ¼ã‚¶ãƒªãƒ³ã‚¯ã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼ˆä¾‹: \"/users\" ã¾ãŸã¯ \"/posts/gallery/users\"ï¼‰ */\n  userLinkPrefix?: string\n}\n\n/**\n * ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œã®ä½œå“ä¸€è¦§\n */\nexport function ResponsivePhotoWorksAlbum (props: Props): React.ReactNode {\n  if (props.works.length <= 2) {\n    return (\n      <div className=\"flex flex-wrap justify-center gap-x-8 gap-y-8\">\n        {props.works.map((workItem, _index) => {\n          return (\n            <div\n              key={workItem.id.toString()}\n              className=\"relative flex flex-col space-y-2\"\n            >\n              <div className=\"relative\">\n                <CroppedWorkSquare\n                  workId={workItem.id}\n                  subWorksCount={workItem.subWorksCount}\n                  imageUrl={workItem.smallThumbnailImageURL}\n                  thumbnailImagePosition={workItem.thumbnailImagePosition ?? 0}\n                  size=\"lg\"\n                  imageWidth={workItem.smallThumbnailImageWidth}\n                  imageHeight={workItem.smallThumbnailImageHeight}\n                  isPromptPublic={\n                    workItem.promptAccessType === \"PUBLIC\" ||\n                    workItem.isGeneration\n                  }\n                  hasVideoUrl={Boolean(workItem.url)}\n                />\n                {workItem.subWorksCount > 0 && (\n                  <div className=\"absolute top-1 right-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                    <Images className=\"size-3 text-white\" />\n                    <div className=\"font-bold text-white text-xs\">\n                      {workItem.subWorksCount + 1}\n                    </div>\n                  </div>\n                )}\n                {workItem.commentsCount > 0 && (\n                  <div className=\"absolute top-1 left-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                    <MessageCircle className=\"size-3 text-white\" />\n                    <div className=\"font-bold text-white text-xs\">\n                      {workItem.commentsCount}\n                    </div>\n                  </div>\n                )}\n                <div className=\"absolute right-0 bottom-0\">\n                  <LikeButton\n                    size={56}\n                    targetWorkId={workItem.id}\n                    targetWorkOwnerUserId={workItem.user?.id ?? \"\"}\n                    defaultLiked={workItem.isLiked}\n                    defaultLikedCount={0}\n                    isBackgroundNone={true}\n                    strokeWidth={2}\n                  />\n                </div>\n              </div>\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n\n  return (\n    <>\n      <div className=\"hidden md:block\">\n        <SSR breakpoints={[300, 600, 900, 1200]}>\n          <RowsPhotoAlbum\n            photos={props.works.map((work) => ({\n              key: work.id,\n              id: work.id.toString(),\n              src:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageURL\n                  : work.smallThumbnailImageURL,\n              width:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageWidth\n                  : work.smallThumbnailImageWidth,\n              height:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageHeight\n                  : work.smallThumbnailImageHeight,\n              context: work,\n            }))}\n            targetRowHeight={\n              props.targetRowHeight !== undefined\n                ? props.targetRowHeight\n                : props.direction === \"rows\"\n                  ? 160\n                  : 220\n            }\n            sizes={{\n              size: \"calc(100vw - 240px)\",\n              sizes: [{ viewport: \"(max-width: 960px)\", size: \"100vw\" }],\n            }}\n            componentsProps={{\n              image: { loading: \"lazy\" },\n            }}\n            render={{\n              image: (imageProps, { photo }) => (\n                <div className=\"relative h-full w-full overflow-hidden rounded\">\n                  {props.onSelect ? (\n                    <button\n                      type=\"button\"\n                      className=\"block h-full w-full cursor-pointer overflow-hidden rounded\"\n                      onClick={() => props.onSelect?.(photo.id)}\n                      aria-label={`Open ${photo.context.title}`}\n                    >\n                      <HoverVideoImage\n                        workId={photo.context.id}\n                        imageUrl={imageProps.src}\n                        videoUrl={photo.context.url}\n                        alt={photo.context.title}\n                        width={\n                          typeof imageProps.width === \"string\"\n                            ? Number.parseInt(imageProps.width)\n                            : imageProps.width\n                        }\n                        height={\n                          typeof imageProps.height === \"string\"\n                            ? Number.parseInt(imageProps.height)\n                            : imageProps.height\n                        }\n                        loading={imageProps.loading as \"lazy\" | \"eager\"}\n                        className=\"h-full w-full\"\n                      />\n                    </button>\n                  ) : (\n                    <HoverVideoImage\n                      workId={photo.context.id}\n                      imageUrl={imageProps.src}\n                      videoUrl={photo.context.url}\n                      alt={photo.context.title}\n                      to={`/posts/${photo.context.id}`}\n                      width={\n                        typeof imageProps.width === \"string\"\n                          ? Number.parseInt(imageProps.width)\n                          : imageProps.width\n                      }\n                      height={\n                        typeof imageProps.height === \"string\"\n                          ? Number.parseInt(imageProps.height)\n                          : imageProps.height\n                      }\n                      loading={imageProps.loading as \"lazy\" | \"eager\"}\n                      className=\"h-full w-full overflow-hidden rounded\"\n                    />\n                  )}\n                  <div\n                    className={cn(\n                      \"absolute right-0 z-10\",\n                      props.isShowProfile ? \"bottom-14\" : \"bottom-0\",\n                    )}\n                    onClick={(e) => {\n                      e.stopPropagation()\n                      e.preventDefault()\n                    }}\n                  >\n                    <LikeButton\n                      size={56}\n                      targetWorkId={photo.context.id}\n                      targetWorkOwnerUserId={photo.context.user?.id ?? \"\"}\n                      defaultLiked={photo.context.isLiked}\n                      defaultLikedCount={0}\n                      isBackgroundNone={true}\n                      strokeWidth={2}\n                      likedCount={photo.context.likesCount}\n                    />\n                  </div>\n                  {photo.context.subWorksCount > 0 && (\n                    <div className=\"absolute top-1 right-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                      <Images className=\"size-3 text-white\" />\n                      <div className=\"font-bold text-white text-xs\">\n                        {photo.context.subWorksCount + 1}\n                      </div>\n                    </div>\n                  )}\n                  {photo.context.commentsCount > 0 && (\n                    <div className=\"absolute top-1 left-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                      <MessageCircle className=\"size-3 text-white\" />\n                      <div className=\"font-bold text-white text-xs\">\n                        {photo.context.commentsCount}\n                      </div>\n                    </div>\n                  )}\n                  {/* ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå…¬é–‹ãƒ»å‹•ç”»ãƒãƒƒã‚¸ */}\n                  <div\n                    className={cn(\n                      \"absolute z-10\",\n                      props.isShowProfile ? \"bottom-16\" : \"bottom-2\",\n                      // ã‚³ãƒ¡ãƒ³ãƒˆæ•°ãŒã‚ã‚‹å ´åˆã¯å³ä¸‹ã€ãªã„å ´åˆã¯å·¦ä¸‹\n                      // ãŸã ã—ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¡¨ç¤ºæ™‚ã®bottom-16ã§ã¯ã€ã„ã„ã­ãƒœã‚¿ãƒ³(right-0)ã¨ã®é‡è¤‡ã‚’é¿ã‘ã‚‹ãŸã‚å·¦ã«å›ºå®š\n                      props.isShowProfile\n                        ? \"left-1\"\n                        : photo.context.commentsCount > 0\n                          ? \"right-1\"\n                          : \"left-1\",\n                    )}\n                  >\n                    <WorkMediaBadge\n                      isPromptPublic={\n                        photo.context.promptAccessType === \"PUBLIC\"\n                      }\n                      hasVideoUrl={Boolean(photo.context.url)}\n                      isGeneration={photo.context.isGeneration}\n                      hasReferenceButton={false}\n                      size=\"md\"\n                    />\n                  </div>\n                  {props.isShowProfile && (\n                    <div className=\"mt-2 flex flex-col space-y-2 overflow-hidden text-ellipsis\">\n                      {props.onSelect ? (\n                        <button\n                          type=\"button\"\n                          className=\"w-48 cursor-pointer font-bold\"\n                          onClick={(e) => {\n                            e.stopPropagation()\n                            props.onSelect?.(photo.context.id.toString())\n                          }}\n                          aria-label={`Open ${photo.context.title}`}\n                        >\n                          <p className=\"overflow-hidden text-ellipsis text-nowrap text-left text-sm\">\n                            {photo.context.title}\n                          </p>\n                        </button>\n                      ) : (\n                        <Link\n                          className=\"w-48 font-bold\"\n                          to={`/posts/${photo.context.id}`}\n                        >\n                          <p className=\"overflow-hidden text-ellipsis text-nowrap text-left text-sm\">\n                            {photo.context.title}\n                          </p>\n                        </Link>\n                      )}\n\n                      <div className=\"flex items-center justify-between\">\n                        <Link\n                          to={`${props.userLinkPrefix || \"/users\"}/${photo.context.user?.id}`}\n                        >\n                          <div className=\"flex items-center space-x-2\">\n                            <Avatar className=\"size-6\">\n                              <AvatarImage\n                                className=\"size-6 rounded-full\"\n                                src={withIconUrlFallback(\n                                  photo.context.user?.iconUrl,\n                                )}\n                                alt=\"\"\n                              />\n                              <AvatarFallback />\n                            </Avatar>\n                            <span className=\"truncate text-sm\">\n                              {photo.context.user?.name}\n                            </span>\n                          </div>\n                        </Link>\n                        <div className=\"absolute right-0 ml-auto flex items-center space-x-1 rounded-md bg-card p-1\">\n                          <Heart className=\"size-3 fill-gray-400 text-gray-400\" />\n                          <span className=\"text-xs\">\n                            {photo.context.likesCount}\n                          </span>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              ),\n            }}\n          />\n        </SSR>\n      </div>\n      <div className=\"block md:hidden\">\n        <HomeCroppedWorks\n          works={props.works}\n          isShowProfile={true}\n          hasReferenceButton={false}\n          onSelect={props.onSelect}\n        />\n      </div>\n    </>\n  )\n}\n\nexport const PhotoAlbumWorkFragment = graphql(\n  `fragment PhotoAlbumWork on WorkNode @_unmask {\n    id\n    isMyRecommended\n    title\n    mdUrl\n    accessType\n    type\n    adminAccessType\n    promptAccessType\n    rating\n    description\n    isSensitive\n    enTitle\n    enDescription\n    imageURL\n    largeThumbnailImageURL\n    largeThumbnailImageWidth\n    largeThumbnailImageHeight\n    smallThumbnailImageURL\n    smallThumbnailImageWidth\n    smallThumbnailImageHeight\n    thumbnailImagePosition\n    subWorksCount\n    url\n    isDeleted\n    user {\n      id\n      biography\n      enBiography\n      login\n      nanoid\n      name\n      receivedLikesCount\n      receivedViewsCount\n      awardsCount\n      followersCount\n      worksCount\n      iconUrl\n      headerImageUrl\n      webFcmToken\n      isFollower\n      isFollowee\n      headerImageUrl\n      receivedLikesCount\n      createdLikesCount\n      createdBookmarksCount\n      isMuted\n      isBlocked\n      promptonUser {\n        id\n      }\n    }\n    likedUsers(offset: 0, limit: 64) {\n      id\n      name\n      iconUrl\n      login\n    }\n    dailyTheme {\n      id\n      title\n      dateText\n    }\n    tagNames\n    createdAt\n    likesCount\n    viewsCount\n    commentsCount\n    subWorks {\n      id\n      imageUrl\n    }\n    model\n    modelHash\n    generationModelId\n    workModelId\n    isTagEditable\n    isCommentsEditable\n    isLiked\n    isBookmarked\n    isInCollection\n    isPromotion\n    isGeneration\n    ogpThumbnailImageUrl\n    prompt\n    negativePrompt\n    noise\n    seed\n    steps\n    sampler\n    scale\n    strength\n    vae\n    clipSkip\n    otherGenerationParams\n    pngInfo\n    style\n    url\n    updatedAt\n    dailyRanking\n    weeklyRanking\n    monthlyRanking\n    relatedUrl\n    nanoid\n  }`,\n)\n\nconst _userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      iconUrl\n    }\n  }`,\n)\n\nexport const CommentListItemFragment = graphql(\n  `fragment Comment on CommentNode @_unmask {\n      ...WorkComment\n      responses(offset: 0, limit: 128) {\n        ...WorkComment\n      }\n  }`,\n  [WorkCommentFragment],\n)\n\nconst _createWorkCommentMutation = graphql(\n  `mutation CreateWorkComment($input: CreateWorkCommentInput!) {\n    createWorkComment(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst _createCommentLikeMutation = graphql(\n  `mutation CreateCommentLike($input: CreateCommentLikeInput!) {\n    createCommentLike(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst _deleteCommentLikeMutation = graphql(\n  `mutation DeleteCommentLike($input: DeleteCommentLikeInput!) {\n    deleteCommentLike(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst _viewerUserQuery = graphql(\n  `query ViewerUser {\n    viewer {\n      id\n      user {\n        id\n        iconUrl\n      }\n      userStickers(offset: 0, limit: 5, orderBy: DATE_USED) {\n        ...StickerButton\n      }\n    }\n  }`,\n  [StickerButtonFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/useKeyWithClickEvents","severity":"error","description":"Enforce to have the onClick mouse event with the onKeyUp, the onKeyDown, or the onKeyPress keyboard event.","message":[{"elements":[],"content":"Enforce to have the "},{"elements":["Emphasis"],"content":"onClick"},{"elements":[],"content":" mouse event with the "},{"elements":["Emphasis"],"content":"onKeyUp"},{"elements":[],"content":", the "},{"elements":["Emphasis"],"content":"onKeyDown"},{"elements":[],"content":", or the "},{"elements":["Emphasis"],"content":"onKeyPress"},{"elements":[],"content":" keyboard event."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Actions triggered using mouse events should have corresponding keyboard events to account for keyboard-only navigation."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/responsive-photo-works-album.tsx"},"span":[7636,7979],"sourceCode":"import { graphql, type FragmentOf } from \"gql.tada\"\nimport { RowsPhotoAlbum } from \"react-photo-album\"\nimport SSR from \"react-photo-album/ssr\"\nimport \"react-photo-album/rows.css\"\nimport { Link } from \"@remix-run/react\"\nimport { LikeButton } from \"~/components/like-button\"\nimport { CroppedWorkSquare } from \"~/components/cropped-work-square\"\nimport { Heart, Images, MessageCircle } from \"lucide-react\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { cn } from \"~/lib/utils\"\nimport { HomeCroppedWorks } from \"~/routes/($lang)._main._index/components/home-cropped-works\"\nimport { Avatar, AvatarImage, AvatarFallback } from \"~/components/ui/avatar\"\nimport { WorkCommentFragment } from \"~/routes/($lang)._main.posts.$post._index/components/work-comment\"\nimport { StickerButtonFragment } from \"~/routes/($lang)._main.posts.$post._index/components/sticker-button\"\nimport { WorkMediaBadge } from \"~/components/work-media-badge\"\nimport { HoverVideoImage } from \"~/components/hover-video-image\"\n\ntype Props = {\n  works: FragmentOf<typeof PhotoAlbumWorkFragment>[]\n  targetRowHeight?: number\n  direction?: \"rows\" | \"columns\"\n  size?: \"small\" | \"medium\" | \"large\"\n  isShowProfile?: boolean\n  /** ä½œå“ã‚¯ãƒªãƒƒã‚¯æ™‚ã« index ã‚’è¿”ã™ã€‚æœªæŒ‡å®šãªã‚‰å¾“æ¥é€šã‚Šãƒªãƒ³ã‚¯é·ç§» */\n  onSelect?: (index: string) => void\n  /** ãƒ¦ãƒ¼ã‚¶ãƒªãƒ³ã‚¯ã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼ˆä¾‹: \"/users\" ã¾ãŸã¯ \"/posts/gallery/users\"ï¼‰ */\n  userLinkPrefix?: string\n}\n\n/**\n * ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œã®ä½œå“ä¸€è¦§\n */\nexport function ResponsivePhotoWorksAlbum (props: Props): React.ReactNode {\n  if (props.works.length <= 2) {\n    return (\n      <div className=\"flex flex-wrap justify-center gap-x-8 gap-y-8\">\n        {props.works.map((workItem, _index) => {\n          return (\n            <div\n              key={workItem.id.toString()}\n              className=\"relative flex flex-col space-y-2\"\n            >\n              <div className=\"relative\">\n                <CroppedWorkSquare\n                  workId={workItem.id}\n                  subWorksCount={workItem.subWorksCount}\n                  imageUrl={workItem.smallThumbnailImageURL}\n                  thumbnailImagePosition={workItem.thumbnailImagePosition ?? 0}\n                  size=\"lg\"\n                  imageWidth={workItem.smallThumbnailImageWidth}\n                  imageHeight={workItem.smallThumbnailImageHeight}\n                  isPromptPublic={\n                    workItem.promptAccessType === \"PUBLIC\" ||\n                    workItem.isGeneration\n                  }\n                  hasVideoUrl={Boolean(workItem.url)}\n                />\n                {workItem.subWorksCount > 0 && (\n                  <div className=\"absolute top-1 right-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                    <Images className=\"size-3 text-white\" />\n                    <div className=\"font-bold text-white text-xs\">\n                      {workItem.subWorksCount + 1}\n                    </div>\n                  </div>\n                )}\n                {workItem.commentsCount > 0 && (\n                  <div className=\"absolute top-1 left-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                    <MessageCircle className=\"size-3 text-white\" />\n                    <div className=\"font-bold text-white text-xs\">\n                      {workItem.commentsCount}\n                    </div>\n                  </div>\n                )}\n                <div className=\"absolute right-0 bottom-0\">\n                  <LikeButton\n                    size={56}\n                    targetWorkId={workItem.id}\n                    targetWorkOwnerUserId={workItem.user?.id ?? \"\"}\n                    defaultLiked={workItem.isLiked}\n                    defaultLikedCount={0}\n                    isBackgroundNone={true}\n                    strokeWidth={2}\n                  />\n                </div>\n              </div>\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n\n  return (\n    <>\n      <div className=\"hidden md:block\">\n        <SSR breakpoints={[300, 600, 900, 1200]}>\n          <RowsPhotoAlbum\n            photos={props.works.map((work) => ({\n              key: work.id,\n              id: work.id.toString(),\n              src:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageURL\n                  : work.smallThumbnailImageURL,\n              width:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageWidth\n                  : work.smallThumbnailImageWidth,\n              height:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageHeight\n                  : work.smallThumbnailImageHeight,\n              context: work,\n            }))}\n            targetRowHeight={\n              props.targetRowHeight !== undefined\n                ? props.targetRowHeight\n                : props.direction === \"rows\"\n                  ? 160\n                  : 220\n            }\n            sizes={{\n              size: \"calc(100vw - 240px)\",\n              sizes: [{ viewport: \"(max-width: 960px)\", size: \"100vw\" }],\n            }}\n            componentsProps={{\n              image: { loading: \"lazy\" },\n            }}\n            render={{\n              image: (imageProps, { photo }) => (\n                <div className=\"relative h-full w-full overflow-hidden rounded\">\n                  {props.onSelect ? (\n                    <button\n                      type=\"button\"\n                      className=\"block h-full w-full cursor-pointer overflow-hidden rounded\"\n                      onClick={() => props.onSelect?.(photo.id)}\n                      aria-label={`Open ${photo.context.title}`}\n                    >\n                      <HoverVideoImage\n                        workId={photo.context.id}\n                        imageUrl={imageProps.src}\n                        videoUrl={photo.context.url}\n                        alt={photo.context.title}\n                        width={\n                          typeof imageProps.width === \"string\"\n                            ? Number.parseInt(imageProps.width)\n                            : imageProps.width\n                        }\n                        height={\n                          typeof imageProps.height === \"string\"\n                            ? Number.parseInt(imageProps.height)\n                            : imageProps.height\n                        }\n                        loading={imageProps.loading as \"lazy\" | \"eager\"}\n                        className=\"h-full w-full\"\n                      />\n                    </button>\n                  ) : (\n                    <HoverVideoImage\n                      workId={photo.context.id}\n                      imageUrl={imageProps.src}\n                      videoUrl={photo.context.url}\n                      alt={photo.context.title}\n                      to={`/posts/${photo.context.id}`}\n                      width={\n                        typeof imageProps.width === \"string\"\n                          ? Number.parseInt(imageProps.width)\n                          : imageProps.width\n                      }\n                      height={\n                        typeof imageProps.height === \"string\"\n                          ? Number.parseInt(imageProps.height)\n                          : imageProps.height\n                      }\n                      loading={imageProps.loading as \"lazy\" | \"eager\"}\n                      className=\"h-full w-full overflow-hidden rounded\"\n                    />\n                  )}\n                  <div\n                    className={cn(\n                      \"absolute right-0 z-10\",\n                      props.isShowProfile ? \"bottom-14\" : \"bottom-0\",\n                    )}\n                    onClick={(e) => {\n                      e.stopPropagation()\n                      e.preventDefault()\n                    }}\n                  >\n                    <LikeButton\n                      size={56}\n                      targetWorkId={photo.context.id}\n                      targetWorkOwnerUserId={photo.context.user?.id ?? \"\"}\n                      defaultLiked={photo.context.isLiked}\n                      defaultLikedCount={0}\n                      isBackgroundNone={true}\n                      strokeWidth={2}\n                      likedCount={photo.context.likesCount}\n                    />\n                  </div>\n                  {photo.context.subWorksCount > 0 && (\n                    <div className=\"absolute top-1 right-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                      <Images className=\"size-3 text-white\" />\n                      <div className=\"font-bold text-white text-xs\">\n                        {photo.context.subWorksCount + 1}\n                      </div>\n                    </div>\n                  )}\n                  {photo.context.commentsCount > 0 && (\n                    <div className=\"absolute top-1 left-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                      <MessageCircle className=\"size-3 text-white\" />\n                      <div className=\"font-bold text-white text-xs\">\n                        {photo.context.commentsCount}\n                      </div>\n                    </div>\n                  )}\n                  {/* ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå…¬é–‹ãƒ»å‹•ç”»ãƒãƒƒã‚¸ */}\n                  <div\n                    className={cn(\n                      \"absolute z-10\",\n                      props.isShowProfile ? \"bottom-16\" : \"bottom-2\",\n                      // ã‚³ãƒ¡ãƒ³ãƒˆæ•°ãŒã‚ã‚‹å ´åˆã¯å³ä¸‹ã€ãªã„å ´åˆã¯å·¦ä¸‹\n                      // ãŸã ã—ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¡¨ç¤ºæ™‚ã®bottom-16ã§ã¯ã€ã„ã„ã­ãƒœã‚¿ãƒ³(right-0)ã¨ã®é‡è¤‡ã‚’é¿ã‘ã‚‹ãŸã‚å·¦ã«å›ºå®š\n                      props.isShowProfile\n                        ? \"left-1\"\n                        : photo.context.commentsCount > 0\n                          ? \"right-1\"\n                          : \"left-1\",\n                    )}\n                  >\n                    <WorkMediaBadge\n                      isPromptPublic={\n                        photo.context.promptAccessType === \"PUBLIC\"\n                      }\n                      hasVideoUrl={Boolean(photo.context.url)}\n                      isGeneration={photo.context.isGeneration}\n                      hasReferenceButton={false}\n                      size=\"md\"\n                    />\n                  </div>\n                  {props.isShowProfile && (\n                    <div className=\"mt-2 flex flex-col space-y-2 overflow-hidden text-ellipsis\">\n                      {props.onSelect ? (\n                        <button\n                          type=\"button\"\n                          className=\"w-48 cursor-pointer font-bold\"\n                          onClick={(e) => {\n                            e.stopPropagation()\n                            props.onSelect?.(photo.context.id.toString())\n                          }}\n                          aria-label={`Open ${photo.context.title}`}\n                        >\n                          <p className=\"overflow-hidden text-ellipsis text-nowrap text-left text-sm\">\n                            {photo.context.title}\n                          </p>\n                        </button>\n                      ) : (\n                        <Link\n                          className=\"w-48 font-bold\"\n                          to={`/posts/${photo.context.id}`}\n                        >\n                          <p className=\"overflow-hidden text-ellipsis text-nowrap text-left text-sm\">\n                            {photo.context.title}\n                          </p>\n                        </Link>\n                      )}\n\n                      <div className=\"flex items-center justify-between\">\n                        <Link\n                          to={`${props.userLinkPrefix || \"/users\"}/${photo.context.user?.id}`}\n                        >\n                          <div className=\"flex items-center space-x-2\">\n                            <Avatar className=\"size-6\">\n                              <AvatarImage\n                                className=\"size-6 rounded-full\"\n                                src={withIconUrlFallback(\n                                  photo.context.user?.iconUrl,\n                                )}\n                                alt=\"\"\n                              />\n                              <AvatarFallback />\n                            </Avatar>\n                            <span className=\"truncate text-sm\">\n                              {photo.context.user?.name}\n                            </span>\n                          </div>\n                        </Link>\n                        <div className=\"absolute right-0 ml-auto flex items-center space-x-1 rounded-md bg-card p-1\">\n                          <Heart className=\"size-3 fill-gray-400 text-gray-400\" />\n                          <span className=\"text-xs\">\n                            {photo.context.likesCount}\n                          </span>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              ),\n            }}\n          />\n        </SSR>\n      </div>\n      <div className=\"block md:hidden\">\n        <HomeCroppedWorks\n          works={props.works}\n          isShowProfile={true}\n          hasReferenceButton={false}\n          onSelect={props.onSelect}\n        />\n      </div>\n    </>\n  )\n}\n\nexport const PhotoAlbumWorkFragment = graphql(\n  `fragment PhotoAlbumWork on WorkNode @_unmask {\n    id\n    isMyRecommended\n    title\n    mdUrl\n    accessType\n    type\n    adminAccessType\n    promptAccessType\n    rating\n    description\n    isSensitive\n    enTitle\n    enDescription\n    imageURL\n    largeThumbnailImageURL\n    largeThumbnailImageWidth\n    largeThumbnailImageHeight\n    smallThumbnailImageURL\n    smallThumbnailImageWidth\n    smallThumbnailImageHeight\n    thumbnailImagePosition\n    subWorksCount\n    url\n    isDeleted\n    user {\n      id\n      biography\n      enBiography\n      login\n      nanoid\n      name\n      receivedLikesCount\n      receivedViewsCount\n      awardsCount\n      followersCount\n      worksCount\n      iconUrl\n      headerImageUrl\n      webFcmToken\n      isFollower\n      isFollowee\n      headerImageUrl\n      receivedLikesCount\n      createdLikesCount\n      createdBookmarksCount\n      isMuted\n      isBlocked\n      promptonUser {\n        id\n      }\n    }\n    likedUsers(offset: 0, limit: 64) {\n      id\n      name\n      iconUrl\n      login\n    }\n    dailyTheme {\n      id\n      title\n      dateText\n    }\n    tagNames\n    createdAt\n    likesCount\n    viewsCount\n    commentsCount\n    subWorks {\n      id\n      imageUrl\n    }\n    model\n    modelHash\n    generationModelId\n    workModelId\n    isTagEditable\n    isCommentsEditable\n    isLiked\n    isBookmarked\n    isInCollection\n    isPromotion\n    isGeneration\n    ogpThumbnailImageUrl\n    prompt\n    negativePrompt\n    noise\n    seed\n    steps\n    sampler\n    scale\n    strength\n    vae\n    clipSkip\n    otherGenerationParams\n    pngInfo\n    style\n    url\n    updatedAt\n    dailyRanking\n    weeklyRanking\n    monthlyRanking\n    relatedUrl\n    nanoid\n  }`,\n)\n\nconst _userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      iconUrl\n    }\n  }`,\n)\n\nexport const CommentListItemFragment = graphql(\n  `fragment Comment on CommentNode @_unmask {\n      ...WorkComment\n      responses(offset: 0, limit: 128) {\n        ...WorkComment\n      }\n  }`,\n  [WorkCommentFragment],\n)\n\nconst _createWorkCommentMutation = graphql(\n  `mutation CreateWorkComment($input: CreateWorkCommentInput!) {\n    createWorkComment(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst _createCommentLikeMutation = graphql(\n  `mutation CreateCommentLike($input: CreateCommentLikeInput!) {\n    createCommentLike(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst _deleteCommentLikeMutation = graphql(\n  `mutation DeleteCommentLike($input: DeleteCommentLikeInput!) {\n    deleteCommentLike(input: $input) {\n      id\n    }\n  }`,\n)\n\nconst _viewerUserQuery = graphql(\n  `query ViewerUser {\n    viewer {\n      id\n      user {\n        id\n        iconUrl\n      }\n      userStickers(offset: 0, limit: 5, orderBy: DATE_USED) {\n        ...StickerButton\n      }\n    }\n  }`,\n  [StickerButtonFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/sort-list-selector.tsx"},"span":[457,792],"sourceCode":"import { CheckIcon, ChevronDown, ChevronUp } from \"lucide-react\"\nimport type { SortType } from \"~/types/sort-type\"\nimport type { SortListSelectorType } from \"~/types/sort-list-selector-type\"\n\ntype Props = {\n  sortList: SortListSelectorType[]\n  nowSort: SortType\n  nowSortType: string\n}\n\nexport function SortListSelector (props: Props): React.ReactNode {\n  return (\n    <>\n      <div className=\"p-4\">\n        {props.sortList.map((item, index) => (\n          <div\n            key={`${item.sortType}-${index}`}\n            onClick={item.callback}\n            onKeyUp={item.callback}\n            onKeyDown={item.callback}\n            onKeyPress={item.callback}\n            className=\"flex w-full cursor-pointer items-center p-1 transition-all hover:bg-gray-100 dark:hover:bg-gray-800\"\n          >\n            {props.nowSortType === item.sortType ? (\n              <CheckIcon className=\"mr-2 w-4\" />\n            ) : (\n              <div className=\"w-6\" />\n            )}\n            <div className=\"m-2 flex items-center\">{item.label}</div>\n            {props.nowSortType === item.sortType && (\n              <div className=\"flex items-center\">\n                {props.nowSort === \"ASC\" ? (\n                  <div>\n                    <ChevronUp className=\"size-4\" />\n                    <ChevronDown className=\"size-4 opacity-40\" />\n                  </div>\n                ) : (\n                  <div>\n                    <ChevronUp className=\"size-4 opacity-40\" />\n                    <ChevronDown className=\"size-4\" />\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n        ))}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/useKeyWithClickEvents","severity":"error","description":"Enforce to have the onClick mouse event with the onKeyUp, the onKeyDown, or the onKeyPress keyboard event.","message":[{"elements":[],"content":"Enforce to have the "},{"elements":["Emphasis"],"content":"onClick"},{"elements":[],"content":" mouse event with the "},{"elements":["Emphasis"],"content":"onKeyUp"},{"elements":[],"content":", the "},{"elements":["Emphasis"],"content":"onKeyDown"},{"elements":[],"content":", or the "},{"elements":["Emphasis"],"content":"onKeyPress"},{"elements":[],"content":" keyboard event."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Actions triggered using mouse events should have corresponding keyboard events to account for keyboard-only navigation."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/stickers/persistent-sticker-panel.tsx"},"span":[4675,5035],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport {\n  StickerButton,\n  StickerButtonFragment,\n} from \"~/routes/($lang)._main.posts.$post._index/components/sticker-button\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { useContext, useState, useEffect } from \"react\"\nimport { graphql } from \"gql.tada\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { ChevronDownIcon, ChevronUpIcon, StampIcon } from \"lucide-react\"\nimport { cn } from \"~/lib/utils\"\n\ntype Props = {\n  onStickerClick?: (stickerId: string, stickerImageURL: string) => void\n  className?: string\n}\n\n/**\n * å¸¸ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚¹ã‚¿ãƒ³ãƒ—ãƒ‘ãƒãƒ«\n * ã‚¢ã‚¤ã‚³ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’æŠ¼ã•ãªãã¦ã‚‚ã‚¹ã‚¿ãƒ³ãƒ—ä¸€è¦§ãŒè¦‹ãˆã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ\n */\nexport function PersistentStickerPanel (props: Props): React.ReactNode {\n  const authContext = useContext(AuthContext)\n  const t = useTranslation()\n\n  const [isExpanded, setIsExpanded] = useState(false)\n  const [stickerPage, setStickerPage] = useState(0)\n\n  const maxStickersPage = 20 // ä¸€åº¦ã«è¡¨ç¤ºã™ã‚‹ã‚¹ã‚¿ãƒ³ãƒ—æ•°ã‚’åˆ¶é™\n\n  const { data: stickers, refetch } = useQuery(viewerUserStickersQuery, {\n    skip: authContext.isNotLoggedIn, // ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã„å ´åˆã®ã¿ã‚¹ã‚­ãƒƒãƒ—\n    variables: {\n      limit: maxStickersPage,\n      offset: stickerPage * maxStickersPage,\n      orderBy: \"DATE_CREATED\",\n    },\n  })\n\n  // ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ãŒå¤‰ã‚ã£ãŸã‚‰ãƒªãƒ•ã‚§ãƒƒãƒ\n  useEffect(() => {\n    if (authContext.login && !authContext.isLoading) {\n      refetch()\n    }\n  }, [authContext.login, authContext.isLoading, refetch])\n\n  // ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã„å ´åˆã¯è¡¨ç¤ºã—ãªã„\n  if (authContext.isNotLoggedIn) {\n    return null\n  }\n\n  // ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã¯è¡¨ç¤ºã—ãªã„\n  const userStickers = stickers?.viewer?.userStickers ?? []\n  if (userStickers.length === 0) {\n    return null\n  }\n\n  const handleStickerClick = (stickerId: string, imageUrl: string) => {\n    if (props.onStickerClick) {\n      props.onStickerClick(stickerId, imageUrl)\n    }\n  }\n\n  return (\n    <div\n      className={cn(\n        \"fixed right-4 bottom-4 z-30 w-80 rounded-lg border bg-background/95 shadow-lg backdrop-blur supports-backdrop-filter:bg-background/60\",\n        props.className,\n      )}\n    >\n      {/* ãƒ˜ãƒƒãƒ€ãƒ¼ */}\n      <div className=\"flex items-center justify-between border-b p-3\">\n        <div className=\"flex items-center space-x-2\">\n          <StampIcon className=\"h-5 w-5\" />\n          <span className=\"font-medium text-sm\">\n            {t(\"ãƒã‚¤ã‚¹ã‚¿ãƒ³ãƒ—\", \"My Stickers\")}\n          </span>\n        </div>\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          onClick={() => setIsExpanded(!isExpanded)}\n          className=\"h-8 w-8 p-0\"\n        >\n          {isExpanded ? (\n            <ChevronDownIcon className=\"h-4 w-4\" />\n          ) : (\n            <ChevronUpIcon className=\"h-4 w-4\" />\n          )}\n        </Button>\n      </div>\n\n      {/* ã‚¹ã‚¿ãƒ³ãƒ—ä¸€è¦§ */}\n      {isExpanded && (\n        <div className=\"p-3\">\n          <ScrollArea className=\"h-48\">\n            <div className=\"grid grid-cols-4 gap-2\">\n              {userStickers.map((sticker) => (\n                <StickerButton\n                  key={sticker.id}\n                  imageUrl={sticker.imageUrl ?? \"\"}\n                  title={sticker.title}\n                  onClick={() =>\n                    handleStickerClick(sticker.id, sticker.imageUrl ?? \"\")\n                  }\n                  size=\"small\"\n                />\n              ))}\n            </div>\n          </ScrollArea>\n\n          {/* ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ */}\n          {userStickers.length === maxStickersPage && (\n            <div className=\"mt-2 flex justify-center space-x-2\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => setStickerPage(Math.max(0, stickerPage - 1))}\n                disabled={stickerPage === 0}\n              >\n                {t(\"å‰\", \"Previous\")}\n              </Button>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => setStickerPage(stickerPage + 1)}\n              >\n                {t(\"æ¬¡\", \"Next\")}\n              </Button>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* æŠ˜ã‚ŠãŸãŸã¿æ™‚ã®ç°¡æ˜“è¡¨ç¤º */}\n      {!isExpanded && userStickers.length > 0 && (\n        <div className=\"flex items-center justify-center p-2\">\n          <div className=\"flex space-x-1\">\n            {userStickers.slice(0, 3).map((sticker) => (\n              <img\n                key={sticker.id}\n                src={sticker.imageUrl ?? \"\"}\n                alt={sticker.title}\n                className=\"h-8 w-8 cursor-pointer rounded border transition-transform hover:scale-110\"\n                onClick={() =>\n                  handleStickerClick(sticker.id, sticker.imageUrl ?? \"\")\n                }\n              />\n            ))}\n            {userStickers.length > 3 && (\n              <div className=\"flex h-8 w-8 items-center justify-center rounded border bg-muted text-xs\">\n                +{userStickers.length - 3}\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n\nconst viewerUserStickersQuery = graphql(\n  `query ViewerUserStickers($offset: Int!, $limit: Int!, $orderBy: StickerOrderBy, $where: UserStickersWhereInput) {\n    viewer {\n      id\n      userStickers(offset: $offset, limit: $limit, orderBy: $orderBy, where: $where) {\n        ...StickerButton\n      }\n    }\n  }`,\n  [StickerButtonFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/swipe-area.tsx"},"span":[1602,1842],"sourceCode":"import { useCallback, useState } from \"react\"\n\ntype Props = {\n  onPrev: () => void\n  onNext: () => void\n  children: React.ReactNode\n}\n\n/**\n * ã‚¹ãƒ¯ã‚¤ãƒ—ã‚¨ãƒªã‚¢\n * childrenã§æŒ‡å®šã•ã‚ŒãŸé ˜åŸŸã«ã¤ã„ã¦ã‚¹ãƒãƒ›ã€PCã§ã‚¹ãƒ¯ã‚¤ãƒ—æ“ä½œå¯èƒ½ã«ã™ã‚‹\n */\nexport function SwipeArea (props: Props): React.ReactNode {\n  const [startPosition, setStartPosition] = useState<number | null>(null)\n\n  const handleTouchStart = useCallback(\n    (e: React.TouchEvent<HTMLDivElement>) => {\n      const touch = e.touches[0]\n      setStartPosition(touch.clientX)\n    },\n    [],\n  )\n\n  const handleTouchEnd = useCallback(\n    (e: React.TouchEvent<HTMLDivElement>) => {\n      if (startPosition == null) return\n\n      const touch = e.changedTouches[0]\n      const endPosition = touch.clientX\n      const distance = endPosition - startPosition\n\n      if (distance > 50) {\n        props.onPrev()\n      } else if (distance < -50) {\n        props.onNext()\n      }\n\n      setStartPosition(null)\n    },\n    [props.onPrev, props.onNext, startPosition],\n  )\n\n  const handleMouseDown = useCallback((e: React.MouseEvent<HTMLDivElement>) => {\n    setStartPosition(e.clientX)\n  }, [])\n\n  const handleMouseUp = useCallback(\n    (e: React.MouseEvent<HTMLDivElement>) => {\n      if (startPosition == null) return\n\n      const endPosition = e.clientX\n      const distance = endPosition - startPosition\n\n      if (distance > 50) {\n        props.onPrev()\n      } else if (distance < -50) {\n        props.onNext()\n      }\n\n      setStartPosition(null)\n    },\n    [props.onPrev, props.onNext, startPosition],\n  )\n\n  return (\n    <div\n      onTouchStart={handleTouchStart}\n      onTouchEnd={handleTouchEnd}\n      onMouseDown={handleMouseDown}\n      onMouseUp={handleMouseUp}\n      style={{ touchAction: \"none\" }} // Prevents scrolling during swipe on touch devices\n    >\n      {props.children}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/tag/autocomplete.tsx"},"span":[1065,1498],"sourceCode":"// https://github.com/JaleelB/emblor/blob/main/website/components/tag/autocomplete.tsx\n\nimport type React from \"react\"\nimport {\n  Command,\n  CommandList,\n  CommandItem,\n  CommandGroup,\n  CommandEmpty,\n} from \"~/components/ui/command\"\nimport type { Tag as TagType } from \"./tag-input\"\n\ntype AutocompleteProps = {\n  tags: TagType[]\n  setTags: React.Dispatch<React.SetStateAction<TagType[]>>\n  autocompleteOptions: TagType[]\n  maxTags?: number\n  onTagAdd?: (tag: string) => void\n  allowDuplicates: boolean\n  children: React.ReactNode\n}\n\nexport function Autocomplete ({\n  tags,\n  setTags,\n  autocompleteOptions,\n  maxTags,\n  onTagAdd,\n  allowDuplicates,\n  children,\n}: AutocompleteProps): React.ReactNode {\n  return (\n    <Command className=\"border\">\n      {children}\n      <CommandList>\n        <CommandEmpty>{\"æ¤œç´¢çµæœãªã—\"}</CommandEmpty>\n        <CommandGroup heading=\"\">\n          {autocompleteOptions.map((option) => (\n            <CommandItem key={option.id}>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-full\"\n                onClick={() => {\n                  if (maxTags && tags.length >= maxTags) return\n                  if (\n                    !allowDuplicates &&\n                    tags.some((tag) => tag.text === option.text)\n                  )\n                    return\n                  setTags([...tags, option])\n                  onTagAdd?.(option.text)\n                }}\n              >\n                {option.text}\n              </div>\n            </CommandItem>\n          ))}\n        </CommandGroup>\n      </CommandList>\n    </Command>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/tag/tag-list.tsx"},"span":[1231,1640],"sourceCode":"import React from \"react\"\nimport type { Tag as TagType } from \"~/components/tag/tag-input\"\nimport { cn } from \"~/lib/utils\"\nimport { Tag, type TagProps } from \"~/components/tag/tag\"\n\nexport type TagListProps = {\n  tags: TagType[]\n  customTagRenderer?: (tag: TagType) => React.ReactNode\n  direction?: TagProps[\"direction\"]\n  onSortEnd: (oldIndex: number, newIndex: number) => void\n} & Omit<TagProps, \"tagObj\">\n\nconst _DropTarget: React.FC = () => {\n  return <div className={cn(\"h-full rounded-md bg-secondary/50\")} />\n}\n\nexport function TagList ({\n  tags,\n  customTagRenderer,\n  direction,\n  draggable,\n  onSortEnd,\n  ...tagListProps\n}: TagListProps): React.ReactNode {\n  const [draggedTagId, setDraggedTagId] = React.useState<string | null>(null)\n\n  const handleMouseDown = (id: string) => {\n    setDraggedTagId(id)\n  }\n\n  const handleMouseUp = () => {\n    setDraggedTagId(null)\n  }\n\n  if (tags.length === 0) {\n    return null\n  }\n\n  return (\n    <div\n      className={cn(\"rounded-md\", {\n        \"flex flex-wrap gap-2\": direction === \"row\",\n        \"flex flex-col gap-2\": direction === \"column\",\n      })}\n    >\n      {draggable ? (\n        <div className=\"list flex flex-wrap gap-2\">\n          {tags.map((tagObj) => (\n            <div\n              key={tagObj.id}\n              onMouseDown={() => handleMouseDown(tagObj.id)}\n              onMouseLeave={handleMouseUp}\n              className={cn(\n                {\n                  \"rounded-md border border-primary border-solid\":\n                    draggedTagId === tagObj.id,\n                },\n                \"transition-all duration-200 ease-in-out\",\n              )}\n            >\n              {customTagRenderer ? (\n                customTagRenderer(tagObj)\n              ) : (\n                <Tag tagObj={tagObj} {...tagListProps} />\n              )}\n            </div>\n          ))}\n        </div>\n      ) : (\n        tags.map((tagObj) =>\n          customTagRenderer ? (\n            customTagRenderer(tagObj)\n          ) : (\n            <Tag key={tagObj.id} tagObj={tagObj} {...tagListProps} />\n          ),\n        )\n      )}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/tag/tag.tsx"},"span":[2684,3125],"sourceCode":"// https://github.com/JaleelB/emblor/blob/main/website/components/tag/tag.tsx\n\nimport { X } from \"lucide-react\"\nimport { Button } from \"../ui/button\"\nimport type { TagInputProps, Tag as TagType } from \"./tag-input\"\nimport { cn } from \"~/lib/utils\"\nimport { cva } from \"class-variance-authority\"\n\nexport const tagVariants = cva(\n  \"transition-all border inline-flex items-center text-sm pl-2 rounded-md\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        primary:\n          \"bg-primary border-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive border-destructive text-destructive-foreground hover:bg-destructive/90\",\n      },\n      size: {\n        sm: \"text-xs h-7\",\n        md: \"text-sm h-8\",\n        lg: \"text-base h-9\",\n        xl: \"text-lg h-10\",\n      },\n      shape: {\n        default: \"rounded-sm\",\n        rounded: \"rounded-lg\",\n        square: \"rounded-none\",\n        pill: \"rounded-full\",\n      },\n      borderStyle: {\n        default: \"border-solid\",\n        none: \"border-none\",\n      },\n      textCase: {\n        uppercase: \"uppercase\",\n        lowercase: \"lowercase\",\n        capitalize: \"capitalize\",\n      },\n      interaction: {\n        clickable: \"cursor-pointer hover:shadow-md\",\n        nonClickable: \"cursor-default\",\n      },\n      animation: {\n        none: \"\",\n        fadeIn: \"animate-fadeIn\",\n        slideIn: \"animate-slideIn\",\n        bounce: \"animate-bounce\",\n      },\n      textStyle: {\n        normal: \"font-normal\",\n        bold: \"font-bold\",\n        italic: \"italic\",\n        underline: \"underline\",\n        lineThrough: \"line-through\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"md\",\n      shape: \"default\",\n      borderStyle: \"default\",\n      interaction: \"nonClickable\",\n      animation: \"fadeIn\",\n      textStyle: \"normal\",\n    },\n  },\n)\n\nexport type TagProps = {\n  tagObj: TagType\n  variant: TagInputProps[\"variant\"]\n  size: TagInputProps[\"size\"]\n  shape: TagInputProps[\"shape\"]\n  borderStyle: TagInputProps[\"borderStyle\"]\n  textCase: TagInputProps[\"textCase\"]\n  interaction: TagInputProps[\"interaction\"]\n  animation: TagInputProps[\"animation\"]\n  textStyle: TagInputProps[\"textStyle\"]\n  onRemoveTag: (id: string) => void\n} & Pick<TagInputProps, \"direction\" | \"onTagClick\" | \"draggable\">\n\nexport function Tag ({\n  tagObj,\n  direction,\n  draggable,\n  onTagClick,\n  onRemoveTag,\n  variant,\n  size,\n  shape,\n  borderStyle,\n  textCase,\n  interaction,\n  animation,\n  textStyle,\n}: TagProps): React.ReactNode {\n  return (\n    // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n    <span\n      key={tagObj.id}\n      draggable={draggable}\n      className={cn(\n        tagVariants({\n          variant,\n          size,\n          shape,\n          borderStyle,\n          textCase,\n          interaction,\n          animation,\n          textStyle,\n        }),\n        {\n          \"justify-between\": direction === \"column\",\n          \"cursor-pointer\": draggable,\n        },\n      )}\n      onClick={() => onTagClick?.(tagObj)}\n    >\n      {tagObj.text}\n      <Button\n        type=\"button\"\n        variant=\"ghost\"\n        onClick={(e) => {\n          e.stopPropagation() // Prevent event from bubbling up to the tag span\n          onRemoveTag(tagObj.id)\n        }}\n        className={cn(\"h-full px-3 py-1 hover:bg-transparent\")}\n      >\n        <X size={14} />\n      </Button>\n    </span>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/toggle-content.tsx"},"span":[808,867],"sourceCode":"import { type ReactNode, useState } from \"react\"\n\ntype Props = {\n  trigger: ReactNode\n  children: ReactNode\n  maxHeight?: string\n  initialOpen?: boolean\n}\n\nexport function ToggleContent ({\n  trigger,\n  children,\n  maxHeight = \"480px\",\n  initialOpen = false,\n}: Props): React.ReactNode {\n  const [isOpen, setIsOpen] = useState(initialOpen)\n  const [contentHeight, setContentHeight] = useState(isOpen ? maxHeight : \"0px\")\n  const [contentOpacity, setContentOpacity] = useState(isOpen ? 1 : 0)\n\n  const toggleContent = () => {\n    if (isOpen) {\n      setContentHeight(\"0px\")\n      setContentOpacity(0)\n    } else {\n      setContentHeight(maxHeight)\n      setContentOpacity(1)\n    }\n    setIsOpen(!isOpen)\n  }\n\n  return (\n    <div>\n      {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n      <div onClick={toggleContent} style={{ cursor: \"pointer\" }}>\n        {trigger}\n      </div>\n      <div\n        style={{\n          maxHeight: contentHeight,\n          overflow: \"hidden\",\n          transition: \"max-height 0.3s ease-out, opacity 0.3s ease-out\",\n          opacity: contentOpacity,\n        }}\n      >\n        {children}\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/useSemanticElements","severity":"error","description":"The elements with this role can be changed to the following elements:\n<button>","message":[{"elements":[],"content":"The elements with this role can be changed to the following elements:\n<button>"}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"For examples and more information, see "},{"elements":[{"Hyperlink":{"href":"https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles"}}],"content":"WAI-ARIA Roles"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/work/work-viewer-dialog.tsx"},"span":[14887,14900],"sourceCode":"import { useCallback, useEffect, useRef, useState, useMemo } from \"react\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport type { PhotoAlbumWorkFragment } from \"~/components/responsive-photo-works-album\"\nimport { useQuery } from \"@apollo/client/index\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Avatar, AvatarImage, AvatarFallback } from \"~/components/ui/avatar\"\nimport { Button } from \"~/components/ui/button\"\nimport { ChevronLeft, ChevronRight, X } from \"lucide-react\"\nimport { WorkArticle } from \"~/routes/($lang)._main.posts.$post._index/components/work-article\"\nimport { WorkCommentSectionEnhanced } from \"~/components/work/work-comment-section-final\"\nimport { WorkCommentInputFixed } from \"~/components/work/work-comment-input-fixed\"\nimport { WorkActionContainer } from \"~/routes/($lang)._main.posts.$post._index/components/work-action-container\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\n// Note: Linkã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ä½¿ç”¨ã—ãªã„ï¼ˆPortalå†…ã§React Routerã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãŒä½¿ç”¨ã§ããªã„ãŸã‚ï¼‰\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Types â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n\ninterface Props {\n  works: FragmentOf<typeof PhotoAlbumWorkFragment>[]\n  /** è¡¨ç¤ºã‚’é–‹å§‹ã—ãŸã„ä½œå“ IDï¼ˆå„ªå…ˆï¼‰ */\n  startWorkId?: string\n  /** ID ãŒç„¡ã„å ´åˆã«ä½¿ã†ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ index */\n  startIndex?: number\n  onClose: () => void\n  /** TagWorkSection ã‹ã‚‰æ¸¡ã•ã‚Œã‚‹è¿½åŠ ãƒ­ãƒ¼ãƒ‰é–¢æ•° */\n  loadMore?: () => void\n  hasNextPage?: boolean\n  isLoadingMore?: boolean\n}\n\n/** è¦ç´ ã‚’è¦ªè¦ç´ ã®ç¸¦æ–¹å‘ä¸­å¤®ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦åˆã‚ã›ã‚‹ */\nexport function scrollItemIntoVerticalCenter(\n  container: HTMLElement,\n  item: HTMLElement,\n  smooth = true,\n): void {\n  const containerMiddle = container.clientHeight / 2\n  const itemMiddle = item.offsetTop + item.clientHeight / 2\n  const newTop = itemMiddle - containerMiddle\n  container.scrollTo({\n    top: newTop,\n    behavior: smooth ? \"smooth\" : \"auto\",\n  })\n}\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Component â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nexport function WorkViewerDialog({\n  works,\n  startIndex,\n  onClose,\n  loadMore,\n  hasNextPage = false,\n  isLoadingMore = false,\n  startWorkId,\n}: Props): React.ReactNode {\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ State / Refs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const initialIndex = useMemo(() => {\n    if (startWorkId) {\n      const idx = works.findIndex((w) => w.id === startWorkId)\n      if (idx !== -1) return idx\n    }\n    const fallbackIndex = startIndex ?? 0\n    return fallbackIndex\n  }, [startWorkId, startIndex, works])\n\n  const [index, setIndex] = useState(initialIndex)\n  const [loadedWorkIds, setLoadedWorkIds] = useState<Set<string>>(new Set())\n  const [workDataCache, setWorkDataCache] = useState<Map<string, unknown>>(\n    new Map(),\n  )\n\n  // ãƒ‡ãƒã‚¦ãƒ³ã‚¹ç”¨ã®çŠ¶æ…‹\n  const [activeWorkId, setActiveWorkId] = useState<string | null>(null)\n  const [isDebouncing, setIsDebouncing] = useState(false)\n  const isFirstScrollDone = useRef(false)\n  const isInitialized = useRef(false)\n\n  // åˆæœŸåŒ–æ™‚ã«æ­£ã—ã„ä½œå“IDã¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ç¢ºå®Ÿã«è¨­å®šï¼ˆä¸€å›ã®ã¿ï¼‰\n  useEffect(() => {\n    if (isInitialized.current) return // æ—¢ã«åˆæœŸåŒ–æ¸ˆã¿ã®å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—\n\n    const targetWork = works[initialIndex]\n    if (targetWork) {\n      // ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚‚ç¢ºå®Ÿã«åˆæœŸå€¤ã«è¨­å®š\n      setIndex(initialIndex)\n      // å¯¾å¿œã™ã‚‹ä½œå“IDã‚‚è¨­å®š\n      if (activeWorkId !== targetWork.id) {\n        setActiveWorkId(targetWork.id)\n      }\n      isInitialized.current = true // åˆæœŸåŒ–å®Œäº†ã‚’ãƒãƒ¼ã‚¯\n    }\n  }, [initialIndex]) // worksã¨activeWorkIdã‚’ä¾å­˜é…åˆ—ã‹ã‚‰é™¤å»\n\n  // startWorkIdãŒå¤‰ã‚ã£ãŸå ´åˆã¯å†åˆæœŸåŒ–ã‚’è¨±å¯\n  useEffect(() => {\n    isInitialized.current = false\n  }, [startWorkId])\n\n  const thumbListRef = useRef<HTMLDivElement | null>(null)\n  const sentinelRef = useRef<HTMLDivElement | null>(null)\n  const debounceTimerRef = useRef<NodeJS.Timeout | null>(null)\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç¾åœ¨ã®ä½œå“ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const work = works[index]\n  const isWorkCached = work ? workDataCache.has(work.id) : false\n  const shouldFetchWork = work && activeWorkId === work.id && !isWorkCached\n\n  useEffect(() => {\n    setTimeout(() => {\n      const listEl = thumbListRef.current\n      if (!listEl) return\n\n      const target = listEl.children[index] as HTMLElement | undefined\n      if (!target) return\n\n      // åˆå›ã ã‘ã¯ä¸€ç¬ã§ä½ç½®åˆã‚ã›ãƒ»ä»¥å¾Œã¯ smooth\n      scrollItemIntoVerticalCenter(\n        listEl,\n        target,\n        /* smooth = */ isFirstScrollDone.current,\n      )\n\n      // 1 å›å®Ÿè¡Œã—ãŸã‚‰ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã¦ smooth ã«åˆ‡ã‚Šæ›¿ãˆ\n      if (!isFirstScrollDone.current) isFirstScrollDone.current = true\n    }, 100)\n  }, [index, works.length, startWorkId, startIndex, initialIndex])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å¤‰æ›´æ™‚ã®å‡¦ç† â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  useEffect(() => {\n    const currentWork = works[index]\n    if (currentWork) {\n      // ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¸ˆã¿ã®å ´åˆã¯å³åº§ã«è¡¨ç¤º\n      if (workDataCache.has(currentWork.id)) {\n        setActiveWorkId(currentWork.id)\n        setIsDebouncing(false)\n        // ã‚¿ã‚¤ãƒãƒ¼ã‚’ã‚¯ãƒªã‚¢\n        if (debounceTimerRef.current) {\n          clearTimeout(debounceTimerRef.current)\n          debounceTimerRef.current = null\n        }\n      } else {\n        // åˆå›è¡¨ç¤ºã¾ãŸã¯æœªã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å ´åˆ\n        const isInitial = activeWorkId === null\n        setIsDebouncing(true)\n\n        // æ—¢å­˜ã®ã‚¿ã‚¤ãƒãƒ¼ã‚’ã‚¯ãƒªã‚¢\n        if (debounceTimerRef.current) {\n          clearTimeout(debounceTimerRef.current)\n        }\n\n        // ãƒ‡ãƒã‚¦ãƒ³ã‚¹æ™‚é–“ã‚’ã•ã‚‰ã«æœ€é©åŒ–ï¼ˆåˆå›ã¯å³åº§ã€ä»¥é™ã¯çŸ­ãï¼‰\n        const debounceTime = isInitial ? 0 : 200\n\n        debounceTimerRef.current = setTimeout(() => {\n          setActiveWorkId(currentWork.id)\n          setIsDebouncing(false)\n          debounceTimerRef.current = null\n        }, debounceTime)\n      }\n    }\n  }, [index, works, workDataCache])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GraphQL Query with conditional execution â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const { data, loading, refetch } = useQuery(workDialogQuery, {\n    variables: { workId: work?.id || \"\" },\n    skip: !shouldFetchWork || !work, // workãŒå­˜åœ¨ã—ãªã„å ´åˆã‚‚ã‚¹ã‚­ãƒƒãƒ—\n    fetchPolicy: \"cache-and-network\",\n    nextFetchPolicy: \"cache-first\",\n    notifyOnNetworkStatusChange: true,\n    returnPartialData: true,\n    onCompleted: (data) => {\n      if (data?.work && work) {\n        // ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ããŸã‚‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜\n        setWorkDataCache((prev) => new Map(prev).set(work.id, data.work))\n        setLoadedWorkIds((prev) => new Set(prev).add(work.id))\n      }\n    },\n  })\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å…ˆèª­ã¿å‡¦ç†ï¼ˆãƒ‡ãƒã‚¦ãƒ³ã‚¹ä»˜ãï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const prefetchAdjacentWorks = useCallback(() => {\n    // ç¾åœ¨ã®ä½œå“ãŒèª­ã¿è¾¼ã¿å®Œäº†ã—ã¦ã‹ã‚‰å…ˆèª­ã¿é–‹å§‹\n    if (isDebouncing || (!isWorkCached && !data?.work)) return\n\n    const prefetchIds: string[] = []\n\n    // å‰å¾Œ2ä½œå“ã®ç¯„å›²ã§å…ˆèª­ã¿ï¼ˆè² è·è»½æ¸›ã®ãŸã‚ç¯„å›²ã‚’ç¸®å°ï¼‰\n    for (\n      let i = Math.max(0, index - 2);\n      i <= Math.min(works.length - 1, index + 2);\n      i++\n    ) {\n      const workItem = works[i]\n      if (workItem && i !== index && !loadedWorkIds.has(workItem.id)) {\n        prefetchIds.push(workItem.id)\n      }\n    }\n\n    // å…ˆèª­ã¿å®Ÿè¡Œï¼ˆã•ã‚‰ã«é…å»¶ã‚’è¿½åŠ ï¼‰\n    prefetchIds.forEach((workId, idx) => {\n      setTimeout(\n        () => {\n          if (!workDataCache.has(workId)) {\n            setActiveWorkId(workId)\n          }\n        },\n        1000 + idx * 500,\n      ) // 1ç§’å¾Œã‹ã‚‰0.5ç§’é–“éš”ã§å…ˆèª­ã¿\n    })\n  }, [\n    index,\n    works,\n    loadedWorkIds,\n    workDataCache,\n    isDebouncing,\n    isWorkCached,\n    data,\n  ])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å…ˆèª­ã¿ã®ãƒˆãƒªã‚¬ãƒ¼ï¼ˆé…å»¶å®Ÿè¡Œï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  useEffect(() => {\n    const timeoutId = setTimeout(() => {\n      prefetchAdjacentWorks()\n    }, 1500) // 1.5ç§’å¾Œã«å…ˆèª­ã¿é–‹å§‹\n\n    return () => clearTimeout(timeoutId)\n  }, [prefetchAdjacentWorks])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç¾åœ¨è¡¨ç¤ºã™ã‚‹ä½œå“ãƒ‡ãƒ¼ã‚¿ã®æ±ºå®š â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const currentWork = useMemo(() => {\n    if (!work) return null\n\n    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—\n    const cachedData = workDataCache.get(work.id)\n    if (cachedData) {\n      return cachedData as typeof work\n    }\n\n    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ãªã„å ´åˆã¯APIã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã¾ãŸã¯åŸºæœ¬ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨\n    return (data?.work as typeof work) ?? work\n  }, [work, workDataCache, data])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚³ãƒ¡ãƒ³ãƒˆé€ä¿¡å¾Œã®å‡¦ç† â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleCommentAdded = useCallback(async () => {\n    if (!work) return\n\n    try {\n      // ãƒ‡ãƒ¼ã‚¿ã‚’å†å–å¾—ã—ã¦ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æ›´æ–°\n      const result = await refetch()\n      if (result.data?.work) {\n        setWorkDataCache((prev) => new Map(prev).set(work.id, result.data.work))\n      }\n    } catch (error) {\n      console.error(\"Failed to refetch comments:\", error)\n    }\n  }, [refetch, work])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ index ãŒæœ«å°¾ãªã‚‰è‡ªå‹•ãƒ­ãƒ¼ãƒ‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  useEffect(() => {\n    if (\n      index === works.length - 1 &&\n      hasNextPage &&\n      !isLoadingMore &&\n      loadMore\n    ) {\n      loadMore()\n    }\n  }, [index, works.length, hasNextPage, isLoadingMore, loadMore])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const next = useCallback(\n    () => setIndex((i) => (i < works.length - 1 ? i + 1 : i)),\n    [works.length],\n  )\n  const prev = useCallback(\n    () => setIndex((i) => (i > 0 ? i - 1 : i)),\n    [works.length],\n  )\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚­ãƒ¼ / ãƒ›ã‚¤ãƒ¼ãƒ« â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  useEffect(() => {\n    const onKey = (e: KeyboardEvent) => {\n      const activeElement = document.activeElement\n      const tagName = activeElement?.tagName.toLowerCase()\n      const isInputFocused =\n        tagName === \"input\" ||\n        tagName === \"textarea\" ||\n        activeElement?.getAttribute(\"contenteditable\") === \"true\" ||\n        activeElement?.getAttribute(\"role\") === \"textbox\"\n\n      // å…¥åŠ›æ¬„ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã—ã¦ã„ã‚‹å ´åˆã¯å‡¦ç†ã‚’åœæ­¢\n      if (isInputFocused) {\n        return\n      }\n\n      if (e.key === \"ArrowUp\") {\n        e.preventDefault() // èƒŒæ™¯ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’é˜²ã\n        e.stopPropagation() // ã‚¤ãƒ™ãƒ³ãƒˆã®ä¼æ’­ã‚’åœæ­¢\n        prev()\n      }\n      if (e.key === \"ArrowDown\") {\n        e.preventDefault() // èƒŒæ™¯ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’é˜²ã\n        e.stopPropagation() // ã‚¤ãƒ™ãƒ³ãƒˆã®ä¼æ’­ã‚’åœæ­¢\n        next()\n      }\n      if (e.key === \"Escape\") onClose()\n    }\n\n    window.addEventListener(\"keydown\", onKey)\n    // ãƒ›ã‚¤ãƒ¼ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’å‰Šé™¤ï¼ˆã‚µãƒ ãƒã‚¤ãƒ«ä¸€è¦§ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã«ã‚ˆã‚‹è‡ªå‹•åˆ‡ã‚Šæ›¿ãˆã‚’é˜²ãï¼‰\n    return () => {\n      window.removeEventListener(\"keydown\", onKey)\n    }\n  }, [prev, next, onClose])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  useEffect(() => {\n    return () => {\n      if (debounceTimerRef.current) {\n        clearTimeout(debounceTimerRef.current)\n      }\n    }\n  }, [])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const isCurrentWorkLoading = (!isWorkCached && loading) || isDebouncing\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å®‰å…¨æ€§ãƒã‚§ãƒƒã‚¯ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  if (!work || !currentWork) {\n    console.error(\n      \"Work not found at index:\",\n      index,\n      \"Works length:\",\n      works.length,\n    )\n    return (\n      <Dialog open onOpenChange={onClose}>\n        <DialogContent className=\"flex h-[90vh] w-[100vw] max-w-[88vw] overflow-hidden p-0\">\n          <div className=\"flex flex-1 items-center justify-center\">\n            <p className=\"text-muted-foreground\">ä½œå“ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</p>\n          </div>\n        </DialogContent>\n      </Dialog>\n    )\n  }\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Render â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  return (\n    <Dialog open onOpenChange={onClose}>\n      <DialogContent className=\"h-[96vh] w-[100vw] max-w-[95vw] overflow-hidden p-0 sm:max-w-[88vw]\">\n        <div className=\"flex h-[88vh] w-[100vw] max-w-[95vw] overflow-hidden p-0 sm:max-w-[88vw]\">\n          {/* è©³ç´°ãƒ‘ãƒãƒ« (Desktop + Mobile) */}\n          <aside\n            className=\"flex flex-col bg-background/80 backdrop-blur-sm\"\n            style={{\n              width: \"calc(100% - 5rem)\",\n              minWidth: \"calc(100% - 5rem)\",\n              maxWidth: \"calc(100% - 5rem)\",\n            }}\n          >\n            <DialogHeader className=\"border-b p-4 pb-2\">\n              {/* ãƒ¢ãƒã‚¤ãƒ«ç”¨ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */}\n              <div className=\"flex items-center justify-between md:hidden\">\n                <Button\n                  onClick={prev}\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  disabled={index === 0}\n                  className=\"p-2\"\n                >\n                  <ChevronLeft className=\"h-4 w-4\" />\n                </Button>\n                <span className=\"text-muted-foreground text-xs\">\n                  {index + 1} / {works.length}\n                </span>\n                <Button\n                  onClick={next}\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  disabled={index === works.length - 1}\n                  className=\"p-2\"\n                >\n                  <ChevronRight className=\"h-4 w-4\" />\n                </Button>\n                <Button\n                  onClick={onClose}\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"p-2\"\n                >\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              </div>\n              <DialogTitle className=\"truncate font-bold text-lg\">\n                {/* ã‚¿ã‚¤ãƒˆãƒ«ã¯ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã®ã¿ */}\n                <span\n                  className=\"hidden cursor-pointer text-left transition-colors hover:text-primary md:inline\"\n                  onClick={() => {\n                    // Portalå†…ã§React RouterãŒä½¿ç”¨ã§ããªã„ãŸã‚ã€ç›´æ¥ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³\n                    if (typeof window !== \"undefined\") {\n                      window.location.href = `/posts/${currentWork.id}`\n                    }\n                  }}\n                  role=\"button\"\n                  tabIndex={0}\n                  onKeyDown={(e) => {\n                    if (e.key === \"Enter\" || e.key === \" \") {\n                      e.preventDefault()\n                      if (typeof window !== \"undefined\") {\n                        window.location.href = `/posts/${currentWork.id}`\n                      }\n                    }\n                  }}\n                >\n                  {currentWork.title}\n                </span>\n                {/* ãƒ¢ãƒã‚¤ãƒ«ç”¨ç°¡æ½”ã‚¿ã‚¤ãƒˆãƒ« */}\n                <span className=\"truncate md:hidden\">{currentWork.title}</span>\n              </DialogTitle>\n              <div className=\"mt-2\">\n                <span\n                  onClick={() => {\n                    if (typeof window !== \"undefined\") {\n                      window.location.href = `/users/${currentWork.user?.login}`\n                    }\n                  }}\n                  className=\"flex cursor-pointer items-center space-x-2 transition-colors hover:text-primary\"\n                  role=\"button\"\n                  tabIndex={0}\n                  onKeyDown={(e) => {\n                    if (e.key === \"Enter\" || e.key === \" \") {\n                      e.preventDefault()\n                      if (typeof window !== \"undefined\") {\n                        window.location.href = `/users/${currentWork.user?.login}`\n                      }\n                    }\n                  }}\n                >\n                  <Avatar className=\"size-6\">\n                    <AvatarImage\n                      src={withIconUrlFallback(currentWork.user?.iconUrl)}\n                    />\n                    <AvatarFallback />\n                  </Avatar>\n                  <span className=\"font-medium text-sm\">\n                    {currentWork.user?.name}\n                  </span>\n                </span>\n              </div>\n            </DialogHeader>\n\n            {/* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º */}\n            {isCurrentWorkLoading ? (\n              <div className=\"flex flex-1 items-center justify-center\">\n                <div className=\"flex flex-col items-center space-y-2\">\n                  <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-muted-foreground border-t-transparent\" />\n                  <span className=\"text-muted-foreground text-sm\">\n                    {isDebouncing ? \"å¾…æ©Ÿä¸­...\" : \"èª­ã¿è¾¼ã¿ä¸­...\"}\n                  </span>\n                </div>\n              </div>\n            ) : (\n              <div className=\"flex flex-1 flex-col overflow-hidden\">\n                {/* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ï¼ˆã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ï¼‰ */}\n                <div className=\"flex-1 overflow-y-auto overscroll-y-contain p-4\">\n                  <WorkArticle\n                    work={{\n                      ...currentWork,\n                      isBotGradingEnabled:\n                        (\n                          currentWork as unknown as {\n                            isBotGradingEnabled?: boolean\n                          }\n                        ).isBotGradingEnabled ?? false,\n                      isBotGradingPublic:\n                        (\n                          currentWork as unknown as {\n                            isBotGradingPublic?: boolean\n                          }\n                        ).isBotGradingPublic ?? false,\n                      botEvaluation: ((currentWork as any).botEvaluation ??\n                        null) as any,\n                      user: currentWork.user\n                        ? { ...currentWork.user, works: [] }\n                        : null,\n                      nextWork: null,\n                      previousWork: null,\n                    }}\n                    userSetting={undefined}\n                    mode={\"dialog\"}\n                  />\n                  {/* ã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆãŒæœ‰åŠ¹ãªå ´åˆã®ã¿ï¼‰ */}\n                  {currentWork.isCommentsEditable && (\n                    <div className=\"mt-6\">\n                      <WorkCommentSectionEnhanced\n                        workId={currentWork.id}\n                        workOwnerIconImageURL={withIconUrlFallback(\n                          currentWork.user?.iconUrl,\n                        )}\n                        isWorkOwnerBlocked={\n                          (currentWork as { user?: { isBlocked?: boolean } })\n                            .user?.isBlocked ?? false\n                        }\n                        isFixedInput={true}\n                        comments={\n                          Array.isArray(\n                            (currentWork as unknown as { comments?: unknown[] })\n                              .comments,\n                          )\n                            ? (\n                                currentWork as unknown as {\n                                  comments: unknown[]\n                                }\n                              ).comments.map((c: unknown) => ({\n                                id: (c as { id: string }).id,\n                                text: (c as { text?: string | null }).text,\n                                createdAt: (c as { createdAt: number })\n                                  .createdAt,\n                                likesCount: (c as { likesCount: number })\n                                  .likesCount,\n                                isLiked: (c as { isLiked: boolean }).isLiked,\n                                isWorkOwnerLiked: (\n                                  c as { isWorkOwnerLiked: boolean }\n                                ).isWorkOwnerLiked,\n                                isMuted: (c as { isMuted?: boolean }).isMuted,\n                                isSensitive: (c as { isSensitive?: boolean })\n                                  .isSensitive,\n                                user: (\n                                  c as {\n                                    user?: {\n                                      id: string\n                                      name: string\n                                      iconUrl?: string | null\n                                    }\n                                  }\n                                ).user\n                                  ? {\n                                      id: (c as { user: { id: string } }).user\n                                        .id,\n                                      name:\n                                        (c as { user: { name: string } }).user\n                                          .name || \"\",\n                                      iconUrl: (\n                                        c as {\n                                          user: { iconUrl?: string | null }\n                                        }\n                                      ).user.iconUrl,\n                                    }\n                                  : undefined,\n                                sticker: (\n                                  c as {\n                                    sticker?: {\n                                      id: string\n                                      title: string\n                                      imageUrl?: string | null\n                                      accessType: string\n                                      isDownloaded?: boolean\n                                    }\n                                  }\n                                ).sticker\n                                  ? {\n                                      id:\n                                        (c as { sticker: { id: string } })\n                                          .sticker.id || \"\",\n                                      title:\n                                        (c as { sticker: { title: string } })\n                                          .sticker.title || \"\",\n                                      imageUrl: (\n                                        c as {\n                                          sticker: { imageUrl?: string | null }\n                                        }\n                                      ).sticker.imageUrl,\n                                      accessType:\n                                        (\n                                          c as {\n                                            sticker: { accessType: string }\n                                          }\n                                        ).sticker.accessType || \"PUBLIC\",\n                                      isDownloaded: (\n                                        c as {\n                                          sticker: { isDownloaded?: boolean }\n                                        }\n                                      ).sticker.isDownloaded,\n                                    }\n                                  : undefined,\n                                responses: [],\n                              }))\n                            : []\n                        }\n                      />\n                    </div>\n                  )}\n                </div>\n\n                {/* å›ºå®šã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¨ãƒªã‚¢ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›ï¼‰ */}\n                <div className=\"border-t bg-background/98 backdrop-blur-md\">\n                  {/* å›ºå®šã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›æ¬„ */}\n                  {currentWork.isCommentsEditable && (\n                    <WorkCommentInputFixed\n                      workId={currentWork.id}\n                      isWorkOwnerBlocked={\n                        (currentWork as { user?: { isBlocked?: boolean } }).user\n                          ?.isBlocked ?? false\n                      }\n                      commentsCount={\n                        Array.isArray(\n                          (currentWork as unknown as { comments?: unknown[] })\n                            .comments,\n                        )\n                          ? (currentWork as unknown as { comments: unknown[] })\n                              .comments.length\n                          : 0\n                      }\n                      onCommentAdded={handleCommentAdded}\n                    />\n                  )}\n                </div>\n              </div>\n            )}\n          </aside>\n\n          {/* ã‚µãƒ ãƒã‚¤ãƒ«åˆ— - ã‚¹ãƒãƒ›ã§ã‚‚å¸¸ã«è¡¨ç¤ºï¼ˆå¹…å›ºå®šï¼‰ */}\n          <aside\n            ref={thumbListRef}\n            className=\"ml-auto flex h-full flex-col overflow-y-auto overscroll-y-contain bg-background/80 backdrop-blur-sm\"\n            style={{\n              width: \"5rem\", // å›ºå®šå¹…\n              minWidth: \"5rem\", // æœ€å°å¹…\n              maxWidth: \"5rem\", // æœ€å¤§å¹…\n              scrollbarWidth: \"thin\",\n              display: \"flex\",\n              visibility: \"visible\",\n              opacity: 1,\n            }}\n          >\n            {works.map((w, i) => (\n              <button\n                key={w.id}\n                type=\"button\"\n                className={`relative m-1 rounded-md ring-offset-2 transition-all duration-200 focus:outline-none focus:ring-2 ${\n                  i === index\n                    ? \"bg-primary/10 ring ring-primary\"\n                    : \"hover:bg-background/20\"\n                }`}\n                onClick={() => setIndex(i)}\n              >\n                <img\n                  src={w.smallThumbnailImageURL}\n                  alt={w.title}\n                  className=\"h-16 w-full rounded-md object-cover\"\n                  draggable={false}\n                  loading=\"lazy\"\n                  onLoad={(e) => {\n                    // ç”»åƒèª­ã¿è¾¼ã¿å®Œäº†æ™‚ã«ã‚µãƒ ãƒã‚¤ãƒ«å¹…ã®å®‰å®šåŒ–\n                    const img = e.target as HTMLImageElement\n                    img.style.opacity = \"1\"\n                  }}\n                  onError={(e) => {\n                    // ã‚¨ãƒ©ãƒ¼æ™‚ã‚‚ã‚µã‚¤ã‚ºã‚’ç¶­æŒ\n                    const img = e.target as HTMLImageElement\n                    img.style.opacity = \"0.5\"\n                  }}\n                  style={{\n                    width: \"100%\",\n                    height: \"4rem\",\n                    objectFit: \"cover\",\n                    opacity: 0,\n                    transition: \"opacity 0.3s ease-in-out\",\n                  }}\n                />\n                {/* ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¸ˆã¿ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */}\n                {loadedWorkIds.has(w.id) && (\n                  <div className=\"absolute top-1 right-1 h-2 w-2 rounded-full bg-green-400 shadow-sm\" />\n                )}\n                {/* ãƒ‡ãƒã‚¦ãƒ³ã‚¹ä¸­ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */}\n                {isDebouncing && i === index && (\n                  <div className=\"absolute top-1 left-1 h-2 w-2 animate-pulse rounded-full bg-yellow-400 shadow-sm\" />\n                )}\n              </button>\n            ))}\n\n            {/* sentinel & spinner */}\n            {isLoadingMore && (\n              <div className=\"flex justify-center py-2\">\n                <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-muted-foreground border-t-transparent\" />\n              </div>\n            )}\n            <div ref={sentinelRef} className=\"h-[2px] w-full\" />\n          </aside>\n        </div>\n        {/* ã„ã„ã­ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ - ãƒ•ãƒ«å¹…æœ‰åŠ¹é ˜åŸŸ */}\n        <div className=\"border-t bg-background/95 backdrop-blur-sm\">\n          <div className=\"w-full\">\n            <WorkActionContainer\n              workLikesCount={currentWork.likesCount}\n              title={currentWork.title}\n              description={\n                (currentWork.description?.length ?? 0) > 100\n                  ? `${currentWork.description?.slice(0, 100)}...`\n                  : (currentWork.description ?? \"\")\n              }\n              currentImageUrl={currentWork.imageURL}\n              imageUrls={[\n                currentWork.imageURL,\n                ...(currentWork.subWorks || []).map(\n                  (subWork) => subWork.imageUrl ?? \"\",\n                ),\n              ]}\n              targetWorkId={currentWork.id}\n              bookmarkFolderId={null}\n              targetWorkOwnerUserId={currentWork.user?.id ?? \"\"}\n              isDisabledShare={false}\n              isTargetUserBlocked={Boolean(currentWork.user?.isBlocked)}\n              mode=\"dialogLikeOnly\"\n            />\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n// GraphQLéƒ¨åˆ†ã¯å¤‰æ›´ãªã—\nexport const workArticleFragment =\n  graphql(`fragment WorkArticle on WorkNode @_unmask {\n  id\n  isMyRecommended\n  title\n  mdUrl\n  accessType\n  type\n  adminAccessType\n  promptAccessType\n  rating\n  description\n  isSensitive\n  enTitle\n  enDescription\n  imageURL\n  largeThumbnailImageURL\n  largeThumbnailImageWidth\n  largeThumbnailImageHeight\n  smallThumbnailImageURL\n  smallThumbnailImageWidth\n  smallThumbnailImageHeight\n  thumbnailImagePosition\n  subWorksCount\n  url\n  isDeleted\n  user {\n    id\n    biography\n    enBiography\n    login\n    nanoid\n    name\n    receivedLikesCount\n    receivedViewsCount\n    awardsCount\n    followersCount\n    worksCount\n    iconUrl\n    headerImageUrl\n    webFcmToken\n    isFollower\n    isFollowee\n    headerImageUrl\n    receivedLikesCount\n    createdLikesCount\n    createdBookmarksCount\n    isMuted\n    promptonUser {\n      id\n    }\n  }\n  likedUsers(offset: 0, limit: 8) {\n    id\n    name\n    iconUrl\n    login\n  }\n  dailyTheme {\n    id\n    title\n    dateText\n  }\n  tagNames\n  createdAt\n  likesCount\n  viewsCount\n  commentsCount\n  subWorks {\n    id\n    imageUrl\n  }\n  model\n  modelHash\n  generationModelId\n  workModelId\n  isTagEditable\n  isCommentsEditable\n  isLiked\n  isBookmarked\n  isInCollection\n  isPromotion\n  isGeneration\n  ogpThumbnailImageUrl\n  prompt\n  negativePrompt\n  noise\n  seed\n  steps\n  sampler\n  scale\n  strength\n  vae\n  clipSkip\n  otherGenerationParams\n  pngInfo\n  style\n  url\n  updatedAt\n  dailyRanking\n  weeklyRanking\n  monthlyRanking\n  relatedUrl\n  nanoid\n  isBotGradingEnabled\n  isBotGradingPublic\n  botEvaluation {\n    cutenessScore\n    coolnessScore\n    beautyScore\n    originalityScore\n    compositionScore\n    colorScore\n    detailScore\n    consistencyScore\n    overallScore\n    comment\n    personality\n  }\n}`)\n\nexport const WorkCommentFragment =\n  graphql(`fragment WorkComment on CommentNode @_unmask {\n  id\n  createdAt\n  text\n  likesCount\n  isWorkOwnerLiked\n  isLiked\n  user {\n    id\n    name\n    login\n    iconUrl\n    nanoid\n  }\n  sticker {\n    id\n    imageUrl\n    title\n    isDownloaded\n    likesCount\n    usesCount\n    downloadsCount\n    accessType\n  }\n}`)\n\nconst workDialogQuery = graphql(\n  `query WorkDialog($workId: ID!) {\n    work(id: $workId) {\n      ...WorkArticle\n      comments(offset: 0, limit: 128) {\n        ...WorkComment\n      }\n      user {\n        iconUrl\n      }\n    }\n    viewer {\n      id\n    }\n  }`,\n  [workArticleFragment, WorkCommentFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/useSemanticElements","severity":"error","description":"The elements with this role can be changed to the following elements:\n<button>","message":[{"elements":[],"content":"The elements with this role can be changed to the following elements:\n<button>"}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"For examples and more information, see "},{"elements":[{"Hyperlink":{"href":"https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles"}}],"content":"WAI-ARIA Roles"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/components/work/work-viewer-dialog.tsx"},"span":[15923,15936],"sourceCode":"import { useCallback, useEffect, useRef, useState, useMemo } from \"react\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport type { PhotoAlbumWorkFragment } from \"~/components/responsive-photo-works-album\"\nimport { useQuery } from \"@apollo/client/index\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Avatar, AvatarImage, AvatarFallback } from \"~/components/ui/avatar\"\nimport { Button } from \"~/components/ui/button\"\nimport { ChevronLeft, ChevronRight, X } from \"lucide-react\"\nimport { WorkArticle } from \"~/routes/($lang)._main.posts.$post._index/components/work-article\"\nimport { WorkCommentSectionEnhanced } from \"~/components/work/work-comment-section-final\"\nimport { WorkCommentInputFixed } from \"~/components/work/work-comment-input-fixed\"\nimport { WorkActionContainer } from \"~/routes/($lang)._main.posts.$post._index/components/work-action-container\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\n// Note: Linkã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ä½¿ç”¨ã—ãªã„ï¼ˆPortalå†…ã§React Routerã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãŒä½¿ç”¨ã§ããªã„ãŸã‚ï¼‰\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Types â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n\ninterface Props {\n  works: FragmentOf<typeof PhotoAlbumWorkFragment>[]\n  /** è¡¨ç¤ºã‚’é–‹å§‹ã—ãŸã„ä½œå“ IDï¼ˆå„ªå…ˆï¼‰ */\n  startWorkId?: string\n  /** ID ãŒç„¡ã„å ´åˆã«ä½¿ã†ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ index */\n  startIndex?: number\n  onClose: () => void\n  /** TagWorkSection ã‹ã‚‰æ¸¡ã•ã‚Œã‚‹è¿½åŠ ãƒ­ãƒ¼ãƒ‰é–¢æ•° */\n  loadMore?: () => void\n  hasNextPage?: boolean\n  isLoadingMore?: boolean\n}\n\n/** è¦ç´ ã‚’è¦ªè¦ç´ ã®ç¸¦æ–¹å‘ä¸­å¤®ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦åˆã‚ã›ã‚‹ */\nexport function scrollItemIntoVerticalCenter(\n  container: HTMLElement,\n  item: HTMLElement,\n  smooth = true,\n): void {\n  const containerMiddle = container.clientHeight / 2\n  const itemMiddle = item.offsetTop + item.clientHeight / 2\n  const newTop = itemMiddle - containerMiddle\n  container.scrollTo({\n    top: newTop,\n    behavior: smooth ? \"smooth\" : \"auto\",\n  })\n}\n\n// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Component â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nexport function WorkViewerDialog({\n  works,\n  startIndex,\n  onClose,\n  loadMore,\n  hasNextPage = false,\n  isLoadingMore = false,\n  startWorkId,\n}: Props): React.ReactNode {\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ State / Refs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const initialIndex = useMemo(() => {\n    if (startWorkId) {\n      const idx = works.findIndex((w) => w.id === startWorkId)\n      if (idx !== -1) return idx\n    }\n    const fallbackIndex = startIndex ?? 0\n    return fallbackIndex\n  }, [startWorkId, startIndex, works])\n\n  const [index, setIndex] = useState(initialIndex)\n  const [loadedWorkIds, setLoadedWorkIds] = useState<Set<string>>(new Set())\n  const [workDataCache, setWorkDataCache] = useState<Map<string, unknown>>(\n    new Map(),\n  )\n\n  // ãƒ‡ãƒã‚¦ãƒ³ã‚¹ç”¨ã®çŠ¶æ…‹\n  const [activeWorkId, setActiveWorkId] = useState<string | null>(null)\n  const [isDebouncing, setIsDebouncing] = useState(false)\n  const isFirstScrollDone = useRef(false)\n  const isInitialized = useRef(false)\n\n  // åˆæœŸåŒ–æ™‚ã«æ­£ã—ã„ä½œå“IDã¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ç¢ºå®Ÿã«è¨­å®šï¼ˆä¸€å›ã®ã¿ï¼‰\n  useEffect(() => {\n    if (isInitialized.current) return // æ—¢ã«åˆæœŸåŒ–æ¸ˆã¿ã®å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—\n\n    const targetWork = works[initialIndex]\n    if (targetWork) {\n      // ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚‚ç¢ºå®Ÿã«åˆæœŸå€¤ã«è¨­å®š\n      setIndex(initialIndex)\n      // å¯¾å¿œã™ã‚‹ä½œå“IDã‚‚è¨­å®š\n      if (activeWorkId !== targetWork.id) {\n        setActiveWorkId(targetWork.id)\n      }\n      isInitialized.current = true // åˆæœŸåŒ–å®Œäº†ã‚’ãƒãƒ¼ã‚¯\n    }\n  }, [initialIndex]) // worksã¨activeWorkIdã‚’ä¾å­˜é…åˆ—ã‹ã‚‰é™¤å»\n\n  // startWorkIdãŒå¤‰ã‚ã£ãŸå ´åˆã¯å†åˆæœŸåŒ–ã‚’è¨±å¯\n  useEffect(() => {\n    isInitialized.current = false\n  }, [startWorkId])\n\n  const thumbListRef = useRef<HTMLDivElement | null>(null)\n  const sentinelRef = useRef<HTMLDivElement | null>(null)\n  const debounceTimerRef = useRef<NodeJS.Timeout | null>(null)\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç¾åœ¨ã®ä½œå“ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const work = works[index]\n  const isWorkCached = work ? workDataCache.has(work.id) : false\n  const shouldFetchWork = work && activeWorkId === work.id && !isWorkCached\n\n  useEffect(() => {\n    setTimeout(() => {\n      const listEl = thumbListRef.current\n      if (!listEl) return\n\n      const target = listEl.children[index] as HTMLElement | undefined\n      if (!target) return\n\n      // åˆå›ã ã‘ã¯ä¸€ç¬ã§ä½ç½®åˆã‚ã›ãƒ»ä»¥å¾Œã¯ smooth\n      scrollItemIntoVerticalCenter(\n        listEl,\n        target,\n        /* smooth = */ isFirstScrollDone.current,\n      )\n\n      // 1 å›å®Ÿè¡Œã—ãŸã‚‰ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã¦ smooth ã«åˆ‡ã‚Šæ›¿ãˆ\n      if (!isFirstScrollDone.current) isFirstScrollDone.current = true\n    }, 100)\n  }, [index, works.length, startWorkId, startIndex, initialIndex])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å¤‰æ›´æ™‚ã®å‡¦ç† â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  useEffect(() => {\n    const currentWork = works[index]\n    if (currentWork) {\n      // ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¸ˆã¿ã®å ´åˆã¯å³åº§ã«è¡¨ç¤º\n      if (workDataCache.has(currentWork.id)) {\n        setActiveWorkId(currentWork.id)\n        setIsDebouncing(false)\n        // ã‚¿ã‚¤ãƒãƒ¼ã‚’ã‚¯ãƒªã‚¢\n        if (debounceTimerRef.current) {\n          clearTimeout(debounceTimerRef.current)\n          debounceTimerRef.current = null\n        }\n      } else {\n        // åˆå›è¡¨ç¤ºã¾ãŸã¯æœªã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å ´åˆ\n        const isInitial = activeWorkId === null\n        setIsDebouncing(true)\n\n        // æ—¢å­˜ã®ã‚¿ã‚¤ãƒãƒ¼ã‚’ã‚¯ãƒªã‚¢\n        if (debounceTimerRef.current) {\n          clearTimeout(debounceTimerRef.current)\n        }\n\n        // ãƒ‡ãƒã‚¦ãƒ³ã‚¹æ™‚é–“ã‚’ã•ã‚‰ã«æœ€é©åŒ–ï¼ˆåˆå›ã¯å³åº§ã€ä»¥é™ã¯çŸ­ãï¼‰\n        const debounceTime = isInitial ? 0 : 200\n\n        debounceTimerRef.current = setTimeout(() => {\n          setActiveWorkId(currentWork.id)\n          setIsDebouncing(false)\n          debounceTimerRef.current = null\n        }, debounceTime)\n      }\n    }\n  }, [index, works, workDataCache])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GraphQL Query with conditional execution â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const { data, loading, refetch } = useQuery(workDialogQuery, {\n    variables: { workId: work?.id || \"\" },\n    skip: !shouldFetchWork || !work, // workãŒå­˜åœ¨ã—ãªã„å ´åˆã‚‚ã‚¹ã‚­ãƒƒãƒ—\n    fetchPolicy: \"cache-and-network\",\n    nextFetchPolicy: \"cache-first\",\n    notifyOnNetworkStatusChange: true,\n    returnPartialData: true,\n    onCompleted: (data) => {\n      if (data?.work && work) {\n        // ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ããŸã‚‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜\n        setWorkDataCache((prev) => new Map(prev).set(work.id, data.work))\n        setLoadedWorkIds((prev) => new Set(prev).add(work.id))\n      }\n    },\n  })\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å…ˆèª­ã¿å‡¦ç†ï¼ˆãƒ‡ãƒã‚¦ãƒ³ã‚¹ä»˜ãï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const prefetchAdjacentWorks = useCallback(() => {\n    // ç¾åœ¨ã®ä½œå“ãŒèª­ã¿è¾¼ã¿å®Œäº†ã—ã¦ã‹ã‚‰å…ˆèª­ã¿é–‹å§‹\n    if (isDebouncing || (!isWorkCached && !data?.work)) return\n\n    const prefetchIds: string[] = []\n\n    // å‰å¾Œ2ä½œå“ã®ç¯„å›²ã§å…ˆèª­ã¿ï¼ˆè² è·è»½æ¸›ã®ãŸã‚ç¯„å›²ã‚’ç¸®å°ï¼‰\n    for (\n      let i = Math.max(0, index - 2);\n      i <= Math.min(works.length - 1, index + 2);\n      i++\n    ) {\n      const workItem = works[i]\n      if (workItem && i !== index && !loadedWorkIds.has(workItem.id)) {\n        prefetchIds.push(workItem.id)\n      }\n    }\n\n    // å…ˆèª­ã¿å®Ÿè¡Œï¼ˆã•ã‚‰ã«é…å»¶ã‚’è¿½åŠ ï¼‰\n    prefetchIds.forEach((workId, idx) => {\n      setTimeout(\n        () => {\n          if (!workDataCache.has(workId)) {\n            setActiveWorkId(workId)\n          }\n        },\n        1000 + idx * 500,\n      ) // 1ç§’å¾Œã‹ã‚‰0.5ç§’é–“éš”ã§å…ˆèª­ã¿\n    })\n  }, [\n    index,\n    works,\n    loadedWorkIds,\n    workDataCache,\n    isDebouncing,\n    isWorkCached,\n    data,\n  ])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å…ˆèª­ã¿ã®ãƒˆãƒªã‚¬ãƒ¼ï¼ˆé…å»¶å®Ÿè¡Œï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  useEffect(() => {\n    const timeoutId = setTimeout(() => {\n      prefetchAdjacentWorks()\n    }, 1500) // 1.5ç§’å¾Œã«å…ˆèª­ã¿é–‹å§‹\n\n    return () => clearTimeout(timeoutId)\n  }, [prefetchAdjacentWorks])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç¾åœ¨è¡¨ç¤ºã™ã‚‹ä½œå“ãƒ‡ãƒ¼ã‚¿ã®æ±ºå®š â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const currentWork = useMemo(() => {\n    if (!work) return null\n\n    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—\n    const cachedData = workDataCache.get(work.id)\n    if (cachedData) {\n      return cachedData as typeof work\n    }\n\n    // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ãªã„å ´åˆã¯APIã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã¾ãŸã¯åŸºæœ¬ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨\n    return (data?.work as typeof work) ?? work\n  }, [work, workDataCache, data])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚³ãƒ¡ãƒ³ãƒˆé€ä¿¡å¾Œã®å‡¦ç† â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const handleCommentAdded = useCallback(async () => {\n    if (!work) return\n\n    try {\n      // ãƒ‡ãƒ¼ã‚¿ã‚’å†å–å¾—ã—ã¦ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æ›´æ–°\n      const result = await refetch()\n      if (result.data?.work) {\n        setWorkDataCache((prev) => new Map(prev).set(work.id, result.data.work))\n      }\n    } catch (error) {\n      console.error(\"Failed to refetch comments:\", error)\n    }\n  }, [refetch, work])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ index ãŒæœ«å°¾ãªã‚‰è‡ªå‹•ãƒ­ãƒ¼ãƒ‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  useEffect(() => {\n    if (\n      index === works.length - 1 &&\n      hasNextPage &&\n      !isLoadingMore &&\n      loadMore\n    ) {\n      loadMore()\n    }\n  }, [index, works.length, hasNextPage, isLoadingMore, loadMore])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const next = useCallback(\n    () => setIndex((i) => (i < works.length - 1 ? i + 1 : i)),\n    [works.length],\n  )\n  const prev = useCallback(\n    () => setIndex((i) => (i > 0 ? i - 1 : i)),\n    [works.length],\n  )\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚­ãƒ¼ / ãƒ›ã‚¤ãƒ¼ãƒ« â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  useEffect(() => {\n    const onKey = (e: KeyboardEvent) => {\n      const activeElement = document.activeElement\n      const tagName = activeElement?.tagName.toLowerCase()\n      const isInputFocused =\n        tagName === \"input\" ||\n        tagName === \"textarea\" ||\n        activeElement?.getAttribute(\"contenteditable\") === \"true\" ||\n        activeElement?.getAttribute(\"role\") === \"textbox\"\n\n      // å…¥åŠ›æ¬„ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã—ã¦ã„ã‚‹å ´åˆã¯å‡¦ç†ã‚’åœæ­¢\n      if (isInputFocused) {\n        return\n      }\n\n      if (e.key === \"ArrowUp\") {\n        e.preventDefault() // èƒŒæ™¯ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’é˜²ã\n        e.stopPropagation() // ã‚¤ãƒ™ãƒ³ãƒˆã®ä¼æ’­ã‚’åœæ­¢\n        prev()\n      }\n      if (e.key === \"ArrowDown\") {\n        e.preventDefault() // èƒŒæ™¯ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’é˜²ã\n        e.stopPropagation() // ã‚¤ãƒ™ãƒ³ãƒˆã®ä¼æ’­ã‚’åœæ­¢\n        next()\n      }\n      if (e.key === \"Escape\") onClose()\n    }\n\n    window.addEventListener(\"keydown\", onKey)\n    // ãƒ›ã‚¤ãƒ¼ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’å‰Šé™¤ï¼ˆã‚µãƒ ãƒã‚¤ãƒ«ä¸€è¦§ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã«ã‚ˆã‚‹è‡ªå‹•åˆ‡ã‚Šæ›¿ãˆã‚’é˜²ãï¼‰\n    return () => {\n      window.removeEventListener(\"keydown\", onKey)\n    }\n  }, [prev, next, onClose])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  useEffect(() => {\n    return () => {\n      if (debounceTimerRef.current) {\n        clearTimeout(debounceTimerRef.current)\n      }\n    }\n  }, [])\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  const isCurrentWorkLoading = (!isWorkCached && loading) || isDebouncing\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å®‰å…¨æ€§ãƒã‚§ãƒƒã‚¯ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  if (!work || !currentWork) {\n    console.error(\n      \"Work not found at index:\",\n      index,\n      \"Works length:\",\n      works.length,\n    )\n    return (\n      <Dialog open onOpenChange={onClose}>\n        <DialogContent className=\"flex h-[90vh] w-[100vw] max-w-[88vw] overflow-hidden p-0\">\n          <div className=\"flex flex-1 items-center justify-center\">\n            <p className=\"text-muted-foreground\">ä½œå“ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</p>\n          </div>\n        </DialogContent>\n      </Dialog>\n    )\n  }\n\n  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Render â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n  return (\n    <Dialog open onOpenChange={onClose}>\n      <DialogContent className=\"h-[96vh] w-[100vw] max-w-[95vw] overflow-hidden p-0 sm:max-w-[88vw]\">\n        <div className=\"flex h-[88vh] w-[100vw] max-w-[95vw] overflow-hidden p-0 sm:max-w-[88vw]\">\n          {/* è©³ç´°ãƒ‘ãƒãƒ« (Desktop + Mobile) */}\n          <aside\n            className=\"flex flex-col bg-background/80 backdrop-blur-sm\"\n            style={{\n              width: \"calc(100% - 5rem)\",\n              minWidth: \"calc(100% - 5rem)\",\n              maxWidth: \"calc(100% - 5rem)\",\n            }}\n          >\n            <DialogHeader className=\"border-b p-4 pb-2\">\n              {/* ãƒ¢ãƒã‚¤ãƒ«ç”¨ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */}\n              <div className=\"flex items-center justify-between md:hidden\">\n                <Button\n                  onClick={prev}\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  disabled={index === 0}\n                  className=\"p-2\"\n                >\n                  <ChevronLeft className=\"h-4 w-4\" />\n                </Button>\n                <span className=\"text-muted-foreground text-xs\">\n                  {index + 1} / {works.length}\n                </span>\n                <Button\n                  onClick={next}\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  disabled={index === works.length - 1}\n                  className=\"p-2\"\n                >\n                  <ChevronRight className=\"h-4 w-4\" />\n                </Button>\n                <Button\n                  onClick={onClose}\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"p-2\"\n                >\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              </div>\n              <DialogTitle className=\"truncate font-bold text-lg\">\n                {/* ã‚¿ã‚¤ãƒˆãƒ«ã¯ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã®ã¿ */}\n                <span\n                  className=\"hidden cursor-pointer text-left transition-colors hover:text-primary md:inline\"\n                  onClick={() => {\n                    // Portalå†…ã§React RouterãŒä½¿ç”¨ã§ããªã„ãŸã‚ã€ç›´æ¥ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³\n                    if (typeof window !== \"undefined\") {\n                      window.location.href = `/posts/${currentWork.id}`\n                    }\n                  }}\n                  role=\"button\"\n                  tabIndex={0}\n                  onKeyDown={(e) => {\n                    if (e.key === \"Enter\" || e.key === \" \") {\n                      e.preventDefault()\n                      if (typeof window !== \"undefined\") {\n                        window.location.href = `/posts/${currentWork.id}`\n                      }\n                    }\n                  }}\n                >\n                  {currentWork.title}\n                </span>\n                {/* ãƒ¢ãƒã‚¤ãƒ«ç”¨ç°¡æ½”ã‚¿ã‚¤ãƒˆãƒ« */}\n                <span className=\"truncate md:hidden\">{currentWork.title}</span>\n              </DialogTitle>\n              <div className=\"mt-2\">\n                <span\n                  onClick={() => {\n                    if (typeof window !== \"undefined\") {\n                      window.location.href = `/users/${currentWork.user?.login}`\n                    }\n                  }}\n                  className=\"flex cursor-pointer items-center space-x-2 transition-colors hover:text-primary\"\n                  role=\"button\"\n                  tabIndex={0}\n                  onKeyDown={(e) => {\n                    if (e.key === \"Enter\" || e.key === \" \") {\n                      e.preventDefault()\n                      if (typeof window !== \"undefined\") {\n                        window.location.href = `/users/${currentWork.user?.login}`\n                      }\n                    }\n                  }}\n                >\n                  <Avatar className=\"size-6\">\n                    <AvatarImage\n                      src={withIconUrlFallback(currentWork.user?.iconUrl)}\n                    />\n                    <AvatarFallback />\n                  </Avatar>\n                  <span className=\"font-medium text-sm\">\n                    {currentWork.user?.name}\n                  </span>\n                </span>\n              </div>\n            </DialogHeader>\n\n            {/* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º */}\n            {isCurrentWorkLoading ? (\n              <div className=\"flex flex-1 items-center justify-center\">\n                <div className=\"flex flex-col items-center space-y-2\">\n                  <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-muted-foreground border-t-transparent\" />\n                  <span className=\"text-muted-foreground text-sm\">\n                    {isDebouncing ? \"å¾…æ©Ÿä¸­...\" : \"èª­ã¿è¾¼ã¿ä¸­...\"}\n                  </span>\n                </div>\n              </div>\n            ) : (\n              <div className=\"flex flex-1 flex-col overflow-hidden\">\n                {/* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ï¼ˆã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ï¼‰ */}\n                <div className=\"flex-1 overflow-y-auto overscroll-y-contain p-4\">\n                  <WorkArticle\n                    work={{\n                      ...currentWork,\n                      isBotGradingEnabled:\n                        (\n                          currentWork as unknown as {\n                            isBotGradingEnabled?: boolean\n                          }\n                        ).isBotGradingEnabled ?? false,\n                      isBotGradingPublic:\n                        (\n                          currentWork as unknown as {\n                            isBotGradingPublic?: boolean\n                          }\n                        ).isBotGradingPublic ?? false,\n                      botEvaluation: ((currentWork as any).botEvaluation ??\n                        null) as any,\n                      user: currentWork.user\n                        ? { ...currentWork.user, works: [] }\n                        : null,\n                      nextWork: null,\n                      previousWork: null,\n                    }}\n                    userSetting={undefined}\n                    mode={\"dialog\"}\n                  />\n                  {/* ã‚³ãƒ¡ãƒ³ãƒˆä¸€è¦§ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆãŒæœ‰åŠ¹ãªå ´åˆã®ã¿ï¼‰ */}\n                  {currentWork.isCommentsEditable && (\n                    <div className=\"mt-6\">\n                      <WorkCommentSectionEnhanced\n                        workId={currentWork.id}\n                        workOwnerIconImageURL={withIconUrlFallback(\n                          currentWork.user?.iconUrl,\n                        )}\n                        isWorkOwnerBlocked={\n                          (currentWork as { user?: { isBlocked?: boolean } })\n                            .user?.isBlocked ?? false\n                        }\n                        isFixedInput={true}\n                        comments={\n                          Array.isArray(\n                            (currentWork as unknown as { comments?: unknown[] })\n                              .comments,\n                          )\n                            ? (\n                                currentWork as unknown as {\n                                  comments: unknown[]\n                                }\n                              ).comments.map((c: unknown) => ({\n                                id: (c as { id: string }).id,\n                                text: (c as { text?: string | null }).text,\n                                createdAt: (c as { createdAt: number })\n                                  .createdAt,\n                                likesCount: (c as { likesCount: number })\n                                  .likesCount,\n                                isLiked: (c as { isLiked: boolean }).isLiked,\n                                isWorkOwnerLiked: (\n                                  c as { isWorkOwnerLiked: boolean }\n                                ).isWorkOwnerLiked,\n                                isMuted: (c as { isMuted?: boolean }).isMuted,\n                                isSensitive: (c as { isSensitive?: boolean })\n                                  .isSensitive,\n                                user: (\n                                  c as {\n                                    user?: {\n                                      id: string\n                                      name: string\n                                      iconUrl?: string | null\n                                    }\n                                  }\n                                ).user\n                                  ? {\n                                      id: (c as { user: { id: string } }).user\n                                        .id,\n                                      name:\n                                        (c as { user: { name: string } }).user\n                                          .name || \"\",\n                                      iconUrl: (\n                                        c as {\n                                          user: { iconUrl?: string | null }\n                                        }\n                                      ).user.iconUrl,\n                                    }\n                                  : undefined,\n                                sticker: (\n                                  c as {\n                                    sticker?: {\n                                      id: string\n                                      title: string\n                                      imageUrl?: string | null\n                                      accessType: string\n                                      isDownloaded?: boolean\n                                    }\n                                  }\n                                ).sticker\n                                  ? {\n                                      id:\n                                        (c as { sticker: { id: string } })\n                                          .sticker.id || \"\",\n                                      title:\n                                        (c as { sticker: { title: string } })\n                                          .sticker.title || \"\",\n                                      imageUrl: (\n                                        c as {\n                                          sticker: { imageUrl?: string | null }\n                                        }\n                                      ).sticker.imageUrl,\n                                      accessType:\n                                        (\n                                          c as {\n                                            sticker: { accessType: string }\n                                          }\n                                        ).sticker.accessType || \"PUBLIC\",\n                                      isDownloaded: (\n                                        c as {\n                                          sticker: { isDownloaded?: boolean }\n                                        }\n                                      ).sticker.isDownloaded,\n                                    }\n                                  : undefined,\n                                responses: [],\n                              }))\n                            : []\n                        }\n                      />\n                    </div>\n                  )}\n                </div>\n\n                {/* å›ºå®šã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¨ãƒªã‚¢ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›ï¼‰ */}\n                <div className=\"border-t bg-background/98 backdrop-blur-md\">\n                  {/* å›ºå®šã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›æ¬„ */}\n                  {currentWork.isCommentsEditable && (\n                    <WorkCommentInputFixed\n                      workId={currentWork.id}\n                      isWorkOwnerBlocked={\n                        (currentWork as { user?: { isBlocked?: boolean } }).user\n                          ?.isBlocked ?? false\n                      }\n                      commentsCount={\n                        Array.isArray(\n                          (currentWork as unknown as { comments?: unknown[] })\n                            .comments,\n                        )\n                          ? (currentWork as unknown as { comments: unknown[] })\n                              .comments.length\n                          : 0\n                      }\n                      onCommentAdded={handleCommentAdded}\n                    />\n                  )}\n                </div>\n              </div>\n            )}\n          </aside>\n\n          {/* ã‚µãƒ ãƒã‚¤ãƒ«åˆ— - ã‚¹ãƒãƒ›ã§ã‚‚å¸¸ã«è¡¨ç¤ºï¼ˆå¹…å›ºå®šï¼‰ */}\n          <aside\n            ref={thumbListRef}\n            className=\"ml-auto flex h-full flex-col overflow-y-auto overscroll-y-contain bg-background/80 backdrop-blur-sm\"\n            style={{\n              width: \"5rem\", // å›ºå®šå¹…\n              minWidth: \"5rem\", // æœ€å°å¹…\n              maxWidth: \"5rem\", // æœ€å¤§å¹…\n              scrollbarWidth: \"thin\",\n              display: \"flex\",\n              visibility: \"visible\",\n              opacity: 1,\n            }}\n          >\n            {works.map((w, i) => (\n              <button\n                key={w.id}\n                type=\"button\"\n                className={`relative m-1 rounded-md ring-offset-2 transition-all duration-200 focus:outline-none focus:ring-2 ${\n                  i === index\n                    ? \"bg-primary/10 ring ring-primary\"\n                    : \"hover:bg-background/20\"\n                }`}\n                onClick={() => setIndex(i)}\n              >\n                <img\n                  src={w.smallThumbnailImageURL}\n                  alt={w.title}\n                  className=\"h-16 w-full rounded-md object-cover\"\n                  draggable={false}\n                  loading=\"lazy\"\n                  onLoad={(e) => {\n                    // ç”»åƒèª­ã¿è¾¼ã¿å®Œäº†æ™‚ã«ã‚µãƒ ãƒã‚¤ãƒ«å¹…ã®å®‰å®šåŒ–\n                    const img = e.target as HTMLImageElement\n                    img.style.opacity = \"1\"\n                  }}\n                  onError={(e) => {\n                    // ã‚¨ãƒ©ãƒ¼æ™‚ã‚‚ã‚µã‚¤ã‚ºã‚’ç¶­æŒ\n                    const img = e.target as HTMLImageElement\n                    img.style.opacity = \"0.5\"\n                  }}\n                  style={{\n                    width: \"100%\",\n                    height: \"4rem\",\n                    objectFit: \"cover\",\n                    opacity: 0,\n                    transition: \"opacity 0.3s ease-in-out\",\n                  }}\n                />\n                {/* ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¸ˆã¿ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */}\n                {loadedWorkIds.has(w.id) && (\n                  <div className=\"absolute top-1 right-1 h-2 w-2 rounded-full bg-green-400 shadow-sm\" />\n                )}\n                {/* ãƒ‡ãƒã‚¦ãƒ³ã‚¹ä¸­ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */}\n                {isDebouncing && i === index && (\n                  <div className=\"absolute top-1 left-1 h-2 w-2 animate-pulse rounded-full bg-yellow-400 shadow-sm\" />\n                )}\n              </button>\n            ))}\n\n            {/* sentinel & spinner */}\n            {isLoadingMore && (\n              <div className=\"flex justify-center py-2\">\n                <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-muted-foreground border-t-transparent\" />\n              </div>\n            )}\n            <div ref={sentinelRef} className=\"h-[2px] w-full\" />\n          </aside>\n        </div>\n        {/* ã„ã„ã­ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ - ãƒ•ãƒ«å¹…æœ‰åŠ¹é ˜åŸŸ */}\n        <div className=\"border-t bg-background/95 backdrop-blur-sm\">\n          <div className=\"w-full\">\n            <WorkActionContainer\n              workLikesCount={currentWork.likesCount}\n              title={currentWork.title}\n              description={\n                (currentWork.description?.length ?? 0) > 100\n                  ? `${currentWork.description?.slice(0, 100)}...`\n                  : (currentWork.description ?? \"\")\n              }\n              currentImageUrl={currentWork.imageURL}\n              imageUrls={[\n                currentWork.imageURL,\n                ...(currentWork.subWorks || []).map(\n                  (subWork) => subWork.imageUrl ?? \"\",\n                ),\n              ]}\n              targetWorkId={currentWork.id}\n              bookmarkFolderId={null}\n              targetWorkOwnerUserId={currentWork.user?.id ?? \"\"}\n              isDisabledShare={false}\n              isTargetUserBlocked={Boolean(currentWork.user?.isBlocked)}\n              mode=\"dialogLikeOnly\"\n            />\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n// GraphQLéƒ¨åˆ†ã¯å¤‰æ›´ãªã—\nexport const workArticleFragment =\n  graphql(`fragment WorkArticle on WorkNode @_unmask {\n  id\n  isMyRecommended\n  title\n  mdUrl\n  accessType\n  type\n  adminAccessType\n  promptAccessType\n  rating\n  description\n  isSensitive\n  enTitle\n  enDescription\n  imageURL\n  largeThumbnailImageURL\n  largeThumbnailImageWidth\n  largeThumbnailImageHeight\n  smallThumbnailImageURL\n  smallThumbnailImageWidth\n  smallThumbnailImageHeight\n  thumbnailImagePosition\n  subWorksCount\n  url\n  isDeleted\n  user {\n    id\n    biography\n    enBiography\n    login\n    nanoid\n    name\n    receivedLikesCount\n    receivedViewsCount\n    awardsCount\n    followersCount\n    worksCount\n    iconUrl\n    headerImageUrl\n    webFcmToken\n    isFollower\n    isFollowee\n    headerImageUrl\n    receivedLikesCount\n    createdLikesCount\n    createdBookmarksCount\n    isMuted\n    promptonUser {\n      id\n    }\n  }\n  likedUsers(offset: 0, limit: 8) {\n    id\n    name\n    iconUrl\n    login\n  }\n  dailyTheme {\n    id\n    title\n    dateText\n  }\n  tagNames\n  createdAt\n  likesCount\n  viewsCount\n  commentsCount\n  subWorks {\n    id\n    imageUrl\n  }\n  model\n  modelHash\n  generationModelId\n  workModelId\n  isTagEditable\n  isCommentsEditable\n  isLiked\n  isBookmarked\n  isInCollection\n  isPromotion\n  isGeneration\n  ogpThumbnailImageUrl\n  prompt\n  negativePrompt\n  noise\n  seed\n  steps\n  sampler\n  scale\n  strength\n  vae\n  clipSkip\n  otherGenerationParams\n  pngInfo\n  style\n  url\n  updatedAt\n  dailyRanking\n  weeklyRanking\n  monthlyRanking\n  relatedUrl\n  nanoid\n  isBotGradingEnabled\n  isBotGradingPublic\n  botEvaluation {\n    cutenessScore\n    coolnessScore\n    beautyScore\n    originalityScore\n    compositionScore\n    colorScore\n    detailScore\n    consistencyScore\n    overallScore\n    comment\n    personality\n  }\n}`)\n\nexport const WorkCommentFragment =\n  graphql(`fragment WorkComment on CommentNode @_unmask {\n  id\n  createdAt\n  text\n  likesCount\n  isWorkOwnerLiked\n  isLiked\n  user {\n    id\n    name\n    login\n    iconUrl\n    nanoid\n  }\n  sticker {\n    id\n    imageUrl\n    title\n    isDownloaded\n    likesCount\n    usesCount\n    downloadsCount\n    accessType\n  }\n}`)\n\nconst workDialogQuery = graphql(\n  `query WorkDialog($workId: ID!) {\n    work(id: $workId) {\n      ...WorkArticle\n      comments(offset: 0, limit: 128) {\n        ...WorkComment\n      }\n      user {\n        iconUrl\n      }\n    }\n    viewer {\n      id\n    }\n  }`,\n  [workArticleFragment, WorkCommentFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main._index/components/responsive-photo-works-album-with-generation-button.tsx"},"span":[7362,7705],"sourceCode":"import type { FragmentOf } from \"gql.tada\"\nimport { RowsPhotoAlbum } from \"react-photo-album\"\nimport SSR from \"react-photo-album/ssr\"\nimport \"react-photo-album/rows.css\"\nimport { Link } from \"@remix-run/react\"\nimport { LikeButton } from \"~/components/like-button\"\nimport { CroppedWorkSquare } from \"~/components/cropped-work-square\"\nimport { Heart, Images, MessageCircle } from \"lucide-react\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { cn } from \"~/lib/utils\"\nimport { Avatar, AvatarImage, AvatarFallback } from \"~/components/ui/avatar\"\nimport { OptimizedImage } from \"~/components/optimized-image\"\nimport { ReferenceGenerationButton } from \"~/routes/($lang)._main._index/components/reference-generation-button\"\nimport type { PhotoAlbumWorkFragment } from \"~/components/responsive-photo-works-album\"\nimport { WorkMediaBadge } from \"~/components/work-media-badge\"\n\ntype Props = {\n  works: FragmentOf<typeof PhotoAlbumWorkFragment>[]\n  targetRowHeight?: number\n  direction?: \"rows\" | \"columns\"\n  size?: \"small\" | \"medium\" | \"large\"\n  isShowProfile?: boolean\n  /** ä½œå“ã‚¯ãƒªãƒƒã‚¯æ™‚ã« index ã‚’è¿”ã™ã€‚æœªæŒ‡å®šãªã‚‰å¾“æ¥é€šã‚Šãƒªãƒ³ã‚¯é·ç§» */\n  onSelect?: (index: string) => void\n}\n\n/**\n * ç”Ÿæˆä½œå“ã‚»ã‚¯ã‚·ãƒ§ãƒ³å°‚ç”¨ã®ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œä½œå“ä¸€è¦§\n * å„ã‚µãƒ ãƒã‚¤ãƒ«ä¸‹ã«å‚ç…§ç”Ÿæˆãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹\n */\nexport function ResponsivePhotoWorksAlbumWithGenerationButton (props: Props) {\n  if (props.works.length <= 2) {\n    return (\n      <div className=\"flex flex-wrap justify-center gap-x-8 gap-y-8\">\n        {props.works.map((workItem, _index) => {\n          return (\n            <div\n              key={workItem.id.toString()}\n              className=\"relative flex flex-col space-y-2\"\n            >\n              <div className=\"relative\">\n                <CroppedWorkSquare\n                  workId={workItem.id}\n                  subWorksCount={workItem.subWorksCount}\n                  imageUrl={workItem.smallThumbnailImageURL}\n                  thumbnailImagePosition={workItem.thumbnailImagePosition ?? 0}\n                  size=\"lg\"\n                  imageWidth={workItem.smallThumbnailImageWidth}\n                  imageHeight={workItem.smallThumbnailImageHeight}\n                  isPromptPublic={workItem.promptAccessType === \"PUBLIC\"}\n                  hasVideoUrl={Boolean(workItem.url)}\n                  isGeneration={workItem.isGeneration}\n                  hasReferenceButton={true}\n                  onSelect={props.onSelect}\n                />\n                {workItem.subWorksCount > 0 && (\n                  <div className=\"absolute top-1 right-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                    <Images className=\"size-3 text-white\" />\n                    <div className=\"font-bold text-white text-xs\">\n                      {workItem.subWorksCount + 1}\n                    </div>\n                  </div>\n                )}\n                <div className=\"absolute right-0 bottom-0\">\n                  <LikeButton\n                    size={56}\n                    targetWorkId={workItem.id}\n                    targetWorkOwnerUserId={workItem.user?.id ?? \"\"}\n                    defaultLiked={workItem.isLiked}\n                    defaultLikedCount={0}\n                    isBackgroundNone={true}\n                    strokeWidth={2}\n                  />\n                </div>\n              </div>\n              {/* å‚ç…§ç”Ÿæˆãƒœã‚¿ãƒ³ã‚’è¿½åŠ  */}\n              <div className=\"w-full\">\n                <ReferenceGenerationButton workId={workItem.id} />\n              </div>\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n\n  return (\n    <>\n      <div className=\"hidden md:block\">\n        <SSR breakpoints={[300, 600, 900, 1200]}>\n          <RowsPhotoAlbum\n            photos={props.works.map((work) => ({\n              key: work.id,\n              id: work.id.toString(),\n              src:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageURL\n                  : work.smallThumbnailImageURL,\n              width:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageWidth\n                  : work.smallThumbnailImageWidth,\n              height:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageHeight\n                  : work.smallThumbnailImageHeight,\n              context: work,\n            }))}\n            targetRowHeight={\n              props.targetRowHeight !== undefined\n                ? props.targetRowHeight\n                : props.direction === \"rows\"\n                  ? 160\n                  : 220\n            }\n            sizes={{\n              size: \"calc(100vw - 240px)\",\n              sizes: [{ viewport: \"(max-width: 960px)\", size: \"100vw\" }],\n            }}\n            componentsProps={{\n              image: { loading: \"lazy\" },\n            }}\n            render={{\n              image: (imageProps, { photo }) => (\n                <div className=\"relative h-full w-full overflow-hidden rounded\">\n                  {props.onSelect ? (\n                    <button\n                      type=\"button\"\n                      className=\"block h-full w-full cursor-pointer overflow-hidden rounded\"\n                      onClick={() => props.onSelect?.(photo.id)}\n                      aria-label={`Open ${photo.context.title}`}\n                    >\n                      <OptimizedImage\n                        src={imageProps.src}\n                        alt={photo.context.title}\n                        className=\"h-full w-full transition-transform duration-300 ease-in-out hover:scale-105\"\n                        width={\n                          typeof imageProps.width === \"string\"\n                            ? Number.parseInt(imageProps.width)\n                            : imageProps.width\n                        }\n                        height={\n                          typeof imageProps.height === \"string\"\n                            ? Number.parseInt(imageProps.height)\n                            : imageProps.height\n                        }\n                        loading={imageProps.loading as \"lazy\" | \"eager\"}\n                      />\n                    </button>\n                  ) : (\n                    <Link\n                      className=\"block h-full w-full overflow-hidden rounded\"\n                      to={`/posts/${photo.context.id}`}\n                    >\n                      <OptimizedImage\n                        src={imageProps.src}\n                        alt={photo.context.title}\n                        className=\"h-full w-full transition-transform duration-300 ease-in-out hover:scale-105\"\n                        width={\n                          typeof imageProps.width === \"string\"\n                            ? Number.parseInt(imageProps.width)\n                            : imageProps.width\n                        }\n                        height={\n                          typeof imageProps.height === \"string\"\n                            ? Number.parseInt(imageProps.height)\n                            : imageProps.height\n                        }\n                        loading={imageProps.loading as \"lazy\" | \"eager\"}\n                      />\n                    </Link>\n                  )}\n                  <div\n                    className={cn(\n                      \"absolute right-0 z-10\",\n                      props.isShowProfile ? \"bottom-28\" : \"bottom-0\",\n                    )}\n                    onClick={(e) => {\n                      e.stopPropagation()\n                      e.preventDefault()\n                    }}\n                  >\n                    <LikeButton\n                      size={56}\n                      targetWorkId={photo.context.id}\n                      targetWorkOwnerUserId={photo.context.user?.id ?? \"\"}\n                      defaultLiked={photo.context.isLiked}\n                      defaultLikedCount={0}\n                      isBackgroundNone={true}\n                      strokeWidth={2}\n                      likedCount={photo.context.likesCount}\n                    />\n                  </div>\n                  {photo.context.subWorksCount > 0 && (\n                    <div className=\"absolute top-1 right-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                      <Images className=\"size-3 text-white\" />\n                      <div className=\"font-bold text-white text-xs\">\n                        {photo.context.subWorksCount + 1}\n                      </div>\n                    </div>\n                  )}\n                  {photo.context.commentsCount > 0 && (\n                    <div className=\"absolute top-1 left-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                      <MessageCircle className=\"size-3 text-white\" />\n                      <div className=\"font-bold text-white text-xs\">\n                        {photo.context.commentsCount}\n                      </div>\n                    </div>\n                  )}\n                  {/* ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå…¬é–‹ãƒ»å‹•ç”»ãƒãƒƒã‚¸ */}\n                  <div className=\"absolute bottom-32 left-1 z-10\">\n                    <WorkMediaBadge\n                      isPromptPublic={\n                        (photo.context.promptAccessType === \"PUBLIC\" &&\n                          photo.context.prompt !== \"\") ||\n                        photo.context.isGeneration\n                      }\n                      hasVideoUrl={Boolean(photo.context.url)}\n                      isGeneration={photo.context.isGeneration}\n                      hasReferenceButton={true}\n                      size=\"md\"\n                    />\n                  </div>\n                  {props.isShowProfile && (\n                    <div className=\"mt-2 flex flex-col space-y-2 overflow-hidden text-ellipsis\">\n                      {props.onSelect ? (\n                        <button\n                          type=\"button\"\n                          className=\"w-48 cursor-pointer font-bold\"\n                          onClick={(e) => {\n                            e.stopPropagation()\n                            props.onSelect?.(photo.context.id.toString())\n                          }}\n                          aria-label={`Open ${photo.context.title}`}\n                        >\n                          <p className=\"overflow-hidden text-ellipsis text-nowrap text-left text-sm\">\n                            {photo.context.title}\n                          </p>\n                        </button>\n                      ) : (\n                        <Link\n                          className=\"w-48 font-bold\"\n                          to={`/posts/${photo.context.id}`}\n                        >\n                          <p className=\"overflow-hidden text-ellipsis text-nowrap text-left text-sm\">\n                            {photo.context.title}\n                          </p>\n                        </Link>\n                      )}\n\n                      <div className=\"flex items-center justify-between\">\n                        <Link to={`/users/${photo.context.user?.id}`}>\n                          <div className=\"flex items-center space-x-2\">\n                            <Avatar className=\"size-6\">\n                              <AvatarImage\n                                className=\"size-6 rounded-full\"\n                                src={withIconUrlFallback(\n                                  photo.context.user?.iconUrl,\n                                )}\n                                alt=\"\"\n                              />\n                              <AvatarFallback />\n                            </Avatar>\n                            <span className=\"truncate text-sm\">\n                              {photo.context.user?.name}\n                            </span>\n                          </div>\n                        </Link>\n                        <div className=\"absolute right-0 ml-auto flex items-center space-x-1 rounded-md bg-card p-1\">\n                          <Heart className=\"size-3 fill-gray-400 text-gray-400\" />\n                          <span className=\"text-xs\">\n                            {photo.context.likesCount}\n                          </span>\n                        </div>\n                      </div>\n\n                      {/* å‚ç…§ç”Ÿæˆãƒœã‚¿ãƒ³ã‚’è¿½åŠ  */}\n                      <div className=\"mt-2 w-full\">\n                        <ReferenceGenerationButton workId={photo.context.id} />\n                      </div>\n                    </div>\n                  )}\n                </div>\n              ),\n            }}\n          />\n        </SSR>\n      </div>\n      <div className=\"block md:hidden\">\n        <HomeCroppedWorksWithGenerationButton\n          works={props.works}\n          isShowProfile={true}\n          onSelect={props.onSelect}\n        />\n      </div>\n    </>\n  )\n}\n\n/**\n * ãƒ¢ãƒã‚¤ãƒ«ç”¨ã®ã‚¯ãƒ­ãƒƒãƒ—æ¸ˆã¿ä½œå“ä¸€è¦§ï¼ˆå‚ç…§ç”Ÿæˆãƒœã‚¿ãƒ³ä»˜ãï¼‰\n */\nfunction HomeCroppedWorksWithGenerationButton(props: {\n  works: FragmentOf<typeof PhotoAlbumWorkFragment>[]\n  isRanking?: boolean\n  isShowProfile?: boolean\n  onSelect?: (index: string) => void\n}) {\n  return (\n    <div className=\"grid w-full grid-cols-2 gap-3 pr-2 pb-4\">\n      {props.works.map((work) => (\n        <div key={work.id} className=\"flex flex-col space-y-2\">\n          <div className=\"relative\">\n            <CroppedWorkSquare\n              workId={work.id}\n              imageUrl={work.smallThumbnailImageURL}\n              thumbnailImagePosition={work.thumbnailImagePosition ?? 0}\n              size=\"lg\"\n              imageWidth={work.smallThumbnailImageWidth}\n              imageHeight={work.smallThumbnailImageHeight}\n              subWorksCount={work.subWorksCount}\n              isPromptPublic={\n                work.promptAccessType === \"PUBLIC\" || work.isGeneration\n              }\n              hasVideoUrl={Boolean(work.url)}\n              isGeneration={work.isGeneration}\n              hasReferenceButton={true}\n              onSelect={props.onSelect}\n            />\n            {work.subWorksCount > 0 && (\n              <div className=\"absolute top-1 right-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                <Images className=\"size-3 text-white\" />\n                <div className=\"font-bold text-white text-xs\">\n                  {work.subWorksCount + 1}\n                </div>\n              </div>\n            )}\n            {work.commentsCount > 0 && (\n              <div className=\"absolute top-1 left-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                <MessageCircle className=\"size-3 text-white\" />\n                <div className=\"font-bold text-white text-xs\">\n                  {work.commentsCount}\n                </div>\n              </div>\n            )}\n            <div className=\"absolute right-0 bottom-0\">\n              <LikeButton\n                size={56}\n                targetWorkId={work.id}\n                targetWorkOwnerUserId={work.user?.id ?? \"\"}\n                defaultLiked={work.isLiked}\n                defaultLikedCount={0}\n                isBackgroundNone={true}\n                strokeWidth={2}\n              />\n            </div>\n          </div>\n\n          {props.isShowProfile && (\n            <div className=\"flex flex-col space-y-1\">\n              {props.onSelect ? (\n                <button\n                  type=\"button\"\n                  onClick={() => props.onSelect?.(work.id)}\n                  className=\"cursor-pointer text-left\"\n                >\n                  <p className=\"line-clamp-2 text-sm\">{work.title}</p>\n                </button>\n              ) : (\n                <Link to={`/posts/${work.id}`}>\n                  <p className=\"line-clamp-2 text-sm\">{work.title}</p>\n                </Link>\n              )}\n              <Link to={`/users/${work.user?.id}`}>\n                <div className=\"flex items-center space-x-2\">\n                  <Avatar className=\"size-4\">\n                    <AvatarImage\n                      className=\"size-4 rounded-full\"\n                      src={withIconUrlFallback(work.user?.iconUrl)}\n                      alt={work.user?.name}\n                    />\n                    <AvatarFallback />\n                  </Avatar>\n                  <span className=\"truncate text-xs\">{work.user?.name}</span>\n                </div>\n              </Link>\n            </div>\n          )}\n\n          {/* å‚ç…§ç”Ÿæˆãƒœã‚¿ãƒ³ã‚’è¿½åŠ  */}\n          <div className=\"w-full\">\n            <ReferenceGenerationButton workId={work.id} className=\"text-xs\" />\n          </div>\n        </div>\n      ))}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/useKeyWithClickEvents","severity":"error","description":"Enforce to have the onClick mouse event with the onKeyUp, the onKeyDown, or the onKeyPress keyboard event.","message":[{"elements":[],"content":"Enforce to have the "},{"elements":["Emphasis"],"content":"onClick"},{"elements":[],"content":" mouse event with the "},{"elements":["Emphasis"],"content":"onKeyUp"},{"elements":[],"content":", the "},{"elements":["Emphasis"],"content":"onKeyDown"},{"elements":[],"content":", or the "},{"elements":["Emphasis"],"content":"onKeyPress"},{"elements":[],"content":" keyboard event."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Actions triggered using mouse events should have corresponding keyboard events to account for keyboard-only navigation."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main._index/components/responsive-photo-works-album-with-generation-button.tsx"},"span":[7362,7705],"sourceCode":"import type { FragmentOf } from \"gql.tada\"\nimport { RowsPhotoAlbum } from \"react-photo-album\"\nimport SSR from \"react-photo-album/ssr\"\nimport \"react-photo-album/rows.css\"\nimport { Link } from \"@remix-run/react\"\nimport { LikeButton } from \"~/components/like-button\"\nimport { CroppedWorkSquare } from \"~/components/cropped-work-square\"\nimport { Heart, Images, MessageCircle } from \"lucide-react\"\nimport { withIconUrlFallback } from \"~/utils/with-icon-url-fallback\"\nimport { cn } from \"~/lib/utils\"\nimport { Avatar, AvatarImage, AvatarFallback } from \"~/components/ui/avatar\"\nimport { OptimizedImage } from \"~/components/optimized-image\"\nimport { ReferenceGenerationButton } from \"~/routes/($lang)._main._index/components/reference-generation-button\"\nimport type { PhotoAlbumWorkFragment } from \"~/components/responsive-photo-works-album\"\nimport { WorkMediaBadge } from \"~/components/work-media-badge\"\n\ntype Props = {\n  works: FragmentOf<typeof PhotoAlbumWorkFragment>[]\n  targetRowHeight?: number\n  direction?: \"rows\" | \"columns\"\n  size?: \"small\" | \"medium\" | \"large\"\n  isShowProfile?: boolean\n  /** ä½œå“ã‚¯ãƒªãƒƒã‚¯æ™‚ã« index ã‚’è¿”ã™ã€‚æœªæŒ‡å®šãªã‚‰å¾“æ¥é€šã‚Šãƒªãƒ³ã‚¯é·ç§» */\n  onSelect?: (index: string) => void\n}\n\n/**\n * ç”Ÿæˆä½œå“ã‚»ã‚¯ã‚·ãƒ§ãƒ³å°‚ç”¨ã®ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œä½œå“ä¸€è¦§\n * å„ã‚µãƒ ãƒã‚¤ãƒ«ä¸‹ã«å‚ç…§ç”Ÿæˆãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹\n */\nexport function ResponsivePhotoWorksAlbumWithGenerationButton (props: Props) {\n  if (props.works.length <= 2) {\n    return (\n      <div className=\"flex flex-wrap justify-center gap-x-8 gap-y-8\">\n        {props.works.map((workItem, _index) => {\n          return (\n            <div\n              key={workItem.id.toString()}\n              className=\"relative flex flex-col space-y-2\"\n            >\n              <div className=\"relative\">\n                <CroppedWorkSquare\n                  workId={workItem.id}\n                  subWorksCount={workItem.subWorksCount}\n                  imageUrl={workItem.smallThumbnailImageURL}\n                  thumbnailImagePosition={workItem.thumbnailImagePosition ?? 0}\n                  size=\"lg\"\n                  imageWidth={workItem.smallThumbnailImageWidth}\n                  imageHeight={workItem.smallThumbnailImageHeight}\n                  isPromptPublic={workItem.promptAccessType === \"PUBLIC\"}\n                  hasVideoUrl={Boolean(workItem.url)}\n                  isGeneration={workItem.isGeneration}\n                  hasReferenceButton={true}\n                  onSelect={props.onSelect}\n                />\n                {workItem.subWorksCount > 0 && (\n                  <div className=\"absolute top-1 right-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                    <Images className=\"size-3 text-white\" />\n                    <div className=\"font-bold text-white text-xs\">\n                      {workItem.subWorksCount + 1}\n                    </div>\n                  </div>\n                )}\n                <div className=\"absolute right-0 bottom-0\">\n                  <LikeButton\n                    size={56}\n                    targetWorkId={workItem.id}\n                    targetWorkOwnerUserId={workItem.user?.id ?? \"\"}\n                    defaultLiked={workItem.isLiked}\n                    defaultLikedCount={0}\n                    isBackgroundNone={true}\n                    strokeWidth={2}\n                  />\n                </div>\n              </div>\n              {/* å‚ç…§ç”Ÿæˆãƒœã‚¿ãƒ³ã‚’è¿½åŠ  */}\n              <div className=\"w-full\">\n                <ReferenceGenerationButton workId={workItem.id} />\n              </div>\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n\n  return (\n    <>\n      <div className=\"hidden md:block\">\n        <SSR breakpoints={[300, 600, 900, 1200]}>\n          <RowsPhotoAlbum\n            photos={props.works.map((work) => ({\n              key: work.id,\n              id: work.id.toString(),\n              src:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageURL\n                  : work.smallThumbnailImageURL,\n              width:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageWidth\n                  : work.smallThumbnailImageWidth,\n              height:\n                props.size === \"large\"\n                  ? work.largeThumbnailImageHeight\n                  : work.smallThumbnailImageHeight,\n              context: work,\n            }))}\n            targetRowHeight={\n              props.targetRowHeight !== undefined\n                ? props.targetRowHeight\n                : props.direction === \"rows\"\n                  ? 160\n                  : 220\n            }\n            sizes={{\n              size: \"calc(100vw - 240px)\",\n              sizes: [{ viewport: \"(max-width: 960px)\", size: \"100vw\" }],\n            }}\n            componentsProps={{\n              image: { loading: \"lazy\" },\n            }}\n            render={{\n              image: (imageProps, { photo }) => (\n                <div className=\"relative h-full w-full overflow-hidden rounded\">\n                  {props.onSelect ? (\n                    <button\n                      type=\"button\"\n                      className=\"block h-full w-full cursor-pointer overflow-hidden rounded\"\n                      onClick={() => props.onSelect?.(photo.id)}\n                      aria-label={`Open ${photo.context.title}`}\n                    >\n                      <OptimizedImage\n                        src={imageProps.src}\n                        alt={photo.context.title}\n                        className=\"h-full w-full transition-transform duration-300 ease-in-out hover:scale-105\"\n                        width={\n                          typeof imageProps.width === \"string\"\n                            ? Number.parseInt(imageProps.width)\n                            : imageProps.width\n                        }\n                        height={\n                          typeof imageProps.height === \"string\"\n                            ? Number.parseInt(imageProps.height)\n                            : imageProps.height\n                        }\n                        loading={imageProps.loading as \"lazy\" | \"eager\"}\n                      />\n                    </button>\n                  ) : (\n                    <Link\n                      className=\"block h-full w-full overflow-hidden rounded\"\n                      to={`/posts/${photo.context.id}`}\n                    >\n                      <OptimizedImage\n                        src={imageProps.src}\n                        alt={photo.context.title}\n                        className=\"h-full w-full transition-transform duration-300 ease-in-out hover:scale-105\"\n                        width={\n                          typeof imageProps.width === \"string\"\n                            ? Number.parseInt(imageProps.width)\n                            : imageProps.width\n                        }\n                        height={\n                          typeof imageProps.height === \"string\"\n                            ? Number.parseInt(imageProps.height)\n                            : imageProps.height\n                        }\n                        loading={imageProps.loading as \"lazy\" | \"eager\"}\n                      />\n                    </Link>\n                  )}\n                  <div\n                    className={cn(\n                      \"absolute right-0 z-10\",\n                      props.isShowProfile ? \"bottom-28\" : \"bottom-0\",\n                    )}\n                    onClick={(e) => {\n                      e.stopPropagation()\n                      e.preventDefault()\n                    }}\n                  >\n                    <LikeButton\n                      size={56}\n                      targetWorkId={photo.context.id}\n                      targetWorkOwnerUserId={photo.context.user?.id ?? \"\"}\n                      defaultLiked={photo.context.isLiked}\n                      defaultLikedCount={0}\n                      isBackgroundNone={true}\n                      strokeWidth={2}\n                      likedCount={photo.context.likesCount}\n                    />\n                  </div>\n                  {photo.context.subWorksCount > 0 && (\n                    <div className=\"absolute top-1 right-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                      <Images className=\"size-3 text-white\" />\n                      <div className=\"font-bold text-white text-xs\">\n                        {photo.context.subWorksCount + 1}\n                      </div>\n                    </div>\n                  )}\n                  {photo.context.commentsCount > 0 && (\n                    <div className=\"absolute top-1 left-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                      <MessageCircle className=\"size-3 text-white\" />\n                      <div className=\"font-bold text-white text-xs\">\n                        {photo.context.commentsCount}\n                      </div>\n                    </div>\n                  )}\n                  {/* ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå…¬é–‹ãƒ»å‹•ç”»ãƒãƒƒã‚¸ */}\n                  <div className=\"absolute bottom-32 left-1 z-10\">\n                    <WorkMediaBadge\n                      isPromptPublic={\n                        (photo.context.promptAccessType === \"PUBLIC\" &&\n                          photo.context.prompt !== \"\") ||\n                        photo.context.isGeneration\n                      }\n                      hasVideoUrl={Boolean(photo.context.url)}\n                      isGeneration={photo.context.isGeneration}\n                      hasReferenceButton={true}\n                      size=\"md\"\n                    />\n                  </div>\n                  {props.isShowProfile && (\n                    <div className=\"mt-2 flex flex-col space-y-2 overflow-hidden text-ellipsis\">\n                      {props.onSelect ? (\n                        <button\n                          type=\"button\"\n                          className=\"w-48 cursor-pointer font-bold\"\n                          onClick={(e) => {\n                            e.stopPropagation()\n                            props.onSelect?.(photo.context.id.toString())\n                          }}\n                          aria-label={`Open ${photo.context.title}`}\n                        >\n                          <p className=\"overflow-hidden text-ellipsis text-nowrap text-left text-sm\">\n                            {photo.context.title}\n                          </p>\n                        </button>\n                      ) : (\n                        <Link\n                          className=\"w-48 font-bold\"\n                          to={`/posts/${photo.context.id}`}\n                        >\n                          <p className=\"overflow-hidden text-ellipsis text-nowrap text-left text-sm\">\n                            {photo.context.title}\n                          </p>\n                        </Link>\n                      )}\n\n                      <div className=\"flex items-center justify-between\">\n                        <Link to={`/users/${photo.context.user?.id}`}>\n                          <div className=\"flex items-center space-x-2\">\n                            <Avatar className=\"size-6\">\n                              <AvatarImage\n                                className=\"size-6 rounded-full\"\n                                src={withIconUrlFallback(\n                                  photo.context.user?.iconUrl,\n                                )}\n                                alt=\"\"\n                              />\n                              <AvatarFallback />\n                            </Avatar>\n                            <span className=\"truncate text-sm\">\n                              {photo.context.user?.name}\n                            </span>\n                          </div>\n                        </Link>\n                        <div className=\"absolute right-0 ml-auto flex items-center space-x-1 rounded-md bg-card p-1\">\n                          <Heart className=\"size-3 fill-gray-400 text-gray-400\" />\n                          <span className=\"text-xs\">\n                            {photo.context.likesCount}\n                          </span>\n                        </div>\n                      </div>\n\n                      {/* å‚ç…§ç”Ÿæˆãƒœã‚¿ãƒ³ã‚’è¿½åŠ  */}\n                      <div className=\"mt-2 w-full\">\n                        <ReferenceGenerationButton workId={photo.context.id} />\n                      </div>\n                    </div>\n                  )}\n                </div>\n              ),\n            }}\n          />\n        </SSR>\n      </div>\n      <div className=\"block md:hidden\">\n        <HomeCroppedWorksWithGenerationButton\n          works={props.works}\n          isShowProfile={true}\n          onSelect={props.onSelect}\n        />\n      </div>\n    </>\n  )\n}\n\n/**\n * ãƒ¢ãƒã‚¤ãƒ«ç”¨ã®ã‚¯ãƒ­ãƒƒãƒ—æ¸ˆã¿ä½œå“ä¸€è¦§ï¼ˆå‚ç…§ç”Ÿæˆãƒœã‚¿ãƒ³ä»˜ãï¼‰\n */\nfunction HomeCroppedWorksWithGenerationButton(props: {\n  works: FragmentOf<typeof PhotoAlbumWorkFragment>[]\n  isRanking?: boolean\n  isShowProfile?: boolean\n  onSelect?: (index: string) => void\n}) {\n  return (\n    <div className=\"grid w-full grid-cols-2 gap-3 pr-2 pb-4\">\n      {props.works.map((work) => (\n        <div key={work.id} className=\"flex flex-col space-y-2\">\n          <div className=\"relative\">\n            <CroppedWorkSquare\n              workId={work.id}\n              imageUrl={work.smallThumbnailImageURL}\n              thumbnailImagePosition={work.thumbnailImagePosition ?? 0}\n              size=\"lg\"\n              imageWidth={work.smallThumbnailImageWidth}\n              imageHeight={work.smallThumbnailImageHeight}\n              subWorksCount={work.subWorksCount}\n              isPromptPublic={\n                work.promptAccessType === \"PUBLIC\" || work.isGeneration\n              }\n              hasVideoUrl={Boolean(work.url)}\n              isGeneration={work.isGeneration}\n              hasReferenceButton={true}\n              onSelect={props.onSelect}\n            />\n            {work.subWorksCount > 0 && (\n              <div className=\"absolute top-1 right-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                <Images className=\"size-3 text-white\" />\n                <div className=\"font-bold text-white text-xs\">\n                  {work.subWorksCount + 1}\n                </div>\n              </div>\n            )}\n            {work.commentsCount > 0 && (\n              <div className=\"absolute top-1 left-1 z-10 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n                <MessageCircle className=\"size-3 text-white\" />\n                <div className=\"font-bold text-white text-xs\">\n                  {work.commentsCount}\n                </div>\n              </div>\n            )}\n            <div className=\"absolute right-0 bottom-0\">\n              <LikeButton\n                size={56}\n                targetWorkId={work.id}\n                targetWorkOwnerUserId={work.user?.id ?? \"\"}\n                defaultLiked={work.isLiked}\n                defaultLikedCount={0}\n                isBackgroundNone={true}\n                strokeWidth={2}\n              />\n            </div>\n          </div>\n\n          {props.isShowProfile && (\n            <div className=\"flex flex-col space-y-1\">\n              {props.onSelect ? (\n                <button\n                  type=\"button\"\n                  onClick={() => props.onSelect?.(work.id)}\n                  className=\"cursor-pointer text-left\"\n                >\n                  <p className=\"line-clamp-2 text-sm\">{work.title}</p>\n                </button>\n              ) : (\n                <Link to={`/posts/${work.id}`}>\n                  <p className=\"line-clamp-2 text-sm\">{work.title}</p>\n                </Link>\n              )}\n              <Link to={`/users/${work.user?.id}`}>\n                <div className=\"flex items-center space-x-2\">\n                  <Avatar className=\"size-4\">\n                    <AvatarImage\n                      className=\"size-4 rounded-full\"\n                      src={withIconUrlFallback(work.user?.iconUrl)}\n                      alt={work.user?.name}\n                    />\n                    <AvatarFallback />\n                  </Avatar>\n                  <span className=\"truncate text-xs\">{work.user?.name}</span>\n                </div>\n              </Link>\n            </div>\n          )}\n\n          {/* å‚ç…§ç”Ÿæˆãƒœã‚¿ãƒ³ã‚’è¿½åŠ  */}\n          <div className=\"w-full\">\n            <ReferenceGenerationButton workId={work.id} className=\"text-xs\" />\n          </div>\n        </div>\n      ))}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/suspicious/noArrayIndexKey","severity":"error","description":"Avoid using the index of an array as key property in an element.","message":[{"elements":[],"content":"Avoid using the index of an array as key property in an element."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"This is the source of the key value."}]]},{"frame":{"path":null,"span":[8042,8047],"sourceCode":"import { useState } from \"react\"\nimport { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { Label } from \"~/components/ui/label\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"~/components/ui/card\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { Plus, Upload, Edit2, Trash2, Copy } from \"lucide-react\"\nimport type { Character, Expression } from \"../types/character\"\n\ntype Props = {\n  character: Character\n}\n\nexport function ExpressionManager (props: Props) {\n  // ãƒ¢ãƒƒã‚¯è¡¨æƒ…ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã¯APIã‹ã‚‰å–å¾—ï¼‰\n  const [expressions, setExpressions] = useState<Expression[]>([\n    {\n      id: \"1\",\n      name: \"ç¬‘é¡”\",\n      description: \"æ˜ã‚‹ã„ç¬‘é¡”ã®è¡¨æƒ…\",\n      imageUrl: undefined,\n      promptModifier: \"smiling, happy, cheerful\",\n      tags: [\"ãƒã‚¸ãƒ†ã‚£ãƒ–\", \"åŸºæœ¬\"],\n      createdAt: new Date().toISOString(),\n    },\n    {\n      id: \"2\",\n      name: \"å›°ã£ãŸé¡”\",\n      description: \"å›°ã£ãŸæ™‚ã®è¡¨æƒ…\",\n      imageUrl: undefined,\n      promptModifier: \"troubled, worried, confused\",\n      tags: [\"ãƒã‚¬ãƒ†ã‚£ãƒ–\", \"æ„Ÿæƒ…\"],\n      createdAt: new Date().toISOString(),\n    },\n    {\n      id: \"3\",\n      name: \"æ€’ã‚Š\",\n      description: \"æ€’ã£ã¦ã„ã‚‹è¡¨æƒ…\",\n      imageUrl: undefined,\n      promptModifier: \"angry, furious, mad\",\n      tags: [\"ãƒã‚¬ãƒ†ã‚£ãƒ–\", \"å¼·ã„æ„Ÿæƒ…\"],\n      createdAt: new Date().toISOString(),\n    },\n  ])\n\n  const [isAddingNew, setIsAddingNew] = useState(false)\n  const [newExpression, setNewExpression] = useState({\n    name: \"\",\n    description: \"\",\n    promptModifier: \"\",\n    tags: \"\",\n  })\n\n  const handleAddExpression = () => {\n    if (!newExpression.name || !newExpression.promptModifier) return\n\n    const expression: Expression = {\n      id: Date.now().toString(),\n      name: newExpression.name,\n      description: newExpression.description,\n      imageUrl: undefined,\n      promptModifier: newExpression.promptModifier,\n      tags: newExpression.tags\n        .split(\",\")\n        .map((tag) => tag.trim())\n        .filter(Boolean),\n      createdAt: new Date().toISOString(),\n    }\n\n    setExpressions([...expressions, expression])\n    setNewExpression({\n      name: \"\",\n      description: \"\",\n      promptModifier: \"\",\n      tags: \"\",\n    })\n    setIsAddingNew(false)\n  }\n\n  const handleDeleteExpression = (expressionId: string) => {\n    setExpressions(expressions.filter((exp) => exp.id !== expressionId))\n  }\n\n  const handleCopyPrompt = (promptModifier: string) => {\n    navigator.clipboard.writeText(\n      `${props.character.promptText}, ${promptModifier}`,\n    )\n    // TODO: ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’è¡¨ç¤º\n    console.log(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ\")\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h3 className=\"font-semibold text-lg\">è¡¨æƒ…å·®åˆ†ç®¡ç†</h3>\n          <p className=\"text-muted-foreground text-sm\">\n            {props.character.name}ã®è¡¨æƒ…ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç®¡ç†ã—ã¾ã™\n          </p>\n        </div>\n        <Button onClick={() => setIsAddingNew(true)} disabled={isAddingNew}>\n          <Plus className=\"mr-2 h-4 w-4\" />\n          è¡¨æƒ…è¿½åŠ \n        </Button>\n      </div>\n\n      {/* æ–°ã—ã„è¡¨æƒ…è¿½åŠ ãƒ•ã‚©ãƒ¼ãƒ  */}\n      {isAddingNew && (\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-base\">æ–°ã—ã„è¡¨æƒ…ã‚’è¿½åŠ </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"expression-name\">è¡¨æƒ…å</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-name\"\n                value={newExpression.name}\n                onChange={(e) =>\n                  setNewExpression({ ...newExpression, name: e.target.value })\n                }\n                placeholder=\"ä¾‹: ç¬‘é¡”ã€å›°ã£ãŸé¡”ã€æ€’ã‚Š\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"expression-description\">èª¬æ˜</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-description\"\n                value={newExpression.description}\n                onChange={(e) =>\n                  setNewExpression({\n                    ...newExpression,\n                    description: e.target.value,\n                  })\n                }\n                placeholder=\"è¡¨æƒ…ã®è©³ç´°èª¬æ˜\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"expression-prompt\">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¿®é£¾å­</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-prompt\"\n                value={newExpression.promptModifier}\n                onChange={(e) =>\n                  setNewExpression({\n                    ...newExpression,\n                    promptModifier: e.target.value,\n                  })\n                }\n                placeholder=\"ä¾‹: smiling, happy, cheerful\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"expression-tags\">ã‚¿ã‚°ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-tags\"\n                value={newExpression.tags}\n                onChange={(e) =>\n                  setNewExpression({ ...newExpression, tags: e.target.value })\n                }\n                placeholder=\"ä¾‹: ãƒã‚¸ãƒ†ã‚£ãƒ–, åŸºæœ¬, æ„Ÿæƒ…\"\n              />\n            </div>\n            <div className=\"flex gap-2\">\n              <Button\n                onClick={handleAddExpression}\n                disabled={!newExpression.name || !newExpression.promptModifier}\n              >\n                è¿½åŠ \n              </Button>\n              <Button variant=\"outline\" onClick={() => setIsAddingNew(false)}>\n                ã‚­ãƒ£ãƒ³ã‚»ãƒ«\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* è¡¨æƒ…ä¸€è¦§ */}\n      <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2\">\n        {expressions.map((expression) => (\n          <Card key={expression.id}>\n            <CardHeader className=\"pb-2\">\n              <div className=\"flex items-center justify-between\">\n                <CardTitle className=\"text-base\">{expression.name}</CardTitle>\n                <div className=\"flex gap-1\">\n                  <Button variant=\"ghost\" size=\"sm\">\n                    <Upload className=\"h-3 w-3\" />\n                  </Button>\n                  <Button variant=\"ghost\" size=\"sm\">\n                    <Edit2 className=\"h-3 w-3\" />\n                  </Button>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => handleDeleteExpression(expression.id)}\n                  >\n                    <Trash2 className=\"h-3 w-3\" />\n                  </Button>\n                </div>\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"text-muted-foreground text-sm\">\n                {expression.description}\n              </p>\n\n              <div>\n                <Label className=\"text-xs\">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¿®é£¾å­</Label>\n                <div className=\"mt-1 flex items-center gap-2\">\n                  <code className=\"flex-1 rounded bg-muted p-2 font-mono text-xs\">\n                    {expression.promptModifier}\n                  </code>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => handleCopyPrompt(expression.promptModifier)}\n                  >\n                    <Copy className=\"h-3 w-3\" />\n                  </Button>\n                </div>\n              </div>\n\n              <div className=\"flex flex-wrap gap-1\">\n                {expression.tags.map((tag, index) => (\n                  <Badge key={index} variant=\"secondary\" className=\"text-xs\">\n                    {tag}\n                  </Badge>\n                ))}\n              </div>\n\n              <div className=\"flex gap-2 pt-2\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  className=\"flex-1\"\n                  onClick={() => handleCopyPrompt(expression.promptModifier)}\n                >\n                  <Copy className=\"mr-1 h-3 w-3\" />\n                  ã‚³ãƒ”ãƒ¼\n                </Button>\n                <Button variant=\"outline\" size=\"sm\" className=\"flex-1\">\n                  ç”Ÿæˆãƒ†ã‚¹ãƒˆ\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {expressions.length === 0 && !isAddingNew && (\n        <Card>\n          <CardContent className=\"py-8 text-center\">\n            <p className=\"text-muted-foreground\">\n              ã¾ã è¡¨æƒ…å·®åˆ†ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“\n            </p>\n            <Button\n              variant=\"outline\"\n              className=\"mt-2\"\n              onClick={() => setIsAddingNew(true)}\n            >\n              <Plus className=\"mr-2 h-4 w-4\" />\n              æœ€åˆã®è¡¨æƒ…ã‚’è¿½åŠ \n            </Button>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  )\n}\n"}},{"log":["info",[{"elements":[],"content":"The order of the items may change, and this also affects performances and component state."}]]},{"log":["info",[{"elements":[],"content":"Check the "},{"elements":[{"Hyperlink":{"href":"https://reactjs.org/docs/lists-and-keys.html#keys"}}],"content":"React documentation"},{"elements":[],"content":". "}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.character-manager._index/components/expression-manager.tsx"},"span":[8084,8089],"sourceCode":"import { useState } from \"react\"\nimport { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { Label } from \"~/components/ui/label\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"~/components/ui/card\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { Plus, Upload, Edit2, Trash2, Copy } from \"lucide-react\"\nimport type { Character, Expression } from \"../types/character\"\n\ntype Props = {\n  character: Character\n}\n\nexport function ExpressionManager (props: Props) {\n  // ãƒ¢ãƒƒã‚¯è¡¨æƒ…ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã¯APIã‹ã‚‰å–å¾—ï¼‰\n  const [expressions, setExpressions] = useState<Expression[]>([\n    {\n      id: \"1\",\n      name: \"ç¬‘é¡”\",\n      description: \"æ˜ã‚‹ã„ç¬‘é¡”ã®è¡¨æƒ…\",\n      imageUrl: undefined,\n      promptModifier: \"smiling, happy, cheerful\",\n      tags: [\"ãƒã‚¸ãƒ†ã‚£ãƒ–\", \"åŸºæœ¬\"],\n      createdAt: new Date().toISOString(),\n    },\n    {\n      id: \"2\",\n      name: \"å›°ã£ãŸé¡”\",\n      description: \"å›°ã£ãŸæ™‚ã®è¡¨æƒ…\",\n      imageUrl: undefined,\n      promptModifier: \"troubled, worried, confused\",\n      tags: [\"ãƒã‚¬ãƒ†ã‚£ãƒ–\", \"æ„Ÿæƒ…\"],\n      createdAt: new Date().toISOString(),\n    },\n    {\n      id: \"3\",\n      name: \"æ€’ã‚Š\",\n      description: \"æ€’ã£ã¦ã„ã‚‹è¡¨æƒ…\",\n      imageUrl: undefined,\n      promptModifier: \"angry, furious, mad\",\n      tags: [\"ãƒã‚¬ãƒ†ã‚£ãƒ–\", \"å¼·ã„æ„Ÿæƒ…\"],\n      createdAt: new Date().toISOString(),\n    },\n  ])\n\n  const [isAddingNew, setIsAddingNew] = useState(false)\n  const [newExpression, setNewExpression] = useState({\n    name: \"\",\n    description: \"\",\n    promptModifier: \"\",\n    tags: \"\",\n  })\n\n  const handleAddExpression = () => {\n    if (!newExpression.name || !newExpression.promptModifier) return\n\n    const expression: Expression = {\n      id: Date.now().toString(),\n      name: newExpression.name,\n      description: newExpression.description,\n      imageUrl: undefined,\n      promptModifier: newExpression.promptModifier,\n      tags: newExpression.tags\n        .split(\",\")\n        .map((tag) => tag.trim())\n        .filter(Boolean),\n      createdAt: new Date().toISOString(),\n    }\n\n    setExpressions([...expressions, expression])\n    setNewExpression({\n      name: \"\",\n      description: \"\",\n      promptModifier: \"\",\n      tags: \"\",\n    })\n    setIsAddingNew(false)\n  }\n\n  const handleDeleteExpression = (expressionId: string) => {\n    setExpressions(expressions.filter((exp) => exp.id !== expressionId))\n  }\n\n  const handleCopyPrompt = (promptModifier: string) => {\n    navigator.clipboard.writeText(\n      `${props.character.promptText}, ${promptModifier}`,\n    )\n    // TODO: ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’è¡¨ç¤º\n    console.log(\"ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ\")\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h3 className=\"font-semibold text-lg\">è¡¨æƒ…å·®åˆ†ç®¡ç†</h3>\n          <p className=\"text-muted-foreground text-sm\">\n            {props.character.name}ã®è¡¨æƒ…ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç®¡ç†ã—ã¾ã™\n          </p>\n        </div>\n        <Button onClick={() => setIsAddingNew(true)} disabled={isAddingNew}>\n          <Plus className=\"mr-2 h-4 w-4\" />\n          è¡¨æƒ…è¿½åŠ \n        </Button>\n      </div>\n\n      {/* æ–°ã—ã„è¡¨æƒ…è¿½åŠ ãƒ•ã‚©ãƒ¼ãƒ  */}\n      {isAddingNew && (\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-base\">æ–°ã—ã„è¡¨æƒ…ã‚’è¿½åŠ </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"expression-name\">è¡¨æƒ…å</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-name\"\n                value={newExpression.name}\n                onChange={(e) =>\n                  setNewExpression({ ...newExpression, name: e.target.value })\n                }\n                placeholder=\"ä¾‹: ç¬‘é¡”ã€å›°ã£ãŸé¡”ã€æ€’ã‚Š\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"expression-description\">èª¬æ˜</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-description\"\n                value={newExpression.description}\n                onChange={(e) =>\n                  setNewExpression({\n                    ...newExpression,\n                    description: e.target.value,\n                  })\n                }\n                placeholder=\"è¡¨æƒ…ã®è©³ç´°èª¬æ˜\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"expression-prompt\">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¿®é£¾å­</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-prompt\"\n                value={newExpression.promptModifier}\n                onChange={(e) =>\n                  setNewExpression({\n                    ...newExpression,\n                    promptModifier: e.target.value,\n                  })\n                }\n                placeholder=\"ä¾‹: smiling, happy, cheerful\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"expression-tags\">ã‚¿ã‚°ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰</Label>\n              {/** biome-ignore lint/nursery/useUniqueElementIds: <explanation> */}\n              <Input\n                id=\"expression-tags\"\n                value={newExpression.tags}\n                onChange={(e) =>\n                  setNewExpression({ ...newExpression, tags: e.target.value })\n                }\n                placeholder=\"ä¾‹: ãƒã‚¸ãƒ†ã‚£ãƒ–, åŸºæœ¬, æ„Ÿæƒ…\"\n              />\n            </div>\n            <div className=\"flex gap-2\">\n              <Button\n                onClick={handleAddExpression}\n                disabled={!newExpression.name || !newExpression.promptModifier}\n              >\n                è¿½åŠ \n              </Button>\n              <Button variant=\"outline\" onClick={() => setIsAddingNew(false)}>\n                ã‚­ãƒ£ãƒ³ã‚»ãƒ«\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* è¡¨æƒ…ä¸€è¦§ */}\n      <div className=\"grid grid-cols-1 gap-4 md:grid-cols-2\">\n        {expressions.map((expression) => (\n          <Card key={expression.id}>\n            <CardHeader className=\"pb-2\">\n              <div className=\"flex items-center justify-between\">\n                <CardTitle className=\"text-base\">{expression.name}</CardTitle>\n                <div className=\"flex gap-1\">\n                  <Button variant=\"ghost\" size=\"sm\">\n                    <Upload className=\"h-3 w-3\" />\n                  </Button>\n                  <Button variant=\"ghost\" size=\"sm\">\n                    <Edit2 className=\"h-3 w-3\" />\n                  </Button>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => handleDeleteExpression(expression.id)}\n                  >\n                    <Trash2 className=\"h-3 w-3\" />\n                  </Button>\n                </div>\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <p className=\"text-muted-foreground text-sm\">\n                {expression.description}\n              </p>\n\n              <div>\n                <Label className=\"text-xs\">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¿®é£¾å­</Label>\n                <div className=\"mt-1 flex items-center gap-2\">\n                  <code className=\"flex-1 rounded bg-muted p-2 font-mono text-xs\">\n                    {expression.promptModifier}\n                  </code>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => handleCopyPrompt(expression.promptModifier)}\n                  >\n                    <Copy className=\"h-3 w-3\" />\n                  </Button>\n                </div>\n              </div>\n\n              <div className=\"flex flex-wrap gap-1\">\n                {expression.tags.map((tag, index) => (\n                  <Badge key={index} variant=\"secondary\" className=\"text-xs\">\n                    {tag}\n                  </Badge>\n                ))}\n              </div>\n\n              <div className=\"flex gap-2 pt-2\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  className=\"flex-1\"\n                  onClick={() => handleCopyPrompt(expression.promptModifier)}\n                >\n                  <Copy className=\"mr-1 h-3 w-3\" />\n                  ã‚³ãƒ”ãƒ¼\n                </Button>\n                <Button variant=\"outline\" size=\"sm\" className=\"flex-1\">\n                  ç”Ÿæˆãƒ†ã‚¹ãƒˆ\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {expressions.length === 0 && !isAddingNew && (\n        <Card>\n          <CardContent className=\"py-8 text-center\">\n            <p className=\"text-muted-foreground\">\n              ã¾ã è¡¨æƒ…å·®åˆ†ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“\n            </p>\n            <Button\n              variant=\"outline\"\n              className=\"mt-2\"\n              onClick={() => setIsAddingNew(true)}\n            >\n              <Plus className=\"mr-2 h-4 w-4\" />\n              æœ€åˆã®è¡¨æƒ…ã‚’è¿½åŠ \n            </Button>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/useKeyWithClickEvents","severity":"error","description":"Enforce to have the onClick mouse event with the onKeyUp, the onKeyDown, or the onKeyPress keyboard event.","message":[{"elements":[],"content":"Enforce to have the "},{"elements":["Emphasis"],"content":"onClick"},{"elements":[],"content":" mouse event with the "},{"elements":["Emphasis"],"content":"onKeyUp"},{"elements":[],"content":", the "},{"elements":["Emphasis"],"content":"onKeyDown"},{"elements":[],"content":", or the "},{"elements":["Emphasis"],"content":"onKeyPress"},{"elements":[],"content":" keyboard event."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Actions triggered using mouse events should have corresponding keyboard events to account for keyboard-only navigation."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.characters._index/components/character-expression-card.tsx"},"span":[8372,8623],"sourceCode":"import { Card, CardContent } from \"~/components/ui/card\"\nimport { Button } from \"~/components/ui/button\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { useState } from \"react\"\nimport { DELETE_IMAGE_GENERATION_RESULT } from \"../queries\"\nimport { toast } from \"sonner\"\nimport {\n  Download,\n  Trash2,\n  Eye,\n  Clock,\n  CheckCircle,\n  XCircle,\n  Loader2,\n  MoreHorizontal,\n} from \"lucide-react\"\n\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"~/components/ui/dropdown-menu\"\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"~/components/ui/alert-dialog\"\n\ntype Props = {\n  result: {\n    id: string\n    nanoid: string | null\n    prompt: string\n    status:\n      | \"CANCELED\"\n      | \"DONE\"\n      | \"ERROR\"\n      | \"IN_PROGRESS\"\n      | \"PENDING\"\n      | \"RESERVED\"\n    imageUrl?: string | null\n    thumbnailUrl?: string | null\n    t2tImageUrl?: string | null\n    completedAt?: number | null\n  }\n  viewMode: \"grid\" | \"list\"\n  onRefresh: () => void\n}\n\nexport function CharacterExpressionCard (props: Props) {\n  const t = useTranslation()\n  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false)\n  const [isPreviewOpen, setIsPreviewOpen] = useState(false)\n\n  const [deleteResult] = useMutation(deleteImageGenerationResultMutation)\n\n  const { result, viewMode } = props\n\n  // ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‹ã‚‰è¡¨æƒ…åã‚’æŠ½å‡º\n  const extractExpression = (prompt: string) => {\n    const match = prompt.match(/character expression: (.+)/)\n    return match ? match[1] : prompt\n  }\n\n  const expressionName = extractExpression(result.prompt)\n\n  const getStatusIcon = () => {\n    switch (result.status) {\n      case \"DONE\":\n        return <CheckCircle className=\"h-4 w-4 text-green-500\" />\n      case \"PENDING\":\n      case \"IN_PROGRESS\":\n        return <Loader2 className=\"h-4 w-4 animate-spin text-blue-500\" />\n      case \"ERROR\":\n      case \"CANCELED\":\n        return <XCircle className=\"h-4 w-4 text-red-500\" />\n      default:\n        return <Clock className=\"h-4 w-4 text-gray-500\" />\n    }\n  }\n\n  const getStatusText = () => {\n    switch (result.status) {\n      case \"DONE\":\n        return t(\"å®Œäº†\", \"Completed\")\n      case \"PENDING\":\n        return t(\"å¾…æ©Ÿä¸­\", \"Pending\")\n      case \"IN_PROGRESS\":\n        return t(\"ç”Ÿæˆä¸­\", \"Processing\")\n      case \"ERROR\":\n        return t(\"å¤±æ•—\", \"Failed\")\n      case \"CANCELED\":\n        return t(\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\", \"Canceled\")\n      default:\n        return result.status\n    }\n  }\n\n  const getStatusVariant = (): \"default\" | \"secondary\" | \"destructive\" => {\n    switch (result.status) {\n      case \"DONE\":\n        return \"default\"\n      case \"PENDING\":\n      case \"IN_PROGRESS\":\n        return \"secondary\"\n      case \"ERROR\":\n      case \"CANCELED\":\n        return \"destructive\"\n      default:\n        return \"secondary\"\n    }\n  }\n\n  const handleDownload = async () => {\n    if (!result.imageUrl) return\n\n    try {\n      const response = await fetch(result.imageUrl)\n      const blob = await response.blob()\n      const url = URL.createObjectURL(blob)\n      const a = document.createElement(\"a\")\n      a.href = url\n      a.download = `character-${expressionName}-${result.nanoid}.png`\n      document.body.appendChild(a)\n      a.click()\n      document.body.removeChild(a)\n      URL.revokeObjectURL(url)\n      toast.success(t(\"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é–‹å§‹ã—ã¾ã—ãŸ\", \"Download started\"))\n    } catch (error) {\n      console.error(\"Download error:\", error)\n      toast.error(t(\"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Download failed\"))\n    }\n  }\n\n  const handleDelete = async () => {\n    try {\n      await deleteResult({\n        variables: {\n          input: {\n            nanoid: result.nanoid || result.id,\n          },\n        },\n      })\n      toast.success(t(\"å‰Šé™¤ã—ã¾ã—ãŸ\", \"Deleted successfully\"))\n      props.onRefresh()\n    } catch (error) {\n      console.error(\"Delete error:\", error)\n      toast.error(t(\"å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Delete failed\"))\n    }\n    setIsDeleteDialogOpen(false)\n  }\n\n  const imageUrl = result.imageUrl || result.thumbnailUrl\n\n  if (viewMode === \"list\") {\n    return (\n      <Card className=\"overflow-hidden\">\n        <CardContent className=\"p-4\">\n          <div className=\"flex items-center gap-4\">\n            {/* ç”»åƒ */}\n            <div className=\"flex-shrink-0\">\n              {imageUrl ? (\n                <img\n                  src={imageUrl}\n                  alt={expressionName}\n                  className=\"h-16 w-16 cursor-pointer rounded-lg object-cover transition-opacity hover:opacity-80\"\n                  onClick={() => setIsPreviewOpen(true)}\n                />\n              ) : (\n                <div className=\"flex h-16 w-16 items-center justify-center rounded-lg bg-muted\">\n                  <Eye className=\"h-6 w-6 text-muted-foreground\" />\n                </div>\n              )}\n            </div>\n\n            {/* æƒ…å ± */}\n            <div className=\"flex-1\">\n              <div className=\"mb-2 flex items-center gap-2\">\n                <h3 className=\"font-semibold\">{expressionName}</h3>\n                <Badge\n                  variant={getStatusVariant()}\n                  className=\"flex items-center gap-1\"\n                >\n                  {getStatusIcon()}\n                  {getStatusText()}\n                </Badge>\n              </div>\n              {result.completedAt && (\n                <p className=\"text-muted-foreground text-sm\">\n                  {t(\"ç”Ÿæˆæ—¥æ™‚\", \"Created\")}:{\" \"}\n                  {new Date(result.completedAt * 1000).toLocaleString()}\n                </p>\n              )}\n              {result.completedAt && (\n                <p className=\"text-muted-foreground text-sm\">\n                  {t(\"å®Œäº†æ—¥æ™‚\", \"Completed\")}:{\" \"}\n                  {new Date(result.completedAt).toLocaleString()}\n                </p>\n              )}\n            </div>\n\n            {/* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ */}\n            <div className=\"flex items-center gap-2\">\n              {result.status === \"DONE\" && imageUrl && (\n                <>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setIsPreviewOpen(true)}\n                  >\n                    <Eye className=\"h-4 w-4\" />\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\" onClick={handleDownload}>\n                    <Download className=\"h-4 w-4\" />\n                  </Button>\n                </>\n              )}\n              <DropdownMenu>\n                <DropdownMenuTrigger asChild>\n                  <Button variant=\"outline\" size=\"sm\">\n                    <MoreHorizontal className=\"h-4 w-4\" />\n                  </Button>\n                </DropdownMenuTrigger>\n                <DropdownMenuContent align=\"end\">\n                  {result.status === \"DONE\" && imageUrl && (\n                    <>\n                      <DropdownMenuItem onClick={() => setIsPreviewOpen(true)}>\n                        <Eye className=\"mr-2 h-4 w-4\" />\n                        {t(\"ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼\", \"Preview\")}\n                      </DropdownMenuItem>\n                      <DropdownMenuItem onClick={handleDownload}>\n                        <Download className=\"mr-2 h-4 w-4\" />\n                        {t(\"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰\", \"Download\")}\n                      </DropdownMenuItem>\n                      <DropdownMenuSeparator />\n                    </>\n                  )}\n                  <DropdownMenuItem\n                    onClick={() => setIsDeleteDialogOpen(true)}\n                    className=\"text-destructive\"\n                  >\n                    <Trash2 className=\"mr-2 h-4 w-4\" />\n                    {t(\"å‰Šé™¤\", \"Delete\")}\n                  </DropdownMenuItem>\n                </DropdownMenuContent>\n              </DropdownMenu>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  return (\n    <>\n      <Card className=\"group overflow-hidden transition-shadow hover:shadow-md\">\n        <div className=\"relative aspect-square\">\n          {imageUrl ? (\n            <>\n              <img\n                src={imageUrl}\n                alt={expressionName}\n                className=\"h-full w-full cursor-pointer object-cover transition-transform hover:scale-105\"\n                onClick={() => setIsPreviewOpen(true)}\n              />\n              {/* ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */}\n              <div className=\"absolute inset-0 flex items-center justify-center bg-black/0 opacity-0 transition-colors group-hover:bg-black/20 group-hover:opacity-100\">\n                <div className=\"flex gap-2\">\n                  <Button\n                    variant=\"secondary\"\n                    size=\"sm\"\n                    onClick={() => setIsPreviewOpen(true)}\n                  >\n                    <Eye className=\"h-4 w-4\" />\n                  </Button>\n                  {result.status === \"DONE\" && (\n                    <Button\n                      variant=\"secondary\"\n                      size=\"sm\"\n                      onClick={handleDownload}\n                    >\n                      <Download className=\"h-4 w-4\" />\n                    </Button>\n                  )}\n                </div>\n              </div>\n            </>\n          ) : (\n            <div className=\"flex h-full w-full items-center justify-center bg-muted\">\n              {result.status === \"PENDING\" ||\n              result.status === \"IN_PROGRESS\" ? (\n                <div className=\"text-center\">\n                  <Loader2 className=\"mx-auto mb-2 h-8 w-8 animate-spin text-muted-foreground\" />\n                  <p className=\"text-muted-foreground text-sm\">\n                    {getStatusText()}\n                  </p>\n                </div>\n              ) : (\n                <div className=\"text-center\">\n                  <Eye className=\"mx-auto mb-2 h-8 w-8 text-muted-foreground\" />\n                  <p className=\"text-muted-foreground text-sm\">\n                    {getStatusText()}\n                  </p>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒã‚¸ */}\n          <div className=\"absolute top-2 right-2\">\n            <Badge\n              variant={getStatusVariant()}\n              className=\"flex items-center gap-1\"\n            >\n              {getStatusIcon()}\n              {getStatusText()}\n            </Badge>\n          </div>\n        </div>\n\n        <CardContent className=\"p-3\">\n          <div className=\"flex items-center justify-between\">\n            <h3 className=\"truncate font-semibold text-sm\">{expressionName}</h3>\n            <DropdownMenu>\n              <DropdownMenuTrigger asChild>\n                <Button variant=\"ghost\" size=\"sm\">\n                  <MoreHorizontal className=\"h-4 w-4\" />\n                </Button>\n              </DropdownMenuTrigger>\n              <DropdownMenuContent align=\"end\">\n                {result.status === \"DONE\" && imageUrl && (\n                  <>\n                    <DropdownMenuItem onClick={() => setIsPreviewOpen(true)}>\n                      <Eye className=\"mr-2 h-4 w-4\" />\n                      {t(\"ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼\", \"Preview\")}\n                    </DropdownMenuItem>\n                    <DropdownMenuItem onClick={handleDownload}>\n                      <Download className=\"mr-2 h-4 w-4\" />\n                      {t(\"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰\", \"Download\")}\n                    </DropdownMenuItem>\n                    <DropdownMenuSeparator />\n                  </>\n                )}\n                <DropdownMenuItem\n                  onClick={() => setIsDeleteDialogOpen(true)}\n                  className=\"text-destructive\"\n                >\n                  <Trash2 className=\"mr-2 h-4 w-4\" />\n                  {t(\"å‰Šé™¤\", \"Delete\")}\n                </DropdownMenuItem>\n              </DropdownMenuContent>\n            </DropdownMenu>\n          </div>\n          {result.completedAt && (\n            <p className=\"mt-1 text-muted-foreground text-xs\">\n              {new Date(result.completedAt * 1000).toLocaleString()}\n            </p>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ€ã‚¤ã‚¢ãƒ­ã‚° */}\n      {isPreviewOpen && imageUrl && (\n        <button\n          className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/80\"\n          onClick={() => setIsPreviewOpen(false)}\n          onKeyDown={(e) => e.key === \"Escape\" && setIsPreviewOpen(false)}\n          aria-label=\"Close preview\"\n        >\n          <div className=\"max-h-[90vh] max-w-4xl p-4\">\n            <img\n              src={imageUrl}\n              alt={expressionName}\n              className=\"max-h-full max-w-full object-contain\"\n              onClick={(e) => e.stopPropagation()}\n              onKeyDown={(e) => e.key === \"Enter\" && e.stopPropagation()}\n            />\n          </div>\n        </button>\n      )}\n\n      {/* å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚° */}\n      <AlertDialog\n        open={isDeleteDialogOpen}\n        onOpenChange={setIsDeleteDialogOpen}\n      >\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>\n              {t(\"è¡¨æƒ…ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\", \"Delete Expression?\")}\n            </AlertDialogTitle>\n            <AlertDialogDescription>\n              {t(\n                \"ã“ã®æ“ä½œã¯å…ƒã«æˆ»ã›ã¾ã›ã‚“ã€‚è¡¨æƒ…ã€Œ{expression}ã€ã‚’å®Œå…¨ã«å‰Šé™¤ã—ã¾ã™ã€‚\",\n                'This action cannot be undone. This will permanently delete the expression \"{expression}\".',\n              ).replace(\"{expression}\", expressionName)}\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>{t(\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\", \"Cancel\")}</AlertDialogCancel>\n            <AlertDialogAction onClick={handleDelete}>\n              {t(\"å‰Šé™¤\", \"Delete\")}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </>\n  )\n}\n\nconst deleteImageGenerationResultMutation = DELETE_IMAGE_GENERATION_RESULT\n"},"tags":[],"source":null},{"category":"lint/a11y/useKeyWithClickEvents","severity":"error","description":"Enforce to have the onClick mouse event with the onKeyUp, the onKeyDown, or the onKeyPress keyboard event.","message":[{"elements":[],"content":"Enforce to have the "},{"elements":["Emphasis"],"content":"onClick"},{"elements":[],"content":" mouse event with the "},{"elements":["Emphasis"],"content":"onKeyUp"},{"elements":[],"content":", the "},{"elements":["Emphasis"],"content":"onKeyDown"},{"elements":[],"content":", or the "},{"elements":["Emphasis"],"content":"onKeyPress"},{"elements":[],"content":" keyboard event."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Actions triggered using mouse events should have corresponding keyboard events to account for keyboard-only navigation."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.characters._index/components/character-expression-card.tsx"},"span":[4631,4898],"sourceCode":"import { Card, CardContent } from \"~/components/ui/card\"\nimport { Button } from \"~/components/ui/button\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { useState } from \"react\"\nimport { DELETE_IMAGE_GENERATION_RESULT } from \"../queries\"\nimport { toast } from \"sonner\"\nimport {\n  Download,\n  Trash2,\n  Eye,\n  Clock,\n  CheckCircle,\n  XCircle,\n  Loader2,\n  MoreHorizontal,\n} from \"lucide-react\"\n\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"~/components/ui/dropdown-menu\"\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"~/components/ui/alert-dialog\"\n\ntype Props = {\n  result: {\n    id: string\n    nanoid: string | null\n    prompt: string\n    status:\n      | \"CANCELED\"\n      | \"DONE\"\n      | \"ERROR\"\n      | \"IN_PROGRESS\"\n      | \"PENDING\"\n      | \"RESERVED\"\n    imageUrl?: string | null\n    thumbnailUrl?: string | null\n    t2tImageUrl?: string | null\n    completedAt?: number | null\n  }\n  viewMode: \"grid\" | \"list\"\n  onRefresh: () => void\n}\n\nexport function CharacterExpressionCard (props: Props) {\n  const t = useTranslation()\n  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false)\n  const [isPreviewOpen, setIsPreviewOpen] = useState(false)\n\n  const [deleteResult] = useMutation(deleteImageGenerationResultMutation)\n\n  const { result, viewMode } = props\n\n  // ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‹ã‚‰è¡¨æƒ…åã‚’æŠ½å‡º\n  const extractExpression = (prompt: string) => {\n    const match = prompt.match(/character expression: (.+)/)\n    return match ? match[1] : prompt\n  }\n\n  const expressionName = extractExpression(result.prompt)\n\n  const getStatusIcon = () => {\n    switch (result.status) {\n      case \"DONE\":\n        return <CheckCircle className=\"h-4 w-4 text-green-500\" />\n      case \"PENDING\":\n      case \"IN_PROGRESS\":\n        return <Loader2 className=\"h-4 w-4 animate-spin text-blue-500\" />\n      case \"ERROR\":\n      case \"CANCELED\":\n        return <XCircle className=\"h-4 w-4 text-red-500\" />\n      default:\n        return <Clock className=\"h-4 w-4 text-gray-500\" />\n    }\n  }\n\n  const getStatusText = () => {\n    switch (result.status) {\n      case \"DONE\":\n        return t(\"å®Œäº†\", \"Completed\")\n      case \"PENDING\":\n        return t(\"å¾…æ©Ÿä¸­\", \"Pending\")\n      case \"IN_PROGRESS\":\n        return t(\"ç”Ÿæˆä¸­\", \"Processing\")\n      case \"ERROR\":\n        return t(\"å¤±æ•—\", \"Failed\")\n      case \"CANCELED\":\n        return t(\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\", \"Canceled\")\n      default:\n        return result.status\n    }\n  }\n\n  const getStatusVariant = (): \"default\" | \"secondary\" | \"destructive\" => {\n    switch (result.status) {\n      case \"DONE\":\n        return \"default\"\n      case \"PENDING\":\n      case \"IN_PROGRESS\":\n        return \"secondary\"\n      case \"ERROR\":\n      case \"CANCELED\":\n        return \"destructive\"\n      default:\n        return \"secondary\"\n    }\n  }\n\n  const handleDownload = async () => {\n    if (!result.imageUrl) return\n\n    try {\n      const response = await fetch(result.imageUrl)\n      const blob = await response.blob()\n      const url = URL.createObjectURL(blob)\n      const a = document.createElement(\"a\")\n      a.href = url\n      a.download = `character-${expressionName}-${result.nanoid}.png`\n      document.body.appendChild(a)\n      a.click()\n      document.body.removeChild(a)\n      URL.revokeObjectURL(url)\n      toast.success(t(\"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é–‹å§‹ã—ã¾ã—ãŸ\", \"Download started\"))\n    } catch (error) {\n      console.error(\"Download error:\", error)\n      toast.error(t(\"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Download failed\"))\n    }\n  }\n\n  const handleDelete = async () => {\n    try {\n      await deleteResult({\n        variables: {\n          input: {\n            nanoid: result.nanoid || result.id,\n          },\n        },\n      })\n      toast.success(t(\"å‰Šé™¤ã—ã¾ã—ãŸ\", \"Deleted successfully\"))\n      props.onRefresh()\n    } catch (error) {\n      console.error(\"Delete error:\", error)\n      toast.error(t(\"å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Delete failed\"))\n    }\n    setIsDeleteDialogOpen(false)\n  }\n\n  const imageUrl = result.imageUrl || result.thumbnailUrl\n\n  if (viewMode === \"list\") {\n    return (\n      <Card className=\"overflow-hidden\">\n        <CardContent className=\"p-4\">\n          <div className=\"flex items-center gap-4\">\n            {/* ç”»åƒ */}\n            <div className=\"flex-shrink-0\">\n              {imageUrl ? (\n                <img\n                  src={imageUrl}\n                  alt={expressionName}\n                  className=\"h-16 w-16 cursor-pointer rounded-lg object-cover transition-opacity hover:opacity-80\"\n                  onClick={() => setIsPreviewOpen(true)}\n                />\n              ) : (\n                <div className=\"flex h-16 w-16 items-center justify-center rounded-lg bg-muted\">\n                  <Eye className=\"h-6 w-6 text-muted-foreground\" />\n                </div>\n              )}\n            </div>\n\n            {/* æƒ…å ± */}\n            <div className=\"flex-1\">\n              <div className=\"mb-2 flex items-center gap-2\">\n                <h3 className=\"font-semibold\">{expressionName}</h3>\n                <Badge\n                  variant={getStatusVariant()}\n                  className=\"flex items-center gap-1\"\n                >\n                  {getStatusIcon()}\n                  {getStatusText()}\n                </Badge>\n              </div>\n              {result.completedAt && (\n                <p className=\"text-muted-foreground text-sm\">\n                  {t(\"ç”Ÿæˆæ—¥æ™‚\", \"Created\")}:{\" \"}\n                  {new Date(result.completedAt * 1000).toLocaleString()}\n                </p>\n              )}\n              {result.completedAt && (\n                <p className=\"text-muted-foreground text-sm\">\n                  {t(\"å®Œäº†æ—¥æ™‚\", \"Completed\")}:{\" \"}\n                  {new Date(result.completedAt).toLocaleString()}\n                </p>\n              )}\n            </div>\n\n            {/* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ */}\n            <div className=\"flex items-center gap-2\">\n              {result.status === \"DONE\" && imageUrl && (\n                <>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setIsPreviewOpen(true)}\n                  >\n                    <Eye className=\"h-4 w-4\" />\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\" onClick={handleDownload}>\n                    <Download className=\"h-4 w-4\" />\n                  </Button>\n                </>\n              )}\n              <DropdownMenu>\n                <DropdownMenuTrigger asChild>\n                  <Button variant=\"outline\" size=\"sm\">\n                    <MoreHorizontal className=\"h-4 w-4\" />\n                  </Button>\n                </DropdownMenuTrigger>\n                <DropdownMenuContent align=\"end\">\n                  {result.status === \"DONE\" && imageUrl && (\n                    <>\n                      <DropdownMenuItem onClick={() => setIsPreviewOpen(true)}>\n                        <Eye className=\"mr-2 h-4 w-4\" />\n                        {t(\"ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼\", \"Preview\")}\n                      </DropdownMenuItem>\n                      <DropdownMenuItem onClick={handleDownload}>\n                        <Download className=\"mr-2 h-4 w-4\" />\n                        {t(\"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰\", \"Download\")}\n                      </DropdownMenuItem>\n                      <DropdownMenuSeparator />\n                    </>\n                  )}\n                  <DropdownMenuItem\n                    onClick={() => setIsDeleteDialogOpen(true)}\n                    className=\"text-destructive\"\n                  >\n                    <Trash2 className=\"mr-2 h-4 w-4\" />\n                    {t(\"å‰Šé™¤\", \"Delete\")}\n                  </DropdownMenuItem>\n                </DropdownMenuContent>\n              </DropdownMenu>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  return (\n    <>\n      <Card className=\"group overflow-hidden transition-shadow hover:shadow-md\">\n        <div className=\"relative aspect-square\">\n          {imageUrl ? (\n            <>\n              <img\n                src={imageUrl}\n                alt={expressionName}\n                className=\"h-full w-full cursor-pointer object-cover transition-transform hover:scale-105\"\n                onClick={() => setIsPreviewOpen(true)}\n              />\n              {/* ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */}\n              <div className=\"absolute inset-0 flex items-center justify-center bg-black/0 opacity-0 transition-colors group-hover:bg-black/20 group-hover:opacity-100\">\n                <div className=\"flex gap-2\">\n                  <Button\n                    variant=\"secondary\"\n                    size=\"sm\"\n                    onClick={() => setIsPreviewOpen(true)}\n                  >\n                    <Eye className=\"h-4 w-4\" />\n                  </Button>\n                  {result.status === \"DONE\" && (\n                    <Button\n                      variant=\"secondary\"\n                      size=\"sm\"\n                      onClick={handleDownload}\n                    >\n                      <Download className=\"h-4 w-4\" />\n                    </Button>\n                  )}\n                </div>\n              </div>\n            </>\n          ) : (\n            <div className=\"flex h-full w-full items-center justify-center bg-muted\">\n              {result.status === \"PENDING\" ||\n              result.status === \"IN_PROGRESS\" ? (\n                <div className=\"text-center\">\n                  <Loader2 className=\"mx-auto mb-2 h-8 w-8 animate-spin text-muted-foreground\" />\n                  <p className=\"text-muted-foreground text-sm\">\n                    {getStatusText()}\n                  </p>\n                </div>\n              ) : (\n                <div className=\"text-center\">\n                  <Eye className=\"mx-auto mb-2 h-8 w-8 text-muted-foreground\" />\n                  <p className=\"text-muted-foreground text-sm\">\n                    {getStatusText()}\n                  </p>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒã‚¸ */}\n          <div className=\"absolute top-2 right-2\">\n            <Badge\n              variant={getStatusVariant()}\n              className=\"flex items-center gap-1\"\n            >\n              {getStatusIcon()}\n              {getStatusText()}\n            </Badge>\n          </div>\n        </div>\n\n        <CardContent className=\"p-3\">\n          <div className=\"flex items-center justify-between\">\n            <h3 className=\"truncate font-semibold text-sm\">{expressionName}</h3>\n            <DropdownMenu>\n              <DropdownMenuTrigger asChild>\n                <Button variant=\"ghost\" size=\"sm\">\n                  <MoreHorizontal className=\"h-4 w-4\" />\n                </Button>\n              </DropdownMenuTrigger>\n              <DropdownMenuContent align=\"end\">\n                {result.status === \"DONE\" && imageUrl && (\n                  <>\n                    <DropdownMenuItem onClick={() => setIsPreviewOpen(true)}>\n                      <Eye className=\"mr-2 h-4 w-4\" />\n                      {t(\"ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼\", \"Preview\")}\n                    </DropdownMenuItem>\n                    <DropdownMenuItem onClick={handleDownload}>\n                      <Download className=\"mr-2 h-4 w-4\" />\n                      {t(\"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰\", \"Download\")}\n                    </DropdownMenuItem>\n                    <DropdownMenuSeparator />\n                  </>\n                )}\n                <DropdownMenuItem\n                  onClick={() => setIsDeleteDialogOpen(true)}\n                  className=\"text-destructive\"\n                >\n                  <Trash2 className=\"mr-2 h-4 w-4\" />\n                  {t(\"å‰Šé™¤\", \"Delete\")}\n                </DropdownMenuItem>\n              </DropdownMenuContent>\n            </DropdownMenu>\n          </div>\n          {result.completedAt && (\n            <p className=\"mt-1 text-muted-foreground text-xs\">\n              {new Date(result.completedAt * 1000).toLocaleString()}\n            </p>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ€ã‚¤ã‚¢ãƒ­ã‚° */}\n      {isPreviewOpen && imageUrl && (\n        <button\n          className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/80\"\n          onClick={() => setIsPreviewOpen(false)}\n          onKeyDown={(e) => e.key === \"Escape\" && setIsPreviewOpen(false)}\n          aria-label=\"Close preview\"\n        >\n          <div className=\"max-h-[90vh] max-w-4xl p-4\">\n            <img\n              src={imageUrl}\n              alt={expressionName}\n              className=\"max-h-full max-w-full object-contain\"\n              onClick={(e) => e.stopPropagation()}\n              onKeyDown={(e) => e.key === \"Enter\" && e.stopPropagation()}\n            />\n          </div>\n        </button>\n      )}\n\n      {/* å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚° */}\n      <AlertDialog\n        open={isDeleteDialogOpen}\n        onOpenChange={setIsDeleteDialogOpen}\n      >\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>\n              {t(\"è¡¨æƒ…ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\", \"Delete Expression?\")}\n            </AlertDialogTitle>\n            <AlertDialogDescription>\n              {t(\n                \"ã“ã®æ“ä½œã¯å…ƒã«æˆ»ã›ã¾ã›ã‚“ã€‚è¡¨æƒ…ã€Œ{expression}ã€ã‚’å®Œå…¨ã«å‰Šé™¤ã—ã¾ã™ã€‚\",\n                'This action cannot be undone. This will permanently delete the expression \"{expression}\".',\n              ).replace(\"{expression}\", expressionName)}\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>{t(\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\", \"Cancel\")}</AlertDialogCancel>\n            <AlertDialogAction onClick={handleDelete}>\n              {t(\"å‰Šé™¤\", \"Delete\")}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </>\n  )\n}\n\nconst deleteImageGenerationResultMutation = DELETE_IMAGE_GENERATION_RESULT\n"},"tags":[],"source":null},{"category":"lint/a11y/useButtonType","severity":"error","description":"Provide an explicit type prop for the button element.","message":[{"elements":[],"content":"Provide an explicit "},{"elements":["Emphasis"],"content":"type"},{"elements":[],"content":" prop for the "},{"elements":["Emphasis"],"content":"button"},{"elements":[],"content":" element."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"The default "},{"elements":["Emphasis"],"content":"type"},{"elements":[],"content":" of a button is "},{"elements":["Emphasis"],"content":"submit"},{"elements":[],"content":", which causes the submission of a form when placed inside a `form` element. This is likely not the behaviour that you want inside a React application."}]]},{"log":["info",[{"elements":[],"content":"Allowed button types are: "},{"elements":["Emphasis"],"content":"submit"},{"elements":[],"content":", "},{"elements":["Emphasis"],"content":"button"},{"elements":[],"content":" or "},{"elements":["Emphasis"],"content":"reset"},{"elements":[],"content":""}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.characters._index/components/character-expression-card.tsx"},"span":[12481,12746],"sourceCode":"import { Card, CardContent } from \"~/components/ui/card\"\nimport { Button } from \"~/components/ui/button\"\nimport { Badge } from \"~/components/ui/badge\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { useState } from \"react\"\nimport { DELETE_IMAGE_GENERATION_RESULT } from \"../queries\"\nimport { toast } from \"sonner\"\nimport {\n  Download,\n  Trash2,\n  Eye,\n  Clock,\n  CheckCircle,\n  XCircle,\n  Loader2,\n  MoreHorizontal,\n} from \"lucide-react\"\n\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"~/components/ui/dropdown-menu\"\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"~/components/ui/alert-dialog\"\n\ntype Props = {\n  result: {\n    id: string\n    nanoid: string | null\n    prompt: string\n    status:\n      | \"CANCELED\"\n      | \"DONE\"\n      | \"ERROR\"\n      | \"IN_PROGRESS\"\n      | \"PENDING\"\n      | \"RESERVED\"\n    imageUrl?: string | null\n    thumbnailUrl?: string | null\n    t2tImageUrl?: string | null\n    completedAt?: number | null\n  }\n  viewMode: \"grid\" | \"list\"\n  onRefresh: () => void\n}\n\nexport function CharacterExpressionCard (props: Props) {\n  const t = useTranslation()\n  const [isDeleteDialogOpen, setIsDeleteDialogOpen] = useState(false)\n  const [isPreviewOpen, setIsPreviewOpen] = useState(false)\n\n  const [deleteResult] = useMutation(deleteImageGenerationResultMutation)\n\n  const { result, viewMode } = props\n\n  // ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‹ã‚‰è¡¨æƒ…åã‚’æŠ½å‡º\n  const extractExpression = (prompt: string) => {\n    const match = prompt.match(/character expression: (.+)/)\n    return match ? match[1] : prompt\n  }\n\n  const expressionName = extractExpression(result.prompt)\n\n  const getStatusIcon = () => {\n    switch (result.status) {\n      case \"DONE\":\n        return <CheckCircle className=\"h-4 w-4 text-green-500\" />\n      case \"PENDING\":\n      case \"IN_PROGRESS\":\n        return <Loader2 className=\"h-4 w-4 animate-spin text-blue-500\" />\n      case \"ERROR\":\n      case \"CANCELED\":\n        return <XCircle className=\"h-4 w-4 text-red-500\" />\n      default:\n        return <Clock className=\"h-4 w-4 text-gray-500\" />\n    }\n  }\n\n  const getStatusText = () => {\n    switch (result.status) {\n      case \"DONE\":\n        return t(\"å®Œäº†\", \"Completed\")\n      case \"PENDING\":\n        return t(\"å¾…æ©Ÿä¸­\", \"Pending\")\n      case \"IN_PROGRESS\":\n        return t(\"ç”Ÿæˆä¸­\", \"Processing\")\n      case \"ERROR\":\n        return t(\"å¤±æ•—\", \"Failed\")\n      case \"CANCELED\":\n        return t(\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\", \"Canceled\")\n      default:\n        return result.status\n    }\n  }\n\n  const getStatusVariant = (): \"default\" | \"secondary\" | \"destructive\" => {\n    switch (result.status) {\n      case \"DONE\":\n        return \"default\"\n      case \"PENDING\":\n      case \"IN_PROGRESS\":\n        return \"secondary\"\n      case \"ERROR\":\n      case \"CANCELED\":\n        return \"destructive\"\n      default:\n        return \"secondary\"\n    }\n  }\n\n  const handleDownload = async () => {\n    if (!result.imageUrl) return\n\n    try {\n      const response = await fetch(result.imageUrl)\n      const blob = await response.blob()\n      const url = URL.createObjectURL(blob)\n      const a = document.createElement(\"a\")\n      a.href = url\n      a.download = `character-${expressionName}-${result.nanoid}.png`\n      document.body.appendChild(a)\n      a.click()\n      document.body.removeChild(a)\n      URL.revokeObjectURL(url)\n      toast.success(t(\"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é–‹å§‹ã—ã¾ã—ãŸ\", \"Download started\"))\n    } catch (error) {\n      console.error(\"Download error:\", error)\n      toast.error(t(\"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Download failed\"))\n    }\n  }\n\n  const handleDelete = async () => {\n    try {\n      await deleteResult({\n        variables: {\n          input: {\n            nanoid: result.nanoid || result.id,\n          },\n        },\n      })\n      toast.success(t(\"å‰Šé™¤ã—ã¾ã—ãŸ\", \"Deleted successfully\"))\n      props.onRefresh()\n    } catch (error) {\n      console.error(\"Delete error:\", error)\n      toast.error(t(\"å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ\", \"Delete failed\"))\n    }\n    setIsDeleteDialogOpen(false)\n  }\n\n  const imageUrl = result.imageUrl || result.thumbnailUrl\n\n  if (viewMode === \"list\") {\n    return (\n      <Card className=\"overflow-hidden\">\n        <CardContent className=\"p-4\">\n          <div className=\"flex items-center gap-4\">\n            {/* ç”»åƒ */}\n            <div className=\"flex-shrink-0\">\n              {imageUrl ? (\n                <img\n                  src={imageUrl}\n                  alt={expressionName}\n                  className=\"h-16 w-16 cursor-pointer rounded-lg object-cover transition-opacity hover:opacity-80\"\n                  onClick={() => setIsPreviewOpen(true)}\n                />\n              ) : (\n                <div className=\"flex h-16 w-16 items-center justify-center rounded-lg bg-muted\">\n                  <Eye className=\"h-6 w-6 text-muted-foreground\" />\n                </div>\n              )}\n            </div>\n\n            {/* æƒ…å ± */}\n            <div className=\"flex-1\">\n              <div className=\"mb-2 flex items-center gap-2\">\n                <h3 className=\"font-semibold\">{expressionName}</h3>\n                <Badge\n                  variant={getStatusVariant()}\n                  className=\"flex items-center gap-1\"\n                >\n                  {getStatusIcon()}\n                  {getStatusText()}\n                </Badge>\n              </div>\n              {result.completedAt && (\n                <p className=\"text-muted-foreground text-sm\">\n                  {t(\"ç”Ÿæˆæ—¥æ™‚\", \"Created\")}:{\" \"}\n                  {new Date(result.completedAt * 1000).toLocaleString()}\n                </p>\n              )}\n              {result.completedAt && (\n                <p className=\"text-muted-foreground text-sm\">\n                  {t(\"å®Œäº†æ—¥æ™‚\", \"Completed\")}:{\" \"}\n                  {new Date(result.completedAt).toLocaleString()}\n                </p>\n              )}\n            </div>\n\n            {/* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ */}\n            <div className=\"flex items-center gap-2\">\n              {result.status === \"DONE\" && imageUrl && (\n                <>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setIsPreviewOpen(true)}\n                  >\n                    <Eye className=\"h-4 w-4\" />\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\" onClick={handleDownload}>\n                    <Download className=\"h-4 w-4\" />\n                  </Button>\n                </>\n              )}\n              <DropdownMenu>\n                <DropdownMenuTrigger asChild>\n                  <Button variant=\"outline\" size=\"sm\">\n                    <MoreHorizontal className=\"h-4 w-4\" />\n                  </Button>\n                </DropdownMenuTrigger>\n                <DropdownMenuContent align=\"end\">\n                  {result.status === \"DONE\" && imageUrl && (\n                    <>\n                      <DropdownMenuItem onClick={() => setIsPreviewOpen(true)}>\n                        <Eye className=\"mr-2 h-4 w-4\" />\n                        {t(\"ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼\", \"Preview\")}\n                      </DropdownMenuItem>\n                      <DropdownMenuItem onClick={handleDownload}>\n                        <Download className=\"mr-2 h-4 w-4\" />\n                        {t(\"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰\", \"Download\")}\n                      </DropdownMenuItem>\n                      <DropdownMenuSeparator />\n                    </>\n                  )}\n                  <DropdownMenuItem\n                    onClick={() => setIsDeleteDialogOpen(true)}\n                    className=\"text-destructive\"\n                  >\n                    <Trash2 className=\"mr-2 h-4 w-4\" />\n                    {t(\"å‰Šé™¤\", \"Delete\")}\n                  </DropdownMenuItem>\n                </DropdownMenuContent>\n              </DropdownMenu>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  return (\n    <>\n      <Card className=\"group overflow-hidden transition-shadow hover:shadow-md\">\n        <div className=\"relative aspect-square\">\n          {imageUrl ? (\n            <>\n              <img\n                src={imageUrl}\n                alt={expressionName}\n                className=\"h-full w-full cursor-pointer object-cover transition-transform hover:scale-105\"\n                onClick={() => setIsPreviewOpen(true)}\n              />\n              {/* ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */}\n              <div className=\"absolute inset-0 flex items-center justify-center bg-black/0 opacity-0 transition-colors group-hover:bg-black/20 group-hover:opacity-100\">\n                <div className=\"flex gap-2\">\n                  <Button\n                    variant=\"secondary\"\n                    size=\"sm\"\n                    onClick={() => setIsPreviewOpen(true)}\n                  >\n                    <Eye className=\"h-4 w-4\" />\n                  </Button>\n                  {result.status === \"DONE\" && (\n                    <Button\n                      variant=\"secondary\"\n                      size=\"sm\"\n                      onClick={handleDownload}\n                    >\n                      <Download className=\"h-4 w-4\" />\n                    </Button>\n                  )}\n                </div>\n              </div>\n            </>\n          ) : (\n            <div className=\"flex h-full w-full items-center justify-center bg-muted\">\n              {result.status === \"PENDING\" ||\n              result.status === \"IN_PROGRESS\" ? (\n                <div className=\"text-center\">\n                  <Loader2 className=\"mx-auto mb-2 h-8 w-8 animate-spin text-muted-foreground\" />\n                  <p className=\"text-muted-foreground text-sm\">\n                    {getStatusText()}\n                  </p>\n                </div>\n              ) : (\n                <div className=\"text-center\">\n                  <Eye className=\"mx-auto mb-2 h-8 w-8 text-muted-foreground\" />\n                  <p className=\"text-muted-foreground text-sm\">\n                    {getStatusText()}\n                  </p>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒã‚¸ */}\n          <div className=\"absolute top-2 right-2\">\n            <Badge\n              variant={getStatusVariant()}\n              className=\"flex items-center gap-1\"\n            >\n              {getStatusIcon()}\n              {getStatusText()}\n            </Badge>\n          </div>\n        </div>\n\n        <CardContent className=\"p-3\">\n          <div className=\"flex items-center justify-between\">\n            <h3 className=\"truncate font-semibold text-sm\">{expressionName}</h3>\n            <DropdownMenu>\n              <DropdownMenuTrigger asChild>\n                <Button variant=\"ghost\" size=\"sm\">\n                  <MoreHorizontal className=\"h-4 w-4\" />\n                </Button>\n              </DropdownMenuTrigger>\n              <DropdownMenuContent align=\"end\">\n                {result.status === \"DONE\" && imageUrl && (\n                  <>\n                    <DropdownMenuItem onClick={() => setIsPreviewOpen(true)}>\n                      <Eye className=\"mr-2 h-4 w-4\" />\n                      {t(\"ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼\", \"Preview\")}\n                    </DropdownMenuItem>\n                    <DropdownMenuItem onClick={handleDownload}>\n                      <Download className=\"mr-2 h-4 w-4\" />\n                      {t(\"ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰\", \"Download\")}\n                    </DropdownMenuItem>\n                    <DropdownMenuSeparator />\n                  </>\n                )}\n                <DropdownMenuItem\n                  onClick={() => setIsDeleteDialogOpen(true)}\n                  className=\"text-destructive\"\n                >\n                  <Trash2 className=\"mr-2 h-4 w-4\" />\n                  {t(\"å‰Šé™¤\", \"Delete\")}\n                </DropdownMenuItem>\n              </DropdownMenuContent>\n            </DropdownMenu>\n          </div>\n          {result.completedAt && (\n            <p className=\"mt-1 text-muted-foreground text-xs\">\n              {new Date(result.completedAt * 1000).toLocaleString()}\n            </p>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ€ã‚¤ã‚¢ãƒ­ã‚° */}\n      {isPreviewOpen && imageUrl && (\n        <button\n          className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/80\"\n          onClick={() => setIsPreviewOpen(false)}\n          onKeyDown={(e) => e.key === \"Escape\" && setIsPreviewOpen(false)}\n          aria-label=\"Close preview\"\n        >\n          <div className=\"max-h-[90vh] max-w-4xl p-4\">\n            <img\n              src={imageUrl}\n              alt={expressionName}\n              className=\"max-h-full max-w-full object-contain\"\n              onClick={(e) => e.stopPropagation()}\n              onKeyDown={(e) => e.key === \"Enter\" && e.stopPropagation()}\n            />\n          </div>\n        </button>\n      )}\n\n      {/* å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚° */}\n      <AlertDialog\n        open={isDeleteDialogOpen}\n        onOpenChange={setIsDeleteDialogOpen}\n      >\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>\n              {t(\"è¡¨æƒ…ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\", \"Delete Expression?\")}\n            </AlertDialogTitle>\n            <AlertDialogDescription>\n              {t(\n                \"ã“ã®æ“ä½œã¯å…ƒã«æˆ»ã›ã¾ã›ã‚“ã€‚è¡¨æƒ…ã€Œ{expression}ã€ã‚’å®Œå…¨ã«å‰Šé™¤ã—ã¾ã™ã€‚\",\n                'This action cannot be undone. This will permanently delete the expression \"{expression}\".',\n              ).replace(\"{expression}\", expressionName)}\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>{t(\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\", \"Cancel\")}</AlertDialogCancel>\n            <AlertDialogAction onClick={handleDelete}>\n              {t(\"å‰Šé™¤\", \"Delete\")}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </>\n  )\n}\n\nconst deleteImageGenerationResultMutation = DELETE_IMAGE_GENERATION_RESULT\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[1586,1602],"sourceCode":"import {\n  Accordion,\n  AccordionContent,\n  AccordionItem,\n  AccordionTrigger,\n} from \"~/components/ui/accordion\"\nimport { Card } from \"~/components/ui/card\"\nimport { Separator } from \"~/components/ui/separator\"\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"~/components/ui/table\"\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"~/components/ui/tabs\"\nimport { loaderClient } from \"~/lib/loader-client\"\nimport { Link, type MetaFunction, useLoaderData } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport type { LoaderFunctionArgs } from \"react-router-dom\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.MILESTONES, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const resp = await loaderClient.query({\n    query: milestonesQuery,\n    variables: {\n      repository: \"aipictors\",\n    },\n  })\n\n  const milestones = resp.data.milestones\n\n  const appResp = await loaderClient.query({\n    query: milestonesQuery,\n    variables: {\n      repository: \"app\",\n    },\n  })\n\n  const appMilestones = appResp.data.milestones\n\n  return {\n    milestones,\n    appMilestones,\n  }\n}\n\nexport default function Milestone () {\n  const data = useLoaderData<typeof loader>()\n\n  if (data == null) {\n    return null\n  }\n\n  const convertDateFormat = (dateStr: string) => {\n    const dateObj = new Date(dateStr)\n    const year = dateObj.getFullYear()\n    const month = dateObj.getMonth() + 1\n    const day = dateObj.getDate()\n    return `${year}/${month}/${day}`\n  }\n\n  const t = useTranslation()\n\n  return (\n    <>\n      <h1 className=\"font-bold\">{t(\"é–‹ç™ºäºˆå®š\", \"Development Milestones\")}</h1>\n      <Tabs defaultValue=\"web\" className=\"w-full\">\n        <TabsList className=\"mb-4 grid w-full grid-cols-2\">\n          <TabsTrigger value=\"web\">{t(\"Webç‰ˆ\", \"Web Version\")}</TabsTrigger>\n          <TabsTrigger value=\"app\">{t(\"Appç‰ˆ\", \"App Version\")}</TabsTrigger>\n        </TabsList>\n        <TabsContent value=\"web\" className=\"w-full\">\n          <div className=\"flex flex-col gap-y-4\">\n            <Card>\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead className=\"min-w-28\">\n                      {t(\"ãƒãƒ¼ã‚¸ãƒ§ãƒ³\", \"Version\")}\n                    </TableHead>\n                    <TableHead className=\"min-w-64\">\n                      {t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n                    </TableHead>\n                    <TableHead className=\"min-w-80\">\n                      {t(\"é–‹ç™ºå†…å®¹\", \"Development Details\")}\n                    </TableHead>\n                    <TableHead className=\"min-w-16\">\n                      {t(\"å®Œäº†äºˆå®š\", \"Estimated Completion\")}\n                    </TableHead>\n                    <TableHead className=\"min-w-32\">\n                      {t(\"GitHub\", \"GitHub\")}\n                    </TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {data.milestones.map((milestone, _index) => {\n                    return (\n                      <TableRow\n                        key={milestone.id}\n                        className={milestone.isDone ? \"hidden\" : \"\"}\n                      >\n                        <TableCell className=\"font-bold\">\n                          {milestone.version}\n                        </TableCell>\n                        <TableCell>{milestone.title}</TableCell>\n                        <TableCell>{milestone.description}</TableCell>\n                        <TableCell>\n                          {milestone.dueDate\n                            ? convertDateFormat(milestone.dueDate)\n                            : t(\"æœªå®š\", \"TBD\")}\n                        </TableCell>\n                        <TableCell key={`link-${milestone.id}`}>\n                          <Link\n                            key={`link-${milestone.id}`}\n                            to={milestone.pageURL}\n                            target=\"_blank\"\n                          >\n                            {t(\"GitHubã§ç¢ºèª\", \"Check on GitHub\")}\n                          </Link>\n                        </TableCell>\n                      </TableRow>\n                    )\n                  })}\n                </TableBody>\n              </Table>\n            </Card>\n            <div className=\"py-2\">\n              <Separator />\n            </div>\n            <Accordion type=\"single\" collapsible>\n              <AccordionItem value=\"setting\">\n                <AccordionTrigger>\n                  <h2 className=\"font-bold text-sm\">\n                    {t(\"ãƒªãƒªãƒ¼ã‚¹æ¸ˆã¿\", \"Released\")}\n                  </h2>\n                </AccordionTrigger>\n                <AccordionContent className=\"space-y-2\">\n                  <Card>\n                    <Table>\n                      <TableHeader>\n                        <TableRow>\n                          <TableHead className=\"min-w-28\">\n                            {t(\"ãƒãƒ¼ã‚¸ãƒ§ãƒ³\", \"Version\")}\n                          </TableHead>\n                          <TableHead className=\"min-w-64\">\n                            {t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n                          </TableHead>\n                          <TableHead className=\"min-w-80\">\n                            {t(\"é–‹ç™ºå†…å®¹\", \"Development Details\")}\n                          </TableHead>\n                          <TableHead className=\"min-w-32\">\n                            {t(\"GitHub\", \"GitHub\")}\n                          </TableHead>\n                        </TableRow>\n                      </TableHeader>\n                      <TableBody>\n                        {data.milestones.map((milestone) => (\n                          <TableRow\n                            key={milestone.id}\n                            className={!milestone.isDone ? \"hidden\" : \"\"}\n                          >\n                            <TableCell className=\"font-bold\">\n                              {milestone.version}\n                            </TableCell>\n                            <TableCell>{milestone.title}</TableCell>\n                            <TableCell>{milestone.description}</TableCell>\n                            <TableCell>\n                              <Link to={milestone.pageURL} target=\"_blank\">\n                                {t(\"GitHubã§ç¢ºèª\", \"Check on GitHub\")}\n                              </Link>\n                            </TableCell>\n                          </TableRow>\n                        ))}\n                      </TableBody>\n                    </Table>\n                  </Card>\n                </AccordionContent>\n              </AccordionItem>\n            </Accordion>\n          </div>\n        </TabsContent>\n        <TabsContent value=\"app\" className=\"w-full\">\n          <div className=\"flex flex-col gap-y-4\">\n            <div className=\"flex items-center justify-start space-x-8\">\n              <Link to=\"https://apps.apple.com/jp/app/aipictors-ai%E3%83%94%E3%82%AF%E3%82%BF%E3%83%BC%E3%82%BA/id6466581636\">\n                <img\n                  src=\"/apple/download.svg\"\n                  alt={t(\"download\", \"download\")}\n                  className=\"h-12\"\n                />\n              </Link>\n              <Link to=\"https://play.google.com/store/apps/details?id=com.aipictors.app&hl=ja\">\n                <img\n                  src=\"/google/download.png\"\n                  alt={t(\"download\", \"download\")}\n                  className=\"h-16\"\n                />\n              </Link>\n            </div>\n            <Card>\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead className=\"min-w-28\">\n                      {t(\"ãƒãƒ¼ã‚¸ãƒ§ãƒ³\", \"Version\")}\n                    </TableHead>\n                    <TableHead className=\"min-w-64\">\n                      {t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n                    </TableHead>\n                    <TableHead className=\"min-w-80\">\n                      {t(\"é–‹ç™ºå†…å®¹\", \"Development Details\")}\n                    </TableHead>\n                    <TableHead className=\"min-w-16\">\n                      {t(\"å®Œäº†äºˆå®š\", \"Estimated Completion\")}\n                    </TableHead>\n                    <TableHead className=\"min-w-32\">\n                      {t(\"GitHub\", \"GitHub\")}\n                    </TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {data.appMilestones.map((milestone) => (\n                    <TableRow\n                      key={milestone.id}\n                      className={milestone.isDone ? \"hidden\" : \"\"}\n                    >\n                      <TableCell className=\"font-bold\">\n                        {milestone.version}\n                      </TableCell>\n                      <TableCell>{milestone.title}</TableCell>\n                      <TableCell>{milestone.description}</TableCell>\n                      <TableCell>\n                        {milestone.dueDate\n                          ? convertDateFormat(milestone.dueDate)\n                          : t(\"æœªå®š\", \"TBD\")}\n                      </TableCell>\n                      <TableCell>\n                        <Link to={milestone.pageURL} target=\"_blank\">\n                          {t(\"GitHubã§ç¢ºèª\", \"Check on GitHub\")}\n                        </Link>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </Card>\n            <div className=\"py-2\">\n              <Separator />\n            </div>\n            <Accordion type=\"single\" collapsible>\n              <AccordionItem value=\"setting\">\n                <AccordionTrigger>\n                  <h2 className=\"font-bold text-sm\">\n                    {t(\"ãƒªãƒªãƒ¼ã‚¹æ¸ˆã¿\", \"Released\")}\n                  </h2>\n                </AccordionTrigger>\n                <AccordionContent className=\"space-y-2\">\n                  <Card>\n                    <Table>\n                      <TableHeader>\n                        <TableRow>\n                          <TableHead className=\"min-w-28\">\n                            {t(\"ãƒãƒ¼ã‚¸ãƒ§ãƒ³\", \"Version\")}\n                          </TableHead>\n                          <TableHead className=\"min-w-64\">\n                            {t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n                          </TableHead>\n                          <TableHead className=\"min-w-80\">\n                            {t(\"é–‹ç™ºå†…å®¹\", \"Development Details\")}\n                          </TableHead>\n                          <TableHead className=\"min-w-32\">\n                            {t(\"GitHub\", \"GitHub\")}\n                          </TableHead>\n                        </TableRow>\n                      </TableHeader>\n                      <TableBody>\n                        {data.appMilestones.map((milestone) => (\n                          <TableRow\n                            key={milestone.id}\n                            className={!milestone.isDone ? \"hidden\" : \"\"}\n                          >\n                            <TableCell className=\"font-bold\">\n                              {milestone.version}\n                            </TableCell>\n                            <TableCell>{milestone.title}</TableCell>\n                            <TableCell>{milestone.description}</TableCell>\n                            <TableCell>\n                              <Link to={milestone.pageURL} target=\"_blank\">\n                                {t(\"GitHubã§ç¢ºèª\", \"Check on GitHub\")}\n                              </Link>\n                            </TableCell>\n                          </TableRow>\n                        ))}\n                      </TableBody>\n                    </Table>\n                  </Card>\n                </AccordionContent>\n              </AccordionItem>\n            </Accordion>\n          </div>\n        </TabsContent>\n      </Tabs>\n    </>\n  )\n}\n\nconst milestonesQuery = graphql(\n  `query Milestones($repository: String!) {\n    milestones(where: {repository: $repository}) {\n      id\n      title\n      version\n      description\n      pageURL\n      isDone\n      dueDate\n    }\n  }`,\n)\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.milestones/route.tsx"},"span":[1865,1879],"sourceCode":"import {\n  Accordion,\n  AccordionContent,\n  AccordionItem,\n  AccordionTrigger,\n} from \"~/components/ui/accordion\"\nimport { Card } from \"~/components/ui/card\"\nimport { Separator } from \"~/components/ui/separator\"\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"~/components/ui/table\"\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"~/components/ui/tabs\"\nimport { loaderClient } from \"~/lib/loader-client\"\nimport { Link, type MetaFunction, useLoaderData } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport type { LoaderFunctionArgs } from \"react-router-dom\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.MILESTONES, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const resp = await loaderClient.query({\n    query: milestonesQuery,\n    variables: {\n      repository: \"aipictors\",\n    },\n  })\n\n  const milestones = resp.data.milestones\n\n  const appResp = await loaderClient.query({\n    query: milestonesQuery,\n    variables: {\n      repository: \"app\",\n    },\n  })\n\n  const appMilestones = appResp.data.milestones\n\n  return {\n    milestones,\n    appMilestones,\n  }\n}\n\nexport default function Milestone () {\n  const data = useLoaderData<typeof loader>()\n\n  if (data == null) {\n    return null\n  }\n\n  const convertDateFormat = (dateStr: string) => {\n    const dateObj = new Date(dateStr)\n    const year = dateObj.getFullYear()\n    const month = dateObj.getMonth() + 1\n    const day = dateObj.getDate()\n    return `${year}/${month}/${day}`\n  }\n\n  const t = useTranslation()\n\n  return (\n    <>\n      <h1 className=\"font-bold\">{t(\"é–‹ç™ºäºˆå®š\", \"Development Milestones\")}</h1>\n      <Tabs defaultValue=\"web\" className=\"w-full\">\n        <TabsList className=\"mb-4 grid w-full grid-cols-2\">\n          <TabsTrigger value=\"web\">{t(\"Webç‰ˆ\", \"Web Version\")}</TabsTrigger>\n          <TabsTrigger value=\"app\">{t(\"Appç‰ˆ\", \"App Version\")}</TabsTrigger>\n        </TabsList>\n        <TabsContent value=\"web\" className=\"w-full\">\n          <div className=\"flex flex-col gap-y-4\">\n            <Card>\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead className=\"min-w-28\">\n                      {t(\"ãƒãƒ¼ã‚¸ãƒ§ãƒ³\", \"Version\")}\n                    </TableHead>\n                    <TableHead className=\"min-w-64\">\n                      {t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n                    </TableHead>\n                    <TableHead className=\"min-w-80\">\n                      {t(\"é–‹ç™ºå†…å®¹\", \"Development Details\")}\n                    </TableHead>\n                    <TableHead className=\"min-w-16\">\n                      {t(\"å®Œäº†äºˆå®š\", \"Estimated Completion\")}\n                    </TableHead>\n                    <TableHead className=\"min-w-32\">\n                      {t(\"GitHub\", \"GitHub\")}\n                    </TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {data.milestones.map((milestone, _index) => {\n                    return (\n                      <TableRow\n                        key={milestone.id}\n                        className={milestone.isDone ? \"hidden\" : \"\"}\n                      >\n                        <TableCell className=\"font-bold\">\n                          {milestone.version}\n                        </TableCell>\n                        <TableCell>{milestone.title}</TableCell>\n                        <TableCell>{milestone.description}</TableCell>\n                        <TableCell>\n                          {milestone.dueDate\n                            ? convertDateFormat(milestone.dueDate)\n                            : t(\"æœªå®š\", \"TBD\")}\n                        </TableCell>\n                        <TableCell key={`link-${milestone.id}`}>\n                          <Link\n                            key={`link-${milestone.id}`}\n                            to={milestone.pageURL}\n                            target=\"_blank\"\n                          >\n                            {t(\"GitHubã§ç¢ºèª\", \"Check on GitHub\")}\n                          </Link>\n                        </TableCell>\n                      </TableRow>\n                    )\n                  })}\n                </TableBody>\n              </Table>\n            </Card>\n            <div className=\"py-2\">\n              <Separator />\n            </div>\n            <Accordion type=\"single\" collapsible>\n              <AccordionItem value=\"setting\">\n                <AccordionTrigger>\n                  <h2 className=\"font-bold text-sm\">\n                    {t(\"ãƒªãƒªãƒ¼ã‚¹æ¸ˆã¿\", \"Released\")}\n                  </h2>\n                </AccordionTrigger>\n                <AccordionContent className=\"space-y-2\">\n                  <Card>\n                    <Table>\n                      <TableHeader>\n                        <TableRow>\n                          <TableHead className=\"min-w-28\">\n                            {t(\"ãƒãƒ¼ã‚¸ãƒ§ãƒ³\", \"Version\")}\n                          </TableHead>\n                          <TableHead className=\"min-w-64\">\n                            {t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n                          </TableHead>\n                          <TableHead className=\"min-w-80\">\n                            {t(\"é–‹ç™ºå†…å®¹\", \"Development Details\")}\n                          </TableHead>\n                          <TableHead className=\"min-w-32\">\n                            {t(\"GitHub\", \"GitHub\")}\n                          </TableHead>\n                        </TableRow>\n                      </TableHeader>\n                      <TableBody>\n                        {data.milestones.map((milestone) => (\n                          <TableRow\n                            key={milestone.id}\n                            className={!milestone.isDone ? \"hidden\" : \"\"}\n                          >\n                            <TableCell className=\"font-bold\">\n                              {milestone.version}\n                            </TableCell>\n                            <TableCell>{milestone.title}</TableCell>\n                            <TableCell>{milestone.description}</TableCell>\n                            <TableCell>\n                              <Link to={milestone.pageURL} target=\"_blank\">\n                                {t(\"GitHubã§ç¢ºèª\", \"Check on GitHub\")}\n                              </Link>\n                            </TableCell>\n                          </TableRow>\n                        ))}\n                      </TableBody>\n                    </Table>\n                  </Card>\n                </AccordionContent>\n              </AccordionItem>\n            </Accordion>\n          </div>\n        </TabsContent>\n        <TabsContent value=\"app\" className=\"w-full\">\n          <div className=\"flex flex-col gap-y-4\">\n            <div className=\"flex items-center justify-start space-x-8\">\n              <Link to=\"https://apps.apple.com/jp/app/aipictors-ai%E3%83%94%E3%82%AF%E3%82%BF%E3%83%BC%E3%82%BA/id6466581636\">\n                <img\n                  src=\"/apple/download.svg\"\n                  alt={t(\"download\", \"download\")}\n                  className=\"h-12\"\n                />\n              </Link>\n              <Link to=\"https://play.google.com/store/apps/details?id=com.aipictors.app&hl=ja\">\n                <img\n                  src=\"/google/download.png\"\n                  alt={t(\"download\", \"download\")}\n                  className=\"h-16\"\n                />\n              </Link>\n            </div>\n            <Card>\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead className=\"min-w-28\">\n                      {t(\"ãƒãƒ¼ã‚¸ãƒ§ãƒ³\", \"Version\")}\n                    </TableHead>\n                    <TableHead className=\"min-w-64\">\n                      {t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n                    </TableHead>\n                    <TableHead className=\"min-w-80\">\n                      {t(\"é–‹ç™ºå†…å®¹\", \"Development Details\")}\n                    </TableHead>\n                    <TableHead className=\"min-w-16\">\n                      {t(\"å®Œäº†äºˆå®š\", \"Estimated Completion\")}\n                    </TableHead>\n                    <TableHead className=\"min-w-32\">\n                      {t(\"GitHub\", \"GitHub\")}\n                    </TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {data.appMilestones.map((milestone) => (\n                    <TableRow\n                      key={milestone.id}\n                      className={milestone.isDone ? \"hidden\" : \"\"}\n                    >\n                      <TableCell className=\"font-bold\">\n                        {milestone.version}\n                      </TableCell>\n                      <TableCell>{milestone.title}</TableCell>\n                      <TableCell>{milestone.description}</TableCell>\n                      <TableCell>\n                        {milestone.dueDate\n                          ? convertDateFormat(milestone.dueDate)\n                          : t(\"æœªå®š\", \"TBD\")}\n                      </TableCell>\n                      <TableCell>\n                        <Link to={milestone.pageURL} target=\"_blank\">\n                          {t(\"GitHubã§ç¢ºèª\", \"Check on GitHub\")}\n                        </Link>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </Card>\n            <div className=\"py-2\">\n              <Separator />\n            </div>\n            <Accordion type=\"single\" collapsible>\n              <AccordionItem value=\"setting\">\n                <AccordionTrigger>\n                  <h2 className=\"font-bold text-sm\">\n                    {t(\"ãƒªãƒªãƒ¼ã‚¹æ¸ˆã¿\", \"Released\")}\n                  </h2>\n                </AccordionTrigger>\n                <AccordionContent className=\"space-y-2\">\n                  <Card>\n                    <Table>\n                      <TableHeader>\n                        <TableRow>\n                          <TableHead className=\"min-w-28\">\n                            {t(\"ãƒãƒ¼ã‚¸ãƒ§ãƒ³\", \"Version\")}\n                          </TableHead>\n                          <TableHead className=\"min-w-64\">\n                            {t(\"ã‚¿ã‚¤ãƒˆãƒ«\", \"Title\")}\n                          </TableHead>\n                          <TableHead className=\"min-w-80\">\n                            {t(\"é–‹ç™ºå†…å®¹\", \"Development Details\")}\n                          </TableHead>\n                          <TableHead className=\"min-w-32\">\n                            {t(\"GitHub\", \"GitHub\")}\n                          </TableHead>\n                        </TableRow>\n                      </TableHeader>\n                      <TableBody>\n                        {data.appMilestones.map((milestone) => (\n                          <TableRow\n                            key={milestone.id}\n                            className={!milestone.isDone ? \"hidden\" : \"\"}\n                          >\n                            <TableCell className=\"font-bold\">\n                              {milestone.version}\n                            </TableCell>\n                            <TableCell>{milestone.title}</TableCell>\n                            <TableCell>{milestone.description}</TableCell>\n                            <TableCell>\n                              <Link to={milestone.pageURL} target=\"_blank\">\n                                {t(\"GitHubã§ç¢ºèª\", \"Check on GitHub\")}\n                              </Link>\n                            </TableCell>\n                          </TableRow>\n                        ))}\n                      </TableBody>\n                    </Table>\n                  </Card>\n                </AccordionContent>\n              </AccordionItem>\n            </Accordion>\n          </div>\n        </TabsContent>\n      </Tabs>\n    </>\n  )\n}\n\nconst milestonesQuery = graphql(\n  `query Milestones($repository: String!) {\n    milestones(where: {repository: $repository}) {\n      id\n      title\n      version\n      description\n      pageURL\n      isDone\n      dueDate\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/ogp-dialog.tsx"},"span":[1545,1987],"sourceCode":"import { useEffect, useState } from \"react\"\nimport { ImageCropperModal } from \"~/components/modal-image-cropper\"\n\ntype Props = {\n  imageBase64: string\n  setResultImage: (image: string) => void\n  children: React.ReactNode\n}\n\nexport function OgpDialog (props: Props) {\n  const [isOpen, setIsOpen] = useState<boolean>(false)\n\n  const [cropDimensions, setCropDimensions] = useState<{\n    width: number\n    height: number\n  }>({ width: 0, height: 0 })\n\n  useEffect(() => {\n    const img = new Image()\n    img.src = props.imageBase64\n    img.onload = () => {\n      const aspectRatio = 1.91\n      const imageWidth = img.width\n      const imageHeight = img.height\n\n      let cropWidth = imageWidth\n      let cropHeight = cropWidth / aspectRatio\n\n      if (cropHeight > imageHeight) {\n        cropHeight = imageHeight\n        cropWidth = cropHeight * aspectRatio\n      }\n\n      setCropDimensions({ width: cropWidth, height: cropHeight })\n    }\n  }, [props.imageBase64])\n\n  const onClose = () => {\n    setIsOpen(false)\n  }\n\n  const onCrop = (croppedImage: string) => {\n    props.setResultImage(croppedImage)\n    onClose()\n  }\n\n  const cropperClassName = \"react-easy-crop-container\"\n\n  return (\n    <>\n      <ImageCropperModal\n        src={props.imageBase64}\n        isOpen={isOpen}\n        cropContainerClassName={cropperClassName}\n        cropWidth={cropDimensions.width}\n        cropHeight={cropDimensions.height}\n        onCrop={onCrop}\n        onClose={onClose}\n      />\n      {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n      <div\n        onClick={() => {\n          setIsOpen(true)\n          setTimeout(() => {\n            const element = document.querySelector(`.${cropperClassName}`)\n            if (element) {\n              setTimeout(() => {\n                element.classList.remove(\"mt-1\")\n              }, 100)\n              setTimeout(() => {\n                element.classList.add(\"mt-1\")\n              }, 200)\n            }\n          }, 500)\n        }}\n      >\n        {props.children}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images-and-video.tsx"},"span":[10856,11308],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { VideoItem } from \"~/routes/($lang)._main.new.image/components/video-item\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport {\n  MAX_IMAGE_FILE_SIZE_BYTES,\n  MAX_VIDEO_FILE_SIZE_BYTES,\n  formatFileSize,\n} from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  videoFile: File | null\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onVideoChange(videoFile: File | null): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImagesAndVideo (props: Props) {\n  const t = useTranslation()\n\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(MAX_IMAGE_FILE_SIZE_BYTES)\n  const videoSizeLabel = formatFileSize(MAX_VIDEO_FILE_SIZE_BYTES)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    // é•ã„ãŒã‚ã£ãŸã‚‰ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n      \"video/mp4\": [\".mp4\", \".MP4\", \".Mp4\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Up to ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (file.type === \"video/mp4\") {\n          if (file.size > MAX_VIDEO_FILE_SIZE_BYTES) {\n            toast(\n              t(\n                `å‹•ç”»ã®ã‚µã‚¤ã‚ºã¯${videoSizeLabel}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„`,\n                `Video size should be under ${videoSizeLabel}`,\n              ),\n            )\n            return\n          }\n          const video = document.createElement(\"video\")\n\n          video.src = URL.createObjectURL(file)\n          video.onloadedmetadata = () => {\n            if (video.duration > 12) {\n              toast(\n                t(\n                  \"å‹•ç”»ã¯12ç§’ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„\",\n                  \"Video length should be under 12 seconds\",\n                ),\n              )\n              return\n            }\n\n            props.onVideoChange(file)\n\n            props.setItems([])\n            props.onChangeItems([])\n\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = video.videoWidth\n            canvas.height = video.videoHeight\n            const ctx = canvas.getContext(\"2d\")\n\n            const time = video.duration / 2\n            video.currentTime = time\n            video.onseeked = () => {\n              ctx?.drawImage(video, 0, 0, canvas.width, canvas.height)\n              const thumbnailUrl = canvas.toDataURL()\n\n              updateThumbnail(thumbnailUrl)\n            }\n          }\n        } else {\n          if (\n            props.maxItemsCount &&\n            props.maxItemsCount < props.items.length + 1\n          ) {\n            toast(\n              t(\n                `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n                `Up to ${props.maxItemsCount} items allowed`,\n              ),\n            )\n            return\n          }\n\n          props.onVideoChange(null)\n\n          if (props.items.length === 0 && file.type === \"image/png\") {\n            const pngInfo = await getExtractInfoFromPNG(file)\n            if (props.onChangePngInfo) {\n              props.onChangePngInfo(pngInfo)\n            }\n          }\n\n          const reader = new FileReader()\n          reader.onload = (event) => {\n            if (event.target) {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = event.target.result as string\n            }\n          }\n          reader.readAsDataURL(file)\n        }\n      })\n\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n            </div>\n          </>\n        )}\n        {props.videoFile && (\n          <VideoItem\n            videoFile={props.videoFile}\n            onDelete={() => {\n              if (!props.isOnlyMove) {\n                props.onVideoChange(null)\n                props.onChangeItems([])\n                if (props.onChangeIndexList) {\n                  props.onChangeIndexList([])\n                }\n              }\n            }}\n          />\n        )}\n\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col text-white\">\n            <p className=\"text-center text-sm\">\n              {t(\n                \"JPEGã€PNGã€GIFã€WEBPã€BMPã€MP4\",\n                \"JPEG, PNG, GIF, WEBP, BMP, MP4\",\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æšã€å‹•ç”»ã¯${videoSizeLabel}ã€12ç§’ã¾ã§`,\n                `Max ${maxSizeLabel} per file, up to 200 files, videos under ${videoSizeLabel} and 12 seconds`,\n              )}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images-and-video.tsx"},"span":[9000,9442],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { VideoItem } from \"~/routes/($lang)._main.new.image/components/video-item\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport {\n  MAX_IMAGE_FILE_SIZE_BYTES,\n  MAX_VIDEO_FILE_SIZE_BYTES,\n  formatFileSize,\n} from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  videoFile: File | null\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onVideoChange(videoFile: File | null): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImagesAndVideo (props: Props) {\n  const t = useTranslation()\n\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(MAX_IMAGE_FILE_SIZE_BYTES)\n  const videoSizeLabel = formatFileSize(MAX_VIDEO_FILE_SIZE_BYTES)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    // é•ã„ãŒã‚ã£ãŸã‚‰ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    // å…ˆé ­ã®è¦ç´ ã‚’ä¸¦ã³æ›¿ãˆã—ãŸå ´åˆã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’0ç•ªç›®ã®ç”»åƒãŒå­˜åœ¨ã—ãŸã‚‰ãã®ç”»åƒã«è¨­å®šã™ã‚‹\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n      \"video/mp4\": [\".mp4\", \".MP4\", \".Mp4\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Up to ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (file.type === \"video/mp4\") {\n          if (file.size > MAX_VIDEO_FILE_SIZE_BYTES) {\n            toast(\n              t(\n                `å‹•ç”»ã®ã‚µã‚¤ã‚ºã¯${videoSizeLabel}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„`,\n                `Video size should be under ${videoSizeLabel}`,\n              ),\n            )\n            return\n          }\n          const video = document.createElement(\"video\")\n\n          video.src = URL.createObjectURL(file)\n          video.onloadedmetadata = () => {\n            if (video.duration > 12) {\n              toast(\n                t(\n                  \"å‹•ç”»ã¯12ç§’ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„\",\n                  \"Video length should be under 12 seconds\",\n                ),\n              )\n              return\n            }\n\n            props.onVideoChange(file)\n\n            props.setItems([])\n            props.onChangeItems([])\n\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = video.videoWidth\n            canvas.height = video.videoHeight\n            const ctx = canvas.getContext(\"2d\")\n\n            const time = video.duration / 2\n            video.currentTime = time\n            video.onseeked = () => {\n              ctx?.drawImage(video, 0, 0, canvas.width, canvas.height)\n              const thumbnailUrl = canvas.toDataURL()\n\n              updateThumbnail(thumbnailUrl)\n            }\n          }\n        } else {\n          if (\n            props.maxItemsCount &&\n            props.maxItemsCount < props.items.length + 1\n          ) {\n            toast(\n              t(\n                `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n                `Up to ${props.maxItemsCount} items allowed`,\n              ),\n            )\n            return\n          }\n\n          props.onVideoChange(null)\n\n          if (props.items.length === 0 && file.type === \"image/png\") {\n            const pngInfo = await getExtractInfoFromPNG(file)\n            if (props.onChangePngInfo) {\n              props.onChangePngInfo(pngInfo)\n            }\n          }\n\n          const reader = new FileReader()\n          reader.onload = (event) => {\n            if (event.target) {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = event.target.result as string\n            }\n          }\n          reader.readAsDataURL(file)\n        }\n      })\n\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n            </div>\n          </>\n        )}\n        {props.videoFile && (\n          <VideoItem\n            videoFile={props.videoFile}\n            onDelete={() => {\n              if (!props.isOnlyMove) {\n                props.onVideoChange(null)\n                props.onChangeItems([])\n                if (props.onChangeIndexList) {\n                  props.onChangeIndexList([])\n                }\n              }\n            }}\n          />\n        )}\n\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col text-white\">\n            <p className=\"text-center text-sm\">\n              {t(\n                \"JPEGã€PNGã€GIFã€WEBPã€BMPã€MP4\",\n                \"JPEG, PNG, GIF, WEBP, BMP, MP4\",\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æšã€å‹•ç”»ã¯${videoSizeLabel}ã€12ç§’ã¾ã§`,\n                `Max ${maxSizeLabel} per file, up to 200 files, videos under ${videoSizeLabel} and 12 seconds`,\n              )}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images.tsx"},"span":[8989,9431],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { MAX_IMAGE_FILE_SIZE_BYTES, formatFileSize } from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n  onInputFiles?: (files: FileList) => void\n  submitText?: string\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImages (props: Props) {\n  const t = useTranslation()\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(maxSize)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰ç”»åƒè²¼ã‚Šä»˜ã‘ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹\n   */\n  useEffect(() => {\n    const handlePaste = async (event: ClipboardEvent) => {\n      const activeElement = document.activeElement\n      if (\n        activeElement &&\n        (activeElement.tagName === \"INPUT\" ||\n          activeElement.tagName === \"TEXTAREA\")\n      ) {\n        return\n      }\n\n      if (props.isOnlyMove) return\n\n      const items = event.clipboardData?.items\n      if (!items) return\n\n      for (const item of items) {\n        if (item.type.startsWith(\"image\")) {\n          const file = item.getAsFile()\n          if (file && file.size <= maxSize) {\n            const reader = new FileReader()\n            reader.onload = (e) => {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = e.target?.result as string\n            }\n            reader.readAsDataURL(file)\n            toast(\"ç”»åƒã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã¾ã—ãŸ\")\n          } else {\n            toast(\n              t(\n                `${maxSizeLabel}ä»¥å†…ã®ç”»åƒã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„`,\n                `Please paste an image under ${maxSizeLabel}`,\n              ),\n            )\n          }\n        }\n      }\n    }\n\n    document.addEventListener(\"paste\", handlePaste)\n    return () => {\n      document.removeEventListener(\"paste\", handlePaste)\n    }\n  }, [])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Maximum ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (\n          props.maxItemsCount &&\n          props.maxItemsCount < props.items.length + 1\n        ) {\n          toast(\n            t(\n              `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n              `Maximum ${props.maxItemsCount} items allowed`,\n            ),\n          )\n          return\n        }\n\n        if (props.items.length === 0 && file.type === \"image/png\") {\n          const pngInfo = await getExtractInfoFromPNG(file)\n          if (props.onChangePngInfo) {\n            props.onChangePngInfo(pngInfo)\n          }\n        }\n\n        const reader = new FileReader()\n        reader.onload = (event) => {\n          if (event.target) {\n            const img = new Image()\n            img.onload = () => {\n              const canvas = document.createElement(\"canvas\")\n              canvas.width = img.width\n              canvas.height = img.height\n              const ctx = canvas.getContext(\"2d\")\n              ctx?.drawImage(img, 0, 0)\n              const webpDataURL = canvas.toDataURL(\"image/webp\")\n              props.items.push({\n                id: props.items.length,\n                content: webpDataURL,\n              })\n              props.onChangeItems([...props.items])\n              updateThumbnail()\n            }\n            img.src = event.target.result as string\n          }\n        }\n        reader.readAsDataURL(file)\n      })\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n\n        if (props.onInputFiles) {\n          props.onInputFiles(inputElement.files)\n        }\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n          props.items.length ? \"\" : \"rounded-b\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              {props.submitText ? (\n                <p className=\"font-bold\">{props.submitText}</p>\n              ) : (\n                <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n              )}\n            </div>\n          </>\n        )}\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            props.items.length !== props.maxItemsCount &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col rounded-b text-white\">\n            <p className=\"text-center text-sm\">{\"JPEGã€PNGã€GIFã€WEBPã€BMP\"}</p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æš`,\n                `Up to ${maxSizeLabel} per image, max 200 images`,\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {\"ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã‚‚å¯èƒ½\"}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-draggable-images.tsx"},"span":[10633,11085],"sourceCode":"import type { TSortableItem } from \"~/components/drag/sortable-item\"\nimport { SortableItems } from \"~/components/drag/sortable-items\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport {\n  getExtractInfoFromPNG,\n  type PNGInfo,\n} from \"~/utils/get-extract-info-from-png\"\nimport { PencilLineIcon, PlusIcon } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { MAX_IMAGE_FILE_SIZE_BYTES, formatFileSize } from \"~/utils/file-size\"\n\ntype Props = {\n  indexList: number[]\n  items: TSortableItem[]\n  isOnlyMove?: boolean\n  maxItemsCount?: number\n  setItems(items: TSortableItem[]): void\n  setIndexList(value: number[]): void\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onChangePngInfo?(pngInfo: PNGInfo): void\n  onMosaicButtonClick?(content: string): void\n  onChangeItems(items: TSortableItem[]): void\n  onChangeIndexList?(indexList: number[]): void\n  onInputFiles?: (files: FileList) => void\n  submitText?: string\n}\n\n/**\n * ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªè¤‡æ•°ç”»åƒé¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemDraggableImages (props: Props) {\n  const t = useTranslation()\n  // å…ˆé ­ã®ç”»åƒ\n  const [nowHeadImageBase64, setNowHeadImageBase64] = useState(\"\")\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_IMAGE_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(maxSize)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é¸æŠä¸­ã®ç”»åƒä¸€è¦§ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã¯ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   */\n  useEffect(() => {\n    if (props.items.length) {\n      if (\n        props.items[0].content &&\n        props.items[0].content !== nowHeadImageBase64\n      ) {\n        updateThumbnail()\n        setNowHeadImageBase64(props.items[0].content)\n      }\n    } else {\n      updateThumbnail()\n      setNowHeadImageBase64(\"\")\n    }\n    if (props.items.length === 0) {\n      if (props.setOgpBase64) {\n        props.setOgpBase64(null)\n      }\n      if (props.setIsThumbnailLandscape) {\n        props.setIsThumbnailLandscape(false)\n      }\n      if (props.setThumbnailBase64) {\n        props.setThumbnailBase64(null)\n      }\n    }\n  }, [props.items])\n\n  /**\n   * ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰ç”»åƒè²¼ã‚Šä»˜ã‘ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹\n   */\n  useEffect(() => {\n    const handlePaste = async (event: ClipboardEvent) => {\n      const activeElement = document.activeElement\n      if (\n        activeElement &&\n        (activeElement.tagName === \"INPUT\" ||\n          activeElement.tagName === \"TEXTAREA\")\n      ) {\n        return\n      }\n\n      if (props.isOnlyMove) return\n\n      const items = event.clipboardData?.items\n      if (!items) return\n\n      for (const item of items) {\n        if (item.type.startsWith(\"image\")) {\n          const file = item.getAsFile()\n          if (file && file.size <= maxSize) {\n            const reader = new FileReader()\n            reader.onload = (e) => {\n              const img = new Image()\n              img.onload = () => {\n                const canvas = document.createElement(\"canvas\")\n                canvas.width = img.width\n                canvas.height = img.height\n                const ctx = canvas.getContext(\"2d\")\n                ctx?.drawImage(img, 0, 0)\n                const webpDataURL = canvas.toDataURL(\"image/webp\")\n                props.items.push({\n                  id: props.items.length,\n                  content: webpDataURL,\n                })\n                props.onChangeItems([...props.items])\n                updateThumbnail()\n              }\n              img.src = e.target?.result as string\n            }\n            reader.readAsDataURL(file)\n            toast(\"ç”»åƒã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã¾ã—ãŸ\")\n          } else {\n            toast(\n              t(\n                `${maxSizeLabel}ä»¥å†…ã®ç”»åƒã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„`,\n                `Please paste an image under ${maxSizeLabel}`,\n              ),\n            )\n          }\n        }\n      }\n    }\n\n    document.addEventListener(\"paste\", handlePaste)\n    return () => {\n      document.removeEventListener(\"paste\", handlePaste)\n    }\n  }, [])\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    if (props.setThumbnailBase64) {\n      if (\n        !webpDataURL &&\n        props.items &&\n        props.items.length > 0 &&\n        props.items[0].content\n      ) {\n        props.setThumbnailBase64(props.items[0].content)\n      } else {\n        props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n      }\n    }\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if ((props.items && props.items.length > 0) || webpDataURL) {\n        const base64 = webpDataURL ? webpDataURL : props.items[0].content\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"image/jpeg\": [\".jpeg\", \".jpg\"],\n      \"image/png\": [\".png\"],\n      \"image/gif\": [\".gif\"],\n      \"image/webp\": [\".webp\"],\n      \"image/bmp\": [\".bmp\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      if (props.isOnlyMove) {\n        return\n      }\n\n      if (props.maxItemsCount && props.maxItemsCount < acceptedFiles.length) {\n        toast(\n          t(\n            `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n            `Maximum ${props.maxItemsCount} items allowed`,\n          ),\n        )\n        return\n      }\n\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (\n          props.maxItemsCount &&\n          props.maxItemsCount < props.items.length + 1\n        ) {\n          toast(\n            t(\n              `æœ€å¤§${props.maxItemsCount}ã¾ã§ã§ã™`,\n              `Maximum ${props.maxItemsCount} items allowed`,\n            ),\n          )\n          return\n        }\n\n        if (props.items.length === 0 && file.type === \"image/png\") {\n          const pngInfo = await getExtractInfoFromPNG(file)\n          if (props.onChangePngInfo) {\n            props.onChangePngInfo(pngInfo)\n          }\n        }\n\n        const reader = new FileReader()\n        reader.onload = (event) => {\n          if (event.target) {\n            const img = new Image()\n            img.onload = () => {\n              const canvas = document.createElement(\"canvas\")\n              canvas.width = img.width\n              canvas.height = img.height\n              const ctx = canvas.getContext(\"2d\")\n              ctx?.drawImage(img, 0, 0)\n              const webpDataURL = canvas.toDataURL(\"image/webp\")\n              props.items.push({\n                id: props.items.length,\n                content: webpDataURL,\n              })\n              props.onChangeItems([...props.items])\n              updateThumbnail()\n            }\n            img.src = event.target.result as string\n          }\n        }\n        reader.readAsDataURL(file)\n      })\n      const inputElement = document.getElementById(\n        \"images_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n\n        if (props.onInputFiles) {\n          props.onInputFiles(inputElement.files)\n        }\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n    disabled: props.isOnlyMove,\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n          props.items.length ? \"\" : \"rounded-b\",\n        )}\n      >\n        {!props.isOnlyMove && <input id=\"images_input\" {...getInputProps()} />}\n        {props.items.length === 0 && !props.isOnlyMove && (\n          <>\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"images_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              {props.submitText ? (\n                <p className=\"font-bold\">{props.submitText}</p>\n              ) : (\n                <p className=\"font-bold\">{t(\"ç”»åƒã‚’è¿½åŠ \", \"Add Image\")}</p>\n              )}\n            </div>\n          </>\n        )}\n        <SortableItems\n          items={props.items}\n          isDeletable={!props.isOnlyMove}\n          setItems={props.setItems}\n          setIndexList={props.setIndexList}\n          optionalButton={\n            <Button\n              className=\"absolute bottom-2 left-2 size-6 md:h-8 md:w-8\"\n              size={\"icon\"}\n              onClick={() => {}}\n            >\n              <PencilLineIcon className=\"size-4 md:h-6 md:w-6\" />\n            </Button>\n          }\n          onClickOptionButton={(index) => {\n            if (props.onMosaicButtonClick && props.items[index].content) {\n              props.onMosaicButtonClick(props.items[index].content)\n            }\n          }}\n          dummyEnableDragItem={\n            props.items.length !== 0 &&\n            props.items.length !== props.maxItemsCount &&\n            !props.isOnlyMove && (\n              // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n              <div\n                onClick={() => {\n                  const inputElement = document.getElementById(\n                    \"images_input\",\n                  ) as HTMLInputElement\n                  if (inputElement) {\n                    inputElement.click()\n                  }\n                }}\n                className=\"flex size-32 cursor-pointer items-center justify-center rounded-md bg-zinc-600 hover:opacity-80 dark:bg-zinc-700\"\n              >\n                <PlusIcon className=\"size-12\" />\n              </div>\n            )\n          }\n        />\n        {!props.items.length && (\n          <div className=\"m-4 flex flex-col rounded-b text-white\">\n            <p className=\"text-center text-sm\">{\"JPEGã€PNGã€GIFã€WEBPã€BMP\"}</p>\n            <p className=\"text-center text-sm\">\n              {t(\n                `1æš${maxSizeLabel}ä»¥å†…ã€æœ€å¤§200æš`,\n                `Up to ${maxSizeLabel} per image, max 200 images`,\n              )}\n            </p>\n            <p className=\"text-center text-sm\">\n              {\"ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰è²¼ã‚Šä»˜ã‘ã‚‚å¯èƒ½\"}\n            </p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[717,733],"sourceCode":"import type { Tag } from \"~/components/tag/tag-input\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { Link } from \"@remix-run/react\"\nimport { useEffect, useState } from \"react\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { getJstDate } from \"~/utils/jst-date\"\n\ntype Props = {\n  eventName: string | null\n  eventDescription: string | null\n  eventTag: string | null\n  endAt: number\n  slug: string | null\n  removeTag: (tag: Tag) => void\n  addTag: (tag: Tag) => void\n  isAttending?: boolean\n}\n\n/**\n * ã‚¤ãƒ™ãƒ³ãƒˆå…¥åŠ›\n */\nexport function PostFormItemEvent (props: Props) {\n  const now = getJstDate(new Date())\n\n  const isOngoing = now <= new Date(props.endAt * 1000)\n\n  if (!isOngoing) {\n    return null\n  }\n\n  const [isAttending, setIsAttending] = useState(\n    props.isAttending === undefined ? false : props.isAttending,\n  )\n\n  const handleAttendanceChange = (isChecked: boolean) => {\n    setIsAttending(isChecked)\n    if (props.eventTag) {\n      if (isChecked) {\n        props.addTag({\n          id: props.eventTag,\n          text: props.eventTag,\n        })\n        return\n      }\n      props.removeTag({\n        id: props.eventTag,\n        text: props.eventTag,\n      })\n    }\n  }\n\n  useEffect(() => {\n    setIsAttending(props.isAttending === undefined ? false : props.isAttending)\n  }, [props.isAttending])\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-2 p-4\">\n        <div className=\"flex items-center\">\n          <Checkbox\n            checked={isAttending}\n            onCheckedChange={handleAttendanceChange}\n            id=\"attend-checkbox\"\n          />\n          <label htmlFor=\"attend-checkbox\" className=\"ml-2 font-medium text-sm\">\n            å‚åŠ ã™ã‚‹\n          </label>\n        </div>\n        {/* ã‚¤ãƒ™ãƒ³ãƒˆåã¨èª¬æ˜ã‚’è¡¨ç¤º */}\n        <Link\n          className=\"block\"\n          to={`https://www.aipictors.com/events/${props.slug}`}\n          target=\"_blank\"\n        >\n          <Card>\n            <CardContent className=\"space-y-2 p-4\">\n              <h3 className=\"font-medium text-sm\">{props.eventName}</h3>\n              {props.eventDescription !== null && (\n                <div\n                  className=\"font-medium text-xs\"\n                  // biome-ignore lint/security/noDangerouslySetInnerHtml: <explanation>\n                  dangerouslySetInnerHTML={{ __html: props.eventDescription }}\n                />\n              )}\n            </CardContent>\n          </Card>\n        </Link>\n      </CardContent>\n    </Card>\n  )\n}\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-event.tsx"},"span":[779,787],"sourceCode":"import type { Tag } from \"~/components/tag/tag-input\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { Link } from \"@remix-run/react\"\nimport { useEffect, useState } from \"react\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { getJstDate } from \"~/utils/jst-date\"\n\ntype Props = {\n  eventName: string | null\n  eventDescription: string | null\n  eventTag: string | null\n  endAt: number\n  slug: string | null\n  removeTag: (tag: Tag) => void\n  addTag: (tag: Tag) => void\n  isAttending?: boolean\n}\n\n/**\n * ã‚¤ãƒ™ãƒ³ãƒˆå…¥åŠ›\n */\nexport function PostFormItemEvent (props: Props) {\n  const now = getJstDate(new Date())\n\n  const isOngoing = now <= new Date(props.endAt * 1000)\n\n  if (!isOngoing) {\n    return null\n  }\n\n  const [isAttending, setIsAttending] = useState(\n    props.isAttending === undefined ? false : props.isAttending,\n  )\n\n  const handleAttendanceChange = (isChecked: boolean) => {\n    setIsAttending(isChecked)\n    if (props.eventTag) {\n      if (isChecked) {\n        props.addTag({\n          id: props.eventTag,\n          text: props.eventTag,\n        })\n        return\n      }\n      props.removeTag({\n        id: props.eventTag,\n        text: props.eventTag,\n      })\n    }\n  }\n\n  useEffect(() => {\n    setIsAttending(props.isAttending === undefined ? false : props.isAttending)\n  }, [props.isAttending])\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-2 p-4\">\n        <div className=\"flex items-center\">\n          <Checkbox\n            checked={isAttending}\n            onCheckedChange={handleAttendanceChange}\n            id=\"attend-checkbox\"\n          />\n          <label htmlFor=\"attend-checkbox\" className=\"ml-2 font-medium text-sm\">\n            å‚åŠ ã™ã‚‹\n          </label>\n        </div>\n        {/* ã‚¤ãƒ™ãƒ³ãƒˆåã¨èª¬æ˜ã‚’è¡¨ç¤º */}\n        <Link\n          className=\"block\"\n          to={`https://www.aipictors.com/events/${props.slug}`}\n          target=\"_blank\"\n        >\n          <Card>\n            <CardContent className=\"space-y-2 p-4\">\n              <h3 className=\"font-medium text-sm\">{props.eventName}</h3>\n              {props.eventDescription !== null && (\n                <div\n                  className=\"font-medium text-xs\"\n                  // biome-ignore lint/security/noDangerouslySetInnerHtml: <explanation>\n                  dangerouslySetInnerHTML={{ __html: props.eventDescription }}\n                />\n              )}\n            </CardContent>\n          </Card>\n        </Link>\n      </CardContent>\n    </Card>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[717,733],"sourceCode":"import type { Tag } from \"~/components/tag/tag-input\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { Link } from \"@remix-run/react\"\nimport { useEffect, useState } from \"react\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { getJstDate } from \"~/utils/jst-date\"\n\ntype Props = {\n  eventName: string | null\n  eventDescription: string | null\n  eventTag: string | null\n  endAt: number\n  slug: string | null\n  removeTag: (tag: Tag) => void\n  addTag: (tag: Tag) => void\n  isAttending?: boolean\n}\n\n/**\n * ã‚¤ãƒ™ãƒ³ãƒˆå…¥åŠ›\n */\nexport function PostFormItemEvent (props: Props) {\n  const now = getJstDate(new Date())\n\n  const isOngoing = now <= new Date(props.endAt * 1000)\n\n  if (!isOngoing) {\n    return null\n  }\n\n  const [isAttending, setIsAttending] = useState(\n    props.isAttending === undefined ? false : props.isAttending,\n  )\n\n  const handleAttendanceChange = (isChecked: boolean) => {\n    setIsAttending(isChecked)\n    if (props.eventTag) {\n      if (isChecked) {\n        props.addTag({\n          id: props.eventTag,\n          text: props.eventTag,\n        })\n        return\n      }\n      props.removeTag({\n        id: props.eventTag,\n        text: props.eventTag,\n      })\n    }\n  }\n\n  useEffect(() => {\n    setIsAttending(props.isAttending === undefined ? false : props.isAttending)\n  }, [props.isAttending])\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-2 p-4\">\n        <div className=\"flex items-center\">\n          <Checkbox\n            checked={isAttending}\n            onCheckedChange={handleAttendanceChange}\n            id=\"attend-checkbox\"\n          />\n          <label htmlFor=\"attend-checkbox\" className=\"ml-2 font-medium text-sm\">\n            å‚åŠ ã™ã‚‹\n          </label>\n        </div>\n        {/* ã‚¤ãƒ™ãƒ³ãƒˆåã¨èª¬æ˜ã‚’è¡¨ç¤º */}\n        <Link\n          className=\"block\"\n          to={`https://www.aipictors.com/events/${props.slug}`}\n          target=\"_blank\"\n        >\n          <Card>\n            <CardContent className=\"space-y-2 p-4\">\n              <h3 className=\"font-medium text-sm\">{props.eventName}</h3>\n              {props.eventDescription !== null && (\n                <div\n                  className=\"font-medium text-xs\"\n                  // biome-ignore lint/security/noDangerouslySetInnerHtml: <explanation>\n                  dangerouslySetInnerHTML={{ __html: props.eventDescription }}\n                />\n              )}\n            </CardContent>\n          </Card>\n        </Link>\n      </CardContent>\n    </Card>\n  )\n}\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-event.tsx"},"span":[1220,1229],"sourceCode":"import type { Tag } from \"~/components/tag/tag-input\"\nimport { Checkbox } from \"~/components/ui/checkbox\"\nimport { Link } from \"@remix-run/react\"\nimport { useEffect, useState } from \"react\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { getJstDate } from \"~/utils/jst-date\"\n\ntype Props = {\n  eventName: string | null\n  eventDescription: string | null\n  eventTag: string | null\n  endAt: number\n  slug: string | null\n  removeTag: (tag: Tag) => void\n  addTag: (tag: Tag) => void\n  isAttending?: boolean\n}\n\n/**\n * ã‚¤ãƒ™ãƒ³ãƒˆå…¥åŠ›\n */\nexport function PostFormItemEvent (props: Props) {\n  const now = getJstDate(new Date())\n\n  const isOngoing = now <= new Date(props.endAt * 1000)\n\n  if (!isOngoing) {\n    return null\n  }\n\n  const [isAttending, setIsAttending] = useState(\n    props.isAttending === undefined ? false : props.isAttending,\n  )\n\n  const handleAttendanceChange = (isChecked: boolean) => {\n    setIsAttending(isChecked)\n    if (props.eventTag) {\n      if (isChecked) {\n        props.addTag({\n          id: props.eventTag,\n          text: props.eventTag,\n        })\n        return\n      }\n      props.removeTag({\n        id: props.eventTag,\n        text: props.eventTag,\n      })\n    }\n  }\n\n  useEffect(() => {\n    setIsAttending(props.isAttending === undefined ? false : props.isAttending)\n  }, [props.isAttending])\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-2 p-4\">\n        <div className=\"flex items-center\">\n          <Checkbox\n            checked={isAttending}\n            onCheckedChange={handleAttendanceChange}\n            id=\"attend-checkbox\"\n          />\n          <label htmlFor=\"attend-checkbox\" className=\"ml-2 font-medium text-sm\">\n            å‚åŠ ã™ã‚‹\n          </label>\n        </div>\n        {/* ã‚¤ãƒ™ãƒ³ãƒˆåã¨èª¬æ˜ã‚’è¡¨ç¤º */}\n        <Link\n          className=\"block\"\n          to={`https://www.aipictors.com/events/${props.slug}`}\n          target=\"_blank\"\n        >\n          <Card>\n            <CardContent className=\"space-y-2 p-4\">\n              <h3 className=\"font-medium text-sm\">{props.eventName}</h3>\n              {props.eventDescription !== null && (\n                <div\n                  className=\"font-medium text-xs\"\n                  // biome-ignore lint/security/noDangerouslySetInnerHtml: <explanation>\n                  dangerouslySetInnerHTML={{ __html: props.eventDescription }}\n                />\n              )}\n            </CardContent>\n          </Card>\n        </Link>\n      </CardContent>\n    </Card>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[684,700],"sourceCode":"import { Checkbox } from \"~/components/ui/checkbox\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  titles: { date: string; title: string }[] | null\n  isChecked?: boolean\n  onChange: (value: boolean) => void\n  isLoading?: boolean\n  targetDate: string // yyyy-mm-dd\n}\n\n/**\n * ãŠé¡Œå…¥åŠ›\n */\nexport function PostFormItemTheme (props: Props) {\n  if (!props.titles) {\n    return null\n  }\n\n  // Extract the title(s) that match the target date\n  const matchingTitles = props.titles\n    .filter((item) => item.date === props.targetDate)\n    .map((item) => item.title)\n\n  if (matchingTitles.length === 0) {\n    return null\n  }\n\n  const t = useTranslation()\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-2 p-4\">\n        <p className=\"font-bold text-sm\">{t(\"ãŠé¡Œå‚åŠ \", \"Join the theme\")}</p>\n        <div className=\"flex items-center space-x-2\">\n          <Checkbox\n            onCheckedChange={(value: boolean) => {\n              props.onChange(value)\n            }}\n            id=\"theme\"\n            checked={props.isChecked}\n          />\n          <label className=\"text-sm\" htmlFor=\"theme\">\n            {t(\n              `ãŠé¡Œã€Œ${matchingTitles.join(\", \")}ã€ã«å‚åŠ ã™ã‚‹`,\n              `Join the theme \"${matchingTitles.join(\", \")}\"`,\n            )}\n          </label>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-theme.tsx"},"span":[718,732],"sourceCode":"import { Checkbox } from \"~/components/ui/checkbox\"\nimport { Card, CardContent } from \"~/components/ui/card\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  titles: { date: string; title: string }[] | null\n  isChecked?: boolean\n  onChange: (value: boolean) => void\n  isLoading?: boolean\n  targetDate: string // yyyy-mm-dd\n}\n\n/**\n * ãŠé¡Œå…¥åŠ›\n */\nexport function PostFormItemTheme (props: Props) {\n  if (!props.titles) {\n    return null\n  }\n\n  // Extract the title(s) that match the target date\n  const matchingTitles = props.titles\n    .filter((item) => item.date === props.targetDate)\n    .map((item) => item.title)\n\n  if (matchingTitles.length === 0) {\n    return null\n  }\n\n  const t = useTranslation()\n\n  return (\n    <Card>\n      <CardContent className=\"space-y-2 p-4\">\n        <p className=\"font-bold text-sm\">{t(\"ãŠé¡Œå‚åŠ \", \"Join the theme\")}</p>\n        <div className=\"flex items-center space-x-2\">\n          <Checkbox\n            onCheckedChange={(value: boolean) => {\n              props.onChange(value)\n            }}\n            id=\"theme\"\n            checked={props.isChecked}\n          />\n          <label className=\"text-sm\" htmlFor=\"theme\">\n            {t(\n              `ãŠé¡Œã€Œ${matchingTitles.join(\", \")}ã€ã«å‚åŠ ã™ã‚‹`,\n              `Join the theme \"${matchingTitles.join(\", \")}\"`,\n            )}\n          </label>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.new.image/components/post-form-item-video.tsx"},"span":[6099,6540],"sourceCode":"import { cn } from \"~/lib/utils\"\nimport { VideoItem } from \"~/routes/($lang)._main.new.image/components/video-item\"\nimport { useState } from \"react\"\nimport { useDropzone } from \"react-dropzone-esm\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { MAX_VIDEO_FILE_SIZE_BYTES, formatFileSize } from \"~/utils/file-size\"\n\ntype Props = {\n  videoFile: File | null\n  setThumbnailBase64(thumbnailBase64: string | null): void\n  setOgpBase64?(ogpBase64: string | null): void\n  setIsThumbnailLandscape?(isThumbnailLandscape: boolean): void\n  onVideoChange(videoFile: File | null): void\n  isEnabledSelectVideo?: boolean\n  previewVideoUrl?: string\n}\n\n/**\n * å‹•ç”»é¸æŠ\n * @param props\n * @returns\n */\nexport function PostFormItemVideo (props: Props) {\n  const t = useTranslation()\n\n  // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§ã‚µã‚¤ã‚º(ãƒã‚¤ãƒˆå˜ä½)\n  const maxSize = MAX_VIDEO_FILE_SIZE_BYTES\n  const maxSizeLabel = formatFileSize(maxSize)\n\n  // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã—ã¦ç”»åƒä¸€è¦§ã«ãƒ›ãƒãƒ¼ä¸­ã‹ã©ã†ã‹\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * ä½œå“ã‚µãƒ ãƒã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹\n   * @param webpDataURL\n   */\n  const updateThumbnail = (webpDataURL: string | null = null) => {\n    if (props.setThumbnailBase64) {\n      props.setThumbnailBase64(webpDataURL ? webpDataURL : \"\")\n    }\n    if (props.setOgpBase64) {\n      props.setOgpBase64(\"\")\n    }\n\n    if (props.setIsThumbnailLandscape) {\n      if (webpDataURL) {\n        const base64 = webpDataURL\n        const img = new Image()\n        img.src = base64 ?? \"\"\n        img.onload = () => {\n          if (props.setIsThumbnailLandscape) {\n            props.setIsThumbnailLandscape(img.width > img.height)\n          }\n        }\n      } else {\n        props.setIsThumbnailLandscape(false)\n      }\n    }\n  }\n\n  const { getRootProps, getInputProps } = useDropzone({\n    minSize: 0,\n    maxSize: maxSize,\n    accept: {\n      \"video/mp4\": [\".mp4\", \".MP4\", \".Mp4\"],\n    },\n    noClick: true,\n    onDrop: (acceptedFiles) => {\n      // biome-ignore lint/complexity/noForEach: <explanation>\n      acceptedFiles.forEach(async (file) => {\n        if (file.type === \"video/mp4\") {\n          if (file.size > maxSize) {\n            toast(\n              t(\n                `å‹•ç”»ã®ã‚µã‚¤ã‚ºã¯${maxSizeLabel}ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„`,\n                `Video size should be under ${maxSizeLabel}`,\n              ),\n            )\n            return\n          }\n          const video = document.createElement(\"video\")\n\n          video.src = URL.createObjectURL(file)\n          video.onloadedmetadata = () => {\n            console.log(\"å‹•ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†:\", {\n              duration: video.duration,\n              videoWidth: video.videoWidth,\n              videoHeight: video.videoHeight,\n            })\n\n            if (video.duration > 12) {\n              toast(\n                t(\n                  \"å‹•ç”»ã¯12ç§’ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„\",\n                  \"Video length should be under 12 seconds\",\n                ),\n              )\n              return\n            }\n\n            props.onVideoChange(file)\n\n            const canvas = document.createElement(\"canvas\")\n            canvas.width = video.videoWidth\n            canvas.height = video.videoHeight\n            const ctx = canvas.getContext(\"2d\")\n\n            if (!ctx) {\n              console.error(\"Canvas 2Dã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              toast(\"ã‚µãƒ ãƒã‚¤ãƒ«ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              return\n            }\n\n            const time = video.duration / 2\n            console.log(\"ã‚·ãƒ¼ã‚¯ã‚¿ã‚¤ãƒ è¨­å®š:\", time)\n            video.currentTime = time\n\n            video.onseeked = () => {\n              console.log(\"å‹•ç”»ã‚·ãƒ¼ã‚¯å®Œäº†ã€ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆé–‹å§‹\")\n              try {\n                ctx.drawImage(video, 0, 0, canvas.width, canvas.height)\n                const thumbnailUrl = canvas.toDataURL() // ã‚µãƒ ãƒã‚¤ãƒ«ã‚’DataURLå½¢å¼ã§å–å¾—\n                console.log(\n                  \"ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆå®Œäº†:\",\n                  `${thumbnailUrl.substring(0, 50)}...`,\n                )\n\n                updateThumbnail(thumbnailUrl)\n              } catch (error) {\n                console.error(\"ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆã‚¨ãƒ©ãƒ¼:\", error)\n                toast(\"ã‚µãƒ ãƒã‚¤ãƒ«ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ\")\n              }\n            }\n\n            video.onerror = (error) => {\n              console.error(\"å‹•ç”»ã‚·ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼:\", error)\n              toast(\"å‹•ç”»ã®å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n            }\n          }\n\n          video.onerror = (error) => {\n            console.error(\"å‹•ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:\", error)\n            toast(\"å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ\")\n          }\n        }\n      })\n      const inputElement = document.getElementById(\n        \"video_input\",\n      ) as HTMLInputElement\n      if (inputElement) {\n        const fileList: File[] = []\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        acceptedFiles.forEach((file) => {\n          fileList.push(file)\n        })\n        const newFileList = new DataTransfer()\n        // biome-ignore lint/complexity/noForEach: <explanation>\n        fileList.forEach((file) => {\n          newFileList.items.add(file)\n        })\n        inputElement.files = newFileList.files\n      }\n    },\n    onDragEnter: () => {\n      setIsHovered(true)\n    },\n    onDragLeave: () => {\n      setIsHovered(false)\n    },\n    onDropAccepted: () => {\n      setIsHovered(false)\n    },\n  })\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        className={cn(\n          \"h-[100%] w-[100%] border-2 border-zinc-800\",\n          isHovered ? \"border-2 border-clear-bright-blue\" : \"\",\n          props.videoFile ? \"\" : \"rounded-b\",\n        )}\n      >\n        {(props.isEnabledSelectVideo === undefined ||\n          props.isEnabledSelectVideo) && (\n          <>\n            <input id=\"video_input\" {...getInputProps()} />\n            {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n            <div\n              className=\"m-auto mt-4 mb-4 flex w-48 cursor-pointer flex-col items-center justify-center rounded bg-clear-bright-blue p-4 text-white\"\n              onClick={() => {\n                const inputElement = document.getElementById(\n                  \"video_input\",\n                ) as HTMLInputElement\n                if (inputElement) {\n                  inputElement.click()\n                }\n              }}\n            >\n              <p className=\"font-bold\">{t(\"å‹•ç”»ã‚’é¸æŠ\", \"Select Video\")}</p>\n            </div>\n            <div className=\"m-4 flex flex-col text-white\">\n              <p className=\"text-center text-sm\">{\"MP4\"}</p>\n              <p className=\"text-center text-sm\">\n                {t(\"12ç§’ã¾ã§\", \"Up to 12 seconds\")}\n              </p>\n            </div>\n          </>\n        )}\n        {props.videoFile && (\n          <VideoItem\n            videoFile={props.videoFile}\n            onDelete={() => {\n              props.onVideoChange(null)\n              updateThumbnail(null)\n            }}\n          />\n        )}\n        {props.previewVideoUrl && (\n          <video\n            controls\n            className=\"m-auto mt-4 mb-4 w-64\"\n            src={props.previewVideoUrl}\n          >\n            <track kind=\"captions\" src=\"path_to_captions.vtt\" label=\"English\" />\n          </video>\n        )}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.posts.$post._index/components/work-image-thumbnail-carousel.tsx"},"span":[1682,2085],"sourceCode":"import {\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselNext,\n  CarouselPrevious,\n} from \"~/components/ui/carousel\"\nimport type React from \"react\"\n\ntype Props = {\n  allImageURLs: string[]\n  selectedImage: string\n  currentIndex: number\n  onSelectImage: (imageURL: string) => void\n}\n\nexport function WorkImageThumbnailCarousel ({\n  allImageURLs,\n  selectedImage,\n  currentIndex,\n  onSelectImage,\n}: Props) {\n  // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼\n  const handleKeyPress = (imageURL: string, event: React.KeyboardEvent) => {\n    if (event.key === \"Enter\") {\n      onSelectImage(imageURL)\n    }\n  }\n\n  return (\n    <div className=\"flex flex-col\">\n      {allImageURLs.length > 1 && (\n        <div className=\"rounded-none bg-card bg-zinc-100 text-center dark:bg-zinc-900\">\n          <p className=\"m-auto text-center text-sm opacity-50\">\n            {currentIndex + 1} / {allImageURLs.length}\n          </p>\n        </div>\n      )}\n      <Carousel opts={{ dragFree: true }}>\n        <CarouselContent>\n          {allImageURLs.map((imageURL, index) => {\n            // é¸æŠã•ã‚ŒãŸç”»åƒã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã€å¯¾å¿œã™ã‚‹ã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨\n            const isSelected = imageURL === selectedImage\n            const imageClassName = isSelected\n              ? \"w-40 h-16 cursor-pointer object-cover border-2 border-clear-bright-blue m-auto\"\n              : \"w-40 h-16 cursor-pointer object-cover border-2 border-transparent m-auto\"\n\n            return (\n              <CarouselItem\n                // biome-ignore lint/suspicious/noArrayIndexKey: <explanation>\n                key={index}\n                className={\"basis-1/8\"}\n              >\n                <img\n                  className={imageClassName}\n                  alt=\"\"\n                  key={imageURL}\n                  src={imageURL}\n                  onClick={() => onSelectImage(imageURL)}\n                  onKeyUp={(event) => handleKeyPress(imageURL, event)}\n                  // biome-ignore lint/a11y/noNoninteractiveTabindex: <explanation>\n                  tabIndex={0}\n                />\n              </CarouselItem>\n            )\n          })}\n        </CarouselContent>\n        {/* <div className=\"absolute top-0 left-0 h-full w-16 bg-linear-to-r from-card to-transparent\" /> */}\n        <CarouselPrevious className=\"absolute left-0\" />\n        {/* <div className=\"absolute top-0 right-0 h-full w-16 bg-linear-to-r from-transparent to-card\" /> */}\n        <CarouselNext className=\"absolute right-0\" />\n      </Carousel>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[642,653],"sourceCode":"import { CroppedWorkSquare } from \"~/components/cropped-work-square\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"~/components/ui/tooltip\"\nimport type { workArticleFragment } from \"~/routes/($lang)._main.posts.$post._index/components/work-article\"\nimport type { FragmentOf } from \"gql.tada\"\nimport { HelpCircleIcon } from \"lucide-react\"\nimport { useEffect } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  work: FragmentOf<typeof workArticleFragment>\n}\n\nexport function WorkNextAndPrevious (props: Props) {\n  const t = useTranslation()\n\n  if (props.work === null) return null\n\n  useEffect(() => {\n    const keyDownHandler = (e: KeyboardEvent) => {\n      if (document !== undefined) {\n        const activeElement = document.activeElement\n        if (\n          activeElement &&\n          (activeElement.tagName.toLowerCase() === \"input\" ||\n            activeElement.tagName.toLowerCase() === \"textarea\")\n        ) {\n          return\n        }\n      }\n\n      if (typeof document !== \"undefined\") {\n        if (e.code === \"KeyQ\" && props.work?.nextWork) {\n          window.location.href = `/posts/${props.work?.nextWork.id}`\n        }\n        if (e.code === \"KeyE\" && props.work?.previousWork) {\n          window.location.href = `/posts/${props.work?.previousWork.id}`\n        }\n      }\n    }\n\n    if (typeof document !== \"undefined\") {\n      document.addEventListener(\"keydown\", keyDownHandler)\n    }\n\n    return () => {\n      if (typeof document !== \"undefined\") {\n        document.removeEventListener(\"keydown\", keyDownHandler)\n      }\n    }\n  }, [props.work])\n\n  return (\n    <>\n      <div className=\"flex text-md\">\n        <h2>{t(\"å‰å¾Œã®ä½œå“\", \"Next and Previous Works\")}</h2>\n        <TooltipProvider>\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <HelpCircleIcon className=\"ml-1 w-4\" />\n            </TooltipTrigger>\n            <TooltipContent>\n              <p>\n                {t(\n                  \"[Q][E]ã‚­ãƒ¼ã§ç§»å‹•ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™\",\n                  \"You can also use the [Q][E] keys to navigate\",\n                )}\n              </p>\n            </TooltipContent>\n          </Tooltip>\n        </TooltipProvider>\n      </div>\n      <div className=\"flex space-x-4\">\n        {props.work.nextWork && (\n          <div className=\"w-full\">\n            <CroppedWorkSquare\n              workId={props.work.nextWork.id}\n              imageUrl={props.work.nextWork.smallThumbnailImageURL}\n              imageWidth={props.work.nextWork.smallThumbnailImageWidth}\n              imageHeight={props.work.nextWork.smallThumbnailImageHeight}\n              thumbnailImagePosition={\n                props.work.nextWork.thumbnailImagePosition ?? 0\n              }\n              size={\"sm\"}\n            />\n          </div>\n        )}\n\n        {!props.work.nextWork && <div className=\"w-full\" />}\n\n        <div className=\"w-full opacity-50\">\n          <CroppedWorkSquare\n            workId={props.work.id}\n            imageUrl={props.work.smallThumbnailImageURL}\n            imageWidth={props.work.smallThumbnailImageWidth}\n            imageHeight={props.work.smallThumbnailImageHeight}\n            thumbnailImagePosition={props.work.thumbnailImagePosition ?? 0}\n            size={\"sm\"}\n          />\n        </div>\n        {props.work.previousWork && (\n          <div className=\"w-full\">\n            <CroppedWorkSquare\n              workId={props.work.previousWork.id}\n              imageUrl={props.work.previousWork.smallThumbnailImageURL}\n              imageWidth={props.work.previousWork.smallThumbnailImageWidth}\n              imageHeight={props.work.previousWork.smallThumbnailImageHeight}\n              thumbnailImagePosition={\n                props.work.previousWork.thumbnailImagePosition ?? 0\n              }\n              size={\"sm\"}\n            />\n          </div>\n        )}\n\n        {!props.work.previousWork && <div className=\"w-full\" />}\n      </div>\n    </>\n  )\n}\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.posts.$post._index/components/work-next-and-previous.tsx"},"span":[657,666],"sourceCode":"import { CroppedWorkSquare } from \"~/components/cropped-work-square\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"~/components/ui/tooltip\"\nimport type { workArticleFragment } from \"~/routes/($lang)._main.posts.$post._index/components/work-article\"\nimport type { FragmentOf } from \"gql.tada\"\nimport { HelpCircleIcon } from \"lucide-react\"\nimport { useEffect } from \"react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  work: FragmentOf<typeof workArticleFragment>\n}\n\nexport function WorkNextAndPrevious (props: Props) {\n  const t = useTranslation()\n\n  if (props.work === null) return null\n\n  useEffect(() => {\n    const keyDownHandler = (e: KeyboardEvent) => {\n      if (document !== undefined) {\n        const activeElement = document.activeElement\n        if (\n          activeElement &&\n          (activeElement.tagName.toLowerCase() === \"input\" ||\n            activeElement.tagName.toLowerCase() === \"textarea\")\n        ) {\n          return\n        }\n      }\n\n      if (typeof document !== \"undefined\") {\n        if (e.code === \"KeyQ\" && props.work?.nextWork) {\n          window.location.href = `/posts/${props.work?.nextWork.id}`\n        }\n        if (e.code === \"KeyE\" && props.work?.previousWork) {\n          window.location.href = `/posts/${props.work?.previousWork.id}`\n        }\n      }\n    }\n\n    if (typeof document !== \"undefined\") {\n      document.addEventListener(\"keydown\", keyDownHandler)\n    }\n\n    return () => {\n      if (typeof document !== \"undefined\") {\n        document.removeEventListener(\"keydown\", keyDownHandler)\n      }\n    }\n  }, [props.work])\n\n  return (\n    <>\n      <div className=\"flex text-md\">\n        <h2>{t(\"å‰å¾Œã®ä½œå“\", \"Next and Previous Works\")}</h2>\n        <TooltipProvider>\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <HelpCircleIcon className=\"ml-1 w-4\" />\n            </TooltipTrigger>\n            <TooltipContent>\n              <p>\n                {t(\n                  \"[Q][E]ã‚­ãƒ¼ã§ç§»å‹•ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™\",\n                  \"You can also use the [Q][E] keys to navigate\",\n                )}\n              </p>\n            </TooltipContent>\n          </Tooltip>\n        </TooltipProvider>\n      </div>\n      <div className=\"flex space-x-4\">\n        {props.work.nextWork && (\n          <div className=\"w-full\">\n            <CroppedWorkSquare\n              workId={props.work.nextWork.id}\n              imageUrl={props.work.nextWork.smallThumbnailImageURL}\n              imageWidth={props.work.nextWork.smallThumbnailImageWidth}\n              imageHeight={props.work.nextWork.smallThumbnailImageHeight}\n              thumbnailImagePosition={\n                props.work.nextWork.thumbnailImagePosition ?? 0\n              }\n              size={\"sm\"}\n            />\n          </div>\n        )}\n\n        {!props.work.nextWork && <div className=\"w-full\" />}\n\n        <div className=\"w-full opacity-50\">\n          <CroppedWorkSquare\n            workId={props.work.id}\n            imageUrl={props.work.smallThumbnailImageURL}\n            imageWidth={props.work.smallThumbnailImageWidth}\n            imageHeight={props.work.smallThumbnailImageHeight}\n            thumbnailImagePosition={props.work.thumbnailImagePosition ?? 0}\n            size={\"sm\"}\n          />\n        </div>\n        {props.work.previousWork && (\n          <div className=\"w-full\">\n            <CroppedWorkSquare\n              workId={props.work.previousWork.id}\n              imageUrl={props.work.previousWork.smallThumbnailImageURL}\n              imageWidth={props.work.previousWork.smallThumbnailImageWidth}\n              imageHeight={props.work.previousWork.smallThumbnailImageHeight}\n              thumbnailImagePosition={\n                props.work.previousWork.thumbnailImagePosition ?? 0\n              }\n              size={\"sm\"}\n            />\n          </div>\n        )}\n\n        {!props.work.previousWork && <div className=\"w-full\" />}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[2071,2087],"sourceCode":"import { loaderClient } from \"~/lib/loader-client\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { useParams } from \"@remix-run/react\"\nimport { useLoaderData } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport {\n  RankingSensitiveWorkList,\n  SensitiveWorkAwardListItemFragment,\n} from \"~/routes/($lang)._main.rankings._index/components/ranking-sensitive-work-list\"\nimport { RankingSensitiveHeader } from \"~/routes/($lang)._main.rankings._index/components/ranking-sensitive-header\"\nimport { config, META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\n\nexport async function loader(props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  if (props.params.year === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  if (props.params.month === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  if (props.params.week === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const year = Number.parseInt(props.params.year)\n\n  const month = Number.parseInt(props.params.month)\n\n  const week = Number.parseInt(props.params.week)\n\n  const workAwardsResp = await loaderClient.query({\n    query: workAwardsQuery,\n    variables: {\n      offset: 0,\n      limit: 200,\n      where: {\n        year: year,\n        month: month,\n        weekIndex: week,\n        isSensitive: true,\n      },\n    },\n  })\n\n  return {\n    year,\n    month,\n    weekIndex: week,\n    workAwards: workAwardsResp,\n  }\n}\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.SENSITIVE_RANKINGS_WEEK, undefined, props.params.lang)\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneDay,\n})\n\n/**\n * ã‚ã‚‹æœˆã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã®å±¥æ­´\n */\nexport default function MonthlyAwards () {\n  const params = useParams()\n\n  if (params.year === undefined) {\n    return null\n  }\n\n  if (params.month === undefined) {\n    return null\n  }\n\n  const data = useLoaderData<typeof loader>()\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <>\n      <RankingSensitiveHeader\n        year={data.year}\n        month={data.month}\n        day={null}\n        weekIndex={data.weekIndex}\n      />\n      <RankingSensitiveWorkList\n        year={data.year}\n        month={data.month}\n        day={null}\n        weekIndex={data.weekIndex}\n        awards={data.workAwards.data.workAwards}\n      />\n    </>\n  )\n}\n\nconst workAwardsQuery = graphql(\n  `query WorkAwards($offset: Int!, $limit: Int!, $where: WorkAwardsWhereInput!) {\n    workAwards(offset: $offset, limit: $limit, where: $where) {\n      ...SensitiveWorkAwardListItem\n    }\n  }`,\n  [SensitiveWorkAwardListItemFragment],\n)\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.r.rankings.$year.$month.weeks.$week._index/route.tsx"},"span":[2108,2121],"sourceCode":"import { loaderClient } from \"~/lib/loader-client\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { useParams } from \"@remix-run/react\"\nimport { useLoaderData } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport {\n  RankingSensitiveWorkList,\n  SensitiveWorkAwardListItemFragment,\n} from \"~/routes/($lang)._main.rankings._index/components/ranking-sensitive-work-list\"\nimport { RankingSensitiveHeader } from \"~/routes/($lang)._main.rankings._index/components/ranking-sensitive-header\"\nimport { config, META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\n\nexport async function loader(props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  if (props.params.year === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  if (props.params.month === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  if (props.params.week === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const year = Number.parseInt(props.params.year)\n\n  const month = Number.parseInt(props.params.month)\n\n  const week = Number.parseInt(props.params.week)\n\n  const workAwardsResp = await loaderClient.query({\n    query: workAwardsQuery,\n    variables: {\n      offset: 0,\n      limit: 200,\n      where: {\n        year: year,\n        month: month,\n        weekIndex: week,\n        isSensitive: true,\n      },\n    },\n  })\n\n  return {\n    year,\n    month,\n    weekIndex: week,\n    workAwards: workAwardsResp,\n  }\n}\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.SENSITIVE_RANKINGS_WEEK, undefined, props.params.lang)\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneDay,\n})\n\n/**\n * ã‚ã‚‹æœˆã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã®å±¥æ­´\n */\nexport default function MonthlyAwards () {\n  const params = useParams()\n\n  if (params.year === undefined) {\n    return null\n  }\n\n  if (params.month === undefined) {\n    return null\n  }\n\n  const data = useLoaderData<typeof loader>()\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <>\n      <RankingSensitiveHeader\n        year={data.year}\n        month={data.month}\n        day={null}\n        weekIndex={data.weekIndex}\n      />\n      <RankingSensitiveWorkList\n        year={data.year}\n        month={data.month}\n        day={null}\n        weekIndex={data.weekIndex}\n        awards={data.workAwards.data.workAwards}\n      />\n    </>\n  )\n}\n\nconst workAwardsQuery = graphql(\n  `query WorkAwards($offset: Int!, $limit: Int!, $where: WorkAwardsWhereInput!) {\n    workAwards(offset: $offset, limit: $limit, where: $where) {\n      ...SensitiveWorkAwardListItem\n    }\n  }`,\n  [SensitiveWorkAwardListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[1801,1817],"sourceCode":"import { loaderClient } from \"~/lib/loader-client\"\nimport { RankingHeader } from \"~/routes/($lang)._main.rankings._index/components/ranking-header\"\nimport {\n  RankingWorkList,\n  WorkAwardListItemFragment,\n} from \"~/routes/($lang)._main.rankings._index/components/ranking-work-list\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { useParams } from \"@remix-run/react\"\nimport { useLoaderData } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { config, META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\n\nexport async function loader(props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  if (props.params.year === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  if (props.params.month === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const year = Number.parseInt(props.params.year)\n\n  const month = Number.parseInt(props.params.month)\n\n  const workAwardsResp = await loaderClient.query({\n    query: workAwardsQuery,\n    variables: {\n      offset: 0,\n      limit: 200,\n      where: {\n        year: year,\n        month: month,\n      },\n    },\n  })\n\n  return {\n    year,\n    month,\n    workAwards: workAwardsResp,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneDay,\n})\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.RANKINGS_MONTHLY, undefined, props.params.lang)\n}\n\n/**\n * ã‚ã‚‹æœˆã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã®å±¥æ­´\n */\nexport default function MonthlyAwards () {\n  const params = useParams()\n\n  if (params.year === undefined) {\n    return null\n  }\n\n  if (params.month === undefined) {\n    return null\n  }\n\n  const data = useLoaderData<typeof loader>()\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <>\n      <RankingHeader\n        year={data.year}\n        month={data.month}\n        day={null}\n        weekIndex={null}\n      />\n      <RankingWorkList\n        year={data.year}\n        month={data.month}\n        day={null}\n        weekIndex={null}\n        awards={data.workAwards.data.workAwards}\n      />\n    </>\n  )\n}\n\nconst workAwardsQuery = graphql(\n  `query WorkAwards($offset: Int!, $limit: Int!, $where: WorkAwardsWhereInput!) {\n    workAwards(offset: $offset, limit: $limit, where: $where) {\n      ...WorkAwardListItem\n    }\n  }`,\n  [WorkAwardListItemFragment],\n)\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.rankings.$year.$month._index/route.tsx"},"span":[1838,1851],"sourceCode":"import { loaderClient } from \"~/lib/loader-client\"\nimport { RankingHeader } from \"~/routes/($lang)._main.rankings._index/components/ranking-header\"\nimport {\n  RankingWorkList,\n  WorkAwardListItemFragment,\n} from \"~/routes/($lang)._main.rankings._index/components/ranking-work-list\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { useParams } from \"@remix-run/react\"\nimport { useLoaderData } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { config, META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\n\nexport async function loader(props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  if (props.params.year === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  if (props.params.month === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const year = Number.parseInt(props.params.year)\n\n  const month = Number.parseInt(props.params.month)\n\n  const workAwardsResp = await loaderClient.query({\n    query: workAwardsQuery,\n    variables: {\n      offset: 0,\n      limit: 200,\n      where: {\n        year: year,\n        month: month,\n      },\n    },\n  })\n\n  return {\n    year,\n    month,\n    workAwards: workAwardsResp,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneDay,\n})\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.RANKINGS_MONTHLY, undefined, props.params.lang)\n}\n\n/**\n * ã‚ã‚‹æœˆã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã®å±¥æ­´\n */\nexport default function MonthlyAwards () {\n  const params = useParams()\n\n  if (params.year === undefined) {\n    return null\n  }\n\n  if (params.month === undefined) {\n    return null\n  }\n\n  const data = useLoaderData<typeof loader>()\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <>\n      <RankingHeader\n        year={data.year}\n        month={data.month}\n        day={null}\n        weekIndex={null}\n      />\n      <RankingWorkList\n        year={data.year}\n        month={data.month}\n        day={null}\n        weekIndex={null}\n        awards={data.workAwards.data.workAwards}\n      />\n    </>\n  )\n}\n\nconst workAwardsQuery = graphql(\n  `query WorkAwards($offset: Int!, $limit: Int!, $where: WorkAwardsWhereInput!) {\n    workAwards(offset: $offset, limit: $limit, where: $where) {\n      ...WorkAwardListItem\n    }\n  }`,\n  [WorkAwardListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[1987,2003],"sourceCode":"import { loaderClient } from \"~/lib/loader-client\"\nimport { RankingHeader } from \"~/routes/($lang)._main.rankings._index/components/ranking-header\"\nimport {\n  RankingWorkList,\n  WorkAwardListItemFragment,\n} from \"~/routes/($lang)._main.rankings._index/components/ranking-work-list\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { useParams } from \"@remix-run/react\"\nimport { useLoaderData } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { config, META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\n\nexport async function loader(props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  if (props.params.year === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  if (props.params.month === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  if (props.params.week === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const year = Number.parseInt(props.params.year)\n\n  const month = Number.parseInt(props.params.month)\n\n  const week = Number.parseInt(props.params.week)\n\n  const workAwardsResp = await loaderClient.query({\n    query: workAwardsQuery,\n    variables: {\n      offset: 0,\n      limit: 200,\n      where: {\n        year: year,\n        month: month,\n        weekIndex: week,\n      },\n    },\n  })\n\n  return {\n    year,\n    month,\n    weekIndex: week,\n    workAwards: workAwardsResp,\n  }\n}\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.RANKINGS_WEEK, undefined, props.params.lang)\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneDay,\n})\n\n/**\n * ã‚ã‚‹æœˆã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã®å±¥æ­´\n */\nexport default function MonthlyAwards () {\n  const params = useParams()\n\n  if (params.year === undefined) {\n    return null\n  }\n\n  if (params.month === undefined) {\n    return null\n  }\n\n  const data = useLoaderData<typeof loader>()\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <>\n      <RankingHeader\n        year={data.year}\n        month={data.month}\n        day={null}\n        weekIndex={data.weekIndex}\n      />\n      <RankingWorkList\n        year={data.year}\n        month={data.month}\n        day={null}\n        weekIndex={data.weekIndex}\n        awards={data.workAwards.data.workAwards}\n      />\n    </>\n  )\n}\n\nconst workAwardsQuery = graphql(\n  `query WorkAwards($offset: Int!, $limit: Int!, $where: WorkAwardsWhereInput!) {\n    workAwards(offset: $offset, limit: $limit, where: $where) {\n      ...WorkAwardListItem\n    }\n  }`,\n  [WorkAwardListItemFragment],\n)\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.rankings.$year.$month.weeks.$week._index/route.tsx"},"span":[2024,2037],"sourceCode":"import { loaderClient } from \"~/lib/loader-client\"\nimport { RankingHeader } from \"~/routes/($lang)._main.rankings._index/components/ranking-header\"\nimport {\n  RankingWorkList,\n  WorkAwardListItemFragment,\n} from \"~/routes/($lang)._main.rankings._index/components/ranking-work-list\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { useParams } from \"@remix-run/react\"\nimport { useLoaderData } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { config, META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\n\nexport async function loader(props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  if (props.params.year === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  if (props.params.month === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  if (props.params.week === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const year = Number.parseInt(props.params.year)\n\n  const month = Number.parseInt(props.params.month)\n\n  const week = Number.parseInt(props.params.week)\n\n  const workAwardsResp = await loaderClient.query({\n    query: workAwardsQuery,\n    variables: {\n      offset: 0,\n      limit: 200,\n      where: {\n        year: year,\n        month: month,\n        weekIndex: week,\n      },\n    },\n  })\n\n  return {\n    year,\n    month,\n    weekIndex: week,\n    workAwards: workAwardsResp,\n  }\n}\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.RANKINGS_WEEK, undefined, props.params.lang)\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneDay,\n})\n\n/**\n * ã‚ã‚‹æœˆã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã®å±¥æ­´\n */\nexport default function MonthlyAwards () {\n  const params = useParams()\n\n  if (params.year === undefined) {\n    return null\n  }\n\n  if (params.month === undefined) {\n    return null\n  }\n\n  const data = useLoaderData<typeof loader>()\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <>\n      <RankingHeader\n        year={data.year}\n        month={data.month}\n        day={null}\n        weekIndex={data.weekIndex}\n      />\n      <RankingWorkList\n        year={data.year}\n        month={data.month}\n        day={null}\n        weekIndex={data.weekIndex}\n        awards={data.workAwards.data.workAwards}\n      />\n    </>\n  )\n}\n\nconst workAwardsQuery = graphql(\n  `query WorkAwards($offset: Int!, $limit: Int!, $where: WorkAwardsWhereInput!) {\n    workAwards(offset: $offset, limit: $limit, where: $where) {\n      ...WorkAwardListItem\n    }\n  }`,\n  [WorkAwardListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/useSemanticElements","severity":"error","description":"The elements with this role can be changed to the following elements:\n<button>","message":[{"elements":[],"content":"The elements with this role can be changed to the following elements:\n<button>"}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"For examples and more information, see "},{"elements":[{"Hyperlink":{"href":"https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles"}}],"content":"WAI-ARIA Roles"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.settings.completed._index/components/new-settings-completed.tsx"},"span":[1775,1788],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { useNavigate } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { Sparkles, Palette, Users, Star } from \"lucide-react\"\n\n/**\n * æ–°ã—ã„è¨­å®šå®Œäº†ãƒšãƒ¼ã‚¸\n */\nexport function NewSettingsCompleted () {\n  const navigate = useNavigate()\n  const t = useTranslation()\n\n  return (\n    <div className=\"mx-auto max-w-4xl space-y-8 p-6\">\n      {/* å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */}\n      <div className=\"rounded-xl border border-green-200 bg-gradient-to-r from-green-50 to-blue-50 p-8 text-center dark:border-green-600 dark:from-green-900/30 dark:to-blue-900/30\">\n        <div className=\"mb-6 text-6xl\">ğŸ‰</div>\n        <h1 className=\"mb-4 font-bold text-3xl text-gray-800 dark:text-gray-100\">\n          {t(\n            \"è¨­å®šå®Œäº†ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼\",\n            \"Congratulations! Setup Complete!\",\n          )}\n        </h1>\n        <p className=\"mb-2 text-gray-600 text-lg dark:text-gray-300\">\n          {t(\"Aipictorsã¸ã‚ˆã†ã“ãï¼\", \"Welcome to Aipictors!\")}\n        </p>\n        <p className=\"text-gray-600 dark:text-gray-300\">\n          {t(\n            \"ã“ã‚Œã§ã‚ãªãŸã‚‚AIã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã®ä»²é–“å…¥ã‚Šã§ã™\",\n            \"You are now part of the AI creator community\",\n          )}\n        </p>\n      </div>\n\n      {/* æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ— */}\n      <div className=\"rounded-xl border border-gray-200 bg-white p-6 dark:border-gray-700 dark:bg-gray-800\">\n        <h2 className=\"mb-6 text-center font-bold text-gray-800 text-xl dark:text-gray-100\">\n          {t(\"ã•ã‚ã€ä½•ã‹ã‚‰å§‹ã‚ã¾ã™ã‹ï¼Ÿ\", \"What would you like to do first?\")}\n        </h2>\n\n        <div className=\"grid gap-6 md:grid-cols-2\">\n          {/* AIç”Ÿæˆ */}\n          <div\n            role=\"button\"\n            tabIndex={0}\n            className=\"group cursor-pointer rounded-lg border border-purple-200 bg-purple-50 p-6 transition-all hover:border-purple-300 hover:bg-purple-100 dark:border-purple-600 dark:bg-purple-900/30 dark:hover:border-purple-500 dark:hover:bg-purple-900/50\"\n            onClick={() => navigate(\"/generation\")}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault()\n                navigate(\"/generation\")\n              }\n            }}\n          >\n            <div className=\"flex items-start gap-4\">\n              <div className=\"rounded-full bg-purple-500 p-3\">\n                <Sparkles className=\"size-6 text-white\" />\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"mb-2 font-bold text-gray-800 dark:text-gray-100\">\n                  {t(\"AIç”»åƒã‚’ç”Ÿæˆã—ã¦ã¿ã‚‹\", \"Try AI Image Generation\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm dark:text-gray-300\">\n                  {t(\n                    \"ç„¡æ–™ã§AIç”»åƒã‚’ç”Ÿæˆã§ãã¾ã™ã€‚ã¾ãšã¯ç°¡å˜ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‹ã‚‰å§‹ã‚ã¦ã¿ã¾ã—ã‚‡ã†\",\n                    \"Generate AI images for free. Start with simple prompts\",\n                  )}\n                </p>\n                <div className=\"mt-3\">\n                  <Button className=\"group-hover:bg-purple-600\">\n                    {t(\"ç”Ÿæˆã‚’å§‹ã‚ã‚‹\", \"Start Generating\")}\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* ä½œå“æŠ•ç¨¿ */}\n          <div\n            role=\"button\"\n            tabIndex={0}\n            className=\"group cursor-pointer rounded-lg border border-blue-200 bg-blue-50 p-6 transition-all hover:border-blue-300 hover:bg-blue-100 dark:border-blue-600 dark:bg-blue-900/30 dark:hover:border-blue-500 dark:hover:bg-blue-900/50\"\n            onClick={() => navigate(\"/new/image\")}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault()\n                navigate(\"/new/image\")\n              }\n            }}\n          >\n            <div className=\"flex items-start gap-4\">\n              <div className=\"rounded-full bg-blue-500 p-3\">\n                <Palette className=\"size-6 text-white\" />\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"mb-2 font-bold text-gray-800 dark:text-gray-100\">\n                  {t(\"ä½œå“ã‚’æŠ•ç¨¿ã—ã¦ã¿ã‚‹\", \"Try Posting Your Work\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm dark:text-gray-300\">\n                  {t(\n                    \"ã‚ãªãŸã®ä½œå“ã‚’æŠ•ç¨¿ã—ã¦ã€ãŸãã•ã‚“ã®äººã«è¦‹ã¦ã‚‚ã‚‰ã„ã¾ã—ã‚‡ã†\",\n                    \"Post your work and share it with many people\",\n                  )}\n                </p>\n                <div className=\"mt-3\">\n                  <Button className=\"group-hover:bg-blue-600\">\n                    {t(\"æŠ•ç¨¿ã™ã‚‹\", \"Post Work\")}\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* ä½œå“ã‚’æ¥½ã—ã‚€ */}\n          <div\n            role=\"button\"\n            tabIndex={0}\n            className=\"group cursor-pointer rounded-lg border border-green-200 bg-green-50 p-6 transition-all hover:border-green-300 hover:bg-green-100 dark:border-green-600 dark:bg-green-900/30 dark:hover:border-green-500 dark:hover:bg-green-900/50\"\n            onClick={() => navigate(\"/\")}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault()\n                navigate(\"/\")\n              }\n            }}\n          >\n            <div className=\"flex items-start gap-4\">\n              <div className=\"rounded-full bg-green-500 p-3\">\n                <Star className=\"size-6 text-white\" />\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"mb-2 font-bold text-gray-800 dark:text-gray-100\">\n                  {t(\"ã¿ã‚“ãªã®ä½œå“ã‚’æ¥½ã—ã‚€\", \"Enjoy Everyone's Works\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm dark:text-gray-300\">\n                  {t(\n                    \"ç´ æ™´ã‚‰ã—ã„AIä½œå“ãŒãŸãã•ã‚“æŠ•ç¨¿ã•ã‚Œã¦ã„ã¾ã™ã€‚ã„ã„ã­ã‚„ã‚³ãƒ¡ãƒ³ãƒˆã§äº¤æµã—ã¾ã—ã‚‡ã†\",\n                    \"Browse amazing AI works and interact with likes and comments\",\n                  )}\n                </p>\n                <div className=\"mt-3\">\n                  <Button className=\"group-hover:bg-green-600\">\n                    {t(\"ä½œå“ã‚’è¦‹ã‚‹\", \"Browse Works\")}\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ */}\n          <div\n            role=\"button\"\n            tabIndex={0}\n            className=\"group cursor-pointer rounded-lg border border-orange-200 bg-orange-50 p-6 transition-all hover:border-orange-300 hover:bg-orange-100 dark:border-orange-600 dark:bg-orange-900/30 dark:hover:border-orange-500 dark:hover:bg-orange-900/50\"\n            onClick={() => navigate(\"/users\")}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault()\n                navigate(\"/users\")\n              }\n            }}\n          >\n            <div className=\"flex items-start gap-4\">\n              <div className=\"rounded-full bg-orange-500 p-3\">\n                <Users className=\"size-6 text-white\" />\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"mb-2 font-bold text-gray-800 dark:text-gray-100\">\n                  {t(\"ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã‚’æ¢ã™\", \"Discover Creators\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm dark:text-gray-300\">\n                  {t(\n                    \"ãŠæ°—ã«å…¥ã‚Šã®ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ã€æ–°ã—ã„ä½œå“ã‚’ã„ã¡æ—©ããƒã‚§ãƒƒã‚¯ã—ã¾ã—ã‚‡ã†\",\n                    \"Follow your favorite creators and stay updated with their latest works\",\n                  )}\n                </p>\n                <div className=\"mt-3\">\n                  <Button className=\"group-hover:bg-orange-600\">\n                    {t(\"æ¢ã—ã¦ã¿ã‚‹\", \"Explore\")}\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* ãƒ’ãƒ³ãƒˆ */}\n      <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-6 dark:border-blue-600 dark:bg-blue-900/30\">\n        <h3 className=\"mb-4 font-bold text-gray-800 dark:text-gray-100\">\n          {t(\"ğŸ’¡ ã¯ã˜ã‚ã¦ã®Aipictors\", \"ğŸ’¡ Getting Started Tips\")}\n        </h3>\n        <div className=\"space-y-3 text-gray-700 text-sm dark:text-gray-300\">\n          <div className=\"flex items-start gap-2\">\n            <span className=\"text-blue-500\">â€¢</span>\n            <p>\n              {t(\n                \"è¨­å®šã¯ã„ã¤ã§ã‚‚å³ä¸Šã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰å¤‰æ›´ã§ãã¾ã™\",\n                \"You can change settings anytime from the menu in the top right\",\n              )}\n            </p>\n          </div>\n          <div className=\"flex items-start gap-2\">\n            <span className=\"text-blue-500\">â€¢</span>\n            <p>\n              {t(\n                \"å›°ã£ãŸæ™‚ã¯ç”»é¢ä¸‹éƒ¨ã®ãƒ˜ãƒ«ãƒ—ã‚„ãŠå•ã„åˆã‚ã›ã‚’ã”åˆ©ç”¨ãã ã•ã„\",\n                \"If you need help, check the help section or contact us at the bottom of the page\",\n              )}\n            </p>\n          </div>\n          <div className=\"flex items-start gap-2\">\n            <span className=\"text-blue-500\">â€¢</span>\n            <p>\n              {t(\n                \"æ¯æ—¥æ–°ã—ã„ä½œå“ãŒæŠ•ç¨¿ã•ã‚Œã‚‹ã®ã§ã€ãœã²å®šæœŸçš„ã«ãƒã‚§ãƒƒã‚¯ã—ã¦ã¿ã¦ãã ã•ã„\",\n                \"New works are posted daily, so check back regularly for fresh content\",\n              )}\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* è¨­å®šå¤‰æ›´ãƒœã‚¿ãƒ³ */}\n      <div className=\"text-center\">\n        <Button\n          variant=\"outline\"\n          onClick={() => navigate(\"/settings\")}\n          className=\"text-gray-600 dark:text-gray-300\"\n        >\n          {t(\"è¨­å®šã‚’å¤‰æ›´ã™ã‚‹\", \"Change Settings\")}\n        </Button>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/useSemanticElements","severity":"error","description":"The elements with this role can be changed to the following elements:\n<button>","message":[{"elements":[],"content":"The elements with this role can be changed to the following elements:\n<button>"}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"For examples and more information, see "},{"elements":[{"Hyperlink":{"href":"https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles"}}],"content":"WAI-ARIA Roles"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.settings.completed._index/components/new-settings-completed.tsx"},"span":[3431,3444],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { useNavigate } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { Sparkles, Palette, Users, Star } from \"lucide-react\"\n\n/**\n * æ–°ã—ã„è¨­å®šå®Œäº†ãƒšãƒ¼ã‚¸\n */\nexport function NewSettingsCompleted () {\n  const navigate = useNavigate()\n  const t = useTranslation()\n\n  return (\n    <div className=\"mx-auto max-w-4xl space-y-8 p-6\">\n      {/* å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */}\n      <div className=\"rounded-xl border border-green-200 bg-gradient-to-r from-green-50 to-blue-50 p-8 text-center dark:border-green-600 dark:from-green-900/30 dark:to-blue-900/30\">\n        <div className=\"mb-6 text-6xl\">ğŸ‰</div>\n        <h1 className=\"mb-4 font-bold text-3xl text-gray-800 dark:text-gray-100\">\n          {t(\n            \"è¨­å®šå®Œäº†ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼\",\n            \"Congratulations! Setup Complete!\",\n          )}\n        </h1>\n        <p className=\"mb-2 text-gray-600 text-lg dark:text-gray-300\">\n          {t(\"Aipictorsã¸ã‚ˆã†ã“ãï¼\", \"Welcome to Aipictors!\")}\n        </p>\n        <p className=\"text-gray-600 dark:text-gray-300\">\n          {t(\n            \"ã“ã‚Œã§ã‚ãªãŸã‚‚AIã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã®ä»²é–“å…¥ã‚Šã§ã™\",\n            \"You are now part of the AI creator community\",\n          )}\n        </p>\n      </div>\n\n      {/* æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ— */}\n      <div className=\"rounded-xl border border-gray-200 bg-white p-6 dark:border-gray-700 dark:bg-gray-800\">\n        <h2 className=\"mb-6 text-center font-bold text-gray-800 text-xl dark:text-gray-100\">\n          {t(\"ã•ã‚ã€ä½•ã‹ã‚‰å§‹ã‚ã¾ã™ã‹ï¼Ÿ\", \"What would you like to do first?\")}\n        </h2>\n\n        <div className=\"grid gap-6 md:grid-cols-2\">\n          {/* AIç”Ÿæˆ */}\n          <div\n            role=\"button\"\n            tabIndex={0}\n            className=\"group cursor-pointer rounded-lg border border-purple-200 bg-purple-50 p-6 transition-all hover:border-purple-300 hover:bg-purple-100 dark:border-purple-600 dark:bg-purple-900/30 dark:hover:border-purple-500 dark:hover:bg-purple-900/50\"\n            onClick={() => navigate(\"/generation\")}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault()\n                navigate(\"/generation\")\n              }\n            }}\n          >\n            <div className=\"flex items-start gap-4\">\n              <div className=\"rounded-full bg-purple-500 p-3\">\n                <Sparkles className=\"size-6 text-white\" />\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"mb-2 font-bold text-gray-800 dark:text-gray-100\">\n                  {t(\"AIç”»åƒã‚’ç”Ÿæˆã—ã¦ã¿ã‚‹\", \"Try AI Image Generation\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm dark:text-gray-300\">\n                  {t(\n                    \"ç„¡æ–™ã§AIç”»åƒã‚’ç”Ÿæˆã§ãã¾ã™ã€‚ã¾ãšã¯ç°¡å˜ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‹ã‚‰å§‹ã‚ã¦ã¿ã¾ã—ã‚‡ã†\",\n                    \"Generate AI images for free. Start with simple prompts\",\n                  )}\n                </p>\n                <div className=\"mt-3\">\n                  <Button className=\"group-hover:bg-purple-600\">\n                    {t(\"ç”Ÿæˆã‚’å§‹ã‚ã‚‹\", \"Start Generating\")}\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* ä½œå“æŠ•ç¨¿ */}\n          <div\n            role=\"button\"\n            tabIndex={0}\n            className=\"group cursor-pointer rounded-lg border border-blue-200 bg-blue-50 p-6 transition-all hover:border-blue-300 hover:bg-blue-100 dark:border-blue-600 dark:bg-blue-900/30 dark:hover:border-blue-500 dark:hover:bg-blue-900/50\"\n            onClick={() => navigate(\"/new/image\")}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault()\n                navigate(\"/new/image\")\n              }\n            }}\n          >\n            <div className=\"flex items-start gap-4\">\n              <div className=\"rounded-full bg-blue-500 p-3\">\n                <Palette className=\"size-6 text-white\" />\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"mb-2 font-bold text-gray-800 dark:text-gray-100\">\n                  {t(\"ä½œå“ã‚’æŠ•ç¨¿ã—ã¦ã¿ã‚‹\", \"Try Posting Your Work\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm dark:text-gray-300\">\n                  {t(\n                    \"ã‚ãªãŸã®ä½œå“ã‚’æŠ•ç¨¿ã—ã¦ã€ãŸãã•ã‚“ã®äººã«è¦‹ã¦ã‚‚ã‚‰ã„ã¾ã—ã‚‡ã†\",\n                    \"Post your work and share it with many people\",\n                  )}\n                </p>\n                <div className=\"mt-3\">\n                  <Button className=\"group-hover:bg-blue-600\">\n                    {t(\"æŠ•ç¨¿ã™ã‚‹\", \"Post Work\")}\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* ä½œå“ã‚’æ¥½ã—ã‚€ */}\n          <div\n            role=\"button\"\n            tabIndex={0}\n            className=\"group cursor-pointer rounded-lg border border-green-200 bg-green-50 p-6 transition-all hover:border-green-300 hover:bg-green-100 dark:border-green-600 dark:bg-green-900/30 dark:hover:border-green-500 dark:hover:bg-green-900/50\"\n            onClick={() => navigate(\"/\")}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault()\n                navigate(\"/\")\n              }\n            }}\n          >\n            <div className=\"flex items-start gap-4\">\n              <div className=\"rounded-full bg-green-500 p-3\">\n                <Star className=\"size-6 text-white\" />\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"mb-2 font-bold text-gray-800 dark:text-gray-100\">\n                  {t(\"ã¿ã‚“ãªã®ä½œå“ã‚’æ¥½ã—ã‚€\", \"Enjoy Everyone's Works\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm dark:text-gray-300\">\n                  {t(\n                    \"ç´ æ™´ã‚‰ã—ã„AIä½œå“ãŒãŸãã•ã‚“æŠ•ç¨¿ã•ã‚Œã¦ã„ã¾ã™ã€‚ã„ã„ã­ã‚„ã‚³ãƒ¡ãƒ³ãƒˆã§äº¤æµã—ã¾ã—ã‚‡ã†\",\n                    \"Browse amazing AI works and interact with likes and comments\",\n                  )}\n                </p>\n                <div className=\"mt-3\">\n                  <Button className=\"group-hover:bg-green-600\">\n                    {t(\"ä½œå“ã‚’è¦‹ã‚‹\", \"Browse Works\")}\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ */}\n          <div\n            role=\"button\"\n            tabIndex={0}\n            className=\"group cursor-pointer rounded-lg border border-orange-200 bg-orange-50 p-6 transition-all hover:border-orange-300 hover:bg-orange-100 dark:border-orange-600 dark:bg-orange-900/30 dark:hover:border-orange-500 dark:hover:bg-orange-900/50\"\n            onClick={() => navigate(\"/users\")}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault()\n                navigate(\"/users\")\n              }\n            }}\n          >\n            <div className=\"flex items-start gap-4\">\n              <div className=\"rounded-full bg-orange-500 p-3\">\n                <Users className=\"size-6 text-white\" />\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"mb-2 font-bold text-gray-800 dark:text-gray-100\">\n                  {t(\"ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã‚’æ¢ã™\", \"Discover Creators\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm dark:text-gray-300\">\n                  {t(\n                    \"ãŠæ°—ã«å…¥ã‚Šã®ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ã€æ–°ã—ã„ä½œå“ã‚’ã„ã¡æ—©ããƒã‚§ãƒƒã‚¯ã—ã¾ã—ã‚‡ã†\",\n                    \"Follow your favorite creators and stay updated with their latest works\",\n                  )}\n                </p>\n                <div className=\"mt-3\">\n                  <Button className=\"group-hover:bg-orange-600\">\n                    {t(\"æ¢ã—ã¦ã¿ã‚‹\", \"Explore\")}\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* ãƒ’ãƒ³ãƒˆ */}\n      <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-6 dark:border-blue-600 dark:bg-blue-900/30\">\n        <h3 className=\"mb-4 font-bold text-gray-800 dark:text-gray-100\">\n          {t(\"ğŸ’¡ ã¯ã˜ã‚ã¦ã®Aipictors\", \"ğŸ’¡ Getting Started Tips\")}\n        </h3>\n        <div className=\"space-y-3 text-gray-700 text-sm dark:text-gray-300\">\n          <div className=\"flex items-start gap-2\">\n            <span className=\"text-blue-500\">â€¢</span>\n            <p>\n              {t(\n                \"è¨­å®šã¯ã„ã¤ã§ã‚‚å³ä¸Šã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰å¤‰æ›´ã§ãã¾ã™\",\n                \"You can change settings anytime from the menu in the top right\",\n              )}\n            </p>\n          </div>\n          <div className=\"flex items-start gap-2\">\n            <span className=\"text-blue-500\">â€¢</span>\n            <p>\n              {t(\n                \"å›°ã£ãŸæ™‚ã¯ç”»é¢ä¸‹éƒ¨ã®ãƒ˜ãƒ«ãƒ—ã‚„ãŠå•ã„åˆã‚ã›ã‚’ã”åˆ©ç”¨ãã ã•ã„\",\n                \"If you need help, check the help section or contact us at the bottom of the page\",\n              )}\n            </p>\n          </div>\n          <div className=\"flex items-start gap-2\">\n            <span className=\"text-blue-500\">â€¢</span>\n            <p>\n              {t(\n                \"æ¯æ—¥æ–°ã—ã„ä½œå“ãŒæŠ•ç¨¿ã•ã‚Œã‚‹ã®ã§ã€ãœã²å®šæœŸçš„ã«ãƒã‚§ãƒƒã‚¯ã—ã¦ã¿ã¦ãã ã•ã„\",\n                \"New works are posted daily, so check back regularly for fresh content\",\n              )}\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* è¨­å®šå¤‰æ›´ãƒœã‚¿ãƒ³ */}\n      <div className=\"text-center\">\n        <Button\n          variant=\"outline\"\n          onClick={() => navigate(\"/settings\")}\n          className=\"text-gray-600 dark:text-gray-300\"\n        >\n          {t(\"è¨­å®šã‚’å¤‰æ›´ã™ã‚‹\", \"Change Settings\")}\n        </Button>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/useSemanticElements","severity":"error","description":"The elements with this role can be changed to the following elements:\n<button>","message":[{"elements":[],"content":"The elements with this role can be changed to the following elements:\n<button>"}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"For examples and more information, see "},{"elements":[{"Hyperlink":{"href":"https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles"}}],"content":"WAI-ARIA Roles"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.settings.completed._index/components/new-settings-completed.tsx"},"span":[5023,5036],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { useNavigate } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { Sparkles, Palette, Users, Star } from \"lucide-react\"\n\n/**\n * æ–°ã—ã„è¨­å®šå®Œäº†ãƒšãƒ¼ã‚¸\n */\nexport function NewSettingsCompleted () {\n  const navigate = useNavigate()\n  const t = useTranslation()\n\n  return (\n    <div className=\"mx-auto max-w-4xl space-y-8 p-6\">\n      {/* å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */}\n      <div className=\"rounded-xl border border-green-200 bg-gradient-to-r from-green-50 to-blue-50 p-8 text-center dark:border-green-600 dark:from-green-900/30 dark:to-blue-900/30\">\n        <div className=\"mb-6 text-6xl\">ğŸ‰</div>\n        <h1 className=\"mb-4 font-bold text-3xl text-gray-800 dark:text-gray-100\">\n          {t(\n            \"è¨­å®šå®Œäº†ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼\",\n            \"Congratulations! Setup Complete!\",\n          )}\n        </h1>\n        <p className=\"mb-2 text-gray-600 text-lg dark:text-gray-300\">\n          {t(\"Aipictorsã¸ã‚ˆã†ã“ãï¼\", \"Welcome to Aipictors!\")}\n        </p>\n        <p className=\"text-gray-600 dark:text-gray-300\">\n          {t(\n            \"ã“ã‚Œã§ã‚ãªãŸã‚‚AIã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã®ä»²é–“å…¥ã‚Šã§ã™\",\n            \"You are now part of the AI creator community\",\n          )}\n        </p>\n      </div>\n\n      {/* æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ— */}\n      <div className=\"rounded-xl border border-gray-200 bg-white p-6 dark:border-gray-700 dark:bg-gray-800\">\n        <h2 className=\"mb-6 text-center font-bold text-gray-800 text-xl dark:text-gray-100\">\n          {t(\"ã•ã‚ã€ä½•ã‹ã‚‰å§‹ã‚ã¾ã™ã‹ï¼Ÿ\", \"What would you like to do first?\")}\n        </h2>\n\n        <div className=\"grid gap-6 md:grid-cols-2\">\n          {/* AIç”Ÿæˆ */}\n          <div\n            role=\"button\"\n            tabIndex={0}\n            className=\"group cursor-pointer rounded-lg border border-purple-200 bg-purple-50 p-6 transition-all hover:border-purple-300 hover:bg-purple-100 dark:border-purple-600 dark:bg-purple-900/30 dark:hover:border-purple-500 dark:hover:bg-purple-900/50\"\n            onClick={() => navigate(\"/generation\")}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault()\n                navigate(\"/generation\")\n              }\n            }}\n          >\n            <div className=\"flex items-start gap-4\">\n              <div className=\"rounded-full bg-purple-500 p-3\">\n                <Sparkles className=\"size-6 text-white\" />\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"mb-2 font-bold text-gray-800 dark:text-gray-100\">\n                  {t(\"AIç”»åƒã‚’ç”Ÿæˆã—ã¦ã¿ã‚‹\", \"Try AI Image Generation\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm dark:text-gray-300\">\n                  {t(\n                    \"ç„¡æ–™ã§AIç”»åƒã‚’ç”Ÿæˆã§ãã¾ã™ã€‚ã¾ãšã¯ç°¡å˜ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‹ã‚‰å§‹ã‚ã¦ã¿ã¾ã—ã‚‡ã†\",\n                    \"Generate AI images for free. Start with simple prompts\",\n                  )}\n                </p>\n                <div className=\"mt-3\">\n                  <Button className=\"group-hover:bg-purple-600\">\n                    {t(\"ç”Ÿæˆã‚’å§‹ã‚ã‚‹\", \"Start Generating\")}\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* ä½œå“æŠ•ç¨¿ */}\n          <div\n            role=\"button\"\n            tabIndex={0}\n            className=\"group cursor-pointer rounded-lg border border-blue-200 bg-blue-50 p-6 transition-all hover:border-blue-300 hover:bg-blue-100 dark:border-blue-600 dark:bg-blue-900/30 dark:hover:border-blue-500 dark:hover:bg-blue-900/50\"\n            onClick={() => navigate(\"/new/image\")}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault()\n                navigate(\"/new/image\")\n              }\n            }}\n          >\n            <div className=\"flex items-start gap-4\">\n              <div className=\"rounded-full bg-blue-500 p-3\">\n                <Palette className=\"size-6 text-white\" />\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"mb-2 font-bold text-gray-800 dark:text-gray-100\">\n                  {t(\"ä½œå“ã‚’æŠ•ç¨¿ã—ã¦ã¿ã‚‹\", \"Try Posting Your Work\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm dark:text-gray-300\">\n                  {t(\n                    \"ã‚ãªãŸã®ä½œå“ã‚’æŠ•ç¨¿ã—ã¦ã€ãŸãã•ã‚“ã®äººã«è¦‹ã¦ã‚‚ã‚‰ã„ã¾ã—ã‚‡ã†\",\n                    \"Post your work and share it with many people\",\n                  )}\n                </p>\n                <div className=\"mt-3\">\n                  <Button className=\"group-hover:bg-blue-600\">\n                    {t(\"æŠ•ç¨¿ã™ã‚‹\", \"Post Work\")}\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* ä½œå“ã‚’æ¥½ã—ã‚€ */}\n          <div\n            role=\"button\"\n            tabIndex={0}\n            className=\"group cursor-pointer rounded-lg border border-green-200 bg-green-50 p-6 transition-all hover:border-green-300 hover:bg-green-100 dark:border-green-600 dark:bg-green-900/30 dark:hover:border-green-500 dark:hover:bg-green-900/50\"\n            onClick={() => navigate(\"/\")}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault()\n                navigate(\"/\")\n              }\n            }}\n          >\n            <div className=\"flex items-start gap-4\">\n              <div className=\"rounded-full bg-green-500 p-3\">\n                <Star className=\"size-6 text-white\" />\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"mb-2 font-bold text-gray-800 dark:text-gray-100\">\n                  {t(\"ã¿ã‚“ãªã®ä½œå“ã‚’æ¥½ã—ã‚€\", \"Enjoy Everyone's Works\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm dark:text-gray-300\">\n                  {t(\n                    \"ç´ æ™´ã‚‰ã—ã„AIä½œå“ãŒãŸãã•ã‚“æŠ•ç¨¿ã•ã‚Œã¦ã„ã¾ã™ã€‚ã„ã„ã­ã‚„ã‚³ãƒ¡ãƒ³ãƒˆã§äº¤æµã—ã¾ã—ã‚‡ã†\",\n                    \"Browse amazing AI works and interact with likes and comments\",\n                  )}\n                </p>\n                <div className=\"mt-3\">\n                  <Button className=\"group-hover:bg-green-600\">\n                    {t(\"ä½œå“ã‚’è¦‹ã‚‹\", \"Browse Works\")}\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ */}\n          <div\n            role=\"button\"\n            tabIndex={0}\n            className=\"group cursor-pointer rounded-lg border border-orange-200 bg-orange-50 p-6 transition-all hover:border-orange-300 hover:bg-orange-100 dark:border-orange-600 dark:bg-orange-900/30 dark:hover:border-orange-500 dark:hover:bg-orange-900/50\"\n            onClick={() => navigate(\"/users\")}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault()\n                navigate(\"/users\")\n              }\n            }}\n          >\n            <div className=\"flex items-start gap-4\">\n              <div className=\"rounded-full bg-orange-500 p-3\">\n                <Users className=\"size-6 text-white\" />\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"mb-2 font-bold text-gray-800 dark:text-gray-100\">\n                  {t(\"ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã‚’æ¢ã™\", \"Discover Creators\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm dark:text-gray-300\">\n                  {t(\n                    \"ãŠæ°—ã«å…¥ã‚Šã®ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ã€æ–°ã—ã„ä½œå“ã‚’ã„ã¡æ—©ããƒã‚§ãƒƒã‚¯ã—ã¾ã—ã‚‡ã†\",\n                    \"Follow your favorite creators and stay updated with their latest works\",\n                  )}\n                </p>\n                <div className=\"mt-3\">\n                  <Button className=\"group-hover:bg-orange-600\">\n                    {t(\"æ¢ã—ã¦ã¿ã‚‹\", \"Explore\")}\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* ãƒ’ãƒ³ãƒˆ */}\n      <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-6 dark:border-blue-600 dark:bg-blue-900/30\">\n        <h3 className=\"mb-4 font-bold text-gray-800 dark:text-gray-100\">\n          {t(\"ğŸ’¡ ã¯ã˜ã‚ã¦ã®Aipictors\", \"ğŸ’¡ Getting Started Tips\")}\n        </h3>\n        <div className=\"space-y-3 text-gray-700 text-sm dark:text-gray-300\">\n          <div className=\"flex items-start gap-2\">\n            <span className=\"text-blue-500\">â€¢</span>\n            <p>\n              {t(\n                \"è¨­å®šã¯ã„ã¤ã§ã‚‚å³ä¸Šã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰å¤‰æ›´ã§ãã¾ã™\",\n                \"You can change settings anytime from the menu in the top right\",\n              )}\n            </p>\n          </div>\n          <div className=\"flex items-start gap-2\">\n            <span className=\"text-blue-500\">â€¢</span>\n            <p>\n              {t(\n                \"å›°ã£ãŸæ™‚ã¯ç”»é¢ä¸‹éƒ¨ã®ãƒ˜ãƒ«ãƒ—ã‚„ãŠå•ã„åˆã‚ã›ã‚’ã”åˆ©ç”¨ãã ã•ã„\",\n                \"If you need help, check the help section or contact us at the bottom of the page\",\n              )}\n            </p>\n          </div>\n          <div className=\"flex items-start gap-2\">\n            <span className=\"text-blue-500\">â€¢</span>\n            <p>\n              {t(\n                \"æ¯æ—¥æ–°ã—ã„ä½œå“ãŒæŠ•ç¨¿ã•ã‚Œã‚‹ã®ã§ã€ãœã²å®šæœŸçš„ã«ãƒã‚§ãƒƒã‚¯ã—ã¦ã¿ã¦ãã ã•ã„\",\n                \"New works are posted daily, so check back regularly for fresh content\",\n              )}\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* è¨­å®šå¤‰æ›´ãƒœã‚¿ãƒ³ */}\n      <div className=\"text-center\">\n        <Button\n          variant=\"outline\"\n          onClick={() => navigate(\"/settings\")}\n          className=\"text-gray-600 dark:text-gray-300\"\n        >\n          {t(\"è¨­å®šã‚’å¤‰æ›´ã™ã‚‹\", \"Change Settings\")}\n        </Button>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/useSemanticElements","severity":"error","description":"The elements with this role can be changed to the following elements:\n<button>","message":[{"elements":[],"content":"The elements with this role can be changed to the following elements:\n<button>"}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"For examples and more information, see "},{"elements":[{"Hyperlink":{"href":"https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles"}}],"content":"WAI-ARIA Roles"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.settings.completed._index/components/new-settings-completed.tsx"},"span":[6659,6672],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { useNavigate } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { Sparkles, Palette, Users, Star } from \"lucide-react\"\n\n/**\n * æ–°ã—ã„è¨­å®šå®Œäº†ãƒšãƒ¼ã‚¸\n */\nexport function NewSettingsCompleted () {\n  const navigate = useNavigate()\n  const t = useTranslation()\n\n  return (\n    <div className=\"mx-auto max-w-4xl space-y-8 p-6\">\n      {/* å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */}\n      <div className=\"rounded-xl border border-green-200 bg-gradient-to-r from-green-50 to-blue-50 p-8 text-center dark:border-green-600 dark:from-green-900/30 dark:to-blue-900/30\">\n        <div className=\"mb-6 text-6xl\">ğŸ‰</div>\n        <h1 className=\"mb-4 font-bold text-3xl text-gray-800 dark:text-gray-100\">\n          {t(\n            \"è¨­å®šå®Œäº†ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼\",\n            \"Congratulations! Setup Complete!\",\n          )}\n        </h1>\n        <p className=\"mb-2 text-gray-600 text-lg dark:text-gray-300\">\n          {t(\"Aipictorsã¸ã‚ˆã†ã“ãï¼\", \"Welcome to Aipictors!\")}\n        </p>\n        <p className=\"text-gray-600 dark:text-gray-300\">\n          {t(\n            \"ã“ã‚Œã§ã‚ãªãŸã‚‚AIã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã®ä»²é–“å…¥ã‚Šã§ã™\",\n            \"You are now part of the AI creator community\",\n          )}\n        </p>\n      </div>\n\n      {/* æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ— */}\n      <div className=\"rounded-xl border border-gray-200 bg-white p-6 dark:border-gray-700 dark:bg-gray-800\">\n        <h2 className=\"mb-6 text-center font-bold text-gray-800 text-xl dark:text-gray-100\">\n          {t(\"ã•ã‚ã€ä½•ã‹ã‚‰å§‹ã‚ã¾ã™ã‹ï¼Ÿ\", \"What would you like to do first?\")}\n        </h2>\n\n        <div className=\"grid gap-6 md:grid-cols-2\">\n          {/* AIç”Ÿæˆ */}\n          <div\n            role=\"button\"\n            tabIndex={0}\n            className=\"group cursor-pointer rounded-lg border border-purple-200 bg-purple-50 p-6 transition-all hover:border-purple-300 hover:bg-purple-100 dark:border-purple-600 dark:bg-purple-900/30 dark:hover:border-purple-500 dark:hover:bg-purple-900/50\"\n            onClick={() => navigate(\"/generation\")}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault()\n                navigate(\"/generation\")\n              }\n            }}\n          >\n            <div className=\"flex items-start gap-4\">\n              <div className=\"rounded-full bg-purple-500 p-3\">\n                <Sparkles className=\"size-6 text-white\" />\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"mb-2 font-bold text-gray-800 dark:text-gray-100\">\n                  {t(\"AIç”»åƒã‚’ç”Ÿæˆã—ã¦ã¿ã‚‹\", \"Try AI Image Generation\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm dark:text-gray-300\">\n                  {t(\n                    \"ç„¡æ–™ã§AIç”»åƒã‚’ç”Ÿæˆã§ãã¾ã™ã€‚ã¾ãšã¯ç°¡å˜ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‹ã‚‰å§‹ã‚ã¦ã¿ã¾ã—ã‚‡ã†\",\n                    \"Generate AI images for free. Start with simple prompts\",\n                  )}\n                </p>\n                <div className=\"mt-3\">\n                  <Button className=\"group-hover:bg-purple-600\">\n                    {t(\"ç”Ÿæˆã‚’å§‹ã‚ã‚‹\", \"Start Generating\")}\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* ä½œå“æŠ•ç¨¿ */}\n          <div\n            role=\"button\"\n            tabIndex={0}\n            className=\"group cursor-pointer rounded-lg border border-blue-200 bg-blue-50 p-6 transition-all hover:border-blue-300 hover:bg-blue-100 dark:border-blue-600 dark:bg-blue-900/30 dark:hover:border-blue-500 dark:hover:bg-blue-900/50\"\n            onClick={() => navigate(\"/new/image\")}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault()\n                navigate(\"/new/image\")\n              }\n            }}\n          >\n            <div className=\"flex items-start gap-4\">\n              <div className=\"rounded-full bg-blue-500 p-3\">\n                <Palette className=\"size-6 text-white\" />\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"mb-2 font-bold text-gray-800 dark:text-gray-100\">\n                  {t(\"ä½œå“ã‚’æŠ•ç¨¿ã—ã¦ã¿ã‚‹\", \"Try Posting Your Work\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm dark:text-gray-300\">\n                  {t(\n                    \"ã‚ãªãŸã®ä½œå“ã‚’æŠ•ç¨¿ã—ã¦ã€ãŸãã•ã‚“ã®äººã«è¦‹ã¦ã‚‚ã‚‰ã„ã¾ã—ã‚‡ã†\",\n                    \"Post your work and share it with many people\",\n                  )}\n                </p>\n                <div className=\"mt-3\">\n                  <Button className=\"group-hover:bg-blue-600\">\n                    {t(\"æŠ•ç¨¿ã™ã‚‹\", \"Post Work\")}\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* ä½œå“ã‚’æ¥½ã—ã‚€ */}\n          <div\n            role=\"button\"\n            tabIndex={0}\n            className=\"group cursor-pointer rounded-lg border border-green-200 bg-green-50 p-6 transition-all hover:border-green-300 hover:bg-green-100 dark:border-green-600 dark:bg-green-900/30 dark:hover:border-green-500 dark:hover:bg-green-900/50\"\n            onClick={() => navigate(\"/\")}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault()\n                navigate(\"/\")\n              }\n            }}\n          >\n            <div className=\"flex items-start gap-4\">\n              <div className=\"rounded-full bg-green-500 p-3\">\n                <Star className=\"size-6 text-white\" />\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"mb-2 font-bold text-gray-800 dark:text-gray-100\">\n                  {t(\"ã¿ã‚“ãªã®ä½œå“ã‚’æ¥½ã—ã‚€\", \"Enjoy Everyone's Works\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm dark:text-gray-300\">\n                  {t(\n                    \"ç´ æ™´ã‚‰ã—ã„AIä½œå“ãŒãŸãã•ã‚“æŠ•ç¨¿ã•ã‚Œã¦ã„ã¾ã™ã€‚ã„ã„ã­ã‚„ã‚³ãƒ¡ãƒ³ãƒˆã§äº¤æµã—ã¾ã—ã‚‡ã†\",\n                    \"Browse amazing AI works and interact with likes and comments\",\n                  )}\n                </p>\n                <div className=\"mt-3\">\n                  <Button className=\"group-hover:bg-green-600\">\n                    {t(\"ä½œå“ã‚’è¦‹ã‚‹\", \"Browse Works\")}\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ */}\n          <div\n            role=\"button\"\n            tabIndex={0}\n            className=\"group cursor-pointer rounded-lg border border-orange-200 bg-orange-50 p-6 transition-all hover:border-orange-300 hover:bg-orange-100 dark:border-orange-600 dark:bg-orange-900/30 dark:hover:border-orange-500 dark:hover:bg-orange-900/50\"\n            onClick={() => navigate(\"/users\")}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault()\n                navigate(\"/users\")\n              }\n            }}\n          >\n            <div className=\"flex items-start gap-4\">\n              <div className=\"rounded-full bg-orange-500 p-3\">\n                <Users className=\"size-6 text-white\" />\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"mb-2 font-bold text-gray-800 dark:text-gray-100\">\n                  {t(\"ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã‚’æ¢ã™\", \"Discover Creators\")}\n                </h3>\n                <p className=\"text-gray-600 text-sm dark:text-gray-300\">\n                  {t(\n                    \"ãŠæ°—ã«å…¥ã‚Šã®ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ã€æ–°ã—ã„ä½œå“ã‚’ã„ã¡æ—©ããƒã‚§ãƒƒã‚¯ã—ã¾ã—ã‚‡ã†\",\n                    \"Follow your favorite creators and stay updated with their latest works\",\n                  )}\n                </p>\n                <div className=\"mt-3\">\n                  <Button className=\"group-hover:bg-orange-600\">\n                    {t(\"æ¢ã—ã¦ã¿ã‚‹\", \"Explore\")}\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* ãƒ’ãƒ³ãƒˆ */}\n      <div className=\"rounded-xl border border-blue-200 bg-blue-50 p-6 dark:border-blue-600 dark:bg-blue-900/30\">\n        <h3 className=\"mb-4 font-bold text-gray-800 dark:text-gray-100\">\n          {t(\"ğŸ’¡ ã¯ã˜ã‚ã¦ã®Aipictors\", \"ğŸ’¡ Getting Started Tips\")}\n        </h3>\n        <div className=\"space-y-3 text-gray-700 text-sm dark:text-gray-300\">\n          <div className=\"flex items-start gap-2\">\n            <span className=\"text-blue-500\">â€¢</span>\n            <p>\n              {t(\n                \"è¨­å®šã¯ã„ã¤ã§ã‚‚å³ä¸Šã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰å¤‰æ›´ã§ãã¾ã™\",\n                \"You can change settings anytime from the menu in the top right\",\n              )}\n            </p>\n          </div>\n          <div className=\"flex items-start gap-2\">\n            <span className=\"text-blue-500\">â€¢</span>\n            <p>\n              {t(\n                \"å›°ã£ãŸæ™‚ã¯ç”»é¢ä¸‹éƒ¨ã®ãƒ˜ãƒ«ãƒ—ã‚„ãŠå•ã„åˆã‚ã›ã‚’ã”åˆ©ç”¨ãã ã•ã„\",\n                \"If you need help, check the help section or contact us at the bottom of the page\",\n              )}\n            </p>\n          </div>\n          <div className=\"flex items-start gap-2\">\n            <span className=\"text-blue-500\">â€¢</span>\n            <p>\n              {t(\n                \"æ¯æ—¥æ–°ã—ã„ä½œå“ãŒæŠ•ç¨¿ã•ã‚Œã‚‹ã®ã§ã€ãœã²å®šæœŸçš„ã«ãƒã‚§ãƒƒã‚¯ã—ã¦ã¿ã¦ãã ã•ã„\",\n                \"New works are posted daily, so check back regularly for fresh content\",\n              )}\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* è¨­å®šå¤‰æ›´ãƒœã‚¿ãƒ³ */}\n      <div className=\"text-center\">\n        <Button\n          variant=\"outline\"\n          onClick={() => navigate(\"/settings\")}\n          className=\"text-gray-600 dark:text-gray-300\"\n        >\n          {t(\"è¨­å®šã‚’å¤‰æ›´ã™ã‚‹\", \"Change Settings\")}\n        </Button>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/suspicious/noArrayIndexKey","severity":"error","description":"Avoid using the index of an array as key property in an element.","message":[{"elements":[],"content":"Avoid using the index of an array as key property in an element."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"This is the source of the key value."}]]},{"frame":{"path":null,"span":[4052,4057],"sourceCode":"import text from \"~/assets/specified-commercial-transaction-act.md?raw\"\nimport { AppMarkdown } from \"~/components/app/app-markdown\"\nimport {\n  Table,\n  TableBody,\n  TableCaption,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"~/components/ui/table\"\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"~/components/ui/card\"\nimport { Badge } from \"~/components/ui/badge\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { useLoaderData } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { config, META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { BuildingIcon, InfoIcon, FileTextIcon } from \"lucide-react\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(\n    META.SPECIFIED_COMMERCIAL_TRANSACTION,\n    undefined,\n    props.params.lang,\n  )\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneMonth,\n})\n\nexport async function loader (_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const company = [\n    {\n      title: \"å•†å·\",\n      content: \"Aipictorsæ ªå¼ä¼šç¤¾\",\n      enContent: \"AIPICTORS K.K.\",\n    },\n    {\n      title: \"ä½æ‰€\",\n      content: \"å¤§é˜ªåºœå¤§é˜ªå¸‚åŒ—åŒºæ¢…ç”°ï¼‘ä¸ç›®ï¼’ç•ªï¼’å·å¤§é˜ªé§…å‰ç¬¬ï¼’ãƒ“ãƒ«ï¼‘ï¼’ï¼ï¼‘ï¼’\",\n      enContent: \"1-2-2 Osaka Station Building 2 12-12 Umeda Kita-ku\",\n    },\n    {\n      title: \"ä»£è¡¨å–ç· å½¹\",\n      content: \"ä¸­å¡šå­£åˆ©äºº\",\n      enContent: \"KIRITO NAKATSUKA\",\n    },\n  ]\n\n  return {\n    text,\n    company,\n  }\n}\n\nexport default function SpecifiedCommercialTransactionActPage () {\n  const data = useLoaderData<typeof loader>()\n\n  const t = useTranslation()\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <div className=\"mx-auto max-w-4xl space-y-8 px-4 py-8\">\n      {/* ãƒ˜ãƒƒãƒ€ãƒ¼ */}\n      <div className=\"space-y-4 text-center\">\n        <div className=\"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-purple-100 dark:bg-purple-900\">\n          <FileTextIcon className=\"h-8 w-8 text-purple-600 dark:text-purple-400\" />\n        </div>\n        <h1 className=\"font-bold text-3xl tracking-tight\">\n          {t(\n            \"ç‰¹å®šå•†å–å¼•æ³•ã«åŸºã¥ãè¡¨è¨˜\",\n            \"Specified Commercial Transaction Act\",\n          )}\n        </h1>\n        <p className=\"text-lg text-muted-foreground\">\n          {t(\n            \"ç‰¹å®šå•†å–å¼•ã«é–¢ã™ã‚‹æ³•å¾‹ã«åŸºã¥ãã€è²©å£²è€…ã®æƒ…å ±ã‚’è¨˜è¼‰ã—ã¦ã„ã¾ã™\",\n            \"Information about the seller based on the Specified Commercial Transaction Act\",\n          )}\n        </p>\n      </div>\n\n      {/* ä¼šç¤¾æƒ…å ± */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center space-x-2\">\n            <BuildingIcon className=\"h-5 w-5 text-blue-600 dark:text-blue-400\" />\n            <CardTitle className=\"text-xl\">\n              {t(\"ä¼šç¤¾æƒ…å ±\", \"Company Information\")}\n            </CardTitle>\n          </div>\n          <CardDescription>\n            {t(\n              \"Aipictorsã‚’é‹å–¶ã™ã‚‹ä¼šç¤¾ã®åŸºæœ¬æƒ…å ±ã§ã™\",\n              \"Basic information about the company that operates Aipictors\",\n            )}\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"overflow-x-auto\">\n            <Table>\n              <TableCaption>\n                {t(\"ä¼šç¤¾æƒ…å ±\", \"Company Information\")}\n              </TableCaption>\n              <TableHeader>\n                <TableRow>\n                  <TableHead className=\"w-[96px]\">\n                    {t(\"é …ç›®\", \"Item\")}\n                  </TableHead>\n                  <TableHead>{t(\"æ—¥æœ¬èª\", \"Japanese\")}</TableHead>\n                  <TableHead>{t(\"English\", \"English\")}</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {data.company.map((item, index) => (\n                  <TableRow key={index}>\n                    <TableCell className=\"font-medium\">{item.title}</TableCell>\n                    <TableCell>{item.content}</TableCell>\n                    <TableCell className=\"text-muted-foreground\">\n                      {item.enContent}\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* äº‹æ¥­å†…å®¹ */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center space-x-2\">\n            <InfoIcon className=\"h-5 w-5 text-green-600 dark:text-green-400\" />\n            <span>{t(\"äº‹æ¥­å†…å®¹\", \"Business Description\")}</span>\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div>\n            <div className=\"mb-2 flex items-center space-x-2\">\n              <Badge variant=\"secondary\">\n                {t(\"ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ \", \"Content Platform\")}\n              </Badge>\n            </div>\n            <p className=\"text-muted-foreground leading-relaxed\">\n              {t(\n                \"ã€ŒAipictorsã€ AIã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«å‡ºä¼šãˆã‚‹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚æ–°ã—ã„ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã€ãƒ¦ãƒ¼ã‚¶ã¨ã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ”¯ãˆã¾ã™ã€‚\",\n                \"We provide a platform where you can discover AI-generated content with Aipictors, supporting communication with new creators and users.\",\n              )}\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* ç‰¹å®šå•†å–å¼•æ³•è¡¨è¨˜ */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"text-xl\">\n            {t(\n              \"ç‰¹å®šå•†å–å¼•æ³•ã«åŸºã¥ãè¡¨è¨˜\",\n              \"Specified Commercial Transaction Act Details\",\n            )}\n          </CardTitle>\n          <CardDescription>\n            {t(\n              \"è²©å£²æ¡ä»¶ã€æ”¯æ‰•ã„æ–¹æ³•ã€è¿”å“ãƒ»äº¤æ›ç­‰ã«é–¢ã™ã‚‹è©³ç´°æƒ…å ±\",\n              \"Detailed information about sales conditions, payment methods, returns and exchanges\",\n            )}\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"prose prose-slate dark:prose-invert max-w-none\">\n            <AppMarkdown className=\"leading-relaxed\">{data.text}</AppMarkdown>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* ãƒ•ãƒƒã‚¿ãƒ¼æƒ…å ± */}\n      <div className=\"space-y-2 border-t pt-8 text-center\">\n        <p className=\"text-muted-foreground text-sm\">\n          {t(\n            \"ã“ã®è¡¨è¨˜ã«ã¤ã„ã¦ã”è³ªå•ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠå•ã„åˆã‚ã›ãã ã•ã„\",\n            \"If you have any questions about this information, please contact us\",\n          )}\n        </p>\n        <p className=\"text-muted-foreground text-xs\">\n          {t(\"æœ€çµ‚æ›´æ–°: 2024å¹´12æœˆ\", \"Last updated: December 2024\")}\n        </p>\n      </div>\n    </div>\n  )\n}\n"}},{"log":["info",[{"elements":[],"content":"The order of the items may change, and this also affects performances and component state."}]]},{"log":["info",[{"elements":[],"content":"Check the "},{"elements":[{"Hyperlink":{"href":"https://reactjs.org/docs/lists-and-keys.html#keys"}}],"content":"React documentation"},{"elements":[],"content":". "}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.specified-commercial-transaction-act/route-backup.tsx"},"span":[4097,4102],"sourceCode":"import text from \"~/assets/specified-commercial-transaction-act.md?raw\"\nimport { AppMarkdown } from \"~/components/app/app-markdown\"\nimport {\n  Table,\n  TableBody,\n  TableCaption,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"~/components/ui/table\"\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"~/components/ui/card\"\nimport { Badge } from \"~/components/ui/badge\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { useLoaderData } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { config, META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { BuildingIcon, InfoIcon, FileTextIcon } from \"lucide-react\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(\n    META.SPECIFIED_COMMERCIAL_TRANSACTION,\n    undefined,\n    props.params.lang,\n  )\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneMonth,\n})\n\nexport async function loader (_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const company = [\n    {\n      title: \"å•†å·\",\n      content: \"Aipictorsæ ªå¼ä¼šç¤¾\",\n      enContent: \"AIPICTORS K.K.\",\n    },\n    {\n      title: \"ä½æ‰€\",\n      content: \"å¤§é˜ªåºœå¤§é˜ªå¸‚åŒ—åŒºæ¢…ç”°ï¼‘ä¸ç›®ï¼’ç•ªï¼’å·å¤§é˜ªé§…å‰ç¬¬ï¼’ãƒ“ãƒ«ï¼‘ï¼’ï¼ï¼‘ï¼’\",\n      enContent: \"1-2-2 Osaka Station Building 2 12-12 Umeda Kita-ku\",\n    },\n    {\n      title: \"ä»£è¡¨å–ç· å½¹\",\n      content: \"ä¸­å¡šå­£åˆ©äºº\",\n      enContent: \"KIRITO NAKATSUKA\",\n    },\n  ]\n\n  return {\n    text,\n    company,\n  }\n}\n\nexport default function SpecifiedCommercialTransactionActPage () {\n  const data = useLoaderData<typeof loader>()\n\n  const t = useTranslation()\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <div className=\"mx-auto max-w-4xl space-y-8 px-4 py-8\">\n      {/* ãƒ˜ãƒƒãƒ€ãƒ¼ */}\n      <div className=\"space-y-4 text-center\">\n        <div className=\"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-purple-100 dark:bg-purple-900\">\n          <FileTextIcon className=\"h-8 w-8 text-purple-600 dark:text-purple-400\" />\n        </div>\n        <h1 className=\"font-bold text-3xl tracking-tight\">\n          {t(\n            \"ç‰¹å®šå•†å–å¼•æ³•ã«åŸºã¥ãè¡¨è¨˜\",\n            \"Specified Commercial Transaction Act\",\n          )}\n        </h1>\n        <p className=\"text-lg text-muted-foreground\">\n          {t(\n            \"ç‰¹å®šå•†å–å¼•ã«é–¢ã™ã‚‹æ³•å¾‹ã«åŸºã¥ãã€è²©å£²è€…ã®æƒ…å ±ã‚’è¨˜è¼‰ã—ã¦ã„ã¾ã™\",\n            \"Information about the seller based on the Specified Commercial Transaction Act\",\n          )}\n        </p>\n      </div>\n\n      {/* ä¼šç¤¾æƒ…å ± */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center space-x-2\">\n            <BuildingIcon className=\"h-5 w-5 text-blue-600 dark:text-blue-400\" />\n            <CardTitle className=\"text-xl\">\n              {t(\"ä¼šç¤¾æƒ…å ±\", \"Company Information\")}\n            </CardTitle>\n          </div>\n          <CardDescription>\n            {t(\n              \"Aipictorsã‚’é‹å–¶ã™ã‚‹ä¼šç¤¾ã®åŸºæœ¬æƒ…å ±ã§ã™\",\n              \"Basic information about the company that operates Aipictors\",\n            )}\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"overflow-x-auto\">\n            <Table>\n              <TableCaption>\n                {t(\"ä¼šç¤¾æƒ…å ±\", \"Company Information\")}\n              </TableCaption>\n              <TableHeader>\n                <TableRow>\n                  <TableHead className=\"w-[96px]\">\n                    {t(\"é …ç›®\", \"Item\")}\n                  </TableHead>\n                  <TableHead>{t(\"æ—¥æœ¬èª\", \"Japanese\")}</TableHead>\n                  <TableHead>{t(\"English\", \"English\")}</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {data.company.map((item, index) => (\n                  <TableRow key={index}>\n                    <TableCell className=\"font-medium\">{item.title}</TableCell>\n                    <TableCell>{item.content}</TableCell>\n                    <TableCell className=\"text-muted-foreground\">\n                      {item.enContent}\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* äº‹æ¥­å†…å®¹ */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center space-x-2\">\n            <InfoIcon className=\"h-5 w-5 text-green-600 dark:text-green-400\" />\n            <span>{t(\"äº‹æ¥­å†…å®¹\", \"Business Description\")}</span>\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div>\n            <div className=\"mb-2 flex items-center space-x-2\">\n              <Badge variant=\"secondary\">\n                {t(\"ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ \", \"Content Platform\")}\n              </Badge>\n            </div>\n            <p className=\"text-muted-foreground leading-relaxed\">\n              {t(\n                \"ã€ŒAipictorsã€ AIã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«å‡ºä¼šãˆã‚‹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚æ–°ã—ã„ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã€ãƒ¦ãƒ¼ã‚¶ã¨ã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ”¯ãˆã¾ã™ã€‚\",\n                \"We provide a platform where you can discover AI-generated content with Aipictors, supporting communication with new creators and users.\",\n              )}\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* ç‰¹å®šå•†å–å¼•æ³•è¡¨è¨˜ */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"text-xl\">\n            {t(\n              \"ç‰¹å®šå•†å–å¼•æ³•ã«åŸºã¥ãè¡¨è¨˜\",\n              \"Specified Commercial Transaction Act Details\",\n            )}\n          </CardTitle>\n          <CardDescription>\n            {t(\n              \"è²©å£²æ¡ä»¶ã€æ”¯æ‰•ã„æ–¹æ³•ã€è¿”å“ãƒ»äº¤æ›ç­‰ã«é–¢ã™ã‚‹è©³ç´°æƒ…å ±\",\n              \"Detailed information about sales conditions, payment methods, returns and exchanges\",\n            )}\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"prose prose-slate dark:prose-invert max-w-none\">\n            <AppMarkdown className=\"leading-relaxed\">{data.text}</AppMarkdown>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* ãƒ•ãƒƒã‚¿ãƒ¼æƒ…å ± */}\n      <div className=\"space-y-2 border-t pt-8 text-center\">\n        <p className=\"text-muted-foreground text-sm\">\n          {t(\n            \"ã“ã®è¡¨è¨˜ã«ã¤ã„ã¦ã”è³ªå•ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠå•ã„åˆã‚ã›ãã ã•ã„\",\n            \"If you have any questions about this information, please contact us\",\n          )}\n        </p>\n        <p className=\"text-muted-foreground text-xs\">\n          {t(\"æœ€çµ‚æ›´æ–°: 2024å¹´12æœˆ\", \"Last updated: December 2024\")}\n        </p>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/suspicious/noArrayIndexKey","severity":"error","description":"Avoid using the index of an array as key property in an element.","message":[{"elements":[],"content":"Avoid using the index of an array as key property in an element."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"This is the source of the key value."}]]},{"frame":{"path":null,"span":[3892,3901],"sourceCode":"import text from \"~/assets/specified-commercial-transaction-act.md?raw\"\nimport { AppMarkdown } from \"~/components/app/app-markdown\"\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"~/components/ui/table\"\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"~/components/ui/card\"\nimport { Badge } from \"~/components/ui/badge\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { useLoaderData } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { config, META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { BuildingIcon, InfoIcon, FileTextIcon } from \"lucide-react\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(\n    META.SPECIFIED_COMMERCIAL_TRANSACTION,\n    undefined,\n    props.params.lang,\n  )\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneMonth,\n})\n\nexport async function loader (_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const company = [\n    {\n      title: \"å•†å·\",\n      content: \"Aipictorsæ ªå¼ä¼šç¤¾\",\n      enContent: \"AIPICTORS K.K.\",\n    },\n    {\n      title: \"ä½æ‰€\",\n      content: \"å¤§é˜ªåºœå¤§é˜ªå¸‚åŒ—åŒºæ¢…ç”°ï¼‘ä¸ç›®ï¼’ç•ªï¼’å·å¤§é˜ªé§…å‰ç¬¬ï¼’ãƒ“ãƒ«ï¼‘ï¼’ï¼ï¼‘ï¼’\",\n      enContent: \"1-2-2 Osaka Station Building 2 12-12 Umeda Kita-ku\",\n    },\n    {\n      title: \"ä»£è¡¨å–ç· å½¹\",\n      content: \"ä¸­å¡šå­£åˆ©äºº\",\n      enContent: \"KIRITO NAKATSUKA\",\n    },\n  ]\n\n  return {\n    text,\n    company,\n  }\n}\n\nexport default function SpecifiedCommercialTransactionActPage () {\n  const data = useLoaderData<typeof loader>()\n\n  const t = useTranslation()\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <div className=\"mx-auto max-w-4xl space-y-8 px-4 py-8\">\n      {/* ãƒ˜ãƒƒãƒ€ãƒ¼ */}\n      <div className=\"space-y-4 text-center\">\n        <div className=\"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-purple-100 dark:bg-purple-900\">\n          <FileTextIcon className=\"h-8 w-8 text-purple-600 dark:text-purple-400\" />\n        </div>\n        <h1 className=\"font-bold text-3xl tracking-tight\">\n          {t(\n            \"ç‰¹å®šå•†å–å¼•æ³•ã«åŸºã¥ãè¡¨è¨˜\",\n            \"Specified Commercial Transaction Act\",\n          )}\n        </h1>\n        <p className=\"text-muted-foreground\">\n          {t(\n            \"æ³•çš„ã«å¿…è¦ãªå–å¼•æƒ…å ±ã¨ä¼šç¤¾æ¦‚è¦ã‚’ã”ç¢ºèªã„ãŸã ã‘ã¾ã™\",\n            \"You can check legally required transaction information and company overview\",\n          )}\n        </p>\n      </div>\n\n      {/* ä¼šç¤¾æƒ…å ± */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center space-x-2\">\n            <BuildingIcon className=\"h-5 w-5 text-blue-600 dark:text-blue-400\" />\n            <CardTitle className=\"text-xl\">\n              {t(\"ä¼šç¤¾æƒ…å ±\", \"Company Information\")}\n            </CardTitle>\n          </div>\n          <CardDescription>\n            {t(\n              \"Aipictorsã‚’é‹å–¶ã™ã‚‹ä¼šç¤¾ã®åŸºæœ¬æƒ…å ±ã§ã™\",\n              \"Basic information about the company that operates Aipictors\",\n            )}\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"overflow-x-auto\">\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead className=\"w-[96px]\">\n                    {t(\"é …ç›®\", \"Item\")}\n                  </TableHead>\n                  <TableHead>{t(\"æ—¥æœ¬èª\", \"Japanese\")}</TableHead>\n                  <TableHead>{t(\"English\", \"English\")}</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {data.company.map((item, itemIndex) => (\n                  <TableRow key={`company-${itemIndex}`}>\n                    <TableCell className=\"font-medium\">{item.title}</TableCell>\n                    <TableCell>{item.content}</TableCell>\n                    <TableCell className=\"text-muted-foreground\">\n                      {item.enContent}\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* äº‹æ¥­å†…å®¹ */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center space-x-2\">\n            <InfoIcon className=\"h-5 w-5 text-green-600 dark:text-green-400\" />\n            <span>{t(\"äº‹æ¥­å†…å®¹\", \"Business Description\")}</span>\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div>\n            <div className=\"mb-2 flex items-center space-x-2\">\n              <Badge variant=\"secondary\">\n                {t(\"ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ \", \"Content Platform\")}\n              </Badge>\n            </div>\n            <p className=\"text-muted-foreground leading-relaxed\">\n              {t(\n                \"ã€ŒAipictorsã€ AIã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«å‡ºä¼šãˆã‚‹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚æ–°ã—ã„ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã€ãƒ¦ãƒ¼ã‚¶ã¨ã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ”¯ãˆã¾ã™ã€‚\",\n                \"We provide a platform where you can discover AI-generated content with Aipictors, supporting communication with new creators and users.\",\n              )}\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* ç‰¹å®šå•†å–å¼•æ³•è¡¨è¨˜ */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"text-xl\">\n            {t(\n              \"ç‰¹å®šå•†å–å¼•æ³•ã«åŸºã¥ãè¡¨è¨˜\",\n              \"Specified Commercial Transaction Act Details\",\n            )}\n          </CardTitle>\n          <CardDescription>\n            {t(\n              \"è²©å£²æ¡ä»¶ã€æ”¯æ‰•ã„æ–¹æ³•ã€è¿”å“ãƒ»äº¤æ›ç­‰ã«é–¢ã™ã‚‹è©³ç´°æƒ…å ±\",\n              \"Detailed information about sales conditions, payment methods, returns and exchanges\",\n            )}\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"prose prose-slate dark:prose-invert max-w-none\">\n            <AppMarkdown className=\"leading-relaxed\">{data.text}</AppMarkdown>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* ãƒ•ãƒƒã‚¿ãƒ¼æƒ…å ± */}\n      <div className=\"space-y-2 border-t pt-8 text-center\">\n        <p className=\"text-muted-foreground text-sm\">\n          {t(\n            \"ã“ã®è¡¨è¨˜ã«ã¤ã„ã¦ã”è³ªå•ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠå•ã„åˆã‚ã›ãã ã•ã„\",\n            \"If you have any questions about this information, please contact us\",\n          )}\n        </p>\n        <p className=\"text-muted-foreground text-xs\">\n          {t(\"æœ€çµ‚æ›´æ–°: 2024å¹´12æœˆ\", \"Last updated: December 2024\")}\n        </p>\n      </div>\n    </div>\n  )\n}\n"}},{"log":["info",[{"elements":[],"content":"The order of the items may change, and this also affects performances and component state."}]]},{"log":["info",[{"elements":[],"content":"Check the "},{"elements":[{"Hyperlink":{"href":"https://reactjs.org/docs/lists-and-keys.html#keys"}}],"content":"React documentation"},{"elements":[],"content":". "}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.specified-commercial-transaction-act/route-new.tsx"},"span":[3952,3961],"sourceCode":"import text from \"~/assets/specified-commercial-transaction-act.md?raw\"\nimport { AppMarkdown } from \"~/components/app/app-markdown\"\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"~/components/ui/table\"\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"~/components/ui/card\"\nimport { Badge } from \"~/components/ui/badge\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { useLoaderData } from \"@remix-run/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { config, META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { BuildingIcon, InfoIcon, FileTextIcon } from \"lucide-react\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(\n    META.SPECIFIED_COMMERCIAL_TRANSACTION,\n    undefined,\n    props.params.lang,\n  )\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneMonth,\n})\n\nexport async function loader (_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const company = [\n    {\n      title: \"å•†å·\",\n      content: \"Aipictorsæ ªå¼ä¼šç¤¾\",\n      enContent: \"AIPICTORS K.K.\",\n    },\n    {\n      title: \"ä½æ‰€\",\n      content: \"å¤§é˜ªåºœå¤§é˜ªå¸‚åŒ—åŒºæ¢…ç”°ï¼‘ä¸ç›®ï¼’ç•ªï¼’å·å¤§é˜ªé§…å‰ç¬¬ï¼’ãƒ“ãƒ«ï¼‘ï¼’ï¼ï¼‘ï¼’\",\n      enContent: \"1-2-2 Osaka Station Building 2 12-12 Umeda Kita-ku\",\n    },\n    {\n      title: \"ä»£è¡¨å–ç· å½¹\",\n      content: \"ä¸­å¡šå­£åˆ©äºº\",\n      enContent: \"KIRITO NAKATSUKA\",\n    },\n  ]\n\n  return {\n    text,\n    company,\n  }\n}\n\nexport default function SpecifiedCommercialTransactionActPage () {\n  const data = useLoaderData<typeof loader>()\n\n  const t = useTranslation()\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <div className=\"mx-auto max-w-4xl space-y-8 px-4 py-8\">\n      {/* ãƒ˜ãƒƒãƒ€ãƒ¼ */}\n      <div className=\"space-y-4 text-center\">\n        <div className=\"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-purple-100 dark:bg-purple-900\">\n          <FileTextIcon className=\"h-8 w-8 text-purple-600 dark:text-purple-400\" />\n        </div>\n        <h1 className=\"font-bold text-3xl tracking-tight\">\n          {t(\n            \"ç‰¹å®šå•†å–å¼•æ³•ã«åŸºã¥ãè¡¨è¨˜\",\n            \"Specified Commercial Transaction Act\",\n          )}\n        </h1>\n        <p className=\"text-muted-foreground\">\n          {t(\n            \"æ³•çš„ã«å¿…è¦ãªå–å¼•æƒ…å ±ã¨ä¼šç¤¾æ¦‚è¦ã‚’ã”ç¢ºèªã„ãŸã ã‘ã¾ã™\",\n            \"You can check legally required transaction information and company overview\",\n          )}\n        </p>\n      </div>\n\n      {/* ä¼šç¤¾æƒ…å ± */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center space-x-2\">\n            <BuildingIcon className=\"h-5 w-5 text-blue-600 dark:text-blue-400\" />\n            <CardTitle className=\"text-xl\">\n              {t(\"ä¼šç¤¾æƒ…å ±\", \"Company Information\")}\n            </CardTitle>\n          </div>\n          <CardDescription>\n            {t(\n              \"Aipictorsã‚’é‹å–¶ã™ã‚‹ä¼šç¤¾ã®åŸºæœ¬æƒ…å ±ã§ã™\",\n              \"Basic information about the company that operates Aipictors\",\n            )}\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"overflow-x-auto\">\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead className=\"w-[96px]\">\n                    {t(\"é …ç›®\", \"Item\")}\n                  </TableHead>\n                  <TableHead>{t(\"æ—¥æœ¬èª\", \"Japanese\")}</TableHead>\n                  <TableHead>{t(\"English\", \"English\")}</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {data.company.map((item, itemIndex) => (\n                  <TableRow key={`company-${itemIndex}`}>\n                    <TableCell className=\"font-medium\">{item.title}</TableCell>\n                    <TableCell>{item.content}</TableCell>\n                    <TableCell className=\"text-muted-foreground\">\n                      {item.enContent}\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* äº‹æ¥­å†…å®¹ */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center space-x-2\">\n            <InfoIcon className=\"h-5 w-5 text-green-600 dark:text-green-400\" />\n            <span>{t(\"äº‹æ¥­å†…å®¹\", \"Business Description\")}</span>\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div>\n            <div className=\"mb-2 flex items-center space-x-2\">\n              <Badge variant=\"secondary\">\n                {t(\"ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ \", \"Content Platform\")}\n              </Badge>\n            </div>\n            <p className=\"text-muted-foreground leading-relaxed\">\n              {t(\n                \"ã€ŒAipictorsã€ AIã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«å‡ºä¼šãˆã‚‹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚æ–°ã—ã„ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã€ãƒ¦ãƒ¼ã‚¶ã¨ã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ”¯ãˆã¾ã™ã€‚\",\n                \"We provide a platform where you can discover AI-generated content with Aipictors, supporting communication with new creators and users.\",\n              )}\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* ç‰¹å®šå•†å–å¼•æ³•è¡¨è¨˜ */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"text-xl\">\n            {t(\n              \"ç‰¹å®šå•†å–å¼•æ³•ã«åŸºã¥ãè¡¨è¨˜\",\n              \"Specified Commercial Transaction Act Details\",\n            )}\n          </CardTitle>\n          <CardDescription>\n            {t(\n              \"è²©å£²æ¡ä»¶ã€æ”¯æ‰•ã„æ–¹æ³•ã€è¿”å“ãƒ»äº¤æ›ç­‰ã«é–¢ã™ã‚‹è©³ç´°æƒ…å ±\",\n              \"Detailed information about sales conditions, payment methods, returns and exchanges\",\n            )}\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"prose prose-slate dark:prose-invert max-w-none\">\n            <AppMarkdown className=\"leading-relaxed\">{data.text}</AppMarkdown>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* ãƒ•ãƒƒã‚¿ãƒ¼æƒ…å ± */}\n      <div className=\"space-y-2 border-t pt-8 text-center\">\n        <p className=\"text-muted-foreground text-sm\">\n          {t(\n            \"ã“ã®è¡¨è¨˜ã«ã¤ã„ã¦ã”è³ªå•ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠå•ã„åˆã‚ã›ãã ã•ã„\",\n            \"If you have any questions about this information, please contact us\",\n          )}\n        </p>\n        <p className=\"text-muted-foreground text-xs\">\n          {t(\"æœ€çµ‚æ›´æ–°: 2024å¹´12æœˆ\", \"Last updated: December 2024\")}\n        </p>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.themes._index/components/theme-list.tsx"},"span":[4320,4833],"sourceCode":"import { Button } from \"~/components/ui/button\"\nimport { createCalendarCells } from \"~/routes/($lang)._main.themes._index/utils/create-calendar-cells\"\nimport { Link, useNavigate } from \"@remix-run/react\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\nimport { ChevronLeftIcon, ChevronRightIcon } from \"lucide-react\"\nimport { cn } from \"~/lib/utils\"\n\ntype Props = {\n  year: number\n  month: number\n  dailyThemes: FragmentOf<typeof ThemeListItemFragment>[]\n}\n\n/**\n * ãŠé¡Œã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®ã‚»ãƒ«ä¸€è¦§ã‚’ä½œæˆã™ã‚‹\n */\nexport function ThemeList (props: Props) {\n  const navigate = useNavigate()\n\n  // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚»ãƒ«ã‚’ç”Ÿæˆ\n  const cells = createCalendarCells(props.year, props.month)\n\n  const currentDateInJapan = getJSTDate()\n\n  const firstDayOfWeek = new Date(props.year, props.month - 1, 1).getDay() // 1æ—¥ã®æ›œæ—¥ã‚’å–å¾—\n\n  const blocks = cells.map((day, index) => {\n    const theme = props.dailyThemes.find((dailyTheme) => {\n      return dailyTheme.day === day\n    })\n\n    const isToday =\n      props.year === currentDateInJapan.getFullYear() &&\n      props.month === currentDateInJapan.getMonth() + 1 &&\n      day === currentDateInJapan.getDate()\n\n    // æ­£ã—ã„æ›œæ—¥ã‚’ç®—å‡º\n    const dayOfWeek = day ? (day + firstDayOfWeek - 1) % 7 : null\n\n    // ç¾åœ¨ã®æ—¥ä»˜ã¨æ¯”è¼ƒ\n    const sevenDaysAfter = new Date(currentDateInJapan)\n\n    sevenDaysAfter.setDate(currentDateInJapan.getDate() + 7)\n\n    const shouldHideTitle = day\n      ? new Date(props.year, props.month - 1, day) > sevenDaysAfter\n      : false\n\n    const isFuture = day\n      ? new Date(props.year, props.month - 1, day) > currentDateInJapan\n      : false\n\n    return {\n      id: `/${props.year}-${props.month}-${index}`,\n      day: day,\n      title: !shouldHideTitle ? (theme?.title ?? null) : null, // 7æ—¥å¾Œä»¥é™ã¯ãŠé¡Œå†…å®¹ã‚’è¡¨ç¤ºã—ãªã„\n      isSunday: dayOfWeek === 0, // æ—¥æ›œæ—¥\n      isSaturday: dayOfWeek === 6, // åœŸæ›œæ—¥\n      isToday: isToday,\n      isFuture: isFuture,\n      date: `${props.year}-${String(props.month).padStart(2, \"0\")}-${String(day).padStart(2, \"0\")}`,\n      thumbnailUrl: isFuture\n        ? null\n        : (theme?.firstWork?.smallThumbnailImageURL ?? null),\n      proposerId: theme?.proposer?.id ?? null,\n      proposerName: theme?.proposer?.name ?? null,\n    }\n  })\n\n  const onPreviousMonth = () => {\n    const previousMonth = props.month - 1\n    if (previousMonth < 1) {\n      navigate(`/themes/${props.year - 1}/${12}`)\n      return\n    }\n    navigate(`/themes/${props.year}/${previousMonth}`)\n  }\n\n  const onNextMonth = () => {\n    const nextMonth = props.month + 1\n    if (nextMonth > 12) {\n      navigate(`/themes/${props.year + 1}/${1}`)\n      return\n    }\n    navigate(`/themes/${props.year}/${nextMonth}`)\n  }\n\n  const handleCellClick = (date: string) => {\n    const year = Number(date.slice(0, 4))\n    const month = Number(date.slice(5, 7))\n    const day = Number(date.slice(8, 10))\n\n    // NaNãªã‚‰ä½•ã‚‚ã—ãªã„\n    if (Number.isNaN(year) || Number.isNaN(month) || Number.isNaN(day)) {\n      return\n    }\n\n    navigate(`/themes/${year}/${month}/${day}?tab=list`)\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex items-center justify-center space-x-4\">\n        <Button\n          variant={\"secondary\"}\n          aria-label=\"previous month\"\n          onClick={onPreviousMonth}\n        >\n          <ChevronLeftIcon className=\"text-lg\" />\n        </Button>\n        <p className=\"text-sm leading-none\">\n          {`${props.year}å¹´${props.month}æœˆ`}\n        </p>\n        <Button\n          variant={\"secondary\"}\n          aria-label=\"next month\"\n          onClick={onNextMonth}\n        >\n          <ChevronRightIcon className=\"text-lg\" />\n        </Button>\n      </div>\n      <div className=\"overflow-x-auto\">\n        <div className=\"grid grid-cols-7 gap-0 md:min-w-[768px] md:gap-4\">\n          {[\"æ—¥\", \"æœˆ\", \"ç«\", \"æ°´\", \"æœ¨\", \"é‡‘\", \"åœŸ\"].map((day) => (\n            <div key={day} className=\"text-center font-bold\">\n              {day}\n            </div>\n          ))}\n          {blocks.map((block) => (\n            <div\n              key={block.id}\n              className={cn(\"relative\", {\n                \"border-green-500\": block.isSaturday,\n                \"border-red-500\": block.isSunday,\n              })}\n            >\n              <div\n                onClick={() => handleCellClick(block.date)}\n                onKeyPress={(e) => {\n                  if (e.key === \"Enter\" || e.key === \" \") {\n                    handleCellClick(block.date)\n                  }\n                }}\n                className={cn(\n                  \"relative flex h-24 cursor-pointer flex-col gap-y-2 border p-2 md:min-w-24\",\n                  {\n                    \"border-2 border-blue-500\": block.isToday,\n                  },\n                )}\n              >\n                <div\n                  className={cn(\"absolute z-10 text-right font-bold text-xs\", {\n                    \"text-red-500\": block.isSunday,\n                    \"text-blue-500\": block.isSaturday,\n                    \"text-black\": !block.isSunday && !block.isSaturday,\n                    \"text-white\": block.thumbnailUrl && !block.isFuture,\n                  })}\n                >\n                  {block.day}\n                </div>\n                {block.thumbnailUrl && !block.isFuture && (\n                  <img\n                    src={block.thumbnailUrl}\n                    alt=\"\"\n                    className=\"absolute top-0 left-0 m-0 h-full w-full object-cover opacity-30 md:opacity-70\"\n                  />\n                )}\n                {block.title && block.thumbnailUrl && !block.isFuture && (\n                  <>\n                    <div className=\"-translate-x-1/2 -translate-y-1/2 absolute top-1/2 left-1/2 z-10 w-14 transform text-wrap rounded-md p-2 text-center font-bold text-white text-xs md:w-24 md:text-md\">\n                      {block.title}\n                    </div>\n                    <div className=\"absolute right-0 bottom-0 left-0 box-border flex h-24 flex-col justify-end bg-linear-to-t from-black to-transparent p-4 pb-3 opacity-80 md:h-24 md:opacity-100\" />\n                  </>\n                )}\n                {block.title && !block.thumbnailUrl && (\n                  <div className=\"-translate-x-1/2 -translate-y-1/2 absolute top-1/2 left-1/2 w-14 transform text-wrap rounded-md p-2 text-center font-bold text-xs md:w-24 md:text-md\">\n                    {block.title}\n                  </div>\n                )}\n              </div>\n              {block.proposerId && block.proposerId?.length !== 0 && (\n                <Link\n                  to={`/users/${block.proposerId}`}\n                  className=\"absolute right-0 bottom-0 left-0 z-10 text-wrap bg-black bg-opacity-60 p-0 text-center text-sm text-white opacity-40\"\n                >\n                  {block.proposerName}\n                  {\"ã•ã‚“æ¡ˆ\"}\n                </Link>\n              )}\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport const ThemeListItemFragment = graphql(\n  `fragment ThemeListItem on DailyThemeNode @_unmask {\n    id\n    title\n    dateText\n    year\n    month\n    day\n    worksCount\n    firstWork {\n      id\n      smallThumbnailImageURL\n    }\n    proposer {\n      id\n      name\n      iconUrl\n    }\n  }`,\n)\n\nconst getJSTDate = () => {\n  const date = new Date()\n  const utcOffset = date.getTimezoneOffset() * 60000 // åˆ†å˜ä½ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’ãƒŸãƒªç§’ã«å¤‰æ›\n  const jstOffset = 9 * 60 * 60 * 1000 // JSTã¯UTC+9\n  const jstDate = new Date(date.getTime() + utcOffset + jstOffset)\n\n  return jstDate\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang)._main.users.$user._index/components/user-profile-info.tsx"},"span":[2015,2141],"sourceCode":"import type React from \"react\"\nimport { useState } from \"react\"\nimport { RiEye2Line, RiHeartLine } from \"@remixicon/react\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { cn } from \"~/lib/utils\"\n\ntype UserProfileInfoProps = {\n  name: string\n  receivedLikesCount: number\n  receivedViewsCount: number\n  awardsCount: number\n  followersCount: number\n  biography: string\n}\n\nconst UserProfileInfo: React.FC<UserProfileInfoProps> = ({\n  name,\n  receivedLikesCount,\n  receivedViewsCount,\n  awardsCount,\n  followersCount,\n  biography,\n}) => {\n  const [showFullBiography, setShowFullBiography] = useState(false)\n  const t = useTranslation()\n\n  const toggleBiography = () => {\n    setShowFullBiography(!showFullBiography)\n  }\n\n  const truncatedBiography = showFullBiography\n    ? biography\n    : biography.slice(0, 100)\n\n  return (\n    <div className=\"mx-auto max-w-4xl\">\n      <div className=\"flex flex-col\">\n        <h1 className=\"font-bold text-2xl\">{name}</h1>\n        <div className=\"flex items-center gap-4\">\n          <span className=\"flex items-center text-base\">\n            <RiHeartLine className=\"mr-1 fill-red-500\" />\n            {receivedLikesCount}\n          </span>\n          <span className=\"flex items-center text-base\">\n            <RiEye2Line className=\"mr-1\" />\n            {receivedViewsCount}\n          </span>\n          <span className=\"text-base\">\n            {t(\"å…¥è³å›æ•°\", \"Awards\")} {awardsCount} {t(\"å›\", \"times\")}\n          </span>\n        </div>\n        <div className=\"text-base\">\n          <span>\n            {followersCount} {t(\"ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼\", \"followers\")}\n          </span>\n        </div>\n        {biography && (\n          <div>\n            <p\n              className={cn(\"mt-4 text-gray\", {\n                truncate: !showFullBiography,\n              })}\n            >\n              {truncatedBiography}\n              {!showFullBiography && biography.length > 100 && (\n                // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n                <span\n                  className=\"cursor-pointer text-blue-500\"\n                  onClick={toggleBiography}\n                >\n                  {t(\" ç¶šãã‚’èª­ã‚€\", \"Read More\")}\n                </span>\n              )}\n            </p>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n\nexport default UserProfileInfo\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[1249,1260],"sourceCode":"import { fragmentShaderCode } from \"~/routes/($lang).app._index/utils/fragment-shader-code\"\nimport { vertexShaderCode } from \"~/routes/($lang).app._index/utils/vertex-shader-code\"\n\nexport function runAnimation(canvas: HTMLCanvasElement) {\n  const context = canvas.getContext(\"webgl\", {\n    antialias: false,\n    depth: false,\n    stencil: false,\n    premultipliedAlpha: false,\n    preserveDrawingBuffer: true,\n  })\n\n  if (context === null) return null\n\n  const program = context.createProgram()\n\n  if (program === null) return null\n\n  const vertexShader = context.createShader(context.VERTEX_SHADER)\n\n  if (vertexShader === null) return null\n\n  context.shaderSource(vertexShader, vertexShaderCode)\n\n  context.compileShader(vertexShader)\n\n  context.attachShader(program, vertexShader)\n\n  const vertexShaderLog = context.getShaderInfoLog(vertexShader)\n\n  const fragmentShader = context.createShader(context.FRAGMENT_SHADER)\n\n  if (fragmentShader === null) return null\n\n  context.shaderSource(fragmentShader, fragmentShaderCode)\n\n  context.compileShader(fragmentShader)\n\n  context.attachShader(program, fragmentShader)\n\n  const fragmentShaderLog = context.getShaderInfoLog(fragmentShader)\n\n  if (vertexShaderLog === null || fragmentShaderLog === null) return null\n\n  context.linkProgram(program)\n\n  const isRunning = Boolean(\n    context.getProgramParameter(program, context.LINK_STATUS),\n  )\n\n  context.useProgram(program)\n\n  const uniformLocations = {\n    time: context.getUniformLocation(program, \"time\"),\n    resolution: context.getUniformLocation(program, \"resolution\"),\n  }\n\n  context.bindBuffer(context.ARRAY_BUFFER, context.createBuffer())\n\n  context.bufferData(\n    context.ARRAY_BUFFER,\n    new Float32Array([-1, 1, 0, -1, -1, 0, 1, 1, 0, 1, -1, 0]),\n    context.STATIC_DRAW,\n  )\n\n  const attributeLocation = context.getAttribLocation(program, \"position\")\n\n  context.enableVertexAttribArray(attributeLocation)\n\n  context.vertexAttribPointer(attributeLocation, 3, context.FLOAT, false, 0, 0)\n\n  context.clearColor(0, 0, 0, 0)\n\n  const startTime = Date.now()\n\n  const render = () => {\n    if (!isRunning) return\n\n    const viewportWidth = window.innerWidth / 1\n\n    const viewportHeight = window.innerHeight / 1\n\n    canvas.width = viewportWidth\n\n    canvas.height = viewportHeight\n\n    context.viewport(0, 0, viewportWidth, viewportHeight)\n\n    const elapsedTime = (Date.now() - startTime) * 0.001\n\n    context.clear(context.COLOR_BUFFER_BIT)\n\n    context.uniform1f(uniformLocations.time, elapsedTime)\n\n    context.uniform2fv(uniformLocations.resolution, [\n      viewportWidth,\n      viewportHeight,\n    ])\n\n    context.drawArrays(context.TRIANGLE_STRIP, 0, 4)\n\n    context.flush()\n\n    requestAnimationFrame(render)\n  }\n\n  render()\n}\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).app._index/utils/run-animation.ts"},"span":[1393,1411],"sourceCode":"import { fragmentShaderCode } from \"~/routes/($lang).app._index/utils/fragment-shader-code\"\nimport { vertexShaderCode } from \"~/routes/($lang).app._index/utils/vertex-shader-code\"\n\nexport function runAnimation(canvas: HTMLCanvasElement) {\n  const context = canvas.getContext(\"webgl\", {\n    antialias: false,\n    depth: false,\n    stencil: false,\n    premultipliedAlpha: false,\n    preserveDrawingBuffer: true,\n  })\n\n  if (context === null) return null\n\n  const program = context.createProgram()\n\n  if (program === null) return null\n\n  const vertexShader = context.createShader(context.VERTEX_SHADER)\n\n  if (vertexShader === null) return null\n\n  context.shaderSource(vertexShader, vertexShaderCode)\n\n  context.compileShader(vertexShader)\n\n  context.attachShader(program, vertexShader)\n\n  const vertexShaderLog = context.getShaderInfoLog(vertexShader)\n\n  const fragmentShader = context.createShader(context.FRAGMENT_SHADER)\n\n  if (fragmentShader === null) return null\n\n  context.shaderSource(fragmentShader, fragmentShaderCode)\n\n  context.compileShader(fragmentShader)\n\n  context.attachShader(program, fragmentShader)\n\n  const fragmentShaderLog = context.getShaderInfoLog(fragmentShader)\n\n  if (vertexShaderLog === null || fragmentShaderLog === null) return null\n\n  context.linkProgram(program)\n\n  const isRunning = Boolean(\n    context.getProgramParameter(program, context.LINK_STATUS),\n  )\n\n  context.useProgram(program)\n\n  const uniformLocations = {\n    time: context.getUniformLocation(program, \"time\"),\n    resolution: context.getUniformLocation(program, \"resolution\"),\n  }\n\n  context.bindBuffer(context.ARRAY_BUFFER, context.createBuffer())\n\n  context.bufferData(\n    context.ARRAY_BUFFER,\n    new Float32Array([-1, 1, 0, -1, -1, 0, 1, 1, 0, 1, -1, 0]),\n    context.STATIC_DRAW,\n  )\n\n  const attributeLocation = context.getAttribLocation(program, \"position\")\n\n  context.enableVertexAttribArray(attributeLocation)\n\n  context.vertexAttribPointer(attributeLocation, 3, context.FLOAT, false, 0, 0)\n\n  context.clearColor(0, 0, 0, 0)\n\n  const startTime = Date.now()\n\n  const render = () => {\n    if (!isRunning) return\n\n    const viewportWidth = window.innerWidth / 1\n\n    const viewportHeight = window.innerHeight / 1\n\n    canvas.width = viewportWidth\n\n    canvas.height = viewportHeight\n\n    context.viewport(0, 0, viewportWidth, viewportHeight)\n\n    const elapsedTime = (Date.now() - startTime) * 0.001\n\n    context.clear(context.COLOR_BUFFER_BIT)\n\n    context.uniform1f(uniformLocations.time, elapsedTime)\n\n    context.uniform2fv(uniformLocations.resolution, [\n      viewportWidth,\n      viewportHeight,\n    ])\n\n    context.drawArrays(context.TRIANGLE_STRIP, 0, 4)\n\n    context.flush()\n\n    requestAnimationFrame(render)\n  }\n\n  render()\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called indirectly and conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called indirectly and conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"This is the call path until the hook."}]]},{"frame":{"path":null,"span":[7258,7298],"sourceCode":"import { Card, CardHeader, CardContent } from \"~/components/ui/card\"\nimport { useLoaderData, useNavigate, useSearchParams } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { loaderClient } from \"~/lib/loader-client\"\nimport {\n  EventWorkList,\n  EventWorkListItemFragment,\n} from \"~/routes/($lang).events.$event._index/components/event-work-list\"\nimport {\n  EventAwardWorkList,\n  EventAwardWorkListItemFragment,\n} from \"~/routes/($lang).events.$event._index/components/event-award-work-list\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { config, META } from \"~/config\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { format } from \"date-fns\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { SensitiveToggle } from \"~/components/sensitive/sensitive-toggle\"\nimport React, { useEffect } from \"react\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport type { SortType } from \"~/types/sort-type\"\n\nconst toEventDateTimeText = (time: number) => {\n  const t = useTranslation()\n\n  // UTCæ™‚é–“ã‹ã‚‰æ—¥æœ¬æ™‚é–“ï¼ˆUTC+9ï¼‰ã«å¤‰æ›\n  const date = new Date(time * 1000)\n  const japanTime = new Date(date.getTime() - 9 * 60 * 60 * 1000)\n\n  return t(\n    format(japanTime, \"yyyyå¹´MMæœˆddæ—¥ HHæ™‚mmåˆ†\"),\n    format(japanTime, \"yyyy/MM/dd HH:mm\"),\n  )\n}\n\nexport async function loader(props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const event = props.params.event\n\n  const urlParams = new URL(props.request.url).searchParams\n\n  const pageParam = urlParams.get(\"page\")\n\n  const page = pageParam ? Number(pageParam) : 0\n\n  if (event === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const orderBy = urlParams.get(\"WorkOrderby\")\n    ? (urlParams.get(\"WorkOrderby\") as IntrospectionEnum<\"WorkOrderBy\">)\n    : \"LIKES_COUNT\"\n\n  const sort = urlParams.get(\"worksOrderDeskAsc\")\n    ? (urlParams.get(\"worksOrderDeskAsc\") as SortType)\n    : \"DESC\"\n\n  const eventsResp = await loaderClient.query({\n    query: appEventQuery,\n    variables: {\n      limit: 64,\n      offset: page * 64,\n      slug: event,\n      where: {\n        ratings: [\"G\", \"R15\"],\n        isNowCreatedAt: true,\n        orderBy: orderBy,\n        sort: sort,\n      },\n      isSensitive: false,\n    },\n  })\n\n  if (eventsResp.data.appEvent === null) {\n    throw new Response(null, { status: 404 })\n  }\n\n  return {\n    appEvent: eventsResp.data.appEvent,\n    page,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneMinute,\n})\n\nexport const meta: MetaFunction = ({ data }) => {\n  if (!data) {\n    return [{ title: \"ã‚¤ãƒ™ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ\" }]\n  }\n\n  const { appEvent } = data as {\n    appEvent: { title: string; description: string; thumbnailImageUrl: string }\n  }\n\n  const stripHtmlTags = (str: string) => {\n    return str.replace(/<[^>]*>?/gm, \"\")\n  }\n\n  return createMeta(META.EVENTS_INDEX, {\n    title: appEvent.title,\n    description: stripHtmlTags(appEvent.description),\n    url: appEvent.thumbnailImageUrl,\n  })\n}\n\nexport default function FollowingLayout () {\n  const t = useTranslation()\n\n  const data = useLoaderData<typeof loader>()\n\n  const _navigate = useNavigate()\n\n  const [searchParams, setSearchParams] = useSearchParams()\n\n  const [workType, setWorkType] =\n    React.useState<IntrospectionEnum<\"WorkType\"> | null>(\n      (searchParams.get(\"workType\") as IntrospectionEnum<\"WorkType\">) || null,\n    )\n\n  const [WorkOrderby, setWorkOrderby] = React.useState<\n    IntrospectionEnum<\"WorkOrderBy\">\n  >(\n    (searchParams.get(\"WorkOrderby\") as IntrospectionEnum<\"WorkOrderBy\">) ||\n      \"DATE_CREATED\",\n  )\n\n  const [worksOrderDeskAsc, setWorksOrderDeskAsc] = React.useState<SortType>(\n    (searchParams.get(\"worksOrderDeskAsc\") as SortType) || \"DESC\",\n  )\n\n  const [rating, setRating] =\n    React.useState<IntrospectionEnum<\"Rating\"> | null>(\n      (searchParams.get(\"rating\") as IntrospectionEnum<\"Rating\">) || null,\n    )\n\n  useEffect(() => {\n    const params = new URLSearchParams()\n\n    params.set(\"page\", String(data.page))\n    if (workType) params.set(\"workType\", workType)\n    if (rating) params.set(\"rating\", rating)\n    params.set(\"WorkOrderby\", WorkOrderby)\n    params.set(\"worksOrderDeskAsc\", worksOrderDeskAsc)\n\n    setSearchParams(params)\n  }, [\n    data.page,\n    workType,\n    rating,\n    WorkOrderby,\n    worksOrderDeskAsc,\n    setSearchParams,\n  ])\n\n  const onClickTitleSortButton = () => {\n    setWorkOrderby(\"NAME\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickLikeSortButton = () => {\n    setWorkOrderby(\"LIKES_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickBookmarkSortButton = () => {\n    setWorkOrderby(\"BOOKMARKS_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickCommentSortButton = () => {\n    setWorkOrderby(\"COMMENTS_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickViewSortButton = () => {\n    setWorkOrderby(\"VIEWS_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickAccessTypeSortButton = () => {\n    setWorkOrderby(\"ACCESS_TYPE\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickDateSortButton = () => {\n    setWorkOrderby(\"DATE_CREATED\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickWorkTypeSortButton = () => {\n    setWorkOrderby(\"WORK_TYPE\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickIsPromotionSortButton = () => {\n    setWorkOrderby(\"IS_PROMOTION\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const [worksMaxCount, _setWorksMaxCount] = React.useState(0)\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <div className=\"flex flex-col space-y-4\">\n      <div className=\"flex flex-col gap-x-2 gap-y-2 md:flex-row\">\n        {data.appEvent.thumbnailImageUrl && (\n          <img\n            className=\"h-auto rounded-lg object-cover md:max-w-96\"\n            src={data.appEvent.thumbnailImageUrl}\n            alt=\"\"\n          />\n        )}\n        <Card className=\"m-auto w-full\">\n          <CardHeader>\n            <div className=\"mt-4 text-center font-medium text-lg\">\n              {data.appEvent.title}\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"m-auto flex flex-col items-center text-left\">\n              {data.appEvent.description && (\n                <div\n                  className=\"mb-2 text-left text-sm\"\n                  // biome-ignore lint/security/noDangerouslySetInnerHtml: <explanation>\n                  dangerouslySetInnerHTML={{\n                    __html: data.appEvent.description,\n                  }}\n                />\n              )}\n              {data.appEvent.startAt && data.appEvent.endAt && (\n                <div className=\"mr-auto text-sm\">\n                  {toEventDateTimeText(data.appEvent.startAt)}ï½\n                  {toEventDateTimeText(data.appEvent.endAt)}\n                </div>\n              )}\n              <div className=\"mt-2 mr-auto text-sm\">\n                {t(\"å¿œå‹Ÿä½œå“æ•°:\", \"Number of Submissions:\")}{\" \"}\n                {data.appEvent.worksCount?.toString() ?? \"0\"}\n              </div>\n              <div className=\"mt-2 mr-auto text-sm\">\n                <span>\n                  {t(\"å‚åŠ ã‚¿ã‚°:\", \"Event Tag:\")} {data.appEvent.tag}\n                </span>\n              </div>\n              {data.appEvent.slug !== null && (\n                <SensitiveToggle\n                  variant=\"compact\"\n                  targetUrl={`/r/events/${data.appEvent.slug}`}\n                />\n              )}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n      {data.appEvent.awardWorks && (\n        <EventAwardWorkList\n          works={data.appEvent.awardWorks}\n          slug={data.appEvent.slug ?? \"\"}\n        />\n      )}\n      {data.appEvent.works && (\n        <EventWorkList\n          works={data.appEvent.works}\n          maxCount={data.appEvent.worksCount as number}\n          page={data.page}\n          slug={data.appEvent.slug ?? \"\"}\n          sort={worksOrderDeskAsc}\n          orderBy={WorkOrderby}\n          sumWorksCount={worksMaxCount}\n          workType={workType}\n          rating={rating}\n          onClickTitleSortButton={onClickTitleSortButton}\n          onClickLikeSortButton={onClickLikeSortButton}\n          onClickBookmarkSortButton={onClickBookmarkSortButton}\n          onClickCommentSortButton={onClickCommentSortButton}\n          onClickViewSortButton={onClickViewSortButton}\n          onClickAccessTypeSortButton={onClickAccessTypeSortButton}\n          onClickDateSortButton={onClickDateSortButton}\n          onClickWorkTypeSortButton={onClickWorkTypeSortButton}\n          onClickIsPromotionSortButton={onClickIsPromotionSortButton}\n          setWorkType={setWorkType}\n          setRating={setRating}\n          setSort={setWorksOrderDeskAsc}\n        />\n      )}\n    </div>\n  )\n}\n\nconst appEventQuery = graphql(\n  `query AppEvent($slug: String!, $offset: Int!, $limit: Int!, $where: WorksWhereInput!, $isSensitive: Boolean!) {\n    appEvent(slug: $slug) {\n      id\n      description\n      title\n      slug\n      thumbnailImageUrl\n      headerImageUrl\n      startAt\n      endAt\n      tag\n      worksCount\n      works(offset: $offset, limit: $limit, where: $where) {\n        ...EventWorkListItem\n      }\n      awardWorks(offset: 0, limit: 20, isSensitive: $isSensitive) {\n        ...EventAwardWorkListItem\n      }\n    }\n  }`,\n  [EventAwardWorkListItemFragment, EventWorkListItemFragment],\n)\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).events.$event._index/route.tsx"},"span":[1082,1096],"sourceCode":"import { Card, CardHeader, CardContent } from \"~/components/ui/card\"\nimport { useLoaderData, useNavigate, useSearchParams } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { loaderClient } from \"~/lib/loader-client\"\nimport {\n  EventWorkList,\n  EventWorkListItemFragment,\n} from \"~/routes/($lang).events.$event._index/components/event-work-list\"\nimport {\n  EventAwardWorkList,\n  EventAwardWorkListItemFragment,\n} from \"~/routes/($lang).events.$event._index/components/event-award-work-list\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { config, META } from \"~/config\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { format } from \"date-fns\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { SensitiveToggle } from \"~/components/sensitive/sensitive-toggle\"\nimport React, { useEffect } from \"react\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport type { SortType } from \"~/types/sort-type\"\n\nconst toEventDateTimeText = (time: number) => {\n  const t = useTranslation()\n\n  // UTCæ™‚é–“ã‹ã‚‰æ—¥æœ¬æ™‚é–“ï¼ˆUTC+9ï¼‰ã«å¤‰æ›\n  const date = new Date(time * 1000)\n  const japanTime = new Date(date.getTime() - 9 * 60 * 60 * 1000)\n\n  return t(\n    format(japanTime, \"yyyyå¹´MMæœˆddæ—¥ HHæ™‚mmåˆ†\"),\n    format(japanTime, \"yyyy/MM/dd HH:mm\"),\n  )\n}\n\nexport async function loader(props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const event = props.params.event\n\n  const urlParams = new URL(props.request.url).searchParams\n\n  const pageParam = urlParams.get(\"page\")\n\n  const page = pageParam ? Number(pageParam) : 0\n\n  if (event === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  const orderBy = urlParams.get(\"WorkOrderby\")\n    ? (urlParams.get(\"WorkOrderby\") as IntrospectionEnum<\"WorkOrderBy\">)\n    : \"LIKES_COUNT\"\n\n  const sort = urlParams.get(\"worksOrderDeskAsc\")\n    ? (urlParams.get(\"worksOrderDeskAsc\") as SortType)\n    : \"DESC\"\n\n  const eventsResp = await loaderClient.query({\n    query: appEventQuery,\n    variables: {\n      limit: 64,\n      offset: page * 64,\n      slug: event,\n      where: {\n        ratings: [\"G\", \"R15\"],\n        isNowCreatedAt: true,\n        orderBy: orderBy,\n        sort: sort,\n      },\n      isSensitive: false,\n    },\n  })\n\n  if (eventsResp.data.appEvent === null) {\n    throw new Response(null, { status: 404 })\n  }\n\n  return {\n    appEvent: eventsResp.data.appEvent,\n    page,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneMinute,\n})\n\nexport const meta: MetaFunction = ({ data }) => {\n  if (!data) {\n    return [{ title: \"ã‚¤ãƒ™ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ\" }]\n  }\n\n  const { appEvent } = data as {\n    appEvent: { title: string; description: string; thumbnailImageUrl: string }\n  }\n\n  const stripHtmlTags = (str: string) => {\n    return str.replace(/<[^>]*>?/gm, \"\")\n  }\n\n  return createMeta(META.EVENTS_INDEX, {\n    title: appEvent.title,\n    description: stripHtmlTags(appEvent.description),\n    url: appEvent.thumbnailImageUrl,\n  })\n}\n\nexport default function FollowingLayout () {\n  const t = useTranslation()\n\n  const data = useLoaderData<typeof loader>()\n\n  const _navigate = useNavigate()\n\n  const [searchParams, setSearchParams] = useSearchParams()\n\n  const [workType, setWorkType] =\n    React.useState<IntrospectionEnum<\"WorkType\"> | null>(\n      (searchParams.get(\"workType\") as IntrospectionEnum<\"WorkType\">) || null,\n    )\n\n  const [WorkOrderby, setWorkOrderby] = React.useState<\n    IntrospectionEnum<\"WorkOrderBy\">\n  >(\n    (searchParams.get(\"WorkOrderby\") as IntrospectionEnum<\"WorkOrderBy\">) ||\n      \"DATE_CREATED\",\n  )\n\n  const [worksOrderDeskAsc, setWorksOrderDeskAsc] = React.useState<SortType>(\n    (searchParams.get(\"worksOrderDeskAsc\") as SortType) || \"DESC\",\n  )\n\n  const [rating, setRating] =\n    React.useState<IntrospectionEnum<\"Rating\"> | null>(\n      (searchParams.get(\"rating\") as IntrospectionEnum<\"Rating\">) || null,\n    )\n\n  useEffect(() => {\n    const params = new URLSearchParams()\n\n    params.set(\"page\", String(data.page))\n    if (workType) params.set(\"workType\", workType)\n    if (rating) params.set(\"rating\", rating)\n    params.set(\"WorkOrderby\", WorkOrderby)\n    params.set(\"worksOrderDeskAsc\", worksOrderDeskAsc)\n\n    setSearchParams(params)\n  }, [\n    data.page,\n    workType,\n    rating,\n    WorkOrderby,\n    worksOrderDeskAsc,\n    setSearchParams,\n  ])\n\n  const onClickTitleSortButton = () => {\n    setWorkOrderby(\"NAME\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickLikeSortButton = () => {\n    setWorkOrderby(\"LIKES_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickBookmarkSortButton = () => {\n    setWorkOrderby(\"BOOKMARKS_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickCommentSortButton = () => {\n    setWorkOrderby(\"COMMENTS_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickViewSortButton = () => {\n    setWorkOrderby(\"VIEWS_COUNT\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickAccessTypeSortButton = () => {\n    setWorkOrderby(\"ACCESS_TYPE\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickDateSortButton = () => {\n    setWorkOrderby(\"DATE_CREATED\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickWorkTypeSortButton = () => {\n    setWorkOrderby(\"WORK_TYPE\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const onClickIsPromotionSortButton = () => {\n    setWorkOrderby(\"IS_PROMOTION\")\n    setWorksOrderDeskAsc(worksOrderDeskAsc === \"ASC\" ? \"DESC\" : \"ASC\")\n  }\n\n  const [worksMaxCount, _setWorksMaxCount] = React.useState(0)\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <div className=\"flex flex-col space-y-4\">\n      <div className=\"flex flex-col gap-x-2 gap-y-2 md:flex-row\">\n        {data.appEvent.thumbnailImageUrl && (\n          <img\n            className=\"h-auto rounded-lg object-cover md:max-w-96\"\n            src={data.appEvent.thumbnailImageUrl}\n            alt=\"\"\n          />\n        )}\n        <Card className=\"m-auto w-full\">\n          <CardHeader>\n            <div className=\"mt-4 text-center font-medium text-lg\">\n              {data.appEvent.title}\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"m-auto flex flex-col items-center text-left\">\n              {data.appEvent.description && (\n                <div\n                  className=\"mb-2 text-left text-sm\"\n                  // biome-ignore lint/security/noDangerouslySetInnerHtml: <explanation>\n                  dangerouslySetInnerHTML={{\n                    __html: data.appEvent.description,\n                  }}\n                />\n              )}\n              {data.appEvent.startAt && data.appEvent.endAt && (\n                <div className=\"mr-auto text-sm\">\n                  {toEventDateTimeText(data.appEvent.startAt)}ï½\n                  {toEventDateTimeText(data.appEvent.endAt)}\n                </div>\n              )}\n              <div className=\"mt-2 mr-auto text-sm\">\n                {t(\"å¿œå‹Ÿä½œå“æ•°:\", \"Number of Submissions:\")}{\" \"}\n                {data.appEvent.worksCount?.toString() ?? \"0\"}\n              </div>\n              <div className=\"mt-2 mr-auto text-sm\">\n                <span>\n                  {t(\"å‚åŠ ã‚¿ã‚°:\", \"Event Tag:\")} {data.appEvent.tag}\n                </span>\n              </div>\n              {data.appEvent.slug !== null && (\n                <SensitiveToggle\n                  variant=\"compact\"\n                  targetUrl={`/r/events/${data.appEvent.slug}`}\n                />\n              )}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n      {data.appEvent.awardWorks && (\n        <EventAwardWorkList\n          works={data.appEvent.awardWorks}\n          slug={data.appEvent.slug ?? \"\"}\n        />\n      )}\n      {data.appEvent.works && (\n        <EventWorkList\n          works={data.appEvent.works}\n          maxCount={data.appEvent.worksCount as number}\n          page={data.page}\n          slug={data.appEvent.slug ?? \"\"}\n          sort={worksOrderDeskAsc}\n          orderBy={WorkOrderby}\n          sumWorksCount={worksMaxCount}\n          workType={workType}\n          rating={rating}\n          onClickTitleSortButton={onClickTitleSortButton}\n          onClickLikeSortButton={onClickLikeSortButton}\n          onClickBookmarkSortButton={onClickBookmarkSortButton}\n          onClickCommentSortButton={onClickCommentSortButton}\n          onClickViewSortButton={onClickViewSortButton}\n          onClickAccessTypeSortButton={onClickAccessTypeSortButton}\n          onClickDateSortButton={onClickDateSortButton}\n          onClickWorkTypeSortButton={onClickWorkTypeSortButton}\n          onClickIsPromotionSortButton={onClickIsPromotionSortButton}\n          setWorkType={setWorkType}\n          setRating={setRating}\n          setSort={setWorksOrderDeskAsc}\n        />\n      )}\n    </div>\n  )\n}\n\nconst appEventQuery = graphql(\n  `query AppEvent($slug: String!, $offset: Int!, $limit: Int!, $where: WorksWhereInput!, $isSensitive: Boolean!) {\n    appEvent(slug: $slug) {\n      id\n      description\n      title\n      slug\n      thumbnailImageUrl\n      headerImageUrl\n      startAt\n      endAt\n      tag\n      worksCount\n      works(offset: $offset, limit: $limit, where: $where) {\n        ...EventWorkListItem\n      }\n      awardWorks(offset: 0, limit: 20, isSensitive: $isSensitive) {\n        ...EventAwardWorkListItem\n      }\n    }\n  }`,\n  [EventAwardWorkListItemFragment, EventWorkListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[534,603],"sourceCode":"import { Input } from \"~/components/ui/input\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { GenerationConfigMemoItem } from \"~/routes/($lang).generation._index/components/config-view/generation-config-memo-item\"\nimport { useEffect, useState } from \"react\"\n\ntype Props = {\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  memos: any[] | undefined\n  refetchMemos: () => void\n}\n\n/**\n * å±¥æ­´ãƒ¡ãƒ¢ä¸€è¦§\n */\nexport function GenerationConfigMemoList (props: Props) {\n  if (props.memos === undefined) {\n    return <>{\"ãƒ—ãƒªã‚»ãƒƒãƒˆã‹ã‚‰è¨­å®šã‚’å¾©å…ƒã§ãã¾ã™\"}</>\n  }\n\n  const [searchWord, setSearchWord] = useState(\"\")\n\n  useEffect(() => {\n    props.refetchMemos()\n  }, [])\n\n  const filterModels =\n    searchWord !== \"\"\n      ? props.memos.filter((memo) => {\n          return (\n            memo?.title?.toLowerCase().includes(searchWord.toLowerCase()) ||\n            memo?.explanation\n              ?.toLowerCase()\n              .includes(searchWord.toLowerCase()) ||\n            memo?.prompts?.toLowerCase().includes(searchWord.toLowerCase())\n          )\n        })\n      : props.memos\n\n  return (\n    <>\n      {\"ãƒ—ãƒªã‚»ãƒƒãƒˆã‹ã‚‰è¨­å®šã‚’å¾©å…ƒã§ãã¾ã™\"}\n      <Input\n        onChange={(event) => {\n          setSearchWord(event.target.value)\n        }}\n        type=\"text\"\n        value={searchWord}\n        placeholder=\"ã‚¿ã‚¤ãƒˆãƒ«ã€èª¬æ˜ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§æ¤œç´¢\"\n      />\n      <ScrollArea className=\"h-full max-h-96 p-4\">\n        {filterModels.map(\n          (memo) =>\n            memo && (\n              <GenerationConfigMemoItem\n                memo={{\n                  ...memo,\n                  model: {\n                    ...memo.model,\n                    recommendedPrompt: \"\",\n                  },\n                }}\n                refetchMemos={props.refetchMemos}\n              />\n            ),\n        )}\n      </ScrollArea>\n    </>\n  )\n}\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/config-view/generation-config-memo-list.tsx"},"span":[663,672],"sourceCode":"import { Input } from \"~/components/ui/input\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { GenerationConfigMemoItem } from \"~/routes/($lang).generation._index/components/config-view/generation-config-memo-item\"\nimport { useEffect, useState } from \"react\"\n\ntype Props = {\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  memos: any[] | undefined\n  refetchMemos: () => void\n}\n\n/**\n * å±¥æ­´ãƒ¡ãƒ¢ä¸€è¦§\n */\nexport function GenerationConfigMemoList (props: Props) {\n  if (props.memos === undefined) {\n    return <>{\"ãƒ—ãƒªã‚»ãƒƒãƒˆã‹ã‚‰è¨­å®šã‚’å¾©å…ƒã§ãã¾ã™\"}</>\n  }\n\n  const [searchWord, setSearchWord] = useState(\"\")\n\n  useEffect(() => {\n    props.refetchMemos()\n  }, [])\n\n  const filterModels =\n    searchWord !== \"\"\n      ? props.memos.filter((memo) => {\n          return (\n            memo?.title?.toLowerCase().includes(searchWord.toLowerCase()) ||\n            memo?.explanation\n              ?.toLowerCase()\n              .includes(searchWord.toLowerCase()) ||\n            memo?.prompts?.toLowerCase().includes(searchWord.toLowerCase())\n          )\n        })\n      : props.memos\n\n  return (\n    <>\n      {\"ãƒ—ãƒªã‚»ãƒƒãƒˆã‹ã‚‰è¨­å®šã‚’å¾©å…ƒã§ãã¾ã™\"}\n      <Input\n        onChange={(event) => {\n          setSearchWord(event.target.value)\n        }}\n        type=\"text\"\n        value={searchWord}\n        placeholder=\"ã‚¿ã‚¤ãƒˆãƒ«ã€èª¬æ˜ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§æ¤œç´¢\"\n      />\n      <ScrollArea className=\"h-full max-h-96 p-4\">\n        {filterModels.map(\n          (memo) =>\n            memo && (\n              <GenerationConfigMemoItem\n                memo={{\n                  ...memo,\n                  model: {\n                    ...memo.model,\n                    recommendedPrompt: \"\",\n                  },\n                }}\n                refetchMemos={props.refetchMemos}\n              />\n            ),\n        )}\n      </ScrollArea>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[534,603],"sourceCode":"import { Input } from \"~/components/ui/input\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { GenerationConfigMemoItem } from \"~/routes/($lang).generation._index/components/config-view/generation-config-memo-item\"\nimport { useEffect, useState } from \"react\"\n\ntype Props = {\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  memos: any[] | undefined\n  refetchMemos: () => void\n}\n\n/**\n * å±¥æ­´ãƒ¡ãƒ¢ä¸€è¦§\n */\nexport function GenerationConfigMemoList (props: Props) {\n  if (props.memos === undefined) {\n    return <>{\"ãƒ—ãƒªã‚»ãƒƒãƒˆã‹ã‚‰è¨­å®šã‚’å¾©å…ƒã§ãã¾ã™\"}</>\n  }\n\n  const [searchWord, setSearchWord] = useState(\"\")\n\n  useEffect(() => {\n    props.refetchMemos()\n  }, [])\n\n  const filterModels =\n    searchWord !== \"\"\n      ? props.memos.filter((memo) => {\n          return (\n            memo?.title?.toLowerCase().includes(searchWord.toLowerCase()) ||\n            memo?.explanation\n              ?.toLowerCase()\n              .includes(searchWord.toLowerCase()) ||\n            memo?.prompts?.toLowerCase().includes(searchWord.toLowerCase())\n          )\n        })\n      : props.memos\n\n  return (\n    <>\n      {\"ãƒ—ãƒªã‚»ãƒƒãƒˆã‹ã‚‰è¨­å®šã‚’å¾©å…ƒã§ãã¾ã™\"}\n      <Input\n        onChange={(event) => {\n          setSearchWord(event.target.value)\n        }}\n        type=\"text\"\n        value={searchWord}\n        placeholder=\"ã‚¿ã‚¤ãƒˆãƒ«ã€èª¬æ˜ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§æ¤œç´¢\"\n      />\n      <ScrollArea className=\"h-full max-h-96 p-4\">\n        {filterModels.map(\n          (memo) =>\n            memo && (\n              <GenerationConfigMemoItem\n                memo={{\n                  ...memo,\n                  model: {\n                    ...memo.model,\n                    recommendedPrompt: \"\",\n                  },\n                }}\n                refetchMemos={props.refetchMemos}\n              />\n            ),\n        )}\n      </ScrollArea>\n    </>\n  )\n}\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/config-view/generation-config-memo-list.tsx"},"span":[647,655],"sourceCode":"import { Input } from \"~/components/ui/input\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { GenerationConfigMemoItem } from \"~/routes/($lang).generation._index/components/config-view/generation-config-memo-item\"\nimport { useEffect, useState } from \"react\"\n\ntype Props = {\n  // biome-ignore lint/suspicious/noExplicitAny: <explanation>\n  memos: any[] | undefined\n  refetchMemos: () => void\n}\n\n/**\n * å±¥æ­´ãƒ¡ãƒ¢ä¸€è¦§\n */\nexport function GenerationConfigMemoList (props: Props) {\n  if (props.memos === undefined) {\n    return <>{\"ãƒ—ãƒªã‚»ãƒƒãƒˆã‹ã‚‰è¨­å®šã‚’å¾©å…ƒã§ãã¾ã™\"}</>\n  }\n\n  const [searchWord, setSearchWord] = useState(\"\")\n\n  useEffect(() => {\n    props.refetchMemos()\n  }, [])\n\n  const filterModels =\n    searchWord !== \"\"\n      ? props.memos.filter((memo) => {\n          return (\n            memo?.title?.toLowerCase().includes(searchWord.toLowerCase()) ||\n            memo?.explanation\n              ?.toLowerCase()\n              .includes(searchWord.toLowerCase()) ||\n            memo?.prompts?.toLowerCase().includes(searchWord.toLowerCase())\n          )\n        })\n      : props.memos\n\n  return (\n    <>\n      {\"ãƒ—ãƒªã‚»ãƒƒãƒˆã‹ã‚‰è¨­å®šã‚’å¾©å…ƒã§ãã¾ã™\"}\n      <Input\n        onChange={(event) => {\n          setSearchWord(event.target.value)\n        }}\n        type=\"text\"\n        value={searchWord}\n        placeholder=\"ã‚¿ã‚¤ãƒˆãƒ«ã€èª¬æ˜ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§æ¤œç´¢\"\n      />\n      <ScrollArea className=\"h-full max-h-96 p-4\">\n        {filterModels.map(\n          (memo) =>\n            memo && (\n              <GenerationConfigMemoItem\n                memo={{\n                  ...memo,\n                  model: {\n                    ...memo.model,\n                    recommendedPrompt: \"\",\n                  },\n                }}\n                refetchMemos={props.refetchMemos}\n              />\n            ),\n        )}\n      </ScrollArea>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/config-view/generation-config-reset-confirm-dialog.tsx"},"span":[700,946],"sourceCode":"import { RotateCcw } from \"lucide-react\"\nimport { useState } from \"react\"\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"~/components/ui/alert-dialog\"\nimport { Button } from \"~/components/ui/button\"\n\ntype Props = {\n  onReset: () => void\n}\n\nexport function GenerationConfigResetConfirmDialog (props: Props) {\n  const [isOpen, setIsOpen] = useState(false)\n\n  const handleNext = () => {\n    props.onReset()\n    setIsOpen(false)\n  }\n\n  return (\n    <AlertDialog open={isOpen} onOpenChange={setIsOpen}>\n      <AlertDialogTrigger asChild>\n        <div\n          className=\"flex w-full flex-col gap-y-2\"\n          onClick={() => setIsOpen(true)}\n          onKeyUp={(e) => {\n            if (e.key === \"Enter\" || e.key === \" \") {\n              setIsOpen(true)\n            }\n          }}\n        >\n          <Button variant=\"secondary\">\n            <RotateCcw className=\"w-4\" />\n            ãƒªã‚»ãƒƒãƒˆ\n          </Button>\n        </div>\n      </AlertDialogTrigger>\n      <AlertDialogContent>\n        <AlertDialogHeader>\n          <AlertDialogTitle>ç¢ºèª</AlertDialogTitle>\n          <AlertDialogDescription>\n            æœ¬å½“ã«ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ\n          </AlertDialogDescription>\n        </AlertDialogHeader>\n        <AlertDialogFooter>\n          <AlertDialogCancel onClick={() => setIsOpen(false)}>\n            ã‚­ãƒ£ãƒ³ã‚»ãƒ«\n          </AlertDialogCancel>\n          <AlertDialogAction onClick={handleNext}>ãƒªã‚»ãƒƒãƒˆ</AlertDialogAction>\n        </AlertDialogFooter>\n      </AlertDialogContent>\n    </AlertDialog>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/config-view/image-model-card.tsx"},"span":[1389,1458],"sourceCode":"import { Badge } from \"~/components/ui/badge\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  displayName: string | null\n  description?: string | null\n  type?: string | null\n  thumbnailImageURL: string | null\n  isActive: boolean\n  onSelect(): void\n}\n\nexport function ImageModelCard (props: Props) {\n  /**\n   * v2ãªã©ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã¯æ®‹ã—ãŸçŠ¶æ…‹ã§ãƒ¢ãƒ‡ãƒ«åã®ã‚¢ãƒ³ãƒ€ãƒ¼ãƒãƒ¼ä»¥é™ã®è©³ç´°æ–‡å­—åˆ—ã‚’å‰Šé™¤ã™ã‚‹\n   * @param input\n   * @returns\n   */\n  const trimString = (input: string) => {\n    if (input === \"blue_pencil-v10\") {\n      return \"blue_pencil\"\n    }\n    if (input === \"lametta_v1745_fp16\") {\n      return \"lametta\"\n    }\n    if (input === \"bluePencil_ex\") {\n      return \"bluePencil_ex\"\n    }\n    if (input === \"animaPencilXL_v310\") {\n      return \"animaPencilXL_v3.1\"\n    }\n\n    const suffix = input.match(/_v\\d+.*$/)?.[0]\n\n    const underscoreIndex = input.indexOf(\"_\")\n\n    if (underscoreIndex !== -1) {\n      return (\n        input.substring(0, underscoreIndex) +\n        (suffix !== undefined ? suffix : \"\")\n      )\n    }\n\n    return input\n  }\n\n  const classes = `flex relative cursor-pointer flex-col rounded-md border border-neutral-1100 bg-neutral-1100 transition-all hover:bg-gray-200 dark:hover:bg-gray-600 ${\n    props.isActive ? \"border-2 border-blue-500\" : \"\"\n  }`\n\n  const t = useTranslation()\n\n  return (\n    <div className={classes} onClick={props.onSelect} onKeyUp={() => {}}>\n      <img\n        className={\n          \"relative w-full rounded-lg border-2 bg-center bg-cover focus:outline-hidden\"\n        }\n        src={props.thumbnailImageURL ?? \"\"}\n        alt={props.displayName ?? \"\"}\n        style={{ transformOrigin: \"center\" }}\n      />\n      <div className=\"\">\n        <span className=\"whitespace-pre-wrap break-words font-bold text-sm\">\n          {trimString(props.displayName ?? \"\")}\n        </span>\n        {props.type && (\n          <div className=\"absolute top-0 left-0\">\n            {props.type === \"FLUX\" && (\n              <Badge variant={\"destructive\"}>{props.type}</Badge>\n            )}\n            {props.displayName === \"flux.1 schnell\" && (\n              <Badge>{t(\"10æšåˆ†æ¶ˆè²»\", \"cost of 10\")}</Badge>\n            )}\n            {props.displayName === \"flux.1 schnell\" && (\n              <Badge>{t(\"è¶…é«˜é€Ÿç”Ÿæˆ\", \"super fast generation\")}</Badge>\n            )}\n            {props.displayName === \"flux.1 pro\" && (\n              <Badge>{t(\"30æšåˆ†æ¶ˆè²»\", \"cost of 30\")}</Badge>\n            )}\n            {props.displayName === \"flux.1 pro\" && (\n              <Badge>{t(\"é«˜é€Ÿç”Ÿæˆ\", \"super fast generation\")}</Badge>\n            )}\n            {(props.type === \"SD5\" ||\n              props.type === \"GEMINI\" ||\n              props.displayName === \"GeminiNanoBanana\") && (\n              <Badge>{t(\"5æšåˆ†æ¶ˆè²»\", \"cost of 5\")}</Badge>\n            )}\n            {props.type !== \"FLUX\" && <Badge>{props.type}</Badge>}\n          </div>\n        )}\n        <div className=\"absolute bottom-8 left-0\">\n          {props.type === \"FLUX\" && (\n            <Badge>{t(\"STANDARDä»¥ä¸Š\", \"super fast generation\")}</Badge>\n          )}\n        </div>\n        {props.description && (\n          <span className=\"whitespace-pre-wrap break-words text-sm\">\n            {props.description}\n          </span>\n        )}\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/generation-task-delete-confirm-dialog.tsx"},"span":[659,807],"sourceCode":"import { XIcon } from \"lucide-react\"\nimport { useState } from \"react\"\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"~/components/ui/alert-dialog\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = {\n  onDelete: () => void\n}\n\nexport function GenerationTaskDeleteConfirmDialog (props: Props) {\n  const t = useTranslation()\n  const [isOpen, setIsOpen] = useState(false)\n\n  return (\n    <AlertDialog open={isOpen} onOpenChange={setIsOpen}>\n      <AlertDialogTrigger asChild>\n        <div\n          onClick={() => setIsOpen(true)}\n          onKeyUp={(e) => {\n            if (e.key === \"Enter\") setIsOpen(true)\n          }}\n        >\n          <XIcon color=\"black\" className=\"fill-white\" />\n        </div>\n      </AlertDialogTrigger>\n      <AlertDialogContent>\n        <AlertDialogHeader>\n          <AlertDialogTitle>{t(\"ç¢ºèª\", \"Confirm\")}</AlertDialogTitle>\n          <AlertDialogDescription>\n            {t(\"æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\", \"Are you sure you want to delete this?\")}\n          </AlertDialogDescription>\n        </AlertDialogHeader>\n        <AlertDialogFooter>\n          <AlertDialogCancel onClick={() => setIsOpen(false)}>\n            {t(\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\", \"Cancel\")}\n          </AlertDialogCancel>\n          <AlertDialogAction\n            onClick={() => {\n              props.onDelete()\n              setIsOpen(false)\n            }}\n          >\n            {t(\"å‰Šé™¤\", \"Delete\")}\n          </AlertDialogAction>\n        </AlertDialogFooter>\n      </AlertDialogContent>\n    </AlertDialog>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/generation-task-editable-card.tsx"},"span":[5732,6170],"sourceCode":"import { SelectableCardButton } from \"~/components/selectable-card-button\"\nimport { Skeleton } from \"~/components/ui/skeleton\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { useGenerationQuery } from \"~/routes/($lang).generation._index/hooks/use-generation-query\"\nimport { useMutation } from \"@apollo/client/index\"\nimport { useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { GenerationConfigContext } from \"~/routes/($lang).generation._index/contexts/generation-config-context\"\nimport { ReservedGenerationCard } from \"~/routes/($lang).generation._index/components/reserved-generation-card\"\nimport { InProgressGenerationCard } from \"~/routes/($lang).generation._index/components/in-progress-generation-card\"\nimport { GenerationTaskZoomUpButton } from \"~/routes/($lang).generation._index/components/generation-task-zoom-up-button\"\nimport { GenerationTaskRatingButton } from \"~/routes/($lang).generation._index/components/generation-task-rating-button\"\nimport { GenerationTaskDeleteButton } from \"~/routes/($lang).generation._index/components/generation-task-delete-button\"\nimport {\n  GenerationResultProtectButtonFragment,\n  GenerationResultProtectButtonTaskFragment,\n} from \"~/routes/($lang).generation._index/components/generation-task-protected-button\"\nimport { graphql, type FragmentOf } from \"gql.tada\"\nimport { normalizeGenerativeFileUrl } from \"~/utils/normalize-generative-file-url\"\nimport { cn } from \"~/lib/utils\"\n\ntype Props = {\n  taskId: string\n  taskNanoid: string | null\n  isSelected?: boolean\n  estimatedSeconds?: number\n  rating: number\n  isProtected: boolean\n  optionButtonSize: number\n  isSelectDisabled: boolean\n  task:\n    | FragmentOf<typeof EditableGenerationResultCardFragment>\n    | FragmentOf<typeof EditableGenerationResultCardTaskFragment>\n  isPreviewByHover?: boolean\n  userToken: string\n  onClick?(): void\n  onCancel?(): void\n  onDelete?(taskId: string): void\n}\n\n/**\n * ç”»åƒç”Ÿæˆã®ç·¨é›†å¯èƒ½ãªå±¥æ­´\n */\nexport function GenerationTaskEditableCard (props: Props) {\n  const context = useGenerationContext()\n\n  const data = useGenerationQuery()\n\n  const [isHovered, setIsHovered] = useState(false)\n\n  const [rating, setRating] = useState(props.rating)\n\n  const [_isProtected, _setIsProtected] = useState(props.isProtected)\n\n  const [cancelTask, { loading: isCanceling }] = useMutation(\n    cancelImageGenerationTaskMutation,\n  )\n\n  const [cancelReservedTask, { loading: isCancelingReservedTask }] =\n    useMutation(cancelImageGenerationReservedTaskMutation)\n\n  const [deleteTask, { loading: isDeletedLoading }] = useMutation(\n    deleteImageGenerationResultMutation,\n  )\n\n  /**\n   * ç”Ÿæˆã‚¿ã‚¹ã‚¯ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹\n   * @param taskNanoid\n   * @returns\n   */\n  const onCancelTask = async (taskNanoid: string | null) => {\n    if (taskNanoid === null) return\n    try {\n      await cancelTask({ variables: { input: { nanoid: taskNanoid } } })\n      if (props.onCancel) {\n        props.onCancel()\n      }\n      toast(\"ã‚¿ã‚¹ã‚¯ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã—ãŸ\")\n    } catch (error) {\n      if (error instanceof Error) {\n        toast(error.message)\n      }\n    }\n  }\n\n  const { send } = GenerationConfigContext.useActorRef()\n\n  /**\n   * ç”Ÿæˆã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã™ã‚‹\n   */\n  const onDeleteTask = async () => {\n    if (props.taskNanoid === null) {\n      toast(\"å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\")\n      return\n    }\n\n    try {\n      await deleteTask({\n        variables: {\n          input: {\n            nanoid: props.taskNanoid,\n          },\n        },\n      })\n      toast(\"å‰Šé™¤ã—ã¾ã—ãŸã€‚\")\n      if (props.onDelete) {\n        props.onDelete(props.taskNanoid)\n      }\n    } catch (_e) {\n      toast(\"å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸã€‚\")\n    }\n  }\n\n  /**\n   * äºˆç´„ç”Ÿæˆã‚¿ã‚¹ã‚¯ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹\n   * @param taskNanoid\n   * @returns\n   */\n  const onCancelReservedTask = async (taskNanoid: string | null) => {\n    if (taskNanoid === null) return\n    try {\n      await cancelReservedTask({ variables: { input: { nanoid: taskNanoid } } })\n      if (props.onCancel) {\n        props.onCancel()\n      }\n      toast(\"äºˆç´„ã‚¿ã‚¹ã‚¯ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã—ãŸ\")\n    } catch (error) {\n      if (error instanceof Error) {\n        toast(error.message)\n      }\n    }\n  }\n\n  /**\n   * å±¥æ­´ç”»åƒä¸Šã«è¡¨ç¤ºã•ã‚Œã‚‹ãƒœã‚¿ãƒ³ã®ã‚µã‚¤ã‚º\n   * @param size ã‚µã‚¤ã‚º\n   * @returns\n   */\n  const optionButtonSize = (size: number) => {\n    if (size < 3) {\n      return 1\n    }\n    if (size < 5) {\n      return 2\n    }\n    return 3\n  }\n\n  if (props.task.status === \"RESERVED\") {\n    return (\n      <ReservedGenerationCard\n        onClick={props.onClick}\n        onCancel={() => onCancelReservedTask(props.task.nanoid)}\n        isCanceling={isCanceling}\n        taskId={props.taskId}\n        isPreviewByHover={props.isPreviewByHover}\n        setIsHovered={setIsHovered}\n      />\n    )\n  }\n\n  if (!props.task.imageUrl) {\n    return (\n      <InProgressGenerationCard\n        onCancel={() => onCancelTask(props.taskNanoid)}\n        isCanceling={isCanceling}\n        inProgressNormalCount={\n          data.engineStatus?.normalPredictionGenerationWait ?? 0\n        }\n        initImageGenerationWaitCount={\n          data.userStatus?.imageGenerationWaitCount ?? 0\n        }\n        imageGenerationWaitCount={\n          data.userStatus?.imageGenerationWaitCount ?? 0\n        }\n      />\n    )\n  }\n\n  const originalImageUrl = props.task.imageUrl\n  const originalThumbnailUrl = props.task.thumbnailUrl ?? \"\"\n\n  const normalizedImageUrl = normalizeGenerativeFileUrl(originalImageUrl)\n  const normalizedThumbnailUrl = originalThumbnailUrl\n    ? normalizeGenerativeFileUrl(originalThumbnailUrl)\n    : originalThumbnailUrl\n\n  return (\n    <div\n      className=\"relative grid h-full overflow-hidden rounded bg-card p-0\"\n      onMouseEnter={() => {\n        if (props.isPreviewByHover) {\n          context.updatePreviewTaskId(props.task.id)\n          send({ type: \"OPEN_HISTORY_PREVIEW\" })\n        }\n        setIsHovered(true)\n      }}\n      onMouseLeave={() => {\n        context.updatePreviewTaskId(null)\n        send({ type: \"CLOSE\" })\n        setIsHovered(false)\n      }}\n    >\n      <SelectableCardButton\n        onClick={props.onClick}\n        isSelected={props.isSelected}\n        isDisabled={props.isSelectDisabled}\n      >\n        {props.task.imageUrl !== \"\" &&\n        props.task.thumbnailUrl !== \"\" &&\n        props.task.thumbnailUrl !== null ? (\n          <img\n            className={cn(`generation-image-${props.taskNanoid}`, \"m-auto\")}\n            src={\n              context.config.taskListThumbnailType === \"light\"\n                ? normalizedThumbnailUrl\n                : normalizedImageUrl\n            }\n            data-original={normalizedImageUrl}\n            data-original-raw={originalImageUrl}\n            data-generative-raw={\n              context.config.taskListThumbnailType === \"light\"\n                ? originalThumbnailUrl\n                : originalImageUrl\n            }\n            onError={(event) => {\n              const img = event.currentTarget\n              const raw = img.dataset.generativeRaw\n              if (!raw) return\n              if (img.dataset.generativeFallback === \"true\") {\n                return\n              }\n              img.dataset.generativeFallback = \"true\"\n              img.src = raw\n\n              // If we fell back for display, also prefer raw for download.\n              const downloadRaw = img.dataset.originalRaw\n              if (downloadRaw) {\n                img.dataset.original = downloadRaw\n              }\n            }}\n            alt={\"-\"}\n          />\n        ) : (\n          <Skeleton className=\"h-[120px] w-[240px] rounded-xl\" />\n        )}\n      </SelectableCardButton>\n      {/* æ‹¡å¤§ãƒœã‚¿ãƒ³ */}\n      {isHovered && props.task.imageUrl && props.task.thumbnailUrl && (\n        <GenerationTaskZoomUpButton\n          taskId={props.taskId}\n          token={props.userToken}\n          size={optionButtonSize(props.optionButtonSize)}\n          setIsHovered={setIsHovered}\n          imageUrl={originalImageUrl}\n          thumbnailUrl={originalThumbnailUrl}\n        />\n      )}\n      {/* ãŠæ°—ã«å…¥ã‚Šãƒœã‚¿ãƒ³ */}\n      {(isHovered || rating !== 0) && props.taskNanoid && (\n        <GenerationTaskRatingButton\n          nowRating={rating}\n          taskNanoid={props.taskNanoid}\n          size={optionButtonSize(props.optionButtonSize)}\n          onRatingChange={(newRating) => {\n            setRating(newRating)\n          }}\n        />\n      )}\n      {/* å‰Šé™¤ãƒœã‚¿ãƒ³ */}\n      {isHovered && props.isSelectDisabled && (\n        <GenerationTaskDeleteButton\n          onDelete={onDeleteTask}\n          isDeletedLoading={isDeletedLoading}\n        />\n      )}\n      {/* ä¿è­·ãƒœã‚¿ãƒ³ */}\n      {/* {(isHovered || isProtected) && props.taskNanoid && (\n        <GenerationTaskProtectedButton\n          isProtected={isProtected}\n          taskNanoid={props.taskNanoid}\n          size={optionButtonSize(props.optionButtonSize)}\n          onProtectedChange={(isProtected) => {\n            setIsProtected(isProtected)\n          }}\n        />\n      )} */}\n    </div>\n  )\n}\n\nexport const EditableGenerationResultCardFragment = graphql(\n  `fragment EditableGenerationResultCard on ImageGenerationResultNode @_unmask {\n    id\n    nanoid\n    status\n    imageUrl\n    thumbnailUrl\n    estimatedSeconds\n    rating\n    ...GenerationResultProtectButton\n  }`,\n  [GenerationResultProtectButtonFragment],\n)\n\nexport const EditableGenerationResultCardTaskFragment = graphql(\n  `fragment EditableGenerationResultCardTask on ImageGenerationTaskNode @_unmask {\n    id\n    nanoid\n    status\n    imageUrl\n    thumbnailUrl\n    estimatedSeconds\n    rating\n    ...GenerationResultProtectButtonTask\n  }`,\n  [GenerationResultProtectButtonTaskFragment],\n)\n\nconst cancelImageGenerationReservedTaskMutation = graphql(\n  `mutation CancelImageGenerationReservedTask($input: CancelImageGenerationReservedTaskInput!) {\n    cancelImageGenerationReservedTask(input: $input) {\n      ...EditableGenerationResultCardTask\n    }\n  }`,\n  [EditableGenerationResultCardTaskFragment],\n)\n\nconst cancelImageGenerationTaskMutation = graphql(\n  `mutation CancelImageGenerationTask($input: CancelImageGenerationTaskInput!) {\n    cancelImageGenerationTask(input: $input) {\n      ...EditableGenerationResultCardTask\n    }\n  }`,\n  [EditableGenerationResultCardTaskFragment],\n)\n\nconst deleteImageGenerationResultMutation = graphql(\n  `mutation deleteImageGenerationResult($input: DeleteImageGenerationResultInput!) {\n    deleteImageGenerationResult(input: $input) {\n      ...EditableGenerationResultCard\n    }\n  }`,\n  [EditableGenerationResultCardFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/generation-task-zoom-up-button.tsx"},"span":[726,822],"sourceCode":"import { GenerationImageDialogButton } from \"~/routes/($lang).generation._index/components/generation-image-dialog-button\"\nimport { ZoomIn } from \"lucide-react\"\n\ntype Props = {\n  taskId: string\n  token: string\n  size: number\n  imageUrl: string\n  thumbnailUrl: string\n  setIsHovered: (isHovered: boolean) => void\n}\n\n/**\n * ç”»åƒç”Ÿæˆã®å±¥æ­´ã®ç”»åƒã‚ºãƒ¼ãƒ ã‚¢ãƒƒãƒ—ãƒœã‚¿ãƒ³\n */\nexport function GenerationTaskZoomUpButton (props: Props) {\n  return (\n    <GenerationImageDialogButton\n      isAbsolute={true}\n      taskId={props.taskId}\n      userToken={props.token}\n      imageUrl={props.imageUrl}\n      thumbnailUrl={props.thumbnailUrl}\n    >\n      <div className=\"flex rounded-lg bg-white px-1 py-1 opacity-80\">\n        <div\n          onMouseEnter={() => {\n            props.setIsHovered(true)\n          }}\n        >\n          <ZoomIn color=\"black\" />\n        </div>\n      </div>\n    </GenerationImageDialogButton>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/generation-work-card .tsx"},"span":[1066,1577],"sourceCode":"import { GenerationConfigContext } from \"~/routes/($lang).generation._index/contexts/generation-config-context\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { GenerationWorkLinkButton } from \"~/routes/($lang).generation._index/components/generation-work-link-button\"\nimport { useState } from \"react\"\nimport { toast } from \"sonner\"\nimport { GenerationWorkZoomUpButton } from \"~/routes/($lang).generation._index/components/generation-work-zoom-up-button\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\nimport { GenerationUpdateSettingConfirmDialog } from \"~/routes/($lang).generation._index/components/generation-update-setting-confirm-dialog\"\n\ntype Props = {\n  work: FragmentOf<typeof GenerationWorkCardFragment>\n  isPreviewByHover: boolean\n}\n\n/**\n * ç”»åƒä½œå“ã‚«ãƒ¼ãƒ‰\n */\nexport function GenerationWorkCard (props: Props) {\n  const [isHovered, setIsHovered] = useState(false)\n\n  const context = useGenerationContext()\n\n  const { send } = GenerationConfigContext.useActorRef()\n\n  return (\n    <div\n      className=\"relative grid h-full overflow-hidden rounded bg-card p-0\"\n      onMouseEnter={() => {\n        if (props.isPreviewByHover) {\n          context.updatePreviewImageURL(props.work.largeThumbnailImageURL)\n          send({ type: \"OPEN_WORK_PREVIEW\" })\n        }\n        setIsHovered(true)\n      }}\n      onMouseLeave={() => {\n        if (props.isPreviewByHover) {\n          context.updatePreviewImageURL(null)\n          send({ type: \"CLOSE\" })\n        }\n        setIsHovered(false)\n      }}\n    >\n      <GenerationUpdateSettingConfirmDialog\n        title={props.work.title}\n        largeThumbnailImageUrl={props.work.largeThumbnailImageURL}\n        onRestore={() => {\n          context.updateSettings(\n            context.config.modelId,\n            props.work.steps ?? context.config.steps,\n            context.config.modelType,\n            props.work.sampler ?? context.config.sampler,\n            props.work.scale ?? context.config.scale,\n            props.work.vae ?? context.config.vae,\n            props.work.prompt,\n            props.work.negativePrompt,\n            -1,\n            context.config.sizeType,\n            context.config.clipSkip,\n            null,\n            null,\n            null,\n            null,\n          )\n          toast(\"è¨­å®šã‚’å¾©å…ƒã—ã¾ã—ãŸ\")\n        }}\n      />\n      {/* æ‹¡å¤§ãƒœã‚¿ãƒ³ */}\n      {isHovered && (\n        <GenerationWorkZoomUpButton\n          imageUrl={props.work.largeThumbnailImageURL}\n          setIsHovered={setIsHovered}\n        />\n      )}\n      {/* ä½œå“ãƒªãƒ³ã‚¯ãƒœã‚¿ãƒ³ */}\n      <GenerationWorkLinkButton\n        id={props.work.id}\n        setIsHovered={setIsHovered}\n      />\n    </div>\n  )\n}\n\nexport const GenerationWorkCardFragment = graphql(\n  `fragment GenerationWorkCard on WorkNode @_unmask {\n    id\n    title\n    steps\n    sampler\n    scale\n    vae\n    prompt\n    negativePrompt\n    largeThumbnailImageURL\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/generation-work-link-button.tsx"},"span":[538,634],"sourceCode":"import { Link } from \"@remix-run/react\"\nimport { ExternalLinkIcon } from \"lucide-react\"\n\ntype Props = {\n  id: string\n  setIsHovered: (isHovered: boolean) => void\n}\n\n/**\n * ç”»åƒç”Ÿæˆä½œå“ã®ãƒªãƒ³ã‚¯ãƒœã‚¿ãƒ³\n */\nexport function GenerationWorkLinkButton (props: Props) {\n  return (\n    <Link\n      className=\"absolute bottom-2 left-2 rounded-full hover:opacity-80\"\n      to={`/posts/${props.id}`}\n      target=\"_blank\"\n      rel=\"noopener noreferrer\"\n    >\n      <div className=\"flex rounded-lg bg-white px-1 py-1 opacity-80\">\n        <div\n          onMouseEnter={() => {\n            props.setIsHovered(true)\n          }}\n        >\n          <ExternalLinkIcon color=\"black\" />\n        </div>\n      </div>\n    </Link>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/generation-work-zoom-up-button.tsx"},"span":[534,630],"sourceCode":"import { GenerationWorkDialogButton } from \"~/routes/($lang).generation._index/components/generation-work-dialog-button\"\nimport { ZoomIn } from \"lucide-react\"\n\ntype Props = {\n  imageUrl: string\n  setIsHovered: (isHovered: boolean) => void\n}\n\n/**\n * ç”»åƒç”Ÿæˆä½œå“ã®ç”»åƒã‚ºãƒ¼ãƒ ã‚¢ãƒƒãƒ—ãƒœã‚¿ãƒ³\n */\nexport function GenerationWorkZoomUpButton (props: Props) {\n  return (\n    <GenerationWorkDialogButton isAbsolute={true} imageUrl={props.imageUrl}>\n      <div className=\"flex rounded-lg bg-white px-1 py-1 opacity-80\">\n        <div\n          onMouseEnter={() => {\n            props.setIsHovered(true)\n          }}\n        >\n          <ZoomIn color=\"black\" />\n        </div>\n      </div>\n    </GenerationWorkDialogButton>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/submission-view/in-painting-setting.tsx"},"span":[1269,1434],"sourceCode":"import { Label } from \"~/components/ui/label\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { Slider } from \"~/components/ui/slider\"\n\ntype Props = {\n  onChangeMaskType(value: string): void\n  onChangeDenoisingStrengthSize(value: string): void\n}\n\nexport function InPaintingSetting (props: Props) {\n  const handleRadioChange = (value: string) => {\n    props.onChangeMaskType(value)\n  }\n  const handleStrengthSizeChange = (\n    event: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    props.onChangeDenoisingStrengthSize(event.target.value)\n  }\n\n  return (\n    <div className=\"flex\">\n      <div className=\"space-y-4\">\n        <div className=\"flex\">\n          <p>{\"ãƒã‚¤ã‚ºé™¤å»å¼·åº¦ï¼š\"}</p>\n          <p>{\"å¼±\"}</p>\n          <Slider\n            onChange={handleStrengthSizeChange}\n            className=\"color-pink w-32\"\n            aria-label=\"slider-ex-2\"\n            max={1}\n            min={0.1}\n            step={0.1}\n            defaultValue={[0.5]}\n          />\n          <p>{\"å¼·\"}</p>\n        </div>\n        <div>\n          <p>{\"ãƒã‚¹ã‚¯æ–¹å¼ï¼š\"}</p>\n          <RadioGroup defaultValue=\"0\">\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"0\")\n                }}\n              >\n                <RadioGroupItem value=\"0\" id=\"r1\" />\n                <Label className=\"color-blue\" htmlFor=\"r1\">\n                  {\"å¡—ã‚Šã¤ã¶ã—\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"1\")\n                }}\n              >\n                <RadioGroupItem value=\"1\" id=\"r2\" />\n                <Label className=\"color-blue\" htmlFor=\"r2\">\n                  {\"ã‚‚ã¨ã«è¿‘ã„\"}\n                </Label>\n              </div>\n            </div>\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"2\")\n                }}\n              >\n                <RadioGroupItem value=\"2\" id=\"r3\" />\n                <Label className=\"color-blue\" htmlFor=\"r3\">\n                  {\"ã‚‚ã¨ã‹ã‚‰å¤§ããå¤‰æ›´\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"3\")\n                }}\n              >\n                <RadioGroupItem value=\"3\" id=\"r4\" />\n                <Label className=\"color-blue\" htmlFor=\"r4\">\n                  {\"ã»ã¼å¤‰ãˆãªã„\"}\n                </Label>\n              </div>\n            </div>\n          </RadioGroup>\n        </div>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/submission-view/in-painting-setting.tsx"},"span":[1728,1893],"sourceCode":"import { Label } from \"~/components/ui/label\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { Slider } from \"~/components/ui/slider\"\n\ntype Props = {\n  onChangeMaskType(value: string): void\n  onChangeDenoisingStrengthSize(value: string): void\n}\n\nexport function InPaintingSetting (props: Props) {\n  const handleRadioChange = (value: string) => {\n    props.onChangeMaskType(value)\n  }\n  const handleStrengthSizeChange = (\n    event: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    props.onChangeDenoisingStrengthSize(event.target.value)\n  }\n\n  return (\n    <div className=\"flex\">\n      <div className=\"space-y-4\">\n        <div className=\"flex\">\n          <p>{\"ãƒã‚¤ã‚ºé™¤å»å¼·åº¦ï¼š\"}</p>\n          <p>{\"å¼±\"}</p>\n          <Slider\n            onChange={handleStrengthSizeChange}\n            className=\"color-pink w-32\"\n            aria-label=\"slider-ex-2\"\n            max={1}\n            min={0.1}\n            step={0.1}\n            defaultValue={[0.5]}\n          />\n          <p>{\"å¼·\"}</p>\n        </div>\n        <div>\n          <p>{\"ãƒã‚¹ã‚¯æ–¹å¼ï¼š\"}</p>\n          <RadioGroup defaultValue=\"0\">\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"0\")\n                }}\n              >\n                <RadioGroupItem value=\"0\" id=\"r1\" />\n                <Label className=\"color-blue\" htmlFor=\"r1\">\n                  {\"å¡—ã‚Šã¤ã¶ã—\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"1\")\n                }}\n              >\n                <RadioGroupItem value=\"1\" id=\"r2\" />\n                <Label className=\"color-blue\" htmlFor=\"r2\">\n                  {\"ã‚‚ã¨ã«è¿‘ã„\"}\n                </Label>\n              </div>\n            </div>\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"2\")\n                }}\n              >\n                <RadioGroupItem value=\"2\" id=\"r3\" />\n                <Label className=\"color-blue\" htmlFor=\"r3\">\n                  {\"ã‚‚ã¨ã‹ã‚‰å¤§ããå¤‰æ›´\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"3\")\n                }}\n              >\n                <RadioGroupItem value=\"3\" id=\"r4\" />\n                <Label className=\"color-blue\" htmlFor=\"r4\">\n                  {\"ã»ã¼å¤‰ãˆãªã„\"}\n                </Label>\n              </div>\n            </div>\n          </RadioGroup>\n        </div>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/submission-view/in-painting-setting.tsx"},"span":[2241,2406],"sourceCode":"import { Label } from \"~/components/ui/label\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { Slider } from \"~/components/ui/slider\"\n\ntype Props = {\n  onChangeMaskType(value: string): void\n  onChangeDenoisingStrengthSize(value: string): void\n}\n\nexport function InPaintingSetting (props: Props) {\n  const handleRadioChange = (value: string) => {\n    props.onChangeMaskType(value)\n  }\n  const handleStrengthSizeChange = (\n    event: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    props.onChangeDenoisingStrengthSize(event.target.value)\n  }\n\n  return (\n    <div className=\"flex\">\n      <div className=\"space-y-4\">\n        <div className=\"flex\">\n          <p>{\"ãƒã‚¤ã‚ºé™¤å»å¼·åº¦ï¼š\"}</p>\n          <p>{\"å¼±\"}</p>\n          <Slider\n            onChange={handleStrengthSizeChange}\n            className=\"color-pink w-32\"\n            aria-label=\"slider-ex-2\"\n            max={1}\n            min={0.1}\n            step={0.1}\n            defaultValue={[0.5]}\n          />\n          <p>{\"å¼·\"}</p>\n        </div>\n        <div>\n          <p>{\"ãƒã‚¹ã‚¯æ–¹å¼ï¼š\"}</p>\n          <RadioGroup defaultValue=\"0\">\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"0\")\n                }}\n              >\n                <RadioGroupItem value=\"0\" id=\"r1\" />\n                <Label className=\"color-blue\" htmlFor=\"r1\">\n                  {\"å¡—ã‚Šã¤ã¶ã—\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"1\")\n                }}\n              >\n                <RadioGroupItem value=\"1\" id=\"r2\" />\n                <Label className=\"color-blue\" htmlFor=\"r2\">\n                  {\"ã‚‚ã¨ã«è¿‘ã„\"}\n                </Label>\n              </div>\n            </div>\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"2\")\n                }}\n              >\n                <RadioGroupItem value=\"2\" id=\"r3\" />\n                <Label className=\"color-blue\" htmlFor=\"r3\">\n                  {\"ã‚‚ã¨ã‹ã‚‰å¤§ããå¤‰æ›´\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"3\")\n                }}\n              >\n                <RadioGroupItem value=\"3\" id=\"r4\" />\n                <Label className=\"color-blue\" htmlFor=\"r4\">\n                  {\"ã»ã¼å¤‰ãˆãªã„\"}\n                </Label>\n              </div>\n            </div>\n          </RadioGroup>\n        </div>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/submission-view/in-painting-setting.tsx"},"span":[2712,2877],"sourceCode":"import { Label } from \"~/components/ui/label\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { Slider } from \"~/components/ui/slider\"\n\ntype Props = {\n  onChangeMaskType(value: string): void\n  onChangeDenoisingStrengthSize(value: string): void\n}\n\nexport function InPaintingSetting (props: Props) {\n  const handleRadioChange = (value: string) => {\n    props.onChangeMaskType(value)\n  }\n  const handleStrengthSizeChange = (\n    event: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    props.onChangeDenoisingStrengthSize(event.target.value)\n  }\n\n  return (\n    <div className=\"flex\">\n      <div className=\"space-y-4\">\n        <div className=\"flex\">\n          <p>{\"ãƒã‚¤ã‚ºé™¤å»å¼·åº¦ï¼š\"}</p>\n          <p>{\"å¼±\"}</p>\n          <Slider\n            onChange={handleStrengthSizeChange}\n            className=\"color-pink w-32\"\n            aria-label=\"slider-ex-2\"\n            max={1}\n            min={0.1}\n            step={0.1}\n            defaultValue={[0.5]}\n          />\n          <p>{\"å¼·\"}</p>\n        </div>\n        <div>\n          <p>{\"ãƒã‚¹ã‚¯æ–¹å¼ï¼š\"}</p>\n          <RadioGroup defaultValue=\"0\">\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"0\")\n                }}\n              >\n                <RadioGroupItem value=\"0\" id=\"r1\" />\n                <Label className=\"color-blue\" htmlFor=\"r1\">\n                  {\"å¡—ã‚Šã¤ã¶ã—\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"1\")\n                }}\n              >\n                <RadioGroupItem value=\"1\" id=\"r2\" />\n                <Label className=\"color-blue\" htmlFor=\"r2\">\n                  {\"ã‚‚ã¨ã«è¿‘ã„\"}\n                </Label>\n              </div>\n            </div>\n            <div className=\"flex\">\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"2\")\n                }}\n              >\n                <RadioGroupItem value=\"2\" id=\"r3\" />\n                <Label className=\"color-blue\" htmlFor=\"r3\">\n                  {\"ã‚‚ã¨ã‹ã‚‰å¤§ããå¤‰æ›´\"}\n                </Label>\n              </div>\n              {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n              <div\n                className=\"w-48 flex-col space-x-5\"\n                onClick={() => {\n                  handleRadioChange(\"3\")\n                }}\n              >\n                <RadioGroupItem value=\"3\" id=\"r4\" />\n                <Label className=\"color-blue\" htmlFor=\"r4\">\n                  {\"ã»ã¼å¤‰ãˆãªã„\"}\n                </Label>\n              </div>\n            </div>\n          </RadioGroup>\n        </div>\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[926,942],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useCachedImageGenerationTask } from \"~/routes/($lang).generation._index/hooks/use-cached-image-generation-task\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { GenerationTaskSheetView } from \"~/routes/($lang).generation._index/components/generation-task-sheet-view\"\nimport { Suspense, useContext } from \"react\"\nimport { useCachedImageGenerationResult } from \"~/routes/($lang).generation._index/hooks/use-cached-image-generation-result\"\n\n/**\n * ç”»åƒç”Ÿæˆå±¥æ­´ã®è©³ç´°\n */\nexport function GenerationTaskDetails () {\n  const context = useGenerationContext()\n\n  const authContext = useContext(AuthContext)\n\n  if (authContext === null || context.config.viewTaskId === null) {\n    return null\n  }\n\n  const imageGenerationTask = useCachedImageGenerationTask(\n    context.config.viewTaskId,\n  )\n\n  const imageGenerationResult = useCachedImageGenerationResult(\n    context.config.viewTaskId,\n  )\n\n  return (\n    <>\n      <ScrollArea className=\"absolute pb-64 md:pb-8\">\n        <Suspense fallback={<AppLoadingPage />}>\n          {imageGenerationTask && (\n            <GenerationTaskSheetView task={imageGenerationTask} />\n          )}\n          {imageGenerationResult && (\n            <GenerationTaskSheetView task={imageGenerationResult} />\n          )}\n        </Suspense>\n      </ScrollArea>\n    </>\n  )\n}\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/task-view/generation-task-details.tsx"},"span":[978,1006],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useCachedImageGenerationTask } from \"~/routes/($lang).generation._index/hooks/use-cached-image-generation-task\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { GenerationTaskSheetView } from \"~/routes/($lang).generation._index/components/generation-task-sheet-view\"\nimport { Suspense, useContext } from \"react\"\nimport { useCachedImageGenerationResult } from \"~/routes/($lang).generation._index/hooks/use-cached-image-generation-result\"\n\n/**\n * ç”»åƒç”Ÿæˆå±¥æ­´ã®è©³ç´°\n */\nexport function GenerationTaskDetails () {\n  const context = useGenerationContext()\n\n  const authContext = useContext(AuthContext)\n\n  if (authContext === null || context.config.viewTaskId === null) {\n    return null\n  }\n\n  const imageGenerationTask = useCachedImageGenerationTask(\n    context.config.viewTaskId,\n  )\n\n  const imageGenerationResult = useCachedImageGenerationResult(\n    context.config.viewTaskId,\n  )\n\n  return (\n    <>\n      <ScrollArea className=\"absolute pb-64 md:pb-8\">\n        <Suspense fallback={<AppLoadingPage />}>\n          {imageGenerationTask && (\n            <GenerationTaskSheetView task={imageGenerationTask} />\n          )}\n          {imageGenerationResult && (\n            <GenerationTaskSheetView task={imageGenerationResult} />\n          )}\n        </Suspense>\n      </ScrollArea>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[926,942],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useCachedImageGenerationTask } from \"~/routes/($lang).generation._index/hooks/use-cached-image-generation-task\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { GenerationTaskSheetView } from \"~/routes/($lang).generation._index/components/generation-task-sheet-view\"\nimport { Suspense, useContext } from \"react\"\nimport { useCachedImageGenerationResult } from \"~/routes/($lang).generation._index/hooks/use-cached-image-generation-result\"\n\n/**\n * ç”»åƒç”Ÿæˆå±¥æ­´ã®è©³ç´°\n */\nexport function GenerationTaskDetails () {\n  const context = useGenerationContext()\n\n  const authContext = useContext(AuthContext)\n\n  if (authContext === null || context.config.viewTaskId === null) {\n    return null\n  }\n\n  const imageGenerationTask = useCachedImageGenerationTask(\n    context.config.viewTaskId,\n  )\n\n  const imageGenerationResult = useCachedImageGenerationResult(\n    context.config.viewTaskId,\n  )\n\n  return (\n    <>\n      <ScrollArea className=\"absolute pb-64 md:pb-8\">\n        <Suspense fallback={<AppLoadingPage />}>\n          {imageGenerationTask && (\n            <GenerationTaskSheetView task={imageGenerationTask} />\n          )}\n          {imageGenerationResult && (\n            <GenerationTaskSheetView task={imageGenerationResult} />\n          )}\n        </Suspense>\n      </ScrollArea>\n    </>\n  )\n}\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).generation._index/components/task-view/generation-task-details.tsx"},"span":[1076,1106],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useCachedImageGenerationTask } from \"~/routes/($lang).generation._index/hooks/use-cached-image-generation-task\"\nimport { useGenerationContext } from \"~/routes/($lang).generation._index/hooks/use-generation-context\"\nimport { GenerationTaskSheetView } from \"~/routes/($lang).generation._index/components/generation-task-sheet-view\"\nimport { Suspense, useContext } from \"react\"\nimport { useCachedImageGenerationResult } from \"~/routes/($lang).generation._index/hooks/use-cached-image-generation-result\"\n\n/**\n * ç”»åƒç”Ÿæˆå±¥æ­´ã®è©³ç´°\n */\nexport function GenerationTaskDetails () {\n  const context = useGenerationContext()\n\n  const authContext = useContext(AuthContext)\n\n  if (authContext === null || context.config.viewTaskId === null) {\n    return null\n  }\n\n  const imageGenerationTask = useCachedImageGenerationTask(\n    context.config.viewTaskId,\n  )\n\n  const imageGenerationResult = useCachedImageGenerationResult(\n    context.config.viewTaskId,\n  )\n\n  return (\n    <>\n      <ScrollArea className=\"absolute pb-64 md:pb-8\">\n        <Suspense fallback={<AppLoadingPage />}>\n          {imageGenerationTask && (\n            <GenerationTaskSheetView task={imageGenerationTask} />\n          )}\n          {imageGenerationResult && (\n            <GenerationTaskSheetView task={imageGenerationResult} />\n          )}\n        </Suspense>\n      </ScrollArea>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/album-delete-confirm-dialog.tsx"},"span":[686,851],"sourceCode":"import { TrashIcon } from \"lucide-react\"\nimport { useState } from \"react\"\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"~/components/ui/alert-dialog\"\ntype Props = {\n  onDelete: () => Promise<void>\n  seriesTitle: string\n}\n\nexport function AlbumDeleteConfirmDialog (props: Props) {\n  const [isOpen, setIsOpen] = useState(false)\n\n  const handleNext = async () => {\n    await props.onDelete()\n    setIsOpen(false)\n  }\n\n  return (\n    <AlertDialog open={isOpen} onOpenChange={setIsOpen}>\n      <AlertDialogTrigger asChild>\n        <div\n          onClick={() => setIsOpen(true)}\n          onKeyUp={(e) => {\n            if (e.key === \"Enter\" || e.key === \" \") setIsOpen(true)\n          }}\n        >\n          <TrashIcon />\n        </div>\n      </AlertDialogTrigger>\n      <AlertDialogContent>\n        <AlertDialogHeader>\n          <AlertDialogTitle>ç¢ºèª</AlertDialogTitle>\n          <AlertDialogDescription>\n            {`ã‚·ãƒªãƒ¼ã‚ºã€Œ${props.seriesTitle}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`}\n          </AlertDialogDescription>\n        </AlertDialogHeader>\n        <AlertDialogFooter>\n          <AlertDialogCancel onClick={() => setIsOpen(false)}>\n            ã‚­ãƒ£ãƒ³ã‚»ãƒ«\n          </AlertDialogCancel>\n          <AlertDialogAction onClick={handleNext}>å‰Šé™¤</AlertDialogAction>\n        </AlertDialogFooter>\n      </AlertDialogContent>\n    </AlertDialog>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/albums-list-column.tsx"},"span":[539,595],"sourceCode":"import type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport type { SortType } from \"~/types/sort-type\"\nimport { ChevronDown, ChevronUp } from \"lucide-react\"\n\ntype Props = {\n  label: string\n  orderBy: IntrospectionEnum<\"AlbumOrderBy\">\n  nowOrderBy: IntrospectionEnum<\"AlbumOrderBy\">\n  sort: SortType\n  onClick: () => void\n}\n\n/**\n * ã‚·ãƒªãƒ¼ã‚ºä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ \n */\nexport function AlbumsListColumn (props: Props) {\n  return (\n    <>\n      {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n      <div onClick={props.onClick} className=\"cursor-pointer\">\n        <div className=\"flex items-center\">\n          {props.label}\n          {props.orderBy === props.nowOrderBy &&\n            (props.sort === \"ASC\" ? <ChevronUp /> : <ChevronDown />)}\n        </div>\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[1151,1167],"sourceCode":"import type { SortType } from \"~/types/sort-type\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext } from \"react\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { useSuspenseQuery } from \"@apollo/client/index\"\nimport {\n  AlbumListItemFragment,\n  AlbumsList,\n} from \"~/routes/($lang).my._index/components/albums-list\"\nimport { WorksSeriesAddButton } from \"~/routes/($lang).my._index/components/works-series-add-button\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { graphql } from \"gql.tada\"\n\ntype Props = {\n  page: number\n  sort: SortType\n  orderBy: IntrospectionEnum<\"AlbumOrderBy\">\n  albumsMaxCount: number\n  rating: IntrospectionEnum<\"AlbumRating\"> | null\n  setAlbumPage: (page: number) => void\n  onClickAlbumTitleSortButton: () => void\n  onClickAlbumDateSortButton: () => void\n}\n\n/**\n * ã‚·ãƒªãƒ¼ã‚ºä¸€è¦§ã‚³ãƒ³ãƒ†ãƒŠ\n */\nexport function AlbumsListContainer (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  if (\n    authContext.isLoading ||\n    authContext.isNotLoggedIn ||\n    authContext.userId === undefined ||\n    !authContext.userId\n  ) {\n    return null\n  }\n  const { data: albumsResp, refetch } = useSuspenseQuery(viewerAlbumsQuery, {\n    skip:\n      authContext.isLoading || authContext.isNotLoggedIn || !authContext.userId,\n    variables: {\n      offset: 16 * props.page,\n      limit: 16,\n      where: {\n        orderBy: props.orderBy,\n        sort: props.sort,\n      },\n    },\n  })\n\n  const albums = albumsResp?.viewer?.albums ?? []\n\n  const refetchAlbums = () => {\n    refetch()\n  }\n\n  return (\n    <>\n      <div className=\"mb-2\">\n        <WorksSeriesAddButton refetch={refetchAlbums} />\n      </div>\n      <AlbumsList\n        albums={albums}\n        sort={props.sort}\n        orderBy={props.orderBy}\n        onClickTitleSortButton={props.onClickAlbumTitleSortButton}\n        onClickDateSortButton={props.onClickAlbumDateSortButton}\n      />\n      <div className=\"h-8\" />\n      <div className=\"-translate-x-1/2 fixed bottom-0 left-1/2 z-10 w-full border-border/40 bg-background/95 p-2 backdrop-blur-sm supports-backdrop-filter:bg-background/80\">\n        <ResponsivePagination\n          perPage={16}\n          maxCount={props.albumsMaxCount}\n          currentPage={props.page}\n          onPageChange={(page: number) => {\n            props.setAlbumPage(page)\n          }}\n        />\n      </div>\n    </>\n  )\n}\n\nconst viewerAlbumsQuery = graphql(\n  `query ViewerAlbums($offset: Int!, $limit: Int!, $where: ViewerAlbumsWhereInput) {\n    viewer {\n      albums(offset: $offset, limit: $limit, where: $where) {\n        ...AlbumListItem\n      }\n    }\n  }`,\n  [AlbumListItemFragment],\n)\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/albums-list-container.tsx"},"span":[1212,1228],"sourceCode":"import type { SortType } from \"~/types/sort-type\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext } from \"react\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { useSuspenseQuery } from \"@apollo/client/index\"\nimport {\n  AlbumListItemFragment,\n  AlbumsList,\n} from \"~/routes/($lang).my._index/components/albums-list\"\nimport { WorksSeriesAddButton } from \"~/routes/($lang).my._index/components/works-series-add-button\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport { graphql } from \"gql.tada\"\n\ntype Props = {\n  page: number\n  sort: SortType\n  orderBy: IntrospectionEnum<\"AlbumOrderBy\">\n  albumsMaxCount: number\n  rating: IntrospectionEnum<\"AlbumRating\"> | null\n  setAlbumPage: (page: number) => void\n  onClickAlbumTitleSortButton: () => void\n  onClickAlbumDateSortButton: () => void\n}\n\n/**\n * ã‚·ãƒªãƒ¼ã‚ºä¸€è¦§ã‚³ãƒ³ãƒ†ãƒŠ\n */\nexport function AlbumsListContainer (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  if (\n    authContext.isLoading ||\n    authContext.isNotLoggedIn ||\n    authContext.userId === undefined ||\n    !authContext.userId\n  ) {\n    return null\n  }\n  const { data: albumsResp, refetch } = useSuspenseQuery(viewerAlbumsQuery, {\n    skip:\n      authContext.isLoading || authContext.isNotLoggedIn || !authContext.userId,\n    variables: {\n      offset: 16 * props.page,\n      limit: 16,\n      where: {\n        orderBy: props.orderBy,\n        sort: props.sort,\n      },\n    },\n  })\n\n  const albums = albumsResp?.viewer?.albums ?? []\n\n  const refetchAlbums = () => {\n    refetch()\n  }\n\n  return (\n    <>\n      <div className=\"mb-2\">\n        <WorksSeriesAddButton refetch={refetchAlbums} />\n      </div>\n      <AlbumsList\n        albums={albums}\n        sort={props.sort}\n        orderBy={props.orderBy}\n        onClickTitleSortButton={props.onClickAlbumTitleSortButton}\n        onClickDateSortButton={props.onClickAlbumDateSortButton}\n      />\n      <div className=\"h-8\" />\n      <div className=\"-translate-x-1/2 fixed bottom-0 left-1/2 z-10 w-full border-border/40 bg-background/95 p-2 backdrop-blur-sm supports-backdrop-filter:bg-background/80\">\n        <ResponsivePagination\n          perPage={16}\n          maxCount={props.albumsMaxCount}\n          currentPage={props.page}\n          onPageChange={(page: number) => {\n            props.setAlbumPage(page)\n          }}\n        />\n      </div>\n    </>\n  )\n}\n\nconst viewerAlbumsQuery = graphql(\n  `query ViewerAlbums($offset: Int!, $limit: Int!, $where: ViewerAlbumsWhereInput) {\n    viewer {\n      albums(offset: $offset, limit: $limit, where: $where) {\n        ...AlbumListItem\n      }\n    }\n  }`,\n  [AlbumListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[828,844],"sourceCode":"import { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext } from \"react\"\nimport { BookmarkWorksList } from \"~/routes/($lang).my._index/components/bookmark-works-list\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { BookmarkWorksTableItemFragment } from \"~/routes/($lang).my._index/components/bookmark-works-list-table\"\n\ntype Props = {\n  page: number\n  maxCount: number\n  setPage: (page: number) => void\n}\n\n/**\n * ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ä¸€è¦§ã‚³ãƒ³ãƒ†ãƒŠ\n */\nexport function BookmarkListContainer (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  if (\n    authContext.isLoading ||\n    authContext.isNotLoggedIn ||\n    authContext.userId === undefined ||\n    !authContext.userId\n  ) {\n    return null\n  }\n  const { data: userResp, refetch } = useQuery(userQuery, {\n    skip:\n      authContext.isLoading || authContext.isNotLoggedIn || !authContext.userId,\n    variables: {\n      bookmarksOffset: 16 * props.page,\n      bookmarksLimit: 16,\n      userId: decodeURIComponent(authContext.userId),\n    },\n  })\n\n  const works = userResp?.user?.bookmarkWorks ?? []\n\n  return (\n    <>\n      <BookmarkWorksList works={works} />\n      <div className=\"h-8\" />\n      <div className=\"-translate-x-1/2 fixed bottom-0 left-1/2 z-10 w-full border-border/40 bg-background/95 p-2 backdrop-blur-sm supports-backdrop-filter:bg-background/80\">\n        <ResponsivePagination\n          perPage={16}\n          maxCount={props.maxCount}\n          currentPage={props.page}\n          onPageChange={(page: number) => {\n            props.setPage(page)\n          }}\n        />\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n    $bookmarksOffset: Int!,\n    $bookmarksLimit: Int!,\n    $bookmarksWhere: UserWorksWhereInput,\n  ) {\n    user(id: $userId) {\n      id\n      bookmarkWorks(offset: $bookmarksOffset, limit: $bookmarksLimit, where: $bookmarksWhere) {\n        ...BookmarkWorksTableItem\n      }\n    }\n  }`,\n  [BookmarkWorksTableItemFragment],\n)\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/bookmark-list-container.tsx"},"span":[887,895],"sourceCode":"import { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext } from \"react\"\nimport { BookmarkWorksList } from \"~/routes/($lang).my._index/components/bookmark-works-list\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport { BookmarkWorksTableItemFragment } from \"~/routes/($lang).my._index/components/bookmark-works-list-table\"\n\ntype Props = {\n  page: number\n  maxCount: number\n  setPage: (page: number) => void\n}\n\n/**\n * ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ä¸€è¦§ã‚³ãƒ³ãƒ†ãƒŠ\n */\nexport function BookmarkListContainer (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  if (\n    authContext.isLoading ||\n    authContext.isNotLoggedIn ||\n    authContext.userId === undefined ||\n    !authContext.userId\n  ) {\n    return null\n  }\n  const { data: userResp, refetch } = useQuery(userQuery, {\n    skip:\n      authContext.isLoading || authContext.isNotLoggedIn || !authContext.userId,\n    variables: {\n      bookmarksOffset: 16 * props.page,\n      bookmarksLimit: 16,\n      userId: decodeURIComponent(authContext.userId),\n    },\n  })\n\n  const works = userResp?.user?.bookmarkWorks ?? []\n\n  return (\n    <>\n      <BookmarkWorksList works={works} />\n      <div className=\"h-8\" />\n      <div className=\"-translate-x-1/2 fixed bottom-0 left-1/2 z-10 w-full border-border/40 bg-background/95 p-2 backdrop-blur-sm supports-backdrop-filter:bg-background/80\">\n        <ResponsivePagination\n          perPage={16}\n          maxCount={props.maxCount}\n          currentPage={props.page}\n          onPageChange={(page: number) => {\n            props.setPage(page)\n          }}\n        />\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n    $bookmarksOffset: Int!,\n    $bookmarksLimit: Int!,\n    $bookmarksWhere: UserWorksWhereInput,\n  ) {\n    user(id: $userId) {\n      id\n      bookmarkWorks(offset: $bookmarksOffset, limit: $bookmarksLimit, where: $bookmarksWhere) {\n        ...BookmarkWorksTableItem\n      }\n    }\n  }`,\n  [BookmarkWorksTableItemFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/cropped-my-work-square.tsx"},"span":[2316,2728],"sourceCode":"import { Images } from \"lucide-react\"\nimport { useState } from \"react\"\nimport { cn } from \"~/lib/utils\"\n\ntype Props = {\n  workId: string\n  imageUrl: string\n  thumbnailImagePosition: number\n  size: \"xs\" | \"sm\" | \"md\" | \"lg\" | \"auto\"\n  imageWidth: number\n  imageHeight: number\n  ranking?: number\n  subWorksCount?: number\n}\n\n/**\n * å››è§’å½¢ã§ä½œå“ã‚’ã‚¯ãƒ­ãƒƒãƒ—ã—ã¦è¡¨ç¤ºã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ\n */\nexport function CroppedMyWorkSquare (props: Props) {\n  const [isHovered, setIsHovered] = useState(false)\n\n  /**\n   * é©åˆ‡ãªã‚¯ãƒ­ãƒƒãƒ—ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¨ˆç®—ã™ã‚‹\n   * å››è§’å½¢ã‚³ãƒ³ãƒ†ãƒŠã«å¯¾ã—ã¦ç”»åƒã‚’ã‚¯ãƒ­ãƒƒãƒ—ã—ã¦è¡¨ç¤º\n   */\n  const getCropStyle = (\n    imageWidth: number,\n    imageHeight: number,\n    thumbnailPosition: number,\n  ) => {\n    const aspectRatio = imageWidth / imageHeight\n\n    if (aspectRatio > 1) {\n      // æ¨ªé•·ç”»åƒ: é«˜ã•ã‚’100%ã«ã—ã¦ã€æ¨ªæ–¹å‘ã§ã‚¯ãƒ­ãƒƒãƒ—\n      const scale = 1.05 // è‹¥å¹²æ‹¡å¤§ã—ã¦ã‚¯ãƒ­ãƒƒãƒ—é ˜åŸŸã‚’ç¢ºä¿\n      const translateX =\n        thumbnailPosition || -((aspectRatio - 1) / (2 * aspectRatio)) * 100\n\n      return {\n        width: \"auto\",\n        height: \"100%\",\n        transform: `translateX(${translateX}%) scale(${scale})`,\n        minWidth: \"100%\",\n        objectFit: \"cover\" as const,\n      }\n    }\n\n    if (aspectRatio < 1) {\n      // ç¸¦é•·ç”»åƒ: å¹…ã‚’100%ã«ã—ã¦ã€ç¸¦æ–¹å‘ã§ã‚¯ãƒ­ãƒƒãƒ—\n      const scale = 1.05\n      const translateY = thumbnailPosition || -((1 - aspectRatio) * 50)\n\n      return {\n        width: \"100%\",\n        height: \"auto\",\n        transform: `translateY(${translateY}%) scale(${scale})`,\n        minHeight: \"100%\",\n        objectFit: \"cover\" as const,\n      }\n    }\n\n    // æ­£æ–¹å½¢ç”»åƒ: ãã®ã¾ã¾è¡¨ç¤º\n    return {\n      width: \"100%\",\n      height: \"100%\",\n      transform: \"scale(1.05)\",\n      objectFit: \"cover\" as const,\n    }\n  }\n\n  const cropStyle = getCropStyle(\n    props.imageWidth,\n    props.imageHeight,\n    props.thumbnailImagePosition,\n  )\n\n  const backgroundColor = () => {\n    if (props.ranking === 1) return \"#d6ba49\"\n    if (props.ranking === 2) return \"#858585\"\n    if (props.ranking === 3) return \"#c8a17e\"\n    return \"#00000052\"\n  }\n\n  return (\n    <div className=\"inline-box relative\">\n      <div className=\"transition-all duration-300 ease-in-out\">\n        <div\n          onMouseEnter={() => setIsHovered(true)}\n          onMouseLeave={() => setIsHovered(false)}\n          className={cn(\"relative overflow-hidden rounded\", {\n            \"w-full\": props.size === \"auto\",\n            \"size-16\": props.size === \"xs\",\n            \"size-20\": props.size === \"sm\",\n            \"size-32\": props.size === \"md\",\n            \"size-40\": props.size === \"lg\",\n          })}\n        >\n          <img\n            src={props.imageUrl}\n            alt=\"\"\n            key={props.imageUrl}\n            style={{\n              ...cropStyle,\n              transform: `${cropStyle.transform} ${isHovered ? \"scale(1.05)\" : \"scale(1)\"}`,\n            }}\n            className=\"max-w-none rounded transition-transform duration-300 ease-in-out\"\n          />\n        </div>\n        {props.ranking && (\n          <div\n            className=\"absolute bottom-2 left-2 flex size-6 items-center justify-center rounded-full font-bold text-white text-xs\"\n            style={{ backgroundColor: backgroundColor() }}\n          >\n            {props.ranking}\n          </div>\n        )}\n        {props.subWorksCount !== undefined && props.subWorksCount !== 0 && (\n          <div className=\"absolute top-1 right-1 flex items-center space-x-1 rounded-xl bg-zinc-800 bg-opacity-50 p-1 px-2\">\n            <Images className=\"size-3 text-white\" />\n            <div className=\"font-bold text-white text-xs\">\n              {props.subWorksCount + 1}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/delete-folder-confirm-dialog.tsx"},"span":[688,855],"sourceCode":"import { TrashIcon } from \"lucide-react\"\nimport { useState } from \"react\"\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"~/components/ui/alert-dialog\"\n\ntype Props = {\n  onDelete: () => Promise<void>\n  folderTitle: string\n}\n\nexport function DeleteFolderConfirmDialog (props: Props) {\n  const [isOpen, setIsOpen] = useState(false)\n\n  const handleNext = async () => {\n    await props.onDelete()\n    setIsOpen(false)\n  }\n\n  return (\n    <AlertDialog open={isOpen} onOpenChange={setIsOpen}>\n      <AlertDialogTrigger asChild>\n        <div\n          onClick={() => setIsOpen(true)}\n          onKeyDown={(e) => {\n            if (e.key === \"Enter\" || e.key === \" \") setIsOpen(true)\n          }}\n        >\n          <TrashIcon />\n        </div>\n      </AlertDialogTrigger>\n      <AlertDialogContent>\n        <AlertDialogHeader>\n          <AlertDialogTitle>ç¢ºèª</AlertDialogTitle>\n          <AlertDialogDescription>\n            {`ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã€Œ${props.folderTitle}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`}\n          </AlertDialogDescription>\n        </AlertDialogHeader>\n        <AlertDialogFooter>\n          <AlertDialogCancel onClick={() => setIsOpen(false)}>\n            ã‚­ãƒ£ãƒ³ã‚»ãƒ«\n          </AlertDialogCancel>\n          <AlertDialogAction onClick={handleNext}>å‰Šé™¤</AlertDialogAction>\n        </AlertDialogFooter>\n      </AlertDialogContent>\n    </AlertDialog>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/delete-work-confirm-dialog.tsx"},"span":[684,832],"sourceCode":"import { TrashIcon } from \"lucide-react\"\nimport { useState } from \"react\"\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"~/components/ui/alert-dialog\"\n\ntype Props = {\n  onDelete: () => Promise<void>\n  workTitle: string\n}\n\nexport function DeleteWorkConfirmDialog (props: Props) {\n  const [isOpen, setIsOpen] = useState(false)\n\n  const handleNext = async () => {\n    await props.onDelete()\n    setIsOpen(false)\n  }\n\n  return (\n    <AlertDialog open={isOpen} onOpenChange={setIsOpen}>\n      <AlertDialogTrigger asChild>\n        <div\n          onClick={() => setIsOpen(true)}\n          onKeyUp={(e) => {\n            if (e.key === \"Enter\") setIsOpen(true)\n          }}\n        >\n          <TrashIcon />\n        </div>\n      </AlertDialogTrigger>\n      <AlertDialogContent>\n        <AlertDialogHeader>\n          <AlertDialogTitle>ç¢ºèª</AlertDialogTitle>\n          <AlertDialogDescription>\n            {`ä½œå“ã€Œ${props.workTitle}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`}\n          </AlertDialogDescription>\n        </AlertDialogHeader>\n        <AlertDialogFooter>\n          <AlertDialogCancel onClick={() => setIsOpen(false)}>\n            ã‚­ãƒ£ãƒ³ã‚»ãƒ«\n          </AlertDialogCancel>\n          <AlertDialogAction onClick={handleNext}>å‰Šé™¤</AlertDialogAction>\n        </AlertDialogFooter>\n      </AlertDialogContent>\n    </AlertDialog>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/folders-list-column.tsx"},"span":[542,598],"sourceCode":"import type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport type { SortType } from \"~/types/sort-type\"\nimport { ChevronDown, ChevronUp } from \"lucide-react\"\n\ntype Props = {\n  label: string\n  orderBy: IntrospectionEnum<\"FolderOrderBy\">\n  nowOrderBy: IntrospectionEnum<\"FolderOrderBy\">\n  sort: SortType\n  onClick: () => void\n}\n\n/**\n * ã‚·ãƒªãƒ¼ã‚ºä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ \n */\nexport function FoldersListColumn (props: Props) {\n  return (\n    <>\n      {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n      <div onClick={props.onClick} className=\"cursor-pointer\">\n        <div className=\"flex items-center\">\n          {props.label}\n          {props.orderBy === props.nowOrderBy &&\n            (props.sort === \"ASC\" ? <ChevronUp /> : <ChevronDown />)}\n        </div>\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[1009,1025],"sourceCode":"import { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext } from \"react\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { useSuspenseQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport type { SortType } from \"~/types/sort-type\"\nimport {\n  FolderListItemFragment,\n  FoldersList,\n} from \"~/routes/($lang).my._index/components/folders-list\"\n\ntype Props = {\n  page: number\n  foldersMaxCount: number\n  sort: SortType\n  orderBy: IntrospectionEnum<\"FolderOrderBy\">\n  setFolderPage: (page: number) => void\n  onClickFolderTitleSortButton: () => void\n  onClickFolderDateSortButton: () => void\n}\n\n/**\n * ãƒ•ã‚©ãƒ«ãƒ€ä¸€è¦§ã‚³ãƒ³ãƒ†ãƒŠ\n */\nexport function FoldersListContainer (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  if (\n    authContext.isLoading ||\n    authContext.isNotLoggedIn ||\n    authContext.userId === undefined ||\n    !authContext.userId\n  ) {\n    return null\n  }\n\n  const { data: FoldersResp, refetch } = useSuspenseQuery(viewerFoldersQuery, {\n    skip:\n      authContext.isLoading || authContext.isNotLoggedIn || !authContext.userId,\n    variables: {\n      offset: 16 * props.page,\n      limit: 16,\n      where: {\n        orderBy: props.orderBy,\n        sort: props.sort,\n      },\n    },\n  })\n\n  const Folders = FoldersResp?.viewer?.folders ?? []\n\n  const _refetchFolders = () => {\n    refetch()\n  }\n\n  return (\n    <>\n      <FoldersList\n        folders={Folders}\n        sort={props.sort}\n        orderBy={props.orderBy}\n        onClickTitleSortButton={props.onClickFolderTitleSortButton}\n        onClickDateSortButton={props.onClickFolderDateSortButton}\n      />\n      <div className=\"h-8\" />\n      <div className=\"-translate-x-1/2 fixed bottom-0 left-1/2 z-10 w-full border-border/40 bg-background/95 p-2 backdrop-blur-sm supports-backdrop-filter:bg-background/80\">\n        <ResponsivePagination\n          perPage={16}\n          maxCount={props.foldersMaxCount}\n          currentPage={props.page}\n          onPageChange={(page: number) => {\n            props.setFolderPage(page)\n          }}\n        />\n      </div>\n    </>\n  )\n}\n\nconst viewerFoldersQuery = graphql(\n  `query ViewerFolders($offset: Int!, $limit: Int!, $where: ViewerFoldersWhereInput) {\n    viewer {\n      folders(offset: $offset, limit: $limit, where: $where) {\n        ...FolderListItem\n      }\n    }\n  }`,\n  [FolderListItemFragment],\n)\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/folders-list-container.tsx"},"span":[1072,1088],"sourceCode":"import { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext } from \"react\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { useSuspenseQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\nimport type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport type { SortType } from \"~/types/sort-type\"\nimport {\n  FolderListItemFragment,\n  FoldersList,\n} from \"~/routes/($lang).my._index/components/folders-list\"\n\ntype Props = {\n  page: number\n  foldersMaxCount: number\n  sort: SortType\n  orderBy: IntrospectionEnum<\"FolderOrderBy\">\n  setFolderPage: (page: number) => void\n  onClickFolderTitleSortButton: () => void\n  onClickFolderDateSortButton: () => void\n}\n\n/**\n * ãƒ•ã‚©ãƒ«ãƒ€ä¸€è¦§ã‚³ãƒ³ãƒ†ãƒŠ\n */\nexport function FoldersListContainer (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  if (\n    authContext.isLoading ||\n    authContext.isNotLoggedIn ||\n    authContext.userId === undefined ||\n    !authContext.userId\n  ) {\n    return null\n  }\n\n  const { data: FoldersResp, refetch } = useSuspenseQuery(viewerFoldersQuery, {\n    skip:\n      authContext.isLoading || authContext.isNotLoggedIn || !authContext.userId,\n    variables: {\n      offset: 16 * props.page,\n      limit: 16,\n      where: {\n        orderBy: props.orderBy,\n        sort: props.sort,\n      },\n    },\n  })\n\n  const Folders = FoldersResp?.viewer?.folders ?? []\n\n  const _refetchFolders = () => {\n    refetch()\n  }\n\n  return (\n    <>\n      <FoldersList\n        folders={Folders}\n        sort={props.sort}\n        orderBy={props.orderBy}\n        onClickTitleSortButton={props.onClickFolderTitleSortButton}\n        onClickDateSortButton={props.onClickFolderDateSortButton}\n      />\n      <div className=\"h-8\" />\n      <div className=\"-translate-x-1/2 fixed bottom-0 left-1/2 z-10 w-full border-border/40 bg-background/95 p-2 backdrop-blur-sm supports-backdrop-filter:bg-background/80\">\n        <ResponsivePagination\n          perPage={16}\n          maxCount={props.foldersMaxCount}\n          currentPage={props.page}\n          onPageChange={(page: number) => {\n            props.setFolderPage(page)\n          }}\n        />\n      </div>\n    </>\n  )\n}\n\nconst viewerFoldersQuery = graphql(\n  `query ViewerFolders($offset: Int!, $limit: Int!, $where: ViewerFoldersWhereInput) {\n    viewer {\n      folders(offset: $offset, limit: $limit, where: $where) {\n        ...FolderListItem\n      }\n    }\n  }`,\n  [FolderListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[738,754],"sourceCode":"import { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext } from \"react\"\nimport {\n  BookmarkWorksList,\n  BookmarkWorksListItemFragment,\n} from \"~/routes/($lang).my._index/components/bookmark-works-list\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\n\ntype Props = {\n  page: number\n  maxCount: number\n  setPage: (page: number) => void\n}\n\n/**\n * ã„ã„ã­ä¸€è¦§ã‚³ãƒ³ãƒ†ãƒŠ\n */\nexport function LikeListContainer (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  if (\n    authContext.isLoading ||\n    authContext.isNotLoggedIn ||\n    authContext.userId === undefined ||\n    !authContext.userId\n  ) {\n    return null\n  }\n  const { data: userResp, refetch } = useQuery(userQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      likesOffset: 16 * props.page,\n      likesLimit: 16,\n      userId: decodeURIComponent(authContext.userId),\n    },\n  })\n\n  const works = userResp?.user?.likedWorks ?? []\n\n  return (\n    <>\n      <BookmarkWorksList works={works} />\n      <div className=\"h-8\" />\n      <div className=\"-translate-x-1/2 fixed bottom-0 left-1/2 z-10 w-full border-border/40 bg-background/95 p-2 backdrop-blur-sm supports-backdrop-filter:bg-background/80\">\n        <ResponsivePagination\n          perPage={16}\n          maxCount={props.maxCount}\n          currentPage={props.page}\n          onPageChange={(page: number) => {\n            props.setPage(page)\n          }}\n        />\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n    $likesOffset: Int!,\n    $likesLimit: Int!,\n    $likesWhere: UserWorksWhereInput,\n  ) {\n    user(id: $userId) {\n      id\n      likedWorks(offset: $likesOffset, limit: $likesLimit, where: $likesWhere) {\n        ...BookmarkWorksListItem\n      }\n    }\n  }`,\n  [BookmarkWorksListItemFragment],\n)\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/like-list-container.tsx"},"span":[797,805],"sourceCode":"import { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext } from \"react\"\nimport {\n  BookmarkWorksList,\n  BookmarkWorksListItemFragment,\n} from \"~/routes/($lang).my._index/components/bookmark-works-list\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\n\ntype Props = {\n  page: number\n  maxCount: number\n  setPage: (page: number) => void\n}\n\n/**\n * ã„ã„ã­ä¸€è¦§ã‚³ãƒ³ãƒ†ãƒŠ\n */\nexport function LikeListContainer (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  if (\n    authContext.isLoading ||\n    authContext.isNotLoggedIn ||\n    authContext.userId === undefined ||\n    !authContext.userId\n  ) {\n    return null\n  }\n  const { data: userResp, refetch } = useQuery(userQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      likesOffset: 16 * props.page,\n      likesLimit: 16,\n      userId: decodeURIComponent(authContext.userId),\n    },\n  })\n\n  const works = userResp?.user?.likedWorks ?? []\n\n  return (\n    <>\n      <BookmarkWorksList works={works} />\n      <div className=\"h-8\" />\n      <div className=\"-translate-x-1/2 fixed bottom-0 left-1/2 z-10 w-full border-border/40 bg-background/95 p-2 backdrop-blur-sm supports-backdrop-filter:bg-background/80\">\n        <ResponsivePagination\n          perPage={16}\n          maxCount={props.maxCount}\n          currentPage={props.page}\n          onPageChange={(page: number) => {\n            props.setPage(page)\n          }}\n        />\n      </div>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n    $likesOffset: Int!,\n    $likesLimit: Int!,\n    $likesWhere: UserWorksWhereInput,\n  ) {\n    user(id: $userId) {\n      id\n      likedWorks(offset: $likesOffset, limit: $likesLimit, where: $likesWhere) {\n        ...BookmarkWorksListItem\n      }\n    }\n  }`,\n  [BookmarkWorksListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[586,602],"sourceCode":"import { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext } from \"react\"\nimport { useSuspenseQuery } from \"@apollo/client/index\"\nimport {\n  RecommendedWorkListItemFragment,\n  RecommendedWorksList,\n} from \"~/routes/($lang).my._index/components/recommended-works-list\"\nimport { graphql } from \"gql.tada\"\n\n/**\n * æ¨è–¦ä¸€è¦§ã‚³ãƒ³ãƒ†ãƒŠ\n */\nexport function RecommendedListContainer () {\n  const authContext = useContext(AuthContext)\n\n  if (\n    authContext.isLoading ||\n    authContext.isNotLoggedIn ||\n    authContext.userId === undefined ||\n    !authContext.userId\n  ) {\n    return null\n  }\n  const { data: worksResp, refetch } = useSuspenseQuery(worksQuery, {\n    skip:\n      authContext.isLoading || authContext.isNotLoggedIn || !authContext.userId,\n    variables: {\n      offset: 0,\n      limit: 16,\n      where: {\n        isRecommended: true,\n        recommendedWorksUserId: authContext.userId,\n        isNowCreatedAt: true,\n        ratings: [\"G\", \"R18G\", \"R15\", \"R18\"],\n      },\n    },\n  })\n\n  const works = worksResp?.works ?? []\n\n  return (\n    <>\n      <RecommendedWorksList works={works} />\n    </>\n  )\n}\n\nconst worksQuery = graphql(\n  `query Works($offset: Int!, $limit: Int!, $where: WorksWhereInput) {\n    works(offset: $offset, limit: $limit, where: $where) {\n      ...RecommendedWorkListItem\n    }\n  }`,\n  [RecommendedWorkListItemFragment],\n)\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/recommended-list-container.tsx"},"span":[646,662],"sourceCode":"import { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext } from \"react\"\nimport { useSuspenseQuery } from \"@apollo/client/index\"\nimport {\n  RecommendedWorkListItemFragment,\n  RecommendedWorksList,\n} from \"~/routes/($lang).my._index/components/recommended-works-list\"\nimport { graphql } from \"gql.tada\"\n\n/**\n * æ¨è–¦ä¸€è¦§ã‚³ãƒ³ãƒ†ãƒŠ\n */\nexport function RecommendedListContainer () {\n  const authContext = useContext(AuthContext)\n\n  if (\n    authContext.isLoading ||\n    authContext.isNotLoggedIn ||\n    authContext.userId === undefined ||\n    !authContext.userId\n  ) {\n    return null\n  }\n  const { data: worksResp, refetch } = useSuspenseQuery(worksQuery, {\n    skip:\n      authContext.isLoading || authContext.isNotLoggedIn || !authContext.userId,\n    variables: {\n      offset: 0,\n      limit: 16,\n      where: {\n        isRecommended: true,\n        recommendedWorksUserId: authContext.userId,\n        isNowCreatedAt: true,\n        ratings: [\"G\", \"R18G\", \"R15\", \"R18\"],\n      },\n    },\n  })\n\n  const works = worksResp?.works ?? []\n\n  return (\n    <>\n      <RecommendedWorksList works={works} />\n    </>\n  )\n}\n\nconst worksQuery = graphql(\n  `query Works($offset: Int!, $limit: Int!, $where: WorksWhereInput) {\n    works(offset: $offset, limit: $limit, where: $where) {\n      ...RecommendedWorkListItem\n    }\n  }`,\n  [RecommendedWorkListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/select-created-works-dialog-with-ids.tsx"},"span":[5031,5151],"sourceCode":"import { useContext, useState } from \"react\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Button } from \"~/components/ui/button\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { ImageIcon, CheckIcon, PlusIcon } from \"lucide-react\"\nimport { Tabs, TabsList, TabsTrigger } from \"~/components/ui/tabs\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n// ----- dnd-kit -----\nimport {\n  DndContext,\n  DragOverlay,\n  PointerSensor,\n  TouchSensor,\n  useSensor,\n  useSensors,\n  closestCenter,\n  type DragStartEvent,\n  type DragEndEvent,\n} from \"@dnd-kit/core\"\nimport {\n  SortableContext,\n  useSortable,\n  arrayMove,\n  rectSortingStrategy,\n} from \"@dnd-kit/sortable\"\nimport { CSS } from \"@dnd-kit/utilities\"\n\ntype Props = {\n  selectedWorkIds: string[]\n  setSelectedWorkIds: (workIds: string[]) => void\n  limit?: number\n}\n\n/**\n * ä½œæˆæ¸ˆã¿ã®ä½œå“é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function SelectCreatedWorksDialogWithIds (props: Props) {\n  const t = useTranslation()\n  const appContext = useContext(AuthContext)\n\n  const [isOpen, setIsOpen] = useState<boolean>(false)\n  const [page, setPage] = useState(0) // \"æœªé¸æŠ\"ã‚¿ãƒ–ç”¨ãƒšãƒ¼ã‚¸\n  const [selectedPage, setSelectedPage] = useState(0) // \"é¸æŠä¸­\"ã‚¿ãƒ–ç”¨ãƒšãƒ¼ã‚¸\n  const [tab, setTab] = useState<\"NO_SELECTED\" | \"SELECTED\">(\"NO_SELECTED\")\n\n  // ä¸¦ã³æ›¿ãˆãƒˆã‚°ãƒ« (true ã§ãƒ‰ãƒ©ãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰)\n  const [isDragMode, setIsDragMode] = useState(false)\n\n  // ======== æœªé¸æŠã‚¿ãƒ–ç”¨ã‚¯ã‚¨ãƒª (å…¨ä½œå“ + ãƒšãƒ¼ã‚¸ãƒ³ã‚°) ========\n  const worksResult = useQuery(worksQuery, {\n    skip: appContext.isLoading,\n    variables: {\n      offset: page * 32,\n      limit: 32,\n      where: {\n        userId: appContext.userId,\n        orderBy: \"DATE_CREATED\",\n        sort: \"DESC\",\n      },\n    },\n  })\n  const works = worksResult.data?.works ?? []\n\n  // ======== å…¨ä½œå“æ•° (æœªé¸æŠã‚¿ãƒ–ã®ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³) ========\n  const worksCountResp = useQuery(worksCountQuery, {\n    skip: appContext.isLoading,\n    variables: {\n      where: {\n        userId: appContext.userId,\n      },\n    },\n  })\n  const worksMaxCount = worksCountResp.data?.worksCount ?? 0\n\n  // ======== é¸æŠä¸­ã‚¿ãƒ–ç”¨ã‚¯ã‚¨ãƒª (selectedWorkIds ã«åˆè‡´ã™ã‚‹ä½œå“) ========\n  const selectedWorksResult = useQuery(worksQuery, {\n    skip: appContext.isLoading || props.selectedWorkIds.length === 0,\n    variables: {\n      offset: selectedPage * 32,\n      limit: 32,\n      where: {\n        ids: props.selectedWorkIds,\n        orderBy: \"DATE_CREATED\",\n        sort: \"DESC\",\n      },\n    },\n  })\n\n  const selectedWorksQueryData = selectedWorksResult.data?.works ?? []\n\n  // ======== é¸æŠä¸­ã‚¿ãƒ–ã®ä½œå“ç·æ•° (ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³) ========\n  const selectedWorksCountResp = useQuery(worksCountQuery, {\n    skip: appContext.isLoading || props.selectedWorkIds.length === 0,\n    variables: {\n      where: {\n        ids: props.selectedWorkIds,\n      },\n    },\n  })\n  const selectedWorksMaxCount = selectedWorksCountResp.data?.worksCount ?? 0\n\n  // ======== ã‚¿ã‚¤ãƒˆãƒ«ã‚’çœç•¥ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼ ========\n  const truncateTitle = (title: string, maxLength: number) =>\n    title.length > maxLength ? `${title.slice(0, maxLength)}...` : title\n\n  // ======== (æœªé¸æŠã‚¿ãƒ–) ä½œå“ã‚¯ãƒªãƒƒã‚¯ ========\n  const handleWorkClick = (work: FragmentOf<typeof DialogWorkFragment>) => {\n    const isAlreadySelected = props.selectedWorkIds.includes(work.id)\n    if (isAlreadySelected) {\n      // é¸æŠè§£é™¤\n      const newIds = props.selectedWorkIds.filter((id) => id !== work.id)\n      props.setSelectedWorkIds(newIds)\n    } else {\n      // æ–°è¦é¸æŠ\n      if (!props.limit || props.selectedWorkIds.length < props.limit) {\n        const newIds = [...props.selectedWorkIds, work.id]\n        props.setSelectedWorkIds(newIds)\n      } else {\n        toast(\n          t(\n            `é¸æŠã§ãã‚‹ä½œå“æ•°ã¯${props.limit}ã¤ã¾ã§ã§ã™ã€‚`,\n            `You can select up to ${props.limit} works.`,\n          ),\n        )\n      }\n    }\n  }\n\n  // ======== ã€Œé¸æŠä¸­ã€ã‚¿ãƒ–ã§è¡¨ç¤ºã™ã‚‹ä½œå“ã‚’ ID ã®é †ç•ªã«ä¸¦ã³æ›¿ãˆãŸé…åˆ—ã‚’ç”Ÿæˆ ========\n  // DnD ãªã©ã§ä¸¦ã³é †ã‚’å¤‰æ›´ã™ã‚‹ã¨ãã¯ã€props.selectedWorkIds ã“ããŒé †åºã®ã‚½ãƒ¼ã‚¹ã«ãªã‚‹æƒ³å®šã€‚\n  const sortedSelectedWorks = props.selectedWorkIds\n    .map((id) => selectedWorksQueryData.find((w) => w.id === id))\n    .filter(Boolean) as FragmentOf<typeof DialogWorkFragment>[]\n\n  // ======== æœªé¸æŠã‚¿ãƒ–ã®æç”» ========\n  const renderWorks = (\n    worksToRender: FragmentOf<typeof DialogWorkFragment>[],\n  ) => {\n    return worksToRender.map((work) => (\n      <div key={work.id}>\n        {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n        <div\n          className=\"relative m-2 size-24 cursor-pointer\"\n          onClick={() => handleWorkClick(work)}\n        >\n          <img\n            className=\"size-24 rounded-md object-cover\"\n            src={work.smallThumbnailImageURL}\n            alt=\"\"\n          />\n          <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n            {truncateTitle(work.title, 8)}\n          </div>\n          {/* é¸æŠæ¸ˆã¿ã ã£ãŸã‚‰ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¤ã‚³ãƒ³ */}\n          {props.selectedWorkIds.includes(work.id) && (\n            <div className=\"absolute top-1 left-1 rounded-full border-2 bg-black dark:bg-white\">\n              <CheckIcon className=\"p-1 text-white dark:text-black\" />\n            </div>\n          )}\n        </div>\n      </div>\n    ))\n  }\n\n  // ========== ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—é–¢é€£ (SELECTED ã‚¿ãƒ–) ==========\n  const [activeDragItem, setActiveDragItem] = useState<FragmentOf<\n    typeof DialogWorkFragment\n  > | null>(null)\n\n  const sensors = useSensors(useSensor(PointerSensor), useSensor(TouchSensor))\n\n  // ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹\n  const handleDragStart = (event: DragStartEvent) => {\n    const { active } = event\n    const found = sortedSelectedWorks.find((w) => w.id === active.id)\n    if (found) {\n      setActiveDragItem(found)\n    }\n  }\n\n  // ãƒ‰ãƒ©ãƒƒã‚°çµ‚äº†\n  const handleDragEnd = (event: DragEndEvent) => {\n    const { active, over } = event\n    if (!over) {\n      setActiveDragItem(null)\n      return\n    }\n    if (active.id !== over.id) {\n      const oldIndex = props.selectedWorkIds.indexOf(active.id.toString())\n      const newIndex = props.selectedWorkIds.indexOf(over.id.toString())\n      // ä¸¦ã³æ›¿ãˆ\n      if (oldIndex !== -1 && newIndex !== -1) {\n        const newIds = arrayMove(props.selectedWorkIds, oldIndex, newIndex)\n        props.setSelectedWorkIds(newIds)\n      }\n    }\n    setActiveDragItem(null)\n  }\n\n  // ã‚½ãƒ¼ãƒˆå¯èƒ½ã‚¢ã‚¤ãƒ†ãƒ \n  function SortableItem({\n    work,\n  }: {\n    work: FragmentOf<typeof DialogWorkFragment>\n  }) {\n    // drag/drop ã®å‹•ä½œç®¡ç†\n    const { attributes, listeners, setNodeRef, transform, transition } =\n      useSortable({ id: work.id })\n\n    const style = {\n      transform: CSS.Transform.toString(transform),\n      transition,\n    }\n\n    return (\n      <div\n        ref={setNodeRef}\n        style={style}\n        {...attributes}\n        {...listeners}\n        // ã€Œä¸¦ã³æ›¿ãˆãƒ¢ãƒ¼ãƒ‰ã€ã§ãªã„ã¨ãã¯ã‚¯ãƒªãƒƒã‚¯ã§\"é¸æŠè§£é™¤\"\n        onClick={\n          !isDragMode\n            ? () => {\n                const newIds = props.selectedWorkIds.filter(\n                  (id) => id !== work.id,\n                )\n                props.setSelectedWorkIds(newIds)\n              }\n            : undefined\n        }\n        className={\n          isDragMode\n            ? \"relative m-2 cursor-grab\" // ä¸¦ã³æ›¿ãˆON: grabã‚«ãƒ¼ã‚½ãƒ«\n            : \"relative m-2 cursor-pointer\" // ä¸¦ã³æ›¿ãˆOFF: ã‚¯ãƒªãƒƒã‚¯è§£é™¤ç”¨\n        }\n      >\n        <img\n          className=\"size-24 rounded-md object-cover\"\n          src={work.smallThumbnailImageURL}\n          alt=\"\"\n        />\n        <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n          {truncateTitle(work.title, 8)}\n        </div>\n      </div>\n    )\n  }\n\n  // é¸æŠä¸­ã‚¿ãƒ–ã®æç”»\n  const renderSelectedWorksDnD = () => {\n    return (\n      <DndContext\n        sensors={sensors}\n        collisionDetection={closestCenter}\n        onDragStart={handleDragStart}\n        onDragEnd={handleDragEnd}\n      >\n        <SortableContext\n          items={props.selectedWorkIds} // é †ç•ªã©ãŠã‚Šã«\n          strategy={rectSortingStrategy}\n        >\n          <div className=\"flex flex-wrap\">\n            {sortedSelectedWorks.map((work) => (\n              <SortableItem key={work.id} work={work} />\n            ))}\n          </div>\n        </SortableContext>\n\n        <DragOverlay adjustScale={false} style={{ transformOrigin: \"0 0 \" }}>\n          {activeDragItem && (\n            <div className=\"size-24 border border-gray-300\">\n              <img\n                className=\"h-full w-full object-cover\"\n                src={activeDragItem.smallThumbnailImageURL}\n                alt=\"\"\n              />\n            </div>\n          )}\n        </DragOverlay>\n      </DndContext>\n    )\n  }\n\n  // ã‚‚ã—æœªé¸æŠã‚¿ãƒ–ã§ä½œå“ãŒå…¨ããªã„å ´åˆ (ã‹ã¤ã€ã‚¿ãƒ–ã‚‚NO_SELECTED) ã®ä¾‹\n  if (!works?.length && tab === \"NO_SELECTED\") {\n    return (\n      <div className=\"p-4\">\n        <ImageIcon className=\"m-auto size-8 opacity-70\" />\n        <p className=\"p-4 text-center text-sm\">\n          {t(\"ä½œå“ãŒã‚ã‚Šã¾ã›ã‚“ã€‚\", \"No works available.\")}\n        </p>\n      </div>\n    )\n  }\n\n  return (\n    <>\n      {/* ã€Œã™ã¹ã¦è¦‹ã‚‹ã€ãƒªãƒ³ã‚¯ï¼šé¸æŠä¸­ãŒ7ä»¶ã‚’è¶…ãˆãŸã‚‰è¡¨ç¤ºä¾‹ */}\n      {props.selectedWorkIds.length > 7 && (\n        // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n        <p\n          onClick={() => setIsOpen(true)}\n          className=\"m-2 cursor-pointer text-right text-sm opacity-80\"\n        >\n          {t(\n            `ã™ã¹ã¦è¦‹ã‚‹(${props.selectedWorkIds.length})`,\n            `View All (${props.selectedWorkIds.length})`,\n          )}\n        </p>\n      )}\n\n      {/* ãƒ€ã‚¤ã‚¢ãƒ­ã‚°å¤–ã§ã¯å…ˆé ­3ä»¶ã ã‘ã‚µãƒ ãƒè¡¨ç¤º */}\n      <div className=\"flex flex-wrap items-center\">\n        {sortedSelectedWorks.slice(0, 3).map((work) => (\n          <div key={work.id} className=\"relative m-2 size-16 md:h-24 md:w-24\">\n            <img\n              className=\"size-16 rounded-md object-cover md:h-24 md:w-24\"\n              src={work.smallThumbnailImageURL}\n              alt=\"\"\n            />\n            <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n              {truncateTitle(work.title, 8)}\n            </div>\n            <div className=\"absolute top-1 left-1 rounded-full border-2 bg-black dark:bg-white\">\n              <CheckIcon className=\"p-1 text-white dark:text-black\" />\n            </div>\n          </div>\n        ))}\n\n        {/* ã€Œï¼‹ã€ãƒœã‚¿ãƒ³ */}\n        <div className=\"border-2 border-transparent p-1\">\n          <Button\n            onClick={() => setIsOpen(true)}\n            className=\"size-16 md:h-24 md:w-24\"\n            size=\"icon\"\n            variant=\"secondary\"\n          >\n            <PlusIcon />\n          </Button>\n        </div>\n      </div>\n\n      {/* ãƒ€ã‚¤ã‚¢ãƒ­ã‚° */}\n      <Dialog open={isOpen} onOpenChange={(opened) => setIsOpen(opened)}>\n        <DialogContent className=\"min-h-[40vw] min-w-[88vw] pl-2\">\n          <DialogHeader>\n            <DialogTitle>{t(\"ä½œå“é¸æŠ\", \"Select Works\")}</DialogTitle>\n          </DialogHeader>\n\n          <Tabs className=\"mt-2 mb-8\" value={tab} defaultValue=\"NO_SELECTED\">\n            <TabsList>\n              <TabsTrigger\n                onClick={() => setTab(\"NO_SELECTED\")}\n                className=\"w-full\"\n                value=\"NO_SELECTED\"\n              >\n                {t(\"æœªé¸æŠ\", \"Not Selected\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => setTab(\"SELECTED\")}\n                className=\"w-full\"\n                value=\"SELECTED\"\n              >\n                {t(\"é¸æŠä¸­\", \"Selected\")}\n              </TabsTrigger>\n            </TabsList>\n          </Tabs>\n\n          <ScrollArea className=\"max-h-80 overflow-y-auto md:max-h-[100%]\">\n            {tab === \"NO_SELECTED\" && (\n              <div className=\"flex flex-wrap\">{renderWorks(works)}</div>\n            )}\n            {tab === \"SELECTED\" && (\n              <>\n                {/* ä¸¦ã³æ›¿ãˆãƒˆã‚°ãƒ« */}\n                <div className=\"mb-4 flex items-center gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => setIsDragMode(!isDragMode)}\n                  >\n                    {isDragMode\n                      ? t(\"ä¸¦ã³æ›¿ãˆçµ‚äº†\", \"Stop Sorting\")\n                      : t(\"ä¸¦ã³æ›¿ãˆ\", \"Sort\")}\n                  </Button>\n                </div>\n                {/* DnDè¡¨ç¤º or ã‚¯ãƒªãƒƒã‚¯è§£é™¤è¡¨ç¤º */}\n                {isDragMode ? (\n                  renderSelectedWorksDnD()\n                ) : (\n                  <div className=\"flex flex-wrap\">\n                    {renderWorks(sortedSelectedWorks)}\n                  </div>\n                )}\n              </>\n            )}\n          </ScrollArea>\n\n          {/* ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ */}\n          {tab === \"NO_SELECTED\" && (\n            <ResponsivePagination\n              perPage={32}\n              maxCount={worksMaxCount}\n              currentPage={page}\n              onPageChange={(p: number) => setPage(p)}\n            />\n          )}\n          {tab === \"SELECTED\" && (\n            <ResponsivePagination\n              perPage={32}\n              maxCount={selectedWorksMaxCount}\n              currentPage={selectedPage}\n              onPageChange={(p: number) => setSelectedPage(p)}\n            />\n          )}\n\n          <div className=\"mt-4 flex gap-2\">\n            <Button onClick={() => setIsOpen(false)}>\n              {t(\"æ±ºå®š\", \"Confirm\")}\n            </Button>\n            <Button variant=\"secondary\" onClick={() => setIsOpen(false)}>\n              {t(\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\", \"Cancel\")}\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </>\n  )\n}\n\n// ==== GraphQL Fragment ====\n// ä½œå“ã‚µãƒ ãƒãƒ»ã‚¿ã‚¤ãƒˆãƒ«ç”¨ã®ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆ\nexport const DialogWorkFragment = graphql(`\n  fragment DialogWork on WorkNode @_unmask {\n    id\n    title\n    smallThumbnailImageURL\n  }\n`)\n\n// ==== GraphQL Queries ====\n// ç·æ•°å–å¾— (ä»»æ„ã® where æ¡ä»¶ã«å¯¾å¿œ)\nconst worksCountQuery = graphql(`\n  query WorksCount($where: WorksWhereInput) {\n    worksCount(where: $where)\n  }\n`)\n\n// ãƒšãƒ¼ã‚¸ãƒ³ã‚°ä»˜ãä½œå“ä¸€è¦§å–å¾— (ä»»æ„ã® where æ¡ä»¶ã«å¯¾å¿œ)\nconst worksQuery = graphql(\n  `\n    query Works($offset: Int!, $limit: Int!, $where: WorksWhereInput) {\n      works(offset: $offset, limit: $limit, where: $where) {\n        ...DialogWork\n      }\n    }\n  `,\n  [DialogWorkFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/nursery/noNestedComponentDefinitions","severity":"error","description":"Components should not be defined inside other components.","message":[{"elements":[],"content":"Components should not be defined inside other components."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Move it outside of the parent component or pass it as a prop."}]]},{"frame":{"path":null,"span":[1230,1261],"sourceCode":"import { useContext, useState } from \"react\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Button } from \"~/components/ui/button\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { ImageIcon, CheckIcon, PlusIcon } from \"lucide-react\"\nimport { Tabs, TabsList, TabsTrigger } from \"~/components/ui/tabs\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n// ----- dnd-kit -----\nimport {\n  DndContext,\n  DragOverlay,\n  PointerSensor,\n  TouchSensor,\n  useSensor,\n  useSensors,\n  closestCenter,\n  type DragStartEvent,\n  type DragEndEvent,\n} from \"@dnd-kit/core\"\nimport {\n  SortableContext,\n  useSortable,\n  arrayMove,\n  rectSortingStrategy,\n} from \"@dnd-kit/sortable\"\nimport { CSS } from \"@dnd-kit/utilities\"\n\ntype Props = {\n  selectedWorkIds: string[]\n  setSelectedWorkIds: (workIds: string[]) => void\n  limit?: number\n}\n\n/**\n * ä½œæˆæ¸ˆã¿ã®ä½œå“é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function SelectCreatedWorksDialogWithIds (props: Props) {\n  const t = useTranslation()\n  const appContext = useContext(AuthContext)\n\n  const [isOpen, setIsOpen] = useState<boolean>(false)\n  const [page, setPage] = useState(0) // \"æœªé¸æŠ\"ã‚¿ãƒ–ç”¨ãƒšãƒ¼ã‚¸\n  const [selectedPage, setSelectedPage] = useState(0) // \"é¸æŠä¸­\"ã‚¿ãƒ–ç”¨ãƒšãƒ¼ã‚¸\n  const [tab, setTab] = useState<\"NO_SELECTED\" | \"SELECTED\">(\"NO_SELECTED\")\n\n  // ä¸¦ã³æ›¿ãˆãƒˆã‚°ãƒ« (true ã§ãƒ‰ãƒ©ãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰)\n  const [isDragMode, setIsDragMode] = useState(false)\n\n  // ======== æœªé¸æŠã‚¿ãƒ–ç”¨ã‚¯ã‚¨ãƒª (å…¨ä½œå“ + ãƒšãƒ¼ã‚¸ãƒ³ã‚°) ========\n  const worksResult = useQuery(worksQuery, {\n    skip: appContext.isLoading,\n    variables: {\n      offset: page * 32,\n      limit: 32,\n      where: {\n        userId: appContext.userId,\n        orderBy: \"DATE_CREATED\",\n        sort: \"DESC\",\n      },\n    },\n  })\n  const works = worksResult.data?.works ?? []\n\n  // ======== å…¨ä½œå“æ•° (æœªé¸æŠã‚¿ãƒ–ã®ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³) ========\n  const worksCountResp = useQuery(worksCountQuery, {\n    skip: appContext.isLoading,\n    variables: {\n      where: {\n        userId: appContext.userId,\n      },\n    },\n  })\n  const worksMaxCount = worksCountResp.data?.worksCount ?? 0\n\n  // ======== é¸æŠä¸­ã‚¿ãƒ–ç”¨ã‚¯ã‚¨ãƒª (selectedWorkIds ã«åˆè‡´ã™ã‚‹ä½œå“) ========\n  const selectedWorksResult = useQuery(worksQuery, {\n    skip: appContext.isLoading || props.selectedWorkIds.length === 0,\n    variables: {\n      offset: selectedPage * 32,\n      limit: 32,\n      where: {\n        ids: props.selectedWorkIds,\n        orderBy: \"DATE_CREATED\",\n        sort: \"DESC\",\n      },\n    },\n  })\n\n  const selectedWorksQueryData = selectedWorksResult.data?.works ?? []\n\n  // ======== é¸æŠä¸­ã‚¿ãƒ–ã®ä½œå“ç·æ•° (ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³) ========\n  const selectedWorksCountResp = useQuery(worksCountQuery, {\n    skip: appContext.isLoading || props.selectedWorkIds.length === 0,\n    variables: {\n      where: {\n        ids: props.selectedWorkIds,\n      },\n    },\n  })\n  const selectedWorksMaxCount = selectedWorksCountResp.data?.worksCount ?? 0\n\n  // ======== ã‚¿ã‚¤ãƒˆãƒ«ã‚’çœç•¥ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼ ========\n  const truncateTitle = (title: string, maxLength: number) =>\n    title.length > maxLength ? `${title.slice(0, maxLength)}...` : title\n\n  // ======== (æœªé¸æŠã‚¿ãƒ–) ä½œå“ã‚¯ãƒªãƒƒã‚¯ ========\n  const handleWorkClick = (work: FragmentOf<typeof DialogWorkFragment>) => {\n    const isAlreadySelected = props.selectedWorkIds.includes(work.id)\n    if (isAlreadySelected) {\n      // é¸æŠè§£é™¤\n      const newIds = props.selectedWorkIds.filter((id) => id !== work.id)\n      props.setSelectedWorkIds(newIds)\n    } else {\n      // æ–°è¦é¸æŠ\n      if (!props.limit || props.selectedWorkIds.length < props.limit) {\n        const newIds = [...props.selectedWorkIds, work.id]\n        props.setSelectedWorkIds(newIds)\n      } else {\n        toast(\n          t(\n            `é¸æŠã§ãã‚‹ä½œå“æ•°ã¯${props.limit}ã¤ã¾ã§ã§ã™ã€‚`,\n            `You can select up to ${props.limit} works.`,\n          ),\n        )\n      }\n    }\n  }\n\n  // ======== ã€Œé¸æŠä¸­ã€ã‚¿ãƒ–ã§è¡¨ç¤ºã™ã‚‹ä½œå“ã‚’ ID ã®é †ç•ªã«ä¸¦ã³æ›¿ãˆãŸé…åˆ—ã‚’ç”Ÿæˆ ========\n  // DnD ãªã©ã§ä¸¦ã³é †ã‚’å¤‰æ›´ã™ã‚‹ã¨ãã¯ã€props.selectedWorkIds ã“ããŒé †åºã®ã‚½ãƒ¼ã‚¹ã«ãªã‚‹æƒ³å®šã€‚\n  const sortedSelectedWorks = props.selectedWorkIds\n    .map((id) => selectedWorksQueryData.find((w) => w.id === id))\n    .filter(Boolean) as FragmentOf<typeof DialogWorkFragment>[]\n\n  // ======== æœªé¸æŠã‚¿ãƒ–ã®æç”» ========\n  const renderWorks = (\n    worksToRender: FragmentOf<typeof DialogWorkFragment>[],\n  ) => {\n    return worksToRender.map((work) => (\n      <div key={work.id}>\n        {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n        <div\n          className=\"relative m-2 size-24 cursor-pointer\"\n          onClick={() => handleWorkClick(work)}\n        >\n          <img\n            className=\"size-24 rounded-md object-cover\"\n            src={work.smallThumbnailImageURL}\n            alt=\"\"\n          />\n          <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n            {truncateTitle(work.title, 8)}\n          </div>\n          {/* é¸æŠæ¸ˆã¿ã ã£ãŸã‚‰ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¤ã‚³ãƒ³ */}\n          {props.selectedWorkIds.includes(work.id) && (\n            <div className=\"absolute top-1 left-1 rounded-full border-2 bg-black dark:bg-white\">\n              <CheckIcon className=\"p-1 text-white dark:text-black\" />\n            </div>\n          )}\n        </div>\n      </div>\n    ))\n  }\n\n  // ========== ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—é–¢é€£ (SELECTED ã‚¿ãƒ–) ==========\n  const [activeDragItem, setActiveDragItem] = useState<FragmentOf<\n    typeof DialogWorkFragment\n  > | null>(null)\n\n  const sensors = useSensors(useSensor(PointerSensor), useSensor(TouchSensor))\n\n  // ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹\n  const handleDragStart = (event: DragStartEvent) => {\n    const { active } = event\n    const found = sortedSelectedWorks.find((w) => w.id === active.id)\n    if (found) {\n      setActiveDragItem(found)\n    }\n  }\n\n  // ãƒ‰ãƒ©ãƒƒã‚°çµ‚äº†\n  const handleDragEnd = (event: DragEndEvent) => {\n    const { active, over } = event\n    if (!over) {\n      setActiveDragItem(null)\n      return\n    }\n    if (active.id !== over.id) {\n      const oldIndex = props.selectedWorkIds.indexOf(active.id.toString())\n      const newIndex = props.selectedWorkIds.indexOf(over.id.toString())\n      // ä¸¦ã³æ›¿ãˆ\n      if (oldIndex !== -1 && newIndex !== -1) {\n        const newIds = arrayMove(props.selectedWorkIds, oldIndex, newIndex)\n        props.setSelectedWorkIds(newIds)\n      }\n    }\n    setActiveDragItem(null)\n  }\n\n  // ã‚½ãƒ¼ãƒˆå¯èƒ½ã‚¢ã‚¤ãƒ†ãƒ \n  function SortableItem({\n    work,\n  }: {\n    work: FragmentOf<typeof DialogWorkFragment>\n  }) {\n    // drag/drop ã®å‹•ä½œç®¡ç†\n    const { attributes, listeners, setNodeRef, transform, transition } =\n      useSortable({ id: work.id })\n\n    const style = {\n      transform: CSS.Transform.toString(transform),\n      transition,\n    }\n\n    return (\n      <div\n        ref={setNodeRef}\n        style={style}\n        {...attributes}\n        {...listeners}\n        // ã€Œä¸¦ã³æ›¿ãˆãƒ¢ãƒ¼ãƒ‰ã€ã§ãªã„ã¨ãã¯ã‚¯ãƒªãƒƒã‚¯ã§\"é¸æŠè§£é™¤\"\n        onClick={\n          !isDragMode\n            ? () => {\n                const newIds = props.selectedWorkIds.filter(\n                  (id) => id !== work.id,\n                )\n                props.setSelectedWorkIds(newIds)\n              }\n            : undefined\n        }\n        className={\n          isDragMode\n            ? \"relative m-2 cursor-grab\" // ä¸¦ã³æ›¿ãˆON: grabã‚«ãƒ¼ã‚½ãƒ«\n            : \"relative m-2 cursor-pointer\" // ä¸¦ã³æ›¿ãˆOFF: ã‚¯ãƒªãƒƒã‚¯è§£é™¤ç”¨\n        }\n      >\n        <img\n          className=\"size-24 rounded-md object-cover\"\n          src={work.smallThumbnailImageURL}\n          alt=\"\"\n        />\n        <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n          {truncateTitle(work.title, 8)}\n        </div>\n      </div>\n    )\n  }\n\n  // é¸æŠä¸­ã‚¿ãƒ–ã®æç”»\n  const renderSelectedWorksDnD = () => {\n    return (\n      <DndContext\n        sensors={sensors}\n        collisionDetection={closestCenter}\n        onDragStart={handleDragStart}\n        onDragEnd={handleDragEnd}\n      >\n        <SortableContext\n          items={props.selectedWorkIds} // é †ç•ªã©ãŠã‚Šã«\n          strategy={rectSortingStrategy}\n        >\n          <div className=\"flex flex-wrap\">\n            {sortedSelectedWorks.map((work) => (\n              <SortableItem key={work.id} work={work} />\n            ))}\n          </div>\n        </SortableContext>\n\n        <DragOverlay adjustScale={false} style={{ transformOrigin: \"0 0 \" }}>\n          {activeDragItem && (\n            <div className=\"size-24 border border-gray-300\">\n              <img\n                className=\"h-full w-full object-cover\"\n                src={activeDragItem.smallThumbnailImageURL}\n                alt=\"\"\n              />\n            </div>\n          )}\n        </DragOverlay>\n      </DndContext>\n    )\n  }\n\n  // ã‚‚ã—æœªé¸æŠã‚¿ãƒ–ã§ä½œå“ãŒå…¨ããªã„å ´åˆ (ã‹ã¤ã€ã‚¿ãƒ–ã‚‚NO_SELECTED) ã®ä¾‹\n  if (!works?.length && tab === \"NO_SELECTED\") {\n    return (\n      <div className=\"p-4\">\n        <ImageIcon className=\"m-auto size-8 opacity-70\" />\n        <p className=\"p-4 text-center text-sm\">\n          {t(\"ä½œå“ãŒã‚ã‚Šã¾ã›ã‚“ã€‚\", \"No works available.\")}\n        </p>\n      </div>\n    )\n  }\n\n  return (\n    <>\n      {/* ã€Œã™ã¹ã¦è¦‹ã‚‹ã€ãƒªãƒ³ã‚¯ï¼šé¸æŠä¸­ãŒ7ä»¶ã‚’è¶…ãˆãŸã‚‰è¡¨ç¤ºä¾‹ */}\n      {props.selectedWorkIds.length > 7 && (\n        // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n        <p\n          onClick={() => setIsOpen(true)}\n          className=\"m-2 cursor-pointer text-right text-sm opacity-80\"\n        >\n          {t(\n            `ã™ã¹ã¦è¦‹ã‚‹(${props.selectedWorkIds.length})`,\n            `View All (${props.selectedWorkIds.length})`,\n          )}\n        </p>\n      )}\n\n      {/* ãƒ€ã‚¤ã‚¢ãƒ­ã‚°å¤–ã§ã¯å…ˆé ­3ä»¶ã ã‘ã‚µãƒ ãƒè¡¨ç¤º */}\n      <div className=\"flex flex-wrap items-center\">\n        {sortedSelectedWorks.slice(0, 3).map((work) => (\n          <div key={work.id} className=\"relative m-2 size-16 md:h-24 md:w-24\">\n            <img\n              className=\"size-16 rounded-md object-cover md:h-24 md:w-24\"\n              src={work.smallThumbnailImageURL}\n              alt=\"\"\n            />\n            <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n              {truncateTitle(work.title, 8)}\n            </div>\n            <div className=\"absolute top-1 left-1 rounded-full border-2 bg-black dark:bg-white\">\n              <CheckIcon className=\"p-1 text-white dark:text-black\" />\n            </div>\n          </div>\n        ))}\n\n        {/* ã€Œï¼‹ã€ãƒœã‚¿ãƒ³ */}\n        <div className=\"border-2 border-transparent p-1\">\n          <Button\n            onClick={() => setIsOpen(true)}\n            className=\"size-16 md:h-24 md:w-24\"\n            size=\"icon\"\n            variant=\"secondary\"\n          >\n            <PlusIcon />\n          </Button>\n        </div>\n      </div>\n\n      {/* ãƒ€ã‚¤ã‚¢ãƒ­ã‚° */}\n      <Dialog open={isOpen} onOpenChange={(opened) => setIsOpen(opened)}>\n        <DialogContent className=\"min-h-[40vw] min-w-[88vw] pl-2\">\n          <DialogHeader>\n            <DialogTitle>{t(\"ä½œå“é¸æŠ\", \"Select Works\")}</DialogTitle>\n          </DialogHeader>\n\n          <Tabs className=\"mt-2 mb-8\" value={tab} defaultValue=\"NO_SELECTED\">\n            <TabsList>\n              <TabsTrigger\n                onClick={() => setTab(\"NO_SELECTED\")}\n                className=\"w-full\"\n                value=\"NO_SELECTED\"\n              >\n                {t(\"æœªé¸æŠ\", \"Not Selected\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => setTab(\"SELECTED\")}\n                className=\"w-full\"\n                value=\"SELECTED\"\n              >\n                {t(\"é¸æŠä¸­\", \"Selected\")}\n              </TabsTrigger>\n            </TabsList>\n          </Tabs>\n\n          <ScrollArea className=\"max-h-80 overflow-y-auto md:max-h-[100%]\">\n            {tab === \"NO_SELECTED\" && (\n              <div className=\"flex flex-wrap\">{renderWorks(works)}</div>\n            )}\n            {tab === \"SELECTED\" && (\n              <>\n                {/* ä¸¦ã³æ›¿ãˆãƒˆã‚°ãƒ« */}\n                <div className=\"mb-4 flex items-center gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => setIsDragMode(!isDragMode)}\n                  >\n                    {isDragMode\n                      ? t(\"ä¸¦ã³æ›¿ãˆçµ‚äº†\", \"Stop Sorting\")\n                      : t(\"ä¸¦ã³æ›¿ãˆ\", \"Sort\")}\n                  </Button>\n                </div>\n                {/* DnDè¡¨ç¤º or ã‚¯ãƒªãƒƒã‚¯è§£é™¤è¡¨ç¤º */}\n                {isDragMode ? (\n                  renderSelectedWorksDnD()\n                ) : (\n                  <div className=\"flex flex-wrap\">\n                    {renderWorks(sortedSelectedWorks)}\n                  </div>\n                )}\n              </>\n            )}\n          </ScrollArea>\n\n          {/* ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ */}\n          {tab === \"NO_SELECTED\" && (\n            <ResponsivePagination\n              perPage={32}\n              maxCount={worksMaxCount}\n              currentPage={page}\n              onPageChange={(p: number) => setPage(p)}\n            />\n          )}\n          {tab === \"SELECTED\" && (\n            <ResponsivePagination\n              perPage={32}\n              maxCount={selectedWorksMaxCount}\n              currentPage={selectedPage}\n              onPageChange={(p: number) => setSelectedPage(p)}\n            />\n          )}\n\n          <div className=\"mt-4 flex gap-2\">\n            <Button onClick={() => setIsOpen(false)}>\n              {t(\"æ±ºå®š\", \"Confirm\")}\n            </Button>\n            <Button variant=\"secondary\" onClick={() => setIsOpen(false)}>\n              {t(\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\", \"Cancel\")}\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </>\n  )\n}\n\n// ==== GraphQL Fragment ====\n// ä½œå“ã‚µãƒ ãƒãƒ»ã‚¿ã‚¤ãƒˆãƒ«ç”¨ã®ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆ\nexport const DialogWorkFragment = graphql(`\n  fragment DialogWork on WorkNode @_unmask {\n    id\n    title\n    smallThumbnailImageURL\n  }\n`)\n\n// ==== GraphQL Queries ====\n// ç·æ•°å–å¾— (ä»»æ„ã® where æ¡ä»¶ã«å¯¾å¿œ)\nconst worksCountQuery = graphql(`\n  query WorksCount($where: WorksWhereInput) {\n    worksCount(where: $where)\n  }\n`)\n\n// ãƒšãƒ¼ã‚¸ãƒ³ã‚°ä»˜ãä½œå“ä¸€è¦§å–å¾— (ä»»æ„ã® where æ¡ä»¶ã«å¯¾å¿œ)\nconst worksQuery = graphql(\n  `\n    query Works($offset: Int!, $limit: Int!, $where: WorksWhereInput) {\n      works(offset: $offset, limit: $limit, where: $where) {\n        ...DialogWork\n      }\n    }\n  `,\n  [DialogWorkFragment],\n)\n"}},{"log":["info",[{"elements":[],"content":"Component definitions inside other components cause them to be recreated on every render, which can lead to performance issues and unexpected behavior."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/select-created-works-dialog-with-ids.tsx"},"span":[6962,6974],"sourceCode":"import { useContext, useState } from \"react\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Button } from \"~/components/ui/button\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { ImageIcon, CheckIcon, PlusIcon } from \"lucide-react\"\nimport { Tabs, TabsList, TabsTrigger } from \"~/components/ui/tabs\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n// ----- dnd-kit -----\nimport {\n  DndContext,\n  DragOverlay,\n  PointerSensor,\n  TouchSensor,\n  useSensor,\n  useSensors,\n  closestCenter,\n  type DragStartEvent,\n  type DragEndEvent,\n} from \"@dnd-kit/core\"\nimport {\n  SortableContext,\n  useSortable,\n  arrayMove,\n  rectSortingStrategy,\n} from \"@dnd-kit/sortable\"\nimport { CSS } from \"@dnd-kit/utilities\"\n\ntype Props = {\n  selectedWorkIds: string[]\n  setSelectedWorkIds: (workIds: string[]) => void\n  limit?: number\n}\n\n/**\n * ä½œæˆæ¸ˆã¿ã®ä½œå“é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function SelectCreatedWorksDialogWithIds (props: Props) {\n  const t = useTranslation()\n  const appContext = useContext(AuthContext)\n\n  const [isOpen, setIsOpen] = useState<boolean>(false)\n  const [page, setPage] = useState(0) // \"æœªé¸æŠ\"ã‚¿ãƒ–ç”¨ãƒšãƒ¼ã‚¸\n  const [selectedPage, setSelectedPage] = useState(0) // \"é¸æŠä¸­\"ã‚¿ãƒ–ç”¨ãƒšãƒ¼ã‚¸\n  const [tab, setTab] = useState<\"NO_SELECTED\" | \"SELECTED\">(\"NO_SELECTED\")\n\n  // ä¸¦ã³æ›¿ãˆãƒˆã‚°ãƒ« (true ã§ãƒ‰ãƒ©ãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰)\n  const [isDragMode, setIsDragMode] = useState(false)\n\n  // ======== æœªé¸æŠã‚¿ãƒ–ç”¨ã‚¯ã‚¨ãƒª (å…¨ä½œå“ + ãƒšãƒ¼ã‚¸ãƒ³ã‚°) ========\n  const worksResult = useQuery(worksQuery, {\n    skip: appContext.isLoading,\n    variables: {\n      offset: page * 32,\n      limit: 32,\n      where: {\n        userId: appContext.userId,\n        orderBy: \"DATE_CREATED\",\n        sort: \"DESC\",\n      },\n    },\n  })\n  const works = worksResult.data?.works ?? []\n\n  // ======== å…¨ä½œå“æ•° (æœªé¸æŠã‚¿ãƒ–ã®ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³) ========\n  const worksCountResp = useQuery(worksCountQuery, {\n    skip: appContext.isLoading,\n    variables: {\n      where: {\n        userId: appContext.userId,\n      },\n    },\n  })\n  const worksMaxCount = worksCountResp.data?.worksCount ?? 0\n\n  // ======== é¸æŠä¸­ã‚¿ãƒ–ç”¨ã‚¯ã‚¨ãƒª (selectedWorkIds ã«åˆè‡´ã™ã‚‹ä½œå“) ========\n  const selectedWorksResult = useQuery(worksQuery, {\n    skip: appContext.isLoading || props.selectedWorkIds.length === 0,\n    variables: {\n      offset: selectedPage * 32,\n      limit: 32,\n      where: {\n        ids: props.selectedWorkIds,\n        orderBy: \"DATE_CREATED\",\n        sort: \"DESC\",\n      },\n    },\n  })\n\n  const selectedWorksQueryData = selectedWorksResult.data?.works ?? []\n\n  // ======== é¸æŠä¸­ã‚¿ãƒ–ã®ä½œå“ç·æ•° (ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³) ========\n  const selectedWorksCountResp = useQuery(worksCountQuery, {\n    skip: appContext.isLoading || props.selectedWorkIds.length === 0,\n    variables: {\n      where: {\n        ids: props.selectedWorkIds,\n      },\n    },\n  })\n  const selectedWorksMaxCount = selectedWorksCountResp.data?.worksCount ?? 0\n\n  // ======== ã‚¿ã‚¤ãƒˆãƒ«ã‚’çœç•¥ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼ ========\n  const truncateTitle = (title: string, maxLength: number) =>\n    title.length > maxLength ? `${title.slice(0, maxLength)}...` : title\n\n  // ======== (æœªé¸æŠã‚¿ãƒ–) ä½œå“ã‚¯ãƒªãƒƒã‚¯ ========\n  const handleWorkClick = (work: FragmentOf<typeof DialogWorkFragment>) => {\n    const isAlreadySelected = props.selectedWorkIds.includes(work.id)\n    if (isAlreadySelected) {\n      // é¸æŠè§£é™¤\n      const newIds = props.selectedWorkIds.filter((id) => id !== work.id)\n      props.setSelectedWorkIds(newIds)\n    } else {\n      // æ–°è¦é¸æŠ\n      if (!props.limit || props.selectedWorkIds.length < props.limit) {\n        const newIds = [...props.selectedWorkIds, work.id]\n        props.setSelectedWorkIds(newIds)\n      } else {\n        toast(\n          t(\n            `é¸æŠã§ãã‚‹ä½œå“æ•°ã¯${props.limit}ã¤ã¾ã§ã§ã™ã€‚`,\n            `You can select up to ${props.limit} works.`,\n          ),\n        )\n      }\n    }\n  }\n\n  // ======== ã€Œé¸æŠä¸­ã€ã‚¿ãƒ–ã§è¡¨ç¤ºã™ã‚‹ä½œå“ã‚’ ID ã®é †ç•ªã«ä¸¦ã³æ›¿ãˆãŸé…åˆ—ã‚’ç”Ÿæˆ ========\n  // DnD ãªã©ã§ä¸¦ã³é †ã‚’å¤‰æ›´ã™ã‚‹ã¨ãã¯ã€props.selectedWorkIds ã“ããŒé †åºã®ã‚½ãƒ¼ã‚¹ã«ãªã‚‹æƒ³å®šã€‚\n  const sortedSelectedWorks = props.selectedWorkIds\n    .map((id) => selectedWorksQueryData.find((w) => w.id === id))\n    .filter(Boolean) as FragmentOf<typeof DialogWorkFragment>[]\n\n  // ======== æœªé¸æŠã‚¿ãƒ–ã®æç”» ========\n  const renderWorks = (\n    worksToRender: FragmentOf<typeof DialogWorkFragment>[],\n  ) => {\n    return worksToRender.map((work) => (\n      <div key={work.id}>\n        {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n        <div\n          className=\"relative m-2 size-24 cursor-pointer\"\n          onClick={() => handleWorkClick(work)}\n        >\n          <img\n            className=\"size-24 rounded-md object-cover\"\n            src={work.smallThumbnailImageURL}\n            alt=\"\"\n          />\n          <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n            {truncateTitle(work.title, 8)}\n          </div>\n          {/* é¸æŠæ¸ˆã¿ã ã£ãŸã‚‰ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¤ã‚³ãƒ³ */}\n          {props.selectedWorkIds.includes(work.id) && (\n            <div className=\"absolute top-1 left-1 rounded-full border-2 bg-black dark:bg-white\">\n              <CheckIcon className=\"p-1 text-white dark:text-black\" />\n            </div>\n          )}\n        </div>\n      </div>\n    ))\n  }\n\n  // ========== ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—é–¢é€£ (SELECTED ã‚¿ãƒ–) ==========\n  const [activeDragItem, setActiveDragItem] = useState<FragmentOf<\n    typeof DialogWorkFragment\n  > | null>(null)\n\n  const sensors = useSensors(useSensor(PointerSensor), useSensor(TouchSensor))\n\n  // ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹\n  const handleDragStart = (event: DragStartEvent) => {\n    const { active } = event\n    const found = sortedSelectedWorks.find((w) => w.id === active.id)\n    if (found) {\n      setActiveDragItem(found)\n    }\n  }\n\n  // ãƒ‰ãƒ©ãƒƒã‚°çµ‚äº†\n  const handleDragEnd = (event: DragEndEvent) => {\n    const { active, over } = event\n    if (!over) {\n      setActiveDragItem(null)\n      return\n    }\n    if (active.id !== over.id) {\n      const oldIndex = props.selectedWorkIds.indexOf(active.id.toString())\n      const newIndex = props.selectedWorkIds.indexOf(over.id.toString())\n      // ä¸¦ã³æ›¿ãˆ\n      if (oldIndex !== -1 && newIndex !== -1) {\n        const newIds = arrayMove(props.selectedWorkIds, oldIndex, newIndex)\n        props.setSelectedWorkIds(newIds)\n      }\n    }\n    setActiveDragItem(null)\n  }\n\n  // ã‚½ãƒ¼ãƒˆå¯èƒ½ã‚¢ã‚¤ãƒ†ãƒ \n  function SortableItem({\n    work,\n  }: {\n    work: FragmentOf<typeof DialogWorkFragment>\n  }) {\n    // drag/drop ã®å‹•ä½œç®¡ç†\n    const { attributes, listeners, setNodeRef, transform, transition } =\n      useSortable({ id: work.id })\n\n    const style = {\n      transform: CSS.Transform.toString(transform),\n      transition,\n    }\n\n    return (\n      <div\n        ref={setNodeRef}\n        style={style}\n        {...attributes}\n        {...listeners}\n        // ã€Œä¸¦ã³æ›¿ãˆãƒ¢ãƒ¼ãƒ‰ã€ã§ãªã„ã¨ãã¯ã‚¯ãƒªãƒƒã‚¯ã§\"é¸æŠè§£é™¤\"\n        onClick={\n          !isDragMode\n            ? () => {\n                const newIds = props.selectedWorkIds.filter(\n                  (id) => id !== work.id,\n                )\n                props.setSelectedWorkIds(newIds)\n              }\n            : undefined\n        }\n        className={\n          isDragMode\n            ? \"relative m-2 cursor-grab\" // ä¸¦ã³æ›¿ãˆON: grabã‚«ãƒ¼ã‚½ãƒ«\n            : \"relative m-2 cursor-pointer\" // ä¸¦ã³æ›¿ãˆOFF: ã‚¯ãƒªãƒƒã‚¯è§£é™¤ç”¨\n        }\n      >\n        <img\n          className=\"size-24 rounded-md object-cover\"\n          src={work.smallThumbnailImageURL}\n          alt=\"\"\n        />\n        <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n          {truncateTitle(work.title, 8)}\n        </div>\n      </div>\n    )\n  }\n\n  // é¸æŠä¸­ã‚¿ãƒ–ã®æç”»\n  const renderSelectedWorksDnD = () => {\n    return (\n      <DndContext\n        sensors={sensors}\n        collisionDetection={closestCenter}\n        onDragStart={handleDragStart}\n        onDragEnd={handleDragEnd}\n      >\n        <SortableContext\n          items={props.selectedWorkIds} // é †ç•ªã©ãŠã‚Šã«\n          strategy={rectSortingStrategy}\n        >\n          <div className=\"flex flex-wrap\">\n            {sortedSelectedWorks.map((work) => (\n              <SortableItem key={work.id} work={work} />\n            ))}\n          </div>\n        </SortableContext>\n\n        <DragOverlay adjustScale={false} style={{ transformOrigin: \"0 0 \" }}>\n          {activeDragItem && (\n            <div className=\"size-24 border border-gray-300\">\n              <img\n                className=\"h-full w-full object-cover\"\n                src={activeDragItem.smallThumbnailImageURL}\n                alt=\"\"\n              />\n            </div>\n          )}\n        </DragOverlay>\n      </DndContext>\n    )\n  }\n\n  // ã‚‚ã—æœªé¸æŠã‚¿ãƒ–ã§ä½œå“ãŒå…¨ããªã„å ´åˆ (ã‹ã¤ã€ã‚¿ãƒ–ã‚‚NO_SELECTED) ã®ä¾‹\n  if (!works?.length && tab === \"NO_SELECTED\") {\n    return (\n      <div className=\"p-4\">\n        <ImageIcon className=\"m-auto size-8 opacity-70\" />\n        <p className=\"p-4 text-center text-sm\">\n          {t(\"ä½œå“ãŒã‚ã‚Šã¾ã›ã‚“ã€‚\", \"No works available.\")}\n        </p>\n      </div>\n    )\n  }\n\n  return (\n    <>\n      {/* ã€Œã™ã¹ã¦è¦‹ã‚‹ã€ãƒªãƒ³ã‚¯ï¼šé¸æŠä¸­ãŒ7ä»¶ã‚’è¶…ãˆãŸã‚‰è¡¨ç¤ºä¾‹ */}\n      {props.selectedWorkIds.length > 7 && (\n        // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n        <p\n          onClick={() => setIsOpen(true)}\n          className=\"m-2 cursor-pointer text-right text-sm opacity-80\"\n        >\n          {t(\n            `ã™ã¹ã¦è¦‹ã‚‹(${props.selectedWorkIds.length})`,\n            `View All (${props.selectedWorkIds.length})`,\n          )}\n        </p>\n      )}\n\n      {/* ãƒ€ã‚¤ã‚¢ãƒ­ã‚°å¤–ã§ã¯å…ˆé ­3ä»¶ã ã‘ã‚µãƒ ãƒè¡¨ç¤º */}\n      <div className=\"flex flex-wrap items-center\">\n        {sortedSelectedWorks.slice(0, 3).map((work) => (\n          <div key={work.id} className=\"relative m-2 size-16 md:h-24 md:w-24\">\n            <img\n              className=\"size-16 rounded-md object-cover md:h-24 md:w-24\"\n              src={work.smallThumbnailImageURL}\n              alt=\"\"\n            />\n            <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n              {truncateTitle(work.title, 8)}\n            </div>\n            <div className=\"absolute top-1 left-1 rounded-full border-2 bg-black dark:bg-white\">\n              <CheckIcon className=\"p-1 text-white dark:text-black\" />\n            </div>\n          </div>\n        ))}\n\n        {/* ã€Œï¼‹ã€ãƒœã‚¿ãƒ³ */}\n        <div className=\"border-2 border-transparent p-1\">\n          <Button\n            onClick={() => setIsOpen(true)}\n            className=\"size-16 md:h-24 md:w-24\"\n            size=\"icon\"\n            variant=\"secondary\"\n          >\n            <PlusIcon />\n          </Button>\n        </div>\n      </div>\n\n      {/* ãƒ€ã‚¤ã‚¢ãƒ­ã‚° */}\n      <Dialog open={isOpen} onOpenChange={(opened) => setIsOpen(opened)}>\n        <DialogContent className=\"min-h-[40vw] min-w-[88vw] pl-2\">\n          <DialogHeader>\n            <DialogTitle>{t(\"ä½œå“é¸æŠ\", \"Select Works\")}</DialogTitle>\n          </DialogHeader>\n\n          <Tabs className=\"mt-2 mb-8\" value={tab} defaultValue=\"NO_SELECTED\">\n            <TabsList>\n              <TabsTrigger\n                onClick={() => setTab(\"NO_SELECTED\")}\n                className=\"w-full\"\n                value=\"NO_SELECTED\"\n              >\n                {t(\"æœªé¸æŠ\", \"Not Selected\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => setTab(\"SELECTED\")}\n                className=\"w-full\"\n                value=\"SELECTED\"\n              >\n                {t(\"é¸æŠä¸­\", \"Selected\")}\n              </TabsTrigger>\n            </TabsList>\n          </Tabs>\n\n          <ScrollArea className=\"max-h-80 overflow-y-auto md:max-h-[100%]\">\n            {tab === \"NO_SELECTED\" && (\n              <div className=\"flex flex-wrap\">{renderWorks(works)}</div>\n            )}\n            {tab === \"SELECTED\" && (\n              <>\n                {/* ä¸¦ã³æ›¿ãˆãƒˆã‚°ãƒ« */}\n                <div className=\"mb-4 flex items-center gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => setIsDragMode(!isDragMode)}\n                  >\n                    {isDragMode\n                      ? t(\"ä¸¦ã³æ›¿ãˆçµ‚äº†\", \"Stop Sorting\")\n                      : t(\"ä¸¦ã³æ›¿ãˆ\", \"Sort\")}\n                  </Button>\n                </div>\n                {/* DnDè¡¨ç¤º or ã‚¯ãƒªãƒƒã‚¯è§£é™¤è¡¨ç¤º */}\n                {isDragMode ? (\n                  renderSelectedWorksDnD()\n                ) : (\n                  <div className=\"flex flex-wrap\">\n                    {renderWorks(sortedSelectedWorks)}\n                  </div>\n                )}\n              </>\n            )}\n          </ScrollArea>\n\n          {/* ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ */}\n          {tab === \"NO_SELECTED\" && (\n            <ResponsivePagination\n              perPage={32}\n              maxCount={worksMaxCount}\n              currentPage={page}\n              onPageChange={(p: number) => setPage(p)}\n            />\n          )}\n          {tab === \"SELECTED\" && (\n            <ResponsivePagination\n              perPage={32}\n              maxCount={selectedWorksMaxCount}\n              currentPage={selectedPage}\n              onPageChange={(p: number) => setSelectedPage(p)}\n            />\n          )}\n\n          <div className=\"mt-4 flex gap-2\">\n            <Button onClick={() => setIsOpen(false)}>\n              {t(\"æ±ºå®š\", \"Confirm\")}\n            </Button>\n            <Button variant=\"secondary\" onClick={() => setIsOpen(false)}>\n              {t(\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\", \"Cancel\")}\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </>\n  )\n}\n\n// ==== GraphQL Fragment ====\n// ä½œå“ã‚µãƒ ãƒãƒ»ã‚¿ã‚¤ãƒˆãƒ«ç”¨ã®ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆ\nexport const DialogWorkFragment = graphql(`\n  fragment DialogWork on WorkNode @_unmask {\n    id\n    title\n    smallThumbnailImageURL\n  }\n`)\n\n// ==== GraphQL Queries ====\n// ç·æ•°å–å¾— (ä»»æ„ã® where æ¡ä»¶ã«å¯¾å¿œ)\nconst worksCountQuery = graphql(`\n  query WorksCount($where: WorksWhereInput) {\n    worksCount(where: $where)\n  }\n`)\n\n// ãƒšãƒ¼ã‚¸ãƒ³ã‚°ä»˜ãä½œå“ä¸€è¦§å–å¾— (ä»»æ„ã® where æ¡ä»¶ã«å¯¾å¿œ)\nconst worksQuery = graphql(\n  `\n    query Works($offset: Int!, $limit: Int!, $where: WorksWhereInput) {\n      works(offset: $offset, limit: $limit, where: $where) {\n        ...DialogWork\n      }\n    }\n  `,\n  [DialogWorkFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/useKeyWithClickEvents","severity":"error","description":"Enforce to have the onClick mouse event with the onKeyUp, the onKeyDown, or the onKeyPress keyboard event.","message":[{"elements":[],"content":"Enforce to have the "},{"elements":["Emphasis"],"content":"onClick"},{"elements":[],"content":" mouse event with the "},{"elements":["Emphasis"],"content":"onKeyUp"},{"elements":[],"content":", the "},{"elements":["Emphasis"],"content":"onKeyDown"},{"elements":[],"content":", or the "},{"elements":["Emphasis"],"content":"onKeyPress"},{"elements":[],"content":" keyboard event."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Actions triggered using mouse events should have corresponding keyboard events to account for keyboard-only navigation."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/select-created-works-dialog-with-ids.tsx"},"span":[7307,7995],"sourceCode":"import { useContext, useState } from \"react\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Button } from \"~/components/ui/button\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { ImageIcon, CheckIcon, PlusIcon } from \"lucide-react\"\nimport { Tabs, TabsList, TabsTrigger } from \"~/components/ui/tabs\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n// ----- dnd-kit -----\nimport {\n  DndContext,\n  DragOverlay,\n  PointerSensor,\n  TouchSensor,\n  useSensor,\n  useSensors,\n  closestCenter,\n  type DragStartEvent,\n  type DragEndEvent,\n} from \"@dnd-kit/core\"\nimport {\n  SortableContext,\n  useSortable,\n  arrayMove,\n  rectSortingStrategy,\n} from \"@dnd-kit/sortable\"\nimport { CSS } from \"@dnd-kit/utilities\"\n\ntype Props = {\n  selectedWorkIds: string[]\n  setSelectedWorkIds: (workIds: string[]) => void\n  limit?: number\n}\n\n/**\n * ä½œæˆæ¸ˆã¿ã®ä½œå“é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function SelectCreatedWorksDialogWithIds (props: Props) {\n  const t = useTranslation()\n  const appContext = useContext(AuthContext)\n\n  const [isOpen, setIsOpen] = useState<boolean>(false)\n  const [page, setPage] = useState(0) // \"æœªé¸æŠ\"ã‚¿ãƒ–ç”¨ãƒšãƒ¼ã‚¸\n  const [selectedPage, setSelectedPage] = useState(0) // \"é¸æŠä¸­\"ã‚¿ãƒ–ç”¨ãƒšãƒ¼ã‚¸\n  const [tab, setTab] = useState<\"NO_SELECTED\" | \"SELECTED\">(\"NO_SELECTED\")\n\n  // ä¸¦ã³æ›¿ãˆãƒˆã‚°ãƒ« (true ã§ãƒ‰ãƒ©ãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰)\n  const [isDragMode, setIsDragMode] = useState(false)\n\n  // ======== æœªé¸æŠã‚¿ãƒ–ç”¨ã‚¯ã‚¨ãƒª (å…¨ä½œå“ + ãƒšãƒ¼ã‚¸ãƒ³ã‚°) ========\n  const worksResult = useQuery(worksQuery, {\n    skip: appContext.isLoading,\n    variables: {\n      offset: page * 32,\n      limit: 32,\n      where: {\n        userId: appContext.userId,\n        orderBy: \"DATE_CREATED\",\n        sort: \"DESC\",\n      },\n    },\n  })\n  const works = worksResult.data?.works ?? []\n\n  // ======== å…¨ä½œå“æ•° (æœªé¸æŠã‚¿ãƒ–ã®ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³) ========\n  const worksCountResp = useQuery(worksCountQuery, {\n    skip: appContext.isLoading,\n    variables: {\n      where: {\n        userId: appContext.userId,\n      },\n    },\n  })\n  const worksMaxCount = worksCountResp.data?.worksCount ?? 0\n\n  // ======== é¸æŠä¸­ã‚¿ãƒ–ç”¨ã‚¯ã‚¨ãƒª (selectedWorkIds ã«åˆè‡´ã™ã‚‹ä½œå“) ========\n  const selectedWorksResult = useQuery(worksQuery, {\n    skip: appContext.isLoading || props.selectedWorkIds.length === 0,\n    variables: {\n      offset: selectedPage * 32,\n      limit: 32,\n      where: {\n        ids: props.selectedWorkIds,\n        orderBy: \"DATE_CREATED\",\n        sort: \"DESC\",\n      },\n    },\n  })\n\n  const selectedWorksQueryData = selectedWorksResult.data?.works ?? []\n\n  // ======== é¸æŠä¸­ã‚¿ãƒ–ã®ä½œå“ç·æ•° (ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³) ========\n  const selectedWorksCountResp = useQuery(worksCountQuery, {\n    skip: appContext.isLoading || props.selectedWorkIds.length === 0,\n    variables: {\n      where: {\n        ids: props.selectedWorkIds,\n      },\n    },\n  })\n  const selectedWorksMaxCount = selectedWorksCountResp.data?.worksCount ?? 0\n\n  // ======== ã‚¿ã‚¤ãƒˆãƒ«ã‚’çœç•¥ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼ ========\n  const truncateTitle = (title: string, maxLength: number) =>\n    title.length > maxLength ? `${title.slice(0, maxLength)}...` : title\n\n  // ======== (æœªé¸æŠã‚¿ãƒ–) ä½œå“ã‚¯ãƒªãƒƒã‚¯ ========\n  const handleWorkClick = (work: FragmentOf<typeof DialogWorkFragment>) => {\n    const isAlreadySelected = props.selectedWorkIds.includes(work.id)\n    if (isAlreadySelected) {\n      // é¸æŠè§£é™¤\n      const newIds = props.selectedWorkIds.filter((id) => id !== work.id)\n      props.setSelectedWorkIds(newIds)\n    } else {\n      // æ–°è¦é¸æŠ\n      if (!props.limit || props.selectedWorkIds.length < props.limit) {\n        const newIds = [...props.selectedWorkIds, work.id]\n        props.setSelectedWorkIds(newIds)\n      } else {\n        toast(\n          t(\n            `é¸æŠã§ãã‚‹ä½œå“æ•°ã¯${props.limit}ã¤ã¾ã§ã§ã™ã€‚`,\n            `You can select up to ${props.limit} works.`,\n          ),\n        )\n      }\n    }\n  }\n\n  // ======== ã€Œé¸æŠä¸­ã€ã‚¿ãƒ–ã§è¡¨ç¤ºã™ã‚‹ä½œå“ã‚’ ID ã®é †ç•ªã«ä¸¦ã³æ›¿ãˆãŸé…åˆ—ã‚’ç”Ÿæˆ ========\n  // DnD ãªã©ã§ä¸¦ã³é †ã‚’å¤‰æ›´ã™ã‚‹ã¨ãã¯ã€props.selectedWorkIds ã“ããŒé †åºã®ã‚½ãƒ¼ã‚¹ã«ãªã‚‹æƒ³å®šã€‚\n  const sortedSelectedWorks = props.selectedWorkIds\n    .map((id) => selectedWorksQueryData.find((w) => w.id === id))\n    .filter(Boolean) as FragmentOf<typeof DialogWorkFragment>[]\n\n  // ======== æœªé¸æŠã‚¿ãƒ–ã®æç”» ========\n  const renderWorks = (\n    worksToRender: FragmentOf<typeof DialogWorkFragment>[],\n  ) => {\n    return worksToRender.map((work) => (\n      <div key={work.id}>\n        {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n        <div\n          className=\"relative m-2 size-24 cursor-pointer\"\n          onClick={() => handleWorkClick(work)}\n        >\n          <img\n            className=\"size-24 rounded-md object-cover\"\n            src={work.smallThumbnailImageURL}\n            alt=\"\"\n          />\n          <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n            {truncateTitle(work.title, 8)}\n          </div>\n          {/* é¸æŠæ¸ˆã¿ã ã£ãŸã‚‰ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¤ã‚³ãƒ³ */}\n          {props.selectedWorkIds.includes(work.id) && (\n            <div className=\"absolute top-1 left-1 rounded-full border-2 bg-black dark:bg-white\">\n              <CheckIcon className=\"p-1 text-white dark:text-black\" />\n            </div>\n          )}\n        </div>\n      </div>\n    ))\n  }\n\n  // ========== ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—é–¢é€£ (SELECTED ã‚¿ãƒ–) ==========\n  const [activeDragItem, setActiveDragItem] = useState<FragmentOf<\n    typeof DialogWorkFragment\n  > | null>(null)\n\n  const sensors = useSensors(useSensor(PointerSensor), useSensor(TouchSensor))\n\n  // ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹\n  const handleDragStart = (event: DragStartEvent) => {\n    const { active } = event\n    const found = sortedSelectedWorks.find((w) => w.id === active.id)\n    if (found) {\n      setActiveDragItem(found)\n    }\n  }\n\n  // ãƒ‰ãƒ©ãƒƒã‚°çµ‚äº†\n  const handleDragEnd = (event: DragEndEvent) => {\n    const { active, over } = event\n    if (!over) {\n      setActiveDragItem(null)\n      return\n    }\n    if (active.id !== over.id) {\n      const oldIndex = props.selectedWorkIds.indexOf(active.id.toString())\n      const newIndex = props.selectedWorkIds.indexOf(over.id.toString())\n      // ä¸¦ã³æ›¿ãˆ\n      if (oldIndex !== -1 && newIndex !== -1) {\n        const newIds = arrayMove(props.selectedWorkIds, oldIndex, newIndex)\n        props.setSelectedWorkIds(newIds)\n      }\n    }\n    setActiveDragItem(null)\n  }\n\n  // ã‚½ãƒ¼ãƒˆå¯èƒ½ã‚¢ã‚¤ãƒ†ãƒ \n  function SortableItem({\n    work,\n  }: {\n    work: FragmentOf<typeof DialogWorkFragment>\n  }) {\n    // drag/drop ã®å‹•ä½œç®¡ç†\n    const { attributes, listeners, setNodeRef, transform, transition } =\n      useSortable({ id: work.id })\n\n    const style = {\n      transform: CSS.Transform.toString(transform),\n      transition,\n    }\n\n    return (\n      <div\n        ref={setNodeRef}\n        style={style}\n        {...attributes}\n        {...listeners}\n        // ã€Œä¸¦ã³æ›¿ãˆãƒ¢ãƒ¼ãƒ‰ã€ã§ãªã„ã¨ãã¯ã‚¯ãƒªãƒƒã‚¯ã§\"é¸æŠè§£é™¤\"\n        onClick={\n          !isDragMode\n            ? () => {\n                const newIds = props.selectedWorkIds.filter(\n                  (id) => id !== work.id,\n                )\n                props.setSelectedWorkIds(newIds)\n              }\n            : undefined\n        }\n        className={\n          isDragMode\n            ? \"relative m-2 cursor-grab\" // ä¸¦ã³æ›¿ãˆON: grabã‚«ãƒ¼ã‚½ãƒ«\n            : \"relative m-2 cursor-pointer\" // ä¸¦ã³æ›¿ãˆOFF: ã‚¯ãƒªãƒƒã‚¯è§£é™¤ç”¨\n        }\n      >\n        <img\n          className=\"size-24 rounded-md object-cover\"\n          src={work.smallThumbnailImageURL}\n          alt=\"\"\n        />\n        <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n          {truncateTitle(work.title, 8)}\n        </div>\n      </div>\n    )\n  }\n\n  // é¸æŠä¸­ã‚¿ãƒ–ã®æç”»\n  const renderSelectedWorksDnD = () => {\n    return (\n      <DndContext\n        sensors={sensors}\n        collisionDetection={closestCenter}\n        onDragStart={handleDragStart}\n        onDragEnd={handleDragEnd}\n      >\n        <SortableContext\n          items={props.selectedWorkIds} // é †ç•ªã©ãŠã‚Šã«\n          strategy={rectSortingStrategy}\n        >\n          <div className=\"flex flex-wrap\">\n            {sortedSelectedWorks.map((work) => (\n              <SortableItem key={work.id} work={work} />\n            ))}\n          </div>\n        </SortableContext>\n\n        <DragOverlay adjustScale={false} style={{ transformOrigin: \"0 0 \" }}>\n          {activeDragItem && (\n            <div className=\"size-24 border border-gray-300\">\n              <img\n                className=\"h-full w-full object-cover\"\n                src={activeDragItem.smallThumbnailImageURL}\n                alt=\"\"\n              />\n            </div>\n          )}\n        </DragOverlay>\n      </DndContext>\n    )\n  }\n\n  // ã‚‚ã—æœªé¸æŠã‚¿ãƒ–ã§ä½œå“ãŒå…¨ããªã„å ´åˆ (ã‹ã¤ã€ã‚¿ãƒ–ã‚‚NO_SELECTED) ã®ä¾‹\n  if (!works?.length && tab === \"NO_SELECTED\") {\n    return (\n      <div className=\"p-4\">\n        <ImageIcon className=\"m-auto size-8 opacity-70\" />\n        <p className=\"p-4 text-center text-sm\">\n          {t(\"ä½œå“ãŒã‚ã‚Šã¾ã›ã‚“ã€‚\", \"No works available.\")}\n        </p>\n      </div>\n    )\n  }\n\n  return (\n    <>\n      {/* ã€Œã™ã¹ã¦è¦‹ã‚‹ã€ãƒªãƒ³ã‚¯ï¼šé¸æŠä¸­ãŒ7ä»¶ã‚’è¶…ãˆãŸã‚‰è¡¨ç¤ºä¾‹ */}\n      {props.selectedWorkIds.length > 7 && (\n        // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n        <p\n          onClick={() => setIsOpen(true)}\n          className=\"m-2 cursor-pointer text-right text-sm opacity-80\"\n        >\n          {t(\n            `ã™ã¹ã¦è¦‹ã‚‹(${props.selectedWorkIds.length})`,\n            `View All (${props.selectedWorkIds.length})`,\n          )}\n        </p>\n      )}\n\n      {/* ãƒ€ã‚¤ã‚¢ãƒ­ã‚°å¤–ã§ã¯å…ˆé ­3ä»¶ã ã‘ã‚µãƒ ãƒè¡¨ç¤º */}\n      <div className=\"flex flex-wrap items-center\">\n        {sortedSelectedWorks.slice(0, 3).map((work) => (\n          <div key={work.id} className=\"relative m-2 size-16 md:h-24 md:w-24\">\n            <img\n              className=\"size-16 rounded-md object-cover md:h-24 md:w-24\"\n              src={work.smallThumbnailImageURL}\n              alt=\"\"\n            />\n            <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n              {truncateTitle(work.title, 8)}\n            </div>\n            <div className=\"absolute top-1 left-1 rounded-full border-2 bg-black dark:bg-white\">\n              <CheckIcon className=\"p-1 text-white dark:text-black\" />\n            </div>\n          </div>\n        ))}\n\n        {/* ã€Œï¼‹ã€ãƒœã‚¿ãƒ³ */}\n        <div className=\"border-2 border-transparent p-1\">\n          <Button\n            onClick={() => setIsOpen(true)}\n            className=\"size-16 md:h-24 md:w-24\"\n            size=\"icon\"\n            variant=\"secondary\"\n          >\n            <PlusIcon />\n          </Button>\n        </div>\n      </div>\n\n      {/* ãƒ€ã‚¤ã‚¢ãƒ­ã‚° */}\n      <Dialog open={isOpen} onOpenChange={(opened) => setIsOpen(opened)}>\n        <DialogContent className=\"min-h-[40vw] min-w-[88vw] pl-2\">\n          <DialogHeader>\n            <DialogTitle>{t(\"ä½œå“é¸æŠ\", \"Select Works\")}</DialogTitle>\n          </DialogHeader>\n\n          <Tabs className=\"mt-2 mb-8\" value={tab} defaultValue=\"NO_SELECTED\">\n            <TabsList>\n              <TabsTrigger\n                onClick={() => setTab(\"NO_SELECTED\")}\n                className=\"w-full\"\n                value=\"NO_SELECTED\"\n              >\n                {t(\"æœªé¸æŠ\", \"Not Selected\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => setTab(\"SELECTED\")}\n                className=\"w-full\"\n                value=\"SELECTED\"\n              >\n                {t(\"é¸æŠä¸­\", \"Selected\")}\n              </TabsTrigger>\n            </TabsList>\n          </Tabs>\n\n          <ScrollArea className=\"max-h-80 overflow-y-auto md:max-h-[100%]\">\n            {tab === \"NO_SELECTED\" && (\n              <div className=\"flex flex-wrap\">{renderWorks(works)}</div>\n            )}\n            {tab === \"SELECTED\" && (\n              <>\n                {/* ä¸¦ã³æ›¿ãˆãƒˆã‚°ãƒ« */}\n                <div className=\"mb-4 flex items-center gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => setIsDragMode(!isDragMode)}\n                  >\n                    {isDragMode\n                      ? t(\"ä¸¦ã³æ›¿ãˆçµ‚äº†\", \"Stop Sorting\")\n                      : t(\"ä¸¦ã³æ›¿ãˆ\", \"Sort\")}\n                  </Button>\n                </div>\n                {/* DnDè¡¨ç¤º or ã‚¯ãƒªãƒƒã‚¯è§£é™¤è¡¨ç¤º */}\n                {isDragMode ? (\n                  renderSelectedWorksDnD()\n                ) : (\n                  <div className=\"flex flex-wrap\">\n                    {renderWorks(sortedSelectedWorks)}\n                  </div>\n                )}\n              </>\n            )}\n          </ScrollArea>\n\n          {/* ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ */}\n          {tab === \"NO_SELECTED\" && (\n            <ResponsivePagination\n              perPage={32}\n              maxCount={worksMaxCount}\n              currentPage={page}\n              onPageChange={(p: number) => setPage(p)}\n            />\n          )}\n          {tab === \"SELECTED\" && (\n            <ResponsivePagination\n              perPage={32}\n              maxCount={selectedWorksMaxCount}\n              currentPage={selectedPage}\n              onPageChange={(p: number) => setSelectedPage(p)}\n            />\n          )}\n\n          <div className=\"mt-4 flex gap-2\">\n            <Button onClick={() => setIsOpen(false)}>\n              {t(\"æ±ºå®š\", \"Confirm\")}\n            </Button>\n            <Button variant=\"secondary\" onClick={() => setIsOpen(false)}>\n              {t(\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\", \"Cancel\")}\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </>\n  )\n}\n\n// ==== GraphQL Fragment ====\n// ä½œå“ã‚µãƒ ãƒãƒ»ã‚¿ã‚¤ãƒˆãƒ«ç”¨ã®ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆ\nexport const DialogWorkFragment = graphql(`\n  fragment DialogWork on WorkNode @_unmask {\n    id\n    title\n    smallThumbnailImageURL\n  }\n`)\n\n// ==== GraphQL Queries ====\n// ç·æ•°å–å¾— (ä»»æ„ã® where æ¡ä»¶ã«å¯¾å¿œ)\nconst worksCountQuery = graphql(`\n  query WorksCount($where: WorksWhereInput) {\n    worksCount(where: $where)\n  }\n`)\n\n// ãƒšãƒ¼ã‚¸ãƒ³ã‚°ä»˜ãä½œå“ä¸€è¦§å–å¾— (ä»»æ„ã® where æ¡ä»¶ã«å¯¾å¿œ)\nconst worksQuery = graphql(\n  `\n    query Works($offset: Int!, $limit: Int!, $where: WorksWhereInput) {\n      works(offset: $offset, limit: $limit, where: $where) {\n        ...DialogWork\n      }\n    }\n  `,\n  [DialogWorkFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/select-created-works-dialog-with-ids.tsx"},"span":[7307,7995],"sourceCode":"import { useContext, useState } from \"react\"\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"~/components/ui/dialog\"\nimport { Button } from \"~/components/ui/button\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { ImageIcon, CheckIcon, PlusIcon } from \"lucide-react\"\nimport { Tabs, TabsList, TabsTrigger } from \"~/components/ui/tabs\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { ScrollArea } from \"~/components/ui/scroll-area\"\nimport { type FragmentOf, graphql } from \"gql.tada\"\nimport { toast } from \"sonner\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\n// ----- dnd-kit -----\nimport {\n  DndContext,\n  DragOverlay,\n  PointerSensor,\n  TouchSensor,\n  useSensor,\n  useSensors,\n  closestCenter,\n  type DragStartEvent,\n  type DragEndEvent,\n} from \"@dnd-kit/core\"\nimport {\n  SortableContext,\n  useSortable,\n  arrayMove,\n  rectSortingStrategy,\n} from \"@dnd-kit/sortable\"\nimport { CSS } from \"@dnd-kit/utilities\"\n\ntype Props = {\n  selectedWorkIds: string[]\n  setSelectedWorkIds: (workIds: string[]) => void\n  limit?: number\n}\n\n/**\n * ä½œæˆæ¸ˆã¿ã®ä½œå“é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚°\n */\nexport function SelectCreatedWorksDialogWithIds (props: Props) {\n  const t = useTranslation()\n  const appContext = useContext(AuthContext)\n\n  const [isOpen, setIsOpen] = useState<boolean>(false)\n  const [page, setPage] = useState(0) // \"æœªé¸æŠ\"ã‚¿ãƒ–ç”¨ãƒšãƒ¼ã‚¸\n  const [selectedPage, setSelectedPage] = useState(0) // \"é¸æŠä¸­\"ã‚¿ãƒ–ç”¨ãƒšãƒ¼ã‚¸\n  const [tab, setTab] = useState<\"NO_SELECTED\" | \"SELECTED\">(\"NO_SELECTED\")\n\n  // ä¸¦ã³æ›¿ãˆãƒˆã‚°ãƒ« (true ã§ãƒ‰ãƒ©ãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰)\n  const [isDragMode, setIsDragMode] = useState(false)\n\n  // ======== æœªé¸æŠã‚¿ãƒ–ç”¨ã‚¯ã‚¨ãƒª (å…¨ä½œå“ + ãƒšãƒ¼ã‚¸ãƒ³ã‚°) ========\n  const worksResult = useQuery(worksQuery, {\n    skip: appContext.isLoading,\n    variables: {\n      offset: page * 32,\n      limit: 32,\n      where: {\n        userId: appContext.userId,\n        orderBy: \"DATE_CREATED\",\n        sort: \"DESC\",\n      },\n    },\n  })\n  const works = worksResult.data?.works ?? []\n\n  // ======== å…¨ä½œå“æ•° (æœªé¸æŠã‚¿ãƒ–ã®ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³) ========\n  const worksCountResp = useQuery(worksCountQuery, {\n    skip: appContext.isLoading,\n    variables: {\n      where: {\n        userId: appContext.userId,\n      },\n    },\n  })\n  const worksMaxCount = worksCountResp.data?.worksCount ?? 0\n\n  // ======== é¸æŠä¸­ã‚¿ãƒ–ç”¨ã‚¯ã‚¨ãƒª (selectedWorkIds ã«åˆè‡´ã™ã‚‹ä½œå“) ========\n  const selectedWorksResult = useQuery(worksQuery, {\n    skip: appContext.isLoading || props.selectedWorkIds.length === 0,\n    variables: {\n      offset: selectedPage * 32,\n      limit: 32,\n      where: {\n        ids: props.selectedWorkIds,\n        orderBy: \"DATE_CREATED\",\n        sort: \"DESC\",\n      },\n    },\n  })\n\n  const selectedWorksQueryData = selectedWorksResult.data?.works ?? []\n\n  // ======== é¸æŠä¸­ã‚¿ãƒ–ã®ä½œå“ç·æ•° (ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³) ========\n  const selectedWorksCountResp = useQuery(worksCountQuery, {\n    skip: appContext.isLoading || props.selectedWorkIds.length === 0,\n    variables: {\n      where: {\n        ids: props.selectedWorkIds,\n      },\n    },\n  })\n  const selectedWorksMaxCount = selectedWorksCountResp.data?.worksCount ?? 0\n\n  // ======== ã‚¿ã‚¤ãƒˆãƒ«ã‚’çœç•¥ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼ ========\n  const truncateTitle = (title: string, maxLength: number) =>\n    title.length > maxLength ? `${title.slice(0, maxLength)}...` : title\n\n  // ======== (æœªé¸æŠã‚¿ãƒ–) ä½œå“ã‚¯ãƒªãƒƒã‚¯ ========\n  const handleWorkClick = (work: FragmentOf<typeof DialogWorkFragment>) => {\n    const isAlreadySelected = props.selectedWorkIds.includes(work.id)\n    if (isAlreadySelected) {\n      // é¸æŠè§£é™¤\n      const newIds = props.selectedWorkIds.filter((id) => id !== work.id)\n      props.setSelectedWorkIds(newIds)\n    } else {\n      // æ–°è¦é¸æŠ\n      if (!props.limit || props.selectedWorkIds.length < props.limit) {\n        const newIds = [...props.selectedWorkIds, work.id]\n        props.setSelectedWorkIds(newIds)\n      } else {\n        toast(\n          t(\n            `é¸æŠã§ãã‚‹ä½œå“æ•°ã¯${props.limit}ã¤ã¾ã§ã§ã™ã€‚`,\n            `You can select up to ${props.limit} works.`,\n          ),\n        )\n      }\n    }\n  }\n\n  // ======== ã€Œé¸æŠä¸­ã€ã‚¿ãƒ–ã§è¡¨ç¤ºã™ã‚‹ä½œå“ã‚’ ID ã®é †ç•ªã«ä¸¦ã³æ›¿ãˆãŸé…åˆ—ã‚’ç”Ÿæˆ ========\n  // DnD ãªã©ã§ä¸¦ã³é †ã‚’å¤‰æ›´ã™ã‚‹ã¨ãã¯ã€props.selectedWorkIds ã“ããŒé †åºã®ã‚½ãƒ¼ã‚¹ã«ãªã‚‹æƒ³å®šã€‚\n  const sortedSelectedWorks = props.selectedWorkIds\n    .map((id) => selectedWorksQueryData.find((w) => w.id === id))\n    .filter(Boolean) as FragmentOf<typeof DialogWorkFragment>[]\n\n  // ======== æœªé¸æŠã‚¿ãƒ–ã®æç”» ========\n  const renderWorks = (\n    worksToRender: FragmentOf<typeof DialogWorkFragment>[],\n  ) => {\n    return worksToRender.map((work) => (\n      <div key={work.id}>\n        {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n        <div\n          className=\"relative m-2 size-24 cursor-pointer\"\n          onClick={() => handleWorkClick(work)}\n        >\n          <img\n            className=\"size-24 rounded-md object-cover\"\n            src={work.smallThumbnailImageURL}\n            alt=\"\"\n          />\n          <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n            {truncateTitle(work.title, 8)}\n          </div>\n          {/* é¸æŠæ¸ˆã¿ã ã£ãŸã‚‰ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¤ã‚³ãƒ³ */}\n          {props.selectedWorkIds.includes(work.id) && (\n            <div className=\"absolute top-1 left-1 rounded-full border-2 bg-black dark:bg-white\">\n              <CheckIcon className=\"p-1 text-white dark:text-black\" />\n            </div>\n          )}\n        </div>\n      </div>\n    ))\n  }\n\n  // ========== ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—é–¢é€£ (SELECTED ã‚¿ãƒ–) ==========\n  const [activeDragItem, setActiveDragItem] = useState<FragmentOf<\n    typeof DialogWorkFragment\n  > | null>(null)\n\n  const sensors = useSensors(useSensor(PointerSensor), useSensor(TouchSensor))\n\n  // ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹\n  const handleDragStart = (event: DragStartEvent) => {\n    const { active } = event\n    const found = sortedSelectedWorks.find((w) => w.id === active.id)\n    if (found) {\n      setActiveDragItem(found)\n    }\n  }\n\n  // ãƒ‰ãƒ©ãƒƒã‚°çµ‚äº†\n  const handleDragEnd = (event: DragEndEvent) => {\n    const { active, over } = event\n    if (!over) {\n      setActiveDragItem(null)\n      return\n    }\n    if (active.id !== over.id) {\n      const oldIndex = props.selectedWorkIds.indexOf(active.id.toString())\n      const newIndex = props.selectedWorkIds.indexOf(over.id.toString())\n      // ä¸¦ã³æ›¿ãˆ\n      if (oldIndex !== -1 && newIndex !== -1) {\n        const newIds = arrayMove(props.selectedWorkIds, oldIndex, newIndex)\n        props.setSelectedWorkIds(newIds)\n      }\n    }\n    setActiveDragItem(null)\n  }\n\n  // ã‚½ãƒ¼ãƒˆå¯èƒ½ã‚¢ã‚¤ãƒ†ãƒ \n  function SortableItem({\n    work,\n  }: {\n    work: FragmentOf<typeof DialogWorkFragment>\n  }) {\n    // drag/drop ã®å‹•ä½œç®¡ç†\n    const { attributes, listeners, setNodeRef, transform, transition } =\n      useSortable({ id: work.id })\n\n    const style = {\n      transform: CSS.Transform.toString(transform),\n      transition,\n    }\n\n    return (\n      <div\n        ref={setNodeRef}\n        style={style}\n        {...attributes}\n        {...listeners}\n        // ã€Œä¸¦ã³æ›¿ãˆãƒ¢ãƒ¼ãƒ‰ã€ã§ãªã„ã¨ãã¯ã‚¯ãƒªãƒƒã‚¯ã§\"é¸æŠè§£é™¤\"\n        onClick={\n          !isDragMode\n            ? () => {\n                const newIds = props.selectedWorkIds.filter(\n                  (id) => id !== work.id,\n                )\n                props.setSelectedWorkIds(newIds)\n              }\n            : undefined\n        }\n        className={\n          isDragMode\n            ? \"relative m-2 cursor-grab\" // ä¸¦ã³æ›¿ãˆON: grabã‚«ãƒ¼ã‚½ãƒ«\n            : \"relative m-2 cursor-pointer\" // ä¸¦ã³æ›¿ãˆOFF: ã‚¯ãƒªãƒƒã‚¯è§£é™¤ç”¨\n        }\n      >\n        <img\n          className=\"size-24 rounded-md object-cover\"\n          src={work.smallThumbnailImageURL}\n          alt=\"\"\n        />\n        <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n          {truncateTitle(work.title, 8)}\n        </div>\n      </div>\n    )\n  }\n\n  // é¸æŠä¸­ã‚¿ãƒ–ã®æç”»\n  const renderSelectedWorksDnD = () => {\n    return (\n      <DndContext\n        sensors={sensors}\n        collisionDetection={closestCenter}\n        onDragStart={handleDragStart}\n        onDragEnd={handleDragEnd}\n      >\n        <SortableContext\n          items={props.selectedWorkIds} // é †ç•ªã©ãŠã‚Šã«\n          strategy={rectSortingStrategy}\n        >\n          <div className=\"flex flex-wrap\">\n            {sortedSelectedWorks.map((work) => (\n              <SortableItem key={work.id} work={work} />\n            ))}\n          </div>\n        </SortableContext>\n\n        <DragOverlay adjustScale={false} style={{ transformOrigin: \"0 0 \" }}>\n          {activeDragItem && (\n            <div className=\"size-24 border border-gray-300\">\n              <img\n                className=\"h-full w-full object-cover\"\n                src={activeDragItem.smallThumbnailImageURL}\n                alt=\"\"\n              />\n            </div>\n          )}\n        </DragOverlay>\n      </DndContext>\n    )\n  }\n\n  // ã‚‚ã—æœªé¸æŠã‚¿ãƒ–ã§ä½œå“ãŒå…¨ããªã„å ´åˆ (ã‹ã¤ã€ã‚¿ãƒ–ã‚‚NO_SELECTED) ã®ä¾‹\n  if (!works?.length && tab === \"NO_SELECTED\") {\n    return (\n      <div className=\"p-4\">\n        <ImageIcon className=\"m-auto size-8 opacity-70\" />\n        <p className=\"p-4 text-center text-sm\">\n          {t(\"ä½œå“ãŒã‚ã‚Šã¾ã›ã‚“ã€‚\", \"No works available.\")}\n        </p>\n      </div>\n    )\n  }\n\n  return (\n    <>\n      {/* ã€Œã™ã¹ã¦è¦‹ã‚‹ã€ãƒªãƒ³ã‚¯ï¼šé¸æŠä¸­ãŒ7ä»¶ã‚’è¶…ãˆãŸã‚‰è¡¨ç¤ºä¾‹ */}\n      {props.selectedWorkIds.length > 7 && (\n        // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n        <p\n          onClick={() => setIsOpen(true)}\n          className=\"m-2 cursor-pointer text-right text-sm opacity-80\"\n        >\n          {t(\n            `ã™ã¹ã¦è¦‹ã‚‹(${props.selectedWorkIds.length})`,\n            `View All (${props.selectedWorkIds.length})`,\n          )}\n        </p>\n      )}\n\n      {/* ãƒ€ã‚¤ã‚¢ãƒ­ã‚°å¤–ã§ã¯å…ˆé ­3ä»¶ã ã‘ã‚µãƒ ãƒè¡¨ç¤º */}\n      <div className=\"flex flex-wrap items-center\">\n        {sortedSelectedWorks.slice(0, 3).map((work) => (\n          <div key={work.id} className=\"relative m-2 size-16 md:h-24 md:w-24\">\n            <img\n              className=\"size-16 rounded-md object-cover md:h-24 md:w-24\"\n              src={work.smallThumbnailImageURL}\n              alt=\"\"\n            />\n            <div className=\"absolute bottom-0 bg-gray-800 bg-opacity-50 text-white text-xs\">\n              {truncateTitle(work.title, 8)}\n            </div>\n            <div className=\"absolute top-1 left-1 rounded-full border-2 bg-black dark:bg-white\">\n              <CheckIcon className=\"p-1 text-white dark:text-black\" />\n            </div>\n          </div>\n        ))}\n\n        {/* ã€Œï¼‹ã€ãƒœã‚¿ãƒ³ */}\n        <div className=\"border-2 border-transparent p-1\">\n          <Button\n            onClick={() => setIsOpen(true)}\n            className=\"size-16 md:h-24 md:w-24\"\n            size=\"icon\"\n            variant=\"secondary\"\n          >\n            <PlusIcon />\n          </Button>\n        </div>\n      </div>\n\n      {/* ãƒ€ã‚¤ã‚¢ãƒ­ã‚° */}\n      <Dialog open={isOpen} onOpenChange={(opened) => setIsOpen(opened)}>\n        <DialogContent className=\"min-h-[40vw] min-w-[88vw] pl-2\">\n          <DialogHeader>\n            <DialogTitle>{t(\"ä½œå“é¸æŠ\", \"Select Works\")}</DialogTitle>\n          </DialogHeader>\n\n          <Tabs className=\"mt-2 mb-8\" value={tab} defaultValue=\"NO_SELECTED\">\n            <TabsList>\n              <TabsTrigger\n                onClick={() => setTab(\"NO_SELECTED\")}\n                className=\"w-full\"\n                value=\"NO_SELECTED\"\n              >\n                {t(\"æœªé¸æŠ\", \"Not Selected\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => setTab(\"SELECTED\")}\n                className=\"w-full\"\n                value=\"SELECTED\"\n              >\n                {t(\"é¸æŠä¸­\", \"Selected\")}\n              </TabsTrigger>\n            </TabsList>\n          </Tabs>\n\n          <ScrollArea className=\"max-h-80 overflow-y-auto md:max-h-[100%]\">\n            {tab === \"NO_SELECTED\" && (\n              <div className=\"flex flex-wrap\">{renderWorks(works)}</div>\n            )}\n            {tab === \"SELECTED\" && (\n              <>\n                {/* ä¸¦ã³æ›¿ãˆãƒˆã‚°ãƒ« */}\n                <div className=\"mb-4 flex items-center gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => setIsDragMode(!isDragMode)}\n                  >\n                    {isDragMode\n                      ? t(\"ä¸¦ã³æ›¿ãˆçµ‚äº†\", \"Stop Sorting\")\n                      : t(\"ä¸¦ã³æ›¿ãˆ\", \"Sort\")}\n                  </Button>\n                </div>\n                {/* DnDè¡¨ç¤º or ã‚¯ãƒªãƒƒã‚¯è§£é™¤è¡¨ç¤º */}\n                {isDragMode ? (\n                  renderSelectedWorksDnD()\n                ) : (\n                  <div className=\"flex flex-wrap\">\n                    {renderWorks(sortedSelectedWorks)}\n                  </div>\n                )}\n              </>\n            )}\n          </ScrollArea>\n\n          {/* ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ */}\n          {tab === \"NO_SELECTED\" && (\n            <ResponsivePagination\n              perPage={32}\n              maxCount={worksMaxCount}\n              currentPage={page}\n              onPageChange={(p: number) => setPage(p)}\n            />\n          )}\n          {tab === \"SELECTED\" && (\n            <ResponsivePagination\n              perPage={32}\n              maxCount={selectedWorksMaxCount}\n              currentPage={selectedPage}\n              onPageChange={(p: number) => setSelectedPage(p)}\n            />\n          )}\n\n          <div className=\"mt-4 flex gap-2\">\n            <Button onClick={() => setIsOpen(false)}>\n              {t(\"æ±ºå®š\", \"Confirm\")}\n            </Button>\n            <Button variant=\"secondary\" onClick={() => setIsOpen(false)}>\n              {t(\"ã‚­ãƒ£ãƒ³ã‚»ãƒ«\", \"Cancel\")}\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </>\n  )\n}\n\n// ==== GraphQL Fragment ====\n// ä½œå“ã‚µãƒ ãƒãƒ»ã‚¿ã‚¤ãƒˆãƒ«ç”¨ã®ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆ\nexport const DialogWorkFragment = graphql(`\n  fragment DialogWork on WorkNode @_unmask {\n    id\n    title\n    smallThumbnailImageURL\n  }\n`)\n\n// ==== GraphQL Queries ====\n// ç·æ•°å–å¾— (ä»»æ„ã® where æ¡ä»¶ã«å¯¾å¿œ)\nconst worksCountQuery = graphql(`\n  query WorksCount($where: WorksWhereInput) {\n    worksCount(where: $where)\n  }\n`)\n\n// ãƒšãƒ¼ã‚¸ãƒ³ã‚°ä»˜ãä½œå“ä¸€è¦§å–å¾— (ä»»æ„ã® where æ¡ä»¶ã«å¯¾å¿œ)\nconst worksQuery = graphql(\n  `\n    query Works($offset: Int!, $limit: Int!, $where: WorksWhereInput) {\n      works(offset: $offset, limit: $limit, where: $where) {\n        ...DialogWork\n      }\n    }\n  `,\n  [DialogWorkFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[743,759],"sourceCode":"import { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext } from \"react\"\nimport {\n  BookmarkWorksList,\n  BookmarkWorksListItemFragment,\n} from \"~/routes/($lang).my._index/components/bookmark-works-list\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\n\ntype Props = {\n  page: number\n  maxCount: number\n  setPage: (page: number) => void\n}\n\n/**\n * é–²è¦§å±¥æ­´ä¸€è¦§ã‚³ãƒ³ãƒ†ãƒŠ\n */\nexport function ViewedListContainer (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  if (\n    authContext.isLoading ||\n    authContext.isNotLoggedIn ||\n    authContext.userId === undefined ||\n    !authContext.userId\n  ) {\n    return null\n  }\n  const { data: workResp, refetch } = useQuery(viewedWorksQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      offset: 16 * props.page,\n      limit: 16,\n    },\n  })\n\n  const works = workResp?.viewer?.viewedWorks ?? []\n\n  return (\n    <>\n      <BookmarkWorksList works={works} />\n      <div className=\"h-8\" />\n      <div className=\"-translate-x-1/2 fixed bottom-0 left-1/2 z-10 w-full border-border/40 bg-background/95 p-2 backdrop-blur-sm supports-backdrop-filter:bg-background/80\">\n        <ResponsivePagination\n          perPage={16}\n          maxCount={props.maxCount}\n          currentPage={props.page}\n          onPageChange={(page: number) => {\n            props.setPage(page)\n          }}\n        />\n      </div>\n    </>\n  )\n}\n\nconst viewedWorksQuery = graphql(\n  `query ViewerViewedWorks($offset: Int!, $limit: Int!) {\n    viewer {\n      viewedWorks(offset: $offset, limit: $limit) {\n        ...BookmarkWorksListItem\n      }\n    }\n  }`,\n  [BookmarkWorksListItemFragment],\n)\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/viewed-list-container.tsx"},"span":[802,810],"sourceCode":"import { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext } from \"react\"\nimport {\n  BookmarkWorksList,\n  BookmarkWorksListItemFragment,\n} from \"~/routes/($lang).my._index/components/bookmark-works-list\"\nimport { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { useQuery } from \"@apollo/client/index\"\nimport { graphql } from \"gql.tada\"\n\ntype Props = {\n  page: number\n  maxCount: number\n  setPage: (page: number) => void\n}\n\n/**\n * é–²è¦§å±¥æ­´ä¸€è¦§ã‚³ãƒ³ãƒ†ãƒŠ\n */\nexport function ViewedListContainer (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  if (\n    authContext.isLoading ||\n    authContext.isNotLoggedIn ||\n    authContext.userId === undefined ||\n    !authContext.userId\n  ) {\n    return null\n  }\n  const { data: workResp, refetch } = useQuery(viewedWorksQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      offset: 16 * props.page,\n      limit: 16,\n    },\n  })\n\n  const works = workResp?.viewer?.viewedWorks ?? []\n\n  return (\n    <>\n      <BookmarkWorksList works={works} />\n      <div className=\"h-8\" />\n      <div className=\"-translate-x-1/2 fixed bottom-0 left-1/2 z-10 w-full border-border/40 bg-background/95 p-2 backdrop-blur-sm supports-backdrop-filter:bg-background/80\">\n        <ResponsivePagination\n          perPage={16}\n          maxCount={props.maxCount}\n          currentPage={props.page}\n          onPageChange={(page: number) => {\n            props.setPage(page)\n          }}\n        />\n      </div>\n    </>\n  )\n}\n\nconst viewedWorksQuery = graphql(\n  `query ViewerViewedWorks($offset: Int!, $limit: Int!) {\n    viewer {\n      viewedWorks(offset: $offset, limit: $limit) {\n        ...BookmarkWorksListItem\n      }\n    }\n  }`,\n  [BookmarkWorksListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my._index/components/works-list-column.tsx"},"span":[530,586],"sourceCode":"import type { IntrospectionEnum } from \"~/lib/introspection-enum\"\nimport type { SortType } from \"~/types/sort-type\"\nimport { ChevronDown, ChevronUp } from \"lucide-react\"\n\ntype Props = {\n  label: string\n  orderBy: IntrospectionEnum<\"WorkOrderBy\">\n  nowOrderBy: IntrospectionEnum<\"WorkOrderBy\">\n  sort: SortType\n  onClick: () => void\n}\n\n/**\n * ä½œå“ä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ©ãƒ \n */\nexport function WorksListColumn (props: Props) {\n  return (\n    <>\n      {/* biome-ignore lint/a11y/useKeyWithClickEvents: <explanation> */}\n      <div onClick={props.onClick} className=\"cursor-pointer\">\n        <div className=\"flex items-center\">\n          {props.label}\n          {props.orderBy === props.nowOrderBy &&\n            (props.sort === \"ASC\" ? <ChevronUp /> : <ChevronDown />)}\n        </div>\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[1200,1230],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { BookmarkListContainer } from \"~/routes/($lang).my._index/components/bookmark-list-container\"\nimport { useQuery } from \"@apollo/client/index\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { graphql } from \"gql.tada\"\nimport React from \"react\"\nimport { Suspense, useContext } from \"react\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { META } from \"~/config\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.MY_BOOKMARKS, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  return {}\n}\n\nexport const headers: HeadersFunction = () => ({\n  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function MyBookmarks () {\n  const [bookmarkPage, setBookmarkPage] = React.useState(0)\n\n  const authContext = useContext(AuthContext)\n\n  if (!authContext.isLoggedIn) {\n    return <AppLoadingPage />\n  }\n\n  const { data: userResp, refetch } = useQuery(userQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      userId: decodeURIComponent(authContext.userId),\n    },\n  })\n\n  const bookmarkMaxCount = userResp?.user?.createdBookmarksCount\n    ? userResp.user.createdBookmarksCount > 400\n      ? 400\n      : userResp.user.createdBookmarksCount\n    : 0\n\n  return (\n    <>\n      <Suspense fallback={<AppLoadingPage />}>\n        <BookmarkListContainer\n          page={bookmarkPage}\n          maxCount={bookmarkMaxCount}\n          setPage={setBookmarkPage}\n        />\n      </Suspense>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      createdBookmarksCount\n    }\n  }`,\n)\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my.bookmarks/route.tsx"},"span":[1274,1282],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { BookmarkListContainer } from \"~/routes/($lang).my._index/components/bookmark-list-container\"\nimport { useQuery } from \"@apollo/client/index\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { graphql } from \"gql.tada\"\nimport React from \"react\"\nimport { Suspense, useContext } from \"react\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { META } from \"~/config\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.MY_BOOKMARKS, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  return {}\n}\n\nexport const headers: HeadersFunction = () => ({\n  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function MyBookmarks () {\n  const [bookmarkPage, setBookmarkPage] = React.useState(0)\n\n  const authContext = useContext(AuthContext)\n\n  if (!authContext.isLoggedIn) {\n    return <AppLoadingPage />\n  }\n\n  const { data: userResp, refetch } = useQuery(userQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      userId: decodeURIComponent(authContext.userId),\n    },\n  })\n\n  const bookmarkMaxCount = userResp?.user?.createdBookmarksCount\n    ? userResp.user.createdBookmarksCount > 400\n      ? 400\n      : userResp.user.createdBookmarksCount\n    : 0\n\n  return (\n    <>\n      <Suspense fallback={<AppLoadingPage />}>\n        <BookmarkListContainer\n          page={bookmarkPage}\n          maxCount={bookmarkMaxCount}\n          setPage={setBookmarkPage}\n        />\n      </Suspense>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      createdBookmarksCount\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[1178,1208],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useQuery } from \"@apollo/client/index\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { graphql } from \"gql.tada\"\nimport React from \"react\"\nimport { Suspense, useContext } from \"react\"\nimport { LikeListContainer } from \"~/routes/($lang).my._index/components/like-list-container\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.MY_LIKES, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  return {}\n}\n\nexport const headers: HeadersFunction = () => ({\n  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function MyLikes () {\n  const [likedPage, setLikedPage] = React.useState(0)\n\n  const authContext = useContext(AuthContext)\n\n  if (!authContext.isLoggedIn) {\n    return <AppLoadingPage />\n  }\n\n  const { data: userResp, refetch } = useQuery(userQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      userId: decodeURIComponent(authContext.userId),\n    },\n  })\n\n  const likedMaxCount = userResp?.user?.createdLikesCount\n    ? userResp.user.createdLikesCount > 400\n      ? 400\n      : userResp.user.createdLikesCount\n    : 0\n\n  return (\n    <>\n      <Suspense fallback={<AppLoadingPage />}>\n        <LikeListContainer\n          page={likedPage}\n          maxCount={likedMaxCount}\n          setPage={setLikedPage}\n        />\n      </Suspense>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      createdLikesCount\n    }\n  }`,\n)\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my.likes/route.tsx"},"span":[1252,1260],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useQuery } from \"@apollo/client/index\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { graphql } from \"gql.tada\"\nimport React from \"react\"\nimport { Suspense, useContext } from \"react\"\nimport { LikeListContainer } from \"~/routes/($lang).my._index/components/like-list-container\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.MY_LIKES, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  return {}\n}\n\nexport const headers: HeadersFunction = () => ({\n  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function MyLikes () {\n  const [likedPage, setLikedPage] = React.useState(0)\n\n  const authContext = useContext(AuthContext)\n\n  if (!authContext.isLoggedIn) {\n    return <AppLoadingPage />\n  }\n\n  const { data: userResp, refetch } = useQuery(userQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      userId: decodeURIComponent(authContext.userId),\n    },\n  })\n\n  const likedMaxCount = userResp?.user?.createdLikesCount\n    ? userResp.user.createdLikesCount > 400\n      ? 400\n      : userResp.user.createdLikesCount\n    : 0\n\n  return (\n    <>\n      <Suspense fallback={<AppLoadingPage />}>\n        <LikeListContainer\n          page={likedPage}\n          maxCount={likedMaxCount}\n          setPage={setLikedPage}\n        />\n      </Suspense>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      createdLikesCount\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[1195,1225],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useQuery } from \"@apollo/client/index\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { graphql } from \"gql.tada\"\nimport React from \"react\"\nimport { Suspense, useContext } from \"react\"\nimport { ModerationReportsContainer } from \"~/routes/($lang).my._index/components/reported-list-container\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.MY_REPORTS, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  return {}\n}\n\nexport const headers: HeadersFunction = () => ({\n  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function MyViews () {\n  const [ViewedPage, setViewedPage] = React.useState(0)\n\n  const authContext = useContext(AuthContext)\n\n  if (!authContext.isLoggedIn) {\n    return <AppLoadingPage />\n  }\n\n  const { data: userResp, refetch } = useQuery(userQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      userId: decodeURIComponent(authContext.userId),\n    },\n  })\n\n  const ViewedMaxCount = userResp?.user?.createdViewsCount\n    ? userResp.user.createdViewsCount > 400\n      ? 400\n      : userResp.user.createdViewsCount\n    : 0\n\n  return (\n    <>\n      <Suspense fallback={<AppLoadingPage />}>\n        <ModerationReportsContainer\n          page={ViewedPage}\n          maxCount={ViewedMaxCount}\n          setPage={setViewedPage}\n        />\n      </Suspense>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      createdViewsCount\n    }\n  }`,\n)\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my.reports/route.tsx"},"span":[1269,1277],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useQuery } from \"@apollo/client/index\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { graphql } from \"gql.tada\"\nimport React from \"react\"\nimport { Suspense, useContext } from \"react\"\nimport { ModerationReportsContainer } from \"~/routes/($lang).my._index/components/reported-list-container\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.MY_REPORTS, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  return {}\n}\n\nexport const headers: HeadersFunction = () => ({\n  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function MyViews () {\n  const [ViewedPage, setViewedPage] = React.useState(0)\n\n  const authContext = useContext(AuthContext)\n\n  if (!authContext.isLoggedIn) {\n    return <AppLoadingPage />\n  }\n\n  const { data: userResp, refetch } = useQuery(userQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      userId: decodeURIComponent(authContext.userId),\n    },\n  })\n\n  const ViewedMaxCount = userResp?.user?.createdViewsCount\n    ? userResp.user.createdViewsCount > 400\n      ? 400\n      : userResp.user.createdViewsCount\n    : 0\n\n  return (\n    <>\n      <Suspense fallback={<AppLoadingPage />}>\n        <ModerationReportsContainer\n          page={ViewedPage}\n          maxCount={ViewedMaxCount}\n          setPage={setViewedPage}\n        />\n      </Suspense>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      createdViewsCount\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[1184,1214],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useQuery } from \"@apollo/client/index\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { graphql } from \"gql.tada\"\nimport React from \"react\"\nimport { Suspense, useContext } from \"react\"\nimport { ViewedListContainer } from \"~/routes/($lang).my._index/components/viewed-list-container\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.MY_VIEWS, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  return {}\n}\n\nexport const headers: HeadersFunction = () => ({\n  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function MyViews () {\n  const [ViewedPage, setViewedPage] = React.useState(0)\n\n  const authContext = useContext(AuthContext)\n\n  if (!authContext.isLoggedIn) {\n    return <AppLoadingPage />\n  }\n\n  const { data: userResp, refetch } = useQuery(userQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      userId: decodeURIComponent(authContext.userId),\n    },\n  })\n\n  const ViewedMaxCount = userResp?.user?.createdViewsCount\n    ? userResp.user.createdViewsCount > 400\n      ? 400\n      : userResp.user.createdViewsCount\n    : 0\n\n  return (\n    <>\n      <Suspense fallback={<AppLoadingPage />}>\n        <ViewedListContainer\n          page={ViewedPage}\n          maxCount={ViewedMaxCount}\n          setPage={setViewedPage}\n        />\n      </Suspense>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      createdViewsCount\n    }\n  }`,\n)\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my.views/route.tsx"},"span":[1258,1266],"sourceCode":"import { AppLoadingPage } from \"~/components/app/app-loading-page\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useQuery } from \"@apollo/client/index\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { graphql } from \"gql.tada\"\nimport React from \"react\"\nimport { Suspense, useContext } from \"react\"\nimport { ViewedListContainer } from \"~/routes/($lang).my._index/components/viewed-list-container\"\nimport { META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.MY_VIEWS, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  return {}\n}\n\nexport const headers: HeadersFunction = () => ({\n  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¸è¦\n  // \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function MyViews () {\n  const [ViewedPage, setViewedPage] = React.useState(0)\n\n  const authContext = useContext(AuthContext)\n\n  if (!authContext.isLoggedIn) {\n    return <AppLoadingPage />\n  }\n\n  const { data: userResp, refetch } = useQuery(userQuery, {\n    skip: authContext.isLoading,\n    variables: {\n      userId: decodeURIComponent(authContext.userId),\n    },\n  })\n\n  const ViewedMaxCount = userResp?.user?.createdViewsCount\n    ? userResp.user.createdViewsCount > 400\n      ? 400\n      : userResp.user.createdViewsCount\n    : 0\n\n  return (\n    <>\n      <Suspense fallback={<AppLoadingPage />}>\n        <ViewedListContainer\n          page={ViewedPage}\n          maxCount={ViewedMaxCount}\n          setPage={setViewedPage}\n        />\n      </Suspense>\n    </>\n  )\n}\n\nconst userQuery = graphql(\n  `query User(\n    $userId: ID!,\n  ) {\n    user(id: $userId) {\n      id\n      createdViewsCount\n    }\n  }`,\n)\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[1550,1566],"sourceCode":"import { Tabs, TabsList, TabsTrigger } from \"~/components/ui/tabs\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext, useEffect } from \"react\"\nimport { useLocation, useNavigate } from \"@remix-run/react\"\nimport React from \"react\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = Readonly<{\n  outlet: React.ReactNode\n}>\n\n/**\n * ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„\n */\nexport function MyContents (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  const location = useLocation()\n\n  const t = useTranslation()\n\n  const type = (path: string) => {\n    if (path.includes(\"posts\")) {\n      return \"POSTS\"\n    }\n    if (path.includes(\"albums\")) {\n      return \"ALBUMS\"\n    }\n    if (path.includes(\"folders\")) {\n      return \"FOLDERS\"\n    }\n    if (path.includes(\"bookmarks\")) {\n      return \"BOOKMARKS\"\n    }\n    if (path.includes(\"recommended\")) {\n      return \"RECOMMENDED\"\n    }\n    if (path.includes(\"likes\")) {\n      return \"LIKES\"\n    }\n    if (path.includes(\"views\")) {\n      return \"VIEWS\"\n    }\n    if (path.includes(\"reports\")) {\n      return \"REPORTS\"\n    }\n    return \"HOME\"\n  }\n\n  const [myContentType, setMyContentType] = React.useState(\n    type(location.pathname),\n  )\n\n  useEffect(() => {\n    setMyContentType(type(location.pathname))\n  }, [location.pathname])\n\n  if (\n    authContext.isLoading ||\n    authContext.isNotLoggedIn ||\n    authContext.userId === undefined ||\n    !authContext.userId\n  ) {\n    return null\n  }\n\n  const navigate = useNavigate()\n\n  return (\n    <>\n      <div\n        className=\"m-auto flex w-full flex-col space-y-2\"\n        style={{\n          margin: \"0 auto\",\n        }}\n      >\n        <div className=\"hidden md:block\">\n          <Tabs className=\"mt-2\" value={myContentType} defaultValue={\"HOME\"}>\n            <TabsList>\n              <TabsTrigger\n                onClick={() => {\n                  setMyContentType(\"HOME\")\n                  navigate(\"/my\")\n                }}\n                className=\"w-full\"\n                value=\"HOME\"\n              >\n                {t(\"ãƒ›ãƒ¼ãƒ \", \"Home\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => {\n                  setMyContentType(\"POSTS\")\n                  navigate(\"/my/posts\")\n                }}\n                className=\"w-full\"\n                value=\"POSTS\"\n              >\n                {t(\"ä½œå“\", \"Posts\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => {\n                  setMyContentType(\"ALBUMS\")\n                  navigate(\"/my/albums\")\n                }}\n                className=\"w-full\"\n                value=\"ALBUMS\"\n              >\n                {t(\"ã‚·ãƒªãƒ¼ã‚º\", \"Albums\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => {\n                  setMyContentType(\"FOLDERS\")\n                  navigate(\"/my/folders\")\n                }}\n                className=\"w-full\"\n                value=\"FOLDERS\"\n              >\n                {t(\"ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³\", \"Folders\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => {\n                  setMyContentType(\"RECOMMENDED\")\n                  navigate(\"/my/recommended\")\n                }}\n                className=\"w-full\"\n                value=\"RECOMMENDED\"\n              >\n                {t(\"æ¨è–¦\", \"Recommended\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => {\n                  setMyContentType(\"BOOKMARKS\")\n                  navigate(\"/my/bookmarks\")\n                }}\n                className=\"w-full\"\n                value=\"BOOKMARKS\"\n              >\n                {t(\"ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯\", \"Bookmarks\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => {\n                  setMyContentType(\"LIKES\")\n                  navigate(\"/my/likes\")\n                }}\n                className=\"w-full\"\n                value=\"LIKES\"\n              >\n                {t(\"ã„ã„ã­\", \"Likes\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => {\n                  setMyContentType(\"VIEWS\")\n                  navigate(\"/my/views\")\n                }}\n                className=\"w-full\"\n                value=\"VIEWS\"\n              >\n                {t(\"é–²è¦§å±¥æ­´\", \"Views\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => {\n                  setMyContentType(\"REPORTS\")\n                  navigate(\"/my/reports\")\n                }}\n                className=\"w-full\"\n                value=\"REPORTS\"\n              >\n                {t(\"é‹å–¶ã‹ã‚‰ã®ãŠçŸ¥ã‚‰ã›\", \"Reports\")}\n              </TabsTrigger>\n            </TabsList>\n          </Tabs>\n        </div>\n        <div className=\"block md:hidden\">\n          <div className=\"grid grid-cols-3 gap-2\">\n            <Button\n              onClick={() => {\n                setMyContentType(\"HOME\")\n                navigate(\"/my\")\n              }}\n              value=\"HOME\"\n              variant={\"secondary\"}\n              className={cn(\n                myContentType === \"HOME\" && \"bg-gray-200 dark:bg-zinc-900\",\n              )}\n            >\n              {t(\"ãƒ›ãƒ¼ãƒ \", \"Home\")}\n            </Button>\n            <Button\n              onClick={() => {\n                setMyContentType(\"POSTS\")\n                navigate(\"/my/posts\")\n              }}\n              value=\"POSTS\"\n              variant={\"secondary\"}\n              className={cn(\n                myContentType === \"POSTS\" && \"bg-gray-200 dark:bg-zinc-900\",\n              )}\n            >\n              {t(\"ä½œå“\", \"Posts\")}\n            </Button>\n            <Button\n              onClick={() => {\n                setMyContentType(\"ALBUMS\")\n                navigate(\"/my/albums\")\n              }}\n              value=\"ALBUMS\"\n              variant={\"secondary\"}\n              className={cn(\n                myContentType === \"ALBUMS\" && \"bg-gray-200 dark:bg-zinc-900\",\n              )}\n            >\n              {t(\"ã‚·ãƒªãƒ¼ã‚º\", \"Albums\")}\n            </Button>\n            <Button\n              onClick={() => {\n                setMyContentType(\"FOLDERS\")\n                navigate(\"/my/folders\")\n              }}\n              value=\"FOLDERS\"\n              variant={\"secondary\"}\n              className={cn(\n                myContentType === \"FOLDERS\" && \"bg-gray-200 dark:bg-zinc-900\",\n              )}\n            >\n              {t(\"ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³\", \"Folders\")}\n            </Button>\n            <Button\n              onClick={() => {\n                setMyContentType(\"RECOMMENDED\")\n                navigate(\"/my/recommended\")\n              }}\n              value=\"RECOMMENDED\"\n              variant={\"secondary\"}\n              className={cn(\n                myContentType === \"RECOMMENDED\" &&\n                  \"bg-gray-200 dark:bg-zinc-900\",\n              )}\n            >\n              {t(\"æ¨è–¦\", \"Recommended\")}\n            </Button>\n            <Button\n              onClick={() => {\n                setMyContentType(\"BOOKMARKS\")\n                navigate(\"/my/bookmarks\")\n              }}\n              value=\"BOOKMARKS\"\n              variant={\"secondary\"}\n              className={cn(\n                myContentType === \"BOOKMARKS\" && \"bg-gray-200 dark:bg-zinc-900\",\n              )}\n            >\n              {t(\"ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯\", \"Bookmarks\")}\n            </Button>\n            <Button\n              onClick={() => {\n                setMyContentType(\"LIKES\")\n                navigate(\"/my/likes\")\n              }}\n              value=\"LIKES\"\n              variant={\"secondary\"}\n              className={cn(\n                myContentType === \"LIKES\" && \"bg-gray-200 dark:bg-zinc-900\",\n              )}\n            >\n              {t(\"ã„ã„ã­\", \"Likes\")}\n            </Button>\n            <Button\n              onClick={() => {\n                setMyContentType(\"VIEWS\")\n                navigate(\"/my/views\")\n              }}\n              value=\"VIEWS\"\n              variant={\"secondary\"}\n              className={cn(\n                myContentType === \"VIEWS\" && \"bg-gray-200 dark:bg-zinc-900\",\n              )}\n            >\n              {t(\"é–²è¦§å±¥æ­´\", \"Views\")}\n            </Button>\n            <Button\n              onClick={() => {\n                setMyContentType(\"REPORTS\")\n                navigate(\"/my/reports\")\n              }}\n              value=\"REPORTS\"\n              variant={\"secondary\"}\n              className={cn(\n                myContentType === \"REPORTS\" && \"bg-gray-200 dark:bg-zinc-900\",\n              )}\n            >\n              {t(\"é‹å–¶ãŠçŸ¥ã‚‰ã›\", \"Reports\")}\n            </Button>\n          </div>\n        </div>\n\n        {props.outlet}\n      </div>\n    </>\n  )\n}\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).my/components/my-contents.tsx"},"span":[1591,1602],"sourceCode":"import { Tabs, TabsList, TabsTrigger } from \"~/components/ui/tabs\"\nimport { AuthContext } from \"~/contexts/auth-context\"\nimport { useContext, useEffect } from \"react\"\nimport { useLocation, useNavigate } from \"@remix-run/react\"\nimport React from \"react\"\nimport { Button } from \"~/components/ui/button\"\nimport { cn } from \"~/lib/utils\"\nimport { useTranslation } from \"~/hooks/use-translation\"\n\ntype Props = Readonly<{\n  outlet: React.ReactNode\n}>\n\n/**\n * ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„\n */\nexport function MyContents (props: Props) {\n  const authContext = useContext(AuthContext)\n\n  const location = useLocation()\n\n  const t = useTranslation()\n\n  const type = (path: string) => {\n    if (path.includes(\"posts\")) {\n      return \"POSTS\"\n    }\n    if (path.includes(\"albums\")) {\n      return \"ALBUMS\"\n    }\n    if (path.includes(\"folders\")) {\n      return \"FOLDERS\"\n    }\n    if (path.includes(\"bookmarks\")) {\n      return \"BOOKMARKS\"\n    }\n    if (path.includes(\"recommended\")) {\n      return \"RECOMMENDED\"\n    }\n    if (path.includes(\"likes\")) {\n      return \"LIKES\"\n    }\n    if (path.includes(\"views\")) {\n      return \"VIEWS\"\n    }\n    if (path.includes(\"reports\")) {\n      return \"REPORTS\"\n    }\n    return \"HOME\"\n  }\n\n  const [myContentType, setMyContentType] = React.useState(\n    type(location.pathname),\n  )\n\n  useEffect(() => {\n    setMyContentType(type(location.pathname))\n  }, [location.pathname])\n\n  if (\n    authContext.isLoading ||\n    authContext.isNotLoggedIn ||\n    authContext.userId === undefined ||\n    !authContext.userId\n  ) {\n    return null\n  }\n\n  const navigate = useNavigate()\n\n  return (\n    <>\n      <div\n        className=\"m-auto flex w-full flex-col space-y-2\"\n        style={{\n          margin: \"0 auto\",\n        }}\n      >\n        <div className=\"hidden md:block\">\n          <Tabs className=\"mt-2\" value={myContentType} defaultValue={\"HOME\"}>\n            <TabsList>\n              <TabsTrigger\n                onClick={() => {\n                  setMyContentType(\"HOME\")\n                  navigate(\"/my\")\n                }}\n                className=\"w-full\"\n                value=\"HOME\"\n              >\n                {t(\"ãƒ›ãƒ¼ãƒ \", \"Home\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => {\n                  setMyContentType(\"POSTS\")\n                  navigate(\"/my/posts\")\n                }}\n                className=\"w-full\"\n                value=\"POSTS\"\n              >\n                {t(\"ä½œå“\", \"Posts\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => {\n                  setMyContentType(\"ALBUMS\")\n                  navigate(\"/my/albums\")\n                }}\n                className=\"w-full\"\n                value=\"ALBUMS\"\n              >\n                {t(\"ã‚·ãƒªãƒ¼ã‚º\", \"Albums\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => {\n                  setMyContentType(\"FOLDERS\")\n                  navigate(\"/my/folders\")\n                }}\n                className=\"w-full\"\n                value=\"FOLDERS\"\n              >\n                {t(\"ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³\", \"Folders\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => {\n                  setMyContentType(\"RECOMMENDED\")\n                  navigate(\"/my/recommended\")\n                }}\n                className=\"w-full\"\n                value=\"RECOMMENDED\"\n              >\n                {t(\"æ¨è–¦\", \"Recommended\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => {\n                  setMyContentType(\"BOOKMARKS\")\n                  navigate(\"/my/bookmarks\")\n                }}\n                className=\"w-full\"\n                value=\"BOOKMARKS\"\n              >\n                {t(\"ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯\", \"Bookmarks\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => {\n                  setMyContentType(\"LIKES\")\n                  navigate(\"/my/likes\")\n                }}\n                className=\"w-full\"\n                value=\"LIKES\"\n              >\n                {t(\"ã„ã„ã­\", \"Likes\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => {\n                  setMyContentType(\"VIEWS\")\n                  navigate(\"/my/views\")\n                }}\n                className=\"w-full\"\n                value=\"VIEWS\"\n              >\n                {t(\"é–²è¦§å±¥æ­´\", \"Views\")}\n              </TabsTrigger>\n              <TabsTrigger\n                onClick={() => {\n                  setMyContentType(\"REPORTS\")\n                  navigate(\"/my/reports\")\n                }}\n                className=\"w-full\"\n                value=\"REPORTS\"\n              >\n                {t(\"é‹å–¶ã‹ã‚‰ã®ãŠçŸ¥ã‚‰ã›\", \"Reports\")}\n              </TabsTrigger>\n            </TabsList>\n          </Tabs>\n        </div>\n        <div className=\"block md:hidden\">\n          <div className=\"grid grid-cols-3 gap-2\">\n            <Button\n              onClick={() => {\n                setMyContentType(\"HOME\")\n                navigate(\"/my\")\n              }}\n              value=\"HOME\"\n              variant={\"secondary\"}\n              className={cn(\n                myContentType === \"HOME\" && \"bg-gray-200 dark:bg-zinc-900\",\n              )}\n            >\n              {t(\"ãƒ›ãƒ¼ãƒ \", \"Home\")}\n            </Button>\n            <Button\n              onClick={() => {\n                setMyContentType(\"POSTS\")\n                navigate(\"/my/posts\")\n              }}\n              value=\"POSTS\"\n              variant={\"secondary\"}\n              className={cn(\n                myContentType === \"POSTS\" && \"bg-gray-200 dark:bg-zinc-900\",\n              )}\n            >\n              {t(\"ä½œå“\", \"Posts\")}\n            </Button>\n            <Button\n              onClick={() => {\n                setMyContentType(\"ALBUMS\")\n                navigate(\"/my/albums\")\n              }}\n              value=\"ALBUMS\"\n              variant={\"secondary\"}\n              className={cn(\n                myContentType === \"ALBUMS\" && \"bg-gray-200 dark:bg-zinc-900\",\n              )}\n            >\n              {t(\"ã‚·ãƒªãƒ¼ã‚º\", \"Albums\")}\n            </Button>\n            <Button\n              onClick={() => {\n                setMyContentType(\"FOLDERS\")\n                navigate(\"/my/folders\")\n              }}\n              value=\"FOLDERS\"\n              variant={\"secondary\"}\n              className={cn(\n                myContentType === \"FOLDERS\" && \"bg-gray-200 dark:bg-zinc-900\",\n              )}\n            >\n              {t(\"ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³\", \"Folders\")}\n            </Button>\n            <Button\n              onClick={() => {\n                setMyContentType(\"RECOMMENDED\")\n                navigate(\"/my/recommended\")\n              }}\n              value=\"RECOMMENDED\"\n              variant={\"secondary\"}\n              className={cn(\n                myContentType === \"RECOMMENDED\" &&\n                  \"bg-gray-200 dark:bg-zinc-900\",\n              )}\n            >\n              {t(\"æ¨è–¦\", \"Recommended\")}\n            </Button>\n            <Button\n              onClick={() => {\n                setMyContentType(\"BOOKMARKS\")\n                navigate(\"/my/bookmarks\")\n              }}\n              value=\"BOOKMARKS\"\n              variant={\"secondary\"}\n              className={cn(\n                myContentType === \"BOOKMARKS\" && \"bg-gray-200 dark:bg-zinc-900\",\n              )}\n            >\n              {t(\"ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯\", \"Bookmarks\")}\n            </Button>\n            <Button\n              onClick={() => {\n                setMyContentType(\"LIKES\")\n                navigate(\"/my/likes\")\n              }}\n              value=\"LIKES\"\n              variant={\"secondary\"}\n              className={cn(\n                myContentType === \"LIKES\" && \"bg-gray-200 dark:bg-zinc-900\",\n              )}\n            >\n              {t(\"ã„ã„ã­\", \"Likes\")}\n            </Button>\n            <Button\n              onClick={() => {\n                setMyContentType(\"VIEWS\")\n                navigate(\"/my/views\")\n              }}\n              value=\"VIEWS\"\n              variant={\"secondary\"}\n              className={cn(\n                myContentType === \"VIEWS\" && \"bg-gray-200 dark:bg-zinc-900\",\n              )}\n            >\n              {t(\"é–²è¦§å±¥æ­´\", \"Views\")}\n            </Button>\n            <Button\n              onClick={() => {\n                setMyContentType(\"REPORTS\")\n                navigate(\"/my/reports\")\n              }}\n              value=\"REPORTS\"\n              variant={\"secondary\"}\n              className={cn(\n                myContentType === \"REPORTS\" && \"bg-gray-200 dark:bg-zinc-900\",\n              )}\n            >\n              {t(\"é‹å–¶ãŠçŸ¥ã‚‰ã›\", \"Reports\")}\n            </Button>\n          </div>\n        </div>\n\n        {props.outlet}\n      </div>\n    </>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/correctness/useHookAtTopLevel","severity":"error","description":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render.","message":[{"elements":[],"content":"This hook is being called conditionally, but all hooks must be called in the exact same order in every component render."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"Hooks should not be called after an early return."}]]},{"frame":{"path":null,"span":[1908,1924],"sourceCode":"import { loaderClient } from \"~/lib/loader-client\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { useParams } from \"@remix-run/react\"\nimport { useLoaderData } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { RankingSensitiveHeader } from \"~/routes/($lang)._main.rankings._index/components/ranking-sensitive-header\"\nimport {\n  RankingSensitiveWorkList,\n  SensitiveWorkAwardListItemFragment,\n} from \"~/routes/($lang)._main.rankings._index/components/ranking-sensitive-work-list\"\nimport { config, META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\n\nexport async function loader(props: LoaderFunctionArgs) {\n  if (props.params.year === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  if (props.params.month === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const year = Number.parseInt(props.params.year)\n\n  const month = Number.parseInt(props.params.month)\n\n  const workAwardsResp = await loaderClient.query({\n    query: workAwardsQuery,\n    variables: {\n      offset: 0,\n      limit: 200,\n      where: {\n        year: year,\n        month: month,\n        isSensitive: true,\n      },\n    },\n  })\n\n  return {\n    year,\n    month,\n    workAwards: workAwardsResp,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneDay,\n})\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(\n    META.SENSITIVE_RANKINGS_MONTHLY,\n    undefined,\n    props.params.lang,\n  )\n}\n\n/**\n * ã‚ã‚‹æœˆã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã®å±¥æ­´\n */\nexport default function SensitiveMonthAward () {\n  const params = useParams()\n\n  if (params.year === undefined) {\n    return null\n  }\n\n  if (params.month === undefined) {\n    return null\n  }\n\n  const data = useLoaderData<typeof loader>()\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <>\n      <RankingSensitiveHeader\n        year={data.year}\n        month={data.month}\n        day={null}\n        weekIndex={null}\n      />\n      <RankingSensitiveWorkList\n        year={data.year}\n        month={data.month}\n        day={null}\n        weekIndex={null}\n        awards={data.workAwards.data.workAwards}\n      />\n    </>\n  )\n}\n\nconst workAwardsQuery = graphql(\n  `query WorkAwards($offset: Int!, $limit: Int!, $where: WorkAwardsWhereInput!) {\n    workAwards(offset: $offset, limit: $limit, where: $where) {\n      ...SensitiveWorkAwardListItem\n    }\n  }`,\n  [SensitiveWorkAwardListItemFragment],\n)\n"}},{"log":["info",[{"elements":[],"content":"For React to preserve state between calls, hooks needs to be called unconditionally and always in the same order."}]]},{"log":["info",[{"elements":[],"content":"See https://reactjs.org/docs/hooks-rules.html#only-call-hooks-at-the-top-level"}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).r.rankings.$year.$month._index/route.tsx"},"span":[1945,1958],"sourceCode":"import { loaderClient } from \"~/lib/loader-client\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { useParams } from \"@remix-run/react\"\nimport { useLoaderData } from \"@remix-run/react\"\nimport { graphql } from \"gql.tada\"\nimport { RankingSensitiveHeader } from \"~/routes/($lang)._main.rankings._index/components/ranking-sensitive-header\"\nimport {\n  RankingSensitiveWorkList,\n  SensitiveWorkAwardListItemFragment,\n} from \"~/routes/($lang)._main.rankings._index/components/ranking-sensitive-work-list\"\nimport { config, META } from \"~/config\"\nimport { createMeta } from \"~/utils/create-meta\"\n\nexport async function loader(props: LoaderFunctionArgs) {\n  if (props.params.year === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  if (props.params.month === undefined) {\n    throw new Response(null, { status: 404 })\n  }\n\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  const year = Number.parseInt(props.params.year)\n\n  const month = Number.parseInt(props.params.month)\n\n  const workAwardsResp = await loaderClient.query({\n    query: workAwardsQuery,\n    variables: {\n      offset: 0,\n      limit: 200,\n      where: {\n        year: year,\n        month: month,\n        isSensitive: true,\n      },\n    },\n  })\n\n  return {\n    year,\n    month,\n    workAwards: workAwardsResp,\n  }\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneDay,\n})\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(\n    META.SENSITIVE_RANKINGS_MONTHLY,\n    undefined,\n    props.params.lang,\n  )\n}\n\n/**\n * ã‚ã‚‹æœˆã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã®å±¥æ­´\n */\nexport default function SensitiveMonthAward () {\n  const params = useParams()\n\n  if (params.year === undefined) {\n    return null\n  }\n\n  if (params.month === undefined) {\n    return null\n  }\n\n  const data = useLoaderData<typeof loader>()\n\n  if (data === null) {\n    return null\n  }\n\n  return (\n    <>\n      <RankingSensitiveHeader\n        year={data.year}\n        month={data.month}\n        day={null}\n        weekIndex={null}\n      />\n      <RankingSensitiveWorkList\n        year={data.year}\n        month={data.month}\n        day={null}\n        weekIndex={null}\n        awards={data.workAwards.data.workAwards}\n      />\n    </>\n  )\n}\n\nconst workAwardsQuery = graphql(\n  `query WorkAwards($offset: Int!, $limit: Int!, $where: WorkAwardsWhereInput!) {\n    workAwards(offset: $offset, limit: $limit, where: $where) {\n      ...SensitiveWorkAwardListItem\n    }\n  }`,\n  [SensitiveWorkAwardListItemFragment],\n)\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.color/route.tsx"},"span":[2322,2777],"sourceCode":"import { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { Tabs, TabsList, TabsTrigger } from \"~/components/ui/tabs\"\nimport { useTheme } from \"next-themes\"\nimport { useState } from \"react\"\nimport { SettingsHeader } from \"~/routes/($lang).settings/components/settings-header\"\nimport { Separator } from \"~/components/ui/separator\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { config, META } from \"~/config\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { cn } from \"~/lib/utils\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.SETTINGS_COLOR, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  return {}\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function SettingColor () {\n  const t = useTranslation()\n  const [activeTab, setActiveTab] = useState<string>(\"sampleTab1\")\n  const [activePage, setActivePage] = useState<number>(1)\n  const { theme, setTheme } = useTheme()\n\n  const handleTabClick = (value: string) => setActiveTab(value)\n\n  const setColorTheme = (mode: string, color: string) => {\n    setTheme(\n      mode === \"system\"\n        ? \"system\"\n        : color === \"none\"\n          ? mode\n          : `${mode}-${color}`,\n    )\n  }\n\n  const getMode = (theme: string): string => {\n    if ([\"system\", \"light\", \"dark\"].includes(theme)) return theme\n    return theme.startsWith(\"light-\")\n      ? \"light\"\n      : theme.startsWith(\"dark-\")\n        ? \"dark\"\n        : \"system\"\n  }\n\n  const getColorSchema = (theme: string): string => {\n    if ([\"system\", \"light\", \"dark\"].includes(theme)) return \"none\"\n    return theme.replace(/(light|dark)-/, \"\") ?? \"none\"\n  }\n\n  const mode = getMode(theme ?? \"system\")\n  const colorSchema = getColorSchema(theme ?? \"system\")\n\n  const themeRadio = (value: string, label: string) => (\n    <div\n      className={cn(\n        \"flex w-full cursor-pointer items-center space-x-2 rounded-lg border p-2 transition duration-150 hover:bg-gray-100 dark:hover:bg-gray-800\",\n        { \"bg-gray-100 bg-opacity-50 dark:bg-gray-800\": mode === value },\n      )}\n      onClick={() => setColorTheme(value, colorSchema)}\n      onKeyUp={(e) => {\n        if (e.key === \"Enter\" || e.key === \" \") {\n          setColorTheme(value, colorSchema)\n        }\n      }}\n    >\n      <RadioGroupItem value={value} id={value} className=\"peer hidden\" />\n      <label\n        htmlFor={value}\n        className=\"flex cursor-pointer items-center peer-checked:text-blue-500\"\n      >\n        <span className=\"flex size-4 items-center justify-center rounded-full border border-gray-300 transition duration-150 peer-checked:border-blue-500 peer-checked:bg-blue-500\" />\n        <span className=\"ml-2\">{t(label, label)}</span>\n      </label>\n    </div>\n  )\n\n  const themeRadioColor = (\n    value: string,\n    label: string,\n    colorValue: string,\n  ) => (\n    // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n    <div\n      className={cn(\n        \"flex w-full cursor-pointer items-center space-x-2 rounded-lg border p-2 transition duration-150 hover:bg-gray-100 dark:hover:bg-gray-800\",\n        { \"bg-gray-100 bg-opacity-50 dark:bg-gray-800\": colorSchema === value },\n      )}\n      onClick={() => setColorTheme(mode, value)}\n    >\n      <RadioGroupItem value={value} id={value} className=\"peer hidden\" />\n      <label\n        htmlFor={value}\n        className=\"flex cursor-pointer items-center peer-checked:text-blue-500\"\n      >\n        <span\n          className={cn(\n            \"flex size-4 items-center justify-center rounded-full transition duration-150 peer-checked:ring-2 peer-checked:ring-blue-500\",\n            colorValue,\n          )}\n        />\n        <span className=\"ml-2\">{t(label, label)}</span>\n      </label>\n    </div>\n  )\n\n  return (\n    <div className=\"flex flex-col space-y-2\">\n      <div className=\"block md:hidden\">\n        <SettingsHeader title={t(\"ã‚«ãƒ©ãƒ¼ãƒ†ãƒ¼ãƒ\", \"Color Theme\")} />\n      </div>\n      <RadioGroup\n        value={mode}\n        name=\"mode\"\n        onValueChange={(value) => setColorTheme(value, colorSchema)}\n        className=\"space-y-2\"\n      >\n        <div className=\"space-y-2\">\n          {themeRadio(\n            \"system\",\n            t(\"ãƒ‡ãƒã‚¤ã‚¹ã®ãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹\", \"Use device mode\"),\n          )}\n          {themeRadio(\"light\", t(\"ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰\", \"Light mode\"))}\n          {themeRadio(\"dark\", t(\"ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰\", \"Dark mode\"))}\n        </div>\n        <p className=\"text-sm\">\n          {t(\n            \"ãƒ©ã‚¤ãƒˆã‹ãƒ€ãƒ¼ã‚¯ã‚’é¸æŠã™ã‚‹ã¨è‰²ã‚‚é¸ã¹ã¾ã™ã€‚\",\n            \"You can select colors if you choose Light or Dark mode.\",\n          )}\n        </p>\n        <Separator />\n      </RadioGroup>\n      <div className={cn(\"space-y-2\", { \"opacity-20\": theme === \"system\" })}>\n        <RadioGroup\n          value={colorSchema}\n          name=\"colorSchema\"\n          onValueChange={(value) => setColorTheme(mode, value)}\n          className=\"space-y-2\"\n        >\n          <div className=\"grid grid-cols-2 gap-2 md:grid-cols-3\">\n            {themeRadioColor(\"none\", t(\"ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ\", \"Default\"), \"bg-gray-100\")}\n            {themeRadioColor(\"gray\", t(\"ã‚°ãƒ¬ãƒ¼\", \"Gray\"), \"bg-gray-500\")}\n            {themeRadioColor(\"red\", t(\"ãƒ¬ãƒƒãƒ‰\", \"Red\"), \"bg-red-500\")}\n            {themeRadioColor(\"pink\", t(\"ãƒ”ãƒ³ã‚¯\", \"Pink\"), \"bg-pink-500\")}\n            {themeRadioColor(\n              \"orange\",\n              t(\"ã‚ªãƒ¬ãƒ³ã‚¸\", \"Orange\"),\n              \"bg-orange-500\",\n            )}\n            {themeRadioColor(\"green\", t(\"ã‚°ãƒªãƒ¼ãƒ³\", \"Green\"), \"bg-green-500\")}\n            {themeRadioColor(\"blue\", t(\"ãƒ–ãƒ«ãƒ¼\", \"Blue\"), \"bg-blue-500\")}\n            {themeRadioColor(\n              \"yellow\",\n              t(\"ã‚¤ã‚¨ãƒ­ãƒ¼\", \"Yellow\"),\n              \"bg-yellow-500\",\n            )}\n            {themeRadioColor(\n              \"violet\",\n              t(\"ãƒã‚¤ã‚ªãƒ¬ãƒƒãƒˆ\", \"Violet\"),\n              \"bg-violet-500\",\n            )}\n          </div>\n        </RadioGroup>\n        <div className=\"mt-4 flex flex-wrap gap-2\">\n          <Button variant=\"default\">{t(\"ãƒœã‚¿ãƒ³\", \"Button\")}</Button>\n          <Button variant=\"destructive\">\n            {t(\"destructive\", \"Destructive\")}\n          </Button>\n          <Button variant=\"outline\">{t(\"outline\", \"Outline\")}</Button>\n          <Button variant=\"secondary\">{t(\"secondary\", \"Secondary\")}</Button>\n          <Button variant=\"ghost\">{t(\"ghost\", \"Ghost\")}</Button>\n          <Button variant=\"link\">{t(\"link\", \"Link\")}</Button>\n        </div>\n        <div className=\"mt-4 space-y-2\">\n          <Input\n            className=\"mx-2 w-80\"\n            id=\"sampleText1\"\n            placeholder={t(\"ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼\", \"Placeholder\")}\n            onChange={(_e) => {}}\n          />\n          <Input\n            className=\"mx-2 w-80\"\n            id=\"sampleText2\"\n            placeholder=\"\"\n            value={t(\"å…¥åŠ›æ¸ˆã¿\", \"Filled\")}\n            onChange={(_e) => {}}\n          />\n        </div>\n        <Tabs>\n          <div className=\"border-b\">\n            <TabsList className=\"flex space-x-2\">\n              <TabsTrigger\n                value=\"sampleTab1\"\n                onClick={() => handleTabClick(\"sampleTab1\")}\n                className={activeTab === \"sampleTab1\" ? \"active-tab\" : \"\"}\n              >\n                {t(\"ã‚¿ãƒ–1\", \"Tab 1\")}\n              </TabsTrigger>\n              <TabsTrigger\n                value=\"sampleTab2\"\n                onClick={() => handleTabClick(\"sampleTab2\")}\n                className={activeTab === \"sampleTab2\" ? \"active-tab\" : \"\"}\n              >\n                {t(\"ã‚¿ãƒ–2\", \"Tab 2\")}\n              </TabsTrigger>\n              <TabsTrigger\n                value=\"sampleTab3\"\n                onClick={() => handleTabClick(\"sampleTab3\")}\n                className={activeTab === \"sampleTab3\" ? \"active-tab\" : \"\"}\n              >\n                {t(\"ã‚¿ãƒ–3\", \"Tab 3\")}\n              </TabsTrigger>\n            </TabsList>\n          </div>\n        </Tabs>\n        <ResponsivePagination\n          perPage={32}\n          maxCount={200}\n          currentPage={activePage}\n          onPageChange={(page: number) => setActivePage(page)}\n        />\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/a11y/noStaticElementInteractions","severity":"error","description":"Static Elements should not be interactive.","message":[{"elements":[],"content":"Static Elements should not be interactive."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"To add interactivity such as a mouse or key event listener to a static element, give the element an appropriate role value."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/routes/($lang).settings.color/route.tsx"},"span":[3417,3735],"sourceCode":"import { ResponsivePagination } from \"~/components/responsive-pagination\"\nimport { Button } from \"~/components/ui/button\"\nimport { Input } from \"~/components/ui/input\"\nimport { RadioGroup, RadioGroupItem } from \"~/components/ui/radio-group\"\nimport { Tabs, TabsList, TabsTrigger } from \"~/components/ui/tabs\"\nimport { useTheme } from \"next-themes\"\nimport { useState } from \"react\"\nimport { SettingsHeader } from \"~/routes/($lang).settings/components/settings-header\"\nimport { Separator } from \"~/components/ui/separator\"\nimport type {\n  HeadersFunction,\n  LoaderFunctionArgs,\n  MetaFunction,\n} from \"@remix-run/cloudflare\"\nimport { createMeta } from \"~/utils/create-meta\"\nimport { config, META } from \"~/config\"\nimport { useTranslation } from \"~/hooks/use-translation\"\nimport { cn } from \"~/lib/utils\"\n\nexport const meta: MetaFunction = (props) => {\n  return createMeta(META.SETTINGS_COLOR, undefined, props.params.lang)\n}\n\nexport async function loader(_props: LoaderFunctionArgs) {\n  // const redirectResponse = checkLocaleRedirect(props.request)\n\n  // if (redirectResponse) {\n  //   return redirectResponse\n  // }\n\n  return {}\n}\n\nexport const headers: HeadersFunction = () => ({\n  \"Cache-Control\": config.cacheControl.oneHour,\n})\n\nexport default function SettingColor () {\n  const t = useTranslation()\n  const [activeTab, setActiveTab] = useState<string>(\"sampleTab1\")\n  const [activePage, setActivePage] = useState<number>(1)\n  const { theme, setTheme } = useTheme()\n\n  const handleTabClick = (value: string) => setActiveTab(value)\n\n  const setColorTheme = (mode: string, color: string) => {\n    setTheme(\n      mode === \"system\"\n        ? \"system\"\n        : color === \"none\"\n          ? mode\n          : `${mode}-${color}`,\n    )\n  }\n\n  const getMode = (theme: string): string => {\n    if ([\"system\", \"light\", \"dark\"].includes(theme)) return theme\n    return theme.startsWith(\"light-\")\n      ? \"light\"\n      : theme.startsWith(\"dark-\")\n        ? \"dark\"\n        : \"system\"\n  }\n\n  const getColorSchema = (theme: string): string => {\n    if ([\"system\", \"light\", \"dark\"].includes(theme)) return \"none\"\n    return theme.replace(/(light|dark)-/, \"\") ?? \"none\"\n  }\n\n  const mode = getMode(theme ?? \"system\")\n  const colorSchema = getColorSchema(theme ?? \"system\")\n\n  const themeRadio = (value: string, label: string) => (\n    <div\n      className={cn(\n        \"flex w-full cursor-pointer items-center space-x-2 rounded-lg border p-2 transition duration-150 hover:bg-gray-100 dark:hover:bg-gray-800\",\n        { \"bg-gray-100 bg-opacity-50 dark:bg-gray-800\": mode === value },\n      )}\n      onClick={() => setColorTheme(value, colorSchema)}\n      onKeyUp={(e) => {\n        if (e.key === \"Enter\" || e.key === \" \") {\n          setColorTheme(value, colorSchema)\n        }\n      }}\n    >\n      <RadioGroupItem value={value} id={value} className=\"peer hidden\" />\n      <label\n        htmlFor={value}\n        className=\"flex cursor-pointer items-center peer-checked:text-blue-500\"\n      >\n        <span className=\"flex size-4 items-center justify-center rounded-full border border-gray-300 transition duration-150 peer-checked:border-blue-500 peer-checked:bg-blue-500\" />\n        <span className=\"ml-2\">{t(label, label)}</span>\n      </label>\n    </div>\n  )\n\n  const themeRadioColor = (\n    value: string,\n    label: string,\n    colorValue: string,\n  ) => (\n    // biome-ignore lint/a11y/useKeyWithClickEvents: <explanation>\n    <div\n      className={cn(\n        \"flex w-full cursor-pointer items-center space-x-2 rounded-lg border p-2 transition duration-150 hover:bg-gray-100 dark:hover:bg-gray-800\",\n        { \"bg-gray-100 bg-opacity-50 dark:bg-gray-800\": colorSchema === value },\n      )}\n      onClick={() => setColorTheme(mode, value)}\n    >\n      <RadioGroupItem value={value} id={value} className=\"peer hidden\" />\n      <label\n        htmlFor={value}\n        className=\"flex cursor-pointer items-center peer-checked:text-blue-500\"\n      >\n        <span\n          className={cn(\n            \"flex size-4 items-center justify-center rounded-full transition duration-150 peer-checked:ring-2 peer-checked:ring-blue-500\",\n            colorValue,\n          )}\n        />\n        <span className=\"ml-2\">{t(label, label)}</span>\n      </label>\n    </div>\n  )\n\n  return (\n    <div className=\"flex flex-col space-y-2\">\n      <div className=\"block md:hidden\">\n        <SettingsHeader title={t(\"ã‚«ãƒ©ãƒ¼ãƒ†ãƒ¼ãƒ\", \"Color Theme\")} />\n      </div>\n      <RadioGroup\n        value={mode}\n        name=\"mode\"\n        onValueChange={(value) => setColorTheme(value, colorSchema)}\n        className=\"space-y-2\"\n      >\n        <div className=\"space-y-2\">\n          {themeRadio(\n            \"system\",\n            t(\"ãƒ‡ãƒã‚¤ã‚¹ã®ãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹\", \"Use device mode\"),\n          )}\n          {themeRadio(\"light\", t(\"ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰\", \"Light mode\"))}\n          {themeRadio(\"dark\", t(\"ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰\", \"Dark mode\"))}\n        </div>\n        <p className=\"text-sm\">\n          {t(\n            \"ãƒ©ã‚¤ãƒˆã‹ãƒ€ãƒ¼ã‚¯ã‚’é¸æŠã™ã‚‹ã¨è‰²ã‚‚é¸ã¹ã¾ã™ã€‚\",\n            \"You can select colors if you choose Light or Dark mode.\",\n          )}\n        </p>\n        <Separator />\n      </RadioGroup>\n      <div className={cn(\"space-y-2\", { \"opacity-20\": theme === \"system\" })}>\n        <RadioGroup\n          value={colorSchema}\n          name=\"colorSchema\"\n          onValueChange={(value) => setColorTheme(mode, value)}\n          className=\"space-y-2\"\n        >\n          <div className=\"grid grid-cols-2 gap-2 md:grid-cols-3\">\n            {themeRadioColor(\"none\", t(\"ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ\", \"Default\"), \"bg-gray-100\")}\n            {themeRadioColor(\"gray\", t(\"ã‚°ãƒ¬ãƒ¼\", \"Gray\"), \"bg-gray-500\")}\n            {themeRadioColor(\"red\", t(\"ãƒ¬ãƒƒãƒ‰\", \"Red\"), \"bg-red-500\")}\n            {themeRadioColor(\"pink\", t(\"ãƒ”ãƒ³ã‚¯\", \"Pink\"), \"bg-pink-500\")}\n            {themeRadioColor(\n              \"orange\",\n              t(\"ã‚ªãƒ¬ãƒ³ã‚¸\", \"Orange\"),\n              \"bg-orange-500\",\n            )}\n            {themeRadioColor(\"green\", t(\"ã‚°ãƒªãƒ¼ãƒ³\", \"Green\"), \"bg-green-500\")}\n            {themeRadioColor(\"blue\", t(\"ãƒ–ãƒ«ãƒ¼\", \"Blue\"), \"bg-blue-500\")}\n            {themeRadioColor(\n              \"yellow\",\n              t(\"ã‚¤ã‚¨ãƒ­ãƒ¼\", \"Yellow\"),\n              \"bg-yellow-500\",\n            )}\n            {themeRadioColor(\n              \"violet\",\n              t(\"ãƒã‚¤ã‚ªãƒ¬ãƒƒãƒˆ\", \"Violet\"),\n              \"bg-violet-500\",\n            )}\n          </div>\n        </RadioGroup>\n        <div className=\"mt-4 flex flex-wrap gap-2\">\n          <Button variant=\"default\">{t(\"ãƒœã‚¿ãƒ³\", \"Button\")}</Button>\n          <Button variant=\"destructive\">\n            {t(\"destructive\", \"Destructive\")}\n          </Button>\n          <Button variant=\"outline\">{t(\"outline\", \"Outline\")}</Button>\n          <Button variant=\"secondary\">{t(\"secondary\", \"Secondary\")}</Button>\n          <Button variant=\"ghost\">{t(\"ghost\", \"Ghost\")}</Button>\n          <Button variant=\"link\">{t(\"link\", \"Link\")}</Button>\n        </div>\n        <div className=\"mt-4 space-y-2\">\n          <Input\n            className=\"mx-2 w-80\"\n            id=\"sampleText1\"\n            placeholder={t(\"ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼\", \"Placeholder\")}\n            onChange={(_e) => {}}\n          />\n          <Input\n            className=\"mx-2 w-80\"\n            id=\"sampleText2\"\n            placeholder=\"\"\n            value={t(\"å…¥åŠ›æ¸ˆã¿\", \"Filled\")}\n            onChange={(_e) => {}}\n          />\n        </div>\n        <Tabs>\n          <div className=\"border-b\">\n            <TabsList className=\"flex space-x-2\">\n              <TabsTrigger\n                value=\"sampleTab1\"\n                onClick={() => handleTabClick(\"sampleTab1\")}\n                className={activeTab === \"sampleTab1\" ? \"active-tab\" : \"\"}\n              >\n                {t(\"ã‚¿ãƒ–1\", \"Tab 1\")}\n              </TabsTrigger>\n              <TabsTrigger\n                value=\"sampleTab2\"\n                onClick={() => handleTabClick(\"sampleTab2\")}\n                className={activeTab === \"sampleTab2\" ? \"active-tab\" : \"\"}\n              >\n                {t(\"ã‚¿ãƒ–2\", \"Tab 2\")}\n              </TabsTrigger>\n              <TabsTrigger\n                value=\"sampleTab3\"\n                onClick={() => handleTabClick(\"sampleTab3\")}\n                className={activeTab === \"sampleTab3\" ? \"active-tab\" : \"\"}\n              >\n                {t(\"ã‚¿ãƒ–3\", \"Tab 3\")}\n              </TabsTrigger>\n            </TabsList>\n          </div>\n        </Tabs>\n        <ResponsivePagination\n          perPage={32}\n          maxCount={200}\n          currentPage={activePage}\n          onPageChange={(page: number) => setActivePage(page)}\n        />\n      </div>\n    </div>\n  )\n}\n"},"tags":[],"source":null},{"category":"lint/suspicious/noAssignInExpressions","severity":"error","description":"The assignment should not be in an expression.","message":[{"elements":[],"content":"The "},{"elements":["Emphasis"],"content":"assignment"},{"elements":[],"content":" should not be in an "},{"elements":["Emphasis"],"content":"expression"},{"elements":[],"content":"."}],"advices":{"advices":[{"log":["info",[{"elements":[],"content":"The use of assignments in expressions is confusing.\nExpressions are often considered as side-effect free."}]]}]},"verboseAdvices":{"advices":[]},"location":{"path":{"file":"app/utils/mobile-performance.ts"},"span":[783,801],"sourceCode":"/**\n * ãƒ¢ãƒã‚¤ãƒ«ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®ãŸã‚ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£\n * ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºã¨ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æ”¹å–„ã™ã‚‹\n */\n\n// ãƒ‡ãƒã‚¦ãƒ³ã‚¹é–¢æ•°\nexport function debounce<T extends (...args: any[]) => any>(\n  func: T,\n  wait: number,\n): (...args: Parameters<T>) => void {\n  let timeout: NodeJS.Timeout\n  return (...args: Parameters<T>) => {\n    clearTimeout(timeout)\n    timeout = setTimeout(() => func(...args), wait)\n  }\n}\n\n// ã‚¹ãƒ­ãƒƒãƒˆãƒ«é–¢æ•°\nexport function throttle<T extends (...args: any[]) => any>(\n  func: T,\n  limit: number,\n): (...args: Parameters<T>) => void {\n  let inThrottle: boolean\n  return (...args: Parameters<T>) => {\n    if (!inThrottle) {\n      func(...args)\n      inThrottle = true\n      setTimeout(() => (inThrottle = false), limit)\n    }\n  }\n}\n\n// ç”»åƒã®äº‹å‰èª­ã¿è¾¼ã¿\nexport function preloadImage(src: string): Promise<void> {\n  return new Promise((resolve, reject) => {\n    const img = new Image()\n    img.onload = () => resolve()\n    img.onerror = () => reject(new Error(`Failed to load image: ${src}`))\n    img.src = src\n  })\n}\n\n// WebP ã‚µãƒãƒ¼ãƒˆã®æ¤œå‡º\nexport function detectWebPSupport(): Promise<boolean> {\n  if (typeof window === \"undefined\") return Promise.resolve(false)\n\n  return new Promise((resolve) => {\n    const webP = new Image()\n    webP.onload = webP.onerror = () => {\n      resolve(webP.height === 2)\n    }\n    webP.src =\n      \"data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA\"\n  })\n}\n\n// ãƒªã‚½ãƒ¼ã‚¹ãƒ’ãƒ³ãƒˆã®è¿½åŠ \nexport function addResourceHint(\n  href: string,\n  rel: \"preload\" | \"prefetch\" | \"dns-prefetch\" | \"preconnect\",\n  as?: string,\n): void {\n  if (typeof document === \"undefined\") return\n\n  const existingLink = document.querySelector(`link[href=\"${href}\"]`)\n  if (existingLink) return\n\n  const link = document.createElement(\"link\")\n  link.rel = rel\n  link.href = href\n  if (as) link.as = as\n\n  document.head.appendChild(link)\n}\n\n// ãƒ¢ãƒã‚¤ãƒ«ãƒ‡ãƒã‚¤ã‚¹ã®æ¤œå‡º\nexport function isMobileDevice(): boolean {\n  if (typeof window === \"undefined\") return false\n\n  return (\n    /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n      navigator.userAgent,\n    ) || window.innerWidth < 768\n  )\n}\n\n// ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºè­¦å‘Šï¼ˆé–‹ç™ºç’°å¢ƒã®ã¿ï¼‰\nexport function warnLargeBundle(componentName: string, sizeKB: number): void {\n  if (process.env.NODE_ENV === \"development\" && sizeKB > 100) {\n    console.warn(\n      `! Large bundle detected: ${componentName} (${sizeKB}KB). Consider code splitting.`,\n    )\n  }\n}\n\n// ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–\nexport function measurePerformance(name: string, fn: () => void): void {\n  if (typeof window === \"undefined\" || process.env.NODE_ENV !== \"development\") {\n    fn()\n    return\n  }\n\n  const start = performance.now()\n  fn()\n  const end = performance.now()\n\n  const duration = end - start\n  if (duration > 16) {\n    // 60fps threshold\n    console.warn(`ğŸŒ Slow operation: ${name} took ${duration.toFixed(2)}ms`)\n  }\n}\n"},"tags":[],"source":null}],"command":"lint"}
